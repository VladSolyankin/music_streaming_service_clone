function Vq(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function mT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function uce(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}var Uq={exports:{}},gT={},$q={exports:{}},Cr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cx=Symbol.for("react.element"),dce=Symbol.for("react.portal"),hce=Symbol.for("react.fragment"),fce=Symbol.for("react.strict_mode"),pce=Symbol.for("react.profiler"),mce=Symbol.for("react.provider"),gce=Symbol.for("react.context"),vce=Symbol.for("react.forward_ref"),yce=Symbol.for("react.suspense"),bce=Symbol.for("react.memo"),xce=Symbol.for("react.lazy"),tV=Symbol.iterator;function wce(e){return e===null||typeof e!="object"?null:(e=tV&&e[tV]||e["@@iterator"],typeof e=="function"?e:null)}var Hq={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Wq=Object.assign,Gq={};function o0(e,t,r){this.props=e,this.context=t,this.refs=Gq,this.updater=r||Hq}o0.prototype.isReactComponent={};o0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};o0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qq(){}qq.prototype=o0.prototype;function Pk(e,t,r){this.props=e,this.context=t,this.refs=Gq,this.updater=r||Hq}var Ik=Pk.prototype=new qq;Ik.constructor=Pk;Wq(Ik,o0.prototype);Ik.isPureReactComponent=!0;var rV=Array.isArray,Xq=Object.prototype.hasOwnProperty,Rk={current:null},Yq={key:!0,ref:!0,__self:!0,__source:!0};function Kq(e,t,r){var i,n={},s=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Xq.call(t,i)&&!Yq.hasOwnProperty(i)&&(n[i]=t[i]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)n[i]===void 0&&(n[i]=o[i]);return{$$typeof:Cx,type:e,key:s,ref:a,props:n,_owner:Rk.current}}function _ce(e,t){return{$$typeof:Cx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Dk(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cx}function Sce(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var iV=/\/+/g;function oP(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Sce(""+e.key):t.toString(36)}function HS(e,t,r,i,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Cx:case dce:a=!0}}if(a)return a=e,n=n(a),e=i===""?"."+oP(a,0):i,rV(n)?(r="",e!=null&&(r=e.replace(iV,"$&/")+"/"),HS(n,t,r,"",function(c){return c})):n!=null&&(Dk(n)&&(n=_ce(n,r+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(iV,"$&/")+"/")+e)),t.push(n)),1;if(a=0,i=i===""?".":i+":",rV(e))for(var o=0;o<e.length;o++){s=e[o];var l=i+oP(s,o);a+=HS(s,t,r,l,n)}else if(l=wce(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=i+oP(s,o++),a+=HS(s,t,r,l,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ow(e,t,r){if(e==null)return e;var i=[],n=0;return HS(e,i,"","",function(s){return t.call(r,s,n++)}),i}function Ece(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ta={current:null},WS={transition:null},Cce={ReactCurrentDispatcher:Ta,ReactCurrentBatchConfig:WS,ReactCurrentOwner:Rk};Cr.Children={map:Ow,forEach:function(e,t,r){Ow(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ow(e,function(){t++}),t},toArray:function(e){return Ow(e,function(t){return t})||[]},only:function(e){if(!Dk(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Cr.Component=o0;Cr.Fragment=hce;Cr.Profiler=pce;Cr.PureComponent=Pk;Cr.StrictMode=fce;Cr.Suspense=yce;Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cce;Cr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Wq({},e.props),n=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Rk.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Xq.call(t,l)&&!Yq.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}return{$$typeof:Cx,type:e.type,key:n,ref:s,props:i,_owner:a}};Cr.createContext=function(e){return e={$$typeof:gce,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:mce,_context:e},e.Consumer=e};Cr.createElement=Kq;Cr.createFactory=function(e){var t=Kq.bind(null,e);return t.type=e,t};Cr.createRef=function(){return{current:null}};Cr.forwardRef=function(e){return{$$typeof:vce,render:e}};Cr.isValidElement=Dk;Cr.lazy=function(e){return{$$typeof:xce,_payload:{_status:-1,_result:e},_init:Ece}};Cr.memo=function(e,t){return{$$typeof:bce,type:e,compare:t===void 0?null:t}};Cr.startTransition=function(e){var t=WS.transition;WS.transition={};try{e()}finally{WS.transition=t}};Cr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Cr.useCallback=function(e,t){return Ta.current.useCallback(e,t)};Cr.useContext=function(e){return Ta.current.useContext(e)};Cr.useDebugValue=function(){};Cr.useDeferredValue=function(e){return Ta.current.useDeferredValue(e)};Cr.useEffect=function(e,t){return Ta.current.useEffect(e,t)};Cr.useId=function(){return Ta.current.useId()};Cr.useImperativeHandle=function(e,t,r){return Ta.current.useImperativeHandle(e,t,r)};Cr.useInsertionEffect=function(e,t){return Ta.current.useInsertionEffect(e,t)};Cr.useLayoutEffect=function(e,t){return Ta.current.useLayoutEffect(e,t)};Cr.useMemo=function(e,t){return Ta.current.useMemo(e,t)};Cr.useReducer=function(e,t,r){return Ta.current.useReducer(e,t,r)};Cr.useRef=function(e){return Ta.current.useRef(e)};Cr.useState=function(e){return Ta.current.useState(e)};Cr.useSyncExternalStore=function(e,t,r){return Ta.current.useSyncExternalStore(e,t,r)};Cr.useTransition=function(){return Ta.current.useTransition()};Cr.version="18.2.0";$q.exports=Cr;var _=$q.exports;const Ge=mT(_),Zu=Vq({__proto__:null,default:Ge},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ace=_,Tce=Symbol.for("react.element"),Mce=Symbol.for("react.fragment"),Pce=Object.prototype.hasOwnProperty,Ice=Ace.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Rce={key:!0,ref:!0,__self:!0,__source:!0};function Qq(e,t,r){var i,n={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)Pce.call(t,i)&&!Rce.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:Tce,type:e,key:s,ref:a,props:n,_owner:Ice.current}}gT.Fragment=Mce;gT.jsx=Qq;gT.jsxs=Qq;Uq.exports=gT;var G=Uq.exports,XD={},Zq={exports:{}},Eo={},Jq={exports:{}},eX={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,B){var z=D.length;D.push(B);e:for(;0<z;){var F=z-1>>>1,V=D[F];if(0<n(V,B))D[F]=B,D[z]=V,z=F;else break e}}function r(D){return D.length===0?null:D[0]}function i(D){if(D.length===0)return null;var B=D[0],z=D.pop();if(z!==B){D[0]=z;e:for(var F=0,V=D.length,Y=V>>>1;F<Y;){var W=2*(F+1)-1,X=D[W],H=W+1,ie=D[H];if(0>n(X,z))H<V&&0>n(ie,X)?(D[F]=ie,D[H]=z,F=H):(D[F]=X,D[W]=z,F=W);else if(H<V&&0>n(ie,z))D[F]=ie,D[H]=z,F=H;else break e}}return B}function n(D,B){var z=D.sortIndex-B.sortIndex;return z!==0?z:D.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,u=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(D){for(var B=r(c);B!==null;){if(B.callback===null)i(c);else if(B.startTime<=D)i(c),B.sortIndex=B.expirationTime,t(l,B);else break;B=r(c)}}function x(D){if(m=!1,b(D),!p)if(r(l)!==null)p=!0,k(S);else{var B=r(c);B!==null&&O(x,B.startTime-D)}}function S(D,B){p=!1,m&&(m=!1,v(C),C=-1),f=!0;var z=h;try{for(b(B),u=r(l);u!==null&&(!(u.expirationTime>B)||D&&!M());){var F=u.callback;if(typeof F=="function"){u.callback=null,h=u.priorityLevel;var V=F(u.expirationTime<=B);B=e.unstable_now(),typeof V=="function"?u.callback=V:u===r(l)&&i(l),b(B)}else i(l);u=r(l)}if(u!==null)var Y=!0;else{var W=r(c);W!==null&&O(x,W.startTime-B),Y=!1}return Y}finally{u=null,h=z,f=!1}}var w=!1,E=null,C=-1,T=5,A=-1;function M(){return!(e.unstable_now()-A<T)}function P(){if(E!==null){var D=e.unstable_now();A=D;var B=!0;try{B=E(!0,D)}finally{B?I():(w=!1,E=null)}}else w=!1}var I;if(typeof y=="function")I=function(){y(P)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,N=R.port2;R.port1.onmessage=P,I=function(){N.postMessage(null)}}else I=function(){g(P,0)};function k(D){E=D,w||(w=!0,I())}function O(D,B){C=g(function(){D(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,k(S))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var z=h;h=B;try{return D()}finally{h=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,B){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var z=h;h=D;try{return B()}finally{h=z}},e.unstable_scheduleCallback=function(D,B,z){var F=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?F+z:F):z=F,D){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=z+V,D={id:d++,callback:B,priorityLevel:D,startTime:z,expirationTime:V,sortIndex:-1},z>F?(D.sortIndex=z,t(c,D),r(l)===null&&D===r(c)&&(m?(v(C),C=-1):m=!0,O(x,z-F))):(D.sortIndex=V,t(l,D),p||f||(p=!0,k(S))),D},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(D){var B=h;return function(){var z=h;h=B;try{return D.apply(this,arguments)}finally{h=z}}}})(eX);Jq.exports=eX;var Dce=Jq.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tX=_,xo=Dce;function st(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rX=new Set,lb={};function $p(e,t){_v(e,t),_v(e+"Capture",t)}function _v(e,t){for(lb[e]=t,e=0;e<t.length;e++)rX.add(t[e])}var Ju=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),YD=Object.prototype.hasOwnProperty,Oce=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nV={},sV={};function Lce(e){return YD.call(sV,e)?!0:YD.call(nV,e)?!1:Oce.test(e)?sV[e]=!0:(nV[e]=!0,!1)}function Nce(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kce(e,t,r,i){if(t===null||typeof t>"u"||Nce(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ma(e,t,r,i,n,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Is[e]=new Ma(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Is[t]=new Ma(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Is[e]=new Ma(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Is[e]=new Ma(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Is[e]=new Ma(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Is[e]=new Ma(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Is[e]=new Ma(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Is[e]=new Ma(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Is[e]=new Ma(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ok=/[\-:]([a-z])/g;function Lk(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ok,Lk);Is[t]=new Ma(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ok,Lk);Is[t]=new Ma(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ok,Lk);Is[t]=new Ma(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Is[e]=new Ma(e,1,!1,e.toLowerCase(),null,!1,!1)});Is.xlinkHref=new Ma("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Is[e]=new Ma(e,1,!1,e.toLowerCase(),null,!0,!0)});function Nk(e,t,r,i){var n=Is.hasOwnProperty(t)?Is[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kce(t,r,n,i)&&(r=null),i||n===null?Lce(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,i=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var pd=tX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lw=Symbol.for("react.element"),_g=Symbol.for("react.portal"),Sg=Symbol.for("react.fragment"),kk=Symbol.for("react.strict_mode"),KD=Symbol.for("react.profiler"),iX=Symbol.for("react.provider"),nX=Symbol.for("react.context"),zk=Symbol.for("react.forward_ref"),QD=Symbol.for("react.suspense"),ZD=Symbol.for("react.suspense_list"),Bk=Symbol.for("react.memo"),Vd=Symbol.for("react.lazy"),sX=Symbol.for("react.offscreen"),aV=Symbol.iterator;function Z0(e){return e===null||typeof e!="object"?null:(e=aV&&e[aV]||e["@@iterator"],typeof e=="function"?e:null)}var ki=Object.assign,lP;function Zy(e){if(lP===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);lP=t&&t[1]||""}return`
`+lP+e}var cP=!1;function uP(e,t){if(!e||cP)return"";cP=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),s=i.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{cP=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Zy(e):""}function zce(e){switch(e.tag){case 5:return Zy(e.type);case 16:return Zy("Lazy");case 13:return Zy("Suspense");case 19:return Zy("SuspenseList");case 0:case 2:case 15:return e=uP(e.type,!1),e;case 11:return e=uP(e.type.render,!1),e;case 1:return e=uP(e.type,!0),e;default:return""}}function JD(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Sg:return"Fragment";case _g:return"Portal";case KD:return"Profiler";case kk:return"StrictMode";case QD:return"Suspense";case ZD:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case nX:return(e.displayName||"Context")+".Consumer";case iX:return(e._context.displayName||"Context")+".Provider";case zk:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bk:return t=e.displayName||null,t!==null?t:JD(e.type)||"Memo";case Vd:t=e._payload,e=e._init;try{return JD(e(t))}catch{}}return null}function Bce(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return JD(t);case 8:return t===kk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Oh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function aX(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Fce(e){var t=aX(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nw(e){e._valueTracker||(e._valueTracker=Fce(e))}function oX(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=aX(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function kE(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function eO(e,t){var r=t.checked;return ki({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function oV(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=Oh(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lX(e,t){t=t.checked,t!=null&&Nk(e,"checked",t,!1)}function tO(e,t){lX(e,t);var r=Oh(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?rO(e,t.type,r):t.hasOwnProperty("defaultValue")&&rO(e,t.type,Oh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function lV(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function rO(e,t,r){(t!=="number"||kE(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Jy=Array.isArray;function qg(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+Oh(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,i&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function iO(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(st(91));return ki({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cV(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(st(92));if(Jy(r)){if(1<r.length)throw Error(st(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Oh(r)}}function cX(e,t){var r=Oh(t.value),i=Oh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function uV(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function uX(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nO(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?uX(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var kw,dX=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(kw=kw||document.createElement("div"),kw.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=kw.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function cb(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var _1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jce=["Webkit","ms","Moz","O"];Object.keys(_1).forEach(function(e){jce.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_1[t]=_1[e]})});function hX(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||_1.hasOwnProperty(e)&&_1[e]?(""+t).trim():t+"px"}function fX(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,n=hX(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}var Vce=ki({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sO(e,t){if(t){if(Vce[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(st(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(st(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(st(61))}if(t.style!=null&&typeof t.style!="object")throw Error(st(62))}}function aO(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oO=null;function Fk(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var lO=null,Xg=null,Yg=null;function dV(e){if(e=Mx(e)){if(typeof lO!="function")throw Error(st(280));var t=e.stateNode;t&&(t=wT(t),lO(e.stateNode,e.type,t))}}function pX(e){Xg?Yg?Yg.push(e):Yg=[e]:Xg=e}function mX(){if(Xg){var e=Xg,t=Yg;if(Yg=Xg=null,dV(e),t)for(e=0;e<t.length;e++)dV(t[e])}}function gX(e,t){return e(t)}function vX(){}var dP=!1;function yX(e,t,r){if(dP)return e(t,r);dP=!0;try{return gX(e,t,r)}finally{dP=!1,(Xg!==null||Yg!==null)&&(vX(),mX())}}function ub(e,t){var r=e.stateNode;if(r===null)return null;var i=wT(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(st(231,t,typeof r));return r}var cO=!1;if(Ju)try{var J0={};Object.defineProperty(J0,"passive",{get:function(){cO=!0}}),window.addEventListener("test",J0,J0),window.removeEventListener("test",J0,J0)}catch{cO=!1}function Uce(e,t,r,i,n,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var S1=!1,zE=null,BE=!1,uO=null,$ce={onError:function(e){S1=!0,zE=e}};function Hce(e,t,r,i,n,s,a,o,l){S1=!1,zE=null,Uce.apply($ce,arguments)}function Wce(e,t,r,i,n,s,a,o,l){if(Hce.apply(this,arguments),S1){if(S1){var c=zE;S1=!1,zE=null}else throw Error(st(198));BE||(BE=!0,uO=c)}}function Hp(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function bX(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hV(e){if(Hp(e)!==e)throw Error(st(188))}function Gce(e){var t=e.alternate;if(!t){if(t=Hp(e),t===null)throw Error(st(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return hV(n),e;if(s===i)return hV(n),t;s=s.sibling}throw Error(st(188))}if(r.return!==i.return)r=n,i=s;else{for(var a=!1,o=n.child;o;){if(o===r){a=!0,r=n,i=s;break}if(o===i){a=!0,i=n,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,i=n;break}if(o===i){a=!0,i=s,r=n;break}o=o.sibling}if(!a)throw Error(st(189))}}if(r.alternate!==i)throw Error(st(190))}if(r.tag!==3)throw Error(st(188));return r.stateNode.current===r?e:t}function xX(e){return e=Gce(e),e!==null?wX(e):null}function wX(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=wX(e);if(t!==null)return t;e=e.sibling}return null}var _X=xo.unstable_scheduleCallback,fV=xo.unstable_cancelCallback,qce=xo.unstable_shouldYield,Xce=xo.unstable_requestPaint,an=xo.unstable_now,Yce=xo.unstable_getCurrentPriorityLevel,jk=xo.unstable_ImmediatePriority,SX=xo.unstable_UserBlockingPriority,FE=xo.unstable_NormalPriority,Kce=xo.unstable_LowPriority,EX=xo.unstable_IdlePriority,vT=null,Nc=null;function Qce(e){if(Nc&&typeof Nc.onCommitFiberRoot=="function")try{Nc.onCommitFiberRoot(vT,e,void 0,(e.current.flags&128)===128)}catch{}}var Nl=Math.clz32?Math.clz32:eue,Zce=Math.log,Jce=Math.LN2;function eue(e){return e>>>=0,e===0?32:31-(Zce(e)/Jce|0)|0}var zw=64,Bw=4194304;function e1(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function jE(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,n=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~n;o!==0?i=e1(o):(s&=a,s!==0&&(i=e1(s)))}else a=r&~n,a!==0?i=e1(a):s!==0&&(i=e1(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&n)&&(n=i&-i,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-Nl(t),n=1<<r,i|=e[r],t&=~n;return i}function tue(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rue(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Nl(s),o=1<<a,l=n[a];l===-1?(!(o&r)||o&i)&&(n[a]=tue(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function dO(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function CX(){var e=zw;return zw<<=1,!(zw&4194240)&&(zw=64),e}function hP(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ax(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nl(t),e[t]=r}function iue(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Nl(r),s=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~s}}function Vk(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-Nl(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var ti=0;function AX(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var TX,Uk,MX,PX,IX,hO=!1,Fw=[],vh=null,yh=null,bh=null,db=new Map,hb=new Map,Hd=[],nue="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pV(e,t){switch(e){case"focusin":case"focusout":vh=null;break;case"dragenter":case"dragleave":yh=null;break;case"mouseover":case"mouseout":bh=null;break;case"pointerover":case"pointerout":db.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hb.delete(t.pointerId)}}function ey(e,t,r,i,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},t!==null&&(t=Mx(t),t!==null&&Uk(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function sue(e,t,r,i,n){switch(t){case"focusin":return vh=ey(vh,e,t,r,i,n),!0;case"dragenter":return yh=ey(yh,e,t,r,i,n),!0;case"mouseover":return bh=ey(bh,e,t,r,i,n),!0;case"pointerover":var s=n.pointerId;return db.set(s,ey(db.get(s)||null,e,t,r,i,n)),!0;case"gotpointercapture":return s=n.pointerId,hb.set(s,ey(hb.get(s)||null,e,t,r,i,n)),!0}return!1}function RX(e){var t=Of(e.target);if(t!==null){var r=Hp(t);if(r!==null){if(t=r.tag,t===13){if(t=bX(r),t!==null){e.blockedOn=t,IX(e.priority,function(){MX(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function GS(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=fO(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);oO=i,r.target.dispatchEvent(i),oO=null}else return t=Mx(r),t!==null&&Uk(t),e.blockedOn=r,!1;t.shift()}return!0}function mV(e,t,r){GS(e)&&r.delete(t)}function aue(){hO=!1,vh!==null&&GS(vh)&&(vh=null),yh!==null&&GS(yh)&&(yh=null),bh!==null&&GS(bh)&&(bh=null),db.forEach(mV),hb.forEach(mV)}function ty(e,t){e.blockedOn===t&&(e.blockedOn=null,hO||(hO=!0,xo.unstable_scheduleCallback(xo.unstable_NormalPriority,aue)))}function fb(e){function t(n){return ty(n,e)}if(0<Fw.length){ty(Fw[0],e);for(var r=1;r<Fw.length;r++){var i=Fw[r];i.blockedOn===e&&(i.blockedOn=null)}}for(vh!==null&&ty(vh,e),yh!==null&&ty(yh,e),bh!==null&&ty(bh,e),db.forEach(t),hb.forEach(t),r=0;r<Hd.length;r++)i=Hd[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<Hd.length&&(r=Hd[0],r.blockedOn===null);)RX(r),r.blockedOn===null&&Hd.shift()}var Kg=pd.ReactCurrentBatchConfig,VE=!0;function oue(e,t,r,i){var n=ti,s=Kg.transition;Kg.transition=null;try{ti=1,$k(e,t,r,i)}finally{ti=n,Kg.transition=s}}function lue(e,t,r,i){var n=ti,s=Kg.transition;Kg.transition=null;try{ti=4,$k(e,t,r,i)}finally{ti=n,Kg.transition=s}}function $k(e,t,r,i){if(VE){var n=fO(e,t,r,i);if(n===null)_P(e,t,i,UE,r),pV(e,i);else if(sue(n,e,t,r,i))i.stopPropagation();else if(pV(e,i),t&4&&-1<nue.indexOf(e)){for(;n!==null;){var s=Mx(n);if(s!==null&&TX(s),s=fO(e,t,r,i),s===null&&_P(e,t,i,UE,r),s===n)break;n=s}n!==null&&i.stopPropagation()}else _P(e,t,i,null,r)}}var UE=null;function fO(e,t,r,i){if(UE=null,e=Fk(i),e=Of(e),e!==null)if(t=Hp(e),t===null)e=null;else if(r=t.tag,r===13){if(e=bX(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return UE=e,null}function DX(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yce()){case jk:return 1;case SX:return 4;case FE:case Kce:return 16;case EX:return 536870912;default:return 16}default:return 16}}var eh=null,Hk=null,qS=null;function OX(){if(qS)return qS;var e,t=Hk,r=t.length,i,n="value"in eh?eh.value:eh.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var a=r-e;for(i=1;i<=a&&t[r-i]===n[s-i];i++);return qS=n.slice(e,1<i?1-i:void 0)}function XS(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jw(){return!0}function gV(){return!1}function Co(e){function t(r,i,n,s,a){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jw:gV,this.isPropagationStopped=gV,this}return ki(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=jw)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=jw)},persist:function(){},isPersistent:jw}),t}var l0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wk=Co(l0),Tx=ki({},l0,{view:0,detail:0}),cue=Co(Tx),fP,pP,ry,yT=ki({},Tx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ry&&(ry&&e.type==="mousemove"?(fP=e.screenX-ry.screenX,pP=e.screenY-ry.screenY):pP=fP=0,ry=e),fP)},movementY:function(e){return"movementY"in e?e.movementY:pP}}),vV=Co(yT),uue=ki({},yT,{dataTransfer:0}),due=Co(uue),hue=ki({},Tx,{relatedTarget:0}),mP=Co(hue),fue=ki({},l0,{animationName:0,elapsedTime:0,pseudoElement:0}),pue=Co(fue),mue=ki({},l0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gue=Co(mue),vue=ki({},l0,{data:0}),yV=Co(vue),yue={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bue={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xue={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wue(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xue[e])?!!t[e]:!1}function Gk(){return wue}var _ue=ki({},Tx,{key:function(e){if(e.key){var t=yue[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=XS(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?bue[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gk,charCode:function(e){return e.type==="keypress"?XS(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?XS(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Sue=Co(_ue),Eue=ki({},yT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bV=Co(Eue),Cue=ki({},Tx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gk}),Aue=Co(Cue),Tue=ki({},l0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mue=Co(Tue),Pue=ki({},yT,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Iue=Co(Pue),Rue=[9,13,27,32],qk=Ju&&"CompositionEvent"in window,E1=null;Ju&&"documentMode"in document&&(E1=document.documentMode);var Due=Ju&&"TextEvent"in window&&!E1,LX=Ju&&(!qk||E1&&8<E1&&11>=E1),xV=String.fromCharCode(32),wV=!1;function NX(e,t){switch(e){case"keyup":return Rue.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kX(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Eg=!1;function Oue(e,t){switch(e){case"compositionend":return kX(t);case"keypress":return t.which!==32?null:(wV=!0,xV);case"textInput":return e=t.data,e===xV&&wV?null:e;default:return null}}function Lue(e,t){if(Eg)return e==="compositionend"||!qk&&NX(e,t)?(e=OX(),qS=Hk=eh=null,Eg=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return LX&&t.locale!=="ko"?null:t.data;default:return null}}var Nue={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _V(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Nue[e.type]:t==="textarea"}function zX(e,t,r,i){pX(i),t=$E(t,"onChange"),0<t.length&&(r=new Wk("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var C1=null,pb=null;function kue(e){XX(e,0)}function bT(e){var t=Tg(e);if(oX(t))return e}function zue(e,t){if(e==="change")return t}var BX=!1;if(Ju){var gP;if(Ju){var vP="oninput"in document;if(!vP){var SV=document.createElement("div");SV.setAttribute("oninput","return;"),vP=typeof SV.oninput=="function"}gP=vP}else gP=!1;BX=gP&&(!document.documentMode||9<document.documentMode)}function EV(){C1&&(C1.detachEvent("onpropertychange",FX),pb=C1=null)}function FX(e){if(e.propertyName==="value"&&bT(pb)){var t=[];zX(t,pb,e,Fk(e)),yX(kue,t)}}function Bue(e,t,r){e==="focusin"?(EV(),C1=t,pb=r,C1.attachEvent("onpropertychange",FX)):e==="focusout"&&EV()}function Fue(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bT(pb)}function jue(e,t){if(e==="click")return bT(t)}function Vue(e,t){if(e==="input"||e==="change")return bT(t)}function Uue(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jl=typeof Object.is=="function"?Object.is:Uue;function mb(e,t){if(jl(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!YD.call(t,n)||!jl(e[n],t[n]))return!1}return!0}function CV(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function AV(e,t){var r=CV(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=CV(r)}}function jX(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?jX(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function VX(){for(var e=window,t=kE();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=kE(e.document)}return t}function Xk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $ue(e){var t=VX(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&jX(r.ownerDocument.documentElement,r)){if(i!==null&&Xk(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!e.extend&&s>i&&(n=i,i=s,s=n),n=AV(r,s);var a=AV(r,i);n&&a&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Hue=Ju&&"documentMode"in document&&11>=document.documentMode,Cg=null,pO=null,A1=null,mO=!1;function TV(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;mO||Cg==null||Cg!==kE(i)||(i=Cg,"selectionStart"in i&&Xk(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),A1&&mb(A1,i)||(A1=i,i=$E(pO,"onSelect"),0<i.length&&(t=new Wk("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Cg)))}function Vw(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ag={animationend:Vw("Animation","AnimationEnd"),animationiteration:Vw("Animation","AnimationIteration"),animationstart:Vw("Animation","AnimationStart"),transitionend:Vw("Transition","TransitionEnd")},yP={},UX={};Ju&&(UX=document.createElement("div").style,"AnimationEvent"in window||(delete Ag.animationend.animation,delete Ag.animationiteration.animation,delete Ag.animationstart.animation),"TransitionEvent"in window||delete Ag.transitionend.transition);function xT(e){if(yP[e])return yP[e];if(!Ag[e])return e;var t=Ag[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in UX)return yP[e]=t[r];return e}var $X=xT("animationend"),HX=xT("animationiteration"),WX=xT("animationstart"),GX=xT("transitionend"),qX=new Map,MV="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hh(e,t){qX.set(e,t),$p(t,[e])}for(var bP=0;bP<MV.length;bP++){var xP=MV[bP],Wue=xP.toLowerCase(),Gue=xP[0].toUpperCase()+xP.slice(1);Hh(Wue,"on"+Gue)}Hh($X,"onAnimationEnd");Hh(HX,"onAnimationIteration");Hh(WX,"onAnimationStart");Hh("dblclick","onDoubleClick");Hh("focusin","onFocus");Hh("focusout","onBlur");Hh(GX,"onTransitionEnd");_v("onMouseEnter",["mouseout","mouseover"]);_v("onMouseLeave",["mouseout","mouseover"]);_v("onPointerEnter",["pointerout","pointerover"]);_v("onPointerLeave",["pointerout","pointerover"]);$p("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$p("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$p("onBeforeInput",["compositionend","keypress","textInput","paste"]);$p("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$p("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$p("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var t1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),que=new Set("cancel close invalid load scroll toggle".split(" ").concat(t1));function PV(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,Wce(i,t,void 0,e),e.currentTarget=null}function XX(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;PV(n,o,c),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;PV(n,o,c),s=l}}}if(BE)throw e=uO,BE=!1,uO=null,e}function bi(e,t){var r=t[xO];r===void 0&&(r=t[xO]=new Set);var i=e+"__bubble";r.has(i)||(YX(t,e,2,!1),r.add(i))}function wP(e,t,r){var i=0;t&&(i|=4),YX(r,e,i,t)}var Uw="_reactListening"+Math.random().toString(36).slice(2);function gb(e){if(!e[Uw]){e[Uw]=!0,rX.forEach(function(r){r!=="selectionchange"&&(que.has(r)||wP(r,!1,e),wP(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Uw]||(t[Uw]=!0,wP("selectionchange",!1,t))}}function YX(e,t,r,i){switch(DX(t)){case 1:var n=oue;break;case 4:n=lue;break;default:n=$k}r=n.bind(null,t,r,e),n=void 0,!cO||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function _P(e,t,r,i,n){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=Of(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}yX(function(){var c=s,d=Fk(r),u=[];e:{var h=qX.get(e);if(h!==void 0){var f=Wk,p=e;switch(e){case"keypress":if(XS(r)===0)break e;case"keydown":case"keyup":f=Sue;break;case"focusin":p="focus",f=mP;break;case"focusout":p="blur",f=mP;break;case"beforeblur":case"afterblur":f=mP;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=vV;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=due;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Aue;break;case $X:case HX:case WX:f=pue;break;case GX:f=Mue;break;case"scroll":f=cue;break;case"wheel":f=Iue;break;case"copy":case"cut":case"paste":f=gue;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=bV}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,b;y!==null;){b=y;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,v!==null&&(x=ub(y,v),x!=null&&m.push(vb(y,x,b)))),g)break;y=y.return}0<m.length&&(h=new f(h,p,null,r,d),u.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&r!==oO&&(p=r.relatedTarget||r.fromElement)&&(Of(p)||p[ed]))break e;if((f||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=c,p=p?Of(p):null,p!==null&&(g=Hp(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=vV,x="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=bV,x="onPointerLeave",v="onPointerEnter",y="pointer"),g=f==null?h:Tg(f),b=p==null?h:Tg(p),h=new m(x,y+"leave",f,r,d),h.target=g,h.relatedTarget=b,x=null,Of(d)===c&&(m=new m(v,y+"enter",p,r,d),m.target=b,m.relatedTarget=g,x=m),g=x,f&&p)t:{for(m=f,v=p,y=0,b=m;b;b=um(b))y++;for(b=0,x=v;x;x=um(x))b++;for(;0<y-b;)m=um(m),y--;for(;0<b-y;)v=um(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=um(m),v=um(v)}m=null}else m=null;f!==null&&IV(u,h,f,m,!1),p!==null&&g!==null&&IV(u,g,p,m,!0)}}e:{if(h=c?Tg(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var S=zue;else if(_V(h))if(BX)S=Vue;else{S=Fue;var w=Bue}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=jue);if(S&&(S=S(e,c))){zX(u,S,r,d);break e}w&&w(e,h,c),e==="focusout"&&(w=h._wrapperState)&&w.controlled&&h.type==="number"&&rO(h,"number",h.value)}switch(w=c?Tg(c):window,e){case"focusin":(_V(w)||w.contentEditable==="true")&&(Cg=w,pO=c,A1=null);break;case"focusout":A1=pO=Cg=null;break;case"mousedown":mO=!0;break;case"contextmenu":case"mouseup":case"dragend":mO=!1,TV(u,r,d);break;case"selectionchange":if(Hue)break;case"keydown":case"keyup":TV(u,r,d)}var E;if(qk)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Eg?NX(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(LX&&r.locale!=="ko"&&(Eg||C!=="onCompositionStart"?C==="onCompositionEnd"&&Eg&&(E=OX()):(eh=d,Hk="value"in eh?eh.value:eh.textContent,Eg=!0)),w=$E(c,C),0<w.length&&(C=new yV(C,e,null,r,d),u.push({event:C,listeners:w}),E?C.data=E:(E=kX(r),E!==null&&(C.data=E)))),(E=Due?Oue(e,r):Lue(e,r))&&(c=$E(c,"onBeforeInput"),0<c.length&&(d=new yV("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:c}),d.data=E))}XX(u,t)})}function vb(e,t,r){return{instance:e,listener:t,currentTarget:r}}function $E(e,t){for(var r=t+"Capture",i=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=ub(e,r),s!=null&&i.unshift(vb(e,s,n)),s=ub(e,t),s!=null&&i.push(vb(e,s,n))),e=e.return}return i}function um(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function IV(e,t,r,i,n){for(var s=t._reactName,a=[];r!==null&&r!==i;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&c!==null&&(o=c,n?(l=ub(r,s),l!=null&&a.unshift(vb(r,l,o))):n||(l=ub(r,s),l!=null&&a.push(vb(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Xue=/\r\n?/g,Yue=/\u0000|\uFFFD/g;function RV(e){return(typeof e=="string"?e:""+e).replace(Xue,`
`).replace(Yue,"")}function $w(e,t,r){if(t=RV(t),RV(e)!==t&&r)throw Error(st(425))}function HE(){}var gO=null,vO=null;function yO(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bO=typeof setTimeout=="function"?setTimeout:void 0,Kue=typeof clearTimeout=="function"?clearTimeout:void 0,DV=typeof Promise=="function"?Promise:void 0,Que=typeof queueMicrotask=="function"?queueMicrotask:typeof DV<"u"?function(e){return DV.resolve(null).then(e).catch(Zue)}:bO;function Zue(e){setTimeout(function(){throw e})}function SP(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){e.removeChild(n),fb(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=n}while(r);fb(t)}function xh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function OV(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var c0=Math.random().toString(36).slice(2),Ec="__reactFiber$"+c0,yb="__reactProps$"+c0,ed="__reactContainer$"+c0,xO="__reactEvents$"+c0,Jue="__reactListeners$"+c0,ede="__reactHandles$"+c0;function Of(e){var t=e[Ec];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ed]||r[Ec]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=OV(e);e!==null;){if(r=e[Ec])return r;e=OV(e)}return t}e=r,r=e.parentNode}return null}function Mx(e){return e=e[Ec]||e[ed],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tg(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(st(33))}function wT(e){return e[yb]||null}var wO=[],Mg=-1;function Wh(e){return{current:e}}function Ei(e){0>Mg||(e.current=wO[Mg],wO[Mg]=null,Mg--)}function gi(e,t){Mg++,wO[Mg]=e.current,e.current=t}var Lh={},ea=Wh(Lh),Ga=Wh(!1),mp=Lh;function Sv(e,t){var r=e.type.contextTypes;if(!r)return Lh;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function qa(e){return e=e.childContextTypes,e!=null}function WE(){Ei(Ga),Ei(ea)}function LV(e,t,r){if(ea.current!==Lh)throw Error(st(168));gi(ea,t),gi(Ga,r)}function KX(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(st(108,Bce(e)||"Unknown",n));return ki({},r,i)}function GE(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Lh,mp=ea.current,gi(ea,e),gi(Ga,Ga.current),!0}function NV(e,t,r){var i=e.stateNode;if(!i)throw Error(st(169));r?(e=KX(e,t,mp),i.__reactInternalMemoizedMergedChildContext=e,Ei(Ga),Ei(ea),gi(ea,e)):Ei(Ga),gi(Ga,r)}var Mu=null,_T=!1,EP=!1;function QX(e){Mu===null?Mu=[e]:Mu.push(e)}function tde(e){_T=!0,QX(e)}function Gh(){if(!EP&&Mu!==null){EP=!0;var e=0,t=ti;try{var r=Mu;for(ti=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}Mu=null,_T=!1}catch(n){throw Mu!==null&&(Mu=Mu.slice(e+1)),_X(jk,Gh),n}finally{ti=t,EP=!1}}return null}var Pg=[],Ig=0,qE=null,XE=0,Wo=[],Go=0,gp=null,ku=1,zu="";function mf(e,t){Pg[Ig++]=XE,Pg[Ig++]=qE,qE=e,XE=t}function ZX(e,t,r){Wo[Go++]=ku,Wo[Go++]=zu,Wo[Go++]=gp,gp=e;var i=ku;e=zu;var n=32-Nl(i)-1;i&=~(1<<n),r+=1;var s=32-Nl(t)+n;if(30<s){var a=n-n%5;s=(i&(1<<a)-1).toString(32),i>>=a,n-=a,ku=1<<32-Nl(t)+n|r<<n|i,zu=s+e}else ku=1<<s|r<<n|i,zu=e}function Yk(e){e.return!==null&&(mf(e,1),ZX(e,1,0))}function Kk(e){for(;e===qE;)qE=Pg[--Ig],Pg[Ig]=null,XE=Pg[--Ig],Pg[Ig]=null;for(;e===gp;)gp=Wo[--Go],Wo[Go]=null,zu=Wo[--Go],Wo[Go]=null,ku=Wo[--Go],Wo[Go]=null}var vo=null,ho=null,Mi=!1,Tl=null;function JX(e,t){var r=Ko(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function kV(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vo=e,ho=xh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vo=e,ho=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=gp!==null?{id:ku,overflow:zu}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ko(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,vo=e,ho=null,!0):!1;default:return!1}}function _O(e){return(e.mode&1)!==0&&(e.flags&128)===0}function SO(e){if(Mi){var t=ho;if(t){var r=t;if(!kV(e,t)){if(_O(e))throw Error(st(418));t=xh(r.nextSibling);var i=vo;t&&kV(e,t)?JX(i,r):(e.flags=e.flags&-4097|2,Mi=!1,vo=e)}}else{if(_O(e))throw Error(st(418));e.flags=e.flags&-4097|2,Mi=!1,vo=e}}}function zV(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vo=e}function Hw(e){if(e!==vo)return!1;if(!Mi)return zV(e),Mi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!yO(e.type,e.memoizedProps)),t&&(t=ho)){if(_O(e))throw eY(),Error(st(418));for(;t;)JX(e,t),t=xh(t.nextSibling)}if(zV(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(st(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ho=xh(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ho=null}}else ho=vo?xh(e.stateNode.nextSibling):null;return!0}function eY(){for(var e=ho;e;)e=xh(e.nextSibling)}function Ev(){ho=vo=null,Mi=!1}function Qk(e){Tl===null?Tl=[e]:Tl.push(e)}var rde=pd.ReactCurrentBatchConfig;function _l(e,t){if(e&&e.defaultProps){t=ki({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var YE=Wh(null),KE=null,Rg=null,Zk=null;function Jk(){Zk=Rg=KE=null}function ez(e){var t=YE.current;Ei(YE),e._currentValue=t}function EO(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Qg(e,t){KE=e,Zk=Rg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ua=!0),e.firstContext=null)}function rl(e){var t=e._currentValue;if(Zk!==e)if(e={context:e,memoizedValue:t,next:null},Rg===null){if(KE===null)throw Error(st(308));Rg=e,KE.dependencies={lanes:0,firstContext:e}}else Rg=Rg.next=e;return t}var Lf=null;function tz(e){Lf===null?Lf=[e]:Lf.push(e)}function tY(e,t,r,i){var n=t.interleaved;return n===null?(r.next=r,tz(t)):(r.next=n.next,n.next=r),t.interleaved=r,td(e,i)}function td(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ud=!1;function rz(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rY(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Wu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function wh(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,kr&2){var n=i.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),i.pending=t,td(e,r)}return n=i.interleaved,n===null?(t.next=t,tz(i)):(t.next=n.next,n.next=t),i.interleaved=t,td(e,r)}function YS(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,Vk(e,r)}}function BV(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function QE(e,t,r,i){var n=e.updateQueue;Ud=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var u=n.baseState;a=0,d=c=l=null,o=s;do{var h=o.lane,f=o.eventTime;if((i&h)===h){d!==null&&(d=d.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,f=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){u=p.call(f,u,h);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,u,h):p,h==null)break e;u=ki({},u,h);break e;case 2:Ud=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=f,l=u):d=d.next=f,a|=h;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;h=o,o=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(1);if(d===null&&(l=u),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do a|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);yp|=a,e.lanes=a,e.memoizedState=u}}function FV(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(n!==null){if(i.callback=null,i=r,typeof n!="function")throw Error(st(191,n));n.call(i)}}}var iY=new tX.Component().refs;function CO(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:ki({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ST={isMounted:function(e){return(e=e._reactInternals)?Hp(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=xa(),n=Sh(e),s=Wu(i,n);s.payload=t,r!=null&&(s.callback=r),t=wh(e,s,n),t!==null&&(kl(t,e,n,i),YS(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=xa(),n=Sh(e),s=Wu(i,n);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=wh(e,s,n),t!==null&&(kl(t,e,n,i),YS(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=xa(),i=Sh(e),n=Wu(r,i);n.tag=2,t!=null&&(n.callback=t),t=wh(e,n,i),t!==null&&(kl(t,e,i,r),YS(t,e,i))}};function jV(e,t,r,i,n,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,a):t.prototype&&t.prototype.isPureReactComponent?!mb(r,i)||!mb(n,s):!0}function nY(e,t,r){var i=!1,n=Lh,s=t.contextType;return typeof s=="object"&&s!==null?s=rl(s):(n=qa(t)?mp:ea.current,i=t.contextTypes,s=(i=i!=null)?Sv(e,n):Lh),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ST,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function VV(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&ST.enqueueReplaceState(t,t.state,null)}function AO(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs=iY,rz(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=rl(s):(s=qa(t)?mp:ea.current,n.context=Sv(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(CO(e,t,s,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&ST.enqueueReplaceState(n,n.state,null),QE(e,r,n,i),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function iy(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(st(309));var i=r.stateNode}if(!i)throw Error(st(147,e));var n=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=n.refs;o===iY&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(st(284));if(!r._owner)throw Error(st(290,e))}return e}function Ww(e,t){throw e=Object.prototype.toString.call(t),Error(st(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function UV(e){var t=e._init;return t(e._payload)}function sY(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function n(v,y){return v=Eh(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,y,b,x){return y===null||y.tag!==6?(y=RP(b,v.mode,x),y.return=v,y):(y=n(y,b),y.return=v,y)}function l(v,y,b,x){var S=b.type;return S===Sg?d(v,y,b.props.children,x,b.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vd&&UV(S)===y.type)?(x=n(y,b.props),x.ref=iy(v,y,b),x.return=v,x):(x=tE(b.type,b.key,b.props,null,v.mode,x),x.ref=iy(v,y,b),x.return=v,x)}function c(v,y,b,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=DP(b,v.mode,x),y.return=v,y):(y=n(y,b.children||[]),y.return=v,y)}function d(v,y,b,x,S){return y===null||y.tag!==7?(y=Jf(b,v.mode,x,S),y.return=v,y):(y=n(y,b),y.return=v,y)}function u(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=RP(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Lw:return b=tE(y.type,y.key,y.props,null,v.mode,b),b.ref=iy(v,null,y),b.return=v,b;case _g:return y=DP(y,v.mode,b),y.return=v,y;case Vd:var x=y._init;return u(v,x(y._payload),b)}if(Jy(y)||Z0(y))return y=Jf(y,v.mode,b,null),y.return=v,y;Ww(v,y)}return null}function h(v,y,b,x){var S=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:o(v,y,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Lw:return b.key===S?l(v,y,b,x):null;case _g:return b.key===S?c(v,y,b,x):null;case Vd:return S=b._init,h(v,y,S(b._payload),x)}if(Jy(b)||Z0(b))return S!==null?null:d(v,y,b,x,null);Ww(v,b)}return null}function f(v,y,b,x,S){if(typeof x=="string"&&x!==""||typeof x=="number")return v=v.get(b)||null,o(y,v,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Lw:return v=v.get(x.key===null?b:x.key)||null,l(y,v,x,S);case _g:return v=v.get(x.key===null?b:x.key)||null,c(y,v,x,S);case Vd:var w=x._init;return f(v,y,b,w(x._payload),S)}if(Jy(x)||Z0(x))return v=v.get(b)||null,d(y,v,x,S,null);Ww(y,x)}return null}function p(v,y,b,x){for(var S=null,w=null,E=y,C=y=0,T=null;E!==null&&C<b.length;C++){E.index>C?(T=E,E=null):T=E.sibling;var A=h(v,E,b[C],x);if(A===null){E===null&&(E=T);break}e&&E&&A.alternate===null&&t(v,E),y=s(A,y,C),w===null?S=A:w.sibling=A,w=A,E=T}if(C===b.length)return r(v,E),Mi&&mf(v,C),S;if(E===null){for(;C<b.length;C++)E=u(v,b[C],x),E!==null&&(y=s(E,y,C),w===null?S=E:w.sibling=E,w=E);return Mi&&mf(v,C),S}for(E=i(v,E);C<b.length;C++)T=f(E,v,C,b[C],x),T!==null&&(e&&T.alternate!==null&&E.delete(T.key===null?C:T.key),y=s(T,y,C),w===null?S=T:w.sibling=T,w=T);return e&&E.forEach(function(M){return t(v,M)}),Mi&&mf(v,C),S}function m(v,y,b,x){var S=Z0(b);if(typeof S!="function")throw Error(st(150));if(b=S.call(b),b==null)throw Error(st(151));for(var w=S=null,E=y,C=y=0,T=null,A=b.next();E!==null&&!A.done;C++,A=b.next()){E.index>C?(T=E,E=null):T=E.sibling;var M=h(v,E,A.value,x);if(M===null){E===null&&(E=T);break}e&&E&&M.alternate===null&&t(v,E),y=s(M,y,C),w===null?S=M:w.sibling=M,w=M,E=T}if(A.done)return r(v,E),Mi&&mf(v,C),S;if(E===null){for(;!A.done;C++,A=b.next())A=u(v,A.value,x),A!==null&&(y=s(A,y,C),w===null?S=A:w.sibling=A,w=A);return Mi&&mf(v,C),S}for(E=i(v,E);!A.done;C++,A=b.next())A=f(E,v,C,A.value,x),A!==null&&(e&&A.alternate!==null&&E.delete(A.key===null?C:A.key),y=s(A,y,C),w===null?S=A:w.sibling=A,w=A);return e&&E.forEach(function(P){return t(v,P)}),Mi&&mf(v,C),S}function g(v,y,b,x){if(typeof b=="object"&&b!==null&&b.type===Sg&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Lw:e:{for(var S=b.key,w=y;w!==null;){if(w.key===S){if(S=b.type,S===Sg){if(w.tag===7){r(v,w.sibling),y=n(w,b.props.children),y.return=v,v=y;break e}}else if(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vd&&UV(S)===w.type){r(v,w.sibling),y=n(w,b.props),y.ref=iy(v,w,b),y.return=v,v=y;break e}r(v,w);break}else t(v,w);w=w.sibling}b.type===Sg?(y=Jf(b.props.children,v.mode,x,b.key),y.return=v,v=y):(x=tE(b.type,b.key,b.props,null,v.mode,x),x.ref=iy(v,y,b),x.return=v,v=x)}return a(v);case _g:e:{for(w=b.key;y!==null;){if(y.key===w)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=n(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=DP(b,v.mode,x),y.return=v,v=y}return a(v);case Vd:return w=b._init,g(v,y,w(b._payload),x)}if(Jy(b))return p(v,y,b,x);if(Z0(b))return m(v,y,b,x);Ww(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=n(y,b),y.return=v,v=y):(r(v,y),y=RP(b,v.mode,x),y.return=v,v=y),a(v)):r(v,y)}return g}var Cv=sY(!0),aY=sY(!1),Px={},kc=Wh(Px),bb=Wh(Px),xb=Wh(Px);function Nf(e){if(e===Px)throw Error(st(174));return e}function iz(e,t){switch(gi(xb,t),gi(bb,e),gi(kc,Px),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:nO(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=nO(t,e)}Ei(kc),gi(kc,t)}function Av(){Ei(kc),Ei(bb),Ei(xb)}function oY(e){Nf(xb.current);var t=Nf(kc.current),r=nO(t,e.type);t!==r&&(gi(bb,e),gi(kc,r))}function nz(e){bb.current===e&&(Ei(kc),Ei(bb))}var Ri=Wh(0);function ZE(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var CP=[];function sz(){for(var e=0;e<CP.length;e++)CP[e]._workInProgressVersionPrimary=null;CP.length=0}var KS=pd.ReactCurrentDispatcher,AP=pd.ReactCurrentBatchConfig,vp=0,Oi=null,Nn=null,Zn=null,JE=!1,T1=!1,wb=0,ide=0;function ks(){throw Error(st(321))}function az(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!jl(e[r],t[r]))return!1;return!0}function oz(e,t,r,i,n,s){if(vp=s,Oi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,KS.current=e===null||e.memoizedState===null?ode:lde,e=r(i,n),T1){s=0;do{if(T1=!1,wb=0,25<=s)throw Error(st(301));s+=1,Zn=Nn=null,t.updateQueue=null,KS.current=cde,e=r(i,n)}while(T1)}if(KS.current=eC,t=Nn!==null&&Nn.next!==null,vp=0,Zn=Nn=Oi=null,JE=!1,t)throw Error(st(300));return e}function lz(){var e=wb!==0;return wb=0,e}function vc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zn===null?Oi.memoizedState=Zn=e:Zn=Zn.next=e,Zn}function il(){if(Nn===null){var e=Oi.alternate;e=e!==null?e.memoizedState:null}else e=Nn.next;var t=Zn===null?Oi.memoizedState:Zn.next;if(t!==null)Zn=t,Nn=e;else{if(e===null)throw Error(st(310));Nn=e,e={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},Zn===null?Oi.memoizedState=Zn=e:Zn=Zn.next=e}return Zn}function _b(e,t){return typeof t=="function"?t(e):t}function TP(e){var t=il(),r=t.queue;if(r===null)throw Error(st(311));r.lastRenderedReducer=e;var i=Nn,n=i.baseQueue,s=r.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}i.baseQueue=n=s,r.pending=null}if(n!==null){s=n.next,i=i.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((vp&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=u,a=i):l=l.next=u,Oi.lanes|=d,yp|=d}c=c.next}while(c!==null&&c!==s);l===null?a=i:l.next=o,jl(i,t.memoizedState)||(Ua=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=l,r.lastRenderedState=i}if(e=r.interleaved,e!==null){n=e;do s=n.lane,Oi.lanes|=s,yp|=s,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function MP(e){var t=il(),r=t.queue;if(r===null)throw Error(st(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var a=n=n.next;do s=e(s,a.action),a=a.next;while(a!==n);jl(s,t.memoizedState)||(Ua=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,i]}function lY(){}function cY(e,t){var r=Oi,i=il(),n=t(),s=!jl(i.memoizedState,n);if(s&&(i.memoizedState=n,Ua=!0),i=i.queue,cz(hY.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||Zn!==null&&Zn.memoizedState.tag&1){if(r.flags|=2048,Sb(9,dY.bind(null,r,i,n,t),void 0,null),ss===null)throw Error(st(349));vp&30||uY(r,t,n)}return n}function uY(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Oi.updateQueue,t===null?(t={lastEffect:null,stores:null},Oi.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function dY(e,t,r,i){t.value=r,t.getSnapshot=i,fY(t)&&pY(e)}function hY(e,t,r){return r(function(){fY(t)&&pY(e)})}function fY(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!jl(e,r)}catch{return!0}}function pY(e){var t=td(e,1);t!==null&&kl(t,e,1,-1)}function $V(e){var t=vc();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_b,lastRenderedState:e},t.queue=e,e=e.dispatch=ade.bind(null,Oi,e),[t.memoizedState,e]}function Sb(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=Oi.updateQueue,t===null?(t={lastEffect:null,stores:null},Oi.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function mY(){return il().memoizedState}function QS(e,t,r,i){var n=vc();Oi.flags|=e,n.memoizedState=Sb(1|t,r,void 0,i===void 0?null:i)}function ET(e,t,r,i){var n=il();i=i===void 0?null:i;var s=void 0;if(Nn!==null){var a=Nn.memoizedState;if(s=a.destroy,i!==null&&az(i,a.deps)){n.memoizedState=Sb(t,r,s,i);return}}Oi.flags|=e,n.memoizedState=Sb(1|t,r,s,i)}function HV(e,t){return QS(8390656,8,e,t)}function cz(e,t){return ET(2048,8,e,t)}function gY(e,t){return ET(4,2,e,t)}function vY(e,t){return ET(4,4,e,t)}function yY(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function bY(e,t,r){return r=r!=null?r.concat([e]):null,ET(4,4,yY.bind(null,t,e),r)}function uz(){}function xY(e,t){var r=il();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&az(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function wY(e,t){var r=il();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&az(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function _Y(e,t,r){return vp&21?(jl(r,t)||(r=CX(),Oi.lanes|=r,yp|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ua=!0),e.memoizedState=r)}function nde(e,t){var r=ti;ti=r!==0&&4>r?r:4,e(!0);var i=AP.transition;AP.transition={};try{e(!1),t()}finally{ti=r,AP.transition=i}}function SY(){return il().memoizedState}function sde(e,t,r){var i=Sh(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},EY(e))CY(t,r);else if(r=tY(e,t,r,i),r!==null){var n=xa();kl(r,e,i,n),AY(r,t,i)}}function ade(e,t,r){var i=Sh(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(EY(e))CY(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(n.hasEagerState=!0,n.eagerState=o,jl(o,a)){var l=t.interleaved;l===null?(n.next=n,tz(t)):(n.next=l.next,l.next=n),t.interleaved=n;return}}catch{}finally{}r=tY(e,t,n,i),r!==null&&(n=xa(),kl(r,e,i,n),AY(r,t,i))}}function EY(e){var t=e.alternate;return e===Oi||t!==null&&t===Oi}function CY(e,t){T1=JE=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function AY(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,Vk(e,r)}}var eC={readContext:rl,useCallback:ks,useContext:ks,useEffect:ks,useImperativeHandle:ks,useInsertionEffect:ks,useLayoutEffect:ks,useMemo:ks,useReducer:ks,useRef:ks,useState:ks,useDebugValue:ks,useDeferredValue:ks,useTransition:ks,useMutableSource:ks,useSyncExternalStore:ks,useId:ks,unstable_isNewReconciler:!1},ode={readContext:rl,useCallback:function(e,t){return vc().memoizedState=[e,t===void 0?null:t],e},useContext:rl,useEffect:HV,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,QS(4194308,4,yY.bind(null,t,e),r)},useLayoutEffect:function(e,t){return QS(4194308,4,e,t)},useInsertionEffect:function(e,t){return QS(4,2,e,t)},useMemo:function(e,t){var r=vc();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=vc();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=sde.bind(null,Oi,e),[i.memoizedState,e]},useRef:function(e){var t=vc();return e={current:e},t.memoizedState=e},useState:$V,useDebugValue:uz,useDeferredValue:function(e){return vc().memoizedState=e},useTransition:function(){var e=$V(!1),t=e[0];return e=nde.bind(null,e[1]),vc().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=Oi,n=vc();if(Mi){if(r===void 0)throw Error(st(407));r=r()}else{if(r=t(),ss===null)throw Error(st(349));vp&30||uY(i,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,HV(hY.bind(null,i,s,e),[e]),i.flags|=2048,Sb(9,dY.bind(null,i,s,r,t),void 0,null),r},useId:function(){var e=vc(),t=ss.identifierPrefix;if(Mi){var r=zu,i=ku;r=(i&~(1<<32-Nl(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=wb++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ide++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},lde={readContext:rl,useCallback:xY,useContext:rl,useEffect:cz,useImperativeHandle:bY,useInsertionEffect:gY,useLayoutEffect:vY,useMemo:wY,useReducer:TP,useRef:mY,useState:function(){return TP(_b)},useDebugValue:uz,useDeferredValue:function(e){var t=il();return _Y(t,Nn.memoizedState,e)},useTransition:function(){var e=TP(_b)[0],t=il().memoizedState;return[e,t]},useMutableSource:lY,useSyncExternalStore:cY,useId:SY,unstable_isNewReconciler:!1},cde={readContext:rl,useCallback:xY,useContext:rl,useEffect:cz,useImperativeHandle:bY,useInsertionEffect:gY,useLayoutEffect:vY,useMemo:wY,useReducer:MP,useRef:mY,useState:function(){return MP(_b)},useDebugValue:uz,useDeferredValue:function(e){var t=il();return Nn===null?t.memoizedState=e:_Y(t,Nn.memoizedState,e)},useTransition:function(){var e=MP(_b)[0],t=il().memoizedState;return[e,t]},useMutableSource:lY,useSyncExternalStore:cY,useId:SY,unstable_isNewReconciler:!1};function Tv(e,t){try{var r="",i=t;do r+=zce(i),i=i.return;while(i);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n,digest:null}}function PP(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function TO(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ude=typeof WeakMap=="function"?WeakMap:Map;function TY(e,t,r){r=Wu(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){rC||(rC=!0,zO=i),TO(e,t)},r}function MY(e,t,r){r=Wu(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){TO(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){TO(e,t),typeof i!="function"&&(_h===null?_h=new Set([this]):_h.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function WV(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new ude;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=Ede.bind(null,e,t,r),t.then(e,e))}function GV(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function qV(e,t,r,i,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Wu(-1,1),t.tag=2,wh(r,t,1))),r.lanes|=1),e)}var dde=pd.ReactCurrentOwner,Ua=!1;function ha(e,t,r,i){t.child=e===null?aY(t,null,r,i):Cv(t,e.child,r,i)}function XV(e,t,r,i,n){r=r.render;var s=t.ref;return Qg(t,n),i=oz(e,t,r,i,s,n),r=lz(),e!==null&&!Ua?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,rd(e,t,n)):(Mi&&r&&Yk(t),t.flags|=1,ha(e,t,i,n),t.child)}function YV(e,t,r,i,n){if(e===null){var s=r.type;return typeof s=="function"&&!yz(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,PY(e,t,s,i,n)):(e=tE(r.type,null,i,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&n)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:mb,r(a,i)&&e.ref===t.ref)return rd(e,t,n)}return t.flags|=1,e=Eh(s,i),e.ref=t.ref,e.return=t,t.child=e}function PY(e,t,r,i,n){if(e!==null){var s=e.memoizedProps;if(mb(s,i)&&e.ref===t.ref)if(Ua=!1,t.pendingProps=i=s,(e.lanes&n)!==0)e.flags&131072&&(Ua=!0);else return t.lanes=e.lanes,rd(e,t,n)}return MO(e,t,r,i,n)}function IY(e,t,r){var i=t.pendingProps,n=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gi(Og,ao),ao|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gi(Og,ao),ao|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:r,gi(Og,ao),ao|=i}else s!==null?(i=s.baseLanes|r,t.memoizedState=null):i=r,gi(Og,ao),ao|=i;return ha(e,t,n,r),t.child}function RY(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function MO(e,t,r,i,n){var s=qa(r)?mp:ea.current;return s=Sv(t,s),Qg(t,n),r=oz(e,t,r,i,s,n),i=lz(),e!==null&&!Ua?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,rd(e,t,n)):(Mi&&i&&Yk(t),t.flags|=1,ha(e,t,r,n),t.child)}function KV(e,t,r,i,n){if(qa(r)){var s=!0;GE(t)}else s=!1;if(Qg(t,n),t.stateNode===null)ZS(e,t),nY(t,r,i),AO(t,r,i,n),i=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=rl(c):(c=qa(r)?mp:ea.current,c=Sv(t,c));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";u||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==c)&&VV(t,a,i,c),Ud=!1;var h=t.memoizedState;a.state=h,QE(t,i,a,n),l=t.memoizedState,o!==i||h!==l||Ga.current||Ud?(typeof d=="function"&&(CO(t,r,d,i),l=t.memoizedState),(o=Ud||jV(t,r,o,i,h,l,c))?(u||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,rY(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:_l(t.type,o),a.props=c,u=t.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=rl(l):(l=qa(r)?mp:ea.current,l=Sv(t,l));var f=r.getDerivedStateFromProps;(d=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==u||h!==l)&&VV(t,a,i,l),Ud=!1,h=t.memoizedState,a.state=h,QE(t,i,a,n);var p=t.memoizedState;o!==u||h!==p||Ga.current||Ud?(typeof f=="function"&&(CO(t,r,f,i),p=t.memoizedState),(c=Ud||jV(t,r,c,i,h,p,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,p,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),a.props=i,a.state=p,a.context=l,i=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return PO(e,t,r,i,s,n)}function PO(e,t,r,i,n,s){RY(e,t);var a=(t.flags&128)!==0;if(!i&&!a)return n&&NV(t,r,!1),rd(e,t,s);i=t.stateNode,dde.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&a?(t.child=Cv(t,e.child,null,s),t.child=Cv(t,null,o,s)):ha(e,t,o,s),t.memoizedState=i.state,n&&NV(t,r,!0),t.child}function DY(e){var t=e.stateNode;t.pendingContext?LV(e,t.pendingContext,t.pendingContext!==t.context):t.context&&LV(e,t.context,!1),iz(e,t.containerInfo)}function QV(e,t,r,i,n){return Ev(),Qk(n),t.flags|=256,ha(e,t,r,i),t.child}var IO={dehydrated:null,treeContext:null,retryLane:0};function RO(e){return{baseLanes:e,cachePool:null,transitions:null}}function OY(e,t,r){var i=t.pendingProps,n=Ri.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),gi(Ri,n&1),e===null)return SO(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,e=i.fallback,s?(i=t.mode,s=t.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=TT(a,i,0,null),e=Jf(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=RO(r),t.memoizedState=IO,e):dz(t,a));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return hde(e,t,a,i,o,n,r);if(s){s=i.fallback,a=t.mode,n=e.child,o=n.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&t.child!==n?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=Eh(n,l),i.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=Eh(o,s):(s=Jf(s,a,r,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a=a===null?RO(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=IO,i}return s=e.child,e=s.sibling,i=Eh(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function dz(e,t){return t=TT({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Gw(e,t,r,i){return i!==null&&Qk(i),Cv(t,e.child,null,r),e=dz(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hde(e,t,r,i,n,s,a){if(r)return t.flags&256?(t.flags&=-257,i=PP(Error(st(422))),Gw(e,t,a,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,n=t.mode,i=TT({mode:"visible",children:i.children},n,0,null),s=Jf(s,n,a,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&Cv(t,e.child,null,a),t.child.memoizedState=RO(a),t.memoizedState=IO,s);if(!(t.mode&1))return Gw(e,t,a,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(st(419)),i=PP(s,i,void 0),Gw(e,t,a,i)}if(o=(a&e.childLanes)!==0,Ua||o){if(i=ss,i!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,td(e,n),kl(i,e,n,-1))}return vz(),i=PP(Error(st(421))),Gw(e,t,a,i)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=Cde.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,ho=xh(n.nextSibling),vo=t,Mi=!0,Tl=null,e!==null&&(Wo[Go++]=ku,Wo[Go++]=zu,Wo[Go++]=gp,ku=e.id,zu=e.overflow,gp=t),t=dz(t,i.children),t.flags|=4096,t)}function ZV(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),EO(e.return,t,r)}function IP(e,t,r,i,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=r,s.tailMode=n)}function LY(e,t,r){var i=t.pendingProps,n=i.revealOrder,s=i.tail;if(ha(e,t,i.children,r),i=Ri.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ZV(e,r,t);else if(e.tag===19)ZV(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(gi(Ri,i),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&ZE(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),IP(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&ZE(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}IP(t,!0,r,null,s);break;case"together":IP(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ZS(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function rd(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),yp|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(st(153));if(t.child!==null){for(e=t.child,r=Eh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Eh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function fde(e,t,r){switch(t.tag){case 3:DY(t),Ev();break;case 5:oY(t);break;case 1:qa(t.type)&&GE(t);break;case 4:iz(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;gi(YE,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(gi(Ri,Ri.current&1),t.flags|=128,null):r&t.child.childLanes?OY(e,t,r):(gi(Ri,Ri.current&1),e=rd(e,t,r),e!==null?e.sibling:null);gi(Ri,Ri.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return LY(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),gi(Ri,Ri.current),i)break;return null;case 22:case 23:return t.lanes=0,IY(e,t,r)}return rd(e,t,r)}var NY,DO,kY,zY;NY=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};DO=function(){};kY=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,Nf(kc.current);var s=null;switch(r){case"input":n=eO(e,n),i=eO(e,i),s=[];break;case"select":n=ki({},n,{value:void 0}),i=ki({},i,{value:void 0}),s=[];break;case"textarea":n=iO(e,n),i=iO(e,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=HE)}sO(r,i);var a;r=null;for(c in n)if(!i.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var o=n[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(lb.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(o=n!=null?n[c]:void 0,i.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(lb.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&bi("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};zY=function(e,t,r,i){r!==i&&(t.flags|=4)};function ny(e,t){if(!Mi)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function zs(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function pde(e,t,r){var i=t.pendingProps;switch(Kk(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zs(t),null;case 1:return qa(t.type)&&WE(),zs(t),null;case 3:return i=t.stateNode,Av(),Ei(Ga),Ei(ea),sz(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Hw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Tl!==null&&(jO(Tl),Tl=null))),DO(e,t),zs(t),null;case 5:nz(t);var n=Nf(xb.current);if(r=t.type,e!==null&&t.stateNode!=null)kY(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(st(166));return zs(t),null}if(e=Nf(kc.current),Hw(t)){i=t.stateNode,r=t.type;var s=t.memoizedProps;switch(i[Ec]=t,i[yb]=s,e=(t.mode&1)!==0,r){case"dialog":bi("cancel",i),bi("close",i);break;case"iframe":case"object":case"embed":bi("load",i);break;case"video":case"audio":for(n=0;n<t1.length;n++)bi(t1[n],i);break;case"source":bi("error",i);break;case"img":case"image":case"link":bi("error",i),bi("load",i);break;case"details":bi("toggle",i);break;case"input":oV(i,s),bi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},bi("invalid",i);break;case"textarea":cV(i,s),bi("invalid",i)}sO(r,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&$w(i.textContent,o,e),n=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&$w(i.textContent,o,e),n=["children",""+o]):lb.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&bi("scroll",i)}switch(r){case"input":Nw(i),lV(i,s,!0);break;case"textarea":Nw(i),uV(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=HE)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=uX(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=a.createElement(r,{is:i.is}):(e=a.createElement(r),r==="select"&&(a=e,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):e=a.createElementNS(e,r),e[Ec]=t,e[yb]=i,NY(e,t,!1,!1),t.stateNode=e;e:{switch(a=aO(r,i),r){case"dialog":bi("cancel",e),bi("close",e),n=i;break;case"iframe":case"object":case"embed":bi("load",e),n=i;break;case"video":case"audio":for(n=0;n<t1.length;n++)bi(t1[n],e);n=i;break;case"source":bi("error",e),n=i;break;case"img":case"image":case"link":bi("error",e),bi("load",e),n=i;break;case"details":bi("toggle",e),n=i;break;case"input":oV(e,i),n=eO(e,i),bi("invalid",e);break;case"option":n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=ki({},i,{value:void 0}),bi("invalid",e);break;case"textarea":cV(e,i),n=iO(e,i),bi("invalid",e);break;default:n=i}sO(r,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?fX(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&dX(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&cb(e,l):typeof l=="number"&&cb(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(lb.hasOwnProperty(s)?l!=null&&s==="onScroll"&&bi("scroll",e):l!=null&&Nk(e,s,l,a))}switch(r){case"input":Nw(e),lV(e,i,!1);break;case"textarea":Nw(e),uV(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Oh(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?qg(e,!!i.multiple,s,!1):i.defaultValue!=null&&qg(e,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=HE)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zs(t),null;case 6:if(e&&t.stateNode!=null)zY(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(st(166));if(r=Nf(xb.current),Nf(kc.current),Hw(t)){if(i=t.stateNode,r=t.memoizedProps,i[Ec]=t,(s=i.nodeValue!==r)&&(e=vo,e!==null))switch(e.tag){case 3:$w(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$w(i.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[Ec]=t,t.stateNode=i}return zs(t),null;case 13:if(Ei(Ri),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Mi&&ho!==null&&t.mode&1&&!(t.flags&128))eY(),Ev(),t.flags|=98560,s=!1;else if(s=Hw(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(st(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(st(317));s[Ec]=t}else Ev(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;zs(t),s=!1}else Tl!==null&&(jO(Tl),Tl=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Ri.current&1?zn===0&&(zn=3):vz())),t.updateQueue!==null&&(t.flags|=4),zs(t),null);case 4:return Av(),DO(e,t),e===null&&gb(t.stateNode.containerInfo),zs(t),null;case 10:return ez(t.type._context),zs(t),null;case 17:return qa(t.type)&&WE(),zs(t),null;case 19:if(Ei(Ri),s=t.memoizedState,s===null)return zs(t),null;if(i=(t.flags&128)!==0,a=s.rendering,a===null)if(i)ny(s,!1);else{if(zn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=ZE(e),a!==null){for(t.flags|=128,ny(s,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)s=r,e=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return gi(Ri,Ri.current&1|2),t.child}e=e.sibling}s.tail!==null&&an()>Mv&&(t.flags|=128,i=!0,ny(s,!1),t.lanes=4194304)}else{if(!i)if(e=ZE(a),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ny(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Mi)return zs(t),null}else 2*an()-s.renderingStartTime>Mv&&r!==1073741824&&(t.flags|=128,i=!0,ny(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=an(),t.sibling=null,r=Ri.current,gi(Ri,i?r&1|2:r&1),t):(zs(t),null);case 22:case 23:return gz(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?ao&1073741824&&(zs(t),t.subtreeFlags&6&&(t.flags|=8192)):zs(t),null;case 24:return null;case 25:return null}throw Error(st(156,t.tag))}function mde(e,t){switch(Kk(t),t.tag){case 1:return qa(t.type)&&WE(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Av(),Ei(Ga),Ei(ea),sz(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return nz(t),null;case 13:if(Ei(Ri),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(st(340));Ev()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ei(Ri),null;case 4:return Av(),null;case 10:return ez(t.type._context),null;case 22:case 23:return gz(),null;case 24:return null;default:return null}}var qw=!1,Hs=!1,gde=typeof WeakSet=="function"?WeakSet:Set,At=null;function Dg(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){Xi(e,t,i)}else r.current=null}function OO(e,t,r){try{r()}catch(i){Xi(e,t,i)}}var JV=!1;function vde(e,t){if(gO=VE,e=VX(),Xk(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,d=0,u=e,h=null;t:for(;;){for(var f;u!==r||n!==0&&u.nodeType!==3||(o=a+n),u!==s||i!==0&&u.nodeType!==3||(l=a+i),u.nodeType===3&&(a+=u.nodeValue.length),(f=u.firstChild)!==null;)h=u,u=f;for(;;){if(u===e)break t;if(h===r&&++c===n&&(o=a),h===s&&++d===i&&(l=a),(f=u.nextSibling)!==null)break;u=h,h=u.parentNode}u=f}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(vO={focusedElem:e,selectionRange:r},VE=!1,At=t;At!==null;)if(t=At,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,At=e;else for(;At!==null;){t=At;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:_l(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(st(163))}}catch(x){Xi(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,At=e;break}At=t.return}return p=JV,JV=!1,p}function M1(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&OO(t,r,s)}n=n.next}while(n!==i)}}function CT(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function LO(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function BY(e){var t=e.alternate;t!==null&&(e.alternate=null,BY(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ec],delete t[yb],delete t[xO],delete t[Jue],delete t[ede])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function FY(e){return e.tag===5||e.tag===3||e.tag===4}function e5(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||FY(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function NO(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=HE));else if(i!==4&&(e=e.child,e!==null))for(NO(e,t,r),e=e.sibling;e!==null;)NO(e,t,r),e=e.sibling}function kO(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(kO(e,t,r),e=e.sibling;e!==null;)kO(e,t,r),e=e.sibling}var fs=null,Sl=!1;function wd(e,t,r){for(r=r.child;r!==null;)jY(e,t,r),r=r.sibling}function jY(e,t,r){if(Nc&&typeof Nc.onCommitFiberUnmount=="function")try{Nc.onCommitFiberUnmount(vT,r)}catch{}switch(r.tag){case 5:Hs||Dg(r,t);case 6:var i=fs,n=Sl;fs=null,wd(e,t,r),fs=i,Sl=n,fs!==null&&(Sl?(e=fs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):fs.removeChild(r.stateNode));break;case 18:fs!==null&&(Sl?(e=fs,r=r.stateNode,e.nodeType===8?SP(e.parentNode,r):e.nodeType===1&&SP(e,r),fb(e)):SP(fs,r.stateNode));break;case 4:i=fs,n=Sl,fs=r.stateNode.containerInfo,Sl=!0,wd(e,t,r),fs=i,Sl=n;break;case 0:case 11:case 14:case 15:if(!Hs&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&OO(r,t,a),n=n.next}while(n!==i)}wd(e,t,r);break;case 1:if(!Hs&&(Dg(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(o){Xi(r,t,o)}wd(e,t,r);break;case 21:wd(e,t,r);break;case 22:r.mode&1?(Hs=(i=Hs)||r.memoizedState!==null,wd(e,t,r),Hs=i):wd(e,t,r);break;default:wd(e,t,r)}}function t5(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new gde),t.forEach(function(i){var n=Ade.bind(null,e,i);r.has(i)||(r.add(i),i.then(n,n))})}}function cl(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:fs=o.stateNode,Sl=!1;break e;case 3:fs=o.stateNode.containerInfo,Sl=!0;break e;case 4:fs=o.stateNode.containerInfo,Sl=!0;break e}o=o.return}if(fs===null)throw Error(st(160));jY(s,a,n),fs=null,Sl=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){Xi(n,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)VY(t,e),t=t.sibling}function VY(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(cl(t,e),ic(e),i&4){try{M1(3,e,e.return),CT(3,e)}catch(m){Xi(e,e.return,m)}try{M1(5,e,e.return)}catch(m){Xi(e,e.return,m)}}break;case 1:cl(t,e),ic(e),i&512&&r!==null&&Dg(r,r.return);break;case 5:if(cl(t,e),ic(e),i&512&&r!==null&&Dg(r,r.return),e.flags&32){var n=e.stateNode;try{cb(n,"")}catch(m){Xi(e,e.return,m)}}if(i&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&lX(n,s),aO(o,a);var c=aO(o,s);for(a=0;a<l.length;a+=2){var d=l[a],u=l[a+1];d==="style"?fX(n,u):d==="dangerouslySetInnerHTML"?dX(n,u):d==="children"?cb(n,u):Nk(n,d,u,c)}switch(o){case"input":tO(n,s);break;case"textarea":cX(n,s);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?qg(n,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?qg(n,!!s.multiple,s.defaultValue,!0):qg(n,!!s.multiple,s.multiple?[]:"",!1))}n[yb]=s}catch(m){Xi(e,e.return,m)}}break;case 6:if(cl(t,e),ic(e),i&4){if(e.stateNode===null)throw Error(st(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(m){Xi(e,e.return,m)}}break;case 3:if(cl(t,e),ic(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{fb(t.containerInfo)}catch(m){Xi(e,e.return,m)}break;case 4:cl(t,e),ic(e);break;case 13:cl(t,e),ic(e),n=e.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(pz=an())),i&4&&t5(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Hs=(c=Hs)||d,cl(t,e),Hs=c):cl(t,e),ic(e),i&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(At=e,d=e.child;d!==null;){for(u=At=d;At!==null;){switch(h=At,f=h.child,h.tag){case 0:case 11:case 14:case 15:M1(4,h,h.return);break;case 1:Dg(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){i=h,r=h.return;try{t=i,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Xi(i,r,m)}}break;case 5:Dg(h,h.return);break;case 22:if(h.memoizedState!==null){i5(u);continue}}f!==null?(f.return=h,At=f):i5(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{n=u.stateNode,c?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=u.stateNode,l=u.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=hX("display",a))}catch(m){Xi(e,e.return,m)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){Xi(e,e.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:cl(t,e),ic(e),i&4&&t5(e);break;case 21:break;default:cl(t,e),ic(e)}}function ic(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(FY(r)){var i=r;break e}r=r.return}throw Error(st(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(cb(n,""),i.flags&=-33);var s=e5(e);kO(e,s,n);break;case 3:case 4:var a=i.stateNode.containerInfo,o=e5(e);NO(e,o,a);break;default:throw Error(st(161))}}catch(l){Xi(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yde(e,t,r){At=e,UY(e)}function UY(e,t,r){for(var i=(e.mode&1)!==0;At!==null;){var n=At,s=n.child;if(n.tag===22&&i){var a=n.memoizedState!==null||qw;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||Hs;o=qw;var c=Hs;if(qw=a,(Hs=l)&&!c)for(At=n;At!==null;)a=At,l=a.child,a.tag===22&&a.memoizedState!==null?n5(n):l!==null?(l.return=a,At=l):n5(n);for(;s!==null;)At=s,UY(s),s=s.sibling;At=n,qw=o,Hs=c}r5(e)}else n.subtreeFlags&8772&&s!==null?(s.return=n,At=s):r5(e)}}function r5(e){for(;At!==null;){var t=At;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Hs||CT(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Hs)if(r===null)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:_l(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&FV(t,s,i);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}FV(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&fb(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(st(163))}Hs||t.flags&512&&LO(t)}catch(h){Xi(t,t.return,h)}}if(t===e){At=null;break}if(r=t.sibling,r!==null){r.return=t.return,At=r;break}At=t.return}}function i5(e){for(;At!==null;){var t=At;if(t===e){At=null;break}var r=t.sibling;if(r!==null){r.return=t.return,At=r;break}At=t.return}}function n5(e){for(;At!==null;){var t=At;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{CT(4,t)}catch(l){Xi(t,r,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(l){Xi(t,n,l)}}var s=t.return;try{LO(t)}catch(l){Xi(t,s,l)}break;case 5:var a=t.return;try{LO(t)}catch(l){Xi(t,a,l)}}}catch(l){Xi(t,t.return,l)}if(t===e){At=null;break}var o=t.sibling;if(o!==null){o.return=t.return,At=o;break}At=t.return}}var bde=Math.ceil,tC=pd.ReactCurrentDispatcher,hz=pd.ReactCurrentOwner,Zo=pd.ReactCurrentBatchConfig,kr=0,ss=null,_n=null,Ss=0,ao=0,Og=Wh(0),zn=0,Eb=null,yp=0,AT=0,fz=0,P1=null,za=null,pz=0,Mv=1/0,Cu=null,rC=!1,zO=null,_h=null,Xw=!1,th=null,iC=0,I1=0,BO=null,JS=-1,eE=0;function xa(){return kr&6?an():JS!==-1?JS:JS=an()}function Sh(e){return e.mode&1?kr&2&&Ss!==0?Ss&-Ss:rde.transition!==null?(eE===0&&(eE=CX()),eE):(e=ti,e!==0||(e=window.event,e=e===void 0?16:DX(e.type)),e):1}function kl(e,t,r,i){if(50<I1)throw I1=0,BO=null,Error(st(185));Ax(e,r,i),(!(kr&2)||e!==ss)&&(e===ss&&(!(kr&2)&&(AT|=r),zn===4&&Wd(e,Ss)),Xa(e,i),r===1&&kr===0&&!(t.mode&1)&&(Mv=an()+500,_T&&Gh()))}function Xa(e,t){var r=e.callbackNode;rue(e,t);var i=jE(e,e===ss?Ss:0);if(i===0)r!==null&&fV(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&fV(r),t===1)e.tag===0?tde(s5.bind(null,e)):QX(s5.bind(null,e)),Que(function(){!(kr&6)&&Gh()}),r=null;else{switch(AX(i)){case 1:r=jk;break;case 4:r=SX;break;case 16:r=FE;break;case 536870912:r=EX;break;default:r=FE}r=KY(r,$Y.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function $Y(e,t){if(JS=-1,eE=0,kr&6)throw Error(st(327));var r=e.callbackNode;if(Zg()&&e.callbackNode!==r)return null;var i=jE(e,e===ss?Ss:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=nC(e,i);else{t=i;var n=kr;kr|=2;var s=WY();(ss!==e||Ss!==t)&&(Cu=null,Mv=an()+500,Zf(e,t));do try{_de();break}catch(o){HY(e,o)}while(1);Jk(),tC.current=s,kr=n,_n!==null?t=0:(ss=null,Ss=0,t=zn)}if(t!==0){if(t===2&&(n=dO(e),n!==0&&(i=n,t=FO(e,n))),t===1)throw r=Eb,Zf(e,0),Wd(e,i),Xa(e,an()),r;if(t===6)Wd(e,i);else{if(n=e.current.alternate,!(i&30)&&!xde(n)&&(t=nC(e,i),t===2&&(s=dO(e),s!==0&&(i=s,t=FO(e,s))),t===1))throw r=Eb,Zf(e,0),Wd(e,i),Xa(e,an()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(st(345));case 2:gf(e,za,Cu);break;case 3:if(Wd(e,i),(i&130023424)===i&&(t=pz+500-an(),10<t)){if(jE(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){xa(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=bO(gf.bind(null,e,za,Cu),t);break}gf(e,za,Cu);break;case 4:if(Wd(e,i),(i&4194240)===i)break;for(t=e.eventTimes,n=-1;0<i;){var a=31-Nl(i);s=1<<a,a=t[a],a>n&&(n=a),i&=~s}if(i=n,i=an()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*bde(i/1960))-i,10<i){e.timeoutHandle=bO(gf.bind(null,e,za,Cu),i);break}gf(e,za,Cu);break;case 5:gf(e,za,Cu);break;default:throw Error(st(329))}}}return Xa(e,an()),e.callbackNode===r?$Y.bind(null,e):null}function FO(e,t){var r=P1;return e.current.memoizedState.isDehydrated&&(Zf(e,t).flags|=256),e=nC(e,t),e!==2&&(t=za,za=r,t!==null&&jO(t)),e}function jO(e){za===null?za=e:za.push.apply(za,e)}function xde(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var n=r[i],s=n.getSnapshot;n=n.value;try{if(!jl(s(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wd(e,t){for(t&=~fz,t&=~AT,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Nl(t),i=1<<r;e[r]=-1,t&=~i}}function s5(e){if(kr&6)throw Error(st(327));Zg();var t=jE(e,0);if(!(t&1))return Xa(e,an()),null;var r=nC(e,t);if(e.tag!==0&&r===2){var i=dO(e);i!==0&&(t=i,r=FO(e,i))}if(r===1)throw r=Eb,Zf(e,0),Wd(e,t),Xa(e,an()),r;if(r===6)throw Error(st(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gf(e,za,Cu),Xa(e,an()),null}function mz(e,t){var r=kr;kr|=1;try{return e(t)}finally{kr=r,kr===0&&(Mv=an()+500,_T&&Gh())}}function bp(e){th!==null&&th.tag===0&&!(kr&6)&&Zg();var t=kr;kr|=1;var r=Zo.transition,i=ti;try{if(Zo.transition=null,ti=1,e)return e()}finally{ti=i,Zo.transition=r,kr=t,!(kr&6)&&Gh()}}function gz(){ao=Og.current,Ei(Og)}function Zf(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Kue(r)),_n!==null)for(r=_n.return;r!==null;){var i=r;switch(Kk(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&WE();break;case 3:Av(),Ei(Ga),Ei(ea),sz();break;case 5:nz(i);break;case 4:Av();break;case 13:Ei(Ri);break;case 19:Ei(Ri);break;case 10:ez(i.type._context);break;case 22:case 23:gz()}r=r.return}if(ss=e,_n=e=Eh(e.current,null),Ss=ao=t,zn=0,Eb=null,fz=AT=yp=0,za=P1=null,Lf!==null){for(t=0;t<Lf.length;t++)if(r=Lf[t],i=r.interleaved,i!==null){r.interleaved=null;var n=i.next,s=r.pending;if(s!==null){var a=s.next;s.next=n,i.next=a}r.pending=i}Lf=null}return e}function HY(e,t){do{var r=_n;try{if(Jk(),KS.current=eC,JE){for(var i=Oi.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}JE=!1}if(vp=0,Zn=Nn=Oi=null,T1=!1,wb=0,hz.current=null,r===null||r.return===null){zn=1,Eb=t,_n=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=Ss,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=GV(a);if(f!==null){f.flags&=-257,qV(f,a,o,s,t),f.mode&1&&WV(s,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(l),t.updateQueue=m}else p.add(l);break e}else{if(!(t&1)){WV(s,c,t),vz();break e}l=Error(st(426))}}else if(Mi&&o.mode&1){var g=GV(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),qV(g,a,o,s,t),Qk(Tv(l,o));break e}}s=l=Tv(l,o),zn!==4&&(zn=2),P1===null?P1=[s]:P1.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=TY(s,l,t);BV(s,v);break e;case 1:o=l;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(_h===null||!_h.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t;var x=MY(s,o,t);BV(s,x);break e}}s=s.return}while(s!==null)}qY(r)}catch(S){t=S,_n===r&&r!==null&&(_n=r=r.return);continue}break}while(1)}function WY(){var e=tC.current;return tC.current=eC,e===null?eC:e}function vz(){(zn===0||zn===3||zn===2)&&(zn=4),ss===null||!(yp&268435455)&&!(AT&268435455)||Wd(ss,Ss)}function nC(e,t){var r=kr;kr|=2;var i=WY();(ss!==e||Ss!==t)&&(Cu=null,Zf(e,t));do try{wde();break}catch(n){HY(e,n)}while(1);if(Jk(),kr=r,tC.current=i,_n!==null)throw Error(st(261));return ss=null,Ss=0,zn}function wde(){for(;_n!==null;)GY(_n)}function _de(){for(;_n!==null&&!qce();)GY(_n)}function GY(e){var t=YY(e.alternate,e,ao);e.memoizedProps=e.pendingProps,t===null?qY(e):_n=t,hz.current=null}function qY(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=mde(r,t),r!==null){r.flags&=32767,_n=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{zn=6,_n=null;return}}else if(r=pde(r,t,ao),r!==null){_n=r;return}if(t=t.sibling,t!==null){_n=t;return}_n=t=e}while(t!==null);zn===0&&(zn=5)}function gf(e,t,r){var i=ti,n=Zo.transition;try{Zo.transition=null,ti=1,Sde(e,t,r,i)}finally{Zo.transition=n,ti=i}return null}function Sde(e,t,r,i){do Zg();while(th!==null);if(kr&6)throw Error(st(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(st(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(iue(e,s),e===ss&&(_n=ss=null,Ss=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Xw||(Xw=!0,KY(FE,function(){return Zg(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Zo.transition,Zo.transition=null;var a=ti;ti=1;var o=kr;kr|=4,hz.current=null,vde(e,r),VY(r,e),$ue(vO),VE=!!gO,vO=gO=null,e.current=r,yde(r),Xce(),kr=o,ti=a,Zo.transition=s}else e.current=r;if(Xw&&(Xw=!1,th=e,iC=n),s=e.pendingLanes,s===0&&(_h=null),Qce(r.stateNode),Xa(e,an()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],i(n.value,{componentStack:n.stack,digest:n.digest});if(rC)throw rC=!1,e=zO,zO=null,e;return iC&1&&e.tag!==0&&Zg(),s=e.pendingLanes,s&1?e===BO?I1++:(I1=0,BO=e):I1=0,Gh(),null}function Zg(){if(th!==null){var e=AX(iC),t=Zo.transition,r=ti;try{if(Zo.transition=null,ti=16>e?16:e,th===null)var i=!1;else{if(e=th,th=null,iC=0,kr&6)throw Error(st(331));var n=kr;for(kr|=4,At=e.current;At!==null;){var s=At,a=s.child;if(At.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(At=c;At!==null;){var d=At;switch(d.tag){case 0:case 11:case 15:M1(8,d,s)}var u=d.child;if(u!==null)u.return=d,At=u;else for(;At!==null;){d=At;var h=d.sibling,f=d.return;if(BY(d),d===c){At=null;break}if(h!==null){h.return=f,At=h;break}At=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}At=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,At=a;else e:for(;At!==null;){if(s=At,s.flags&2048)switch(s.tag){case 0:case 11:case 15:M1(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,At=v;break e}At=s.return}}var y=e.current;for(At=y;At!==null;){a=At;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,At=b;else e:for(a=y;At!==null;){if(o=At,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:CT(9,o)}}catch(S){Xi(o,o.return,S)}if(o===a){At=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,At=x;break e}At=o.return}}if(kr=n,Gh(),Nc&&typeof Nc.onPostCommitFiberRoot=="function")try{Nc.onPostCommitFiberRoot(vT,e)}catch{}i=!0}return i}finally{ti=r,Zo.transition=t}}return!1}function a5(e,t,r){t=Tv(r,t),t=TY(e,t,1),e=wh(e,t,1),t=xa(),e!==null&&(Ax(e,1,t),Xa(e,t))}function Xi(e,t,r){if(e.tag===3)a5(e,e,r);else for(;t!==null;){if(t.tag===3){a5(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(_h===null||!_h.has(i))){e=Tv(r,e),e=MY(t,e,1),t=wh(t,e,1),e=xa(),t!==null&&(Ax(t,1,e),Xa(t,e));break}}t=t.return}}function Ede(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=xa(),e.pingedLanes|=e.suspendedLanes&r,ss===e&&(Ss&r)===r&&(zn===4||zn===3&&(Ss&130023424)===Ss&&500>an()-pz?Zf(e,0):fz|=r),Xa(e,t)}function XY(e,t){t===0&&(e.mode&1?(t=Bw,Bw<<=1,!(Bw&130023424)&&(Bw=4194304)):t=1);var r=xa();e=td(e,t),e!==null&&(Ax(e,t,r),Xa(e,r))}function Cde(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),XY(e,r)}function Ade(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(st(314))}i!==null&&i.delete(t),XY(e,r)}var YY;YY=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ga.current)Ua=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ua=!1,fde(e,t,r);Ua=!!(e.flags&131072)}else Ua=!1,Mi&&t.flags&1048576&&ZX(t,XE,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;ZS(e,t),e=t.pendingProps;var n=Sv(t,ea.current);Qg(t,r),n=oz(null,t,i,e,n,r);var s=lz();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qa(i)?(s=!0,GE(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,rz(t),n.updater=ST,t.stateNode=n,n._reactInternals=t,AO(t,i,e,r),t=PO(null,t,i,!0,s,r)):(t.tag=0,Mi&&s&&Yk(t),ha(null,t,n,r),t=t.child),t;case 16:i=t.elementType;e:{switch(ZS(e,t),e=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=Mde(i),e=_l(i,e),n){case 0:t=MO(null,t,i,e,r);break e;case 1:t=KV(null,t,i,e,r);break e;case 11:t=XV(null,t,i,e,r);break e;case 14:t=YV(null,t,i,_l(i.type,e),r);break e}throw Error(st(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:_l(i,n),MO(e,t,i,n,r);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:_l(i,n),KV(e,t,i,n,r);case 3:e:{if(DY(t),e===null)throw Error(st(387));i=t.pendingProps,s=t.memoizedState,n=s.element,rY(e,t),QE(t,i,null,r);var a=t.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=Tv(Error(st(423)),t),t=QV(e,t,i,r,n);break e}else if(i!==n){n=Tv(Error(st(424)),t),t=QV(e,t,i,r,n);break e}else for(ho=xh(t.stateNode.containerInfo.firstChild),vo=t,Mi=!0,Tl=null,r=aY(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ev(),i===n){t=rd(e,t,r);break e}ha(e,t,i,r)}t=t.child}return t;case 5:return oY(t),e===null&&SO(t),i=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,a=n.children,yO(i,n)?a=null:s!==null&&yO(i,s)&&(t.flags|=32),RY(e,t),ha(e,t,a,r),t.child;case 6:return e===null&&SO(t),null;case 13:return OY(e,t,r);case 4:return iz(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Cv(t,null,i,r):ha(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:_l(i,n),XV(e,t,i,n,r);case 7:return ha(e,t,t.pendingProps,r),t.child;case 8:return ha(e,t,t.pendingProps.children,r),t.child;case 12:return ha(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,gi(YE,i._currentValue),i._currentValue=a,s!==null)if(jl(s.value,a)){if(s.children===n.children&&!Ga.current){t=rd(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Wu(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),EO(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(st(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),EO(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ha(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,Qg(t,r),n=rl(n),i=i(n),t.flags|=1,ha(e,t,i,r),t.child;case 14:return i=t.type,n=_l(i,t.pendingProps),n=_l(i.type,n),YV(e,t,i,n,r);case 15:return PY(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:_l(i,n),ZS(e,t),t.tag=1,qa(i)?(e=!0,GE(t)):e=!1,Qg(t,r),nY(t,i,n),AO(t,i,n,r),PO(null,t,i,!0,e,r);case 19:return LY(e,t,r);case 22:return IY(e,t,r)}throw Error(st(156,t.tag))};function KY(e,t){return _X(e,t)}function Tde(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ko(e,t,r,i){return new Tde(e,t,r,i)}function yz(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Mde(e){if(typeof e=="function")return yz(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zk)return 11;if(e===Bk)return 14}return 2}function Eh(e,t){var r=e.alternate;return r===null?(r=Ko(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function tE(e,t,r,i,n,s){var a=2;if(i=e,typeof e=="function")yz(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Sg:return Jf(r.children,n,s,t);case kk:a=8,n|=8;break;case KD:return e=Ko(12,r,t,n|2),e.elementType=KD,e.lanes=s,e;case QD:return e=Ko(13,r,t,n),e.elementType=QD,e.lanes=s,e;case ZD:return e=Ko(19,r,t,n),e.elementType=ZD,e.lanes=s,e;case sX:return TT(r,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case iX:a=10;break e;case nX:a=9;break e;case zk:a=11;break e;case Bk:a=14;break e;case Vd:a=16,i=null;break e}throw Error(st(130,e==null?e:typeof e,""))}return t=Ko(a,r,t,n),t.elementType=e,t.type=i,t.lanes=s,t}function Jf(e,t,r,i){return e=Ko(7,e,i,t),e.lanes=r,e}function TT(e,t,r,i){return e=Ko(22,e,i,t),e.elementType=sX,e.lanes=r,e.stateNode={isHidden:!1},e}function RP(e,t,r){return e=Ko(6,e,null,t),e.lanes=r,e}function DP(e,t,r){return t=Ko(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Pde(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hP(0),this.expirationTimes=hP(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hP(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function bz(e,t,r,i,n,s,a,o,l){return e=new Pde(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ko(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},rz(s),e}function Ide(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_g,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function QY(e){if(!e)return Lh;e=e._reactInternals;e:{if(Hp(e)!==e||e.tag!==1)throw Error(st(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(st(171))}if(e.tag===1){var r=e.type;if(qa(r))return KX(e,r,t)}return t}function ZY(e,t,r,i,n,s,a,o,l){return e=bz(r,i,!0,e,n,s,a,o,l),e.context=QY(null),r=e.current,i=xa(),n=Sh(r),s=Wu(i,n),s.callback=t??null,wh(r,s,n),e.current.lanes=n,Ax(e,n,i),Xa(e,i),e}function MT(e,t,r,i){var n=t.current,s=xa(),a=Sh(n);return r=QY(r),t.context===null?t.context=r:t.pendingContext=r,t=Wu(s,a),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=wh(n,t,a),e!==null&&(kl(e,n,a,s),YS(e,n,a)),a}function sC(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function o5(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xz(e,t){o5(e,t),(e=e.alternate)&&o5(e,t)}function Rde(){return null}var JY=typeof reportError=="function"?reportError:function(e){console.error(e)};function wz(e){this._internalRoot=e}PT.prototype.render=wz.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(st(409));MT(e,t,null,null)};PT.prototype.unmount=wz.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;bp(function(){MT(null,e,null,null)}),t[ed]=null}};function PT(e){this._internalRoot=e}PT.prototype.unstable_scheduleHydration=function(e){if(e){var t=PX();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hd.length&&t!==0&&t<Hd[r].priority;r++);Hd.splice(r,0,e),r===0&&RX(e)}};function _z(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function IT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function l5(){}function Dde(e,t,r,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var c=sC(a);s.call(c)}}var a=ZY(t,i,e,0,null,!1,!1,"",l5);return e._reactRootContainer=a,e[ed]=a.current,gb(e.nodeType===8?e.parentNode:e),bp(),a}for(;n=e.lastChild;)e.removeChild(n);if(typeof i=="function"){var o=i;i=function(){var c=sC(l);o.call(c)}}var l=bz(e,0,!1,null,null,!1,!1,"",l5);return e._reactRootContainer=l,e[ed]=l.current,gb(e.nodeType===8?e.parentNode:e),bp(function(){MT(t,l,r,i)}),l}function RT(e,t,r,i,n){var s=r._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=sC(a);o.call(l)}}MT(t,a,e,n)}else a=Dde(r,t,e,n,i);return sC(a)}TX=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=e1(t.pendingLanes);r!==0&&(Vk(t,r|1),Xa(t,an()),!(kr&6)&&(Mv=an()+500,Gh()))}break;case 13:bp(function(){var i=td(e,1);if(i!==null){var n=xa();kl(i,e,1,n)}}),xz(e,1)}};Uk=function(e){if(e.tag===13){var t=td(e,134217728);if(t!==null){var r=xa();kl(t,e,134217728,r)}xz(e,134217728)}};MX=function(e){if(e.tag===13){var t=Sh(e),r=td(e,t);if(r!==null){var i=xa();kl(r,e,t,i)}xz(e,t)}};PX=function(){return ti};IX=function(e,t){var r=ti;try{return ti=e,t()}finally{ti=r}};lO=function(e,t,r){switch(t){case"input":if(tO(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=wT(i);if(!n)throw Error(st(90));oX(i),tO(i,n)}}}break;case"textarea":cX(e,r);break;case"select":t=r.value,t!=null&&qg(e,!!r.multiple,t,!1)}};gX=mz;vX=bp;var Ode={usingClientEntryPoint:!1,Events:[Mx,Tg,wT,pX,mX,mz]},sy={findFiberByHostInstance:Of,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Lde={bundleType:sy.bundleType,version:sy.version,rendererPackageName:sy.rendererPackageName,rendererConfig:sy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=xX(e),e===null?null:e.stateNode},findFiberByHostInstance:sy.findFiberByHostInstance||Rde,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yw.isDisabled&&Yw.supportsFiber)try{vT=Yw.inject(Lde),Nc=Yw}catch{}}Eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ode;Eo.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_z(t))throw Error(st(200));return Ide(e,t,null,r)};Eo.createRoot=function(e,t){if(!_z(e))throw Error(st(299));var r=!1,i="",n=JY;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=bz(e,1,!1,null,null,r,!1,i,n),e[ed]=t.current,gb(e.nodeType===8?e.parentNode:e),new wz(t)};Eo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(st(188)):(e=Object.keys(e).join(","),Error(st(268,e)));return e=xX(t),e=e===null?null:e.stateNode,e};Eo.flushSync=function(e){return bp(e)};Eo.hydrate=function(e,t,r){if(!IT(t))throw Error(st(200));return RT(null,e,t,!0,r)};Eo.hydrateRoot=function(e,t,r){if(!_z(e))throw Error(st(405));var i=r!=null&&r.hydratedSources||null,n=!1,s="",a=JY;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=ZY(t,null,e,1,r??null,n,!1,s,a),e[ed]=t.current,gb(e),i)for(e=0;e<i.length;e++)r=i[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new PT(t)};Eo.render=function(e,t,r){if(!IT(t))throw Error(st(200));return RT(null,e,t,!1,r)};Eo.unmountComponentAtNode=function(e){if(!IT(e))throw Error(st(40));return e._reactRootContainer?(bp(function(){RT(null,null,e,!1,function(){e._reactRootContainer=null,e[ed]=null})}),!0):!1};Eo.unstable_batchedUpdates=mz;Eo.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!IT(r))throw Error(st(200));if(e==null||e._reactInternals===void 0)throw Error(st(38));return RT(e,t,r,!1,i)};Eo.version="18.2.0-next-9e3b772b8-20220608";function eK(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eK)}catch(e){console.error(e)}}eK(),Zq.exports=Eo;var Vl=Zq.exports;const Lg=mT(Vl),Nde=Vq({__proto__:null,default:Lg},[Vl]);var c5=Vl;XD.createRoot=c5.createRoot,XD.hydrateRoot=c5.hydrateRoot;/**
 * @remix-run/router v1.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cb(){return Cb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Cb.apply(this,arguments)}var rh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(rh||(rh={}));const u5="popstate";function kde(e){e===void 0&&(e={});function t(i,n){let{pathname:s,search:a,hash:o}=i.location;return VO("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(i,n){return typeof n=="string"?n:tK(n)}return Bde(t,r,null,e)}function Fn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Sz(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function zde(){return Math.random().toString(36).substr(2,8)}function d5(e,t){return{usr:e.state,key:e.key,idx:t}}function VO(e,t,r,i){return r===void 0&&(r=null),Cb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?u0(t):t,{state:r,key:t&&t.key||i||zde()})}function tK(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function u0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function Bde(e,t,r,i){i===void 0&&(i={});let{window:n=document.defaultView,v5Compat:s=!1}=i,a=n.history,o=rh.Pop,l=null,c=d();c==null&&(c=0,a.replaceState(Cb({},a.state,{idx:c}),""));function d(){return(a.state||{idx:null}).idx}function u(){o=rh.Pop;let g=d(),v=g==null?null:g-c;c=g,l&&l({action:o,location:m.location,delta:v})}function h(g,v){o=rh.Push;let y=VO(m.location,g,v);r&&r(y,g),c=d()+1;let b=d5(y,c),x=m.createHref(y);try{a.pushState(b,"",x)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;n.location.assign(x)}s&&l&&l({action:o,location:m.location,delta:1})}function f(g,v){o=rh.Replace;let y=VO(m.location,g,v);r&&r(y,g),c=d();let b=d5(y,c),x=m.createHref(y);a.replaceState(b,"",x),s&&l&&l({action:o,location:m.location,delta:0})}function p(g){let v=n.location.origin!=="null"?n.location.origin:n.location.href,y=typeof g=="string"?g:tK(g);return Fn(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return o},get location(){return e(n,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(u5,u),l=g,()=>{n.removeEventListener(u5,u),l=null}},createHref(g){return t(n,g)},createURL:p,encodeLocation(g){let v=p(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:f,go(g){return a.go(g)}};return m}var h5;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(h5||(h5={}));function Fde(e,t,r){r===void 0&&(r="/");let i=typeof t=="string"?u0(t):t,n=nK(i.pathname||"/",r);if(n==null)return null;let s=rK(e);jde(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=Yde(s[o],Zde(n));return a}function rK(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Fn(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=ep([i,l.relativePath]),d=r.concat(l);s.children&&s.children.length>0&&(Fn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),rK(s.children,t,d,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:qde(c,s.index),routesMeta:d})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of iK(s.path))n(s,a,l)}),t}function iK(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(i.length===0)return n?[s,""]:[s];let a=iK(i.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function jde(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Xde(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const Vde=/^:\w+$/,Ude=3,$de=2,Hde=1,Wde=10,Gde=-2,f5=e=>e==="*";function qde(e,t){let r=e.split("/"),i=r.length;return r.some(f5)&&(i+=Gde),t&&(i+=$de),r.filter(n=>!f5(n)).reduce((n,s)=>n+(Vde.test(s)?Ude:s===""?Hde:Wde),i)}function Xde(e,t){return e.length===t.length&&e.slice(0,-1).every((i,n)=>i===t[n])?e[e.length-1]-t[t.length-1]:0}function Yde(e,t){let{routesMeta:r}=e,i={},n="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=n==="/"?t:t.slice(n.length)||"/",d=Kde({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!d)return null;Object.assign(i,d.params);let u=o.route;s.push({params:i,pathname:ep([n,d.pathname]),pathnameBase:she(ep([n,d.pathnameBase])),route:u}),d.pathnameBase!=="/"&&(n=ep([n,d.pathnameBase]))}return s}function Kde(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=Qde(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:i.reduce((c,d,u)=>{let{paramName:h,isOptional:f}=d;if(h==="*"){let m=o[u]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=o[u];return f&&!p?c[h]=void 0:c[h]=Jde(p||"",h),c},{}),pathname:s,pathnameBase:a,pattern:e}}function Qde(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Sz(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(a,o,l)=>(i.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),i]}function Zde(e){try{return decodeURI(e)}catch(t){return Sz(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Jde(e,t){try{return decodeURIComponent(e)}catch(r){return Sz(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function nK(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function ehe(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:n=""}=typeof e=="string"?u0(e):e;return{pathname:r?r.startsWith("/")?r:the(r,t):t,search:ahe(i),hash:ohe(n)}}function the(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function OP(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rhe(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ihe(e){return rhe(e).map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function nhe(e,t,r,i){i===void 0&&(i=!1);let n;typeof e=="string"?n=u0(e):(n=Cb({},e),Fn(!n.pathname||!n.pathname.includes("?"),OP("?","pathname","search",n)),Fn(!n.pathname||!n.pathname.includes("#"),OP("#","pathname","hash",n)),Fn(!n.search||!n.search.includes("#"),OP("#","search","hash",n)));let s=e===""||n.pathname==="",a=s?"/":n.pathname,o;if(a==null)o=r;else if(i){let u=t[t.length-1].replace(/^\//,"").split("/");if(a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),u.pop();n.pathname=h.join("/")}o="/"+u.join("/")}else{let u=t.length-1;if(a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),u-=1;n.pathname=h.join("/")}o=u>=0?t[u]:"/"}let l=ehe(n,o),c=a&&a!=="/"&&a.endsWith("/"),d=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}const ep=e=>e.join("/").replace(/\/\/+/g,"/"),she=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ahe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ohe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function lhe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const sK=["post","put","patch","delete"];new Set(sK);const che=["get",...sK];new Set(che);/**
 * React Router v6.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function aC(){return aC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},aC.apply(this,arguments)}const Ez=_.createContext(null),uhe=_.createContext(null),DT=_.createContext(null),OT=_.createContext(null),d0=_.createContext({outlet:null,matches:[],isDataRoute:!1}),aK=_.createContext(null);function LT(){return _.useContext(OT)!=null}function oK(){return LT()||Fn(!1),_.useContext(OT).location}function lK(e){_.useContext(DT).static||_.useLayoutEffect(e)}function Ix(){let{isDataRoute:e}=_.useContext(d0);return e?She():dhe()}function dhe(){LT()||Fn(!1);let e=_.useContext(Ez),{basename:t,navigator:r}=_.useContext(DT),{matches:i}=_.useContext(d0),{pathname:n}=oK(),s=JSON.stringify(ihe(i)),a=_.useRef(!1);return lK(()=>{a.current=!0}),_.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let d=nhe(l,JSON.parse(s),n,c.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ep([t,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[t,r,s,n,e])}function hhe(e,t){return fhe(e,t)}function fhe(e,t,r){LT()||Fn(!1);let{navigator:i}=_.useContext(DT),{matches:n}=_.useContext(d0),s=n[n.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=oK(),c;if(t){var d;let m=typeof t=="string"?u0(t):t;o==="/"||(d=m.pathname)!=null&&d.startsWith(o)||Fn(!1),c=m}else c=l;let u=c.pathname||"/",h=o==="/"?u:u.slice(o.length)||"/",f=Fde(e,{pathname:h}),p=yhe(f&&f.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:ep([o,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?o:ep([o,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),n,r);return t&&p?_.createElement(OT.Provider,{value:{location:aC({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:rh.Pop}},p):p}function phe(){let e=_he(),t=lhe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),r?_.createElement("pre",{style:n},r):null,s)}const mhe=_.createElement(phe,null);class ghe extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?_.createElement(d0.Provider,{value:this.props.routeContext},_.createElement(aK.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vhe(e){let{routeContext:t,match:r,children:i}=e,n=_.useContext(Ez);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),_.createElement(d0.Provider,{value:t},i)}function yhe(e,t,r){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var n;if((n=r)!=null&&n.errors)e=r.matches;else return null}let s=e,a=(i=r)==null?void 0:i.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||Fn(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let d=l.route.id?a==null?void 0:a[l.route.id]:null,u=null;r&&(u=l.route.errorElement||mhe);let h=t.concat(s.slice(0,c+1)),f=()=>{let p;return d?p=u:l.route.Component?p=_.createElement(l.route.Component,null):l.route.element?p=l.route.element:p=o,_.createElement(vhe,{match:l,routeContext:{outlet:o,matches:h,isDataRoute:r!=null},children:p})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?_.createElement(ghe,{location:r.location,revalidation:r.revalidation,component:u,error:d,children:f(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):f()},null)}var cK=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(cK||{}),oC=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(oC||{});function bhe(e){let t=_.useContext(Ez);return t||Fn(!1),t}function xhe(e){let t=_.useContext(uhe);return t||Fn(!1),t}function whe(e){let t=_.useContext(d0);return t||Fn(!1),t}function uK(e){let t=whe(),r=t.matches[t.matches.length-1];return r.route.id||Fn(!1),r.route.id}function _he(){var e;let t=_.useContext(aK),r=xhe(oC.UseRouteError),i=uK(oC.UseRouteError);return t||((e=r.errors)==null?void 0:e[i])}function She(){let{router:e}=bhe(cK.UseNavigateStable),t=uK(oC.UseNavigateStable),r=_.useRef(!1);return lK(()=>{r.current=!0}),_.useCallback(function(n,s){s===void 0&&(s={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,aC({fromRouteId:t},s)))},[e,t])}function jd(e){Fn(!1)}function Ehe(e){let{basename:t="/",children:r=null,location:i,navigationType:n=rh.Pop,navigator:s,static:a=!1}=e;LT()&&Fn(!1);let o=t.replace(/^\/*/,"/"),l=_.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof i=="string"&&(i=u0(i));let{pathname:c="/",search:d="",hash:u="",state:h=null,key:f="default"}=i,p=_.useMemo(()=>{let m=nK(c,o);return m==null?null:{location:{pathname:m,search:d,hash:u,state:h,key:f},navigationType:n}},[o,c,d,u,h,f,n]);return p==null?null:_.createElement(DT.Provider,{value:l},_.createElement(OT.Provider,{children:r,value:p}))}function Che(e){let{children:t,location:r}=e;return hhe(UO(t),r)}new Promise(()=>{});function UO(e,t){t===void 0&&(t=[]);let r=[];return _.Children.forEach(e,(i,n)=>{if(!_.isValidElement(i))return;let s=[...t,n];if(i.type===_.Fragment){r.push.apply(r,UO(i.props.children,s));return}i.type!==jd&&Fn(!1),!i.props.index||!i.props.children||Fn(!1);let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=UO(i.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Ahe="startTransition",p5=Zu[Ahe];function The(e){let{basename:t,children:r,future:i,window:n}=e,s=_.useRef();s.current==null&&(s.current=kde({window:n,v5Compat:!0}));let a=s.current,[o,l]=_.useState({action:a.action,location:a.location}),{v7_startTransition:c}=i||{},d=_.useCallback(u=>{c&&p5?p5(()=>l(u)):l(u)},[l,c]);return _.useLayoutEffect(()=>a.listen(d),[a,d]),_.createElement(Ehe,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a})}var m5;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(m5||(m5={}));var g5;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(g5||(g5={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dK=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=n&63|128):(n&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(e.charCodeAt(++i)&1023),t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=n&63|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=n&63|128)}return t},Mhe=function(e){const t=[];let r=0,i=0;for(;r<e.length;){const n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){const s=e[r++];t[i++]=String.fromCharCode((n&31)<<6|s&63)}else if(n>239&&n<365){const s=e[r++],a=e[r++],o=e[r++],l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[i++]=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63)}}return t.join("")},hK={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<e.length;n+=3){const s=e[n],a=n+1<e.length,o=a?e[n+1]:0,l=n+2<e.length,c=l?e[n+2]:0,d=s>>2,u=(s&3)<<4|o>>4;let h=(o&15)<<2|c>>6,f=c&63;l||(f=64,a||(h=64)),i.push(r[d],r[u],r[h],r[f])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(dK(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Mhe(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<e.length;){const s=r[e.charAt(n++)],o=n<e.length?r[e.charAt(n)]:0;++n;const c=n<e.length?r[e.charAt(n)]:64;++n;const u=n<e.length?r[e.charAt(n)]:64;if(++n,s==null||o==null||c==null||u==null)throw new Phe;const h=s<<2|o>>4;if(i.push(h),c!==64){const f=o<<4&240|c>>2;if(i.push(f),u!==64){const p=c<<6&192|u;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Phe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ihe=function(e){const t=dK(e);return hK.encodeByteArray(t,!0)},lC=function(e){return Ihe(e).replace(/\./g,"")},fK=function(e){try{return hK.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rhe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dhe=()=>Rhe().__FIREBASE_DEFAULTS__,Ohe=()=>{if(typeof process>"u"||typeof process.env>"u")return;const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Lhe=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&fK(e[1]);return t&&JSON.parse(t)},Cz=()=>{try{return Dhe()||Ohe()||Lhe()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},pK=e=>{var t,r;return(r=(t=Cz())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},mK=e=>{const t=pK(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),i]:[t.substring(0,r),i]},gK=()=>{var e;return(e=Cz())===null||e===void 0?void 0:e.config},vK=e=>{var t;return(t=Cz())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nhe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,i)=>{r?this.reject(r):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yK(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},i=t||"demo-project",n=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),o="";return[lC(JSON.stringify(r)),lC(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function khe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ta())}function zhe(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function Bhe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Fhe(){const e=ta();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function jhe(){try{return typeof indexedDB=="object"}catch{return!1}}function Vhe(){return new Promise((e,t)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var s;t(((s=n.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uhe="FirebaseError";class ru extends Error{constructor(t,r,i){super(r),this.code=t,this.customData=i,this.name=Uhe,Object.setPrototypeOf(this,ru.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rx.prototype.create)}}class Rx{constructor(t,r,i){this.service=t,this.serviceName=r,this.errors=i}create(t,...r){const i=r[0]||{},n=`${this.service}/${t}`,s=this.errors[t],a=s?$he(s,i):"Error",o=`${this.serviceName}: ${a} (${n}).`;return new ru(n,o,i)}}function $he(e,t){return e.replace(Hhe,(r,i)=>{const n=t[i];return n!=null?String(n):`<${i}?>`})}const Hhe=/\{\$([^}]+)}/g;function Whe(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function cC(e,t){if(e===t)return!0;const r=Object.keys(e),i=Object.keys(t);for(const n of r){if(!i.includes(n))return!1;const s=e[n],a=t[n];if(v5(s)&&v5(a)){if(!cC(s,a))return!1}else if(s!==a)return!1}for(const n of i)if(!r.includes(n))return!1;return!0}function v5(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(e){const t=[];for(const[r,i]of Object.entries(e))Array.isArray(i)?i.forEach(n=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function r1(e){const t={};return e.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[n,s]=i.split("=");t[decodeURIComponent(n)]=decodeURIComponent(s)}}),t}function i1(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function Ghe(e,t){const r=new qhe(e,t);return r.subscribe.bind(r)}class qhe{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,i){let n;if(t===void 0&&r===void 0&&i===void 0)throw new Error("Missing Observer.");Xhe(t,["next","error","complete"])?n=t:n={next:t,error:r,complete:i},n.next===void 0&&(n.next=LP),n.error===void 0&&(n.error=LP),n.complete===void 0&&(n.complete=LP);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch{}}),this.observers.push(n),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Xhe(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function LP(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(e){return e&&e._delegate?e._delegate:e}class Nh{constructor(t,r,i){this.name=t,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yhe{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const i=new Nhe;if(this.instancesDeferred.set(r,i),this.isInitialized(r)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:r});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),n=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Qhe(t))try{this.getOrInitializeService({instanceIdentifier:vf})}catch{}for(const[r,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:n});i.resolve(s)}catch{}}}}clearInstance(t=vf){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=vf){return this.instances.has(t)}getOptions(t=vf){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);i===o&&a.resolve(n)}return n}onInit(t,r){var i;const n=this.normalizeInstanceIdentifier(r),s=(i=this.onInitCallbacks.get(n))!==null&&i!==void 0?i:new Set;s.add(t),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&t(a,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const i=this.onInitCallbacks.get(r);if(i)for(const n of i)try{n(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Khe(t),options:r}),this.instances.set(t,i),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=vf){return this.component?this.component.multipleInstances?t:vf:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Khe(e){return e===vf?void 0:e}function Qhe(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zhe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Yhe(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ir;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ir||(Ir={}));const Jhe={debug:Ir.DEBUG,verbose:Ir.VERBOSE,info:Ir.INFO,warn:Ir.WARN,error:Ir.ERROR,silent:Ir.SILENT},efe=Ir.INFO,tfe={[Ir.DEBUG]:"log",[Ir.VERBOSE]:"log",[Ir.INFO]:"info",[Ir.WARN]:"warn",[Ir.ERROR]:"error"},rfe=(e,t,...r)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),n=tfe[t];if(n)console[n](`[${i}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Az{constructor(t){this.name=t,this._logLevel=efe,this._logHandler=rfe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ir))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Jhe[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ir.DEBUG,...t),this._logHandler(this,Ir.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ir.VERBOSE,...t),this._logHandler(this,Ir.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ir.INFO,...t),this._logHandler(this,Ir.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ir.WARN,...t),this._logHandler(this,Ir.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ir.ERROR,...t),this._logHandler(this,Ir.ERROR,...t)}}const ife=(e,t)=>t.some(r=>e instanceof r);let y5,b5;function nfe(){return y5||(y5=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sfe(){return b5||(b5=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bK=new WeakMap,$O=new WeakMap,xK=new WeakMap,NP=new WeakMap,Tz=new WeakMap;function afe(e){const t=new Promise((r,i)=>{const n=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(Ch(e.result)),n()},a=()=>{i(e.error),n()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&bK.set(r,e)}).catch(()=>{}),Tz.set(t,e),t}function ofe(e){if($O.has(e))return;const t=new Promise((r,i)=>{const n=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),n()},a=()=>{i(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});$O.set(e,t)}let HO={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return $O.get(e);if(t==="objectStoreNames")return e.objectStoreNames||xK.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ch(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function lfe(e){HO=e(HO)}function cfe(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const i=e.call(kP(this),t,...r);return xK.set(i,t.sort?t.sort():[t]),Ch(i)}:sfe().includes(e)?function(...t){return e.apply(kP(this),t),Ch(bK.get(this))}:function(...t){return Ch(e.apply(kP(this),t))}}function ufe(e){return typeof e=="function"?cfe(e):(e instanceof IDBTransaction&&ofe(e),ife(e,nfe())?new Proxy(e,HO):e)}function Ch(e){if(e instanceof IDBRequest)return afe(e);if(NP.has(e))return NP.get(e);const t=ufe(e);return t!==e&&(NP.set(e,t),Tz.set(t,e)),t}const kP=e=>Tz.get(e);function dfe(e,t,{blocked:r,upgrade:i,blocking:n,terminated:s}={}){const a=indexedDB.open(e,t),o=Ch(a);return i&&a.addEventListener("upgradeneeded",l=>{i(Ch(a.result),l.oldVersion,l.newVersion,Ch(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),n&&l.addEventListener("versionchange",c=>n(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const hfe=["get","getKey","getAll","getAllKeys","count"],ffe=["put","add","delete","clear"],zP=new Map;function x5(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(zP.get(t))return zP.get(t);const r=t.replace(/FromIndex$/,""),i=t!==r,n=ffe.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||hfe.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,n?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),n&&l.done]))[0]};return zP.set(t,s),s}lfe(e=>({...e,get:(t,r,i)=>x5(t,r)||e.get(t,r,i),has:(t,r)=>!!x5(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pfe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(mfe(r)){const i=r.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(r=>r).join(" ")}}function mfe(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const WO="@firebase/app",w5="0.9.25";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=new Az("@firebase/app"),gfe="@firebase/app-compat",vfe="@firebase/analytics-compat",yfe="@firebase/analytics",bfe="@firebase/app-check-compat",xfe="@firebase/app-check",wfe="@firebase/auth",_fe="@firebase/auth-compat",Sfe="@firebase/database",Efe="@firebase/database-compat",Cfe="@firebase/functions",Afe="@firebase/functions-compat",Tfe="@firebase/installations",Mfe="@firebase/installations-compat",Pfe="@firebase/messaging",Ife="@firebase/messaging-compat",Rfe="@firebase/performance",Dfe="@firebase/performance-compat",Ofe="@firebase/remote-config",Lfe="@firebase/remote-config-compat",Nfe="@firebase/storage",kfe="@firebase/storage-compat",zfe="@firebase/firestore",Bfe="@firebase/firestore-compat",Ffe="firebase",jfe="10.7.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO="[DEFAULT]",Vfe={[WO]:"fire-core",[gfe]:"fire-core-compat",[yfe]:"fire-analytics",[vfe]:"fire-analytics-compat",[xfe]:"fire-app-check",[bfe]:"fire-app-check-compat",[wfe]:"fire-auth",[_fe]:"fire-auth-compat",[Sfe]:"fire-rtdb",[Efe]:"fire-rtdb-compat",[Cfe]:"fire-fn",[Afe]:"fire-fn-compat",[Tfe]:"fire-iid",[Mfe]:"fire-iid-compat",[Pfe]:"fire-fcm",[Ife]:"fire-fcm-compat",[Rfe]:"fire-perf",[Dfe]:"fire-perf-compat",[Ofe]:"fire-rc",[Lfe]:"fire-rc-compat",[Nfe]:"fire-gcs",[kfe]:"fire-gcs-compat",[zfe]:"fire-fst",[Bfe]:"fire-fst-compat","fire-js":"fire-js",[Ffe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=new Map,qO=new Map;function Ufe(e,t){try{e.container.addComponent(t)}catch(r){xp.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function wp(e){const t=e.name;if(qO.has(t))return xp.debug(`There were multiple attempts to register component ${t}.`),!1;qO.set(t,e);for(const r of uC.values())Ufe(r,e);return!0}function NT(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $fe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ah=new Rx("app","Firebase",$fe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hfe{constructor(t,r,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Nh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ah.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp=jfe;function wK(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:GO,automaticDataCollectionEnabled:!1},t),n=i.name;if(typeof n!="string"||!n)throw Ah.create("bad-app-name",{appName:String(n)});if(r||(r=gK()),!r)throw Ah.create("no-options");const s=uC.get(n);if(s){if(cC(r,s.options)&&cC(i,s.config))return s;throw Ah.create("duplicate-app",{appName:n})}const a=new Zhe(n);for(const l of qO.values())a.addComponent(l);const o=new Hfe(r,i,a);return uC.set(n,o),o}function Mz(e=GO){const t=uC.get(e);if(!t&&e===GO&&gK())return wK();if(!t)throw Ah.create("no-app",{appName:e});return t}function zc(e,t,r){var i;let n=(i=Vfe[e])!==null&&i!==void 0?i:e;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${n}" with version "${t}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),xp.warn(o.join(" "));return}wp(new Nh(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wfe="firebase-heartbeat-database",Gfe=1,Ab="firebase-heartbeat-store";let BP=null;function _K(){return BP||(BP=dfe(Wfe,Gfe,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Ab)}}}).catch(e=>{throw Ah.create("idb-open",{originalErrorMessage:e.message})})),BP}async function qfe(e){try{return await(await _K()).transaction(Ab).objectStore(Ab).get(SK(e))}catch(t){if(t instanceof ru)xp.warn(t.message);else{const r=Ah.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});xp.warn(r.message)}}}async function _5(e,t){try{const i=(await _K()).transaction(Ab,"readwrite");await i.objectStore(Ab).put(t,SK(e)),await i.done}catch(r){if(r instanceof ru)xp.warn(r.message);else{const i=Ah.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});xp.warn(i.message)}}}function SK(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xfe=1024,Yfe=30*24*60*60*1e3;class Kfe{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Zfe(r),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,r;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=S5();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=Yfe}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=S5(),{heartbeatsToSend:i,unsentEntries:n}=Qfe(this._heartbeatsCache.heartbeats),s=lC(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=r,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function S5(){return new Date().toISOString().substring(0,10)}function Qfe(e,t=Xfe){const r=[];let i=e.slice();for(const n of e){const s=r.find(a=>a.agent===n.agent);if(s){if(s.dates.push(n.date),E5(r)>t){s.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),E5(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class Zfe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jhe()?Vhe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await qfe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return _5(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return _5(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function E5(e){return lC(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jfe(e){wp(new Nh("platform-logger",t=>new pfe(t),"PRIVATE")),wp(new Nh("heartbeat",t=>new Kfe(t),"PRIVATE")),zc(WO,w5,e),zc(WO,w5,"esm2017"),zc("fire-js","")}Jfe("");var epe="firebase",tpe="10.7.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zc(epe,tpe,"app");function Pz(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function EK(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rpe=EK,CK=new Rx("auth","Firebase",EK());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=new Az("@firebase/auth");function ipe(e,...t){dC.logLevel<=Ir.WARN&&dC.warn(`Auth (${Wp}): ${e}`,...t)}function rE(e,...t){dC.logLevel<=Ir.ERROR&&dC.error(`Auth (${Wp}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(e,...t){throw Iz(e,...t)}function Bc(e,...t){return Iz(e,...t)}function npe(e,t,r){const i=Object.assign(Object.assign({},rpe()),{[t]:r});return new Rx("auth","Firebase",i).create(t,{appName:e.name})}function Iz(e,...t){if(typeof e!="string"){const r=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(r,...i)}return CK.create(e,...t)}function tr(e,t,...r){if(!e)throw Iz(t,...r)}function Bu(e){const t="INTERNAL ASSERTION FAILED: "+e;throw rE(t),new Error(t)}function id(e,t){e||Bu(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function spe(){return C5()==="http:"||C5()==="https:"}function C5(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ape(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(spe()||zhe()||"connection"in navigator)?navigator.onLine:!0}function ope(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(t,r){this.shortDelay=t,this.longDelay=r,id(r>t,"Short delay should be less than long delay!"),this.isMobile=khe()||Bhe()}get(){return ape()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rz(e,t){id(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AK{static initialize(t,r,i){this.fetchImpl=t,r&&(this.headersImpl=r),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cpe=new Ox(3e4,6e4);function qh(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Xh(e,t,r,i,n={}){return TK(e,n,async()=>{let s={},a={};i&&(t==="GET"?a=i:s={body:JSON.stringify(i)});const o=Dx(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),AK.fetch()(MK(e,e.config.apiHost,r,o),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function TK(e,t,r){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},lpe),t);try{const n=new dpe(e),s=await Promise.race([r(),n.promise]);n.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Kw(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kw(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Kw(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw Kw(e,"user-disabled",a);const d=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw npe(e,d,c);Ul(e,d)}}catch(n){if(n instanceof ru)throw n;Ul(e,"network-request-failed",{message:String(n)})}}async function Lx(e,t,r,i,n={}){const s=await Xh(e,t,r,i,n);return"mfaPendingCredential"in s&&Ul(e,"multi-factor-auth-required",{_serverResponse:s}),s}function MK(e,t,r,i){const n=`${t}${r}?${i}`;return e.config.emulator?Rz(e.config,n):`${e.config.apiScheme}://${n}`}function upe(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dpe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,i)=>{this.timer=setTimeout(()=>i(Bc(this.auth,"network-request-failed")),cpe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Kw(e,t,r){const i={appName:e.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);const n=Bc(e,t,i);return n.customData._tokenResponse=r,n}function A5(e){return e!==void 0&&e.enterprise!==void 0}class hpe{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===t)return upe(r.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}}async function fpe(e,t){return Xh(e,"GET","/v2/recaptchaConfig",qh(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ppe(e,t){return Xh(e,"POST","/v1/accounts:delete",t)}async function mpe(e,t){return Xh(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function gpe(e,t=!1){const r=Rs(e),i=await r.getIdToken(t),n=Dz(i);tr(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");const s=typeof n.firebase=="object"?n.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:n,token:i,authTime:R1(FP(n.auth_time)),issuedAtTime:R1(FP(n.iat)),expirationTime:R1(FP(n.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function FP(e){return Number(e)*1e3}function Dz(e){const[t,r,i]=e.split(".");if(t===void 0||r===void 0||i===void 0)return rE("JWT malformed, contained fewer than 3 sections"),null;try{const n=fK(r);return n?JSON.parse(n):(rE("Failed to decode base64 JWT payload"),null)}catch(n){return rE("Caught error parsing JWT payload as JSON",n==null?void 0:n.toString()),null}}function vpe(e){const t=Dz(e);return tr(t,"internal-error"),tr(typeof t.exp<"u","internal-error"),tr(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(e,t,r=!1){if(r)return t;try{return await t}catch(i){throw i instanceof ru&&ype(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function ype({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bpe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const n=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PK{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=R1(this.lastLoginAt),this.creationTime=R1(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hC(e){var t;const r=e.auth,i=await e.getIdToken(),n=await Tb(e,mpe(r,{idToken:i}));tr(n==null?void 0:n.users.length,r,"internal-error");const s=n.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?_pe(s.providerUserInfo):[],o=wpe(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new PK(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,u)}async function xpe(e){const t=Rs(e);await hC(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function wpe(e,t){return[...e.filter(i=>!t.some(n=>n.providerId===i.providerId)),...t]}function _pe(e){return e.map(t=>{var{providerId:r}=t,i=Pz(t,["providerId"]);return{providerId:r,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Spe(e,t){const r=await TK(e,{},async()=>{const i=Dx({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:s}=e.config,a=MK(e,n,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",AK.fetch()(a,{method:"POST",headers:o,body:i})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Epe(e,t){return Xh(e,"POST","/v2/accounts:revokeToken",qh(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){tr(t.idToken,"internal-error"),tr(typeof t.idToken<"u","internal-error"),tr(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):vpe(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}async getToken(t,r=!1){return tr(!this.accessToken||this.refreshToken,t,"user-token-expired"),!r&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:i,refreshToken:n,expiresIn:s}=await Spe(t,r);this.updateTokensAndExpiration(i,n,Number(s))}updateTokensAndExpiration(t,r,i){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,r){const{refreshToken:i,accessToken:n,expirationTime:s}=r,a=new Mb;return i&&(tr(typeof i=="string","internal-error",{appName:t}),a.refreshToken=i),n&&(tr(typeof n=="string","internal-error",{appName:t}),a.accessToken=n),s&&(tr(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Mb,this.toJSON())}_performRefresh(){return Bu("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(e,t){tr(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class tp{constructor(t){var{uid:r,auth:i,stsTokenManager:n}=t,s=Pz(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bpe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new PK(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await Tb(this,this.stsTokenManager.getToken(this.auth,t));return tr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return gpe(this,t)}reload(){return xpe(this)}_assign(t){this!==t&&(tr(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new tp(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){tr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),r&&await hC(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Tb(this,ppe(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var i,n,s,a,o,l,c,d;const u=(i=r.displayName)!==null&&i!==void 0?i:void 0,h=(n=r.email)!==null&&n!==void 0?n:void 0,f=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,p=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,g=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,v=(c=r.createdAt)!==null&&c!==void 0?c:void 0,y=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:x,isAnonymous:S,providerData:w,stsTokenManager:E}=r;tr(b&&E,t,"internal-error");const C=Mb.fromJSON(this.name,E);tr(typeof b=="string",t,"internal-error"),_d(u,t.name),_d(h,t.name),tr(typeof x=="boolean",t,"internal-error"),tr(typeof S=="boolean",t,"internal-error"),_d(f,t.name),_d(p,t.name),_d(m,t.name),_d(g,t.name),_d(v,t.name),_d(y,t.name);const T=new tp({uid:b,auth:t,email:h,emailVerified:x,displayName:u,isAnonymous:S,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:C,createdAt:v,lastLoginAt:y});return w&&Array.isArray(w)&&(T.providerData=w.map(A=>Object.assign({},A))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(t,r,i=!1){const n=new Mb;n.updateFromServerResponse(r);const s=new tp({uid:r.localId,auth:t,stsTokenManager:n,isAnonymous:i});return await hC(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T5=new Map;function Fu(e){id(e instanceof Function,"Expected a class definition");let t=T5.get(e);return t?(id(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,T5.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IK{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}IK.type="NONE";const M5=IK;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(e,t,r){return`firebase:${e}:${t}:${r}`}class Jg{constructor(t,r,i){this.persistence=t,this.auth=r,this.userKey=i;const{config:n,name:s}=this.auth;this.fullUserKey=iE(this.userKey,n.apiKey,s),this.fullPersistenceKey=iE("persistence",n.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?tp._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,i="authUser"){if(!r.length)return new Jg(Fu(M5),t,i);const n=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=n[0]||Fu(M5);const a=iE(i,t.config.apiKey,t.name);let o=null;for(const c of r)try{const d=await c._get(a);if(d){const u=tp._fromJSON(t,d);c!==s&&(o=u),s=c;break}}catch{}const l=n.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Jg(s,t,i):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Jg(s,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(OK(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(RK(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(NK(t))return"Blackberry";if(kK(t))return"Webos";if(Oz(t))return"Safari";if((t.includes("chrome/")||DK(t))&&!t.includes("edge/"))return"Chrome";if(LK(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(r);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function RK(e=ta()){return/firefox\//i.test(e)}function Oz(e=ta()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function DK(e=ta()){return/crios\//i.test(e)}function OK(e=ta()){return/iemobile/i.test(e)}function LK(e=ta()){return/android/i.test(e)}function NK(e=ta()){return/blackberry/i.test(e)}function kK(e=ta()){return/webos/i.test(e)}function kT(e=ta()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Cpe(e=ta()){var t;return kT(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function Ape(){return Fhe()&&document.documentMode===10}function zK(e=ta()){return kT(e)||LK(e)||kK(e)||NK(e)||/windows phone/i.test(e)||OK(e)}function Tpe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BK(e,t=[]){let r;switch(e){case"Browser":r=P5(ta());break;case"Worker":r=`${P5(ta())}-${e}`;break;default:r=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${Wp}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mpe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const i=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});i.onAbort=r,this.queue.push(i);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const i of this.queue)await i(t),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const n of r)try{n()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ppe(e,t={}){return Xh(e,"GET","/v2/passwordPolicy",qh(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ipe=6;class Rpe{constructor(t){var r,i,n,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Ipe,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(n=(i=t.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&n!==void 0?n:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,i,n,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(n=l.containsLowercaseLetter)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const i=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;i&&(r.meetsMinPasswordLength=t.length>=i),n&&(r.meetsMaxPasswordLength=t.length<=n)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let i;for(let n=0;n<t.length;n++)i=t.charAt(n),this.updatePasswordCharacterOptionsStatuses(r,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,r,i,n,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dpe{constructor(t,r,i,n){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new I5(this),this.idTokenSubscription=new I5(this),this.beforeStateQueue=new Mpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CK,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Fu(r)),this._initializationPromise=this.queue(async()=>{var i,n;if(!this._deleted&&(this.persistenceManager=await Jg.create(this,t),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((n=this.currentUser)===null||n===void 0?void 0:n.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUser(t){var r;const i=await this.assertedPersistence.getCurrentUser();let n=i,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return tr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await hC(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=ope()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const r=t?Rs(t):null;return r&&tr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&tr(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Fu(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await Ppe(this),r=new Rpe(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Rx("auth","Firebase",t())}onAuthStateChanged(t,r,i){return this.registerStateListener(this.authStateSubscription,t,r,i)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,i){return this.registerStateListener(this.idTokenSubscription,t,r,i)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(i.tenantId=this.tenantId),await Epe(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const i=await this.getOrInitRedirectPersistenceManager(r);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Fu(t)||this._popupRedirectResolver;tr(r,this,"argument-error"),this.redirectPersistenceManager=await Jg.create(this,[Fu(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,i;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,i,n){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(tr(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,i,n);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return tr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=BK(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const i=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());i&&(r["X-Firebase-Client"]=i);const n=await this._getAppCheckToken();return n&&(r["X-Firebase-AppCheck"]=n),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&ipe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Gp(e){return Rs(e)}class I5{constructor(t){this.auth=t,this.observer=null,this.addObserver=Ghe(r=>this.observer=r)}get next(){return tr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ope(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}function FK(e){return new Promise((t,r)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=n=>{const s=Bc("internal-error");s.customData=n,r(s)},i.type="text/javascript",i.charset="UTF-8",Ope().appendChild(i)})}function Lpe(e){return`__${e}${Math.floor(Math.random()*1e6)}`}const Npe="https://www.google.com/recaptcha/enterprise.js?render=",kpe="recaptcha-enterprise",zpe="NO_RECAPTCHA";class Bpe{constructor(t){this.type=kpe,this.auth=Gp(t)}async verify(t="verify",r=!1){async function i(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{fpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new hpe(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function n(s,a,o){const l=window.grecaptcha;A5(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:t}).then(c=>{a(c)}).catch(()=>{a(zpe)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{i(this.auth).then(o=>{if(!r&&A5(window.grecaptcha))n(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}FK(Npe+o).then(()=>{n(o,s,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function R5(e,t,r,i=!1){const n=new Bpe(e);let s;try{s=await n.verify(r)}catch{s=await n.verify(r,!0)}const a=Object.assign({},t);return i?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function YO(e,t,r,i){var n;if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await R5(e,t,r,r==="getOobCode");return i(e,s)}else return i(e,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await R5(e,t,r,r==="getOobCode");return i(e,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fpe(e,t){const r=NT(e,"auth");if(r.isInitialized()){const n=r.getImmediate(),s=r.getOptions();if(cC(s,t??{}))return n;Ul(n,"already-initialized")}return r.initialize({options:t})}function jpe(e,t){const r=(t==null?void 0:t.persistence)||[],i=(Array.isArray(r)?r:[r]).map(Fu);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function Vpe(e,t,r){const i=Gp(e);tr(i._canInitEmulator,i,"emulator-config-failed"),tr(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const n=!!(r!=null&&r.disableWarnings),s=jK(t),{host:a,port:o}=Upe(t),l=o===null?"":`:${o}`;i.config.emulator={url:`${s}//${a}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:n})}),n||$pe()}function jK(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Upe(e){const t=jK(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const i=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(i);if(n){const s=n[1];return{host:s,port:D5(i.substr(s.length+1))}}else{const[s,a]=i.split(":");return{host:s,port:D5(a)}}}function D5(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function $pe(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return Bu("not implemented")}_getIdTokenResponse(t){return Bu("not implemented")}_linkToIdToken(t,r){return Bu("not implemented")}_getReauthenticationResolver(t){return Bu("not implemented")}}async function Hpe(e,t){return Xh(e,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wpe(e,t){return Lx(e,"POST","/v1/accounts:signInWithPassword",qh(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gpe(e,t){return Lx(e,"POST","/v1/accounts:signInWithEmailLink",qh(e,t))}async function qpe(e,t){return Lx(e,"POST","/v1/accounts:signInWithEmailLink",qh(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb extends Lz{constructor(t,r,i,n=null){super("password",i),this._email=t,this._password=r,this._tenantId=n}static _fromEmailAndPassword(t,r){return new Pb(t,r,"password")}static _fromEmailAndCode(t,r,i=null){return new Pb(t,r,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return YO(t,r,"signInWithPassword",Wpe);case"emailLink":return Gpe(t,{email:this._email,oobCode:this._password});default:Ul(t,"internal-error")}}async _linkToIdToken(t,r){switch(this.signInMethod){case"password":const i={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return YO(t,i,"signUpPassword",Hpe);case"emailLink":return qpe(t,{idToken:r,email:this._email,oobCode:this._password});default:Ul(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ev(e,t){return Lx(e,"POST","/v1/accounts:signInWithIdp",qh(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xpe="http://localhost";class _p extends Lz{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new _p(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Ul("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:n}=r,s=Pz(r,["providerId","signInMethod"]);if(!i||!n)return null;const a=new _p(i,n);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return ev(t,r)}_linkToIdToken(t,r){const i=this.buildRequest();return i.idToken=r,ev(t,i)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,ev(t,r)}buildRequest(){const t={requestUri:Xpe,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Dx(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ype(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Kpe(e){const t=r1(i1(e)).link,r=t?r1(i1(t)).deep_link_id:null,i=r1(i1(e)).deep_link_id;return(i?r1(i1(i)).link:null)||i||r||t||e}class Nz{constructor(t){var r,i,n,s,a,o;const l=r1(i1(t)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,d=(i=l.oobCode)!==null&&i!==void 0?i:null,u=Ype((n=l.mode)!==null&&n!==void 0?n:null);tr(c&&d&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(t){const r=Kpe(t);try{return new Nz(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(){this.providerId=h0.PROVIDER_ID}static credential(t,r){return Pb._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const i=Nz.parseLink(r);return tr(i,"argument-error"),Pb._fromEmailAndCode(t,i.code,i.tenantId)}}h0.PROVIDER_ID="password";h0.EMAIL_PASSWORD_SIGN_IN_METHOD="password";h0.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VK{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx extends VK{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd extends Nx{constructor(){super("facebook.com")}static credential(t){return _p._fromParams({providerId:Gd.PROVIDER_ID,signInMethod:Gd.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Gd.credentialFromTaggedObject(t)}static credentialFromError(t){return Gd.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Gd.credential(t.oauthAccessToken)}catch{return null}}}Gd.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gd.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd extends Nx{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return _p._fromParams({providerId:qd.PROVIDER_ID,signInMethod:qd.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return qd.credentialFromTaggedObject(t)}static credentialFromError(t){return qd.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return qd.credential(r,i)}catch{return null}}}qd.GOOGLE_SIGN_IN_METHOD="google.com";qd.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends Nx{constructor(){super("github.com")}static credential(t){return _p._fromParams({providerId:Xd.PROVIDER_ID,signInMethod:Xd.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Xd.credentialFromTaggedObject(t)}static credentialFromError(t){return Xd.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Xd.credential(t.oauthAccessToken)}catch{return null}}}Xd.GITHUB_SIGN_IN_METHOD="github.com";Xd.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd extends Nx{constructor(){super("twitter.com")}static credential(t,r){return _p._fromParams({providerId:Yd.PROVIDER_ID,signInMethod:Yd.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Yd.credentialFromTaggedObject(t)}static credentialFromError(t){return Yd.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return Yd.credential(r,i)}catch{return null}}}Yd.TWITTER_SIGN_IN_METHOD="twitter.com";Yd.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qpe(e,t){return Lx(e,"POST","/v1/accounts:signUp",qh(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,i,n=!1){const s=await tp._fromIdTokenResponse(t,i,n),a=O5(i);return new Sp({user:s,providerId:a,_tokenResponse:i,operationType:r})}static async _forOperation(t,r,i){await t._updateTokensIfNecessary(i,!0);const n=O5(i);return new Sp({user:t,providerId:n,_tokenResponse:i,operationType:r})}}function O5(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC extends ru{constructor(t,r,i,n){var s;super(r.code,r.message),this.operationType=i,this.user=n,Object.setPrototypeOf(this,fC.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,r,i,n){return new fC(t,r,i,n)}}function UK(e,t,r,i){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fC._fromErrorAndOperation(e,s,t,i):s})}async function Zpe(e,t,r=!1){const i=await Tb(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return Sp._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jpe(e,t,r=!1){const{auth:i}=e,n="reauthenticate";try{const s=await Tb(e,UK(i,n,t,e),r);tr(s.idToken,i,"internal-error");const a=Dz(s.idToken);tr(a,i,"internal-error");const{sub:o}=a;return tr(e.uid===o,i,"user-mismatch"),Sp._forOperation(e,n,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ul(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $K(e,t,r=!1){const i="signIn",n=await UK(e,i,t),s=await Sp._fromIdTokenResponse(e,i,n);return r||await e._updateCurrentUser(s.user),s}async function eme(e,t){return $K(Gp(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HK(e){const t=Gp(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function tme(e,t,r){const i=Gp(e),a=await YO(i,{returnSecureToken:!0,email:t,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Qpe).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&HK(e),l}),o=await Sp._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(o.user),o}function rme(e,t,r){return eme(Rs(e),h0.credential(t,r)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&HK(e),i})}function ime(e,t,r,i){return Rs(e).onIdTokenChanged(t,r,i)}function nme(e,t,r){return Rs(e).beforeAuthStateChanged(t,r)}const pC="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WK{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(pC,"1"),this.storage.removeItem(pC),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sme(){const e=ta();return Oz(e)||kT(e)}const ame=1e3,ome=10;class GK extends WK{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=sme()&&Tpe(),this.fallbackToPolling=zK(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),n=this.localCache[r];i!==n&&t(r,n,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}const n=()=>{const a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);Ape()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(n,ome):n()}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const n of Array.from(i))n(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},ame)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}GK.type="LOCAL";const lme=GK;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qK extends WK{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}qK.type="SESSION";const XK=qK;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cme(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(n=>n.isListeningto(t));if(r)return r;const i=new zT(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:i,eventType:n,data:s}=r.data,a=this.handlersMap[n];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:n});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await cme(o);r.ports[0].postMessage({status:"done",eventId:i,eventType:n,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zT.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kz(e="",t=10){let r="";for(let i=0;i<t;i++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ume{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,i=50){const n=typeof MessageChannel<"u"?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=kz("",20);n.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},i);a={messageChannel:n,onMessage(u){const h=u;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(h.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),n.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[n.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(){return window}function dme(e){Fc().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YK(){return typeof Fc().WorkerGlobalScope<"u"&&typeof Fc().importScripts=="function"}async function hme(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fme(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function pme(){return YK()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KK="firebaseLocalStorageDb",mme=1,mC="firebaseLocalStorage",QK="fbase_key";class kx{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function BT(e,t){return e.transaction([mC],t?"readwrite":"readonly").objectStore(mC)}function gme(){const e=indexedDB.deleteDatabase(KK);return new kx(e).toPromise()}function KO(){const e=indexedDB.open(KK,mme);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore(mC,{keyPath:QK})}catch(n){r(n)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains(mC)?t(i):(i.close(),await gme(),t(await KO()))})})}async function L5(e,t,r){const i=BT(e,!0).put({[QK]:t,value:r});return new kx(i).toPromise()}async function vme(e,t){const r=BT(e,!1).get(t),i=await new kx(r).toPromise();return i===void 0?null:i.value}function N5(e,t){const r=BT(e,!0).delete(t);return new kx(r).toPromise()}const yme=800,bme=3;class ZK{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await KO(),this.db)}async _withRetries(t){let r=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(r++>bme)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return YK()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zT._getInstance(pme()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await hme(),!this.activeServiceWorker)return;this.sender=new ume(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||fme()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await KO();return await L5(t,pC,"1"),await N5(t,pC),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>L5(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(i=>vme(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>N5(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(n=>{const s=BT(n,!1).getAll();return new kx(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],i=new Set;if(t.length!==0)for(const{fbase_key:n,value:s}of t)i.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(s)&&(this.notifyListeners(n,s),r.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!i.has(n)&&(this.notifyListeners(n,null),r.push(n));return r}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const n of Array.from(i))n(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yme)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ZK.type="LOCAL";const xme=ZK;new Ox(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wme(e,t){return t?Fu(t):(tr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz extends Lz{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ev(t,this._buildIdpRequest())}_linkToIdToken(t,r){return ev(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return ev(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function _me(e){return $K(e.auth,new zz(e),e.bypassAuthState)}function Sme(e){const{auth:t,user:r}=e;return tr(r,t,"internal-error"),Jpe(r,new zz(e),e.bypassAuthState)}async function Eme(e){const{auth:t,user:r}=e;return tr(r,t,"internal-error"),Zpe(r,new zz(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JK{constructor(t,r,i,n,s=!1){this.auth=t,this.resolver=i,this.user=n,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:i,postBody:n,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:i,tenantId:s||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return _me;case"linkViaPopup":case"linkViaRedirect":return Eme;case"reauthViaPopup":case"reauthViaRedirect":return Sme;default:Ul(this.auth,"internal-error")}}resolve(t){id(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){id(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cme=new Ox(2e3,1e4);class Ng extends JK{constructor(t,r,i,n,s){super(t,r,n,s),this.provider=i,this.authWindow=null,this.pollId=null,Ng.currentPopupAction&&Ng.currentPopupAction.cancel(),Ng.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return tr(t,this.auth,"internal-error"),t}async onExecution(){id(this.filter.length===1,"Popup operations only handle one event");const t=kz();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Bc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Bc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ng.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Cme.get())};t()}}Ng.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ame="pendingRedirect",nE=new Map;class Tme extends JK{constructor(t,r,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i),this.eventId=null}async execute(){let t=nE.get(this.auth._key());if(!t){try{const i=await Mme(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(r){t=()=>Promise.reject(r)}nE.set(this.auth._key(),t)}return this.bypassAuthState||nE.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Mme(e,t){const r=Rme(t),i=Ime(e);if(!await i._isAvailable())return!1;const n=await i._get(r)==="true";return await i._remove(r),n}function Pme(e,t){nE.set(e._key(),t)}function Ime(e){return Fu(e._redirectPersistence)}function Rme(e){return iE(Ame,e.config.apiKey,e.name)}async function Dme(e,t,r=!1){const i=Gp(e),n=wme(i,t),a=await new Tme(i,n,r).execute();return a&&!r&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ome=10*60*1e3;class Lme{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(r=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!Nme(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var i;if(t.error&&!eQ(t)){const n=((i=t.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";r.onError(Bc(this.auth,n))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const i=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=Ome&&this.cachedEventUids.clear(),this.cachedEventUids.has(k5(t))}saveEventToCache(t){this.cachedEventUids.add(k5(t)),this.lastProcessedEventTime=Date.now()}}function k5(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function eQ({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function Nme(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eQ(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kme(e,t={}){return Xh(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zme=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Bme=/^https?/;async function Fme(e){if(e.config.emulator)return;const{authorizedDomains:t}=await kme(e);for(const r of t)try{if(jme(r))return}catch{}Ul(e,"unauthorized-domain")}function jme(e){const t=XO(),{protocol:r,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&i===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===i}if(!Bme.test(r))return!1;if(zme.test(e))return i===e;const n=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vme=new Ox(3e4,6e4);function z5(){const e=Fc().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function Ume(e){return new Promise((t,r)=>{var i,n,s;function a(){z5(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{z5(),r(Bc(e,"network-request-failed"))},timeout:Vme.get()})}if(!((n=(i=Fc().gapi)===null||i===void 0?void 0:i.iframes)===null||n===void 0)&&n.Iframe)t(gapi.iframes.getContext());else if(!((s=Fc().gapi)===null||s===void 0)&&s.load)a();else{const o=Lpe("iframefcb");return Fc()[o]=()=>{gapi.load?a():r(Bc(e,"network-request-failed"))},FK(`https://apis.google.com/js/api.js?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw sE=null,t})}let sE=null;function $me(e){return sE=sE||Ume(e),sE}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hme=new Ox(5e3,15e3),Wme="__/auth/iframe",Gme="emulator/auth/iframe",qme={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xme=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yme(e){const t=e.config;tr(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Rz(t,Gme):`https://${e.config.authDomain}/${Wme}`,i={apiKey:t.apiKey,appName:e.name,v:Wp},n=Xme.get(e.config.apiHost);n&&(i.eid=n);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${r}?${Dx(i).slice(1)}`}async function Kme(e){const t=await $me(e),r=Fc().gapi;return tr(r,e,"internal-error"),t.open({where:document.body,url:Yme(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qme,dontclear:!0},i=>new Promise(async(n,s)=>{await i.restyle({setHideOnLeave:!1});const a=Bc(e,"network-request-failed"),o=Fc().setTimeout(()=>{s(a)},Hme.get());function l(){Fc().clearTimeout(o),n(i)}i.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qme={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Zme=500,Jme=600,ege="_blank",tge="http://localhost";class B5{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rge(e,t,r,i=Zme,n=Jme){const s=Math.max((window.screen.availHeight-n)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Qme),{width:i.toString(),height:n.toString(),top:s,left:a}),c=ta().toLowerCase();r&&(o=DK(c)?ege:r),RK(c)&&(t=t||tge,l.scrollbars="yes");const d=Object.entries(l).reduce((h,[f,p])=>`${h}${f}=${p},`,"");if(Cpe(c)&&o!=="_self")return ige(t||"",o),new B5(null);const u=window.open(t||"",o,d);tr(u,e,"popup-blocked");try{u.focus()}catch{}return new B5(u)}function ige(e,t){const r=document.createElement("a");r.href=e,r.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nge="__/auth/handler",sge="emulator/auth/handler",age=encodeURIComponent("fac");async function F5(e,t,r,i,n,s){tr(e.config.authDomain,e,"auth-domain-config-required"),tr(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:i,v:Wp,eventId:n};if(t instanceof VK){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",Whe(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[d,u]of Object.entries(s||{}))a[d]=u}if(t instanceof Nx){const d=t.getScopes().filter(u=>u!=="");d.length>0&&(a.scopes=d.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await e._getAppCheckToken(),c=l?`#${age}=${encodeURIComponent(l)}`:"";return`${oge(e)}?${Dx(o).slice(1)}${c}`}function oge({config:e}){return e.emulator?Rz(e,sge):`https://${e.authDomain}/${nge}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP="webStorageSupport";class lge{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=XK,this._completeRedirectFn=Dme,this._overrideRedirectResult=Pme}async _openPopup(t,r,i,n){var s;id((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await F5(t,r,i,XO(),n);return rge(t,a,kz())}async _openRedirect(t,r,i,n){await this._originValidation(t);const s=await F5(t,r,i,XO(),n);return dme(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:n,promise:s}=this.eventManagers[r];return n?Promise.resolve(n):(id(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(t);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(t){const r=await Kme(t),i=new Lme(t);return r.register("authEvent",n=>(tr(n==null?void 0:n.authEvent,t,"invalid-auth-event"),{status:i.onEvent(n.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=r,i}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(jP,{type:jP},n=>{var s;const a=(s=n==null?void 0:n[0])===null||s===void 0?void 0:s[jP];a!==void 0&&r(!!a),Ul(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=Fme(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return zK()||Oz()||kT()}}const cge=lge;var j5="@firebase/auth",V5="1.5.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uge{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dge(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function hge(e){wp(new Nh("auth",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=i.options;tr(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BK(e)},c=new Dpe(i,n,s,l);return jpe(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,i)=>{t.getProvider("auth-internal").initialize()})),wp(new Nh("auth-internal",t=>{const r=Gp(t.getProvider("auth").getImmediate());return(i=>new uge(i))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),zc(j5,V5,dge(e)),zc(j5,V5,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fge=5*60,pge=vK("authIdTokenMaxAge")||fge;let U5=null;const mge=e=>async t=>{const r=t&&await t.getIdTokenResult(),i=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>pge)return;const n=r==null?void 0:r.token;U5!==n&&(U5=n,await fetch(e,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))};function gge(e=Mz()){const t=NT(e,"auth");if(t.isInitialized())return t.getImmediate();const r=Fpe(e,{popupRedirectResolver:cge,persistence:[xme,lme,XK]}),i=vK("authTokenSyncURL");if(i){const s=mge(i);nme(r,s,()=>s(r.currentUser)),ime(r,a=>s(a))}const n=pK("auth");return n&&Vpe(r,`http://${n}`),r}hge("Browser");var vge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bt,Bz=Bz||{},sr=vge||self;function FT(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function zx(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function yge(e){return Object.prototype.hasOwnProperty.call(e,VP)&&e[VP]||(e[VP]=++bge)}var VP="closure_uid_"+(1e9*Math.random()>>>0),bge=0;function xge(e,t,r){return e.call.apply(e.bind,arguments)}function wge(e,t,r){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Ks(e,t,r){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ks=xge:Ks=wge,Ks.apply(null,arguments)}function Qw(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var i=r.slice();return i.push.apply(i,arguments),e.apply(this,i)}}function ls(e,t){function r(){}r.prototype=t.prototype,e.$=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.ac=function(i,n,s){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return t.prototype[n].apply(i,a)}}function Yh(){this.s=this.s,this.o=this.o}var _ge=0;Yh.prototype.s=!1;Yh.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),_ge!=0)&&yge(this)};Yh.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const tQ=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let r=0;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1};function Fz(e){const t=e.length;if(0<t){const r=Array(t);for(let i=0;i<t;i++)r[i]=e[i];return r}return[]}function $5(e,t){for(let r=1;r<arguments.length;r++){const i=arguments[r];if(FT(i)){const n=e.length||0,s=i.length||0;e.length=n+s;for(let a=0;a<s;a++)e[n+a]=i[a]}else e.push(i)}}function Qs(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Qs.prototype.h=function(){this.defaultPrevented=!0};var Sge=function(){if(!sr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const r=()=>{};sr.addEventListener("test",r,t),sr.removeEventListener("test",r,t)}catch{}return e}();function Ib(e){return/^[\s\xa0]*$/.test(e)}function jT(){var e=sr.navigator;return e&&(e=e.userAgent)?e:""}function Cc(e){return jT().indexOf(e)!=-1}function jz(e){return jz[" "](e),e}jz[" "]=function(){};function Ege(e,t){var r=gve;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}var Cge=Cc("Opera"),Pv=Cc("Trident")||Cc("MSIE"),rQ=Cc("Edge"),QO=rQ||Pv,iQ=Cc("Gecko")&&!(jT().toLowerCase().indexOf("webkit")!=-1&&!Cc("Edge"))&&!(Cc("Trident")||Cc("MSIE"))&&!Cc("Edge"),Age=jT().toLowerCase().indexOf("webkit")!=-1&&!Cc("Edge");function nQ(){var e=sr.document;return e?e.documentMode:void 0}var ZO;e:{var UP="",$P=function(){var e=jT();if(iQ)return/rv:([^\);]+)(\)|;)/.exec(e);if(rQ)return/Edge\/([\d\.]+)/.exec(e);if(Pv)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(Age)return/WebKit\/(\S+)/.exec(e);if(Cge)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if($P&&(UP=$P?$P[1]:""),Pv){var HP=nQ();if(HP!=null&&HP>parseFloat(UP)){ZO=String(HP);break e}}ZO=UP}var JO;if(sr.document&&Pv){var H5=nQ();JO=H5||parseInt(ZO,10)||void 0}else JO=void 0;var Tge=JO;function Rb(e,t){if(Qs.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(iQ){e:{try{jz(t.nodeName);var n=!0;break e}catch{}n=!1}n||(t=null)}}else r=="mouseover"?t=e.fromElement:r=="mouseout"&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:Mge[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Rb.$.h.call(this)}}ls(Rb,Qs);var Mge={2:"touch",3:"pen",4:"mouse"};Rb.prototype.h=function(){Rb.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Bx="closure_listenable_"+(1e6*Math.random()|0),Pge=0;function Ige(e,t,r,i,n){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!i,this.la=n,this.key=++Pge,this.fa=this.ia=!1}function VT(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Vz(e,t,r){for(const i in e)t.call(r,e[i],i,e)}function Rge(e,t){for(const r in e)t.call(void 0,e[r],r,e)}function sQ(e){const t={};for(const r in e)t[r]=e[r];return t}const W5="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function aQ(e,t){let r,i;for(let n=1;n<arguments.length;n++){i=arguments[n];for(r in i)e[r]=i[r];for(let s=0;s<W5.length;s++)r=W5[s],Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}}function UT(e){this.src=e,this.g={},this.h=0}UT.prototype.add=function(e,t,r,i,n){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var a=t3(e,t,i,n);return-1<a?(t=e[a],r||(t.ia=!1)):(t=new Ige(t,this.src,s,!!i,n),t.ia=r,e.push(t)),t};function e3(e,t){var r=t.type;if(r in e.g){var i=e.g[r],n=tQ(i,t),s;(s=0<=n)&&Array.prototype.splice.call(i,n,1),s&&(VT(t),e.g[r].length==0&&(delete e.g[r],e.h--))}}function t3(e,t,r,i){for(var n=0;n<e.length;++n){var s=e[n];if(!s.fa&&s.listener==t&&s.capture==!!r&&s.la==i)return n}return-1}var Uz="closure_lm_"+(1e6*Math.random()|0),WP={};function oQ(e,t,r,i,n){if(i&&i.once)return cQ(e,t,r,i,n);if(Array.isArray(t)){for(var s=0;s<t.length;s++)oQ(e,t[s],r,i,n);return null}return r=Wz(r),e&&e[Bx]?e.O(t,r,zx(i)?!!i.capture:!!i,n):lQ(e,t,r,!1,i,n)}function lQ(e,t,r,i,n,s){if(!t)throw Error("Invalid event type");var a=zx(n)?!!n.capture:!!n,o=Hz(e);if(o||(e[Uz]=o=new UT(e)),r=o.add(t,r,i,a,s),r.proxy)return r;if(i=Dge(),r.proxy=i,i.src=e,i.listener=r,e.addEventListener)Sge||(n=a),n===void 0&&(n=!1),e.addEventListener(t.toString(),i,n);else if(e.attachEvent)e.attachEvent(dQ(t.toString()),i);else if(e.addListener&&e.removeListener)e.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return r}function Dge(){function e(r){return t.call(e.src,e.listener,r)}const t=Oge;return e}function cQ(e,t,r,i,n){if(Array.isArray(t)){for(var s=0;s<t.length;s++)cQ(e,t[s],r,i,n);return null}return r=Wz(r),e&&e[Bx]?e.P(t,r,zx(i)?!!i.capture:!!i,n):lQ(e,t,r,!0,i,n)}function uQ(e,t,r,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)uQ(e,t[s],r,i,n);else i=zx(i)?!!i.capture:!!i,r=Wz(r),e&&e[Bx]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],r=t3(s,r,i,n),-1<r&&(VT(s[r]),Array.prototype.splice.call(s,r,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=Hz(e))&&(t=e.g[t.toString()],e=-1,t&&(e=t3(t,r,i,n)),(r=-1<e?t[e]:null)&&$z(r))}function $z(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[Bx])e3(t.i,e);else{var r=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(r,i,e.capture):t.detachEvent?t.detachEvent(dQ(r),i):t.addListener&&t.removeListener&&t.removeListener(i),(r=Hz(t))?(e3(r,e),r.h==0&&(r.src=null,t[Uz]=null)):VT(e)}}}function dQ(e){return e in WP?WP[e]:WP[e]="on"+e}function Oge(e,t){if(e.fa)e=!0;else{t=new Rb(t,this);var r=e.listener,i=e.la||e.src;e.ia&&$z(e),e=r.call(i,t)}return e}function Hz(e){return e=e[Uz],e instanceof UT?e:null}var GP="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wz(e){return typeof e=="function"?e:(e[GP]||(e[GP]=function(t){return e.handleEvent(t)}),e[GP])}function as(){Yh.call(this),this.i=new UT(this),this.S=this,this.J=null}ls(as,Yh);as.prototype[Bx]=!0;as.prototype.removeEventListener=function(e,t,r,i){uQ(this,e,t,r,i)};function Es(e,t){var r,i=e.J;if(i)for(r=[];i;i=i.J)r.push(i);if(e=e.S,i=t.type||t,typeof t=="string")t=new Qs(t,e);else if(t instanceof Qs)t.target=t.target||e;else{var n=t;t=new Qs(i,e),aQ(t,n)}if(n=!0,r)for(var s=r.length-1;0<=s;s--){var a=t.g=r[s];n=Zw(a,i,!0,t)&&n}if(a=t.g=e,n=Zw(a,i,!0,t)&&n,n=Zw(a,i,!1,t)&&n,r)for(s=0;s<r.length;s++)a=t.g=r[s],n=Zw(a,i,!1,t)&&n}as.prototype.N=function(){if(as.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var r=e.g[t],i=0;i<r.length;i++)VT(r[i]);delete e.g[t],e.h--}}this.J=null};as.prototype.O=function(e,t,r,i){return this.i.add(String(e),t,!1,r,i)};as.prototype.P=function(e,t,r,i){return this.i.add(String(e),t,!0,r,i)};function Zw(e,t,r,i){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var n=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.fa&&a.capture==r){var o=a.listener,l=a.la||a.src;a.ia&&e3(e.i,a),n=o.call(l,i)!==!1&&n}}return n&&!i.defaultPrevented}var Gz=sr.JSON.stringify;let Lge=class{constructor(t,r){this.i=t,this.j=r,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}};function Nge(){var e=qz;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class kge{constructor(){this.h=this.g=null}add(t,r){const i=hQ.get();i.set(t,r),this.h?this.h.next=i:this.g=i,this.h=i}}var hQ=new Lge(()=>new zge,e=>e.reset());let zge=class{constructor(){this.next=this.g=this.h=null}set(t,r){this.h=t,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}};function Bge(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function Fge(e){sr.setTimeout(()=>{throw e},0)}let Db,Ob=!1,qz=new kge,fQ=()=>{const e=sr.Promise.resolve(void 0);Db=()=>{e.then(jge)}};var jge=()=>{for(var e;e=Nge();){try{e.h.call(e.g)}catch(r){Fge(r)}var t=hQ;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ob=!1};function $T(e,t){as.call(this),this.h=e||1,this.g=t||sr,this.j=Ks(this.qb,this),this.l=Date.now()}ls($T,as);bt=$T.prototype;bt.ga=!1;bt.T=null;bt.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Es(this,"tick"),this.ga&&(Xz(this),this.start()))}};bt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Xz(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}bt.N=function(){$T.$.N.call(this),Xz(this),delete this.g};function Yz(e,t,r){if(typeof e=="function")r&&(e=Ks(e,r));else if(e&&typeof e.handleEvent=="function")e=Ks(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:sr.setTimeout(e,t||0)}function pQ(e){e.g=Yz(()=>{e.g=null,e.i&&(e.i=!1,pQ(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}let Vge=class extends Yh{constructor(t,r){super(),this.m=t,this.j=r,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:pQ(this)}N(){super.N(),this.g&&(sr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Lb(e){Yh.call(this),this.h=e,this.g={}}ls(Lb,Yh);var G5=[];function mQ(e,t,r,i){Array.isArray(r)||(r&&(G5[0]=r.toString()),r=G5);for(var n=0;n<r.length;n++){var s=oQ(t,r[n],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function gQ(e){Vz(e.g,function(t,r){this.g.hasOwnProperty(r)&&$z(t)},e),e.g={}}Lb.prototype.N=function(){Lb.$.N.call(this),gQ(this)};Lb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function HT(){this.g=!0}HT.prototype.Ea=function(){this.g=!1};function Uge(e,t,r,i,n,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");a=2<=u.length&&u[1]=="type"?a+(d+"="+c+"&"):a+(d+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+i+") [attempt "+n+"]: "+t+`
`+r+`
`+a})}function $ge(e,t,r,i,n,s,a){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+n+"]: "+t+`
`+r+`
`+s+" "+a})}function kg(e,t,r,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+Wge(e,r)+(i?" "+i:"")})}function Hge(e,t){e.info(function(){return"TIMEOUT: "+t})}HT.prototype.info=function(){};function Wge(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r){for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var i=r[e];if(!(2>i.length)){var n=i[1];if(Array.isArray(n)&&!(1>n.length)){var s=n[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<n.length;a++)n[a]=""}}}}return Gz(r)}catch{return t}}var qp={},q5=null;function WT(){return q5=q5||new as}qp.Ta="serverreachability";function vQ(e){Qs.call(this,qp.Ta,e)}ls(vQ,Qs);function Nb(e){const t=WT();Es(t,new vQ(t))}qp.STAT_EVENT="statevent";function yQ(e,t){Qs.call(this,qp.STAT_EVENT,e),this.stat=t}ls(yQ,Qs);function ya(e){const t=WT();Es(t,new yQ(t,e))}qp.Ua="timingevent";function bQ(e,t){Qs.call(this,qp.Ua,e),this.size=t}ls(bQ,Qs);function Fx(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return sr.setTimeout(function(){e()},t)}var GT={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},xQ={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Kz(){}Kz.prototype.h=null;function X5(e){return e.h||(e.h=e.i())}function wQ(){}var jx={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Qz(){Qs.call(this,"d")}ls(Qz,Qs);function Zz(){Qs.call(this,"c")}ls(Zz,Qs);var r3;function qT(){}ls(qT,Kz);qT.prototype.g=function(){return new XMLHttpRequest};qT.prototype.i=function(){return{}};r3=new qT;function Vx(e,t,r,i){this.l=e,this.j=t,this.m=r,this.W=i||1,this.U=new Lb(this),this.P=Gge,e=QO?125:void 0,this.V=new $T(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new _Q}function _Q(){this.i=null,this.g="",this.h=!1}var Gge=45e3,SQ={},i3={};bt=Vx.prototype;bt.setTimeout=function(e){this.P=e};function n3(e,t,r){e.L=1,e.A=YT(nd(t)),e.u=r,e.S=!0,EQ(e,null)}function EQ(e,t){e.G=Date.now(),Ux(e),e.B=nd(e.A);var r=e.B,i=e.W;Array.isArray(i)||(i=[String(i)]),DQ(r.i,"t",i),e.o=0,r=e.l.J,e.h=new _Q,e.g=JQ(e.l,r?t:null,!e.u),0<e.O&&(e.M=new Vge(Ks(e.Pa,e,e.g),e.O)),mQ(e.U,e.g,"readystatechange",e.nb),t=e.I?sQ(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),Nb(),Uge(e.j,e.v,e.B,e.m,e.W,e.u)}bt.nb=function(e){e=e.target;const t=this.M;t&&Pc(e)==3?t.l():this.Pa(e)};bt.Pa=function(e){try{if(e==this.g)e:{const d=Pc(this.g);var t=this.g.Ia();const u=this.g.da();if(!(3>d)&&(d!=3||QO||this.g&&(this.h.h||this.g.ja()||Z5(this.g)))){this.J||d!=4||t==7||(t==8||0>=u?Nb(3):Nb(2)),XT(this);var r=this.g.da();this.ca=r;t:if(CQ(this)){var i=Z5(this.g);e="";var n=i.length,s=Pc(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){kf(this),D1(this);var a="";break t}this.h.i=new sr.TextDecoder}for(t=0;t<n;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==n-1});i.length=0,this.h.g+=e,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=r==200,$ge(this.j,this.v,this.B,this.m,this.W,d,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ib(o)){var c=o;break t}}c=null}if(r=c)kg(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,s3(this,r);else{this.i=!1,this.s=3,ya(12),kf(this),D1(this);break e}}this.S?(AQ(this,d,a),QO&&this.i&&d==3&&(mQ(this.U,this.V,"tick",this.mb),this.V.start())):(kg(this.j,this.m,a,null),s3(this,a)),d==4&&kf(this),this.i&&!this.J&&(d==4?YQ(this.l,this):(this.i=!1,Ux(this)))}else fve(this.g),r==400&&0<a.indexOf("Unknown SID")?(this.s=3,ya(12)):(this.s=0,ya(13)),kf(this),D1(this)}}}catch{}finally{}};function CQ(e){return e.g?e.v=="GET"&&e.L!=2&&e.l.Ha:!1}function AQ(e,t,r){let i=!0,n;for(;!e.J&&e.o<r.length;)if(n=qge(e,r),n==i3){t==4&&(e.s=4,ya(14),i=!1),kg(e.j,e.m,null,"[Incomplete Response]");break}else if(n==SQ){e.s=4,ya(15),kg(e.j,e.m,r,"[Invalid Chunk]"),i=!1;break}else kg(e.j,e.m,n,null),s3(e,n);CQ(e)&&e.o!=0&&(e.h.g=e.h.g.slice(e.o),e.o=0),t!=4||r.length!=0||e.h.h||(e.s=1,ya(16),i=!1),e.i=e.i&&i,i?0<r.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+r.length),nB(t),t.M=!0,ya(11))):(kg(e.j,e.m,r,"[Invalid Chunked Response]"),kf(e),D1(e))}bt.mb=function(){if(this.g){var e=Pc(this.g),t=this.g.ja();this.o<t.length&&(XT(this),AQ(this,e,t),this.i&&e!=4&&Ux(this))}};function qge(e,t){var r=e.o,i=t.indexOf(`
`,r);return i==-1?i3:(r=Number(t.substring(r,i)),isNaN(r)?SQ:(i+=1,i+r>t.length?i3:(t=t.slice(i,i+r),e.o=i+r,t)))}bt.cancel=function(){this.J=!0,kf(this)};function Ux(e){e.Y=Date.now()+e.P,TQ(e,e.P)}function TQ(e,t){if(e.C!=null)throw Error("WatchDog timer not null");e.C=Fx(Ks(e.lb,e),t)}function XT(e){e.C&&(sr.clearTimeout(e.C),e.C=null)}bt.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(Hge(this.j,this.B),this.L!=2&&(Nb(),ya(17)),kf(this),this.s=2,D1(this)):TQ(this,this.Y-e)};function D1(e){e.l.H==0||e.J||YQ(e.l,e)}function kf(e){XT(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,Xz(e.V),gQ(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function s3(e,t){try{var r=e.l;if(r.H!=0&&(r.g==e||a3(r.i,e))){if(!e.K&&a3(r.i,e)&&r.H==3){try{var i=r.Ja.g.parse(t)}catch{i=null}if(Array.isArray(i)&&i.length==3){var n=i;if(n[0]==0){e:if(!r.u){if(r.g)if(r.g.G+3e3<e.G)yC(r),JT(r);else break e;iB(r),ya(18)}}else r.Fa=n[1],0<r.Fa-r.V&&37500>n[2]&&r.G&&r.A==0&&!r.v&&(r.v=Fx(Ks(r.ib,r),6e3));if(1>=NQ(r.i)&&r.oa){try{r.oa()}catch{}r.oa=void 0}}else zf(r,11)}else if((e.K||r.g==e)&&yC(r),!Ib(t))for(n=r.Ja.g.parse(t),t=0;t<n.length;t++){let c=n[t];if(r.V=c[0],c=c[1],r.H==2)if(c[0]=="c"){r.K=c[1],r.pa=c[2];const d=c[3];d!=null&&(r.ra=d,r.l.info("VER="+r.ra));const u=c[4];u!=null&&(r.Ga=u,r.l.info("SVER="+r.Ga));const h=c[5];h!=null&&typeof h=="number"&&0<h&&(i=1.5*h,r.L=i,r.l.info("backChannelRequestTimeoutMs_="+i)),i=r;const f=e.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=i.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Jz(s,s.h),s.h=null))}if(i.F){const m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(i.Da=m,wi(i.I,i.F,m))}}r.H=3,r.h&&r.h.Ba(),r.ca&&(r.S=Date.now()-e.G,r.l.info("Handshake RTT: "+r.S+"ms")),i=r;var a=e;if(i.wa=ZQ(i,i.J?i.pa:null,i.Y),a.K){kQ(i.i,a);var o=a,l=i.L;l&&o.setTimeout(l),o.C&&(XT(o),Ux(o)),i.g=a}else qQ(i);0<r.j.length&&e2(r)}else c[0]!="stop"&&c[0]!="close"||zf(r,7);else r.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?zf(r,7):rB(r):c[0]!="noop"&&r.h&&r.h.Aa(c),r.A=0)}}Nb(4)}catch{}}function Xge(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(FT(e)){for(var t=[],r=e.length,i=0;i<r;i++)t.push(e[i]);return t}t=[],r=0;for(i in e)t[r++]=e[i];return t}function Yge(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(FT(e)||typeof e=="string"){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const i in e)t[r++]=i;return t}}}function MQ(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(FT(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var r=Yge(e),i=Xge(e),n=i.length,s=0;s<n;s++)t.call(void 0,i[s],r&&r[s],e)}var PQ=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Kge(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var i=e[r].indexOf("="),n=null;if(0<=i){var s=e[r].substring(0,i);n=e[r].substring(i+1)}else s=e[r];t(s,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}function rp(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof rp){this.h=e.h,gC(this,e.j),this.s=e.s,this.g=e.g,vC(this,e.m),this.l=e.l;var t=e.i,r=new kb;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),Y5(this,r),this.o=e.o}else e&&(t=String(e).match(PQ))?(this.h=!1,gC(this,t[1]||"",!0),this.s=n1(t[2]||""),this.g=n1(t[3]||"",!0),vC(this,t[4]),this.l=n1(t[5]||"",!0),Y5(this,t[6]||"",!0),this.o=n1(t[7]||"")):(this.h=!1,this.i=new kb(null,this.h))}rp.prototype.toString=function(){var e=[],t=this.j;t&&e.push(s1(t,K5,!0),":");var r=this.g;return(r||t=="file")&&(e.push("//"),(t=this.s)&&e.push(s1(t,K5,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r=this.m,r!=null&&e.push(":",String(r))),(r=this.l)&&(this.g&&r.charAt(0)!="/"&&e.push("/"),e.push(s1(r,r.charAt(0)=="/"?Jge:Zge,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.o)&&e.push("#",s1(r,tve)),e.join("")};function nd(e){return new rp(e)}function gC(e,t,r){e.j=r?n1(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function vC(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Y5(e,t,r){t instanceof kb?(e.i=t,rve(e.i,e.h)):(r||(t=s1(t,eve)),e.i=new kb(t,e.h))}function wi(e,t,r){e.i.set(t,r)}function YT(e){return wi(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function n1(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function s1(e,t,r){return typeof e=="string"?(e=encodeURI(e).replace(t,Qge),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Qge(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var K5=/[#\/\?@]/g,Zge=/[#\?:]/g,Jge=/[#\?]/g,eve=/[#\?@]/g,tve=/#/g;function kb(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Kh(e){e.g||(e.g=new Map,e.h=0,e.i&&Kge(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}bt=kb.prototype;bt.add=function(e,t){Kh(this),this.i=null,e=f0(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this};function IQ(e,t){Kh(e),t=f0(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function RQ(e,t){return Kh(e),t=f0(e,t),e.g.has(t)}bt.forEach=function(e,t){Kh(this),this.g.forEach(function(r,i){r.forEach(function(n){e.call(t,n,i,this)},this)},this)};bt.ta=function(){Kh(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let i=0;i<t.length;i++){const n=e[i];for(let s=0;s<n.length;s++)r.push(t[i])}return r};bt.Z=function(e){Kh(this);let t=[];if(typeof e=="string")RQ(this,e)&&(t=t.concat(this.g.get(f0(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t};bt.set=function(e,t){return Kh(this),this.i=null,e=f0(this,e),RQ(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};bt.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function DQ(e,t,r){IQ(e,t),0<r.length&&(e.i=null,e.g.set(f0(e,t),Fz(r)),e.h+=r.length)}bt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var i=t[r];const s=encodeURIComponent(String(i)),a=this.Z(i);for(i=0;i<a.length;i++){var n=s;a[i]!==""&&(n+="="+encodeURIComponent(String(a[i]))),e.push(n)}}return this.i=e.join("&")};function f0(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function rve(e,t){t&&!e.j&&(Kh(e),e.i=null,e.g.forEach(function(r,i){var n=i.toLowerCase();i!=n&&(IQ(this,i),DQ(this,n,r))},e)),e.j=t}var ive=class{constructor(t,r){this.g=t,this.map=r}};function OQ(e){this.l=e||nve,sr.PerformanceNavigationTiming?(e=sr.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(sr.g&&sr.g.Ka&&sr.g.Ka()&&sr.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var nve=10;function LQ(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function NQ(e){return e.h?1:e.g?e.g.size:0}function a3(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Jz(e,t){e.g?e.g.add(t):e.h=t}function kQ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}OQ.prototype.cancel=function(){if(this.i=zQ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function zQ(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const r of e.g.values())t=t.concat(r.F);return t}return Fz(e.i)}var sve=class{stringify(t){return sr.JSON.stringify(t,void 0)}parse(t){return sr.JSON.parse(t,void 0)}};function ave(){this.g=new sve}function ove(e,t,r){const i=r||"";try{MQ(e,function(n,s){let a=n;zx(n)&&(a=Gz(n)),t.push(i+s+"="+encodeURIComponent(a))})}catch(n){throw t.push(i+"type="+encodeURIComponent("_badmap")),n}}function lve(e,t){const r=new HT;if(sr.Image){const i=new Image;i.onload=Qw(Jw,r,i,"TestLoadImage: loaded",!0,t),i.onerror=Qw(Jw,r,i,"TestLoadImage: error",!1,t),i.onabort=Qw(Jw,r,i,"TestLoadImage: abort",!1,t),i.ontimeout=Qw(Jw,r,i,"TestLoadImage: timeout",!1,t),sr.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}function Jw(e,t,r,i,n){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,n(i)}catch{}}function KT(e){this.l=e.ec||null,this.j=e.ob||!1}ls(KT,Kz);KT.prototype.g=function(){return new QT(this.l,this.j)};KT.prototype.i=function(e){return function(){return e}}({});function QT(e,t){as.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=eB,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ls(QT,as);var eB=0;bt=QT.prototype;bt.open=function(e,t){if(this.readyState!=eB)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,zb(this)};bt.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||sr).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};bt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$x(this)),this.readyState=eB};bt.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,zb(this)),this.g&&(this.readyState=3,zb(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof sr.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;BQ(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function BQ(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}bt.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?$x(this):zb(this),this.readyState==3&&BQ(this)}};bt.Za=function(e){this.g&&(this.response=this.responseText=e,$x(this))};bt.Ya=function(e){this.g&&(this.response=e,$x(this))};bt.ka=function(){this.g&&$x(this)};function $x(e){e.readyState=4,e.l=null,e.j=null,e.A=null,zb(e)}bt.setRequestHeader=function(e,t){this.v.append(e,t)};bt.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};bt.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join(`\r
`)};function zb(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(QT.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var cve=sr.JSON.parse;function Zi(e){as.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=FQ,this.L=this.M=!1}ls(Zi,as);var FQ="",uve=/^https?$/i,dve=["POST","PUT"];bt=Zi.prototype;bt.Oa=function(e){this.M=e};bt.ha=function(e,t,r,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():r3.g(),this.C=this.u?X5(this.u):X5(r3),this.g.onreadystatechange=Ks(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){Q5(this,s);return}if(e=r||"",r=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var n in i)r.set(n,i[n]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(const s of i.keys())r.set(s,i.get(s));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(r.keys()).find(s=>s.toLowerCase()=="content-type"),n=sr.FormData&&e instanceof sr.FormData,!(0<=tQ(dve,t))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of r)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{UQ(this),0<this.B&&((this.L=hve(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ks(this.ua,this)):this.A=Yz(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Q5(this,s)}};function hve(e){return Pv&&typeof e.timeout=="number"&&e.ontimeout!==void 0}bt.ua=function(){typeof Bz<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Es(this,"timeout"),this.abort(8))};function Q5(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,jQ(e),ZT(e)}function jQ(e){e.F||(e.F=!0,Es(e,"complete"),Es(e,"error"))}bt.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Es(this,"complete"),Es(this,"abort"),ZT(this))};bt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ZT(this,!0)),Zi.$.N.call(this)};bt.La=function(){this.s||(this.G||this.v||this.l?VQ(this):this.kb())};bt.kb=function(){VQ(this)};function VQ(e){if(e.h&&typeof Bz<"u"&&(!e.C[1]||Pc(e)!=4||e.da()!=2)){if(e.v&&Pc(e)==4)Yz(e.La,0,e);else if(Es(e,"readystatechange"),Pc(e)==4){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var i;if(i=a===0){var n=String(e.I).match(PQ)[1]||null;!n&&sr.self&&sr.self.location&&(n=sr.self.location.protocol.slice(0,-1)),i=!uve.test(n?n.toLowerCase():"")}r=i}if(r)Es(e,"complete"),Es(e,"success");else{e.m=6;try{var s=2<Pc(e)?e.g.statusText:""}catch{s=""}e.j=s+" ["+e.da()+"]",jQ(e)}}finally{ZT(e)}}}}function ZT(e,t){if(e.g){UQ(e);const r=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Es(e,"ready");try{r.onreadystatechange=i}catch{}}}function UQ(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(sr.clearTimeout(e.A),e.A=null)}bt.isActive=function(){return!!this.g};function Pc(e){return e.g?e.g.readyState:0}bt.da=function(){try{return 2<Pc(this)?this.g.status:-1}catch{return-1}};bt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};bt.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),cve(t)}};function Z5(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case FQ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function fve(e){const t={};e=(e.g&&2<=Pc(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let i=0;i<e.length;i++){if(Ib(e[i]))continue;var r=Bge(e[i]);const n=r[0];if(r=r[1],typeof r!="string")continue;r=r.trim();const s=t[n]||[];t[n]=s,s.push(r)}Rge(t,function(i){return i.join(", ")})}bt.Ia=function(){return this.m};bt.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function $Q(e){let t="";return Vz(e,function(r,i){t+=i,t+=":",t+=r,t+=`\r
`}),t}function tB(e,t,r){e:{for(i in r){var i=!1;break e}i=!0}i||(r=$Q(r),typeof e=="string"?r!=null&&encodeURIComponent(String(r)):wi(e,t,r))}function ay(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function HQ(e){this.Ga=0,this.j=[],this.l=new HT,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ay("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ay("baseRetryDelayMs",5e3,e),this.hb=ay("retryDelaySeedMs",1e4,e),this.eb=ay("forwardChannelMaxRetries",2,e),this.xa=ay("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new OQ(e&&e.concurrentRequestLimit),this.Ja=new ave,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}bt=HQ.prototype;bt.ra=8;bt.H=1;function rB(e){if(WQ(e),e.H==3){var t=e.W++,r=nd(e.I);if(wi(r,"SID",e.K),wi(r,"RID",t),wi(r,"TYPE","terminate"),Hx(e,r),t=new Vx(e,e.l,t),t.L=2,t.A=YT(nd(r)),r=!1,sr.navigator&&sr.navigator.sendBeacon)try{r=sr.navigator.sendBeacon(t.A.toString(),"")}catch{}!r&&sr.Image&&(new Image().src=t.A,r=!0),r||(t.g=JQ(t.l,null),t.g.ha(t.A)),t.G=Date.now(),Ux(t)}QQ(e)}function JT(e){e.g&&(nB(e),e.g.cancel(),e.g=null)}function WQ(e){JT(e),e.u&&(sr.clearTimeout(e.u),e.u=null),yC(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&sr.clearTimeout(e.m),e.m=null)}function e2(e){if(!LQ(e.i)&&!e.m){e.m=!0;var t=e.Na;Db||fQ(),Ob||(Db(),Ob=!0),qz.add(t,e),e.C=0}}function pve(e,t){return NQ(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=Fx(Ks(e.Na,e,t),KQ(e,e.C)),e.C++,!0)}bt.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const n=new Vx(this,this.l,e);let s=this.s;if(this.U&&(s?(s=sQ(s),aQ(s,this.U)):s=this.U),this.o!==null||this.O||(n.I=s,s=null),this.P)e:{for(var t=0,r=0;r<this.j.length;r++){t:{var i=this.j[r];if("__data__"in i.map&&(i=i.map.__data__,typeof i=="string")){i=i.length;break t}i=void 0}if(i===void 0)break;if(t+=i,4096<t){t=r;break e}if(t===4096||r===this.j.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=GQ(this,n,t),r=nd(this.I),wi(r,"RID",e),wi(r,"CVER",22),this.F&&wi(r,"X-HTTP-Session-Id",this.F),Hx(this,r),s&&(this.O?t="headers="+encodeURIComponent(String($Q(s)))+"&"+t:this.o&&tB(r,this.o,s)),Jz(this.i,n),this.bb&&wi(r,"TYPE","init"),this.P?(wi(r,"$req",t),wi(r,"SID","null"),n.aa=!0,n3(n,r,null)):n3(n,r,t),this.H=2}}else this.H==3&&(e?J5(this,e):this.j.length==0||LQ(this.i)||J5(this))};function J5(e,t){var r;t?r=t.m:r=e.W++;const i=nd(e.I);wi(i,"SID",e.K),wi(i,"RID",r),wi(i,"AID",e.V),Hx(e,i),e.o&&e.s&&tB(i,e.o,e.s),r=new Vx(e,e.l,r,e.C+1),e.o===null&&(r.I=e.s),t&&(e.j=t.F.concat(e.j)),t=GQ(e,r,1e3),r.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Jz(e.i,r),n3(r,i,t)}function Hx(e,t){e.na&&Vz(e.na,function(r,i){wi(t,i,r)}),e.h&&MQ({},function(r,i){wi(t,i,r)})}function GQ(e,t,r){r=Math.min(e.j.length,r);var i=e.h?Ks(e.h.Va,e.h,e):null;e:{var n=e.j;let s=-1;for(;;){const a=["count="+r];s==-1?0<r?(s=n[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let l=0;l<r;l++){let c=n[l].g;const d=n[l].map;if(c-=s,0>c)s=Math.max(0,n[l].g-100),o=!1;else try{ove(d,a,"req"+c+"_")}catch{i&&i(d)}}if(o){i=a.join("&");break e}}}return e=e.j.splice(0,r),t.F=e,i}function qQ(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Db||fQ(),Ob||(Db(),Ob=!0),qz.add(t,e),e.A=0}}function iB(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=Fx(Ks(e.Ma,e),KQ(e,e.A)),e.A++,!0)}bt.Ma=function(){if(this.u=null,XQ(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Fx(Ks(this.jb,this),e)}};bt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ya(10),JT(this),XQ(this))};function nB(e){e.B!=null&&(sr.clearTimeout(e.B),e.B=null)}function XQ(e){e.g=new Vx(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=nd(e.wa);wi(t,"RID","rpc"),wi(t,"SID",e.K),wi(t,"AID",e.V),wi(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&wi(t,"TO",e.qa),wi(t,"TYPE","xmlhttp"),Hx(e,t),e.o&&e.s&&tB(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var r=e.g;e=e.pa,r.L=1,r.A=YT(nd(t)),r.u=null,r.S=!0,EQ(r,e)}bt.ib=function(){this.v!=null&&(this.v=null,JT(this),iB(this),ya(19))};function yC(e){e.v!=null&&(sr.clearTimeout(e.v),e.v=null)}function YQ(e,t){var r=null;if(e.g==t){yC(e),nB(e),e.g=null;var i=2}else if(a3(e.i,t))r=t.F,kQ(e.i,t),i=1;else return;if(e.H!=0){if(t.i)if(i==1){r=t.u?t.u.length:0,t=Date.now()-t.G;var n=e.C;i=WT(),Es(i,new bQ(i,r)),e2(e)}else qQ(e);else if(n=t.s,n==3||n==0&&0<t.ca||!(i==1&&pve(e,t)||i==2&&iB(e)))switch(r&&0<r.length&&(t=e.i,t.i=t.i.concat(r)),n){case 1:zf(e,5);break;case 4:zf(e,10);break;case 3:zf(e,6);break;default:zf(e,2)}}}function KQ(e,t){let r=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(r*=2),r*t}function zf(e,t){if(e.l.info("Error code "+t),t==2){var r=null;e.h&&(r=null);var i=Ks(e.pb,e);r||(r=new rp("//www.google.com/images/cleardot.gif"),sr.location&&sr.location.protocol=="http"||gC(r,"https"),YT(r)),lve(r.toString(),i)}else ya(2);e.H=0,e.h&&e.h.za(t),QQ(e),WQ(e)}bt.pb=function(e){e?(this.l.info("Successfully pinged google.com"),ya(2)):(this.l.info("Failed to ping google.com"),ya(1))};function QQ(e){if(e.H=0,e.ma=[],e.h){const t=zQ(e.i);(t.length!=0||e.j.length!=0)&&($5(e.ma,t),$5(e.ma,e.j),e.i.i.length=0,Fz(e.j),e.j.length=0),e.h.ya()}}function ZQ(e,t,r){var i=r instanceof rp?nd(r):new rp(r);if(i.g!="")t&&(i.g=t+"."+i.g),vC(i,i.m);else{var n=sr.location;i=n.protocol,t=t?t+"."+n.hostname:n.hostname,n=+n.port;var s=new rp(null);i&&gC(s,i),t&&(s.g=t),n&&vC(s,n),r&&(s.l=r),i=s}return r=e.F,t=e.Da,r&&t&&wi(i,r,t),wi(i,"VER",e.ra),Hx(e,i),i}function JQ(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=e.Ha&&!e.va?new Zi(new KT({ob:r})):new Zi(e.va),t.Oa(e.J),t}bt.isActive=function(){return!!this.h&&this.h.isActive(this)};function eZ(){}bt=eZ.prototype;bt.Ba=function(){};bt.Aa=function(){};bt.za=function(){};bt.ya=function(){};bt.isActive=function(){return!0};bt.Va=function(){};function bC(){if(Pv&&!(10<=Number(Tge)))throw Error("Environmental error: no available transport.")}bC.prototype.g=function(e,t){return new wo(e,t)};function wo(e,t){as.call(this),this.g=new HQ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Ib(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Ib(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new p0(this)}ls(wo,as);wo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,r=this.h||void 0;ya(0),e.Y=t,e.na=r||{},e.G=e.aa,e.I=ZQ(e,null,e.Y),e2(e)};wo.prototype.close=function(){rB(this.g)};wo.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var r={};r.__data__=e,e=r}else this.v&&(r={},r.__data__=Gz(e),e=r);t.j.push(new ive(t.fb++,e)),t.H==3&&e2(t)};wo.prototype.N=function(){this.g.h=null,delete this.j,rB(this.g),delete this.g,wo.$.N.call(this)};function tZ(e){Qz.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}ls(tZ,Qz);function rZ(){Zz.call(this),this.status=1}ls(rZ,Zz);function p0(e){this.g=e}ls(p0,eZ);p0.prototype.Ba=function(){Es(this.g,"a")};p0.prototype.Aa=function(e){Es(this.g,new tZ(e))};p0.prototype.za=function(e){Es(this.g,new rZ)};p0.prototype.ya=function(){Es(this.g,"b")};function mve(){this.blockSize=-1}function $l(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ls($l,mve);$l.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function qP(e,t,r){r||(r=0);var i=Array(16);if(typeof t=="string")for(var n=0;16>n;++n)i[n]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(n=0;16>n;++n)i[n]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],n=e.g[2];var s=e.g[3],a=t+(s^r&(n^s))+i[0]+3614090360&4294967295;t=r+(a<<7&4294967295|a>>>25),a=s+(n^t&(r^n))+i[1]+3905402710&4294967295,s=t+(a<<12&4294967295|a>>>20),a=n+(r^s&(t^r))+i[2]+606105819&4294967295,n=s+(a<<17&4294967295|a>>>15),a=r+(t^n&(s^t))+i[3]+3250441966&4294967295,r=n+(a<<22&4294967295|a>>>10),a=t+(s^r&(n^s))+i[4]+4118548399&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(n^t&(r^n))+i[5]+1200080426&4294967295,s=t+(a<<12&4294967295|a>>>20),a=n+(r^s&(t^r))+i[6]+2821735955&4294967295,n=s+(a<<17&4294967295|a>>>15),a=r+(t^n&(s^t))+i[7]+4249261313&4294967295,r=n+(a<<22&4294967295|a>>>10),a=t+(s^r&(n^s))+i[8]+1770035416&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(n^t&(r^n))+i[9]+2336552879&4294967295,s=t+(a<<12&4294967295|a>>>20),a=n+(r^s&(t^r))+i[10]+4294925233&4294967295,n=s+(a<<17&4294967295|a>>>15),a=r+(t^n&(s^t))+i[11]+2304563134&4294967295,r=n+(a<<22&4294967295|a>>>10),a=t+(s^r&(n^s))+i[12]+1804603682&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(n^t&(r^n))+i[13]+4254626195&4294967295,s=t+(a<<12&4294967295|a>>>20),a=n+(r^s&(t^r))+i[14]+2792965006&4294967295,n=s+(a<<17&4294967295|a>>>15),a=r+(t^n&(s^t))+i[15]+1236535329&4294967295,r=n+(a<<22&4294967295|a>>>10),a=t+(n^s&(r^n))+i[1]+4129170786&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^n&(t^r))+i[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=n+(t^r&(s^t))+i[11]+643717713&4294967295,n=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(n^s))+i[0]+3921069994&4294967295,r=n+(a<<20&4294967295|a>>>12),a=t+(n^s&(r^n))+i[5]+3593408605&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^n&(t^r))+i[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=n+(t^r&(s^t))+i[15]+3634488961&4294967295,n=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(n^s))+i[4]+3889429448&4294967295,r=n+(a<<20&4294967295|a>>>12),a=t+(n^s&(r^n))+i[9]+568446438&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^n&(t^r))+i[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=n+(t^r&(s^t))+i[3]+4107603335&4294967295,n=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(n^s))+i[8]+1163531501&4294967295,r=n+(a<<20&4294967295|a>>>12),a=t+(n^s&(r^n))+i[13]+2850285829&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^n&(t^r))+i[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=n+(t^r&(s^t))+i[7]+1735328473&4294967295,n=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(n^s))+i[12]+2368359562&4294967295,r=n+(a<<20&4294967295|a>>>12),a=t+(r^n^s)+i[5]+4294588738&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^n)+i[8]+2272392833&4294967295,s=t+(a<<11&4294967295|a>>>21),a=n+(s^t^r)+i[11]+1839030562&4294967295,n=s+(a<<16&4294967295|a>>>16),a=r+(n^s^t)+i[14]+4259657740&4294967295,r=n+(a<<23&4294967295|a>>>9),a=t+(r^n^s)+i[1]+2763975236&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^n)+i[4]+1272893353&4294967295,s=t+(a<<11&4294967295|a>>>21),a=n+(s^t^r)+i[7]+4139469664&4294967295,n=s+(a<<16&4294967295|a>>>16),a=r+(n^s^t)+i[10]+3200236656&4294967295,r=n+(a<<23&4294967295|a>>>9),a=t+(r^n^s)+i[13]+681279174&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^n)+i[0]+3936430074&4294967295,s=t+(a<<11&4294967295|a>>>21),a=n+(s^t^r)+i[3]+3572445317&4294967295,n=s+(a<<16&4294967295|a>>>16),a=r+(n^s^t)+i[6]+76029189&4294967295,r=n+(a<<23&4294967295|a>>>9),a=t+(r^n^s)+i[9]+3654602809&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^n)+i[12]+3873151461&4294967295,s=t+(a<<11&4294967295|a>>>21),a=n+(s^t^r)+i[15]+530742520&4294967295,n=s+(a<<16&4294967295|a>>>16),a=r+(n^s^t)+i[2]+3299628645&4294967295,r=n+(a<<23&4294967295|a>>>9),a=t+(n^(r|~s))+i[0]+4096336452&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~n))+i[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=n+(t^(s|~r))+i[14]+2878612391&4294967295,n=s+(a<<15&4294967295|a>>>17),a=r+(s^(n|~t))+i[5]+4237533241&4294967295,r=n+(a<<21&4294967295|a>>>11),a=t+(n^(r|~s))+i[12]+1700485571&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~n))+i[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=n+(t^(s|~r))+i[10]+4293915773&4294967295,n=s+(a<<15&4294967295|a>>>17),a=r+(s^(n|~t))+i[1]+2240044497&4294967295,r=n+(a<<21&4294967295|a>>>11),a=t+(n^(r|~s))+i[8]+1873313359&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~n))+i[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=n+(t^(s|~r))+i[6]+2734768916&4294967295,n=s+(a<<15&4294967295|a>>>17),a=r+(s^(n|~t))+i[13]+1309151649&4294967295,r=n+(a<<21&4294967295|a>>>11),a=t+(n^(r|~s))+i[4]+4149444226&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~n))+i[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=n+(t^(s|~r))+i[2]+718787259&4294967295,n=s+(a<<15&4294967295|a>>>17),a=r+(s^(n|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(n+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+n&4294967295,e.g[3]=e.g[3]+s&4294967295}$l.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var r=t-this.blockSize,i=this.m,n=this.h,s=0;s<t;){if(n==0)for(;s<=r;)qP(this,e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(i[n++]=e.charCodeAt(s++),n==this.blockSize){qP(this,i),n=0;break}}else for(;s<t;)if(i[n++]=e[s++],n==this.blockSize){qP(this,i),n=0;break}}this.h=n,this.i+=t};$l.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=r&255,r/=256;for(this.j(e),e=Array(16),t=r=0;4>t;++t)for(var i=0;32>i;i+=8)e[r++]=this.g[t]>>>i&255;return e};function ri(e,t){this.h=t;for(var r=[],i=!0,n=e.length-1;0<=n;n--){var s=e[n]|0;i&&s==t||(r[n]=s,i=!1)}this.g=r}var gve={};function sB(e){return-128<=e&&128>e?Ege(e,function(t){return new ri([t|0],0>t?-1:0)}):new ri([e|0],0>e?-1:0)}function Ic(e){if(isNaN(e)||!isFinite(e))return tv;if(0>e)return ys(Ic(-e));for(var t=[],r=1,i=0;e>=r;i++)t[i]=e/r|0,r*=o3;return new ri(t,0)}function iZ(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return ys(iZ(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Ic(Math.pow(t,8)),i=tv,n=0;n<e.length;n+=8){var s=Math.min(8,e.length-n),a=parseInt(e.substring(n,n+s),t);8>s?(s=Ic(Math.pow(t,s)),i=i.R(s).add(Ic(a))):(i=i.R(r),i=i.add(Ic(a)))}return i}var o3=4294967296,tv=sB(0),l3=sB(1),eU=sB(16777216);bt=ri.prototype;bt.ea=function(){if(Yo(this))return-ys(this).ea();for(var e=0,t=1,r=0;r<this.g.length;r++){var i=this.D(r);e+=(0<=i?i:o3+i)*t,t*=o3}return e};bt.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(ju(this))return"0";if(Yo(this))return"-"+ys(this).toString(e);for(var t=Ic(Math.pow(e,6)),r=this,i="";;){var n=wC(r,t).g;r=xC(r,n.R(t));var s=((0<r.g.length?r.g[0]:r.h)>>>0).toString(e);if(r=n,ju(r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}};bt.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function ju(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function Yo(e){return e.h==-1}bt.X=function(e){return e=xC(this,e),Yo(e)?-1:ju(e)?0:1};function ys(e){for(var t=e.g.length,r=[],i=0;i<t;i++)r[i]=~e.g[i];return new ri(r,~e.h).add(l3)}bt.abs=function(){return Yo(this)?ys(this):this};bt.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0,n=0;n<=t;n++){var s=i+(this.D(n)&65535)+(e.D(n)&65535),a=(s>>>16)+(this.D(n)>>>16)+(e.D(n)>>>16);i=a>>>16,s&=65535,a&=65535,r[n]=a<<16|s}return new ri(r,r[r.length-1]&-2147483648?-1:0)};function xC(e,t){return e.add(ys(t))}bt.R=function(e){if(ju(this)||ju(e))return tv;if(Yo(this))return Yo(e)?ys(this).R(ys(e)):ys(ys(this).R(e));if(Yo(e))return ys(this.R(ys(e)));if(0>this.X(eU)&&0>e.X(eU))return Ic(this.ea()*e.ea());for(var t=this.g.length+e.g.length,r=[],i=0;i<2*t;i++)r[i]=0;for(i=0;i<this.g.length;i++)for(var n=0;n<e.g.length;n++){var s=this.D(i)>>>16,a=this.D(i)&65535,o=e.D(n)>>>16,l=e.D(n)&65535;r[2*i+2*n]+=a*l,e_(r,2*i+2*n),r[2*i+2*n+1]+=s*l,e_(r,2*i+2*n+1),r[2*i+2*n+1]+=a*o,e_(r,2*i+2*n+1),r[2*i+2*n+2]+=s*o,e_(r,2*i+2*n+2)}for(i=0;i<t;i++)r[i]=r[2*i+1]<<16|r[2*i];for(i=t;i<2*t;i++)r[i]=0;return new ri(r,0)};function e_(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function oy(e,t){this.g=e,this.h=t}function wC(e,t){if(ju(t))throw Error("division by zero");if(ju(e))return new oy(tv,tv);if(Yo(e))return t=wC(ys(e),t),new oy(ys(t.g),ys(t.h));if(Yo(t))return t=wC(e,ys(t)),new oy(ys(t.g),t.h);if(30<e.g.length){if(Yo(e)||Yo(t))throw Error("slowDivide_ only works with positive integers.");for(var r=l3,i=t;0>=i.X(e);)r=tU(r),i=tU(i);var n=dm(r,1),s=dm(i,1);for(i=dm(i,2),r=dm(r,2);!ju(i);){var a=s.add(i);0>=a.X(e)&&(n=n.add(r),s=a),i=dm(i,1),r=dm(r,1)}return t=xC(e,n.R(t)),new oy(n,t)}for(n=tv;0<=e.X(t);){for(r=Math.max(1,Math.floor(e.ea()/t.ea())),i=Math.ceil(Math.log(r)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),s=Ic(r),a=s.R(t);Yo(a)||0<a.X(e);)r-=i,s=Ic(r),a=s.R(t);ju(s)&&(s=l3),n=n.add(s),e=xC(e,a)}return new oy(n,e)}bt.gb=function(e){return wC(this,e).h};bt.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.D(i)&e.D(i);return new ri(r,this.h&e.h)};bt.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.D(i)|e.D(i);return new ri(r,this.h|e.h)};bt.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],i=0;i<t;i++)r[i]=this.D(i)^e.D(i);return new ri(r,this.h^e.h)};function tU(e){for(var t=e.g.length+1,r=[],i=0;i<t;i++)r[i]=e.D(i)<<1|e.D(i-1)>>>31;return new ri(r,e.h)}function dm(e,t){var r=t>>5;t%=32;for(var i=e.g.length-r,n=[],s=0;s<i;s++)n[s]=0<t?e.D(s+r)>>>t|e.D(s+r+1)<<32-t:e.D(s+r);return new ri(n,e.h)}bC.prototype.createWebChannel=bC.prototype.g;wo.prototype.send=wo.prototype.u;wo.prototype.open=wo.prototype.m;wo.prototype.close=wo.prototype.close;GT.NO_ERROR=0;GT.TIMEOUT=8;GT.HTTP_ERROR=6;xQ.COMPLETE="complete";wQ.EventType=jx;jx.OPEN="a";jx.CLOSE="b";jx.ERROR="c";jx.MESSAGE="d";as.prototype.listen=as.prototype.O;Zi.prototype.listenOnce=Zi.prototype.P;Zi.prototype.getLastError=Zi.prototype.Sa;Zi.prototype.getLastErrorCode=Zi.prototype.Ia;Zi.prototype.getStatus=Zi.prototype.da;Zi.prototype.getResponseJson=Zi.prototype.Wa;Zi.prototype.getResponseText=Zi.prototype.ja;Zi.prototype.send=Zi.prototype.ha;Zi.prototype.setWithCredentials=Zi.prototype.Oa;$l.prototype.digest=$l.prototype.l;$l.prototype.reset=$l.prototype.reset;$l.prototype.update=$l.prototype.j;ri.prototype.add=ri.prototype.add;ri.prototype.multiply=ri.prototype.R;ri.prototype.modulo=ri.prototype.gb;ri.prototype.compare=ri.prototype.X;ri.prototype.toNumber=ri.prototype.ea;ri.prototype.toString=ri.prototype.toString;ri.prototype.getBits=ri.prototype.D;ri.fromNumber=Ic;ri.fromString=iZ;var vve=function(){return new bC},yve=function(){return WT()},XP=GT,bve=xQ,xve=qp,rU={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},t_=wQ,wve=Zi,_ve=$l,rv=ri;const iU="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Vs.UNAUTHENTICATED=new Vs(null),Vs.GOOGLE_CREDENTIALS=new Vs("google-credentials-uid"),Vs.FIRST_PARTY=new Vs("first-party-uid"),Vs.MOCK_USER=new Vs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m0="10.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep=new Az("@firebase/firestore");function ly(){return Ep.logLevel}function It(e,...t){if(Ep.logLevel<=Ir.DEBUG){const r=t.map(aB);Ep.debug(`Firestore (${m0}): ${e}`,...r)}}function sd(e,...t){if(Ep.logLevel<=Ir.ERROR){const r=t.map(aB);Ep.error(`Firestore (${m0}): ${e}`,...r)}}function Iv(e,...t){if(Ep.logLevel<=Ir.WARN){const r=t.map(aB);Ep.warn(`Firestore (${m0}): ${e}`,...r)}}function aB(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(e="Unexpected state"){const t=`FIRESTORE (${m0}) INTERNAL ASSERTION FAILED: `+e;throw sd(t),new Error(t)}function vi(e,t){e||rr()}function gr(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Tt extends ru{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nZ{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Sve{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Vs.UNAUTHENTICATED))}shutdown(){}}class Eve{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Cve{constructor(t){this.t=t,this.currentUser=Vs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){let i=this.i;const n=l=>this.i!==i?(i=this.i,r(l)):Promise.resolve();let s=new Gu;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Gu,t.enqueueRetryable(()=>n(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await n(this.currentUser)})},o=l=>{It("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(It("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Gu)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(i=>this.i!==t?(It("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(vi(typeof i.accessToken=="string"),new nZ(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return vi(t===null||typeof t=="string"),new Vs(t)}}class Ave{constructor(t,r,i){this.l=t,this.h=r,this.P=i,this.type="FirstParty",this.user=Vs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Tve{constructor(t,r,i){this.l=t,this.h=r,this.P=i}getToken(){return Promise.resolve(new Ave(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Vs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Mve{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Pve{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){const i=s=>{s.error!=null&&It("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,It("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const n=s=>{It("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>n(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?n(s):It("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(vi(typeof r.token=="string"),this.R=r.token,new Mve(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ive(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let i=0;i<e;i++)r[i]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sZ{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const n=Ive(40);for(let s=0;s<n.length;++s)i.length<20&&n[s]<r&&(i+=t.charAt(n[s]%t.length))}return i}}function $r(e,t){return e<t?-1:e>t?1:0}function Rv(e,t,r){return e.length===t.length&&e.every((i,n)=>r(i,t[n]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Tt(Je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Tt(Je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Tt(Je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Tt(Je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return jn.fromMillis(Date.now())}static fromDate(t){return jn.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*r));return new jn(r,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?$r(this.nanoseconds,t.nanoseconds):$r(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ur(t)}static min(){return new ur(new jn(0,0))}static max(){return new ur(new jn(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(t,r,i){r===void 0?r=0:r>t.length&&rr(),i===void 0?i=t.length-r:i>t.length-r&&rr(),this.segments=t,this.offset=r,this.len=i}get length(){return this.len}isEqual(t){return Bb.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof Bb?t.forEach(i=>{r.push(i)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,i=this.limit();r<i;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const i=Math.min(t.length,r.length);for(let n=0;n<i;n++){const s=t.get(n),a=r.get(n);if(s<a)return-1;if(s>a)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class _i extends Bb{construct(t,r,i){return new _i(t,r,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const r=[];for(const i of t){if(i.indexOf("//")>=0)throw new Tt(Je.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);r.push(...i.split("/").filter(n=>n.length>0))}return new _i(r)}static emptyPath(){return new _i([])}}const Rve=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends Bb{construct(t,r,i){return new bs(t,r,i)}static isValidIdentifier(t){return Rve.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new bs(["__name__"])}static fromServerFormat(t){const r=[];let i="",n=0;const s=()=>{if(i.length===0)throw new Tt(Je.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(i),i=""};let a=!1;for(;n<t.length;){const o=t[n];if(o==="\\"){if(n+1===t.length)throw new Tt(Je.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[n+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Tt(Je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,n+=2}else o==="`"?(a=!a,n++):o!=="."||a?(i+=o,n++):(s(),n++)}if(s(),a)throw new Tt(Je.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new bs(r)}static emptyPath(){return new bs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(t){this.path=t}static fromPath(t){return new Vt(_i.fromString(t))}static fromName(t){return new Vt(_i.fromString(t).popFirst(5))}static empty(){return new Vt(_i.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&_i.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return _i.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Vt(new _i(t.slice()))}}function Dve(e,t){const r=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,n=ur.fromTimestamp(i===1e9?new jn(r+1,0):new jn(r,i));return new kh(n,Vt.empty(),t)}function Ove(e){return new kh(e.readTime,e.key,-1)}class kh{constructor(t,r,i){this.readTime=t,this.documentKey=r,this.largestBatchId=i}static min(){return new kh(ur.min(),Vt.empty(),-1)}static max(){return new kh(ur.max(),Vt.empty(),-1)}}function Lve(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Vt.comparator(e.documentKey,t.documentKey),r!==0?r:$r(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nve="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kve{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wx(e){if(e.code!==Je.FAILED_PRECONDITION||e.message!==Nve)throw e;It("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&rr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new nt((i,n)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,n)},this.catchCallback=s=>{this.wrapFailure(r,s).next(i,n)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof nt?r:nt.resolve(r)}catch(r){return nt.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):nt.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):nt.reject(r)}static resolve(t){return new nt((r,i)=>{r(t)})}static reject(t){return new nt((r,i)=>{i(t)})}static waitFor(t){return new nt((r,i)=>{let n=0,s=0,a=!1;t.forEach(o=>{++n,o.next(()=>{++s,a&&s===n&&r()},l=>i(l))}),a=!0,s===n&&r()})}static or(t){let r=nt.resolve(!1);for(const i of t)r=r.next(n=>n?nt.resolve(n):i());return r}static forEach(t,r){const i=[];return t.forEach((n,s)=>{i.push(r.call(this,n,s))}),this.waitFor(i)}static mapArray(t,r){return new nt((i,n)=>{const s=t.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(t[c]).next(d=>{a[c]=d,++o,o===s&&i(a)},d=>n(d))}})}static doWhile(t,r){return new nt((i,n)=>{const s=()=>{t()===!0?r().next(()=>{s()},n):i()};s()})}}function Gx(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}oB._e=-1;function t2(e){return e==null}function _C(e){return e===0&&1/e==-1/0}function zve(e){return typeof e=="number"&&Number.isInteger(e)&&!_C(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Xp(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function aZ(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(t,r){this.comparator=t,this.root=r||gs.EMPTY}insert(t,r){return new zi(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,gs.BLACK,null,null))}remove(t){return new zi(this.comparator,this.root.remove(t,this.comparator).copy(null,null,gs.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return r.value;i<0?r=r.left:i>0&&(r=r.right)}return null}indexOf(t){let r=0,i=this.root;for(;!i.isEmpty();){const n=this.comparator(t,i.key);if(n===0)return r+i.left.size;n<0?i=i.left:(r+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,i)=>(t(r,i),!1))}toString(){const t=[];return this.inorderTraversal((r,i)=>(t.push(`${r}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new r_(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new r_(this.root,t,this.comparator,!1)}getReverseIterator(){return new r_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new r_(this.root,t,this.comparator,!0)}}class r_{constructor(t,r,i,n){this.isReverse=n,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?i(t.key,r):1,r&&n&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class gs{constructor(t,r,i,n,s){this.key=t,this.value=r,this.color=i??gs.RED,this.left=n??gs.EMPTY,this.right=s??gs.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,n,s){return new gs(t??this.key,r??this.value,i??this.color,n??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let n=this;const s=i(t,n.key);return n=s<0?n.copy(null,null,null,n.left.insert(t,r,i),null):s===0?n.copy(null,r,null,null,null):n.copy(null,null,null,null,n.right.insert(t,r,i)),n.fixUp()}removeMin(){if(this.left.isEmpty())return gs.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,n=this;if(r(t,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(t,r),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),r(t,n.key)===0){if(n.right.isEmpty())return gs.EMPTY;i=n.right.min(),n=n.copy(i.key,i.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(t,r))}return n.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,gs.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,gs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw rr();const t=this.left.check();if(t!==this.right.check())throw rr();return t+(this.isRed()?0:1)}}gs.EMPTY=null,gs.RED=!0,gs.BLACK=!1;gs.EMPTY=new class{constructor(){this.size=0}get key(){throw rr()}get value(){throw rr()}get color(){throw rr()}get left(){throw rr()}get right(){throw rr()}copy(t,r,i,n,s){return this}insert(t,r,i){return new gs(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(t){this.comparator=t,this.data=new zi(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,i)=>(t(r),!1))}forEachInRange(t,r){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const n=i.getNext();if(this.comparator(n.key,t[1])>=0)return;r(n.key)}}forEachWhile(t,r){let i;for(i=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new sU(this.data.getIterator())}getIteratorFrom(t){return new sU(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(i=>{r=r.add(i)}),r}isEqual(t){if(!(t instanceof Cs)||this.size!==t.size)return!1;const r=this.data.getIterator(),i=t.data.getIterator();for(;r.hasNext();){const n=r.getNext().key,s=i.getNext().key;if(this.comparator(n,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Cs(this.comparator);return r.data=t,r}}class sU{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(t){this.fields=t,t.sort(bs.comparator)}static empty(){return new fo([])}unionWith(t){let r=new Cs(bs.comparator);for(const i of this.fields)r=r.add(i);for(const i of t)r=r.add(i);return new fo(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return Rv(this.fields,t.fields,(r,i)=>r.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(n){try{return atob(n)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new oZ("Invalid base64 string: "+s):s}}(t);return new ra(r)}static fromUint8Array(t){const r=function(n){let s="";for(let a=0;a<n.length;++a)s+=String.fromCharCode(n[a]);return s}(t);return new ra(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return $r(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ra.EMPTY_BYTE_STRING=new ra("");const Bve=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zh(e){if(vi(!!e),typeof e=="string"){let t=0;const r=Bve.exec(e);if(vi(!!r),r[1]){let n=r[1];n=(n+"000000000").substr(0,9),t=Number(n)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:bn(e.seconds),nanos:bn(e.nanos)}}function bn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Cp(e){return typeof e=="string"?ra.fromBase64String(e):ra.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lB(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function cB(e){const t=e.mapValue.fields.__previous_value__;return lB(t)?cB(t):t}function Fb(e){const t=zh(e.mapValue.fields.__local_write_time__.timestampValue);return new jn(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fve{constructor(t,r,i,n,s,a,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=i,this.host=n,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class jb{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new jb("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof jb&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ap(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lB(e)?4:jve(e)?9007199254740991:10:rr()}function qc(e,t){if(e===t)return!0;const r=Ap(e);if(r!==Ap(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Fb(e).isEqual(Fb(t));case 3:return function(n,s){if(typeof n.timestampValue=="string"&&typeof s.timestampValue=="string"&&n.timestampValue.length===s.timestampValue.length)return n.timestampValue===s.timestampValue;const a=zh(n.timestampValue),o=zh(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(n,s){return Cp(n.bytesValue).isEqual(Cp(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(n,s){return bn(n.geoPointValue.latitude)===bn(s.geoPointValue.latitude)&&bn(n.geoPointValue.longitude)===bn(s.geoPointValue.longitude)}(e,t);case 2:return function(n,s){if("integerValue"in n&&"integerValue"in s)return bn(n.integerValue)===bn(s.integerValue);if("doubleValue"in n&&"doubleValue"in s){const a=bn(n.doubleValue),o=bn(s.doubleValue);return a===o?_C(a)===_C(o):isNaN(a)&&isNaN(o)}return!1}(e,t);case 9:return Rv(e.arrayValue.values||[],t.arrayValue.values||[],qc);case 10:return function(n,s){const a=n.mapValue.fields||{},o=s.mapValue.fields||{};if(nU(a)!==nU(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!qc(a[l],o[l])))return!1;return!0}(e,t);default:return rr()}}function Vb(e,t){return(e.values||[]).find(r=>qc(r,t))!==void 0}function Dv(e,t){if(e===t)return 0;const r=Ap(e),i=Ap(t);if(r!==i)return $r(r,i);switch(r){case 0:case 9007199254740991:return 0;case 1:return $r(e.booleanValue,t.booleanValue);case 2:return function(s,a){const o=bn(s.integerValue||s.doubleValue),l=bn(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return aU(e.timestampValue,t.timestampValue);case 4:return aU(Fb(e),Fb(t));case 5:return $r(e.stringValue,t.stringValue);case 6:return function(s,a){const o=Cp(s),l=Cp(a);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const d=$r(o[c],l[c]);if(d!==0)return d}return $r(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const o=$r(bn(s.latitude),bn(a.latitude));return o!==0?o:$r(bn(s.longitude),bn(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,a){const o=s.values||[],l=a.values||[];for(let c=0;c<o.length&&c<l.length;++c){const d=Dv(o[c],l[c]);if(d)return d}return $r(o.length,l.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,a){if(s===i_.mapValue&&a===i_.mapValue)return 0;if(s===i_.mapValue)return 1;if(a===i_.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let u=0;u<l.length&&u<d.length;++u){const h=$r(l[u],d[u]);if(h!==0)return h;const f=Dv(o[l[u]],c[d[u]]);if(f!==0)return f}return $r(l.length,d.length)}(e.mapValue,t.mapValue);default:throw rr()}}function aU(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return $r(e,t);const r=zh(e),i=zh(t),n=$r(r.seconds,i.seconds);return n!==0?n:$r(r.nanos,i.nanos)}function Ov(e){return c3(e)}function c3(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const i=zh(r);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Cp(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Vt.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let i="[",n=!0;for(const s of r.values||[])n?n=!1:i+=",",i+=c3(s);return i+"]"}(e.arrayValue):"mapValue"in e?function(r){const i=Object.keys(r.fields||{}).sort();let n="{",s=!0;for(const a of i)s?s=!1:n+=",",n+=`${a}:${c3(r.fields[a])}`;return n+"}"}(e.mapValue):rr()}function oU(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function u3(e){return!!e&&"integerValue"in e}function uB(e){return!!e&&"arrayValue"in e}function lU(e){return!!e&&"nullValue"in e}function cU(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function aE(e){return!!e&&"mapValue"in e}function O1(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Xp(e.mapValue.fields,(r,i)=>t.mapValue.fields[r]=O1(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=O1(e.arrayValue.values[r]);return t}return Object.assign({},e)}function jve(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(t){this.value=t}static empty(){return new Fa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let i=0;i<t.length-1;++i)if(r=(r.mapValue.fields||{})[t.get(i)],!aE(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=O1(r)}setAll(t){let r=bs.emptyPath(),i={},n=[];t.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,i,n),i={},n=[],r=o.popLast()}a?i[o.lastSegment()]=O1(a):n.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,i,n)}delete(t){const r=this.field(t.popLast());aE(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return qc(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let i=0;i<t.length;++i){let n=r.mapValue.fields[t.get(i)];aE(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},r.mapValue.fields[t.get(i)]=n),r=n}return r.mapValue.fields}applyChanges(t,r,i){Xp(r,(n,s)=>t[n]=s);for(const n of i)delete t[n]}clone(){return new Fa(O1(this.value))}}function lZ(e){const t=[];return Xp(e.fields,(r,i)=>{const n=new bs([r]);if(aE(i)){const s=lZ(i.mapValue).fields;if(s.length===0)t.push(n);else for(const a of s)t.push(n.child(a))}else t.push(n)}),new fo(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(t,r,i,n,s,a,o){this.key=t,this.documentType=r,this.version=i,this.readTime=n,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(t){return new Ws(t,0,ur.min(),ur.min(),ur.min(),Fa.empty(),0)}static newFoundDocument(t,r,i,n){return new Ws(t,1,r,ur.min(),i,n,0)}static newNoDocument(t,r){return new Ws(t,2,r,ur.min(),ur.min(),Fa.empty(),0)}static newUnknownDocument(t,r){return new Ws(t,3,r,ur.min(),ur.min(),Fa.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(ur.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Fa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Fa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ur.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ws&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ws(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(t,r){this.position=t,this.inclusive=r}}function uU(e,t,r){let i=0;for(let n=0;n<e.position.length;n++){const s=t[n],a=e.position[n];if(s.field.isKeyField()?i=Vt.comparator(Vt.fromName(a.referenceValue),r.key):i=Dv(a,r.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function dU(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!qc(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(t,r="asc"){this.field=t,this.dir=r}}function Vve(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cZ{}class Sn extends cZ{constructor(t,r,i){super(),this.field=t,this.op=r,this.value=i}static create(t,r,i){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,i):new $ve(t,r,i):r==="array-contains"?new Gve(t,i):r==="in"?new qve(t,i):r==="not-in"?new Xve(t,i):r==="array-contains-any"?new Yve(t,i):new Sn(t,r,i)}static createKeyFieldInFilter(t,r,i){return r==="in"?new Hve(t,i):new Wve(t,i)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Dv(r,this.value)):r!==null&&Ap(this.value)===Ap(r)&&this.matchesComparison(Dv(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return rr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Hl extends cZ{constructor(t,r){super(),this.filters=t,this.op=r,this.ue=null}static create(t,r){return new Hl(t,r)}matches(t){return uZ(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function uZ(e){return e.op==="and"}function dZ(e){return Uve(e)&&uZ(e)}function Uve(e){for(const t of e.filters)if(t instanceof Hl)return!1;return!0}function d3(e){if(e instanceof Sn)return e.field.canonicalString()+e.op.toString()+Ov(e.value);if(dZ(e))return e.filters.map(t=>d3(t)).join(",");{const t=e.filters.map(r=>d3(r)).join(",");return`${e.op}(${t})`}}function hZ(e,t){return e instanceof Sn?function(i,n){return n instanceof Sn&&i.op===n.op&&i.field.isEqual(n.field)&&qc(i.value,n.value)}(e,t):e instanceof Hl?function(i,n){return n instanceof Hl&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((s,a,o)=>s&&hZ(a,n.filters[o]),!0):!1}(e,t):void rr()}function fZ(e){return e instanceof Sn?function(r){return`${r.field.canonicalString()} ${r.op} ${Ov(r.value)}`}(e):e instanceof Hl?function(r){return r.op.toString()+" {"+r.getFilters().map(fZ).join(" ,")+"}"}(e):"Filter"}class $ve extends Sn{constructor(t,r,i){super(t,r,i),this.key=Vt.fromName(i.referenceValue)}matches(t){const r=Vt.comparator(t.key,this.key);return this.matchesComparison(r)}}class Hve extends Sn{constructor(t,r){super(t,"in",r),this.keys=pZ("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class Wve extends Sn{constructor(t,r){super(t,"not-in",r),this.keys=pZ("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function pZ(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(i=>Vt.fromName(i.referenceValue))}class Gve extends Sn{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return uB(r)&&Vb(r.arrayValue,this.value)}}class qve extends Sn{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&Vb(this.value.arrayValue,r)}}class Xve extends Sn{constructor(t,r){super(t,"not-in",r)}matches(t){if(Vb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!Vb(this.value.arrayValue,r)}}class Yve extends Sn{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!uB(r)||!r.arrayValue.values)&&r.arrayValue.values.some(i=>Vb(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kve{constructor(t,r=null,i=[],n=[],s=null,a=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=i,this.filters=n,this.limit=s,this.startAt=a,this.endAt=o,this.ce=null}}function hU(e,t=null,r=[],i=[],n=null,s=null,a=null){return new Kve(e,t,r,i,n,s,a)}function dB(e){const t=gr(e);if(t.ce===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(i=>d3(i)).join(","),r+="|ob:",r+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),t2(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ov(i)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ov(i)).join(",")),t.ce=r}return t.ce}function hB(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!Vve(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!hZ(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dU(e.startAt,t.startAt)&&dU(e.endAt,t.endAt)}function h3(e){return Vt.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(t,r=null,i=[],n=[],s=null,a="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=n,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Qve(e,t,r,i,n,s,a,o){return new qx(e,t,r,i,n,s,a,o)}function fB(e){return new qx(e)}function fU(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function mZ(e){return e.collectionGroup!==null}function L1(e){const t=gr(e);if(t.le===null){t.le=[];const r=new Set;for(const s of t.explicitOrderBy)t.le.push(s),r.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Cs(bs.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.le.push(new EC(s,i))}),r.has(bs.keyField().canonicalString())||t.le.push(new EC(bs.keyField(),i))}return t.le}function jc(e){const t=gr(e);return t.he||(t.he=Zve(t,L1(e))),t.he}function Zve(e,t){if(e.limitType==="F")return hU(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(n=>{const s=n.dir==="desc"?"asc":"desc";return new EC(n.field,s)});const r=e.endAt?new SC(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new SC(e.startAt.position,e.startAt.inclusive):null;return hU(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}}function f3(e,t){const r=e.filters.concat([t]);return new qx(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function p3(e,t,r){return new qx(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function r2(e,t){return hB(jc(e),jc(t))&&e.limitType===t.limitType}function gZ(e){return`${dB(jc(e))}|lt:${e.limitType}`}function ug(e){return`Query(target=${function(r){let i=r.path.canonicalString();return r.collectionGroup!==null&&(i+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(i+=`, filters: [${r.filters.map(n=>fZ(n)).join(", ")}]`),t2(r.limit)||(i+=", limit: "+r.limit),r.orderBy.length>0&&(i+=`, orderBy: [${r.orderBy.map(n=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(n)).join(", ")}]`),r.startAt&&(i+=", startAt: ",i+=r.startAt.inclusive?"b:":"a:",i+=r.startAt.position.map(n=>Ov(n)).join(",")),r.endAt&&(i+=", endAt: ",i+=r.endAt.inclusive?"a:":"b:",i+=r.endAt.position.map(n=>Ov(n)).join(",")),`Target(${i})`}(jc(e))}; limitType=${e.limitType})`}function i2(e,t){return t.isFoundDocument()&&function(i,n){const s=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Vt.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(e,t)&&function(i,n){for(const s of L1(i))if(!s.field.isKeyField()&&n.data.field(s.field)===null)return!1;return!0}(e,t)&&function(i,n){for(const s of i.filters)if(!s.matches(n))return!1;return!0}(e,t)&&function(i,n){return!(i.startAt&&!function(a,o,l){const c=uU(a,o,l);return a.inclusive?c<=0:c<0}(i.startAt,L1(i),n)||i.endAt&&!function(a,o,l){const c=uU(a,o,l);return a.inclusive?c>=0:c>0}(i.endAt,L1(i),n))}(e,t)}function Jve(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function vZ(e){return(t,r)=>{let i=!1;for(const n of L1(e)){const s=e0e(n,t,r);if(s!==0)return s;i=i||n.field.isKeyField()}return 0}}function e0e(e,t,r){const i=e.field.isKeyField()?Vt.comparator(t.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Dv(l,c):rr()}(e.field,t,r);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return rr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i!==void 0){for(const[n,s]of i)if(this.equalsFn(n,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const i=this.mapKeyFn(t),n=this.inner[i];if(n===void 0)return this.inner[i]=[[t,r]],void this.innerSize++;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return void(n[s]=[t,r]);n.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return!1;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return i.length===1?delete this.inner[r]:i.splice(n,1),this.innerSize--,!0;return!1}forEach(t){Xp(this.inner,(r,i)=>{for(const[n,s]of i)t(n,s)})}isEmpty(){return aZ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0e=new zi(Vt.comparator);function ad(){return t0e}const yZ=new zi(Vt.comparator);function a1(...e){let t=yZ;for(const r of e)t=t.insert(r.key,r);return t}function bZ(e){let t=yZ;return e.forEach((r,i)=>t=t.insert(r,i.overlayedDocument)),t}function Bf(){return N1()}function xZ(){return N1()}function N1(){return new g0(e=>e.toString(),(e,t)=>e.isEqual(t))}const r0e=new zi(Vt.comparator),i0e=new Cs(Vt.comparator);function Sr(...e){let t=i0e;for(const r of e)t=t.add(r);return t}const n0e=new Cs($r);function s0e(){return n0e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wZ(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_C(t)?"-0":t}}function _Z(e){return{integerValue:""+e}}function a0e(e,t){return zve(t)?_Z(t):wZ(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this._=void 0}}function o0e(e,t,r){return e instanceof CC?function(n,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return s&&lB(s)&&(s=cB(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,t):e instanceof Lv?EZ(e,t):e instanceof Ub?CZ(e,t):function(n,s){const a=SZ(n,s),o=pU(a)+pU(n.Ie);return u3(a)&&u3(n.Ie)?_Z(o):wZ(n.serializer,o)}(e,t)}function l0e(e,t,r){return e instanceof Lv?EZ(e,t):e instanceof Ub?CZ(e,t):r}function SZ(e,t){return e instanceof AC?function(i){return u3(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class CC extends n2{}class Lv extends n2{constructor(t){super(),this.elements=t}}function EZ(e,t){const r=AZ(t);for(const i of e.elements)r.some(n=>qc(n,i))||r.push(i);return{arrayValue:{values:r}}}class Ub extends n2{constructor(t){super(),this.elements=t}}function CZ(e,t){let r=AZ(t);for(const i of e.elements)r=r.filter(n=>!qc(n,i));return{arrayValue:{values:r}}}class AC extends n2{constructor(t,r){super(),this.serializer=t,this.Ie=r}}function pU(e){return bn(e.integerValue||e.doubleValue)}function AZ(e){return uB(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0e{constructor(t,r){this.field=t,this.transform=r}}function u0e(e,t){return e.field.isEqual(t.field)&&function(i,n){return i instanceof Lv&&n instanceof Lv||i instanceof Ub&&n instanceof Ub?Rv(i.elements,n.elements,qc):i instanceof AC&&n instanceof AC?qc(i.Ie,n.Ie):i instanceof CC&&n instanceof CC}(e.transform,t.transform)}class d0e{constructor(t,r){this.version=t,this.transformResults=r}}class zl{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new zl}static exists(t){return new zl(void 0,t)}static updateTime(t){return new zl(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function oE(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class s2{}function TZ(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new PZ(e.key,zl.none()):new Xx(e.key,e.data,zl.none());{const r=e.data,i=Fa.empty();let n=new Cs(bs.comparator);for(let s of t.fields)if(!n.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?i.delete(s):i.set(s,a),n=n.add(s)}return new Qh(e.key,i,new fo(n.toArray()),zl.none())}}function h0e(e,t,r){e instanceof Xx?function(n,s,a){const o=n.value.clone(),l=gU(n.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(e,t,r):e instanceof Qh?function(n,s,a){if(!oE(n.precondition,s))return void s.convertToUnknownDocument(a.version);const o=gU(n.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(MZ(n)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,r):function(n,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function k1(e,t,r,i){return e instanceof Xx?function(s,a,o,l){if(!oE(s.precondition,a))return o;const c=s.value.clone(),d=vU(s.fieldTransforms,l,a);return c.setAll(d),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(e,t,r,i):e instanceof Qh?function(s,a,o,l){if(!oE(s.precondition,a))return o;const c=vU(s.fieldTransforms,l,a),d=a.data;return d.setAll(MZ(s)),d.setAll(c),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(e,t,r,i):function(s,a,o){return oE(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(e,t,r)}function f0e(e,t){let r=null;for(const i of e.fieldTransforms){const n=t.data.field(i.field),s=SZ(i.transform,n||null);s!=null&&(r===null&&(r=Fa.empty()),r.set(i.field,s))}return r||null}function mU(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&Rv(i,n,(s,a)=>u0e(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Xx extends s2{constructor(t,r,i,n=[]){super(),this.key=t,this.value=r,this.precondition=i,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class Qh extends s2{constructor(t,r,i,n,s=[]){super(),this.key=t,this.data=r,this.fieldMask=i,this.precondition=n,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function MZ(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const i=e.data.field(r);t.set(r,i)}}),t}function gU(e,t,r){const i=new Map;vi(e.length===r.length);for(let n=0;n<r.length;n++){const s=e[n],a=s.transform,o=t.data.field(s.field);i.set(s.field,l0e(a,o,r[n]))}return i}function vU(e,t,r){const i=new Map;for(const n of e){const s=n.transform,a=r.data.field(n.field);i.set(n.field,o0e(s,a,t))}return i}class PZ extends s2{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class p0e extends s2{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0e{constructor(t,r,i,n){this.batchId=t,this.localWriteTime=r,this.baseMutations=i,this.mutations=n}applyToRemoteDocument(t,r){const i=r.mutationResults;for(let n=0;n<this.mutations.length;n++){const s=this.mutations[n];s.key.isEqual(t.key)&&h0e(s,t,i[n])}}applyToLocalView(t,r){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(r=k1(i,t,r,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(r=k1(i,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const i=xZ();return this.mutations.forEach(n=>{const s=t.get(n.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(n.key)?null:o;const l=TZ(a,o);l!==null&&i.set(n.key,l),a.isValidDocument()||a.convertToNoDocument(ur.min())}),i}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Sr())}isEqual(t){return this.batchId===t.batchId&&Rv(this.mutations,t.mutations,(r,i)=>mU(r,i))&&Rv(this.baseMutations,t.baseMutations,(r,i)=>mU(r,i))}}class pB{constructor(t,r,i,n){this.batch=t,this.commitVersion=r,this.mutationResults=i,this.docVersions=n}static from(t,r,i){vi(t.mutations.length===i.length);let n=function(){return r0e}();const s=t.mutations;for(let a=0;a<s.length;a++)n=n.insert(s[a].key,i[a].version);return new pB(t,r,i,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g0e=class{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0e{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn,Dr;function y0e(e){switch(e){default:return rr();case Je.CANCELLED:case Je.UNKNOWN:case Je.DEADLINE_EXCEEDED:case Je.RESOURCE_EXHAUSTED:case Je.INTERNAL:case Je.UNAVAILABLE:case Je.UNAUTHENTICATED:return!1;case Je.INVALID_ARGUMENT:case Je.NOT_FOUND:case Je.ALREADY_EXISTS:case Je.PERMISSION_DENIED:case Je.FAILED_PRECONDITION:case Je.ABORTED:case Je.OUT_OF_RANGE:case Je.UNIMPLEMENTED:case Je.DATA_LOSS:return!0}}function IZ(e){if(e===void 0)return sd("GRPC error has no .code"),Je.UNKNOWN;switch(e){case vn.OK:return Je.OK;case vn.CANCELLED:return Je.CANCELLED;case vn.UNKNOWN:return Je.UNKNOWN;case vn.DEADLINE_EXCEEDED:return Je.DEADLINE_EXCEEDED;case vn.RESOURCE_EXHAUSTED:return Je.RESOURCE_EXHAUSTED;case vn.INTERNAL:return Je.INTERNAL;case vn.UNAVAILABLE:return Je.UNAVAILABLE;case vn.UNAUTHENTICATED:return Je.UNAUTHENTICATED;case vn.INVALID_ARGUMENT:return Je.INVALID_ARGUMENT;case vn.NOT_FOUND:return Je.NOT_FOUND;case vn.ALREADY_EXISTS:return Je.ALREADY_EXISTS;case vn.PERMISSION_DENIED:return Je.PERMISSION_DENIED;case vn.FAILED_PRECONDITION:return Je.FAILED_PRECONDITION;case vn.ABORTED:return Je.ABORTED;case vn.OUT_OF_RANGE:return Je.OUT_OF_RANGE;case vn.UNIMPLEMENTED:return Je.UNIMPLEMENTED;case vn.DATA_LOSS:return Je.DATA_LOSS;default:return rr()}}(Dr=vn||(vn={}))[Dr.OK=0]="OK",Dr[Dr.CANCELLED=1]="CANCELLED",Dr[Dr.UNKNOWN=2]="UNKNOWN",Dr[Dr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dr[Dr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dr[Dr.NOT_FOUND=5]="NOT_FOUND",Dr[Dr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dr[Dr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dr[Dr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dr[Dr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dr[Dr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dr[Dr.ABORTED=10]="ABORTED",Dr[Dr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dr[Dr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dr[Dr.INTERNAL=13]="INTERNAL",Dr[Dr.UNAVAILABLE=14]="UNAVAILABLE",Dr[Dr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0e(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0e=new rv([4294967295,4294967295],0);function yU(e){const t=b0e().encode(e),r=new _ve;return r.update(t),new Uint8Array(r.digest())}function bU(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),i=t.getUint32(4,!0),n=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new rv([r,i],0),new rv([n,s],0)]}class mB{constructor(t,r,i){if(this.bitmap=t,this.padding=r,this.hashCount=i,r<0||r>=8)throw new o1(`Invalid padding: ${r}`);if(i<0)throw new o1(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new o1(`Invalid hash count: ${i}`);if(t.length===0&&r!==0)throw new o1(`Invalid padding when bitmap length is 0: ${r}`);this.Te=8*t.length-r,this.Ee=rv.fromNumber(this.Te)}de(t,r,i){let n=t.add(r.multiply(rv.fromNumber(i)));return n.compare(x0e)===1&&(n=new rv([n.getBits(0),n.getBits(1)],0)),n.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const r=yU(t),[i,n]=bU(r);for(let s=0;s<this.hashCount;s++){const a=this.de(i,n,s);if(!this.Ae(a))return!1}return!0}static create(t,r,i){const n=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new mB(s,n,r);return i.forEach(o=>a.insert(o)),a}insert(t){if(this.Te===0)return;const r=yU(t),[i,n]=bU(r);for(let s=0;s<this.hashCount;s++){const a=this.de(i,n,s);this.Re(a)}}Re(t){const r=Math.floor(t/8),i=t%8;this.bitmap[r]|=1<<i}}class o1 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(t,r,i,n,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=n,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,i){const n=new Map;return n.set(t,Yx.createSynthesizedTargetChangeForCurrentChange(t,r,i)),new a2(ur.min(),n,new zi($r),ad(),Sr())}}class Yx{constructor(t,r,i,n,s){this.resumeToken=t,this.current=r,this.addedDocuments=i,this.modifiedDocuments=n,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,i){return new Yx(i,r,Sr(),Sr(),Sr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t,r,i,n){this.Ve=t,this.removedTargetIds=r,this.key=i,this.me=n}}class RZ{constructor(t,r){this.targetId=t,this.fe=r}}class DZ{constructor(t,r,i=ra.EMPTY_BYTE_STRING,n=null){this.state=t,this.targetIds=r,this.resumeToken=i,this.cause=n}}class xU{constructor(){this.ge=0,this.pe=_U(),this.ye=ra.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=Sr(),r=Sr(),i=Sr();return this.pe.forEach((n,s)=>{switch(s){case 0:t=t.add(n);break;case 2:r=r.add(n);break;case 1:i=i.add(n);break;default:rr()}}),new Yx(this.ye,this.we,t,r,i)}Fe(){this.Se=!1,this.pe=_U()}Me(t,r){this.Se=!0,this.pe=this.pe.insert(t,r)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,vi(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class w0e{constructor(t){this.Le=t,this.ke=new Map,this.qe=ad(),this.Qe=wU(),this.Ke=new zi($r)}$e(t){for(const r of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(r,t.me):this.We(r,t.key,t.me);for(const r of t.removedTargetIds)this.We(r,t.key,t.me)}Ge(t){this.forEachTarget(t,r=>{const i=this.ze(r);switch(t.state){case 0:this.je(r)&&i.Ce(t.resumeToken);break;case 1:i.Ne(),i.be||i.Fe(),i.Ce(t.resumeToken);break;case 2:i.Ne(),i.be||this.removeTarget(r);break;case 3:this.je(r)&&(i.Be(),i.Ce(t.resumeToken));break;case 4:this.je(r)&&(this.He(r),i.Ce(t.resumeToken));break;default:rr()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ke.forEach((i,n)=>{this.je(n)&&r(n)})}Je(t){const r=t.targetId,i=t.fe.count,n=this.Ye(r);if(n){const s=n.target;if(h3(s))if(i===0){const a=new Vt(s.path);this.We(r,a,Ws.newNoDocument(a,ur.min()))}else vi(i===1);else{const a=this.Ze(r);if(a!==i){const o=this.Xe(t),l=o?this.et(o,t,a):1;if(l!==0){this.He(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,c)}}}}}Xe(t){const r=t.fe.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:i="",padding:n=0},hashCount:s=0}=r;let a,o;try{a=Cp(i).toUint8Array()}catch(l){if(l instanceof oZ)return Iv("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new mB(a,n,s)}catch(l){return Iv(l instanceof o1?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Te===0?null:o}et(t,r,i){return r.fe.count===i-this.rt(t,r.targetId)?0:2}rt(t,r){const i=this.Le.getRemoteKeysForTarget(r);let n=0;return i.forEach(s=>{const a=this.Le.nt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.We(r,s,null),n++)}),n}it(t){const r=new Map;this.ke.forEach((s,a)=>{const o=this.Ye(a);if(o){if(s.current&&h3(o.target)){const l=new Vt(o.target.path);this.qe.get(l)!==null||this.st(a,l)||this.We(a,l,Ws.newNoDocument(l,t))}s.De&&(r.set(a,s.ve()),s.Fe())}});let i=Sr();this.Qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(i=i.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(t));const n=new a2(t,r,this.Ke,this.qe,i);return this.qe=ad(),this.Qe=wU(),this.Ke=new zi($r),n}Ue(t,r){if(!this.je(t))return;const i=this.st(t,r.key)?2:0;this.ze(t).Me(r.key,i),this.qe=this.qe.insert(r.key,r),this.Qe=this.Qe.insert(r.key,this.ot(r.key).add(t))}We(t,r,i){if(!this.je(t))return;const n=this.ze(t);this.st(t,r)?n.Me(r,1):n.xe(r),this.Qe=this.Qe.insert(r,this.ot(r).delete(t)),i&&(this.qe=this.qe.insert(r,i))}removeTarget(t){this.ke.delete(t)}Ze(t){const r=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let r=this.ke.get(t);return r||(r=new xU,this.ke.set(t,r)),r}ot(t){let r=this.Qe.get(t);return r||(r=new Cs($r),this.Qe=this.Qe.insert(t,r)),r}je(t){const r=this.Ye(t)!==null;return r||It("WatchChangeAggregator","Detected inactive target",t),r}Ye(t){const r=this.ke.get(t);return r&&r.be?null:this.Le._t(t)}He(t){this.ke.set(t,new xU),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.We(t,r,null)})}st(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function wU(){return new zi(Vt.comparator)}function _U(){return new zi(Vt.comparator)}const _0e=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),S0e=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),E0e=(()=>({and:"AND",or:"OR"}))();class C0e{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function m3(e,t){return e.useProto3Json||t2(t)?t:{value:t}}function TC(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function OZ(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function A0e(e,t){return TC(e,t.toTimestamp())}function Vc(e){return vi(!!e),ur.fromTimestamp(function(r){const i=zh(r);return new jn(i.seconds,i.nanos)}(e))}function gB(e,t){return function(i){return new _i(["projects",i.projectId,"databases",i.database])}(e).child("documents").child(t).canonicalString()}function LZ(e){const t=_i.fromString(e);return vi(BZ(t)),t}function g3(e,t){return gB(e.databaseId,t.path)}function YP(e,t){const r=LZ(t);if(r.get(1)!==e.databaseId.projectId)throw new Tt(Je.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Tt(Je.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Vt(NZ(r))}function v3(e,t){return gB(e.databaseId,t)}function T0e(e){const t=LZ(e);return t.length===4?_i.emptyPath():NZ(t)}function y3(e){return new _i(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function NZ(e){return vi(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function SU(e,t,r){return{name:g3(e,t),fields:r.value.mapValue.fields}}function M0e(e,t){let r;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:rr()}(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(vi(d===void 0||typeof d=="string"),ra.fromBase64String(d||"")):(vi(d===void 0||d instanceof Uint8Array),ra.fromUint8Array(d||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(c){const d=c.code===void 0?Je.UNKNOWN:IZ(c.code);return new Tt(d,c.message||"")}(a);r=new DZ(i,n,s,o||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const n=YP(e,i.document.name),s=Vc(i.document.updateTime),a=i.document.createTime?Vc(i.document.createTime):ur.min(),o=new Fa({mapValue:{fields:i.document.fields}}),l=Ws.newFoundDocument(n,s,a,o),c=i.targetIds||[],d=i.removedTargetIds||[];r=new lE(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const n=YP(e,i.document),s=i.readTime?Vc(i.readTime):ur.min(),a=Ws.newNoDocument(n,s),o=i.removedTargetIds||[];r=new lE([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const n=YP(e,i.document),s=i.removedTargetIds||[];r=new lE([],s,n,null)}else{if(!("filter"in t))return rr();{t.filter;const i=t.filter;i.targetId;const{count:n=0,unchangedNames:s}=i,a=new v0e(n,s),o=i.targetId;r=new RZ(o,a)}}return r}function P0e(e,t){let r;if(t instanceof Xx)r={update:SU(e,t.key,t.value)};else if(t instanceof PZ)r={delete:g3(e,t.key)};else if(t instanceof Qh)r={update:SU(e,t.key,t.data),updateMask:B0e(t.fieldMask)};else{if(!(t instanceof p0e))return rr();r={verify:g3(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(i=>function(s,a){const o=a.transform;if(o instanceof CC)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Lv)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ub)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof AC)return{fieldPath:a.field.canonicalString(),increment:o.Ie};throw rr()}(0,i))),t.precondition.isNone||(r.currentDocument=function(n,s){return s.updateTime!==void 0?{updateTime:A0e(n,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:rr()}(e,t.precondition)),r}function I0e(e,t){return e&&e.length>0?(vi(t!==void 0),e.map(r=>function(n,s){let a=n.updateTime?Vc(n.updateTime):Vc(s);return a.isEqual(ur.min())&&(a=Vc(s)),new d0e(a,n.transformResults||[])}(r,t))):[]}function R0e(e,t){return{documents:[v3(e,t.path)]}}function D0e(e,t){const r={structuredQuery:{}},i=t.path;t.collectionGroup!==null?(r.parent=v3(e,i),r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r.parent=v3(e,i.popLast()),r.structuredQuery.from=[{collectionId:i.lastSegment()}]);const n=function(l){if(l.length!==0)return zZ(Hl.create(l,"and"))}(t.filters);n&&(r.structuredQuery.where=n);const s=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:dg(u.field),direction:N0e(u.dir)}}(c))}(t.orderBy);s&&(r.structuredQuery.orderBy=s);const a=m3(e,t.limit);return a!==null&&(r.structuredQuery.limit=a),t.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),r}function O0e(e){let t=T0e(e.parent);const r=e.structuredQuery,i=r.from?r.from.length:0;let n=null;if(i>0){vi(i===1);const d=r.from[0];d.allDescendants?n=d.collectionId:t=t.child(d.collectionId)}let s=[];r.where&&(s=function(u){const h=kZ(u);return h instanceof Hl&&dZ(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(u){return u.map(h=>function(p){return new EC(hg(p.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(u){let h;return h=typeof u=="object"?u.value:u,t2(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(u){const h=!!u.before,f=u.values||[];return new SC(f,h)}(r.startAt));let c=null;return r.endAt&&(c=function(u){const h=!u.before,f=u.values||[];return new SC(f,h)}(r.endAt)),Qve(t,n,a,s,o,"F",l,c)}function L0e(e,t){const r=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rr()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function kZ(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const i=hg(r.unaryFilter.field);return Sn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=hg(r.unaryFilter.field);return Sn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=hg(r.unaryFilter.field);return Sn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=hg(r.unaryFilter.field);return Sn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return rr()}}(e):e.fieldFilter!==void 0?function(r){return Sn.create(hg(r.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rr()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return Hl.create(r.compositeFilter.filters.map(i=>kZ(i)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return rr()}}(r.compositeFilter.op))}(e):rr()}function N0e(e){return _0e[e]}function k0e(e){return S0e[e]}function z0e(e){return E0e[e]}function dg(e){return{fieldPath:e.canonicalString()}}function hg(e){return bs.fromServerFormat(e.fieldPath)}function zZ(e){return e instanceof Sn?function(r){if(r.op==="=="){if(cU(r.value))return{unaryFilter:{field:dg(r.field),op:"IS_NAN"}};if(lU(r.value))return{unaryFilter:{field:dg(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(cU(r.value))return{unaryFilter:{field:dg(r.field),op:"IS_NOT_NAN"}};if(lU(r.value))return{unaryFilter:{field:dg(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dg(r.field),op:k0e(r.op),value:r.value}}}(e):e instanceof Hl?function(r){const i=r.getFilters().map(n=>zZ(n));return i.length===1?i[0]:{compositeFilter:{op:z0e(r.op),filters:i}}}(e):rr()}function B0e(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function BZ(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(t,r,i,n,s=ur.min(),a=ur.min(),o=ra.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=i,this.sequenceNumber=n,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new ih(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new ih(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ih(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ih(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0e{constructor(t){this.ut=t}}function j0e(e){const t=O0e({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?p3(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0e{constructor(){this.on=new U0e}addToCollectionParentIndex(t,r){return this.on.add(r),nt.resolve()}getCollectionParents(t,r){return nt.resolve(this.on.getEntries(r))}addFieldIndex(t,r){return nt.resolve()}deleteFieldIndex(t,r){return nt.resolve()}deleteAllFieldIndexes(t){return nt.resolve()}createTargetIndexes(t,r){return nt.resolve()}getDocumentsMatchingTarget(t,r){return nt.resolve(null)}getIndexType(t,r){return nt.resolve(0)}getFieldIndexes(t,r){return nt.resolve([])}getNextCollectionGroupToUpdate(t){return nt.resolve(null)}getMinOffset(t,r){return nt.resolve(kh.min())}getMinOffsetFromCollectionGroup(t,r){return nt.resolve(kh.min())}updateCollectionGroup(t,r,i){return nt.resolve()}updateIndexEntries(t,r){return nt.resolve()}}class U0e{constructor(){this.index={}}add(t){const r=t.lastSegment(),i=t.popLast(),n=this.index[r]||new Cs(_i.comparator),s=!n.has(i);return this.index[r]=n.add(i),s}has(t){const r=t.lastSegment(),i=t.popLast(),n=this.index[r];return n&&n.has(i)}getEntries(t){return(this.index[t]||new Cs(_i.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Nv(0)}static Nn(){return new Nv(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0e{constructor(){this.changes=new g0(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Ws.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const i=this.changes.get(r);return i!==void 0?nt.resolve(i):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0e{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0e{constructor(t,r,i,n){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=n}getDocument(t,r){let i=null;return this.documentOverlayCache.getOverlay(t,r).next(n=>(i=n,this.remoteDocumentCache.getEntry(t,r))).next(n=>(i!==null&&k1(i.mutation,n,fo.empty(),jn.now()),n))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.getLocalViewOfDocuments(t,i,Sr()).next(()=>i))}getLocalViewOfDocuments(t,r,i=Sr()){const n=Bf();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,i).next(s=>{let a=a1();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const i=Bf();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,Sr()))}populateOverlays(t,r,i){const n=[];return i.forEach(s=>{r.has(s)||n.push(s)}),this.documentOverlayCache.getOverlays(t,n).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(t,r,i,n){let s=ad();const a=N1(),o=function(){return N1()}();return r.forEach((l,c)=>{const d=i.get(c.key);n.has(c.key)&&(d===void 0||d.mutation instanceof Qh)?s=s.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),k1(d.mutation,c,d.mutation.getFieldMask(),jn.now())):a.set(c.key,fo.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,d)=>a.set(c,d)),r.forEach((c,d)=>{var u;return o.set(c,new H0e(d,(u=a.get(c))!==null&&u!==void 0?u:null))}),o))}recalculateAndSaveOverlays(t,r){const i=N1();let n=new zi((a,o)=>a-o),s=Sr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let d=i.get(l)||fo.empty();d=o.applyToLocalView(c,d),i.set(l,d);const u=(n.get(o.batchId)||Sr()).add(l);n=n.insert(o.batchId,u)})}).next(()=>{const a=[],o=n.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,d=l.value,u=xZ();d.forEach(h=>{if(!s.has(h)){const f=TZ(r.get(h),i.get(h));f!==null&&u.set(h,f),s=s.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,u))}return nt.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,r,i,n){return function(a){return Vt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):mZ(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,i,n):this.getDocumentsMatchingCollectionQuery(t,r,i,n)}getNextDocuments(t,r,i,n){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,i,n).next(s=>{const a=n-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,i.largestBatchId,n-s.size):nt.resolve(Bf());let o=-1,l=s;return a.next(c=>nt.forEach(c,(d,u)=>(o<u.largestBatchId&&(o=u.largestBatchId),s.get(d)?nt.resolve():this.remoteDocumentCache.getEntry(t,d).next(h=>{l=l.insert(d,h)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,Sr())).next(d=>({batchId:o,changes:bZ(d)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Vt(r)).next(i=>{let n=a1();return i.isFoundDocument()&&(n=n.insert(i.key,i)),n})}getDocumentsMatchingCollectionGroupQuery(t,r,i,n){const s=r.collectionGroup;let a=a1();return this.indexManager.getCollectionParents(t,s).next(o=>nt.forEach(o,l=>{const c=function(u,h){return new qx(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,i,n).next(d=>{d.forEach((u,h)=>{a=a.insert(u,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,i,n){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,i,s,n))).next(a=>{s.forEach((l,c)=>{const d=c.getKey();a.get(d)===null&&(a=a.insert(d,Ws.newInvalidDocument(d)))});let o=a1();return a.forEach((l,c)=>{const d=s.get(l);d!==void 0&&k1(d.mutation,c,fo.empty(),jn.now()),i2(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0e{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,r){return nt.resolve(this.ur.get(r))}saveBundleMetadata(t,r){return this.ur.set(r.id,function(n){return{id:n.id,version:n.version,createTime:Vc(n.createTime)}}(r)),nt.resolve()}getNamedQuery(t,r){return nt.resolve(this.cr.get(r))}saveNamedQuery(t,r){return this.cr.set(r.name,function(n){return{name:n.name,query:j0e(n.bundledQuery),readTime:Vc(n.readTime)}}(r)),nt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0e{constructor(){this.overlays=new zi(Vt.comparator),this.lr=new Map}getOverlay(t,r){return nt.resolve(this.overlays.get(r))}getOverlays(t,r){const i=Bf();return nt.forEach(r,n=>this.getOverlay(t,n).next(s=>{s!==null&&i.set(n,s)})).next(()=>i)}saveOverlays(t,r,i){return i.forEach((n,s)=>{this.lt(t,r,s)}),nt.resolve()}removeOverlaysForBatchId(t,r,i){const n=this.lr.get(i);return n!==void 0&&(n.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(i)),nt.resolve()}getOverlaysForCollection(t,r,i){const n=Bf(),s=r.length+1,a=new Vt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>i&&n.set(l.getKey(),l)}return nt.resolve(n)}getOverlaysForCollectionGroup(t,r,i,n){let s=new zi((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>i){let d=s.get(c.largestBatchId);d===null&&(d=Bf(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=Bf(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=n)););return nt.resolve(o)}lt(t,r,i){const n=this.overlays.get(i.key);if(n!==null){const a=this.lr.get(n.largestBatchId).delete(i.key);this.lr.set(n.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new g0e(r,i));let s=this.lr.get(r);s===void 0&&(s=Sr(),this.lr.set(r,s)),this.lr.set(r,s.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vB{constructor(){this.hr=new Cs(Kn.Pr),this.Ir=new Cs(Kn.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,r){const i=new Kn(t,r);this.hr=this.hr.add(i),this.Ir=this.Ir.add(i)}Er(t,r){t.forEach(i=>this.addReference(i,r))}removeReference(t,r){this.dr(new Kn(t,r))}Ar(t,r){t.forEach(i=>this.removeReference(i,r))}Rr(t){const r=new Vt(new _i([])),i=new Kn(r,t),n=new Kn(r,t+1),s=[];return this.Ir.forEachInRange([i,n],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const r=new Vt(new _i([])),i=new Kn(r,t),n=new Kn(r,t+1);let s=Sr();return this.Ir.forEachInRange([i,n],a=>{s=s.add(a.key)}),s}containsKey(t){const r=new Kn(t,0),i=this.hr.firstAfterOrEqual(r);return i!==null&&t.isEqual(i.key)}}class Kn{constructor(t,r){this.key=t,this.gr=r}static Pr(t,r){return Vt.comparator(t.key,r.key)||$r(t.gr,r.gr)}static Tr(t,r){return $r(t.gr,r.gr)||Vt.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0e{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.pr=1,this.yr=new Cs(Kn.Pr)}checkEmpty(t){return nt.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,i,n){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new m0e(s,r,i,n);this.mutationQueue.push(a);for(const o of n)this.yr=this.yr.add(new Kn(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return nt.resolve(a)}lookupMutationBatch(t,r){return nt.resolve(this.wr(r))}getNextMutationBatchAfterBatchId(t,r){const i=r+1,n=this.Sr(i),s=n<0?0:n;return nt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return nt.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(t){return nt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const i=new Kn(r,0),n=new Kn(r,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([i,n],a=>{const o=this.wr(a.gr);s.push(o)}),nt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let i=new Cs($r);return r.forEach(n=>{const s=new Kn(n,0),a=new Kn(n,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],o=>{i=i.add(o.gr)})}),nt.resolve(this.br(i))}getAllMutationBatchesAffectingQuery(t,r){const i=r.path,n=i.length+1;let s=i;Vt.isDocumentKey(s)||(s=s.child(""));const a=new Kn(new Vt(s),0);let o=new Cs($r);return this.yr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===n&&(o=o.add(l.gr)),!0)},a),nt.resolve(this.br(o))}br(t){const r=[];return t.forEach(i=>{const n=this.wr(i);n!==null&&r.push(n)}),r}removeMutationBatch(t,r){vi(this.Dr(r.batchId,"removed")===0),this.mutationQueue.shift();let i=this.yr;return nt.forEach(r.mutations,n=>{const s=new Kn(n.key,r.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,n.key)}).next(()=>{this.yr=i})}Fn(t){}containsKey(t,r){const i=new Kn(r,0),n=this.yr.firstAfterOrEqual(i);return nt.resolve(r.isEqual(n&&n.key))}performConsistencyCheck(t){return this.mutationQueue.length,nt.resolve()}Dr(t,r){return this.Sr(t)}Sr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}wr(t){const r=this.Sr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0e{constructor(t){this.Cr=t,this.docs=function(){return new zi(Vt.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const i=r.key,n=this.docs.get(i),s=n?n.size:0,a=this.Cr(r);return this.docs=this.docs.insert(i,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const i=this.docs.get(r);return nt.resolve(i?i.document.mutableCopy():Ws.newInvalidDocument(r))}getEntries(t,r){let i=ad();return r.forEach(n=>{const s=this.docs.get(n);i=i.insert(n,s?s.document.mutableCopy():Ws.newInvalidDocument(n))}),nt.resolve(i)}getDocumentsMatchingQuery(t,r,i,n){let s=ad();const a=r.path,o=new Vt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Lve(Ove(d),i)<=0||(n.has(d.key)||i2(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return nt.resolve(s)}getAllFromCollectionGroup(t,r,i,n){rr()}vr(t,r){return nt.forEach(this.docs,i=>r(i))}newChangeBuffer(t){return new K0e(this)}getSize(t){return nt.resolve(this.size)}}class K0e extends $0e{constructor(t){super(),this._r=t}applyChanges(t){const r=[];return this.changes.forEach((i,n)=>{n.isValidDocument()?r.push(this._r.addEntry(t,n)):this._r.removeEntry(i)}),nt.waitFor(r)}getFromCache(t,r){return this._r.getEntry(t,r)}getAllFromCache(t,r){return this._r.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0e{constructor(t){this.persistence=t,this.Fr=new g0(r=>dB(r),hB),this.lastRemoteSnapshotVersion=ur.min(),this.highestTargetId=0,this.Mr=0,this.Or=new vB,this.targetCount=0,this.Nr=Nv.On()}forEachTarget(t,r){return this.Fr.forEach((i,n)=>r(n)),nt.resolve()}getLastRemoteSnapshotVersion(t){return nt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return nt.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),nt.resolve(this.highestTargetId)}setTargetsMetadata(t,r,i){return i&&(this.lastRemoteSnapshotVersion=i),r>this.Mr&&(this.Mr=r),nt.resolve()}kn(t){this.Fr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.Nr=new Nv(r),this.highestTargetId=r),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,r){return this.kn(r),this.targetCount+=1,nt.resolve()}updateTargetData(t,r){return this.kn(r),nt.resolve()}removeTargetData(t,r){return this.Fr.delete(r.target),this.Or.Rr(r.targetId),this.targetCount-=1,nt.resolve()}removeTargets(t,r,i){let n=0;const s=[];return this.Fr.forEach((a,o)=>{o.sequenceNumber<=r&&i.get(o.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),n++)}),nt.waitFor(s).next(()=>n)}getTargetCount(t){return nt.resolve(this.targetCount)}getTargetData(t,r){const i=this.Fr.get(r)||null;return nt.resolve(i)}addMatchingKeys(t,r,i){return this.Or.Er(r,i),nt.resolve()}removeMatchingKeys(t,r,i){this.Or.Ar(r,i);const n=this.persistence.referenceDelegate,s=[];return n&&r.forEach(a=>{s.push(n.markPotentiallyOrphaned(t,a))}),nt.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Or.Rr(r),nt.resolve()}getMatchingKeysForTargetId(t,r){const i=this.Or.mr(r);return nt.resolve(i)}containsKey(t,r){return nt.resolve(this.Or.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0e{constructor(t,r){this.Br={},this.overlays={},this.Lr=new oB(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new Q0e(this),this.indexManager=new V0e,this.remoteDocumentCache=function(n){return new Y0e(n)}(i=>this.referenceDelegate.Qr(i)),this.serializer=new F0e(r),this.Kr=new G0e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new q0e,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let i=this.Br[t.toKey()];return i||(i=new X0e(r,this.referenceDelegate),this.Br[t.toKey()]=i),i}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,r,i){It("MemoryPersistence","Starting transaction:",t);const n=new J0e(this.Lr.next());return this.referenceDelegate.$r(),i(n).next(s=>this.referenceDelegate.Ur(n).next(()=>s)).toPromise().then(s=>(n.raiseOnCommittedEvent(),s))}Wr(t,r){return nt.or(Object.values(this.Br).map(i=>()=>i.containsKey(t,r)))}}class J0e extends kve{constructor(t){super(),this.currentSequenceNumber=t}}class yB{constructor(t){this.persistence=t,this.Gr=new vB,this.zr=null}static jr(t){return new yB(t)}get Hr(){if(this.zr)return this.zr;throw rr()}addReference(t,r,i){return this.Gr.addReference(i,r),this.Hr.delete(i.toString()),nt.resolve()}removeReference(t,r,i){return this.Gr.removeReference(i,r),this.Hr.add(i.toString()),nt.resolve()}markPotentiallyOrphaned(t,r){return this.Hr.add(r.toString()),nt.resolve()}removeTarget(t,r){this.Gr.Rr(r.targetId).forEach(n=>this.Hr.add(n.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,r.targetId).next(n=>{n.forEach(s=>this.Hr.add(s.toString()))}).next(()=>i.removeTargetData(t,r))}$r(){this.zr=new Set}Ur(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return nt.forEach(this.Hr,i=>{const n=Vt.fromPath(i);return this.Jr(t,n).next(s=>{s||r.removeEntry(n,ur.min())})}).next(()=>(this.zr=null,r.apply(t)))}updateLimboDocument(t,r){return this.Jr(t,r).next(i=>{i?this.Hr.delete(r.toString()):this.Hr.add(r.toString())})}Qr(t){return 0}Jr(t,r){return nt.or([()=>nt.resolve(this.Gr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Wr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bB{constructor(t,r,i,n){this.targetId=t,this.fromCache=r,this.ki=i,this.qi=n}static Qi(t,r){let i=Sr(),n=Sr();for(const s of r.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:n=n.add(s.doc.key)}return new bB(t,r.fromCache,i,n)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eye{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tye{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,r){this.Gi=t,this.indexManager=r,this.Ki=!0}getDocumentsMatchingQuery(t,r,i,n){const s={result:null};return this.zi(t,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(t,r,n,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new eye;return this.Hi(t,r,a).next(o=>{if(s.result=o,this.$i)return this.Ji(t,r,a,o.size)})}).next(()=>s.result)}Ji(t,r,i,n){return i.documentReadCount<this.Ui?(ly()<=Ir.DEBUG&&It("QueryEngine","SDK will not create cache indexes for query:",ug(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),nt.resolve()):(ly()<=Ir.DEBUG&&It("QueryEngine","Query:",ug(r),"scans",i.documentReadCount,"local documents and returns",n,"documents as results."),i.documentReadCount>this.Wi*n?(ly()<=Ir.DEBUG&&It("QueryEngine","The SDK decides to create cache indexes for query:",ug(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,jc(r))):nt.resolve())}zi(t,r){if(fU(r))return nt.resolve(null);let i=jc(r);return this.indexManager.getIndexType(t,i).next(n=>n===0?null:(r.limit!==null&&n===1&&(r=p3(r,null,"F"),i=jc(r)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const a=Sr(...s);return this.Gi.getDocuments(t,a).next(o=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.Yi(r,o);return this.Zi(r,c,a,l.readTime)?this.zi(t,p3(r,null,"F")):this.Xi(t,c,r,l)}))})))}ji(t,r,i,n){return fU(r)||n.isEqual(ur.min())?nt.resolve(null):this.Gi.getDocuments(t,i).next(s=>{const a=this.Yi(r,s);return this.Zi(r,a,i,n)?nt.resolve(null):(ly()<=Ir.DEBUG&&It("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ug(r)),this.Xi(t,a,r,Dve(n,-1)).next(o=>o))})}Yi(t,r){let i=new Cs(vZ(t));return r.forEach((n,s)=>{i2(t,s)&&(i=i.add(s))}),i}Zi(t,r,i,n){if(t.limit===null)return!1;if(i.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(n)>0)}Hi(t,r,i){return ly()<=Ir.DEBUG&&It("QueryEngine","Using full collection scan to execute query:",ug(r)),this.Gi.getDocumentsMatchingQuery(t,r,kh.min(),i)}Xi(t,r,i,n){return this.Gi.getDocumentsMatchingQuery(t,i,n).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rye{constructor(t,r,i,n){this.persistence=t,this.es=r,this.serializer=n,this.ts=new zi($r),this.ns=new g0(s=>dB(s),hB),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(i)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new W0e(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.ts))}}function iye(e,t,r,i){return new rye(e,t,r,i)}async function FZ(e,t){const r=gr(e);return await r.persistence.runTransaction("Handle user change","readonly",i=>{let n;return r.mutationQueue.getAllMutationBatches(i).next(s=>(n=s,r.os(t),r.mutationQueue.getAllMutationBatches(i))).next(s=>{const a=[],o=[];let l=Sr();for(const c of n){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return r.localDocuments.getDocuments(i,l).next(c=>({_s:c,removedBatchIds:a,addedBatchIds:o}))})})}function nye(e,t){const r=gr(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const n=t.batch.keys(),s=r.ss.newChangeBuffer({trackRemovals:!0});return function(o,l,c,d){const u=c.batch,h=u.keys();let f=nt.resolve();return h.forEach(p=>{f=f.next(()=>d.getEntry(l,p)).next(m=>{const g=c.docVersions.get(p);vi(g!==null),m.version.compareTo(g)<0&&(u.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),d.addEntry(m)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(l,u))}(r,i,t,s).next(()=>s.apply(i)).next(()=>r.mutationQueue.performConsistencyCheck(i)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(i,n,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(o){let l=Sr();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(i,n))})}function jZ(e){const t=gr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.qr.getLastRemoteSnapshotVersion(r))}function sye(e,t){const r=gr(e),i=t.snapshotVersion;let n=r.ts;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.ss.newChangeBuffer({trackRemovals:!0});n=r.ts;const o=[];t.targetChanges.forEach((d,u)=>{const h=n.get(u);if(!h)return;o.push(r.qr.removeMatchingKeys(s,d.removedDocuments,u).next(()=>r.qr.addMatchingKeys(s,d.addedDocuments,u)));let f=h.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(u)!==null?f=f.withResumeToken(ra.EMPTY_BYTE_STRING,ur.min()).withLastLimboFreeSnapshotVersion(ur.min()):d.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(d.resumeToken,i)),n=n.insert(u,f),function(m,g,v){return m.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(h,f,d)&&o.push(r.qr.updateTargetData(s,f))});let l=ad(),c=Sr();if(t.documentUpdates.forEach(d=>{t.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(aye(s,a,t.documentUpdates).next(d=>{l=d.us,c=d.cs})),!i.isEqual(ur.min())){const d=r.qr.getLastRemoteSnapshotVersion(s).next(u=>r.qr.setTargetsMetadata(s,s.currentSequenceNumber,i));o.push(d)}return nt.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.ts=n,s))}function aye(e,t,r){let i=Sr(),n=Sr();return r.forEach(s=>i=i.add(s)),t.getEntries(e,i).next(s=>{let a=ad();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(n=n.add(o)),l.isNoDocument()&&l.version.isEqual(ur.min())?(t.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(o,l)):It("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{us:a,cs:n}})}function oye(e,t){const r=gr(e);return r.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function lye(e,t){const r=gr(e);return r.persistence.runTransaction("Allocate target","readwrite",i=>{let n;return r.qr.getTargetData(i,t).next(s=>s?(n=s,nt.resolve(n)):r.qr.allocateTargetId(i).next(a=>(n=new ih(t,a,"TargetPurposeListen",i.currentSequenceNumber),r.qr.addTargetData(i,n).next(()=>n))))}).then(i=>{const n=r.ts.get(i.targetId);return(n===null||i.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.ts=r.ts.insert(i.targetId,i),r.ns.set(t,i.targetId)),i})}async function b3(e,t,r){const i=gr(e),n=i.ts.get(t),s=r?"readwrite":"readwrite-primary";try{r||await i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,n))}catch(a){if(!Gx(a))throw a;It("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}i.ts=i.ts.remove(t),i.ns.delete(n.target)}function EU(e,t,r){const i=gr(e);let n=ur.min(),s=Sr();return i.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,d){const u=gr(l),h=u.ns.get(d);return h!==void 0?nt.resolve(u.ts.get(h)):u.qr.getTargetData(c,d)}(i,a,jc(t)).next(o=>{if(o)return n=o.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>i.es.getDocumentsMatchingQuery(a,t,r?n:ur.min(),r?s:Sr())).next(o=>(cye(i,Jve(t),o),{documents:o,ls:s})))}function cye(e,t,r){let i=e.rs.get(t)||ur.min();r.forEach((n,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),e.rs.set(t,i)}class CU{constructor(){this.activeTargetIds=s0e()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class uye{constructor(){this.eo=new CU,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,i){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,r,i){this.no[t]=r}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new CU,Promise.resolve()}handleUserChange(t,r,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dye{ro(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){It("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){It("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n_=null;function KP(){return n_===null?n_=function(){return 268435456+Math.round(2147483648*Math.random())}():n_++,"0x"+n_.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hye={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fye{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs="WebChannelConnection";class pye extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const i=r.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=i+"://"+r.host,this.fo=`projects/${n}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${n}`:`project_id=${n}&database_id=${s}`}get yo(){return!1}wo(r,i,n,s,a){const o=KP(),l=this.So(r,i);It("RestConnection",`Sending RPC '${r}' ${o}:`,l,n);const c={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(c,s,a),this.Do(r,l,c,n).then(d=>(It("RestConnection",`Received RPC '${r}' ${o}: `,d),d),d=>{throw Iv("RestConnection",`RPC '${r}' ${o} failed with error: `,d,"url: ",l,"request:",n),d})}Co(r,i,n,s,a,o){return this.wo(r,i,n,s,a)}bo(r,i,n){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+m0}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,a)=>r[a]=s),n&&n.headers.forEach((s,a)=>r[a]=s)}So(r,i){const n=hye[r];return`${this.mo}/v1/${i}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,r,i,n){const s=KP();return new Promise((a,o)=>{const l=new wve;l.setWithCredentials(!0),l.listenOnce(bve.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case XP.NO_ERROR:const d=l.getResponseJson();It(Bs,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(d)),a(d);break;case XP.TIMEOUT:It(Bs,`RPC '${t}' ${s} timed out`),o(new Tt(Je.DEADLINE_EXCEEDED,"Request time out"));break;case XP.HTTP_ERROR:const u=l.getStatus();if(It(Bs,`RPC '${t}' ${s} failed with status:`,u,"response text:",l.getResponseText()),u>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const f=h==null?void 0:h.error;if(f&&f.status&&f.message){const p=function(g){const v=g.toLowerCase().replace(/_/g,"-");return Object.values(Je).indexOf(v)>=0?v:Je.UNKNOWN}(f.status);o(new Tt(p,f.message))}else o(new Tt(Je.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Tt(Je.UNAVAILABLE,"Connection failed."));break;default:rr()}}finally{It(Bs,`RPC '${t}' ${s} completed.`)}});const c=JSON.stringify(n);It(Bs,`RPC '${t}' ${s} sending request:`,n),l.send(r,"POST",c,i,15)})}vo(t,r,i){const n=KP(),s=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=vve(),o=yve(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.bo(l.initMessageHeaders,r,i),l.encodeInitMessageHeaders=!0;const d=s.join("");It(Bs,`Creating RPC '${t}' stream ${n}: ${d}`,l);const u=a.createWebChannel(d,l);let h=!1,f=!1;const p=new fye({co:g=>{f?It(Bs,`Not sending because RPC '${t}' stream ${n} is closed:`,g):(h||(It(Bs,`Opening RPC '${t}' stream ${n} transport.`),u.open(),h=!0),It(Bs,`RPC '${t}' stream ${n} sending:`,g),u.send(g))},lo:()=>u.close()}),m=(g,v,y)=>{g.listen(v,b=>{try{y(b)}catch(x){setTimeout(()=>{throw x},0)}})};return m(u,t_.EventType.OPEN,()=>{f||It(Bs,`RPC '${t}' stream ${n} transport opened.`)}),m(u,t_.EventType.CLOSE,()=>{f||(f=!0,It(Bs,`RPC '${t}' stream ${n} transport closed`),p.Ro())}),m(u,t_.EventType.ERROR,g=>{f||(f=!0,Iv(Bs,`RPC '${t}' stream ${n} transport errored:`,g),p.Ro(new Tt(Je.UNAVAILABLE,"The operation could not be completed")))}),m(u,t_.EventType.MESSAGE,g=>{var v;if(!f){const y=g.data[0];vi(!!y);const b=y,x=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(x){It(Bs,`RPC '${t}' stream ${n} received error:`,x);const S=x.status;let w=function(T){const A=vn[T];if(A!==void 0)return IZ(A)}(S),E=x.message;w===void 0&&(w=Je.INTERNAL,E="Unknown error status: "+S+" with message "+x.message),f=!0,p.Ro(new Tt(w,E)),u.close()}else It(Bs,`RPC '${t}' stream ${n} received:`,y),p.Vo(y)}}),m(o,xve.STAT_EVENT,g=>{g.stat===rU.PROXY?It(Bs,`RPC '${t}' stream ${n} detected buffering proxy`):g.stat===rU.NOPROXY&&It(Bs,`RPC '${t}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{p.Ao()},0),p}}function QP(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(e){return new C0e(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VZ{constructor(t,r,i=1e3,n=1.5,s=6e4){this.si=t,this.timerId=r,this.Fo=i,this.Mo=n,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const r=Math.floor(this.Oo+this.qo()),i=Math.max(0,Date.now()-this.Bo),n=Math.max(0,r-i);n>0&&It("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.Oo} ms, delay with jitter: ${r} ms, last attempt: ${i} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,n,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UZ{constructor(t,r,i,n,s,a,o,l){this.si=t,this.Ko=i,this.$o=n,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new VZ(t,r)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,r){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,t!==4?this.zo.reset():r&&r.code===Je.RESOURCE_EXHAUSTED?(sd(r.toString()),sd("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):r&&r.code===Je.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(r)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),r=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,n])=>{this.Uo===r&&this.s_(i,n)},i=>{t(()=>{const n=new Tt(Je.UNKNOWN,"Fetching auth token failed: "+i.message);return this.o_(n)})})}s_(t,r){const i=this.i_(this.Uo);this.stream=this.__(t,r),this.stream.ho(()=>{i(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(n=>{i(()=>this.o_(n))}),this.stream.onMessage(n=>{i(()=>this.onMessage(n))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(t){return It("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return r=>{this.si.enqueueAndForget(()=>this.Uo===t?r():(It("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mye extends UZ{constructor(t,r,i,n,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,n,a),this.serializer=s}__(t,r){return this.connection.vo("Listen",t,r)}onMessage(t){this.zo.reset();const r=M0e(this.serializer,t),i=function(s){if(!("targetChange"in s))return ur.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ur.min():a.readTime?Vc(a.readTime):ur.min()}(t);return this.listener.a_(r,i)}u_(t){const r={};r.database=y3(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=h3(l)?{documents:R0e(s,l)}:{query:D0e(s,l)},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=OZ(s,a.resumeToken);const c=m3(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(ur.min())>0){o.readTime=TC(s,a.snapshotVersion.toTimestamp());const c=m3(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const i=L0e(this.serializer,t);i&&(r.labels=i),this.e_(r)}c_(t){const r={};r.database=y3(this.serializer),r.removeTarget=t,this.e_(r)}}class gye extends UZ{constructor(t,r,i,n,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,n,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,r){return this.connection.vo("Write",t,r)}onMessage(t){if(vi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const r=I0e(t.writeResults,t.commitTime),i=Vc(t.commitTime);return this.listener.I_(i,r)}return vi(!t.writeResults||t.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=y3(this.serializer),this.e_(t)}P_(t){const r={streamToken:this.lastStreamToken,writes:t.map(i=>P0e(this.serializer,i))};this.e_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vye extends class{}{constructor(t,r,i,n){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=i,this.serializer=n,this.d_=!1}A_(){if(this.d_)throw new Tt(Je.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([n,s])=>this.connection.wo(t,r,i,n,s)).catch(n=>{throw n.name==="FirebaseError"?(n.code===Je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),n):new Tt(Je.UNKNOWN,n.toString())})}Co(t,r,i,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(t,r,i,s,a,n)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Tt(Je.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class yye{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,t==="Online"&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(sd(r),this.f_=!1):It("OnlineStateTracker",r)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bye{constructor(t,r,i,n,s){this.localStore=t,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{i.enqueueAndForget(async()=>{Yp(this)&&(It("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=gr(l);c.C_.add(4),await Kx(c),c.M_.set("Unknown"),c.C_.delete(4),await l2(c)}(this))})}),this.M_=new yye(i,n)}}async function l2(e){if(Yp(e))for(const t of e.v_)await t(!0)}async function Kx(e){for(const t of e.v_)await t(!1)}function $Z(e,t){const r=gr(e);r.D_.has(t.targetId)||(r.D_.set(t.targetId,t),_B(r)?wB(r):v0(r).Ho()&&xB(r,t))}function HZ(e,t){const r=gr(e),i=v0(r);r.D_.delete(t),i.Ho()&&WZ(r,t),r.D_.size===0&&(i.Ho()?i.Zo():Yp(r)&&r.M_.set("Unknown"))}function xB(e,t){if(e.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ur.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}v0(e).u_(t)}function WZ(e,t){e.x_.Oe(t),v0(e).c_(t)}function wB(e){e.x_=new w0e({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.D_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),v0(e).start(),e.M_.g_()}function _B(e){return Yp(e)&&!v0(e).jo()&&e.D_.size>0}function Yp(e){return gr(e).C_.size===0}function GZ(e){e.x_=void 0}async function xye(e){e.D_.forEach((t,r)=>{xB(e,t)})}async function wye(e,t){GZ(e),_B(e)?(e.M_.w_(t),wB(e)):e.M_.set("Unknown")}async function _ye(e,t,r){if(e.M_.set("Online"),t instanceof DZ&&t.state===2&&t.cause)try{await async function(n,s){const a=s.cause;for(const o of s.targetIds)n.D_.has(o)&&(await n.remoteSyncer.rejectListen(o,a),n.D_.delete(o),n.x_.removeTarget(o))}(e,t)}catch(i){It("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await MC(e,i)}else if(t instanceof lE?e.x_.$e(t):t instanceof RZ?e.x_.Je(t):e.x_.Ge(t),!r.isEqual(ur.min()))try{const i=await jZ(e.localStore);r.compareTo(i)>=0&&await function(s,a){const o=s.x_.it(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.D_.get(c);d&&s.D_.set(c,d.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const d=s.D_.get(l);if(!d)return;s.D_.set(l,d.withResumeToken(ra.EMPTY_BYTE_STRING,d.snapshotVersion)),WZ(s,l);const u=new ih(d.target,l,c,d.sequenceNumber);xB(s,u)}),s.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(i){It("RemoteStore","Failed to raise snapshot:",i),await MC(e,i)}}async function MC(e,t,r){if(!Gx(t))throw t;e.C_.add(1),await Kx(e),e.M_.set("Offline"),r||(r=()=>jZ(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{It("RemoteStore","Retrying IndexedDB access"),await r(),e.C_.delete(1),await l2(e)})}function qZ(e,t){return t().catch(r=>MC(e,r,t))}async function c2(e){const t=gr(e),r=Bh(t);let i=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;Sye(t);)try{const n=await oye(t.localStore,i);if(n===null){t.b_.length===0&&r.Zo();break}i=n.batchId,Eye(t,n)}catch(n){await MC(t,n)}XZ(t)&&YZ(t)}function Sye(e){return Yp(e)&&e.b_.length<10}function Eye(e,t){e.b_.push(t);const r=Bh(e);r.Ho()&&r.h_&&r.P_(t.mutations)}function XZ(e){return Yp(e)&&!Bh(e).jo()&&e.b_.length>0}function YZ(e){Bh(e).start()}async function Cye(e){Bh(e).E_()}async function Aye(e){const t=Bh(e);for(const r of e.b_)t.P_(r.mutations)}async function Tye(e,t,r){const i=e.b_.shift(),n=pB.from(i,t,r);await qZ(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),await c2(e)}async function Mye(e,t){t&&Bh(e).h_&&await async function(i,n){if(function(a){return y0e(a)&&a!==Je.ABORTED}(n.code)){const s=i.b_.shift();Bh(i).Yo(),await qZ(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,n)),await c2(i)}}(e,t),XZ(e)&&YZ(e)}async function TU(e,t){const r=gr(e);r.asyncQueue.verifyOperationInProgress(),It("RemoteStore","RemoteStore received new credentials");const i=Yp(r);r.C_.add(3),await Kx(r),i&&r.M_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.C_.delete(3),await l2(r)}async function Pye(e,t){const r=gr(e);t?(r.C_.delete(2),await l2(r)):t||(r.C_.add(2),await Kx(r),r.M_.set("Unknown"))}function v0(e){return e.O_||(e.O_=function(r,i,n){const s=gr(r);return s.A_(),new mye(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{ho:xye.bind(null,e),Io:wye.bind(null,e),a_:_ye.bind(null,e)}),e.v_.push(async t=>{t?(e.O_.Yo(),_B(e)?wB(e):e.M_.set("Unknown")):(await e.O_.stop(),GZ(e))})),e.O_}function Bh(e){return e.N_||(e.N_=function(r,i,n){const s=gr(r);return s.A_(),new gye(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{ho:Cye.bind(null,e),Io:Mye.bind(null,e),T_:Aye.bind(null,e),I_:Tye.bind(null,e)}),e.v_.push(async t=>{t?(e.N_.Yo(),await c2(e)):(await e.N_.stop(),e.b_.length>0&&(It("RemoteStore",`Stopping write stream with ${e.b_.length} pending writes`),e.b_=[]))})),e.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{constructor(t,r,i,n,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=i,this.op=n,this.removalCallback=s,this.deferred=new Gu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,i,n,s){const a=Date.now()+i,o=new SB(t,r,a,n,s);return o.start(i),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Tt(Je.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function EB(e,t){if(sd("AsyncQueue",`${t}: ${e}`),Gx(e))return new Tt(Je.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(t){this.comparator=t?(r,i)=>t(r,i)||Vt.comparator(r.key,i.key):(r,i)=>Vt.comparator(r.key,i.key),this.keyedMap=a1(),this.sortedSet=new zi(this.comparator)}static emptySet(t){return new iv(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,i)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof iv)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;r.hasNext();){const n=r.getNext().key,s=i.getNext().key;if(!n.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const i=new iv;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=r,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(){this.B_=new zi(Vt.comparator)}track(t){const r=t.doc.key,i=this.B_.get(r);i?t.type!==0&&i.type===3?this.B_=this.B_.insert(r,t):t.type===3&&i.type!==1?this.B_=this.B_.insert(r,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.B_=this.B_.insert(r,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.B_=this.B_.remove(r):t.type===1&&i.type===2?this.B_=this.B_.insert(r,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):rr():this.B_=this.B_.insert(r,t)}L_(){const t=[];return this.B_.inorderTraversal((r,i)=>{t.push(i)}),t}}class kv{constructor(t,r,i,n,s,a,o,l,c){this.query=t,this.docs=r,this.oldDocs=i,this.docChanges=n,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,i,n,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new kv(t,r,iv.emptySet(r),a,i,n,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&r2(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,i=t.docChanges;if(r.length!==i.length)return!1;for(let n=0;n<r.length;n++)if(r[n].type!==i[n].type||!r[n].doc.isEqual(i[n].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iye{constructor(){this.k_=void 0,this.listeners=[]}}class Rye{constructor(){this.queries=new g0(t=>gZ(t),r2),this.onlineState="Unknown",this.q_=new Set}}async function KZ(e,t){const r=gr(e),i=t.query;let n=!1,s=r.queries.get(i);if(s||(n=!0,s=new Iye),n)try{s.k_=await r.onListen(i)}catch(a){const o=EB(a,`Initialization of query '${ug(t.query)}' failed`);return void t.onError(o)}r.queries.set(i,s),s.listeners.push(t),t.Q_(r.onlineState),s.k_&&t.K_(s.k_)&&CB(r)}async function QZ(e,t){const r=gr(e),i=t.query;let n=!1;const s=r.queries.get(i);if(s){const a=s.listeners.indexOf(t);a>=0&&(s.listeners.splice(a,1),n=s.listeners.length===0)}if(n)return r.queries.delete(i),r.onUnlisten(i)}function Dye(e,t){const r=gr(e);let i=!1;for(const n of t){const s=n.query,a=r.queries.get(s);if(a){for(const o of a.listeners)o.K_(n)&&(i=!0);a.k_=n}}i&&CB(r)}function Oye(e,t,r){const i=gr(e),n=i.queries.get(t);if(n)for(const s of n.listeners)s.onError(r);i.queries.delete(t)}function CB(e){e.q_.forEach(t=>{t.next()})}class ZZ{constructor(t,r,i){this.query=t,this.U_=r,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=i||{}}K_(t){if(!this.options.includeMetadataChanges){const i=[];for(const n of t.docChanges)n.type!==3&&i.push(n);t=new kv(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.W_?this.z_(t)&&(this.U_.next(t),r=!0):this.j_(t,this.onlineState)&&(this.H_(t),r=!0),this.G_=t,r}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let r=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),r=!0),r}j_(t,r){if(!t.fromCache)return!0;const i=r!=="Offline";return(!this.options.J_||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}z_(t){if(t.docChanges.length>0)return!0;const r=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}H_(t){t=kv.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JZ{constructor(t){this.key=t}}class eJ{constructor(t){this.key=t}}class Lye{constructor(t,r){this.query=t,this.ia=r,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Sr(),this.mutatedKeys=Sr(),this._a=vZ(t),this.aa=new iv(this._a)}get ua(){return this.ia}ca(t,r){const i=r?r.la:new MU,n=r?r.aa:this.aa;let s=r?r.mutatedKeys:this.mutatedKeys,a=n,o=!1;const l=this.query.limitType==="F"&&n.size===this.query.limit?n.last():null,c=this.query.limitType==="L"&&n.size===this.query.limit?n.first():null;if(t.inorderTraversal((d,u)=>{const h=n.get(d),f=i2(this.query,u)?u:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let g=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(i.track({type:3,doc:f}),g=!0):this.ha(h,f)||(i.track({type:2,doc:f}),g=!0,(l&&this._a(f,l)>0||c&&this._a(f,c)<0)&&(o=!0)):!h&&f?(i.track({type:0,doc:f}),g=!0):h&&!f&&(i.track({type:1,doc:h}),g=!0,(l||c)&&(o=!0)),g&&(f?(a=a.add(f),s=m?s.add(d):s.delete(d)):(a=a.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),s=s.delete(d.key),i.track({type:1,doc:d})}return{aa:a,la:i,Zi:o,mutatedKeys:s}}ha(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,i,n){const s=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const a=t.la.L_();a.sort((d,u)=>function(f,p){const m=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rr()}};return m(f)-m(p)}(d.type,u.type)||this._a(d.doc,u.doc)),this.Pa(i),n=n!=null&&n;const o=r&&!n?this.Ia():[],l=this.oa.size===0&&this.current&&!n?1:0,c=l!==this.sa;return this.sa=l,a.length!==0||c?{snapshot:new kv(this.query,t.aa,s,a,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new MU,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(r=>this.ia=this.ia.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.ia=this.ia.delete(r)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=Sr(),this.aa.forEach(i=>{this.Ea(i.key)&&(this.oa=this.oa.add(i.key))});const r=[];return t.forEach(i=>{this.oa.has(i)||r.push(new eJ(i))}),this.oa.forEach(i=>{t.has(i)||r.push(new JZ(i))}),r}da(t){this.ia=t.ls,this.oa=Sr();const r=this.ca(t.documents);return this.applyChanges(r,!0)}Aa(){return kv.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class Nye{constructor(t,r,i){this.query=t,this.targetId=r,this.view=i}}class kye{constructor(t){this.key=t,this.Ra=!1}}class zye{constructor(t,r,i,n,s,a){this.localStore=t,this.remoteStore=r,this.eventManager=i,this.sharedClientState=n,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new g0(o=>gZ(o),r2),this.fa=new Map,this.ga=new Set,this.pa=new zi(Vt.comparator),this.ya=new Map,this.wa=new vB,this.Sa={},this.ba=new Map,this.Da=Nv.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function Bye(e,t){const r=Xye(e);let i,n;const s=r.ma.get(t);if(s)i=s.targetId,r.sharedClientState.addLocalQueryTarget(i),n=s.view.Aa();else{const a=await lye(r.localStore,jc(t)),o=r.sharedClientState.addLocalQueryTarget(a.targetId);i=a.targetId,n=await Fye(r,t,i,o==="current",a.resumeToken),r.isPrimaryClient&&$Z(r.remoteStore,a)}return n}async function Fye(e,t,r,i,n){e.va=(u,h,f)=>async function(m,g,v,y){let b=g.view.ca(v);b.Zi&&(b=await EU(m.localStore,g.query,!1).then(({documents:E})=>g.view.ca(E,b)));const x=y&&y.targetChanges.get(g.targetId),S=y&&y.targetMismatches.get(g.targetId)!=null,w=g.view.applyChanges(b,m.isPrimaryClient,x,S);return IU(m,g.targetId,w.Ta),w.snapshot}(e,u,h,f);const s=await EU(e.localStore,t,!0),a=new Lye(t,s.ls),o=a.ca(s.documents),l=Yx.createSynthesizedTargetChangeForCurrentChange(r,i&&e.onlineState!=="Offline",n),c=a.applyChanges(o,e.isPrimaryClient,l);IU(e,r,c.Ta);const d=new Nye(t,r,a);return e.ma.set(t,d),e.fa.has(r)?e.fa.get(r).push(t):e.fa.set(r,[t]),c.snapshot}async function jye(e,t){const r=gr(e),i=r.ma.get(t),n=r.fa.get(i.targetId);if(n.length>1)return r.fa.set(i.targetId,n.filter(s=>!r2(s,t))),void r.ma.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await b3(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),HZ(r.remoteStore,i.targetId),x3(r,i.targetId)}).catch(Wx)):(x3(r,i.targetId),await b3(r.localStore,i.targetId,!0))}async function Vye(e,t,r){const i=Yye(e);try{const n=await function(a,o){const l=gr(a),c=jn.now(),d=o.reduce((f,p)=>f.add(p.key),Sr());let u,h;return l.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=ad(),m=Sr();return l.ss.getEntries(f,d).next(g=>{p=g,p.forEach((v,y)=>{y.isValidDocument()||(m=m.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(f,p)).next(g=>{u=g;const v=[];for(const y of o){const b=f0e(y,u.get(y.key).overlayedDocument);b!=null&&v.push(new Qh(y.key,b,lZ(b.value.mapValue),zl.exists(!0)))}return l.mutationQueue.addMutationBatch(f,c,v,o)}).next(g=>{h=g;const v=g.applyToLocalDocumentSet(u,m);return l.documentOverlayCache.saveOverlays(f,g.batchId,v)})}).then(()=>({batchId:h.batchId,changes:bZ(u)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(n.batchId),function(a,o,l){let c=a.Sa[a.currentUser.toKey()];c||(c=new zi($r)),c=c.insert(o,l),a.Sa[a.currentUser.toKey()]=c}(i,n.batchId,r),await Qx(i,n.changes),await c2(i.remoteStore)}catch(n){const s=EB(n,"Failed to persist write");r.reject(s)}}async function tJ(e,t){const r=gr(e);try{const i=await sye(r.localStore,t);t.targetChanges.forEach((n,s)=>{const a=r.ya.get(s);a&&(vi(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1),n.addedDocuments.size>0?a.Ra=!0:n.modifiedDocuments.size>0?vi(a.Ra):n.removedDocuments.size>0&&(vi(a.Ra),a.Ra=!1))}),await Qx(r,i,t)}catch(i){await Wx(i)}}function PU(e,t,r){const i=gr(e);if(i.isPrimaryClient&&r===0||!i.isPrimaryClient&&r===1){const n=[];i.ma.forEach((s,a)=>{const o=a.view.Q_(t);o.snapshot&&n.push(o.snapshot)}),function(a,o){const l=gr(a);l.onlineState=o;let c=!1;l.queries.forEach((d,u)=>{for(const h of u.listeners)h.Q_(o)&&(c=!0)}),c&&CB(l)}(i.eventManager,t),n.length&&i.Va.a_(n),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Uye(e,t,r){const i=gr(e);i.sharedClientState.updateQueryState(t,"rejected",r);const n=i.ya.get(t),s=n&&n.key;if(s){let a=new zi(Vt.comparator);a=a.insert(s,Ws.newNoDocument(s,ur.min()));const o=Sr().add(s),l=new a2(ur.min(),new Map,new zi($r),a,o);await tJ(i,l),i.pa=i.pa.remove(s),i.ya.delete(t),AB(i)}else await b3(i.localStore,t,!1).then(()=>x3(i,t,r)).catch(Wx)}async function $ye(e,t){const r=gr(e),i=t.batch.batchId;try{const n=await nye(r.localStore,t);iJ(r,i,null),rJ(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),await Qx(r,n)}catch(n){await Wx(n)}}async function Hye(e,t,r){const i=gr(e);try{const n=await function(a,o){const l=gr(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,o).next(u=>(vi(u!==null),d=u.keys(),l.mutationQueue.removeMutationBatch(c,u))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(i.localStore,t);iJ(i,t,r),rJ(i,t),i.sharedClientState.updateMutationState(t,"rejected",r),await Qx(i,n)}catch(n){await Wx(n)}}function rJ(e,t){(e.ba.get(t)||[]).forEach(r=>{r.resolve()}),e.ba.delete(t)}function iJ(e,t,r){const i=gr(e);let n=i.Sa[i.currentUser.toKey()];if(n){const s=n.get(t);s&&(r?s.reject(r):s.resolve(),n=n.remove(t)),i.Sa[i.currentUser.toKey()]=n}}function x3(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.fa.get(t))e.ma.delete(i),r&&e.Va.Fa(i,r);e.fa.delete(t),e.isPrimaryClient&&e.wa.Rr(t).forEach(i=>{e.wa.containsKey(i)||nJ(e,i)})}function nJ(e,t){e.ga.delete(t.path.canonicalString());const r=e.pa.get(t);r!==null&&(HZ(e.remoteStore,r),e.pa=e.pa.remove(t),e.ya.delete(r),AB(e))}function IU(e,t,r){for(const i of r)i instanceof JZ?(e.wa.addReference(i.key,t),Wye(e,i)):i instanceof eJ?(It("SyncEngine","Document no longer in limbo: "+i.key),e.wa.removeReference(i.key,t),e.wa.containsKey(i.key)||nJ(e,i.key)):rr()}function Wye(e,t){const r=t.key,i=r.path.canonicalString();e.pa.get(r)||e.ga.has(i)||(It("SyncEngine","New document in limbo: "+r),e.ga.add(i),AB(e))}function AB(e){for(;e.ga.size>0&&e.pa.size<e.maxConcurrentLimboResolutions;){const t=e.ga.values().next().value;e.ga.delete(t);const r=new Vt(_i.fromString(t)),i=e.Da.next();e.ya.set(i,new kye(r)),e.pa=e.pa.insert(r,i),$Z(e.remoteStore,new ih(jc(fB(r.path)),i,"TargetPurposeLimboResolution",oB._e))}}async function Qx(e,t,r){const i=gr(e),n=[],s=[],a=[];i.ma.isEmpty()||(i.ma.forEach((o,l)=>{a.push(i.va(l,t,r).then(c=>{if((c||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){n.push(c);const d=bB.Qi(l.targetId,c);s.push(d)}}))}),await Promise.all(a),i.Va.a_(n),await async function(l,c){const d=gr(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>nt.forEach(c,h=>nt.forEach(h.ki,f=>d.persistence.referenceDelegate.addReference(u,h.targetId,f)).next(()=>nt.forEach(h.qi,f=>d.persistence.referenceDelegate.removeReference(u,h.targetId,f)))))}catch(u){if(!Gx(u))throw u;It("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const f=d.ts.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);d.ts=d.ts.insert(h,m)}}}(i.localStore,s))}async function Gye(e,t){const r=gr(e);if(!r.currentUser.isEqual(t)){It("SyncEngine","User change. New user:",t.toKey());const i=await FZ(r.localStore,t);r.currentUser=t,function(s,a){s.ba.forEach(o=>{o.forEach(l=>{l.reject(new Tt(Je.CANCELLED,a))})}),s.ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await Qx(r,i._s)}}function qye(e,t){const r=gr(e),i=r.ya.get(t);if(i&&i.Ra)return Sr().add(i.key);{let n=Sr();const s=r.fa.get(t);if(!s)return n;for(const a of s){const o=r.ma.get(a);n=n.unionWith(o.view.ua)}return n}}function Xye(e){const t=gr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=tJ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=qye.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Uye.bind(null,t),t.Va.a_=Dye.bind(null,t.eventManager),t.Va.Fa=Oye.bind(null,t.eventManager),t}function Yye(e){const t=gr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=$ye.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Hye.bind(null,t),t}class RU{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=o2(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return iye(this.persistence,new tye,t.initialUser,this.serializer)}createPersistence(t){return new Z0e(yB.jr,this.serializer)}createSharedClientState(t){return new uye}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Kye{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>PU(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gye.bind(null,this.syncEngine),await Pye(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new Rye}()}createDatastore(t){const r=o2(t.databaseInfo.databaseId),i=function(s){return new pye(s)}(t.databaseInfo);return function(s,a,o,l){return new vye(s,a,o,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,n,s,a,o){return new bye(i,n,s,a,o)}(this.localStore,this.datastore,t.asyncQueue,r=>PU(this.syncEngine,r,0),function(){return AU.D()?new AU:new dye}())}createSyncEngine(t,r){return function(n,s,a,o,l,c,d){const u=new zye(n,s,a,o,l,c);return d&&(u.Ca=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return async function(r){const i=gr(r);It("RemoteStore","RemoteStore shutting down."),i.C_.add(5),await Kx(i),i.F_.shutdown(),i.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sJ{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):sd("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,r){this.muted||setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qye{constructor(t,r,i,n){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=n,this.user=Vs.UNAUTHENTICATED,this.clientId=sZ.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async s=>{It("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(It("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Tt(Je.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Gu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=EB(r,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function ZP(e,t){e.asyncQueue.verifyOperationInProgress(),It("FirestoreClient","Initializing OfflineComponentProvider");const r=await e.getConfiguration();await t.initialize(r);let i=r.initialUser;e.setCredentialChangeListener(async n=>{i.isEqual(n)||(await FZ(t.localStore,n),i=n)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function DU(e,t){e.asyncQueue.verifyOperationInProgress();const r=await Jye(e);It("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(r,i),e.setCredentialChangeListener(n=>TU(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>TU(t.remoteStore,s)),e._onlineComponents=t}function Zye(e){return e.name==="FirebaseError"?e.code===Je.FAILED_PRECONDITION||e.code===Je.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function Jye(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){It("FirestoreClient","Using user provided OfflineComponentProvider");try{await ZP(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!Zye(r))throw r;Iv("Error using user provided cache. Falling back to memory cache: "+r),await ZP(e,new RU)}}else It("FirestoreClient","Using default OfflineComponentProvider"),await ZP(e,new RU);return e._offlineComponents}async function aJ(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(It("FirestoreClient","Using user provided OnlineComponentProvider"),await DU(e,e._uninitializedComponentsProvider._online)):(It("FirestoreClient","Using default OnlineComponentProvider"),await DU(e,new Kye))),e._onlineComponents}function e1e(e){return aJ(e).then(t=>t.syncEngine)}async function oJ(e){const t=await aJ(e),r=t.eventManager;return r.onListen=Bye.bind(null,t.syncEngine),r.onUnlisten=jye.bind(null,t.syncEngine),r}function t1e(e,t,r={}){const i=new Gu;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new sJ({next:h=>{a.enqueueAndForget(()=>QZ(s,u));const f=h.docs.has(o);!f&&h.fromCache?c.reject(new Tt(Je.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&l&&l.source==="server"?c.reject(new Tt(Je.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new ZZ(fB(o.path),d,{includeMetadataChanges:!0,J_:!0});return KZ(s,u)}(await oJ(e),e.asyncQueue,t,r,i)),i.promise}function r1e(e,t,r={}){const i=new Gu;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const d=new sJ({next:h=>{a.enqueueAndForget(()=>QZ(s,u)),h.fromCache&&l.source==="server"?c.reject(new Tt(Je.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new ZZ(o,d,{includeMetadataChanges:!0,J_:!0});return KZ(s,u)}(await oJ(e),e.asyncQueue,t,r,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lJ(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OU=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cJ(e,t,r){if(!r)throw new Tt(Je.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function i1e(e,t,r,i){if(t===!0&&i===!0)throw new Tt(Je.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function LU(e){if(!Vt.isDocumentKey(e))throw new Tt(Je.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function NU(e){if(Vt.isDocumentKey(e))throw new Tt(Je.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function u2(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":rr()}function Xc(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Tt(Je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=u2(e);throw new Tt(Je.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(t){var r,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Tt(Je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Tt(Je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}i1e("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lJ((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Tt(Je.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Tt(Je.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Tt(Je.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,n){return i.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class d2{constructor(t,r,i,n){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=i,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kU({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Tt(Je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new Tt(Je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kU(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Sve;switch(i.type){case"firstParty":return new Tve(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Tt(Je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const i=OU.get(r);i&&(It("ComponentProvider","Removing Datastore"),OU.delete(r),i.terminate())}(this),Promise.resolve()}}function n1e(e,t,r,i={}){var n;const s=(e=Xc(e,d2))._getSettings(),a=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Iv("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let o,l;if(typeof i.mockUserToken=="string")o=i.mockUserToken,l=Vs.MOCK_USER;else{o=yK(i.mockUserToken,(n=e._app)===null||n===void 0?void 0:n.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Tt(Je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Vs(c)}e._authCredentials=new Eve(new nZ(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(t,r,i){this.converter=r,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new y0(this.firestore,t,this._query)}}class wa{constructor(t,r,i){this.converter=r,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Th(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new wa(this.firestore,t,this._key)}}class Th extends y0{constructor(t,r,i){super(t,r,fB(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new wa(this.firestore,null,new Vt(t))}withConverter(t){return new Th(this.firestore,t,this._path)}}function b0(e,t,...r){if(e=Rs(e),cJ("collection","path",t),e instanceof d2){const i=_i.fromString(t,...r);return NU(i),new Th(e,null,i)}{if(!(e instanceof wa||e instanceof Th))throw new Tt(Je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(_i.fromString(t,...r));return NU(i),new Th(e.firestore,null,i)}}function Tp(e,t,...r){if(e=Rs(e),arguments.length===1&&(t=sZ.newId()),cJ("doc","path",t),e instanceof d2){const i=_i.fromString(t,...r);return LU(i),new wa(e,null,new Vt(i))}{if(!(e instanceof wa||e instanceof Th))throw new Tt(Je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(_i.fromString(t,...r));return LU(i),new wa(e.firestore,e instanceof Th?e.converter:null,new Vt(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1e{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new VZ(this,"async_queue_retry"),this.iu=()=>{const r=QP();r&&It("AsyncQueue","Visibility state changed to "+r.visibilityState),this.zo.Qo()};const t=QP();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const r=QP();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const r=new Gu;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!Gx(t))throw t;It("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const r=this.Ja.then(()=>(this.tu=!0,t().catch(i=>{this.eu=i,this.tu=!1;const n=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(i);throw sd("INTERNAL UNHANDLED ERROR: ",n),i}).then(i=>(this.tu=!1,i))));return this.Ja=r,r}enqueueAfterDelay(t,r,i){this.su(),this.ru.indexOf(t)>-1&&(r=0);const n=SB.createAndSchedule(this,t,r,i,s=>this.au(s));return this.Xa.push(n),n}su(){this.eu&&rr()}verifyOperationInProgress(){}async uu(){let t;do t=this.Ja,await t;while(t!==this.Ja)}cu(t){for(const r of this.Xa)if(r.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((r,i)=>r.targetTimeMs-i.targetTimeMs);for(const r of this.Xa)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const r=this.Xa.indexOf(t);this.Xa.splice(r,1)}}class x0 extends d2{constructor(t,r,i,n){super(t,r,i,n),this.type="firestore",this._queue=function(){return new s1e}(),this._persistenceKey=(n==null?void 0:n.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||uJ(this),this._firestoreClient.terminate()}}function a1e(e,t){const r=typeof e=="object"?e:Mz(),i=typeof e=="string"?e:t||"(default)",n=NT(r,"firestore").getImmediate({identifier:i});if(!n._initialized){const s=mK("firestore");s&&n1e(n,...s)}return n}function TB(e){return e._firestoreClient||uJ(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function uJ(e){var t,r,i;const n=e._freezeSettings(),s=function(o,l,c,d){return new Fve(o,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,lJ(d.experimentalLongPollingOptions),d.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Qye(e._authCredentials,e._appCheckCredentials,e._queue,s),!((r=n.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((i=n.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:n.localCache.kind,_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(t){this._byteString=t}static fromBase64String(t){try{return new zv(ra.fromBase64String(t))}catch(r){throw new Tt(Je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new zv(ra.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Tt(Je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MB{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Tt(Je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Tt(Je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return $r(this._lat,t._lat)||$r(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1e=/^__.*__$/;class l1e{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return this.fieldMask!==null?new Qh(t,this.data,this.fieldMask,r,this.fieldTransforms):new Xx(t,this.data,r,this.fieldTransforms)}}class dJ{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return new Qh(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function hJ(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rr()}}class p2{constructor(t,r,i,n,s,a){this.settings=t,this.databaseId=r,this.serializer=i,this.ignoreUndefinedProperties=n,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new p2(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var r;const i=(r=this.path)===null||r===void 0?void 0:r.child(t),n=this.Tu({path:i,du:!1});return n.Au(t),n}Ru(t){var r;const i=(r=this.path)===null||r===void 0?void 0:r.child(t),n=this.Tu({path:i,du:!1});return n.Pu(),n}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return PC(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(t.length===0)throw this.mu("Document fields must not be empty");if(hJ(this.Iu)&&o1e.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class c1e{constructor(t,r,i){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=i||o2(t)}pu(t,r,i,n=!1){return new p2({Iu:t,methodName:r,gu:i,path:bs.emptyPath(),du:!1,fu:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function m2(e){const t=e._freezeSettings(),r=o2(e._databaseId);return new c1e(e._databaseId,!!t.ignoreUndefinedProperties,r)}function fJ(e,t,r,i,n,s={}){const a=e.pu(s.merge||s.mergeFields?2:0,t,r,n);PB("Data must be an object, but it was:",a,i);const o=pJ(i,a);let l,c;if(s.merge)l=new fo(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const d=[];for(const u of s.mergeFields){const h=w3(t,u,r);if(!a.contains(h))throw new Tt(Je.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);gJ(d,h)||d.push(h)}l=new fo(d),c=a.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=a.fieldTransforms;return new l1e(new Fa(o),l,c)}class g2 extends f2{_toFieldTransform(t){if(t.Iu!==2)throw t.Iu===1?t.mu(`${this._methodName}() can only appear at the top level of your update data`):t.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof g2}}function u1e(e,t,r){return new p2({Iu:3,gu:t.settings.gu,methodName:e._methodName,du:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class d1e extends f2{constructor(t,r){super(t),this.yu=r}_toFieldTransform(t){const r=u1e(this,t,!0),i=this.yu.map(s=>w0(s,r)),n=new Lv(i);return new c0e(t.path,n)}isEqual(t){return this===t}}function h1e(e,t,r,i){const n=e.pu(1,t,r);PB("Data must be an object, but it was:",n,i);const s=[],a=Fa.empty();Xp(i,(l,c)=>{const d=IB(t,l,r);c=Rs(c);const u=n.Ru(d);if(c instanceof g2)s.push(d);else{const h=w0(c,u);h!=null&&(s.push(d),a.set(d,h))}});const o=new fo(s);return new dJ(a,o,n.fieldTransforms)}function f1e(e,t,r,i,n,s){const a=e.pu(1,t,r),o=[w3(t,i,r)],l=[n];if(s.length%2!=0)throw new Tt(Je.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)o.push(w3(t,s[h])),l.push(s[h+1]);const c=[],d=Fa.empty();for(let h=o.length-1;h>=0;--h)if(!gJ(c,o[h])){const f=o[h];let p=l[h];p=Rs(p);const m=a.Ru(f);if(p instanceof g2)c.push(f);else{const g=w0(p,m);g!=null&&(c.push(f),d.set(f,g))}}const u=new fo(c);return new dJ(d,u,a.fieldTransforms)}function p1e(e,t,r,i=!1){return w0(r,e.pu(i?4:3,t))}function w0(e,t){if(mJ(e=Rs(e)))return PB("Unsupported field value:",t,e),pJ(e,t);if(e instanceof f2)return function(i,n){if(!hJ(n.Iu))throw n.mu(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n.mu(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(n);s&&n.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.du&&t.Iu!==4)throw t.mu("Nested arrays are not supported");return function(i,n){const s=[];let a=0;for(const o of i){let l=w0(o,n.Vu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(e,t)}return function(i,n){if((i=Rs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return a0e(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=jn.fromDate(i);return{timestampValue:TC(n.serializer,s)}}if(i instanceof jn){const s=new jn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:TC(n.serializer,s)}}if(i instanceof MB)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof zv)return{bytesValue:OZ(n.serializer,i._byteString)};if(i instanceof wa){const s=n.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw n.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:gB(i.firestore._databaseId||n.databaseId,i._key.path)}}throw n.mu(`Unsupported field value: ${u2(i)}`)}(e,t)}function pJ(e,t){const r={};return aZ(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Xp(e,(i,n)=>{const s=w0(n,t.Eu(i));s!=null&&(r[i]=s)}),{mapValue:{fields:r}}}function mJ(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof jn||e instanceof MB||e instanceof zv||e instanceof wa||e instanceof f2)}function PB(e,t,r){if(!mJ(r)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(r)){const i=u2(r);throw i==="an object"?t.mu(e+" a custom object"):t.mu(e+" "+i)}}function w3(e,t,r){if((t=Rs(t))instanceof h2)return t._internalPath;if(typeof t=="string")return IB(e,t);throw PC("Field path arguments must be of type string or ",e,!1,void 0,r)}const m1e=new RegExp("[~\\*/\\[\\]]");function IB(e,t,r){if(t.search(m1e)>=0)throw PC(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new h2(...t.split("."))._internalPath}catch{throw PC(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function PC(e,t,r,i,n){const s=i&&!i.isEmpty(),a=n!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${n}`),l+=")"),new Tt(Je.INVALID_ARGUMENT,o+e+l)}function gJ(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(t,r,i,n,s){this._firestore=t,this._userDataWriter=r,this._key=i,this._document=n,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new wa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new g1e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(RB("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class g1e extends vJ{data(){return super.data()}}function RB(e,t){return typeof t=="string"?IB(e,t):t instanceof h2?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1e(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Tt(Je.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class DB{}class y1e extends DB{}function OB(e,t,...r){let i=[];t instanceof DB&&i.push(t),i=i.concat(r),function(s){const a=s.filter(l=>l instanceof NB).length,o=s.filter(l=>l instanceof v2).length;if(a>1||a>0&&o>0)throw new Tt(Je.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const n of i)e=n._apply(e);return e}class v2 extends y1e{constructor(t,r,i){super(),this._field=t,this._op=r,this._value=i,this.type="where"}static _create(t,r,i){return new v2(t,r,i)}_apply(t){const r=this._parse(t);return yJ(t._query,r),new y0(t.firestore,t.converter,f3(t._query,r))}_parse(t){const r=m2(t.firestore);return function(s,a,o,l,c,d,u){let h;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Tt(Je.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){BU(u,d);const f=[];for(const p of u)f.push(zU(l,s,p));h={arrayValue:{values:f}}}else h=zU(l,s,u)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||BU(u,d),h=p1e(o,a,u,d==="in"||d==="not-in");return Sn.create(c,d,h)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function LB(e,t,r){const i=t,n=RB("where",e);return v2._create(n,i,r)}class NB extends DB{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new NB(t,r)}_parse(t){const r=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return r.length===1?r[0]:Hl.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(n,s){let a=n;const o=s.getFlattenedFilters();for(const l of o)yJ(a,l),a=f3(a,l)}(t._query,r),new y0(t.firestore,t.converter,f3(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function zU(e,t,r){if(typeof(r=Rs(r))=="string"){if(r==="")throw new Tt(Je.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mZ(t)&&r.indexOf("/")!==-1)throw new Tt(Je.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const i=t.path.child(_i.fromString(r));if(!Vt.isDocumentKey(i))throw new Tt(Je.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return oU(e,new Vt(i))}if(r instanceof wa)return oU(e,r._key);throw new Tt(Je.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${u2(r)}.`)}function BU(e,t){if(!Array.isArray(e)||e.length===0)throw new Tt(Je.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function yJ(e,t){const r=function(n,s){for(const a of n)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Tt(Je.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Tt(Je.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class b1e{convertValue(t,r="none"){switch(Ap(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Cp(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 10:return this.convertObject(t.mapValue,r);default:throw rr()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const i={};return Xp(t,(n,s)=>{i[n]=this.convertValue(s,r)}),i}convertGeoPoint(t){return new MB(bn(t.latitude),bn(t.longitude))}convertArray(t,r){return(t.values||[]).map(i=>this.convertValue(i,r))}convertServerTimestamp(t,r){switch(r){case"previous":const i=cB(t);return i==null?null:this.convertValue(i,r);case"estimate":return this.convertTimestamp(Fb(t));default:return null}}convertTimestamp(t){const r=zh(t);return new jn(r.seconds,r.nanos)}convertDocumentKey(t,r){const i=_i.fromString(t);vi(BZ(i));const n=new jb(i.get(1),i.get(3)),s=new Vt(i.popFirst(5));return n.isEqual(r)||sd(`Document ${s} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bJ(e,t,r){let i;return i=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class xJ extends vJ{constructor(t,r,i,n,s,a){super(t,r,i,n,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new cE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const i=this._document.data.field(RB("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,r.serverTimestamps)}}}class cE extends xJ{data(t={}){return super.data(t)}}class x1e{constructor(t,r,i,n){this._firestore=t,this._userDataWriter=r,this._snapshot=n,this.metadata=new l1(n.hasPendingWrites,n.fromCache),this.query=i}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(i=>{t.call(r,new cE(this._firestore,this._userDataWriter,i.key,i,new l1(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Tt(Je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(n,s){if(n._snapshot.oldDocs.isEmpty()){let a=0;return n._snapshot.docChanges.map(o=>{const l=new cE(n._firestore,n._userDataWriter,o.doc.key,o.doc,new l1(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new cE(n._firestore,n._userDataWriter,o.doc.key,o.doc,new l1(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,d=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),d=a.indexOf(o.doc.key)),{type:w1e(o.type),doc:l,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function w1e(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(e){e=Xc(e,wa);const t=Xc(e.firestore,x0);return t1e(TB(t),e._key).then(r=>S1e(t,e,r))}class wJ extends b1e{constructor(t){super(),this.firestore=t}convertBytes(t){return new zv(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new wa(this.firestore,null,r)}}function y2(e){e=Xc(e,y0);const t=Xc(e.firestore,x0),r=TB(t),i=new wJ(t);return v1e(e._query),r1e(r,e._query).then(n=>new x1e(t,i,e,n))}function _1e(e,t,r){e=Xc(e,wa);const i=Xc(e.firestore,x0),n=bJ(e.converter,t,r);return zB(i,[fJ(m2(i),"setDoc",e._key,n,e.converter!==null,r).toMutation(e._key,zl.none())])}function b2(e,t,r,...i){e=Xc(e,wa);const n=Xc(e.firestore,x0),s=m2(n);let a;return a=typeof(t=Rs(t))=="string"||t instanceof h2?f1e(s,"updateDoc",e._key,t,r,i):h1e(s,"updateDoc",e._key,t),zB(n,[a.toMutation(e._key,zl.exists(!0))])}function _J(e,t){const r=Xc(e.firestore,x0),i=Tp(e),n=bJ(e.converter,t);return zB(r,[fJ(m2(e.firestore),"addDoc",i._key,n,e.converter!==null,{}).toMutation(i._key,zl.exists(!1))]).then(()=>i)}function zB(e,t){return function(i,n){const s=new Gu;return i.asyncQueue.enqueueAndForget(async()=>Vye(await e1e(i),n,s)),s.promise}(TB(e),t)}function S1e(e,t,r){const i=r.docs.get(t._key),n=new wJ(e);return new xJ(e,n,t._key,i,new l1(r.hasPendingWrites,r.fromCache),t.converter)}function E1e(...e){return new d1e("arrayUnion",e)}(function(t,r=!0){(function(n){m0=n})(Wp),wp(new Nh("firestore",(i,{instanceIdentifier:n,options:s})=>{const a=i.getProvider("app").getImmediate(),o=new x0(new Cve(i.getProvider("auth-internal")),new Pve(i.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Tt(Je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jb(c.options.projectId,d)}(a,n),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),zc(iU,"4.4.0",t),zc(iU,"4.4.0","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SJ="firebasestorage.googleapis.com",C1e="storageBucket",A1e=2*60*1e3,T1e=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu extends ru{constructor(t,r,i=0){super(JP(t),`Firebase Storage: ${r} (${JP(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,iu.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return JP(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Yc;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Yc||(Yc={}));function JP(e){return"storage/"+e}function M1e(){const e="An unknown error occurred, please check the error payload for server response.";return new iu(Yc.UNKNOWN,e)}function P1e(){return new iu(Yc.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function I1e(){return new iu(Yc.CANCELED,"User canceled the upload/download.")}function R1e(e){return new iu(Yc.INVALID_URL,"Invalid URL '"+e+"'.")}function D1e(e){return new iu(Yc.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function FU(e){return new iu(Yc.INVALID_ARGUMENT,e)}function EJ(){return new iu(Yc.APP_DELETED,"The Firebase app was deleted.")}function O1e(e){return new iu(Yc.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let i;try{i=Il.makeFromUrl(t,r)}catch{return new Il(t,"")}if(i.path==="")return i;throw D1e(t)}static makeFromUrl(t,r){let i=null;const n="([A-Za-z0-9.\\-_]+)";function s(x){x.path.charAt(x.path.length-1)==="/"&&(x.path_=x.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+n+a,"i"),l={bucket:1,path:3};function c(x){x.path_=decodeURIComponent(x.path)}const d="v[A-Za-z0-9_]+",u=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",f=new RegExp(`^https?://${u}/${d}/b/${n}/o${h}`,"i"),p={bucket:1,path:3},m=r===SJ?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",v=new RegExp(`^https?://${m}/${n}/${g}`,"i"),b=[{regex:o,indices:l,postModify:s},{regex:f,indices:p,postModify:c},{regex:v,indices:{bucket:1,path:2},postModify:c}];for(let x=0;x<b.length;x++){const S=b[x],w=S.regex.exec(t);if(w){const E=w[S.indices.bucket];let C=w[S.indices.path];C||(C=""),i=new Il(E,C),S.postModify(i);break}}if(i==null)throw R1e(t);return i}}class L1e{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1e(e,t,r){let i=1,n=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function d(...g){c||(c=!0,t.apply(null,g))}function u(g){n=setTimeout(()=>{n=null,e(f,l())},g)}function h(){s&&clearTimeout(s)}function f(g,...v){if(c){h();return}if(g){h(),d.call(null,g,...v);return}if(l()||a){h(),d.call(null,g,...v);return}i<64&&(i*=2);let b;o===1?(o=2,b=0):b=(i+Math.random())*1e3,u(b)}let p=!1;function m(g){p||(p=!0,h(),!c&&(n!==null?(g||(o=2),clearTimeout(n),u(0)):g||(o=1)))}return u(0),s=setTimeout(()=>{a=!0,m(!0)},r),m}function k1e(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1e(e){return e!==void 0}function jU(e,t,r,i){if(i<t)throw FU(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>r)throw FU(`Invalid value for '${e}'. Expected ${r} or less.`)}function B1e(e){const t=encodeURIComponent;let r="?";for(const i in e)if(e.hasOwnProperty(i)){const n=t(i)+"="+t(e[i]);r=r+n+"&"}return r=r.slice(0,-1),r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var IC;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(IC||(IC={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1e(e,t){const r=e>=500&&e<600,n=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return r||n||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1e{constructor(t,r,i,n,s,a,o,l,c,d,u,h=!0){this.url_=t,this.method_=r,this.headers_=i,this.body_=n,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){const t=(i,n)=>{if(n){i(!1,new s_(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===IC.NO_ERROR,l=s.getStatus();if(!o||F1e(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===IC.ABORT;i(!1,new s_(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new s_(c,s))})},r=(i,n)=>{const s=this.resolve_,a=this.reject_,o=n.connection;if(n.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());z1e(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=M1e();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(n.canceled){const l=this.appDelete_?EJ():I1e();a(l)}else{const l=P1e();a(l)}};this.canceled_?r(!1,new s_(!1,null,!0)):this.backoffId_=N1e(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&k1e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class s_{constructor(t,r,i){this.wasSuccessCode=t,this.connection=r,this.canceled=!!i}}function V1e(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function U1e(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function $1e(e,t){t&&(e["X-Firebase-GMPID"]=t)}function H1e(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function W1e(e,t,r,i,n,s,a=!0){const o=B1e(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return $1e(c,t),V1e(c,r),U1e(c,s),H1e(c,i),new j1e(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1e(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function q1e(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(t,r){this._service=t,r instanceof Il?this._location=r:this._location=Il.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new RC(t,r)}get root(){const t=new Il(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return q1e(this._location.path)}get storage(){return this._service}get parent(){const t=G1e(this._location.path);if(t===null)return null;const r=new Il(this._location.bucket,t);return new RC(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw O1e(t)}}function VU(e,t){const r=t==null?void 0:t[C1e];return r==null?null:Il.makeFromBucketSpec(r,e)}function X1e(e,t,r,i={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:n}=i;n&&(e._overrideAuthToken=typeof n=="string"?n:yK(n,e.app.options.projectId))}class Y1e{constructor(t,r,i,n,s){this.app=t,this._authProvider=r,this._appCheckProvider=i,this._url=n,this._firebaseVersion=s,this._bucket=null,this._host=SJ,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=A1e,this._maxUploadRetryTime=T1e,this._requests=new Set,n!=null?this._bucket=Il.makeFromBucketSpec(n,this._host):this._bucket=VU(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Il.makeFromBucketSpec(this._url,t):this._bucket=VU(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){jU("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){jU("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new RC(this,t)}_makeRequest(t,r,i,n,s=!0){if(this._deleted)return new L1e(EJ());{const a=W1e(t,this._appId,i,n,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(t,r){const[i,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,i,n).getPromise()}}const UU="@firebase/storage",$U="0.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CJ="storage";function K1e(e=Mz(),t){e=Rs(e);const i=NT(e,CJ).getImmediate({identifier:t}),n=mK("storage");return n&&Q1e(i,...n),i}function Q1e(e,t,r,i={}){X1e(e,t,r,i)}function Z1e(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),n=e.getProvider("app-check-internal");return new Y1e(r,i,n,t,Wp)}function J1e(){wp(new Nh(CJ,Z1e,"PUBLIC").setMultipleInstances(!0)),zc(UU,$U,""),zc(UU,$U,"esm2017")}J1e();const ebe={apiKey:"AIzaSyApaPQeFl2ciboPvacqkyu5vFOLaQBTpqk",authDomain:"musicstream-react.firebaseapp.com",projectId:"musicstream-react",storageBucket:"musicstream-react.appspot.com",messagingSenderId:"67776188337",appId:"1:67776188337:web:e452f3559fc0c02a6cf790"},AJ=wK(ebe),TJ=gge(),Wl=a1e(AJ);K1e(AJ);const tbe=async(e,t)=>{const r={likedTracks:[],email:t};await _J(b0(Tp(Wl,"users",e),"playlists"),{}),await _1e(Tp(Wl,`users/${e}`),r)},rbe=async(e,t,r,i)=>{const n={id:t,title:r,imagePath:i,tracks:[]};await _J(b0(Wl,`users/${e}/playlists`),n)},ibe=async(e,t,r,i)=>{const n=OB(b0(Wl,`users/${e}/playlists`),LB("id","==",t));(await y2(n)).forEach(a=>{b2(a.ref,{tracks:E1e({trackId:i,preview_url:r})})})},nbe=async(e,t)=>{const r=Tp(Wl,`users/${e}`),n=(await kB(r)).data().likedTracks;n.includes(t)?console.log("Трек уже добавлен"):await b2(r,{likedTracks:[...n,t]})},sbe=async(e,t,r)=>{const i=OB(b0(Wl,`users/${e}/playlists`),LB("id","==",t));(await y2(i)).forEach(s=>{const a=s.data();if(s&&a){const l=a.tracks.filter(d=>d.trackId!==r),c=Tp(Wl,`users/${e}/playlists/${s.id}`);b2(c,{tracks:l})}})},abe=async(e,t)=>{const r=Tp(Wl,`users/${e}`),n=(await kB(r)).data().likedTracks||console.log(new Error("No tracks found"));await b2(r,{likedTracks:n.filter(s=>s!==t)})},obe=async e=>{let t=[];return(await y2(b0(Wl,`users/${e}/playlists`))).forEach(i=>{t=[...t,i.data()]}),t},lbe=async(e,t)=>{let r=[];const i=OB(b0(Wl,`users/${e}/playlists`),LB("id","==",t));return(await y2(i)).forEach(s=>r=s.data().tracks),r},MJ=async e=>(await kB(Tp(Wl,`users/${e}`))).data().likedTracks,PJ=()=>{},IJ=(e,t)=>{_.useEffect(()=>{(async()=>{const n=(await obe(t)).map(s=>s);e(s=>[...s,...n])})()},[])},cbe=({playlist:e,onPlaylistSelect:t})=>G.jsxs("div",{children:[G.jsx("div",{className:"bg-gray-100 p-2 rounded flex items-center",children:G.jsx("button",{onClick:()=>t(e),children:G.jsx("img",{className:"w-44 h-44 rounded mr-2 hover:scale-90 duration-150",src:e.imagePath,alt:e.title})})}),G.jsx("h2",{className:"text-white text-xl text-center",children:e.title})]},e.id),ube={black:"#000",white:"#fff"},$b=ube,dbe={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},hm=dbe,hbe={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},fm=hbe,fbe={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},pm=fbe,pbe={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},mm=pbe,mbe={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},gm=mbe,gbe={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},cy=gbe,vbe={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ybe=vbe;function Fh(e){let t="https://mui.com/production-error/?code="+e;for(let r=1;r<arguments.length;r+=1)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}const x2="$$material";function ae(){return ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ae.apply(this,arguments)}function ar(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function RJ(e){var t=Object.create(null);return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var bbe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,xbe=RJ(function(e){return bbe.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91});function wbe(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function _be(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Sbe=function(){function e(r){var i=this;this._insertTag=function(n){var s;i.tags.length===0?i.insertionPoint?s=i.insertionPoint.nextSibling:i.prepend?s=i.container.firstChild:s=i.before:s=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(n,s),i.tags.push(n)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(i){i.forEach(this._insertTag)},t.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(_be(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var s=wbe(n);try{s.insertRule(i,s.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(i));this.ctr++},t.flush=function(){this.tags.forEach(function(i){return i.parentNode&&i.parentNode.removeChild(i)}),this.tags=[],this.ctr=0},e}(),js="-ms-",DC="-moz-",Vr="-webkit-",DJ="comm",BB="rule",FB="decl",Ebe="@import",OJ="@keyframes",Cbe="@layer",Abe=Math.abs,w2=String.fromCharCode,Tbe=Object.assign;function Mbe(e,t){return vs(e,0)^45?(((t<<2^vs(e,0))<<2^vs(e,1))<<2^vs(e,2))<<2^vs(e,3):0}function LJ(e){return e.trim()}function Pbe(e,t){return(e=t.exec(e))?e[0]:e}function Ur(e,t,r){return e.replace(t,r)}function _3(e,t){return e.indexOf(t)}function vs(e,t){return e.charCodeAt(t)|0}function Hb(e,t,r){return e.slice(t,r)}function xc(e){return e.length}function jB(e){return e.length}function a_(e,t){return t.push(e),e}function Ibe(e,t){return e.map(t).join("")}var _2=1,Bv=1,NJ=0,Qa=0,xn=0,_0="";function S2(e,t,r,i,n,s,a){return{value:e,root:t,parent:r,type:i,props:n,children:s,line:_2,column:Bv,length:a,return:""}}function uy(e,t){return Tbe(S2("",null,null,"",null,null,0),e,{length:-e.length},t)}function Rbe(){return xn}function Dbe(){return xn=Qa>0?vs(_0,--Qa):0,Bv--,xn===10&&(Bv=1,_2--),xn}function yo(){return xn=Qa<NJ?vs(_0,Qa++):0,Bv++,xn===10&&(Bv=1,_2++),xn}function Uc(){return vs(_0,Qa)}function uE(){return Qa}function Zx(e,t){return Hb(_0,e,t)}function Wb(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function kJ(e){return _2=Bv=1,NJ=xc(_0=e),Qa=0,[]}function zJ(e){return _0="",e}function dE(e){return LJ(Zx(Qa-1,S3(e===91?e+2:e===40?e+1:e)))}function Obe(e){for(;(xn=Uc())&&xn<33;)yo();return Wb(e)>2||Wb(xn)>3?"":" "}function Lbe(e,t){for(;--t&&yo()&&!(xn<48||xn>102||xn>57&&xn<65||xn>70&&xn<97););return Zx(e,uE()+(t<6&&Uc()==32&&yo()==32))}function S3(e){for(;yo();)switch(xn){case e:return Qa;case 34:case 39:e!==34&&e!==39&&S3(xn);break;case 40:e===41&&S3(e);break;case 92:yo();break}return Qa}function Nbe(e,t){for(;yo()&&e+xn!==47+10;)if(e+xn===42+42&&Uc()===47)break;return"/*"+Zx(t,Qa-1)+"*"+w2(e===47?e:yo())}function kbe(e){for(;!Wb(Uc());)yo();return Zx(e,Qa)}function BJ(e){return zJ(hE("",null,null,null,[""],e=kJ(e),0,[0],e))}function hE(e,t,r,i,n,s,a,o,l){for(var c=0,d=0,u=a,h=0,f=0,p=0,m=1,g=1,v=1,y=0,b="",x=n,S=s,w=i,E=b;g;)switch(p=y,y=yo()){case 40:if(p!=108&&vs(E,u-1)==58){_3(E+=Ur(dE(y),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:E+=dE(y);break;case 9:case 10:case 13:case 32:E+=Obe(p);break;case 92:E+=Lbe(uE()-1,7);continue;case 47:switch(Uc()){case 42:case 47:a_(zbe(Nbe(yo(),uE()),t,r),l);break;default:E+="/"}break;case 123*m:o[c++]=xc(E)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+d:v==-1&&(E=Ur(E,/\f/g,"")),f>0&&xc(E)-u&&a_(f>32?WU(E+";",i,r,u-1):WU(Ur(E," ","")+";",i,r,u-2),l);break;case 59:E+=";";default:if(a_(w=HU(E,t,r,c,d,n,o,b,x=[],S=[],u),s),y===123)if(d===0)hE(E,t,w,w,x,s,u,o,S);else switch(h===99&&vs(E,3)===110?100:h){case 100:case 108:case 109:case 115:hE(e,w,w,i&&a_(HU(e,w,w,0,0,n,o,b,n,x=[],u),S),n,S,u,o,i?x:S);break;default:hE(E,w,w,w,[""],S,0,o,S)}}c=d=f=0,m=v=1,b=E="",u=a;break;case 58:u=1+xc(E),f=p;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&Dbe()==125)continue}switch(E+=w2(y),y*m){case 38:v=d>0?1:(E+="\f",-1);break;case 44:o[c++]=(xc(E)-1)*v,v=1;break;case 64:Uc()===45&&(E+=dE(yo())),h=Uc(),d=u=xc(b=E+=kbe(uE())),y++;break;case 45:p===45&&xc(E)==2&&(m=0)}}return s}function HU(e,t,r,i,n,s,a,o,l,c,d){for(var u=n-1,h=n===0?s:[""],f=jB(h),p=0,m=0,g=0;p<i;++p)for(var v=0,y=Hb(e,u+1,u=Abe(m=a[p])),b=e;v<f;++v)(b=LJ(m>0?h[v]+" "+y:Ur(y,/&\f/g,h[v])))&&(l[g++]=b);return S2(e,t,r,n===0?BB:o,l,c,d)}function zbe(e,t,r){return S2(e,t,r,DJ,w2(Rbe()),Hb(e,2,-2),0)}function WU(e,t,r,i){return S2(e,t,r,FB,Hb(e,0,i),Hb(e,i+1,-1),i)}function ip(e,t){for(var r="",i=jB(e),n=0;n<i;n++)r+=t(e[n],n,e,t)||"";return r}function FJ(e,t,r,i){switch(e.type){case Cbe:if(e.children.length)break;case Ebe:case FB:return e.return=e.return||e.value;case DJ:return"";case OJ:return e.return=e.value+"{"+ip(e.children,i)+"}";case BB:e.value=e.props.join(",")}return xc(r=ip(e.children,i))?e.return=e.value+"{"+r+"}":""}function Bbe(e){var t=jB(e);return function(r,i,n,s){for(var a="",o=0;o<t;o++)a+=e[o](r,i,n,s)||"";return a}}function Fbe(e){return function(t){t.root||(t=t.return)&&e(t)}}var jbe=function(t,r,i){for(var n=0,s=0;n=s,s=Uc(),n===38&&s===12&&(r[i]=1),!Wb(s);)yo();return Zx(t,Qa)},Vbe=function(t,r){var i=-1,n=44;do switch(Wb(n)){case 0:n===38&&Uc()===12&&(r[i]=1),t[i]+=jbe(Qa-1,r,i);break;case 2:t[i]+=dE(n);break;case 4:if(n===44){t[++i]=Uc()===58?"&\f":"",r[i]=t[i].length;break}default:t[i]+=w2(n)}while(n=yo());return t},Ube=function(t,r){return zJ(Vbe(kJ(t),r))},GU=new WeakMap,$be=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,i=t.parent,n=t.column===i.column&&t.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!GU.get(i))&&!n){GU.set(t,!0);for(var s=[],a=Ube(r,s),o=i.props,l=0,c=0;l<a.length;l++)for(var d=0;d<o.length;d++,c++)t.props[c]=s[l]?a[l].replace(/&\f/g,o[d]):o[d]+" "+a[l]}}},Hbe=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};function jJ(e,t){switch(Mbe(e,t)){case 5103:return Vr+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Vr+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Vr+e+DC+e+js+e+e;case 6828:case 4268:return Vr+e+js+e+e;case 6165:return Vr+e+js+"flex-"+e+e;case 5187:return Vr+e+Ur(e,/(\w+).+(:[^]+)/,Vr+"box-$1$2"+js+"flex-$1$2")+e;case 5443:return Vr+e+js+"flex-item-"+Ur(e,/flex-|-self/,"")+e;case 4675:return Vr+e+js+"flex-line-pack"+Ur(e,/align-content|flex-|-self/,"")+e;case 5548:return Vr+e+js+Ur(e,"shrink","negative")+e;case 5292:return Vr+e+js+Ur(e,"basis","preferred-size")+e;case 6060:return Vr+"box-"+Ur(e,"-grow","")+Vr+e+js+Ur(e,"grow","positive")+e;case 4554:return Vr+Ur(e,/([^-])(transform)/g,"$1"+Vr+"$2")+e;case 6187:return Ur(Ur(Ur(e,/(zoom-|grab)/,Vr+"$1"),/(image-set)/,Vr+"$1"),e,"")+e;case 5495:case 3959:return Ur(e,/(image-set\([^]*)/,Vr+"$1$`$1");case 4968:return Ur(Ur(e,/(.+:)(flex-)?(.*)/,Vr+"box-pack:$3"+js+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Vr+e+e;case 4095:case 3583:case 4068:case 2532:return Ur(e,/(.+)-inline(.+)/,Vr+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xc(e)-1-t>6)switch(vs(e,t+1)){case 109:if(vs(e,t+4)!==45)break;case 102:return Ur(e,/(.+:)(.+)-([^]+)/,"$1"+Vr+"$2-$3$1"+DC+(vs(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~_3(e,"stretch")?jJ(Ur(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(vs(e,t+1)!==115)break;case 6444:switch(vs(e,xc(e)-3-(~_3(e,"!important")&&10))){case 107:return Ur(e,":",":"+Vr)+e;case 101:return Ur(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Vr+(vs(e,14)===45?"inline-":"")+"box$3$1"+Vr+"$2$3$1"+js+"$2box$3")+e}break;case 5936:switch(vs(e,t+11)){case 114:return Vr+e+js+Ur(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Vr+e+js+Ur(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Vr+e+js+Ur(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Vr+e+js+e+e}return e}var Wbe=function(t,r,i,n){if(t.length>-1&&!t.return)switch(t.type){case FB:t.return=jJ(t.value,t.length);break;case OJ:return ip([uy(t,{value:Ur(t.value,"@","@"+Vr)})],n);case BB:if(t.length)return Ibe(t.props,function(s){switch(Pbe(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ip([uy(t,{props:[Ur(s,/:(read-\w+)/,":"+DC+"$1")]})],n);case"::placeholder":return ip([uy(t,{props:[Ur(s,/:(plac\w+)/,":"+Vr+"input-$1")]}),uy(t,{props:[Ur(s,/:(plac\w+)/,":"+DC+"$1")]}),uy(t,{props:[Ur(s,/:(plac\w+)/,js+"input-$1")]})],n)}return""})}},Gbe=[Wbe],qbe=function(t){var r=t.key;if(r==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var n=t.stylisPlugins||Gbe,s={},a,o=[];a=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),v=1;v<g.length;v++)s[g[v]]=!0;o.push(m)});var l,c=[$be,Hbe];{var d,u=[FJ,Fbe(function(m){d.insert(m)})],h=Bbe(c.concat(n,u)),f=function(g){return ip(BJ(g),h)};l=function(g,v,y,b){d=y,f(g?g+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:r,sheet:new Sbe({key:r,container:a,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:s,registered:{},insert:l};return p.sheet.hydrate(o),p},VJ={exports:{}},ii={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cs=typeof Symbol=="function"&&Symbol.for,VB=cs?Symbol.for("react.element"):60103,UB=cs?Symbol.for("react.portal"):60106,E2=cs?Symbol.for("react.fragment"):60107,C2=cs?Symbol.for("react.strict_mode"):60108,A2=cs?Symbol.for("react.profiler"):60114,T2=cs?Symbol.for("react.provider"):60109,M2=cs?Symbol.for("react.context"):60110,$B=cs?Symbol.for("react.async_mode"):60111,P2=cs?Symbol.for("react.concurrent_mode"):60111,I2=cs?Symbol.for("react.forward_ref"):60112,R2=cs?Symbol.for("react.suspense"):60113,Xbe=cs?Symbol.for("react.suspense_list"):60120,D2=cs?Symbol.for("react.memo"):60115,O2=cs?Symbol.for("react.lazy"):60116,Ybe=cs?Symbol.for("react.block"):60121,Kbe=cs?Symbol.for("react.fundamental"):60117,Qbe=cs?Symbol.for("react.responder"):60118,Zbe=cs?Symbol.for("react.scope"):60119;function Ao(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case VB:switch(e=e.type,e){case $B:case P2:case E2:case A2:case C2:case R2:return e;default:switch(e=e&&e.$$typeof,e){case M2:case I2:case O2:case D2:case T2:return e;default:return t}}case UB:return t}}}function UJ(e){return Ao(e)===P2}ii.AsyncMode=$B;ii.ConcurrentMode=P2;ii.ContextConsumer=M2;ii.ContextProvider=T2;ii.Element=VB;ii.ForwardRef=I2;ii.Fragment=E2;ii.Lazy=O2;ii.Memo=D2;ii.Portal=UB;ii.Profiler=A2;ii.StrictMode=C2;ii.Suspense=R2;ii.isAsyncMode=function(e){return UJ(e)||Ao(e)===$B};ii.isConcurrentMode=UJ;ii.isContextConsumer=function(e){return Ao(e)===M2};ii.isContextProvider=function(e){return Ao(e)===T2};ii.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===VB};ii.isForwardRef=function(e){return Ao(e)===I2};ii.isFragment=function(e){return Ao(e)===E2};ii.isLazy=function(e){return Ao(e)===O2};ii.isMemo=function(e){return Ao(e)===D2};ii.isPortal=function(e){return Ao(e)===UB};ii.isProfiler=function(e){return Ao(e)===A2};ii.isStrictMode=function(e){return Ao(e)===C2};ii.isSuspense=function(e){return Ao(e)===R2};ii.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===E2||e===P2||e===A2||e===C2||e===R2||e===Xbe||typeof e=="object"&&e!==null&&(e.$$typeof===O2||e.$$typeof===D2||e.$$typeof===T2||e.$$typeof===M2||e.$$typeof===I2||e.$$typeof===Kbe||e.$$typeof===Qbe||e.$$typeof===Zbe||e.$$typeof===Ybe)};ii.typeOf=Ao;VJ.exports=ii;var Jbe=VJ.exports,$J=Jbe,exe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},txe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},HJ={};HJ[$J.ForwardRef]=exe;HJ[$J.Memo]=txe;var rxe=!0;function ixe(e,t,r){var i="";return r.split(" ").forEach(function(n){e[n]!==void 0?t.push(e[n]+";"):i+=n+" "}),i}var WJ=function(t,r,i){var n=t.key+"-"+r.name;(i===!1||rxe===!1)&&t.registered[n]===void 0&&(t.registered[n]=r.styles)},GJ=function(t,r,i){WJ(t,r,i);var n=t.key+"-"+r.name;if(t.inserted[r.name]===void 0){var s=r;do t.insert(r===s?"."+n:"",s,t.sheet,!0),s=s.next;while(s!==void 0)}};function nxe(e){for(var t=0,r,i=0,n=e.length;n>=4;++i,n-=4)r=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(n){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var sxe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},axe=/[A-Z]|^ms/g,oxe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,qJ=function(t){return t.charCodeAt(1)===45},qU=function(t){return t!=null&&typeof t!="boolean"},eI=RJ(function(e){return qJ(e)?e:e.replace(axe,"-$&").toLowerCase()}),XU=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(oxe,function(i,n,s){return wc={name:n,styles:s,next:wc},n})}return sxe[t]!==1&&!qJ(t)&&typeof r=="number"&&r!==0?r+"px":r};function Gb(e,t,r){if(r==null)return"";if(r.__emotion_styles!==void 0)return r;switch(typeof r){case"boolean":return"";case"object":{if(r.anim===1)return wc={name:r.name,styles:r.styles,next:wc},r.name;if(r.styles!==void 0){var i=r.next;if(i!==void 0)for(;i!==void 0;)wc={name:i.name,styles:i.styles,next:wc},i=i.next;var n=r.styles+";";return n}return lxe(e,t,r)}case"function":{if(e!==void 0){var s=wc,a=r(e);return wc=s,Gb(e,t,a)}break}}if(t==null)return r;var o=t[r];return o!==void 0?o:r}function lxe(e,t,r){var i="";if(Array.isArray(r))for(var n=0;n<r.length;n++)i+=Gb(e,t,r[n])+";";else for(var s in r){var a=r[s];if(typeof a!="object")t!=null&&t[a]!==void 0?i+=s+"{"+t[a]+"}":qU(a)&&(i+=eI(s)+":"+XU(s,a)+";");else if(Array.isArray(a)&&typeof a[0]=="string"&&(t==null||t[a[0]]===void 0))for(var o=0;o<a.length;o++)qU(a[o])&&(i+=eI(s)+":"+XU(s,a[o])+";");else{var l=Gb(e,t,a);switch(s){case"animation":case"animationName":{i+=eI(s)+":"+l+";";break}default:i+=s+"{"+l+"}"}}}return i}var YU=/label:\s*([^\s;\n{]+)\s*(;|$)/g,wc,XJ=function(t,r,i){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,s="";wc=void 0;var a=t[0];a==null||a.raw===void 0?(n=!1,s+=Gb(i,r,a)):s+=a[0];for(var o=1;o<t.length;o++)s+=Gb(i,r,t[o]),n&&(s+=a[o]);YU.lastIndex=0;for(var l="",c;(c=YU.exec(s))!==null;)l+="-"+c[1];var d=nxe(s)+l;return{name:d,styles:s,next:wc}},cxe=function(t){return t()},YJ=Zu["useInsertionEffect"]?Zu["useInsertionEffect"]:!1,uxe=YJ||cxe,KU=YJ||_.useLayoutEffect,KJ=_.createContext(typeof HTMLElement<"u"?qbe({key:"css"}):null);KJ.Provider;var QJ=function(t){return _.forwardRef(function(r,i){var n=_.useContext(KJ);return t(r,n,i)})},HB=_.createContext({}),dxe=QJ(function(e,t){var r=e.styles,i=XJ([r],void 0,_.useContext(HB)),n=_.useRef();return KU(function(){var s=t.key+"-global",a=new t.sheet.constructor({key:s,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),o=!1,l=document.querySelector('style[data-emotion="'+s+" "+i.name+'"]');return t.sheet.tags.length&&(a.before=t.sheet.tags[0]),l!==null&&(o=!0,l.setAttribute("data-emotion",s),a.hydrate([l])),n.current=[a,o],function(){a.flush()}},[t]),KU(function(){var s=n.current,a=s[0],o=s[1];if(o){s[1]=!1;return}if(i.next!==void 0&&GJ(t,i.next,!0),a.tags.length){var l=a.tags[a.tags.length-1].nextElementSibling;a.before=l,a.flush()}t.insert("",i,a,!1)},[t,i.name]),null}),hxe=xbe,fxe=function(t){return t!=="theme"},QU=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?hxe:fxe},ZU=function(t,r,i){var n;if(r){var s=r.shouldForwardProp;n=t.__emotion_forwardProp&&s?function(a){return t.__emotion_forwardProp(a)&&s(a)}:s}return typeof n!="function"&&i&&(n=t.__emotion_forwardProp),n},pxe=function(t){var r=t.cache,i=t.serialized,n=t.isStringTag;return WJ(r,i,n),uxe(function(){return GJ(r,i,n)}),null},mxe=function e(t,r){var i=t.__emotion_real===t,n=i&&t.__emotion_base||t,s,a;r!==void 0&&(s=r.label,a=r.target);var o=ZU(t,r,i),l=o||QU(n),c=!l("as");return function(){var d=arguments,u=i&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(s!==void 0&&u.push("label:"+s+";"),d[0]==null||d[0].raw===void 0)u.push.apply(u,d);else{u.push(d[0][0]);for(var h=d.length,f=1;f<h;f++)u.push(d[f],d[0][f])}var p=QJ(function(m,g,v){var y=c&&m.as||n,b="",x=[],S=m;if(m.theme==null){S={};for(var w in m)S[w]=m[w];S.theme=_.useContext(HB)}typeof m.className=="string"?b=ixe(g.registered,x,m.className):m.className!=null&&(b=m.className+" ");var E=XJ(u.concat(x),g.registered,S);b+=g.key+"-"+E.name,a!==void 0&&(b+=" "+a);var C=c&&o===void 0?QU(y):l,T={};for(var A in m)c&&A==="as"||C(A)&&(T[A]=m[A]);return T.className=b,T.ref=v,_.createElement(_.Fragment,null,_.createElement(pxe,{cache:g,serialized:E,isStringTag:typeof y=="string"}),_.createElement(y,T))});return p.displayName=s!==void 0?s:"Styled("+(typeof n=="string"?n:n.displayName||n.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=n,p.__emotion_styles=u,p.__emotion_forwardProp=o,Object.defineProperty(p,"toString",{value:function(){return"."+a}}),p.withComponent=function(m,g){return e(m,ae({},r,g,{shouldForwardProp:ZU(p,g,!0)})).apply(void 0,u)},p}},gxe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],E3=mxe.bind();gxe.forEach(function(e){E3[e]=E3(e)});function vxe(e){return e==null||Object.keys(e).length===0}function yxe(e){const{styles:t,defaultTheme:r={}}=e,i=typeof t=="function"?n=>t(vxe(n)?r:n):t;return G.jsx(dxe,{styles:i})}/**
 * @mui/styled-engine v5.15.2
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function bxe(e,t){return E3(e,t)}const xxe=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))};function Ou(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function ZJ(e){if(!Ou(e))return e;const t={};return Object.keys(e).forEach(r=>{t[r]=ZJ(e[r])}),t}function Ya(e,t,r={clone:!0}){const i=r.clone?ae({},e):e;return Ou(e)&&Ou(t)&&Object.keys(t).forEach(n=>{n!=="__proto__"&&(Ou(t[n])&&n in e&&Ou(e[n])?i[n]=Ya(e[n],t[n],r):r.clone?i[n]=Ou(t[n])?ZJ(t[n]):t[n]:i[n]=t[n])}),i}var JJ={exports:{}},ni={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WB=Symbol.for("react.element"),GB=Symbol.for("react.portal"),L2=Symbol.for("react.fragment"),N2=Symbol.for("react.strict_mode"),k2=Symbol.for("react.profiler"),z2=Symbol.for("react.provider"),B2=Symbol.for("react.context"),wxe=Symbol.for("react.server_context"),F2=Symbol.for("react.forward_ref"),j2=Symbol.for("react.suspense"),V2=Symbol.for("react.suspense_list"),U2=Symbol.for("react.memo"),$2=Symbol.for("react.lazy"),_xe=Symbol.for("react.offscreen"),eee;eee=Symbol.for("react.module.reference");function al(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case WB:switch(e=e.type,e){case L2:case k2:case N2:case j2:case V2:return e;default:switch(e=e&&e.$$typeof,e){case wxe:case B2:case F2:case $2:case U2:case z2:return e;default:return t}}case GB:return t}}}ni.ContextConsumer=B2;ni.ContextProvider=z2;ni.Element=WB;ni.ForwardRef=F2;ni.Fragment=L2;ni.Lazy=$2;ni.Memo=U2;ni.Portal=GB;ni.Profiler=k2;ni.StrictMode=N2;ni.Suspense=j2;ni.SuspenseList=V2;ni.isAsyncMode=function(){return!1};ni.isConcurrentMode=function(){return!1};ni.isContextConsumer=function(e){return al(e)===B2};ni.isContextProvider=function(e){return al(e)===z2};ni.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===WB};ni.isForwardRef=function(e){return al(e)===F2};ni.isFragment=function(e){return al(e)===L2};ni.isLazy=function(e){return al(e)===$2};ni.isMemo=function(e){return al(e)===U2};ni.isPortal=function(e){return al(e)===GB};ni.isProfiler=function(e){return al(e)===k2};ni.isStrictMode=function(e){return al(e)===N2};ni.isSuspense=function(e){return al(e)===j2};ni.isSuspenseList=function(e){return al(e)===V2};ni.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===L2||e===k2||e===N2||e===j2||e===V2||e===_xe||typeof e=="object"&&e!==null&&(e.$$typeof===$2||e.$$typeof===U2||e.$$typeof===z2||e.$$typeof===B2||e.$$typeof===F2||e.$$typeof===eee||e.getModuleId!==void 0)};ni.typeOf=al;JJ.exports=ni;var qB=JJ.exports;function Xr(e){if(typeof e!="string")throw new Error(Fh(7));return e.charAt(0).toUpperCase()+e.slice(1)}function JU(...e){return e.reduce((t,r)=>r==null?t:function(...n){t.apply(this,n),r.apply(this,n)},()=>{})}function tee(e,t=166){let r;function i(...n){const s=()=>{e.apply(this,n)};clearTimeout(r),r=setTimeout(s,t)}return i.clear=()=>{clearTimeout(r)},i}function tI(e,t){var r,i;return _.isValidElement(e)&&t.indexOf((r=e.type.muiName)!=null?r:(i=e.type)==null||(i=i._payload)==null||(i=i.value)==null?void 0:i.muiName)!==-1}function bo(e){return e&&e.ownerDocument||document}function Mp(e){return bo(e).defaultView||window}function C3(e,t){typeof e=="function"?e(t):e&&(e.current=t)}const Sxe=typeof window<"u"?_.useLayoutEffect:_.useEffect,Pp=Sxe;let e$=0;function Exe(e){const[t,r]=_.useState(e),i=e||t;return _.useEffect(()=>{t==null&&(e$+=1,r(`mui-${e$}`))},[t]),i}const t$=Zu["useId".toString()];function XB(e){if(t$!==void 0){const t=t$();return e??t}return Exe(e)}function r$({controlled:e,default:t,name:r,state:i="value"}){const{current:n}=_.useRef(e!==void 0),[s,a]=_.useState(t),o=n?e:s,l=_.useCallback(c=>{n||a(c)},[]);return[o,l]}function i$(e){const t=_.useRef(e);return Pp(()=>{t.current=e}),_.useRef((...r)=>(0,t.current)(...r)).current}function ol(...e){return _.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(r=>{C3(r,t)})},e)}function ree(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function iee(e,t){const r=ae({},t);return Object.keys(e).forEach(i=>{if(i.toString().match(/^(components|slots)$/))r[i]=ae({},e[i],r[i]);else if(i.toString().match(/^(componentsProps|slotProps)$/)){const n=e[i]||{},s=t[i];r[i]={},!s||!Object.keys(s)?r[i]=n:!n||!Object.keys(n)?r[i]=s:(r[i]=ae({},s),Object.keys(n).forEach(a=>{r[i][a]=iee(n[a],s[a])}))}else r[i]===void 0&&(r[i]=e[i])}),r}function Bi(e,t,r=void 0){const i={};return Object.keys(e).forEach(n=>{i[n]=e[n].reduce((s,a)=>{if(a){const o=t(a);o!==""&&s.push(o),r&&r[a]&&s.push(r[a])}return s},[]).join(" ")}),i}const n$=e=>e,Cxe=()=>{let e=n$;return{configure(t){e=t},generate(t){return e(t)},reset(){e=n$}}},Axe=Cxe(),Txe=Axe,Mxe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Pi(e,t,r="Mui"){const i=Mxe[t];return i?`${r}-${i}`:`${Txe.generate(e)}-${t}`}function Fi(e,t,r="Mui"){const i={};return t.forEach(n=>{i[n]=Pi(e,n,r)}),i}const Pxe=["values","unit","step"],Ixe=e=>{const t=Object.keys(e).map(r=>({key:r,val:e[r]}))||[];return t.sort((r,i)=>r.val-i.val),t.reduce((r,i)=>ae({},r,{[i.key]:i.val}),{})};function Rxe(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:i=5}=e,n=ar(e,Pxe),s=Ixe(t),a=Object.keys(s);function o(h){return`@media (min-width:${typeof t[h]=="number"?t[h]:h}${r})`}function l(h){return`@media (max-width:${(typeof t[h]=="number"?t[h]:h)-i/100}${r})`}function c(h,f){const p=a.indexOf(f);return`@media (min-width:${typeof t[h]=="number"?t[h]:h}${r}) and (max-width:${(p!==-1&&typeof t[a[p]]=="number"?t[a[p]]:f)-i/100}${r})`}function d(h){return a.indexOf(h)+1<a.length?c(h,a[a.indexOf(h)+1]):o(h)}function u(h){const f=a.indexOf(h);return f===0?o(a[1]):f===a.length-1?l(a[f]):c(h,a[a.indexOf(h)+1]).replace("@media","@media not all and")}return ae({keys:a,values:s,up:o,down:l,between:c,only:d,not:u,unit:r},n)}const Dxe={borderRadius:4},Oxe=Dxe;function z1(e,t){return t?Ya(e,t,{clone:!1}):e}const YB={xs:0,sm:600,md:900,lg:1200,xl:1536},s$={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${YB[e]}px)`};function od(e,t,r){const i=e.theme||{};if(Array.isArray(t)){const s=i.breakpoints||s$;return t.reduce((a,o,l)=>(a[s.up(s.keys[l])]=r(t[l]),a),{})}if(typeof t=="object"){const s=i.breakpoints||s$;return Object.keys(t).reduce((a,o)=>{if(Object.keys(s.values||YB).indexOf(o)!==-1){const l=s.up(o);a[l]=r(t[o],o)}else{const l=o;a[l]=t[l]}return a},{})}return r(t)}function Lxe(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((i,n)=>{const s=e.up(n);return i[s]={},i},{}))||{}}function Nxe(e,t){return e.reduce((r,i)=>{const n=r[i];return(!n||Object.keys(n).length===0)&&delete r[i],r},t)}function H2(e,t,r=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&r){const i=`vars.${t}`.split(".").reduce((n,s)=>n&&n[s]?n[s]:null,e);if(i!=null)return i}return t.split(".").reduce((i,n)=>i&&i[n]!=null?i[n]:null,e)}function OC(e,t,r,i=r){let n;return typeof e=="function"?n=e(r):Array.isArray(e)?n=e[r]||i:n=H2(e,r)||i,t&&(n=t(n,i,e)),n}function hn(e){const{prop:t,cssProperty:r=e.prop,themeKey:i,transform:n}=e,s=a=>{if(a[t]==null)return null;const o=a[t],l=a.theme,c=H2(l,i)||{};return od(a,o,u=>{let h=OC(c,n,u);return u===h&&typeof u=="string"&&(h=OC(c,n,`${t}${u==="default"?"":Xr(u)}`,u)),r===!1?h:{[r]:h}})};return s.propTypes={},s.filterProps=[t],s}function kxe(e){const t={};return r=>(t[r]===void 0&&(t[r]=e(r)),t[r])}const zxe={m:"margin",p:"padding"},Bxe={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},a$={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Fxe=kxe(e=>{if(e.length>2)if(a$[e])e=a$[e];else return[e];const[t,r]=e.split(""),i=zxe[t],n=Bxe[r]||"";return Array.isArray(n)?n.map(s=>i+s):[i+n]}),KB=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],QB=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...KB,...QB];function Jx(e,t,r,i){var n;const s=(n=H2(e,t,!1))!=null?n:r;return typeof s=="number"?a=>typeof a=="string"?a:s*a:Array.isArray(s)?a=>typeof a=="string"?a:s[a]:typeof s=="function"?s:()=>{}}function nee(e){return Jx(e,"spacing",8)}function ew(e,t){if(typeof t=="string"||t==null)return t;const r=Math.abs(t),i=e(r);return t>=0?i:typeof i=="number"?-i:`-${i}`}function jxe(e,t){return r=>e.reduce((i,n)=>(i[n]=ew(t,r),i),{})}function Vxe(e,t,r,i){if(t.indexOf(r)===-1)return null;const n=Fxe(r),s=jxe(n,i),a=e[r];return od(e,a,s)}function see(e,t){const r=nee(e.theme);return Object.keys(e).map(i=>Vxe(e,t,i,r)).reduce(z1,{})}function Hi(e){return see(e,KB)}Hi.propTypes={};Hi.filterProps=KB;function Wi(e){return see(e,QB)}Wi.propTypes={};Wi.filterProps=QB;function Uxe(e=8){if(e.mui)return e;const t=nee({spacing:e}),r=(...i)=>(i.length===0?[1]:i).map(s=>{const a=t(s);return typeof a=="number"?`${a}px`:a}).join(" ");return r.mui=!0,r}function W2(...e){const t=e.reduce((i,n)=>(n.filterProps.forEach(s=>{i[s]=n}),i),{}),r=i=>Object.keys(i).reduce((n,s)=>t[s]?z1(n,t[s](i)):n,{});return r.propTypes={},r.filterProps=e.reduce((i,n)=>i.concat(n.filterProps),[]),r}function qo(e){return typeof e!="number"?e:`${e}px solid`}function ll(e,t){return hn({prop:e,themeKey:"borders",transform:t})}const $xe=ll("border",qo),Hxe=ll("borderTop",qo),Wxe=ll("borderRight",qo),Gxe=ll("borderBottom",qo),qxe=ll("borderLeft",qo),Xxe=ll("borderColor"),Yxe=ll("borderTopColor"),Kxe=ll("borderRightColor"),Qxe=ll("borderBottomColor"),Zxe=ll("borderLeftColor"),Jxe=ll("outline",qo),ewe=ll("outlineColor"),G2=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=Jx(e.theme,"shape.borderRadius",4),r=i=>({borderRadius:ew(t,i)});return od(e,e.borderRadius,r)}return null};G2.propTypes={};G2.filterProps=["borderRadius"];W2($xe,Hxe,Wxe,Gxe,qxe,Xxe,Yxe,Kxe,Qxe,Zxe,G2,Jxe,ewe);const q2=e=>{if(e.gap!==void 0&&e.gap!==null){const t=Jx(e.theme,"spacing",8),r=i=>({gap:ew(t,i)});return od(e,e.gap,r)}return null};q2.propTypes={};q2.filterProps=["gap"];const X2=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=Jx(e.theme,"spacing",8),r=i=>({columnGap:ew(t,i)});return od(e,e.columnGap,r)}return null};X2.propTypes={};X2.filterProps=["columnGap"];const Y2=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=Jx(e.theme,"spacing",8),r=i=>({rowGap:ew(t,i)});return od(e,e.rowGap,r)}return null};Y2.propTypes={};Y2.filterProps=["rowGap"];const twe=hn({prop:"gridColumn"}),rwe=hn({prop:"gridRow"}),iwe=hn({prop:"gridAutoFlow"}),nwe=hn({prop:"gridAutoColumns"}),swe=hn({prop:"gridAutoRows"}),awe=hn({prop:"gridTemplateColumns"}),owe=hn({prop:"gridTemplateRows"}),lwe=hn({prop:"gridTemplateAreas"}),cwe=hn({prop:"gridArea"});W2(q2,X2,Y2,twe,rwe,iwe,nwe,swe,awe,owe,lwe,cwe);function nv(e,t){return t==="grey"?t:e}const uwe=hn({prop:"color",themeKey:"palette",transform:nv}),dwe=hn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:nv}),hwe=hn({prop:"backgroundColor",themeKey:"palette",transform:nv});W2(uwe,dwe,hwe);function uo(e){return e<=1&&e!==0?`${e*100}%`:e}const fwe=hn({prop:"width",transform:uo}),ZB=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=r=>{var i,n;const s=((i=e.theme)==null||(i=i.breakpoints)==null||(i=i.values)==null?void 0:i[r])||YB[r];return s?((n=e.theme)==null||(n=n.breakpoints)==null?void 0:n.unit)!=="px"?{maxWidth:`${s}${e.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:uo(r)}};return od(e,e.maxWidth,t)}return null};ZB.filterProps=["maxWidth"];const pwe=hn({prop:"minWidth",transform:uo}),mwe=hn({prop:"height",transform:uo}),gwe=hn({prop:"maxHeight",transform:uo}),vwe=hn({prop:"minHeight",transform:uo});hn({prop:"size",cssProperty:"width",transform:uo});hn({prop:"size",cssProperty:"height",transform:uo});const ywe=hn({prop:"boxSizing"});W2(fwe,ZB,pwe,mwe,gwe,vwe,ywe);const bwe={border:{themeKey:"borders",transform:qo},borderTop:{themeKey:"borders",transform:qo},borderRight:{themeKey:"borders",transform:qo},borderBottom:{themeKey:"borders",transform:qo},borderLeft:{themeKey:"borders",transform:qo},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:qo},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:G2},color:{themeKey:"palette",transform:nv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:nv},backgroundColor:{themeKey:"palette",transform:nv},p:{style:Wi},pt:{style:Wi},pr:{style:Wi},pb:{style:Wi},pl:{style:Wi},px:{style:Wi},py:{style:Wi},padding:{style:Wi},paddingTop:{style:Wi},paddingRight:{style:Wi},paddingBottom:{style:Wi},paddingLeft:{style:Wi},paddingX:{style:Wi},paddingY:{style:Wi},paddingInline:{style:Wi},paddingInlineStart:{style:Wi},paddingInlineEnd:{style:Wi},paddingBlock:{style:Wi},paddingBlockStart:{style:Wi},paddingBlockEnd:{style:Wi},m:{style:Hi},mt:{style:Hi},mr:{style:Hi},mb:{style:Hi},ml:{style:Hi},mx:{style:Hi},my:{style:Hi},margin:{style:Hi},marginTop:{style:Hi},marginRight:{style:Hi},marginBottom:{style:Hi},marginLeft:{style:Hi},marginX:{style:Hi},marginY:{style:Hi},marginInline:{style:Hi},marginInlineStart:{style:Hi},marginInlineEnd:{style:Hi},marginBlock:{style:Hi},marginBlockStart:{style:Hi},marginBlockEnd:{style:Hi},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:q2},rowGap:{style:Y2},columnGap:{style:X2},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:uo},maxWidth:{style:ZB},minWidth:{transform:uo},height:{transform:uo},maxHeight:{transform:uo},minHeight:{transform:uo},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},K2=bwe;function xwe(...e){const t=e.reduce((i,n)=>i.concat(Object.keys(n)),[]),r=new Set(t);return e.every(i=>r.size===Object.keys(i).length)}function wwe(e,t){return typeof e=="function"?e(t):e}function _we(){function e(r,i,n,s){const a={[r]:i,theme:n},o=s[r];if(!o)return{[r]:i};const{cssProperty:l=r,themeKey:c,transform:d,style:u}=o;if(i==null)return null;if(c==="typography"&&i==="inherit")return{[r]:i};const h=H2(n,c)||{};return u?u(a):od(a,i,p=>{let m=OC(h,d,p);return p===m&&typeof p=="string"&&(m=OC(h,d,`${r}${p==="default"?"":Xr(p)}`,p)),l===!1?m:{[l]:m}})}function t(r){var i;const{sx:n,theme:s={}}=r||{};if(!n)return null;const a=(i=s.unstable_sxConfig)!=null?i:K2;function o(l){let c=l;if(typeof l=="function")c=l(s);else if(typeof l!="object")return l;if(!c)return null;const d=Lxe(s.breakpoints),u=Object.keys(d);let h=d;return Object.keys(c).forEach(f=>{const p=wwe(c[f],s);if(p!=null)if(typeof p=="object")if(a[f])h=z1(h,e(f,p,s,a));else{const m=od({theme:s},p,g=>({[f]:g}));xwe(m,p)?h[f]=t({sx:p,theme:s}):h=z1(h,m)}else h=z1(h,e(f,p,s,a))}),Nxe(u,h)}return Array.isArray(n)?n.map(o):o(n)}return t}const aee=_we();aee.filterProps=["sx"];const JB=aee,Swe=["breakpoints","palette","spacing","shape"];function eF(e={},...t){const{breakpoints:r={},palette:i={},spacing:n,shape:s={}}=e,a=ar(e,Swe),o=Rxe(r),l=Uxe(n);let c=Ya({breakpoints:o,direction:"ltr",components:{},palette:ae({mode:"light"},i),spacing:l,shape:ae({},Oxe,s)},a);return c=t.reduce((d,u)=>Ya(d,u),c),c.unstable_sxConfig=ae({},K2,a==null?void 0:a.unstable_sxConfig),c.unstable_sx=function(u){return JB({sx:u,theme:this})},c}function Ewe(e){return Object.keys(e).length===0}function Cwe(e=null){const t=_.useContext(HB);return!t||Ewe(t)?e:t}const Awe=eF();function tF(e=Awe){return Cwe(e)}function Twe({styles:e,themeId:t,defaultTheme:r={}}){const i=tF(r),n=typeof e=="function"?e(t&&i[t]||i):e;return G.jsx(yxe,{styles:n})}const Mwe=["sx"],Pwe=e=>{var t,r;const i={systemProps:{},otherProps:{}},n=(t=e==null||(r=e.theme)==null?void 0:r.unstable_sxConfig)!=null?t:K2;return Object.keys(e).forEach(s=>{n[s]?i.systemProps[s]=e[s]:i.otherProps[s]=e[s]}),i};function Iwe(e){const{sx:t}=e,r=ar(e,Mwe),{systemProps:i,otherProps:n}=Pwe(r);let s;return Array.isArray(t)?s=[i,...t]:typeof t=="function"?s=(...a)=>{const o=t(...a);return Ou(o)?ae({},i,o):i}:s=ae({},i,t),ae({},n,{sx:s})}function oee(e){var t,r,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=oee(e[t]))&&(i&&(i+=" "),i+=r);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function ui(){for(var e,t,r=0,i="";r<arguments.length;)(e=arguments[r++])&&(t=oee(e))&&(i&&(i+=" "),i+=t);return i}const Rwe=["variant"];function o$(e){return e.length===0}function lee(e){const{variant:t}=e,r=ar(e,Rwe);let i=t||"";return Object.keys(r).sort().forEach(n=>{n==="color"?i+=o$(i)?e[n]:Xr(e[n]):i+=`${o$(i)?n:Xr(n)}${Xr(e[n].toString())}`}),i}const Dwe=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Owe(e){return Object.keys(e).length===0}function Lwe(e){return typeof e=="string"&&e.charCodeAt(0)>96}const Nwe=(e,t)=>t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null,LC=e=>{let t=0;const r={};return e&&e.forEach(i=>{let n="";typeof i.props=="function"?(n=`callback${t}`,t+=1):n=lee(i.props),r[n]=i.style}),r},kwe=(e,t)=>{let r=[];return t&&t.components&&t.components[e]&&t.components[e].variants&&(r=t.components[e].variants),LC(r)},NC=(e,t,r)=>{const{ownerState:i={}}=e,n=[];let s=0;return r&&r.forEach(a=>{let o=!0;if(typeof a.props=="function"){const l=ae({},e,i);o=a.props(l)}else Object.keys(a.props).forEach(l=>{i[l]!==a.props[l]&&e[l]!==a.props[l]&&(o=!1)});o&&(typeof a.props=="function"?n.push(t[`callback${s}`]):n.push(t[lee(a.props)])),typeof a.props=="function"&&(s+=1)}),n},zwe=(e,t,r,i)=>{var n;const s=r==null||(n=r.components)==null||(n=n[i])==null?void 0:n.variants;return NC(e,t,s)};function B1(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Bwe=eF(),Fwe=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function fE({defaultTheme:e,theme:t,themeId:r}){return Owe(t)?e:t[r]||t}function jwe(e){return e?(t,r)=>r[e]:null}const l$=({styledArg:e,props:t,defaultTheme:r,themeId:i})=>{const n=e(ae({},t,{theme:fE(ae({},t,{defaultTheme:r,themeId:i}))}));let s;if(n&&n.variants&&(s=n.variants,delete n.variants),s){const a=NC(t,LC(s),s);return[n,...a]}return n};function Vwe(e={}){const{themeId:t,defaultTheme:r=Bwe,rootShouldForwardProp:i=B1,slotShouldForwardProp:n=B1}=e,s=a=>JB(ae({},a,{theme:fE(ae({},a,{defaultTheme:r,themeId:t}))}));return s.__mui_systemSx=!0,(a,o={})=>{xxe(a,x=>x.filter(S=>!(S!=null&&S.__mui_systemSx)));const{name:l,slot:c,skipVariantsResolver:d,skipSx:u,overridesResolver:h=jwe(Fwe(c))}=o,f=ar(o,Dwe),p=d!==void 0?d:c&&c!=="Root"&&c!=="root"||!1,m=u||!1;let g,v=B1;c==="Root"||c==="root"?v=i:c?v=n:Lwe(a)&&(v=void 0);const y=bxe(a,ae({shouldForwardProp:v,label:g},f)),b=(x,...S)=>{const w=S?S.map(A=>{if(typeof A=="function"&&A.__emotion_real!==A)return M=>l$({styledArg:A,props:M,defaultTheme:r,themeId:t});if(Ou(A)){let M=A,P;return A&&A.variants&&(P=A.variants,delete M.variants,M=I=>{let R=A;return NC(I,LC(P),P).forEach(k=>{R=Ya(R,k)}),R}),M}return A}):[];let E=x;if(Ou(x)){let A;x&&x.variants&&(A=x.variants,delete E.variants,E=M=>{let P=x;return NC(M,LC(A),A).forEach(R=>{P=Ya(P,R)}),P})}else typeof x=="function"&&x.__emotion_real!==x&&(E=A=>l$({styledArg:x,props:A,defaultTheme:r,themeId:t}));l&&h&&w.push(A=>{const M=fE(ae({},A,{defaultTheme:r,themeId:t})),P=Nwe(l,M);if(P){const I={};return Object.entries(P).forEach(([R,N])=>{I[R]=typeof N=="function"?N(ae({},A,{theme:M})):N}),h(A,I)}return null}),l&&!p&&w.push(A=>{const M=fE(ae({},A,{defaultTheme:r,themeId:t}));return zwe(A,kwe(l,M),M,l)}),m||w.push(s);const C=w.length-S.length;if(Array.isArray(x)&&C>0){const A=new Array(C).fill("");E=[...x,...A],E.raw=[...x.raw,...A]}const T=y(E,...w);return a.muiName&&(T.muiName=a.muiName),T};return y.withConfig&&(b.withConfig=y.withConfig),b}}function Uwe(e){const{theme:t,name:r,props:i}=e;return!t||!t.components||!t.components[r]||!t.components[r].defaultProps?i:iee(t.components[r].defaultProps,i)}function $we({props:e,name:t,defaultTheme:r,themeId:i}){let n=tF(r);return i&&(n=n[i]||n),Uwe({theme:n,name:t,props:e})}function rF(e,t=0,r=1){return Math.min(Math.max(t,e),r)}function Hwe(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(t);return r&&r[0].length===1&&(r=r.map(i=>i+i)),r?`rgb${r.length===4?"a":""}(${r.map((i,n)=>n<3?parseInt(i,16):Math.round(parseInt(i,16)/255*1e3)/1e3).join(", ")})`:""}function Ip(e){if(e.type)return e;if(e.charAt(0)==="#")return Ip(Hwe(e));const t=e.indexOf("("),r=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(r)===-1)throw new Error(Fh(9,e));let i=e.substring(t+1,e.length-1),n;if(r==="color"){if(i=i.split(" "),n=i.shift(),i.length===4&&i[3].charAt(0)==="/"&&(i[3]=i[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n)===-1)throw new Error(Fh(10,n))}else i=i.split(",");return i=i.map(s=>parseFloat(s)),{type:r,values:i,colorSpace:n}}function Q2(e){const{type:t,colorSpace:r}=e;let{values:i}=e;return t.indexOf("rgb")!==-1?i=i.map((n,s)=>s<3?parseInt(n,10):n):t.indexOf("hsl")!==-1&&(i[1]=`${i[1]}%`,i[2]=`${i[2]}%`),t.indexOf("color")!==-1?i=`${r} ${i.join(" ")}`:i=`${i.join(", ")}`,`${t}(${i})`}function Wwe(e){e=Ip(e);const{values:t}=e,r=t[0],i=t[1]/100,n=t[2]/100,s=i*Math.min(n,1-n),a=(c,d=(c+r/30)%12)=>n-s*Math.max(Math.min(d-3,9-d,1),-1);let o="rgb";const l=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return e.type==="hsla"&&(o+="a",l.push(t[3])),Q2({type:o,values:l})}function c$(e){e=Ip(e);let t=e.type==="hsl"||e.type==="hsla"?Ip(Wwe(e)).values:e.values;return t=t.map(r=>(e.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Gwe(e,t){const r=c$(e),i=c$(t);return(Math.max(r,i)+.05)/(Math.min(r,i)+.05)}function u$(e,t){return e=Ip(e),t=rF(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Q2(e)}function qwe(e,t){if(e=Ip(e),t=rF(t),e.type.indexOf("hsl")!==-1)e.values[2]*=1-t;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let r=0;r<3;r+=1)e.values[r]*=1-t;return Q2(e)}function Xwe(e,t){if(e=Ip(e),t=rF(t),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*t;else if(e.type.indexOf("rgb")!==-1)for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(e.type.indexOf("color")!==-1)for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return Q2(e)}function Ywe(e,t){return ae({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}const Kwe=["mode","contrastThreshold","tonalOffset"],d$={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:$b.white,default:$b.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},rI={text:{primary:$b.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:$b.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function h$(e,t,r,i){const n=i.light||i,s=i.dark||i*1.5;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:t==="light"?e.light=Xwe(e.main,n):t==="dark"&&(e.dark=qwe(e.main,s)))}function Qwe(e="light"){return e==="dark"?{main:pm[200],light:pm[50],dark:pm[400]}:{main:pm[700],light:pm[400],dark:pm[800]}}function Zwe(e="light"){return e==="dark"?{main:fm[200],light:fm[50],dark:fm[400]}:{main:fm[500],light:fm[300],dark:fm[700]}}function Jwe(e="light"){return e==="dark"?{main:hm[500],light:hm[300],dark:hm[700]}:{main:hm[700],light:hm[400],dark:hm[800]}}function e_e(e="light"){return e==="dark"?{main:mm[400],light:mm[300],dark:mm[700]}:{main:mm[700],light:mm[500],dark:mm[900]}}function t_e(e="light"){return e==="dark"?{main:gm[400],light:gm[300],dark:gm[700]}:{main:gm[800],light:gm[500],dark:gm[900]}}function r_e(e="light"){return e==="dark"?{main:cy[400],light:cy[300],dark:cy[700]}:{main:"#ed6c02",light:cy[500],dark:cy[900]}}function i_e(e){const{mode:t="light",contrastThreshold:r=3,tonalOffset:i=.2}=e,n=ar(e,Kwe),s=e.primary||Qwe(t),a=e.secondary||Zwe(t),o=e.error||Jwe(t),l=e.info||e_e(t),c=e.success||t_e(t),d=e.warning||r_e(t);function u(m){return Gwe(m,rI.text.primary)>=r?rI.text.primary:d$.text.primary}const h=({color:m,name:g,mainShade:v=500,lightShade:y=300,darkShade:b=700})=>{if(m=ae({},m),!m.main&&m[v]&&(m.main=m[v]),!m.hasOwnProperty("main"))throw new Error(Fh(11,g?` (${g})`:"",v));if(typeof m.main!="string")throw new Error(Fh(12,g?` (${g})`:"",JSON.stringify(m.main)));return h$(m,"light",y,i),h$(m,"dark",b,i),m.contrastText||(m.contrastText=u(m.main)),m},f={dark:rI,light:d$};return Ya(ae({common:ae({},$b),mode:t,primary:h({color:s,name:"primary"}),secondary:h({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:o,name:"error"}),warning:h({color:d,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:c,name:"success"}),grey:ybe,contrastThreshold:r,getContrastText:u,augmentColor:h,tonalOffset:i},f[t]),n)}const n_e=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function s_e(e){return Math.round(e*1e5)/1e5}const f$={textTransform:"uppercase"},p$='"Roboto", "Helvetica", "Arial", sans-serif';function a_e(e,t){const r=typeof t=="function"?t(e):t,{fontFamily:i=p$,fontSize:n=14,fontWeightLight:s=300,fontWeightRegular:a=400,fontWeightMedium:o=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:d,pxToRem:u}=r,h=ar(r,n_e),f=n/14,p=u||(v=>`${v/c*f}rem`),m=(v,y,b,x,S)=>ae({fontFamily:i,fontWeight:v,fontSize:p(y),lineHeight:b},i===p$?{letterSpacing:`${s_e(x/y)}em`}:{},S,d),g={h1:m(s,96,1.167,-1.5),h2:m(s,60,1.2,-.5),h3:m(a,48,1.167,0),h4:m(a,34,1.235,.25),h5:m(a,24,1.334,0),h6:m(o,20,1.6,.15),subtitle1:m(a,16,1.75,.15),subtitle2:m(o,14,1.57,.1),body1:m(a,16,1.5,.15),body2:m(a,14,1.43,.15),button:m(o,14,1.75,.4,f$),caption:m(a,12,1.66,.4),overline:m(a,12,2.66,1,f$),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ya(ae({htmlFontSize:c,pxToRem:p,fontFamily:i,fontSize:n,fontWeightLight:s,fontWeightRegular:a,fontWeightMedium:o,fontWeightBold:l},g),h,{clone:!1})}const o_e=.2,l_e=.14,c_e=.12;function Ti(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${o_e})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${l_e})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${c_e})`].join(",")}const u_e=["none",Ti(0,2,1,-1,0,1,1,0,0,1,3,0),Ti(0,3,1,-2,0,2,2,0,0,1,5,0),Ti(0,3,3,-2,0,3,4,0,0,1,8,0),Ti(0,2,4,-1,0,4,5,0,0,1,10,0),Ti(0,3,5,-1,0,5,8,0,0,1,14,0),Ti(0,3,5,-1,0,6,10,0,0,1,18,0),Ti(0,4,5,-2,0,7,10,1,0,2,16,1),Ti(0,5,5,-3,0,8,10,1,0,3,14,2),Ti(0,5,6,-3,0,9,12,1,0,3,16,2),Ti(0,6,6,-3,0,10,14,1,0,4,18,3),Ti(0,6,7,-4,0,11,15,1,0,4,20,3),Ti(0,7,8,-4,0,12,17,2,0,5,22,4),Ti(0,7,8,-4,0,13,19,2,0,5,24,4),Ti(0,7,9,-4,0,14,21,2,0,5,26,4),Ti(0,8,9,-5,0,15,22,2,0,6,28,5),Ti(0,8,10,-5,0,16,24,2,0,6,30,5),Ti(0,8,11,-5,0,17,26,2,0,6,32,5),Ti(0,9,11,-5,0,18,28,2,0,7,34,6),Ti(0,9,12,-6,0,19,29,2,0,7,36,6),Ti(0,10,13,-6,0,20,31,3,0,8,38,7),Ti(0,10,13,-6,0,21,33,3,0,8,40,7),Ti(0,10,14,-6,0,22,35,3,0,8,42,7),Ti(0,11,14,-7,0,23,36,3,0,9,44,8),Ti(0,11,15,-7,0,24,38,3,0,9,46,8)],d_e=u_e,h_e=["duration","easing","delay"],f_e={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},p_e={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function m$(e){return`${Math.round(e)}ms`}function m_e(e){if(!e)return 0;const t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function g_e(e){const t=ae({},f_e,e.easing),r=ae({},p_e,e.duration);return ae({getAutoHeightDuration:m_e,create:(n=["all"],s={})=>{const{duration:a=r.standard,easing:o=t.easeInOut,delay:l=0}=s;return ar(s,h_e),(Array.isArray(n)?n:[n]).map(c=>`${c} ${typeof a=="string"?a:m$(a)} ${o} ${typeof l=="string"?l:m$(l)}`).join(",")}},e,{easing:t,duration:r})}const v_e={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},y_e=v_e,b_e=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function x_e(e={},...t){const{mixins:r={},palette:i={},transitions:n={},typography:s={}}=e,a=ar(e,b_e);if(e.vars)throw new Error(Fh(18));const o=i_e(i),l=eF(e);let c=Ya(l,{mixins:Ywe(l.breakpoints,r),palette:o,shadows:d_e.slice(),typography:a_e(o,s),transitions:g_e(n),zIndex:ae({},y_e)});return c=Ya(c,a),c=t.reduce((d,u)=>Ya(d,u),c),c.unstable_sxConfig=ae({},K2,a==null?void 0:a.unstable_sxConfig),c.unstable_sx=function(u){return JB({sx:u,theme:this})},c}const w_e=x_e(),Z2=w_e;function J2(){const e=tF(Z2);return e[x2]||e}function Ji({props:e,name:t}){return $we({props:e,name:t,defaultTheme:Z2,themeId:x2})}const Jl=e=>B1(e)&&e!=="classes",__e=B1,S_e=Vwe({themeId:x2,defaultTheme:Z2,rootShouldForwardProp:Jl}),fr=S_e,E_e=e=>{let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,(t/100).toFixed(2)},g$=E_e;function C_e(e){return Pi("MuiSvgIcon",e)}Fi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const A_e=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],T_e=e=>{const{color:t,fontSize:r,classes:i}=e,n={root:["root",t!=="inherit"&&`color${Xr(t)}`,`fontSize${Xr(r)}`]};return Bi(n,C_e,i)},M_e=fr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.color!=="inherit"&&t[`color${Xr(r.color)}`],t[`fontSize${Xr(r.fontSize)}`]]}})(({theme:e,ownerState:t})=>{var r,i,n,s,a,o,l,c,d,u,h,f,p;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(r=e.transitions)==null||(i=r.create)==null?void 0:i.call(r,"fill",{duration:(n=e.transitions)==null||(n=n.duration)==null?void 0:n.shorter}),fontSize:{inherit:"inherit",small:((s=e.typography)==null||(a=s.pxToRem)==null?void 0:a.call(s,20))||"1.25rem",medium:((o=e.typography)==null||(l=o.pxToRem)==null?void 0:l.call(o,24))||"1.5rem",large:((c=e.typography)==null||(d=c.pxToRem)==null?void 0:d.call(c,35))||"2.1875rem"}[t.fontSize],color:(u=(h=(e.vars||e).palette)==null||(h=h[t.color])==null?void 0:h.main)!=null?u:{action:(f=(e.vars||e).palette)==null||(f=f.action)==null?void 0:f.active,disabled:(p=(e.vars||e).palette)==null||(p=p.action)==null?void 0:p.disabled,inherit:void 0}[t.color]}}),cee=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiSvgIcon"}),{children:n,className:s,color:a="inherit",component:o="svg",fontSize:l="medium",htmlColor:c,inheritViewBox:d=!1,titleAccess:u,viewBox:h="0 0 24 24"}=i,f=ar(i,A_e),p=_.isValidElement(n)&&n.type==="svg",m=ae({},i,{color:a,component:o,fontSize:l,instanceFontSize:t.fontSize,inheritViewBox:d,viewBox:h,hasSvgAsChild:p}),g={};d||(g.viewBox=h);const v=T_e(m);return G.jsxs(M_e,ae({as:o,className:ui(v.root,s),focusable:"false",color:c,"aria-hidden":u?void 0:!0,role:u?"img":void 0,ref:r},g,f,p&&n.props,{ownerState:m,children:[p?n.props.children:n,u?G.jsx("title",{children:u}):null]}))});cee.muiName="SvgIcon";const v$=cee;function iF(e,t){function r(i,n){return G.jsx(v$,ae({"data-testid":`${t}Icon`,ref:n},i,{children:e}))}return r.muiName=v$.muiName,_.memo(_.forwardRef(r))}function kC(e,t){return kC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},kC(e,t)}function P_e(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,kC(e,t)}const y$={disabled:!1},uee=Ge.createContext(null);var I_e=function(t){return t.scrollTop},c1="unmounted",yf="exited",bf="entering",fg="entered",A3="exiting",md=function(e){P_e(t,e);function t(i,n){var s;s=e.call(this,i,n)||this;var a=n,o=a&&!a.isMounting?i.enter:i.appear,l;return s.appearStatus=null,i.in?o?(l=yf,s.appearStatus=bf):l=fg:i.unmountOnExit||i.mountOnEnter?l=c1:l=yf,s.state={status:l},s.nextCallback=null,s}t.getDerivedStateFromProps=function(n,s){var a=n.in;return a&&s.status===c1?{status:yf}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(n){var s=null;if(n!==this.props){var a=this.state.status;this.props.in?a!==bf&&a!==fg&&(s=bf):(a===bf||a===fg)&&(s=A3)}this.updateStatus(!1,s)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var n=this.props.timeout,s,a,o;return s=a=o=n,n!=null&&typeof n!="number"&&(s=n.exit,a=n.enter,o=n.appear!==void 0?n.appear:a),{exit:s,enter:a,appear:o}},r.updateStatus=function(n,s){if(n===void 0&&(n=!1),s!==null)if(this.cancelNextCallback(),s===bf){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:Lg.findDOMNode(this);a&&I_e(a)}this.performEnter(n)}else this.performExit();else this.props.unmountOnExit&&this.state.status===yf&&this.setState({status:c1})},r.performEnter=function(n){var s=this,a=this.props.enter,o=this.context?this.context.isMounting:n,l=this.props.nodeRef?[o]:[Lg.findDOMNode(this),o],c=l[0],d=l[1],u=this.getTimeouts(),h=o?u.appear:u.enter;if(!n&&!a||y$.disabled){this.safeSetState({status:fg},function(){s.props.onEntered(c)});return}this.props.onEnter(c,d),this.safeSetState({status:bf},function(){s.props.onEntering(c,d),s.onTransitionEnd(h,function(){s.safeSetState({status:fg},function(){s.props.onEntered(c,d)})})})},r.performExit=function(){var n=this,s=this.props.exit,a=this.getTimeouts(),o=this.props.nodeRef?void 0:Lg.findDOMNode(this);if(!s||y$.disabled){this.safeSetState({status:yf},function(){n.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:A3},function(){n.props.onExiting(o),n.onTransitionEnd(a.exit,function(){n.safeSetState({status:yf},function(){n.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(n,s){s=this.setNextCallback(s),this.setState(n,s)},r.setNextCallback=function(n){var s=this,a=!0;return this.nextCallback=function(o){a&&(a=!1,s.nextCallback=null,n(o))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},r.onTransitionEnd=function(n,s){this.setNextCallback(s);var a=this.props.nodeRef?this.props.nodeRef.current:Lg.findDOMNode(this),o=n==null&&!this.props.addEndListener;if(!a||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],c=l[0],d=l[1];this.props.addEndListener(c,d)}n!=null&&setTimeout(this.nextCallback,n)},r.render=function(){var n=this.state.status;if(n===c1)return null;var s=this.props,a=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var o=ar(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Ge.createElement(uee.Provider,{value:null},typeof a=="function"?a(n,o):Ge.cloneElement(Ge.Children.only(a),o))},t}(Ge.Component);md.contextType=uee;md.propTypes={};function vm(){}md.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:vm,onEntering:vm,onEntered:vm,onExit:vm,onExiting:vm,onExited:vm};md.UNMOUNTED=c1;md.EXITED=yf;md.ENTERING=bf;md.ENTERED=fg;md.EXITING=A3;const dee=md;function Nr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}const hee=e=>e.scrollTop;function zC(e,t){var r,i;const{timeout:n,easing:s,style:a={}}=e;return{duration:(r=a.transitionDuration)!=null?r:typeof n=="number"?n:n[t.mode]||0,easing:(i=a.transitionTimingFunction)!=null?i:typeof s=="object"?s[t.mode]:s,delay:a.transitionDelay}}function R_e(e){return Pi("MuiPaper",e)}Fi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const D_e=["className","component","elevation","square","variant"],O_e=e=>{const{square:t,elevation:r,variant:i,classes:n}=e,s={root:["root",i,!t&&"rounded",i==="elevation"&&`elevation${r}`]};return Bi(s,R_e,n)},L_e=fr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],!r.square&&t.rounded,r.variant==="elevation"&&t[`elevation${r.elevation}`]]}})(({theme:e,ownerState:t})=>{var r;return ae({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!t.square&&{borderRadius:e.shape.borderRadius},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.divider}`},t.variant==="elevation"&&ae({boxShadow:(e.vars||e).shadows[t.elevation]},!e.vars&&e.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${u$("#fff",g$(t.elevation))}, ${u$("#fff",g$(t.elevation))})`},e.vars&&{backgroundImage:(r=e.vars.overlays)==null?void 0:r[t.elevation]}))}),N_e=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiPaper"}),{className:n,component:s="div",elevation:a=1,square:o=!1,variant:l="elevation"}=i,c=ar(i,D_e),d=ae({},i,{component:s,elevation:a,square:o,variant:l}),u=O_e(d);return G.jsx(L_e,ae({as:s,ownerState:d,className:ui(u.root,n),ref:r},c))}),nF=N_e;function k_e(e){return Pi("MuiTypography",e)}Fi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const z_e=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],B_e=e=>{const{align:t,gutterBottom:r,noWrap:i,paragraph:n,variant:s,classes:a}=e,o={root:["root",s,e.align!=="inherit"&&`align${Xr(t)}`,r&&"gutterBottom",i&&"noWrap",n&&"paragraph"]};return Bi(o,k_e,a)},F_e=fr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.variant&&t[r.variant],r.align!=="inherit"&&t[`align${Xr(r.align)}`],r.noWrap&&t.noWrap,r.gutterBottom&&t.gutterBottom,r.paragraph&&t.paragraph]}})(({theme:e,ownerState:t})=>ae({margin:0},t.variant==="inherit"&&{font:"inherit"},t.variant!=="inherit"&&e.typography[t.variant],t.align!=="inherit"&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16})),b$={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},j_e={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},V_e=e=>j_e[e]||e,U_e=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiTypography"}),n=V_e(i.color),s=Iwe(ae({},i,{color:n})),{align:a="inherit",className:o,component:l,gutterBottom:c=!1,noWrap:d=!1,paragraph:u=!1,variant:h="body1",variantMapping:f=b$}=s,p=ar(s,z_e),m=ae({},s,{align:a,color:n,className:o,component:l,gutterBottom:c,noWrap:d,paragraph:u,variant:h,variantMapping:f}),g=l||(u?"p":f[h]||b$[h])||"span",v=B_e(m);return G.jsx(F_e,ae({as:g,ref:r,ownerState:m,className:ui(v.root,o)},p))}),fee=U_e;function BC(e){return typeof e=="string"}function $_e(e,t,r){return e===void 0||BC(e)?t:ae({},t,{ownerState:ae({},t.ownerState,r)})}function pee(e,t=[]){if(e===void 0)return{};const r={};return Object.keys(e).filter(i=>i.match(/^on[A-Z]/)&&typeof e[i]=="function"&&!t.includes(i)).forEach(i=>{r[i]=e[i]}),r}function H_e(e,t,r){return typeof e=="function"?e(t,r):e}function x$(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(r=>!(r.match(/^on[A-Z]/)&&typeof e[r]=="function")).forEach(r=>{t[r]=e[r]}),t}function W_e(e){const{getSlotProps:t,additionalProps:r,externalSlotProps:i,externalForwardedProps:n,className:s}=e;if(!t){const f=ui(r==null?void 0:r.className,s,n==null?void 0:n.className,i==null?void 0:i.className),p=ae({},r==null?void 0:r.style,n==null?void 0:n.style,i==null?void 0:i.style),m=ae({},r,n,i);return f.length>0&&(m.className=f),Object.keys(p).length>0&&(m.style=p),{props:m,internalRef:void 0}}const a=pee(ae({},n,i)),o=x$(i),l=x$(n),c=t(a),d=ui(c==null?void 0:c.className,r==null?void 0:r.className,s,n==null?void 0:n.className,i==null?void 0:i.className),u=ae({},c==null?void 0:c.style,r==null?void 0:r.style,n==null?void 0:n.style,i==null?void 0:i.style),h=ae({},c,r,l,o);return d.length>0&&(h.className=d),Object.keys(u).length>0&&(h.style=u),{props:h,internalRef:c.ref}}const G_e=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Fv(e){var t;const{elementType:r,externalSlotProps:i,ownerState:n,skipResolvingSlotProps:s=!1}=e,a=ar(e,G_e),o=s?{}:H_e(i,n),{props:l,internalRef:c}=W_e(ae({},a,{externalSlotProps:o})),d=ol(c,o==null?void 0:o.ref,(t=e.additionalProps)==null?void 0:t.ref);return $_e(r,ae({},l,{ref:d}),n)}const q_e=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function X_e(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:t}function Y_e(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const t=i=>e.ownerDocument.querySelector(`input[type="radio"]${i}`);let r=t(`[name="${e.name}"]:checked`);return r||(r=t(`[name="${e.name}"]`)),r!==e}function K_e(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||Y_e(e))}function Q_e(e){const t=[],r=[];return Array.from(e.querySelectorAll(q_e)).forEach((i,n)=>{const s=X_e(i);s===-1||!K_e(i)||(s===0?t.push(i):r.push({documentOrder:n,tabIndex:s,node:i}))}),r.sort((i,n)=>i.tabIndex===n.tabIndex?i.documentOrder-n.documentOrder:i.tabIndex-n.tabIndex).map(i=>i.node).concat(t)}function Z_e(){return!0}function J_e(e){const{children:t,disableAutoFocus:r=!1,disableEnforceFocus:i=!1,disableRestoreFocus:n=!1,getTabbable:s=Q_e,isEnabled:a=Z_e,open:o}=e,l=_.useRef(!1),c=_.useRef(null),d=_.useRef(null),u=_.useRef(null),h=_.useRef(null),f=_.useRef(!1),p=_.useRef(null),m=ol(t.ref,p),g=_.useRef(null);_.useEffect(()=>{!o||!p.current||(f.current=!r)},[r,o]),_.useEffect(()=>{if(!o||!p.current)return;const b=bo(p.current);return p.current.contains(b.activeElement)||(p.current.hasAttribute("tabIndex")||p.current.setAttribute("tabIndex","-1"),f.current&&p.current.focus()),()=>{n||(u.current&&u.current.focus&&(l.current=!0,u.current.focus()),u.current=null)}},[o]),_.useEffect(()=>{if(!o||!p.current)return;const b=bo(p.current),x=E=>{g.current=E,!(i||!a()||E.key!=="Tab")&&b.activeElement===p.current&&E.shiftKey&&(l.current=!0,d.current&&d.current.focus())},S=()=>{const E=p.current;if(E===null)return;if(!b.hasFocus()||!a()||l.current){l.current=!1;return}if(E.contains(b.activeElement)||i&&b.activeElement!==c.current&&b.activeElement!==d.current)return;if(b.activeElement!==h.current)h.current=null;else if(h.current!==null)return;if(!f.current)return;let C=[];if((b.activeElement===c.current||b.activeElement===d.current)&&(C=s(p.current)),C.length>0){var T,A;const M=!!((T=g.current)!=null&&T.shiftKey&&((A=g.current)==null?void 0:A.key)==="Tab"),P=C[0],I=C[C.length-1];typeof P!="string"&&typeof I!="string"&&(M?I.focus():P.focus())}else E.focus()};b.addEventListener("focusin",S),b.addEventListener("keydown",x,!0);const w=setInterval(()=>{b.activeElement&&b.activeElement.tagName==="BODY"&&S()},50);return()=>{clearInterval(w),b.removeEventListener("focusin",S),b.removeEventListener("keydown",x,!0)}},[r,i,n,a,o,s]);const v=b=>{u.current===null&&(u.current=b.relatedTarget),f.current=!0,h.current=b.target;const x=t.props.onFocus;x&&x(b)},y=b=>{u.current===null&&(u.current=b.relatedTarget),f.current=!0};return G.jsxs(_.Fragment,{children:[G.jsx("div",{tabIndex:o?0:-1,onFocus:y,ref:c,"data-testid":"sentinelStart"}),_.cloneElement(t,{ref:m,onFocus:v}),G.jsx("div",{tabIndex:o?0:-1,onFocus:y,ref:d,"data-testid":"sentinelEnd"})]})}function eSe(e){return typeof e=="function"?e():e}const tSe=_.forwardRef(function(t,r){const{children:i,container:n,disablePortal:s=!1}=t,[a,o]=_.useState(null),l=ol(_.isValidElement(i)?i.ref:null,r);if(Pp(()=>{s||o(eSe(n)||document.body)},[n,s]),Pp(()=>{if(a&&!s)return C3(r,a),()=>{C3(r,null)}},[r,a,s]),s){if(_.isValidElement(i)){const c={ref:l};return _.cloneElement(i,c)}return G.jsx(_.Fragment,{children:i})}return G.jsx(_.Fragment,{children:a&&Vl.createPortal(i,a)})});function rSe(e){const t=bo(e);return t.body===e?Mp(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function F1(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function w$(e){return parseInt(Mp(e).getComputedStyle(e).paddingRight,10)||0}function iSe(e){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName)!==-1,i=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return r||i}function _$(e,t,r,i,n){const s=[t,r,...i];[].forEach.call(e.children,a=>{const o=s.indexOf(a)===-1,l=!iSe(a);o&&l&&F1(a,n)})}function iI(e,t){let r=-1;return e.some((i,n)=>t(i)?(r=n,!0):!1),r}function nSe(e,t){const r=[],i=e.container;if(!t.disableScrollLock){if(rSe(i)){const a=ree(bo(i));r.push({value:i.style.paddingRight,property:"padding-right",el:i}),i.style.paddingRight=`${w$(i)+a}px`;const o=bo(i).querySelectorAll(".mui-fixed");[].forEach.call(o,l=>{r.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${w$(l)+a}px`})}let s;if(i.parentNode instanceof DocumentFragment)s=bo(i).body;else{const a=i.parentElement,o=Mp(i);s=(a==null?void 0:a.nodeName)==="HTML"&&o.getComputedStyle(a).overflowY==="scroll"?a:i}r.push({value:s.style.overflow,property:"overflow",el:s},{value:s.style.overflowX,property:"overflow-x",el:s},{value:s.style.overflowY,property:"overflow-y",el:s}),s.style.overflow="hidden"}return()=>{r.forEach(({value:s,el:a,property:o})=>{s?a.style.setProperty(o,s):a.style.removeProperty(o)})}}function sSe(e){const t=[];return[].forEach.call(e.children,r=>{r.getAttribute("aria-hidden")==="true"&&t.push(r)}),t}class aSe{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(t,r){let i=this.modals.indexOf(t);if(i!==-1)return i;i=this.modals.length,this.modals.push(t),t.modalRef&&F1(t.modalRef,!1);const n=sSe(r);_$(r,t.mount,t.modalRef,n,!0);const s=iI(this.containers,a=>a.container===r);return s!==-1?(this.containers[s].modals.push(t),i):(this.containers.push({modals:[t],container:r,restore:null,hiddenSiblings:n}),i)}mount(t,r){const i=iI(this.containers,s=>s.modals.indexOf(t)!==-1),n=this.containers[i];n.restore||(n.restore=nSe(n,r))}remove(t,r=!0){const i=this.modals.indexOf(t);if(i===-1)return i;const n=iI(this.containers,a=>a.modals.indexOf(t)!==-1),s=this.containers[n];if(s.modals.splice(s.modals.indexOf(t),1),this.modals.splice(i,1),s.modals.length===0)s.restore&&s.restore(),t.modalRef&&F1(t.modalRef,r),_$(s.container,t.mount,t.modalRef,s.hiddenSiblings,!1),this.containers.splice(n,1);else{const a=s.modals[s.modals.length-1];a.modalRef&&F1(a.modalRef,!1)}return i}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}function oSe(e){return typeof e=="function"?e():e}function lSe(e){return e?e.props.hasOwnProperty("in"):!1}const cSe=new aSe;function uSe(e){const{container:t,disableEscapeKeyDown:r=!1,disableScrollLock:i=!1,manager:n=cSe,closeAfterTransition:s=!1,onTransitionEnter:a,onTransitionExited:o,children:l,onClose:c,open:d,rootRef:u}=e,h=_.useRef({}),f=_.useRef(null),p=_.useRef(null),m=ol(p,u),[g,v]=_.useState(!d),y=lSe(l);let b=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(b=!1);const x=()=>bo(f.current),S=()=>(h.current.modalRef=p.current,h.current.mount=f.current,h.current),w=()=>{n.mount(S(),{disableScrollLock:i}),p.current&&(p.current.scrollTop=0)},E=i$(()=>{const k=oSe(t)||x().body;n.add(S(),k),p.current&&w()}),C=_.useCallback(()=>n.isTopModal(S()),[n]),T=i$(k=>{f.current=k,k&&(d&&C()?w():p.current&&F1(p.current,b))}),A=_.useCallback(()=>{n.remove(S(),b)},[b,n]);_.useEffect(()=>()=>{A()},[A]),_.useEffect(()=>{d?E():(!y||!s)&&A()},[d,A,y,s,E]);const M=k=>O=>{var D;(D=k.onKeyDown)==null||D.call(k,O),!(O.key!=="Escape"||O.which===229||!C())&&(r||(O.stopPropagation(),c&&c(O,"escapeKeyDown")))},P=k=>O=>{var D;(D=k.onClick)==null||D.call(k,O),O.target===O.currentTarget&&c&&c(O,"backdropClick")};return{getRootProps:(k={})=>{const O=pee(e);delete O.onTransitionEnter,delete O.onTransitionExited;const D=ae({},O,k);return ae({role:"presentation"},D,{onKeyDown:M(D),ref:m})},getBackdropProps:(k={})=>{const O=k;return ae({"aria-hidden":!0},O,{onClick:P(O),open:d})},getTransitionProps:()=>{const k=()=>{v(!1),a&&a()},O=()=>{v(!0),o&&o(),s&&A()};return{onEnter:JU(k,l==null?void 0:l.props.onEnter),onExited:JU(O,l==null?void 0:l.props.onExited)}},rootRef:m,portalRef:T,isTopModal:C,exited:g,hasTransition:y}}const dSe=["onChange","maxRows","minRows","style","value"];function o_(e){return parseInt(e,10)||0}const hSe={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function S$(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflow}const fSe=_.forwardRef(function(t,r){const{onChange:i,maxRows:n,minRows:s=1,style:a,value:o}=t,l=ar(t,dSe),{current:c}=_.useRef(o!=null),d=_.useRef(null),u=ol(r,d),h=_.useRef(null),f=_.useRef(0),[p,m]=_.useState({outerHeightStyle:0}),g=_.useCallback(()=>{const x=d.current,w=Mp(x).getComputedStyle(x);if(w.width==="0px")return{outerHeightStyle:0};const E=h.current;E.style.width=w.width,E.value=x.value||t.placeholder||"x",E.value.slice(-1)===`
`&&(E.value+=" ");const C=w.boxSizing,T=o_(w.paddingBottom)+o_(w.paddingTop),A=o_(w.borderBottomWidth)+o_(w.borderTopWidth),M=E.scrollHeight;E.value="x";const P=E.scrollHeight;let I=M;s&&(I=Math.max(Number(s)*P,I)),n&&(I=Math.min(Number(n)*P,I)),I=Math.max(I,P);const R=I+(C==="border-box"?T+A:0),N=Math.abs(I-M)<=1;return{outerHeightStyle:R,overflow:N}},[n,s,t.placeholder]),v=(x,S)=>{const{outerHeightStyle:w,overflow:E}=S;return f.current<20&&(w>0&&Math.abs((x.outerHeightStyle||0)-w)>1||x.overflow!==E)?(f.current+=1,{overflow:E,outerHeightStyle:w}):x},y=_.useCallback(()=>{const x=g();S$(x)||m(S=>v(S,x))},[g]);Pp(()=>{const x=()=>{const M=g();S$(M)||Vl.flushSync(()=>{m(P=>v(P,M))})},S=()=>{f.current=0,x()};let w;const E=tee(S),C=d.current,T=Mp(C);T.addEventListener("resize",E);let A;return typeof ResizeObserver<"u"&&(A=new ResizeObserver(S),A.observe(C)),()=>{E.clear(),cancelAnimationFrame(w),T.removeEventListener("resize",E),A&&A.disconnect()}},[g]),Pp(()=>{y()}),_.useEffect(()=>{f.current=0},[o]);const b=x=>{f.current=0,c||y(),i&&i(x)};return G.jsxs(_.Fragment,{children:[G.jsx("textarea",ae({value:o,onChange:b,ref:u,rows:s,style:ae({height:p.outerHeightStyle,overflow:p.overflow?"hidden":void 0},a)},l)),G.jsx("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:h,tabIndex:-1,style:ae({},hSe.shadow,a,{paddingTop:0,paddingBottom:0})})]})});function S0({props:e,states:t,muiFormControl:r}){return t.reduce((i,n)=>(i[n]=e[n],r&&typeof e[n]>"u"&&(i[n]=r[n]),i),{})}const pSe=_.createContext(void 0),sF=pSe;function E0(){return _.useContext(sF)}function mSe(e){return G.jsx(Twe,ae({},e,{defaultTheme:Z2,themeId:x2}))}function E$(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function FC(e,t=!1){return e&&(E$(e.value)&&e.value!==""||t&&E$(e.defaultValue)&&e.defaultValue!=="")}function gSe(e){return e.startAdornment}function vSe(e){return Pi("MuiInputBase",e)}const ySe=Fi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),jv=ySe,bSe=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],eM=(e,t)=>{const{ownerState:r}=e;return[t.root,r.formControl&&t.formControl,r.startAdornment&&t.adornedStart,r.endAdornment&&t.adornedEnd,r.error&&t.error,r.size==="small"&&t.sizeSmall,r.multiline&&t.multiline,r.color&&t[`color${Xr(r.color)}`],r.fullWidth&&t.fullWidth,r.hiddenLabel&&t.hiddenLabel]},tM=(e,t)=>{const{ownerState:r}=e;return[t.input,r.size==="small"&&t.inputSizeSmall,r.multiline&&t.inputMultiline,r.type==="search"&&t.inputTypeSearch,r.startAdornment&&t.inputAdornedStart,r.endAdornment&&t.inputAdornedEnd,r.hiddenLabel&&t.inputHiddenLabel]},xSe=e=>{const{classes:t,color:r,disabled:i,error:n,endAdornment:s,focused:a,formControl:o,fullWidth:l,hiddenLabel:c,multiline:d,readOnly:u,size:h,startAdornment:f,type:p}=e,m={root:["root",`color${Xr(r)}`,i&&"disabled",n&&"error",l&&"fullWidth",a&&"focused",o&&"formControl",h&&h!=="medium"&&`size${Xr(h)}`,d&&"multiline",f&&"adornedStart",s&&"adornedEnd",c&&"hiddenLabel",u&&"readOnly"],input:["input",i&&"disabled",p==="search"&&"inputTypeSearch",d&&"inputMultiline",h==="small"&&"inputSizeSmall",c&&"inputHiddenLabel",f&&"inputAdornedStart",s&&"inputAdornedEnd",u&&"readOnly"]};return Bi(m,vSe,t)},rM=fr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:eM})(({theme:e,ownerState:t})=>ae({},e.typography.body1,{color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${jv.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"}},t.multiline&&ae({padding:"4px 0 5px"},t.size==="small"&&{paddingTop:1}),t.fullWidth&&{width:"100%"})),iM=fr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:tM})(({theme:e,ownerState:t})=>{const r=e.palette.mode==="light",i=ae({color:"currentColor"},e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})}),n={opacity:"0 !important"},s=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return ae({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${jv.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&:-ms-input-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus:-ms-input-placeholder":s,"&:focus::-ms-input-placeholder":s},[`&.${jv.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},t.size==="small"&&{paddingTop:1},t.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},t.type==="search"&&{MozAppearance:"textfield"})}),wSe=G.jsx(mSe,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),_Se=_.forwardRef(function(t,r){var i;const n=Ji({props:t,name:"MuiInputBase"}),{"aria-describedby":s,autoComplete:a,autoFocus:o,className:l,components:c={},componentsProps:d={},defaultValue:u,disabled:h,disableInjectingGlobalStyles:f,endAdornment:p,fullWidth:m=!1,id:g,inputComponent:v="input",inputProps:y={},inputRef:b,maxRows:x,minRows:S,multiline:w=!1,name:E,onBlur:C,onChange:T,onClick:A,onFocus:M,onKeyDown:P,onKeyUp:I,placeholder:R,readOnly:N,renderSuffix:k,rows:O,slotProps:D={},slots:B={},startAdornment:z,type:F="text",value:V}=n,Y=ar(n,bSe),W=y.value!=null?y.value:V,{current:X}=_.useRef(W!=null),H=_.useRef(),ie=_.useCallback(ze=>{},[]),Q=ol(H,b,y.ref,ie),[Z,ee]=_.useState(!1),re=E0(),ne=S0({props:n,muiFormControl:re,states:["color","disabled","error","hiddenLabel","size","required","filled"]});ne.focused=re?re.focused:Z,_.useEffect(()=>{!re&&h&&Z&&(ee(!1),C&&C())},[re,h,Z,C]);const se=re&&re.onFilled,fe=re&&re.onEmpty,me=_.useCallback(ze=>{FC(ze)?se&&se():fe&&fe()},[se,fe]);Pp(()=>{X&&me({value:W})},[W,me,X]);const Oe=ze=>{if(ne.disabled){ze.stopPropagation();return}M&&M(ze),y.onFocus&&y.onFocus(ze),re&&re.onFocus?re.onFocus(ze):ee(!0)},Ee=ze=>{C&&C(ze),y.onBlur&&y.onBlur(ze),re&&re.onBlur?re.onBlur(ze):ee(!1)},Se=(ze,...Ve)=>{if(!X){const pe=ze.target||H.current;if(pe==null)throw new Error(Fh(1));me({value:pe.value})}y.onChange&&y.onChange(ze,...Ve),T&&T(ze,...Ve)};_.useEffect(()=>{me(H.current)},[]);const de=ze=>{H.current&&ze.currentTarget===ze.target&&H.current.focus(),A&&A(ze)};let be=v,ye=y;w&&be==="input"&&(O?ye=ae({type:void 0,minRows:O,maxRows:O},ye):ye=ae({type:void 0,maxRows:x,minRows:S},ye),be=fSe);const q=ze=>{me(ze.animationName==="mui-auto-fill-cancel"?H.current:{value:"x"})};_.useEffect(()=>{re&&re.setAdornedStart(!!z)},[re,z]);const U=ae({},n,{color:ne.color||"primary",disabled:ne.disabled,endAdornment:p,error:ne.error,focused:ne.focused,formControl:re,fullWidth:m,hiddenLabel:ne.hiddenLabel,multiline:w,size:ne.size,startAdornment:z,type:F}),ce=xSe(U),xe=B.root||c.Root||rM,j=D.root||d.root||{},Be=B.input||c.Input||iM;return ye=ae({},ye,(i=D.input)!=null?i:d.input),G.jsxs(_.Fragment,{children:[!f&&wSe,G.jsxs(xe,ae({},j,!BC(xe)&&{ownerState:ae({},U,j.ownerState)},{ref:r,onClick:de},Y,{className:ui(ce.root,j.className,l,N&&"MuiInputBase-readOnly"),children:[z,G.jsx(sF.Provider,{value:null,children:G.jsx(Be,ae({ownerState:U,"aria-invalid":ne.error,"aria-describedby":s,autoComplete:a,autoFocus:o,defaultValue:u,disabled:ne.disabled,id:g,onAnimationStart:q,name:E,placeholder:R,readOnly:N,required:ne.required,rows:O,value:W,onKeyDown:P,onKeyUp:I,type:F},ye,!BC(Be)&&{as:be,ownerState:ae({},U,ye.ownerState)},{ref:Q,className:ui(ce.input,ye.className,N&&"MuiInputBase-readOnly"),onBlur:Ee,onChange:Se,onFocus:Oe}))}),p,k?k(ae({},ne,{startAdornment:z})):null]}))]})}),aF=_Se;function SSe(e){return Pi("MuiInput",e)}const ESe=ae({},jv,Fi("MuiInput",["root","underline","input"])),dy=ESe;function CSe(e){return Pi("MuiOutlinedInput",e)}const ASe=ae({},jv,Fi("MuiOutlinedInput",["root","notchedOutline","input"])),Sd=ASe;function TSe(e){return Pi("MuiFilledInput",e)}const MSe=ae({},jv,Fi("MuiFilledInput",["root","underline","input"])),af=MSe,PSe=iF(G.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),ISe=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],RSe={entering:{opacity:1},entered:{opacity:1}},DSe=_.forwardRef(function(t,r){const i=J2(),n={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{addEndListener:s,appear:a=!0,children:o,easing:l,in:c,onEnter:d,onEntered:u,onEntering:h,onExit:f,onExited:p,onExiting:m,style:g,timeout:v=n,TransitionComponent:y=dee}=t,b=ar(t,ISe),x=_.useRef(null),S=ol(x,o.ref,r),w=R=>N=>{if(R){const k=x.current;N===void 0?R(k):R(k,N)}},E=w(h),C=w((R,N)=>{hee(R);const k=zC({style:g,timeout:v,easing:l},{mode:"enter"});R.style.webkitTransition=i.transitions.create("opacity",k),R.style.transition=i.transitions.create("opacity",k),d&&d(R,N)}),T=w(u),A=w(m),M=w(R=>{const N=zC({style:g,timeout:v,easing:l},{mode:"exit"});R.style.webkitTransition=i.transitions.create("opacity",N),R.style.transition=i.transitions.create("opacity",N),f&&f(R)}),P=w(p),I=R=>{s&&s(x.current,R)};return G.jsx(y,ae({appear:a,in:c,nodeRef:x,onEnter:C,onEntered:T,onEntering:E,onExit:M,onExited:P,onExiting:A,addEndListener:I,timeout:v},b,{children:(R,N)=>_.cloneElement(o,ae({style:ae({opacity:0,visibility:R==="exited"&&!c?"hidden":void 0},RSe[R],g,o.props.style),ref:S},N))}))}),mee=DSe;function OSe(e){return Pi("MuiBackdrop",e)}Fi("MuiBackdrop",["root","invisible"]);const LSe=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],NSe=e=>{const{classes:t,invisible:r}=e;return Bi({root:["root",r&&"invisible"]},OSe,t)},kSe=fr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.invisible&&t.invisible]}})(({ownerState:e})=>ae({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"})),zSe=_.forwardRef(function(t,r){var i,n,s;const a=Ji({props:t,name:"MuiBackdrop"}),{children:o,className:l,component:c="div",components:d={},componentsProps:u={},invisible:h=!1,open:f,slotProps:p={},slots:m={},TransitionComponent:g=mee,transitionDuration:v}=a,y=ar(a,LSe),b=ae({},a,{component:c,invisible:h}),x=NSe(b),S=(i=p.root)!=null?i:u.root;return G.jsx(g,ae({in:f,timeout:v},y,{children:G.jsx(kSe,ae({"aria-hidden":!0},S,{as:(n=(s=m.root)!=null?s:d.Root)!=null?n:c,className:ui(x.root,l,S==null?void 0:S.className),ownerState:ae({},b,S==null?void 0:S.ownerState),classes:x,ref:r,children:o}))}))}),gee=zSe;function BSe(e){return Pi("MuiModal",e)}Fi("MuiModal",["root","hidden","backdrop"]);const FSe=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],jSe=e=>{const{open:t,exited:r,classes:i}=e;return Bi({root:["root",!t&&r&&"hidden"],backdrop:["backdrop"]},BSe,i)},VSe=fr("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.open&&r.exited&&t.hidden]}})(({theme:e,ownerState:t})=>ae({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&t.exited&&{visibility:"hidden"})),USe=fr(gee,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),$Se=_.forwardRef(function(t,r){var i,n,s,a,o,l;const c=Ji({name:"MuiModal",props:t}),{BackdropComponent:d=USe,BackdropProps:u,className:h,closeAfterTransition:f=!1,children:p,container:m,component:g,components:v={},componentsProps:y={},disableAutoFocus:b=!1,disableEnforceFocus:x=!1,disableEscapeKeyDown:S=!1,disablePortal:w=!1,disableRestoreFocus:E=!1,disableScrollLock:C=!1,hideBackdrop:T=!1,keepMounted:A=!1,onBackdropClick:M,open:P,slotProps:I,slots:R}=c,N=ar(c,FSe),k=ae({},c,{closeAfterTransition:f,disableAutoFocus:b,disableEnforceFocus:x,disableEscapeKeyDown:S,disablePortal:w,disableRestoreFocus:E,disableScrollLock:C,hideBackdrop:T,keepMounted:A}),{getRootProps:O,getBackdropProps:D,getTransitionProps:B,portalRef:z,isTopModal:F,exited:V,hasTransition:Y}=uSe(ae({},k,{rootRef:r})),W=ae({},k,{exited:V}),X=jSe(W),H={};if(p.props.tabIndex===void 0&&(H.tabIndex="-1"),Y){const{onEnter:se,onExited:fe}=B();H.onEnter=se,H.onExited=fe}const ie=(i=(n=R==null?void 0:R.root)!=null?n:v.Root)!=null?i:VSe,Q=(s=(a=R==null?void 0:R.backdrop)!=null?a:v.Backdrop)!=null?s:d,Z=(o=I==null?void 0:I.root)!=null?o:y.root,ee=(l=I==null?void 0:I.backdrop)!=null?l:y.backdrop,re=Fv({elementType:ie,externalSlotProps:Z,externalForwardedProps:N,getSlotProps:O,additionalProps:{ref:r,as:g},ownerState:W,className:ui(h,Z==null?void 0:Z.className,X==null?void 0:X.root,!W.open&&W.exited&&(X==null?void 0:X.hidden))}),ne=Fv({elementType:Q,externalSlotProps:ee,additionalProps:u,getSlotProps:se=>D(ae({},se,{onClick:fe=>{M&&M(fe),se!=null&&se.onClick&&se.onClick(fe)}})),className:ui(ee==null?void 0:ee.className,u==null?void 0:u.className,X==null?void 0:X.backdrop),ownerState:W});return!A&&!P&&(!Y||V)?null:G.jsx(tSe,{ref:z,container:m,disablePortal:w,children:G.jsxs(ie,ae({},re,{children:[!T&&d?G.jsx(Q,ae({},ne)):null,G.jsx(J_e,{disableEnforceFocus:x,disableAutoFocus:b,disableRestoreFocus:E,isEnabled:F,open:P,children:_.cloneElement(p,H)})]}))})}),vee=$Se;function HSe(e){return Pi("MuiDialog",e)}const WSe=Fi("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),nI=WSe,GSe=_.createContext({}),yee=GSe,qSe=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],XSe=fr(gee,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),YSe=e=>{const{classes:t,scroll:r,maxWidth:i,fullWidth:n,fullScreen:s}=e,a={root:["root"],container:["container",`scroll${Xr(r)}`],paper:["paper",`paperScroll${Xr(r)}`,`paperWidth${Xr(String(i))}`,n&&"paperFullWidth",s&&"paperFullScreen"]};return Bi(a,HSe,t)},KSe=fr(vee,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),QSe=fr("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.container,t[`scroll${Xr(r.scroll)}`]]}})(({ownerState:e})=>ae({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),ZSe=fr(nF,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.paper,t[`scrollPaper${Xr(r.scroll)}`],t[`paperWidth${Xr(String(r.maxWidth))}`],r.fullWidth&&t.paperFullWidth,r.fullScreen&&t.paperFullScreen]}})(({theme:e,ownerState:t})=>ae({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},t.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},t.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!t.maxWidth&&{maxWidth:"calc(100% - 64px)"},t.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${nI.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},t.maxWidth&&t.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`,[`&.${nI.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},t.fullWidth&&{width:"calc(100% - 64px)"},t.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${nI.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),JSe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiDialog"}),n=J2(),s={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{"aria-describedby":a,"aria-labelledby":o,BackdropComponent:l,BackdropProps:c,children:d,className:u,disableEscapeKeyDown:h=!1,fullScreen:f=!1,fullWidth:p=!1,maxWidth:m="sm",onBackdropClick:g,onClose:v,open:y,PaperComponent:b=nF,PaperProps:x={},scroll:S="paper",TransitionComponent:w=mee,transitionDuration:E=s,TransitionProps:C}=i,T=ar(i,qSe),A=ae({},i,{disableEscapeKeyDown:h,fullScreen:f,fullWidth:p,maxWidth:m,scroll:S}),M=YSe(A),P=_.useRef(),I=O=>{P.current=O.target===O.currentTarget},R=O=>{P.current&&(P.current=null,g&&g(O),v&&v(O,"backdropClick"))},N=XB(o),k=_.useMemo(()=>({titleId:N}),[N]);return G.jsx(KSe,ae({className:ui(M.root,u),closeAfterTransition:!0,components:{Backdrop:XSe},componentsProps:{backdrop:ae({transitionDuration:E,as:l},c)},disableEscapeKeyDown:h,onClose:v,open:y,ref:r,onClick:R,ownerState:A},T,{children:G.jsx(w,ae({appear:!0,in:y,timeout:E,role:"presentation"},C,{children:G.jsx(QSe,{className:ui(M.container),onMouseDown:I,ownerState:A,children:G.jsx(ZSe,ae({as:b,elevation:24,role:"dialog","aria-describedby":a,"aria-labelledby":N},x,{className:ui(M.paper,x.className),ownerState:A,children:G.jsx(yee.Provider,{value:k,children:d})}))})}))}))}),oF=JSe;function eEe(e){return Pi("MuiDialogContent",e)}Fi("MuiDialogContent",["root","dividers"]);function tEe(e){return Pi("MuiDialogTitle",e)}const rEe=Fi("MuiDialogTitle",["root"]),iEe=rEe,nEe=["className","dividers"],sEe=e=>{const{classes:t,dividers:r}=e;return Bi({root:["root",r&&"dividers"]},eEe,t)},aEe=fr("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>ae({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${iEe.root} + &`]:{paddingTop:0}})),oEe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiDialogContent"}),{className:n,dividers:s=!1}=i,a=ar(i,nEe),o=ae({},i,{dividers:s}),l=sEe(o);return G.jsx(aEe,ae({className:ui(l.root,n),ownerState:o,ref:r},a))}),lF=oEe;function lEe(e){return Pi("MuiDialogContentText",e)}Fi("MuiDialogContentText",["root"]);const cEe=["children","className"],uEe=e=>{const{classes:t}=e,i=Bi({root:["root"]},lEe,t);return ae({},t,i)},dEe=fr(fee,{shouldForwardProp:e=>Jl(e)||e==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),hEe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiDialogContentText"}),{className:n}=i,s=ar(i,cEe),a=uEe(s);return G.jsx(dEe,ae({component:"p",variant:"body1",color:"text.secondary",ref:r,ownerState:s,className:ui(a.root,n)},i,{classes:a}))}),fEe=hEe,pEe=["className","id"],mEe=e=>{const{classes:t}=e;return Bi({root:["root"]},tEe,t)},gEe=fr(fee,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),vEe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiDialogTitle"}),{className:n,id:s}=i,a=ar(i,pEe),o=i,l=mEe(o),{titleId:c=s}=_.useContext(yee);return G.jsx(gEe,ae({component:"h2",className:ui(l.root,n),ownerState:o,ref:r,variant:"h6",id:s??c},a))}),cF=vEe,yEe=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],bEe=e=>{const{classes:t,disableUnderline:r}=e,n=Bi({root:["root",!r&&"underline"],input:["input"]},TSe,t);return ae({},t,n)},xEe=fr(rM,{shouldForwardProp:e=>Jl(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[...eM(e,t),!r.disableUnderline&&t.underline]}})(({theme:e,ownerState:t})=>{var r;const i=e.palette.mode==="light",n=i?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",s=i?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",a=i?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",o=i?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return ae({position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:a,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s}},[`&.${af.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:s},[`&.${af.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:o}},!t.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(r=(e.vars||e).palette[t.color||"primary"])==null?void 0:r.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${af.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${af.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${af.disabled}, .${af.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${af.disabled}:before`]:{borderBottomStyle:"dotted"}},t.startAdornment&&{paddingLeft:12},t.endAdornment&&{paddingRight:12},t.multiline&&ae({padding:"25px 12px 8px"},t.size==="small"&&{paddingTop:21,paddingBottom:4},t.hiddenLabel&&{paddingTop:16,paddingBottom:17},t.hiddenLabel&&t.size==="small"&&{paddingTop:8,paddingBottom:9}))}),wEe=fr(iM,{name:"MuiFilledInput",slot:"Input",overridesResolver:tM})(({theme:e,ownerState:t})=>ae({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},t.size==="small"&&{paddingTop:21,paddingBottom:4},t.hiddenLabel&&{paddingTop:16,paddingBottom:17},t.startAdornment&&{paddingLeft:0},t.endAdornment&&{paddingRight:0},t.hiddenLabel&&t.size==="small"&&{paddingTop:8,paddingBottom:9},t.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),bee=_.forwardRef(function(t,r){var i,n,s,a;const o=Ji({props:t,name:"MuiFilledInput"}),{components:l={},componentsProps:c,fullWidth:d=!1,inputComponent:u="input",multiline:h=!1,slotProps:f,slots:p={},type:m="text"}=o,g=ar(o,yEe),v=ae({},o,{fullWidth:d,inputComponent:u,multiline:h,type:m}),y=bEe(o),b={root:{ownerState:v},input:{ownerState:v}},x=f??c?Ya(b,f??c):b,S=(i=(n=p.root)!=null?n:l.Root)!=null?i:xEe,w=(s=(a=p.input)!=null?a:l.Input)!=null?s:wEe;return G.jsx(aF,ae({slots:{root:S,input:w},componentsProps:x,fullWidth:d,inputComponent:u,multiline:h,ref:r,type:m},g,{classes:y}))});bee.muiName="Input";const xee=bee;function _Ee(e){return Pi("MuiFormControl",e)}Fi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const SEe=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],EEe=e=>{const{classes:t,margin:r,fullWidth:i}=e,n={root:["root",r!=="none"&&`margin${Xr(r)}`,i&&"fullWidth"]};return Bi(n,_Ee,t)},CEe=fr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:e},t)=>ae({},t.root,t[`margin${Xr(e.margin)}`],e.fullWidth&&t.fullWidth)})(({ownerState:e})=>ae({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},e.margin==="normal"&&{marginTop:16,marginBottom:8},e.margin==="dense"&&{marginTop:8,marginBottom:4},e.fullWidth&&{width:"100%"})),AEe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiFormControl"}),{children:n,className:s,color:a="primary",component:o="div",disabled:l=!1,error:c=!1,focused:d,fullWidth:u=!1,hiddenLabel:h=!1,margin:f="none",required:p=!1,size:m="medium",variant:g="outlined"}=i,v=ar(i,SEe),y=ae({},i,{color:a,component:o,disabled:l,error:c,fullWidth:u,hiddenLabel:h,margin:f,required:p,size:m,variant:g}),b=EEe(y),[x,S]=_.useState(()=>{let I=!1;return n&&_.Children.forEach(n,R=>{if(!tI(R,["Input","Select"]))return;const N=tI(R,["Select"])?R.props.input:R;N&&gSe(N.props)&&(I=!0)}),I}),[w,E]=_.useState(()=>{let I=!1;return n&&_.Children.forEach(n,R=>{tI(R,["Input","Select"])&&(FC(R.props,!0)||FC(R.props.inputProps,!0))&&(I=!0)}),I}),[C,T]=_.useState(!1);l&&C&&T(!1);const A=d!==void 0&&!l?d:C;let M;const P=_.useMemo(()=>({adornedStart:x,setAdornedStart:S,color:a,disabled:l,error:c,filled:w,focused:A,fullWidth:u,hiddenLabel:h,size:m,onBlur:()=>{T(!1)},onEmpty:()=>{E(!1)},onFilled:()=>{E(!0)},onFocus:()=>{T(!0)},registerEffect:M,required:p,variant:g}),[x,a,l,c,w,A,u,h,M,p,m,g]);return G.jsx(sF.Provider,{value:P,children:G.jsx(CEe,ae({as:o,ownerState:y,className:ui(b.root,s),ref:r},v,{children:n}))})}),TEe=AEe;function MEe(e){return Pi("MuiFormHelperText",e)}const PEe=Fi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),C$=PEe;var A$;const IEe=["children","className","component","disabled","error","filled","focused","margin","required","variant"],REe=e=>{const{classes:t,contained:r,size:i,disabled:n,error:s,filled:a,focused:o,required:l}=e,c={root:["root",n&&"disabled",s&&"error",i&&`size${Xr(i)}`,r&&"contained",o&&"focused",a&&"filled",l&&"required"]};return Bi(c,MEe,t)},DEe=fr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.size&&t[`size${Xr(r.size)}`],r.contained&&t.contained,r.filled&&t.filled]}})(({theme:e,ownerState:t})=>ae({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${C$.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${C$.error}`]:{color:(e.vars||e).palette.error.main}},t.size==="small"&&{marginTop:4},t.contained&&{marginLeft:14,marginRight:14})),OEe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiFormHelperText"}),{children:n,className:s,component:a="p"}=i,o=ar(i,IEe),l=E0(),c=S0({props:i,muiFormControl:l,states:["variant","size","disabled","error","filled","focused","required"]}),d=ae({},i,{component:a,contained:c.variant==="filled"||c.variant==="outlined",variant:c.variant,size:c.size,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),u=REe(d);return G.jsx(DEe,ae({as:a,ownerState:d,className:ui(u.root,s),ref:r},o,{children:n===" "?A$||(A$=G.jsx("span",{className:"notranslate",children:"​"})):n}))}),LEe=OEe;function NEe(e){return Pi("MuiFormLabel",e)}const kEe=Fi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),j1=kEe,zEe=["children","className","color","component","disabled","error","filled","focused","required"],BEe=e=>{const{classes:t,color:r,focused:i,disabled:n,error:s,filled:a,required:o}=e,l={root:["root",`color${Xr(r)}`,n&&"disabled",s&&"error",a&&"filled",i&&"focused",o&&"required"],asterisk:["asterisk",s&&"error"]};return Bi(l,NEe,t)},FEe=fr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},t)=>ae({},t.root,e.color==="secondary"&&t.colorSecondary,e.filled&&t.filled)})(({theme:e,ownerState:t})=>ae({color:(e.vars||e).palette.text.secondary},e.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${j1.focused}`]:{color:(e.vars||e).palette[t.color].main},[`&.${j1.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${j1.error}`]:{color:(e.vars||e).palette.error.main}})),jEe=fr("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(({theme:e})=>({[`&.${j1.error}`]:{color:(e.vars||e).palette.error.main}})),VEe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiFormLabel"}),{children:n,className:s,component:a="label"}=i,o=ar(i,zEe),l=E0(),c=S0({props:i,muiFormControl:l,states:["color","required","focused","disabled","error","filled"]}),d=ae({},i,{color:c.color||"primary",component:a,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),u=BEe(d);return G.jsxs(FEe,ae({as:a,ownerState:d,className:ui(u.root,s),ref:r},o,{children:[n,c.required&&G.jsxs(jEe,{ownerState:d,"aria-hidden":!0,className:u.asterisk,children:[" ","*"]})]}))}),UEe=VEe,$Ee=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function T3(e){return`scale(${e}, ${e**2})`}const HEe={entering:{opacity:1,transform:T3(1)},entered:{opacity:1,transform:"none"}},sI=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),wee=_.forwardRef(function(t,r){const{addEndListener:i,appear:n=!0,children:s,easing:a,in:o,onEnter:l,onEntered:c,onEntering:d,onExit:u,onExited:h,onExiting:f,style:p,timeout:m="auto",TransitionComponent:g=dee}=t,v=ar(t,$Ee),y=_.useRef(),b=_.useRef(),x=J2(),S=_.useRef(null),w=ol(S,s.ref,r),E=N=>k=>{if(N){const O=S.current;k===void 0?N(O):N(O,k)}},C=E(d),T=E((N,k)=>{hee(N);const{duration:O,delay:D,easing:B}=zC({style:p,timeout:m,easing:a},{mode:"enter"});let z;m==="auto"?(z=x.transitions.getAutoHeightDuration(N.clientHeight),b.current=z):z=O,N.style.transition=[x.transitions.create("opacity",{duration:z,delay:D}),x.transitions.create("transform",{duration:sI?z:z*.666,delay:D,easing:B})].join(","),l&&l(N,k)}),A=E(c),M=E(f),P=E(N=>{const{duration:k,delay:O,easing:D}=zC({style:p,timeout:m,easing:a},{mode:"exit"});let B;m==="auto"?(B=x.transitions.getAutoHeightDuration(N.clientHeight),b.current=B):B=k,N.style.transition=[x.transitions.create("opacity",{duration:B,delay:O}),x.transitions.create("transform",{duration:sI?B:B*.666,delay:sI?O:O||B*.333,easing:D})].join(","),N.style.opacity=0,N.style.transform=T3(.75),u&&u(N)}),I=E(h),R=N=>{m==="auto"&&(y.current=setTimeout(N,b.current||0)),i&&i(S.current,N)};return _.useEffect(()=>()=>{clearTimeout(y.current)},[]),G.jsx(g,ae({appear:n,in:o,nodeRef:S,onEnter:T,onEntered:A,onEntering:C,onExit:P,onExited:I,onExiting:M,addEndListener:R,timeout:m==="auto"?null:m},v,{children:(N,k)=>_.cloneElement(s,ae({style:ae({opacity:0,transform:T3(.75),visibility:N==="exited"&&!o?"hidden":void 0},HEe[N],p,s.props.style),ref:w},k))}))});wee.muiSupportAuto=!0;const WEe=wee,GEe=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],qEe=e=>{const{classes:t,disableUnderline:r}=e,n=Bi({root:["root",!r&&"underline"],input:["input"]},SSe,t);return ae({},t,n)},XEe=fr(rM,{shouldForwardProp:e=>Jl(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[...eM(e,t),!r.disableUnderline&&t.underline]}})(({theme:e,ownerState:t})=>{let i=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(i=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),ae({position:"relative"},t.formControl&&{"label + &":{marginTop:16}},!t.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[t.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${dy.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${dy.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${i}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${dy.disabled}, .${dy.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${i}`}},[`&.${dy.disabled}:before`]:{borderBottomStyle:"dotted"}})}),YEe=fr(iM,{name:"MuiInput",slot:"Input",overridesResolver:tM})({}),_ee=_.forwardRef(function(t,r){var i,n,s,a;const o=Ji({props:t,name:"MuiInput"}),{disableUnderline:l,components:c={},componentsProps:d,fullWidth:u=!1,inputComponent:h="input",multiline:f=!1,slotProps:p,slots:m={},type:g="text"}=o,v=ar(o,GEe),y=qEe(o),x={root:{ownerState:{disableUnderline:l}}},S=p??d?Ya(p??d,x):x,w=(i=(n=m.root)!=null?n:c.Root)!=null?i:XEe,E=(s=(a=m.input)!=null?a:c.Input)!=null?s:YEe;return G.jsx(aF,ae({slots:{root:w,input:E},slotProps:S,fullWidth:u,inputComponent:h,multiline:f,ref:r,type:g},v,{classes:y}))});_ee.muiName="Input";const See=_ee;function KEe(e){return Pi("MuiInputLabel",e)}Fi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const QEe=["disableAnimation","margin","shrink","variant","className"],ZEe=e=>{const{classes:t,formControl:r,size:i,shrink:n,disableAnimation:s,variant:a,required:o}=e,l={root:["root",r&&"formControl",!s&&"animated",n&&"shrink",i&&i!=="normal"&&`size${Xr(i)}`,a],asterisk:[o&&"asterisk"]},c=Bi(l,KEe,t);return ae({},t,c)},JEe=fr(UEe,{shouldForwardProp:e=>Jl(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${j1.asterisk}`]:t.asterisk},t.root,r.formControl&&t.formControl,r.size==="small"&&t.sizeSmall,r.shrink&&t.shrink,!r.disableAnimation&&t.animated,r.focused&&t.focused,t[r.variant]]}})(({theme:e,ownerState:t})=>ae({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},t.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},t.size==="small"&&{transform:"translate(0, 17px) scale(1)"},t.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!t.disableAnimation&&{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},t.variant==="filled"&&ae({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},t.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},t.shrink&&ae({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},t.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),t.variant==="outlined"&&ae({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},t.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},t.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),eCe=_.forwardRef(function(t,r){const i=Ji({name:"MuiInputLabel",props:t}),{disableAnimation:n=!1,shrink:s,className:a}=i,o=ar(i,QEe),l=E0();let c=s;typeof c>"u"&&l&&(c=l.filled||l.focused||l.adornedStart);const d=S0({props:i,muiFormControl:l,states:["size","variant","required","focused"]}),u=ae({},i,{disableAnimation:n,formControl:l,shrink:c,size:d.size,variant:d.variant,required:d.required,focused:d.focused}),h=ZEe(u);return G.jsx(JEe,ae({"data-shrink":c,ownerState:u,ref:r,className:ui(h.root,a)},o,{classes:h}))}),tCe=eCe,rCe=_.createContext({}),iCe=rCe;function nCe(e){return Pi("MuiList",e)}Fi("MuiList",["root","padding","dense","subheader"]);const sCe=["children","className","component","dense","disablePadding","subheader"],aCe=e=>{const{classes:t,disablePadding:r,dense:i,subheader:n}=e;return Bi({root:["root",!r&&"padding",i&&"dense",n&&"subheader"]},nCe,t)},oCe=fr("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disablePadding&&t.padding,r.dense&&t.dense,r.subheader&&t.subheader]}})(({ownerState:e})=>ae({listStyle:"none",margin:0,padding:0,position:"relative"},!e.disablePadding&&{paddingTop:8,paddingBottom:8},e.subheader&&{paddingTop:0})),lCe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiList"}),{children:n,className:s,component:a="ul",dense:o=!1,disablePadding:l=!1,subheader:c}=i,d=ar(i,sCe),u=_.useMemo(()=>({dense:o}),[o]),h=ae({},i,{component:a,dense:o,disablePadding:l}),f=aCe(h);return G.jsx(iCe.Provider,{value:u,children:G.jsxs(oCe,ae({as:a,className:ui(f.root,s),ref:r,ownerState:h},d,{children:[c,n]}))})}),cCe=lCe,uCe=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function aI(e,t,r){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:r?null:e.firstChild}function T$(e,t,r){return e===t?r?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:r?null:e.lastChild}function Eee(e,t){if(t===void 0)return!0;let r=e.innerText;return r===void 0&&(r=e.textContent),r=r.trim().toLowerCase(),r.length===0?!1:t.repeating?r[0]===t.keys[0]:r.indexOf(t.keys.join(""))===0}function hy(e,t,r,i,n,s){let a=!1,o=n(e,t,t?r:!1);for(;o;){if(o===e.firstChild){if(a)return!1;a=!0}const l=i?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!Eee(o,s)||l)o=n(e,o,r);else return o.focus(),!0}return!1}const dCe=_.forwardRef(function(t,r){const{actions:i,autoFocus:n=!1,autoFocusItem:s=!1,children:a,className:o,disabledItemsFocusable:l=!1,disableListWrap:c=!1,onKeyDown:d,variant:u="selectedMenu"}=t,h=ar(t,uCe),f=_.useRef(null),p=_.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Pp(()=>{n&&f.current.focus()},[n]),_.useImperativeHandle(i,()=>({adjustStyleForScrollbar:(b,x)=>{const S=!f.current.style.width;if(b.clientHeight<f.current.clientHeight&&S){const w=`${ree(bo(b))}px`;f.current.style[x.direction==="rtl"?"paddingLeft":"paddingRight"]=w,f.current.style.width=`calc(100% + ${w})`}return f.current}}),[]);const m=b=>{const x=f.current,S=b.key,w=bo(x).activeElement;if(S==="ArrowDown")b.preventDefault(),hy(x,w,c,l,aI);else if(S==="ArrowUp")b.preventDefault(),hy(x,w,c,l,T$);else if(S==="Home")b.preventDefault(),hy(x,null,c,l,aI);else if(S==="End")b.preventDefault(),hy(x,null,c,l,T$);else if(S.length===1){const E=p.current,C=S.toLowerCase(),T=performance.now();E.keys.length>0&&(T-E.lastTime>500?(E.keys=[],E.repeating=!0,E.previousKeyMatched=!0):E.repeating&&C!==E.keys[0]&&(E.repeating=!1)),E.lastTime=T,E.keys.push(C);const A=w&&!E.repeating&&Eee(w,E);E.previousKeyMatched&&(A||hy(x,w,!1,l,aI,E))?b.preventDefault():E.previousKeyMatched=!1}d&&d(b)},g=ol(f,r);let v=-1;_.Children.forEach(a,(b,x)=>{if(!_.isValidElement(b)){v===x&&(v+=1,v>=a.length&&(v=-1));return}b.props.disabled||(u==="selectedMenu"&&b.props.selected||v===-1)&&(v=x),v===x&&(b.props.disabled||b.props.muiSkipListHighlight||b.type.muiSkipListHighlight)&&(v+=1,v>=a.length&&(v=-1))});const y=_.Children.map(a,(b,x)=>{if(x===v){const S={};return s&&(S.autoFocus=!0),b.props.tabIndex===void 0&&u==="selectedMenu"&&(S.tabIndex=0),_.cloneElement(b,S)}return b});return G.jsx(cCe,ae({role:"menu",ref:g,className:o,onKeyDown:m,tabIndex:n?0:-1},h,{children:y}))}),hCe=dCe;function fCe(e){return Pi("MuiPopover",e)}Fi("MuiPopover",["root","paper"]);const pCe=["onEntering"],mCe=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],gCe=["slotProps"];function M$(e,t){let r=0;return typeof t=="number"?r=t:t==="center"?r=e.height/2:t==="bottom"&&(r=e.height),r}function P$(e,t){let r=0;return typeof t=="number"?r=t:t==="center"?r=e.width/2:t==="right"&&(r=e.width),r}function I$(e){return[e.horizontal,e.vertical].map(t=>typeof t=="number"?`${t}px`:t).join(" ")}function oI(e){return typeof e=="function"?e():e}const vCe=e=>{const{classes:t}=e;return Bi({root:["root"],paper:["paper"]},fCe,t)},yCe=fr(vee,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Cee=fr(nF,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),bCe=_.forwardRef(function(t,r){var i,n,s;const a=Ji({props:t,name:"MuiPopover"}),{action:o,anchorEl:l,anchorOrigin:c={vertical:"top",horizontal:"left"},anchorPosition:d,anchorReference:u="anchorEl",children:h,className:f,container:p,elevation:m=8,marginThreshold:g=16,open:v,PaperProps:y={},slots:b,slotProps:x,transformOrigin:S={vertical:"top",horizontal:"left"},TransitionComponent:w=WEe,transitionDuration:E="auto",TransitionProps:{onEntering:C}={},disableScrollLock:T=!1}=a,A=ar(a.TransitionProps,pCe),M=ar(a,mCe),P=(i=x==null?void 0:x.paper)!=null?i:y,I=_.useRef(),R=ol(I,P.ref),N=ae({},a,{anchorOrigin:c,anchorReference:u,elevation:m,marginThreshold:g,externalPaperSlotProps:P,transformOrigin:S,TransitionComponent:w,transitionDuration:E,TransitionProps:A}),k=vCe(N),O=_.useCallback(()=>{if(u==="anchorPosition")return d;const se=oI(l),me=(se&&se.nodeType===1?se:bo(I.current).body).getBoundingClientRect();return{top:me.top+M$(me,c.vertical),left:me.left+P$(me,c.horizontal)}},[l,c.horizontal,c.vertical,d,u]),D=_.useCallback(se=>({vertical:M$(se,S.vertical),horizontal:P$(se,S.horizontal)}),[S.horizontal,S.vertical]),B=_.useCallback(se=>{const fe={width:se.offsetWidth,height:se.offsetHeight},me=D(fe);if(u==="none")return{top:null,left:null,transformOrigin:I$(me)};const Oe=O();let Ee=Oe.top-me.vertical,Se=Oe.left-me.horizontal;const de=Ee+fe.height,be=Se+fe.width,ye=Mp(oI(l)),q=ye.innerHeight-g,U=ye.innerWidth-g;if(g!==null&&Ee<g){const ce=Ee-g;Ee-=ce,me.vertical+=ce}else if(g!==null&&de>q){const ce=de-q;Ee-=ce,me.vertical+=ce}if(g!==null&&Se<g){const ce=Se-g;Se-=ce,me.horizontal+=ce}else if(be>U){const ce=be-U;Se-=ce,me.horizontal+=ce}return{top:`${Math.round(Ee)}px`,left:`${Math.round(Se)}px`,transformOrigin:I$(me)}},[l,u,O,D,g]),[z,F]=_.useState(v),V=_.useCallback(()=>{const se=I.current;if(!se)return;const fe=B(se);fe.top!==null&&(se.style.top=fe.top),fe.left!==null&&(se.style.left=fe.left),se.style.transformOrigin=fe.transformOrigin,F(!0)},[B]);_.useEffect(()=>(T&&window.addEventListener("scroll",V),()=>window.removeEventListener("scroll",V)),[l,T,V]);const Y=(se,fe)=>{C&&C(se,fe),V()},W=()=>{F(!1)};_.useEffect(()=>{v&&V()}),_.useImperativeHandle(o,()=>v?{updatePosition:()=>{V()}}:null,[v,V]),_.useEffect(()=>{if(!v)return;const se=tee(()=>{V()}),fe=Mp(l);return fe.addEventListener("resize",se),()=>{se.clear(),fe.removeEventListener("resize",se)}},[l,v,V]);let X=E;E==="auto"&&!w.muiSupportAuto&&(X=void 0);const H=p||(l?bo(oI(l)).body:void 0),ie=(n=b==null?void 0:b.root)!=null?n:yCe,Q=(s=b==null?void 0:b.paper)!=null?s:Cee,Z=Fv({elementType:Q,externalSlotProps:ae({},P,{style:z?P.style:ae({},P.style,{opacity:0})}),additionalProps:{elevation:m,ref:R},ownerState:N,className:ui(k.paper,P==null?void 0:P.className)}),ee=Fv({elementType:ie,externalSlotProps:(x==null?void 0:x.root)||{},externalForwardedProps:M,additionalProps:{ref:r,slotProps:{backdrop:{invisible:!0}},container:H,open:v},ownerState:N,className:ui(k.root,f)}),{slotProps:re}=ee,ne=ar(ee,gCe);return G.jsx(ie,ae({},ne,!BC(ie)&&{slotProps:re,disableScrollLock:T},{children:G.jsx(w,ae({appear:!0,in:v,onEntering:Y,onExited:W,timeout:X},A,{children:G.jsx(Q,ae({},Z,{children:h}))}))}))}),xCe=bCe;function wCe(e){return Pi("MuiMenu",e)}Fi("MuiMenu",["root","paper","list"]);const _Ce=["onEntering"],SCe=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],ECe={vertical:"top",horizontal:"right"},CCe={vertical:"top",horizontal:"left"},ACe=e=>{const{classes:t}=e;return Bi({root:["root"],paper:["paper"],list:["list"]},wCe,t)},TCe=fr(xCe,{shouldForwardProp:e=>Jl(e)||e==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),MCe=fr(Cee,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),PCe=fr(hCe,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),ICe=_.forwardRef(function(t,r){var i,n;const s=Ji({props:t,name:"MuiMenu"}),{autoFocus:a=!0,children:o,className:l,disableAutoFocusItem:c=!1,MenuListProps:d={},onClose:u,open:h,PaperProps:f={},PopoverClasses:p,transitionDuration:m="auto",TransitionProps:{onEntering:g}={},variant:v="selectedMenu",slots:y={},slotProps:b={}}=s,x=ar(s.TransitionProps,_Ce),S=ar(s,SCe),w=J2(),E=w.direction==="rtl",C=ae({},s,{autoFocus:a,disableAutoFocusItem:c,MenuListProps:d,onEntering:g,PaperProps:f,transitionDuration:m,TransitionProps:x,variant:v}),T=ACe(C),A=a&&!c&&h,M=_.useRef(null),P=(B,z)=>{M.current&&M.current.adjustStyleForScrollbar(B,w),g&&g(B,z)},I=B=>{B.key==="Tab"&&(B.preventDefault(),u&&u(B,"tabKeyDown"))};let R=-1;_.Children.map(o,(B,z)=>{_.isValidElement(B)&&(B.props.disabled||(v==="selectedMenu"&&B.props.selected||R===-1)&&(R=z))});const N=(i=y.paper)!=null?i:MCe,k=(n=b.paper)!=null?n:f,O=Fv({elementType:y.root,externalSlotProps:b.root,ownerState:C,className:[T.root,l]}),D=Fv({elementType:N,externalSlotProps:k,ownerState:C,className:T.paper});return G.jsx(TCe,ae({onClose:u,anchorOrigin:{vertical:"bottom",horizontal:E?"right":"left"},transformOrigin:E?ECe:CCe,slots:{paper:N,root:y.root},slotProps:{root:O,paper:D},open:h,ref:r,transitionDuration:m,TransitionProps:ae({onEntering:P},x),ownerState:C},S,{classes:p,children:G.jsx(PCe,ae({onKeyDown:I,actions:M,autoFocus:a&&(R===-1||c),autoFocusItem:A,variant:v},d,{className:ui(T.list,d.className),children:o}))}))}),RCe=ICe;function DCe(e){return Pi("MuiNativeSelect",e)}const OCe=Fi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),uF=OCe,LCe=["className","disabled","error","IconComponent","inputRef","variant"],NCe=e=>{const{classes:t,variant:r,disabled:i,multiple:n,open:s,error:a}=e,o={select:["select",r,i&&"disabled",n&&"multiple",a&&"error"],icon:["icon",`icon${Xr(r)}`,s&&"iconOpen",i&&"disabled"]};return Bi(o,DCe,t)},Aee=({ownerState:e,theme:t})=>ae({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":ae({},t.vars?{backgroundColor:`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:t.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${uF.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},e.variant==="filled"&&{"&&&":{paddingRight:32}},e.variant==="outlined"&&{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}),kCe=fr("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Jl,overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.select,t[r.variant],r.error&&t.error,{[`&.${uF.multiple}`]:t.multiple}]}})(Aee),Tee=({ownerState:e,theme:t})=>ae({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${uF.disabled}`]:{color:(t.vars||t).palette.action.disabled}},e.open&&{transform:"rotate(180deg)"},e.variant==="filled"&&{right:7},e.variant==="outlined"&&{right:7}),zCe=fr("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,r.variant&&t[`icon${Xr(r.variant)}`],r.open&&t.iconOpen]}})(Tee),BCe=_.forwardRef(function(t,r){const{className:i,disabled:n,error:s,IconComponent:a,inputRef:o,variant:l="standard"}=t,c=ar(t,LCe),d=ae({},t,{disabled:n,variant:l,error:s}),u=NCe(d);return G.jsxs(_.Fragment,{children:[G.jsx(kCe,ae({ownerState:d,className:ui(u.select,i),disabled:n,ref:o||r},c)),t.multiple?null:G.jsx(zCe,{as:a,ownerState:d,className:u.icon})]})}),FCe=BCe;var R$;const jCe=["children","classes","className","label","notched"],VCe=fr("fieldset",{shouldForwardProp:Jl})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),UCe=fr("legend",{shouldForwardProp:Jl})(({ownerState:e,theme:t})=>ae({float:"unset",width:"auto",overflow:"hidden"},!e.withLabel&&{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})},e.withLabel&&ae({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},e.notched&&{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})})));function $Ce(e){const{className:t,label:r,notched:i}=e,n=ar(e,jCe),s=r!=null&&r!=="",a=ae({},e,{notched:i,withLabel:s});return G.jsx(VCe,ae({"aria-hidden":!0,className:t,ownerState:a},n,{children:G.jsx(UCe,{ownerState:a,children:s?G.jsx("span",{children:r}):R$||(R$=G.jsx("span",{className:"notranslate",children:"​"}))})}))}const HCe=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],WCe=e=>{const{classes:t}=e,i=Bi({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},CSe,t);return ae({},t,i)},GCe=fr(rM,{shouldForwardProp:e=>Jl(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:eM})(({theme:e,ownerState:t})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return ae({position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${Sd.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${Sd.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${Sd.focused} .${Sd.notchedOutline}`]:{borderColor:(e.vars||e).palette[t.color].main,borderWidth:2},[`&.${Sd.error} .${Sd.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${Sd.disabled} .${Sd.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}},t.startAdornment&&{paddingLeft:14},t.endAdornment&&{paddingRight:14},t.multiline&&ae({padding:"16.5px 14px"},t.size==="small"&&{padding:"8.5px 14px"}))}),qCe=fr($Ce,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})(({theme:e})=>{const t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:t}}),XCe=fr(iM,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:tM})(({theme:e,ownerState:t})=>ae({padding:"16.5px 14px"},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},t.size==="small"&&{padding:"8.5px 14px"},t.multiline&&{padding:0},t.startAdornment&&{paddingLeft:0},t.endAdornment&&{paddingRight:0})),Mee=_.forwardRef(function(t,r){var i,n,s,a,o;const l=Ji({props:t,name:"MuiOutlinedInput"}),{components:c={},fullWidth:d=!1,inputComponent:u="input",label:h,multiline:f=!1,notched:p,slots:m={},type:g="text"}=l,v=ar(l,HCe),y=WCe(l),b=E0(),x=S0({props:l,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),S=ae({},l,{color:x.color||"primary",disabled:x.disabled,error:x.error,focused:x.focused,formControl:b,fullWidth:d,hiddenLabel:x.hiddenLabel,multiline:f,size:x.size,type:g}),w=(i=(n=m.root)!=null?n:c.Root)!=null?i:GCe,E=(s=(a=m.input)!=null?a:c.Input)!=null?s:XCe;return G.jsx(aF,ae({slots:{root:w,input:E},renderSuffix:C=>G.jsx(qCe,{ownerState:S,className:y.notchedOutline,label:h!=null&&h!==""&&x.required?o||(o=G.jsxs(_.Fragment,{children:[h," ","*"]})):h,notched:typeof p<"u"?p:!!(C.startAdornment||C.filled||C.focused)}),fullWidth:d,inputComponent:u,multiline:f,ref:r,type:g},v,{classes:ae({},y,{notchedOutline:null})}))});Mee.muiName="Input";const Pee=Mee;function YCe(e){return Pi("MuiSelect",e)}const KCe=Fi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),fy=KCe;var D$;const QCe=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],ZCe=fr("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`&.${fy.select}`]:t.select},{[`&.${fy.select}`]:t[r.variant]},{[`&.${fy.error}`]:t.error},{[`&.${fy.multiple}`]:t.multiple}]}})(Aee,{[`&.${fy.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),JCe=fr("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,r.variant&&t[`icon${Xr(r.variant)}`],r.open&&t.iconOpen]}})(Tee),eAe=fr("input",{shouldForwardProp:e=>__e(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function O$(e,t){return typeof t=="object"&&t!==null?e===t:String(e)===String(t)}function tAe(e){return e==null||typeof e=="string"&&!e.trim()}const rAe=e=>{const{classes:t,variant:r,disabled:i,multiple:n,open:s,error:a}=e,o={select:["select",r,i&&"disabled",n&&"multiple",a&&"error"],icon:["icon",`icon${Xr(r)}`,s&&"iconOpen",i&&"disabled"],nativeInput:["nativeInput"]};return Bi(o,YCe,t)},iAe=_.forwardRef(function(t,r){var i;const{"aria-describedby":n,"aria-label":s,autoFocus:a,autoWidth:o,children:l,className:c,defaultOpen:d,defaultValue:u,disabled:h,displayEmpty:f,error:p=!1,IconComponent:m,inputRef:g,labelId:v,MenuProps:y={},multiple:b,name:x,onBlur:S,onChange:w,onClose:E,onFocus:C,onOpen:T,open:A,readOnly:M,renderValue:P,SelectDisplayProps:I={},tabIndex:R,value:N,variant:k="standard"}=t,O=ar(t,QCe),[D,B]=r$({controlled:N,default:u,name:"Select"}),[z,F]=r$({controlled:A,default:d,name:"Select"}),V=_.useRef(null),Y=_.useRef(null),[W,X]=_.useState(null),{current:H}=_.useRef(A!=null),[ie,Q]=_.useState(),Z=ol(r,g),ee=_.useCallback(Re=>{Y.current=Re,Re&&X(Re)},[]),re=W==null?void 0:W.parentNode;_.useImperativeHandle(Z,()=>({focus:()=>{Y.current.focus()},node:V.current,value:D}),[D]),_.useEffect(()=>{d&&z&&W&&!H&&(Q(o?null:re.clientWidth),Y.current.focus())},[W,o]),_.useEffect(()=>{a&&Y.current.focus()},[a]),_.useEffect(()=>{if(!v)return;const Re=bo(Y.current).getElementById(v);if(Re){const et=()=>{getSelection().isCollapsed&&Y.current.focus()};return Re.addEventListener("click",et),()=>{Re.removeEventListener("click",et)}}},[v]);const ne=(Re,et)=>{Re?T&&T(et):E&&E(et),H||(Q(o?null:re.clientWidth),F(Re))},se=Re=>{Re.button===0&&(Re.preventDefault(),Y.current.focus(),ne(!0,Re))},fe=Re=>{ne(!1,Re)},me=_.Children.toArray(l),Oe=Re=>{const et=me.find(Xe=>Xe.props.value===Re.target.value);et!==void 0&&(B(et.props.value),w&&w(Re,et))},Ee=Re=>et=>{let Xe;if(et.currentTarget.hasAttribute("tabindex")){if(b){Xe=Array.isArray(D)?D.slice():[];const Ze=D.indexOf(Re.props.value);Ze===-1?Xe.push(Re.props.value):Xe.splice(Ze,1)}else Xe=Re.props.value;if(Re.props.onClick&&Re.props.onClick(et),D!==Xe&&(B(Xe),w)){const Ze=et.nativeEvent||et,Mt=new Ze.constructor(Ze.type,Ze);Object.defineProperty(Mt,"target",{writable:!0,value:{value:Xe,name:x}}),w(Mt,Re)}b||ne(!1,et)}},Se=Re=>{M||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Re.key)!==-1&&(Re.preventDefault(),ne(!0,Re))},de=W!==null&&z,be=Re=>{!de&&S&&(Object.defineProperty(Re,"target",{writable:!0,value:{value:D,name:x}}),S(Re))};delete O["aria-invalid"];let ye,q;const U=[];let ce=!1;(FC({value:D})||f)&&(P?ye=P(D):ce=!0);const xe=me.map(Re=>{if(!_.isValidElement(Re))return null;let et;if(b){if(!Array.isArray(D))throw new Error(Fh(2));et=D.some(Xe=>O$(Xe,Re.props.value)),et&&ce&&U.push(Re.props.children)}else et=O$(D,Re.props.value),et&&ce&&(q=Re.props.children);return _.cloneElement(Re,{"aria-selected":et?"true":"false",onClick:Ee(Re),onKeyUp:Xe=>{Xe.key===" "&&Xe.preventDefault(),Re.props.onKeyUp&&Re.props.onKeyUp(Xe)},role:"option",selected:et,value:void 0,"data-value":Re.props.value})});ce&&(b?U.length===0?ye=null:ye=U.reduce((Re,et,Xe)=>(Re.push(et),Xe<U.length-1&&Re.push(", "),Re),[]):ye=q);let j=ie;!o&&H&&W&&(j=re.clientWidth);let Be;typeof R<"u"?Be=R:Be=h?null:0;const ze=I.id||(x?`mui-component-select-${x}`:void 0),Ve=ae({},t,{variant:k,value:D,open:de,error:p}),pe=rAe(Ve),Me=ae({},y.PaperProps,(i=y.slotProps)==null?void 0:i.paper),Ue=XB();return G.jsxs(_.Fragment,{children:[G.jsx(ZCe,ae({ref:ee,tabIndex:Be,role:"combobox","aria-controls":Ue,"aria-disabled":h?"true":void 0,"aria-expanded":de?"true":"false","aria-haspopup":"listbox","aria-label":s,"aria-labelledby":[v,ze].filter(Boolean).join(" ")||void 0,"aria-describedby":n,onKeyDown:Se,onMouseDown:h||M?null:se,onBlur:be,onFocus:C},I,{ownerState:Ve,className:ui(I.className,pe.select,c),id:ze,children:tAe(ye)?D$||(D$=G.jsx("span",{className:"notranslate",children:"​"})):ye})),G.jsx(eAe,ae({"aria-invalid":p,value:Array.isArray(D)?D.join(","):D,name:x,ref:V,"aria-hidden":!0,onChange:Oe,tabIndex:-1,disabled:h,className:pe.nativeInput,autoFocus:a,ownerState:Ve},O)),G.jsx(JCe,{as:m,className:pe.icon,ownerState:Ve}),G.jsx(RCe,ae({id:`menu-${x||""}`,anchorEl:re,open:de,onClose:fe,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},y,{MenuListProps:ae({"aria-labelledby":v,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:Ue},y.MenuListProps),slotProps:ae({},y.slotProps,{paper:ae({},Me,{style:ae({minWidth:j},Me!=null?Me.style:null)})}),children:xe}))]})}),nAe=iAe,sAe=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],aAe=["root"],oAe=e=>{const{classes:t}=e;return t},dF={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>Jl(e)&&e!=="variant",slot:"Root"},lAe=fr(See,dF)(""),cAe=fr(Pee,dF)(""),uAe=fr(xee,dF)(""),Iee=_.forwardRef(function(t,r){const i=Ji({name:"MuiSelect",props:t}),{autoWidth:n=!1,children:s,classes:a={},className:o,defaultOpen:l=!1,displayEmpty:c=!1,IconComponent:d=PSe,id:u,input:h,inputProps:f,label:p,labelId:m,MenuProps:g,multiple:v=!1,native:y=!1,onClose:b,onOpen:x,open:S,renderValue:w,SelectDisplayProps:E,variant:C="outlined"}=i,T=ar(i,sAe),A=y?FCe:nAe,M=E0(),P=S0({props:i,muiFormControl:M,states:["variant","error"]}),I=P.variant||C,R=ae({},i,{variant:I,classes:a}),N=oAe(R),k=ar(N,aAe),O=h||{standard:G.jsx(lAe,{ownerState:R}),outlined:G.jsx(cAe,{label:p,ownerState:R}),filled:G.jsx(uAe,{ownerState:R})}[I],D=ol(r,O.ref);return G.jsx(_.Fragment,{children:_.cloneElement(O,ae({inputComponent:A,inputProps:ae({children:s,error:P.error,IconComponent:d,variant:I,type:void 0,multiple:v},y?{id:u}:{autoWidth:n,defaultOpen:l,displayEmpty:c,labelId:m,MenuProps:g,onClose:b,onOpen:x,open:S,renderValue:w,SelectDisplayProps:ae({id:u},E)},f,{classes:f?Ya(k,f.classes):k},h?h.props.inputProps:{})},v&&y&&I==="outlined"?{notched:!0}:{},{ref:D,className:ui(O.props.className,o,N.root)},!h&&{variant:I},T))})});Iee.muiName="Select";const dAe=Iee;function hAe(e){return Pi("MuiTextField",e)}Fi("MuiTextField",["root"]);const fAe=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],pAe={standard:See,filled:xee,outlined:Pee},mAe=e=>{const{classes:t}=e;return Bi({root:["root"]},hAe,t)},gAe=fr(TEe,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),vAe=_.forwardRef(function(t,r){const i=Ji({props:t,name:"MuiTextField"}),{autoComplete:n,autoFocus:s=!1,children:a,className:o,color:l="primary",defaultValue:c,disabled:d=!1,error:u=!1,FormHelperTextProps:h,fullWidth:f=!1,helperText:p,id:m,InputLabelProps:g,inputProps:v,InputProps:y,inputRef:b,label:x,maxRows:S,minRows:w,multiline:E=!1,name:C,onBlur:T,onChange:A,onFocus:M,placeholder:P,required:I=!1,rows:R,select:N=!1,SelectProps:k,type:O,value:D,variant:B="outlined"}=i,z=ar(i,fAe),F=ae({},i,{autoFocus:s,color:l,disabled:d,error:u,fullWidth:f,multiline:E,required:I,select:N,variant:B}),V=mAe(F),Y={};B==="outlined"&&(g&&typeof g.shrink<"u"&&(Y.notched=g.shrink),Y.label=x),N&&((!k||!k.native)&&(Y.id=void 0),Y["aria-describedby"]=void 0);const W=XB(m),X=p&&W?`${W}-helper-text`:void 0,H=x&&W?`${W}-label`:void 0,ie=pAe[B],Q=G.jsx(ie,ae({"aria-describedby":X,autoComplete:n,autoFocus:s,defaultValue:c,fullWidth:f,multiline:E,name:C,rows:R,maxRows:S,minRows:w,type:O,value:D,id:W,inputRef:b,onBlur:T,onChange:A,onFocus:M,placeholder:P,inputProps:v},Y,y));return G.jsxs(gAe,ae({className:ui(V.root,o),disabled:d,error:u,fullWidth:f,ref:r,required:I,color:l,variant:B,ownerState:F},z,{children:[x!=null&&x!==""&&G.jsx(tCe,ae({htmlFor:W,id:H},g,{children:x})),N?G.jsx(dAe,ae({"aria-describedby":X,id:W,labelId:H,value:D,input:Q},k,{children:a})):Q,p&&G.jsx(LEe,ae({id:X},h,{children:p}))]}))}),yAe=vAe,bAe=({isOpen:e,onClose:t,onLoadPlaylistPreview:r,previewImage:i,setNewPlaylistTitle:n})=>G.jsxs(oF,{open:e,onClose:t,children:[G.jsx(cF,{children:"Добавить новый плейлист"}),G.jsx(lF,{children:G.jsxs("div",{className:"flex flex-col gap-5 w-96",children:[G.jsx(fEe,{children:"Выберите обложку и название:"}),i&&G.jsx("img",{src:i,alt:"Preview",className:"w-16 h-16 mb-2"}),G.jsx("input",{type:"file",onChange:r}),G.jsx(yAe,{autoFocus:!0,margin:"dense",id:"title",label:"Название плейлиста",type:"input",fullWidth:!0,variant:"standard",onChange:s=>n(s.target.value)})]})})]});let hF=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");const xAe={type:"warning",description:"Введённые данные неверны",message:"Вход не произведён"},Kc=localStorage.getItem("currentUserId"),wAe=({onPlaylistSelect:e})=>{const[t,r]=_.useState([]),[i,n]=_.useState(""),[s,a]=_.useState(null),[o,l]=_.useState(!1),c=()=>l(!0),d=()=>{l(!1);const h={id:hF(),title:i,imagePath:s||"/assets/liked.png"};r([...t,h]),rbe(Kc,h.id,i,s).then(()=>console.log("New playlist added to database"))},u=h=>{const f=h.target.files&&h.target.files[0];if(f){const p=new FileReader;p.onloadend=()=>{a(p.result)},p.readAsDataURL(f)}};return IJ(r,Kc),G.jsxs("div",{className:"flex flex-col justify-center items-center border-2 min-h-32dvh min-w-full max-w-5xl mx-auto my-10 py-10 rounded-xl bg-gray-12 p-10 gap-3",children:[G.jsxs("div",{className:"flex items-center justify-between w-full",children:[G.jsxs("div",{className:"flex",children:[G.jsx("div",{className:"relative",children:G.jsx("img",{src:"/assets/grid_icon.png",alt:"Add new playlist button",className:"w-8 h-8 mr-5"})}),G.jsx("h2",{className:"text-2xl font-bold text-white",children:"Ваши плейлисты"})]}),G.jsx("div",{onClick:c,className:"",children:G.jsx("img",{src:"/assets/add_playlist_button.png",alt:"Add new playlist button",className:"w-12 h-12"})})]}),G.jsx("div",{className:"grid gap-20 2xl:grid-cols-playlistsWrap-2xl xl:grid-cols-playlistsWrap-xl lg:grid-cols-playlistsWrap-lg md:grid-cols-playlistsWrap-md sm:grid-cols-playlistsWrap-sm",children:t&&t.map(h=>G.jsx(cbe,{playlist:h,onPlaylistSelect:()=>e(h)},h.id))}),G.jsx(bAe,{isOpen:o,onClose:d,onLoadPlaylistPreview:u,previewImage:s,setNewPlaylistTitle:n})]})};var Ree={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},L$=Ge.createContext&&Ge.createContext(Ree),_Ae=["attr","size","title"];function SAe(e,t){if(e==null)return{};var r=EAe(e,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function EAe(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function jC(){return jC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},jC.apply(this,arguments)}function N$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function VC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N$(Object(r),!0).forEach(function(i){CAe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N$(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function CAe(e,t,r){return t=AAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AAe(e){var t=TAe(e,"string");return typeof t=="symbol"?t:String(t)}function TAe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dee(e){return e&&e.map((t,r)=>Ge.createElement(t.tag,VC({key:r},t.attr),Dee(t.child)))}function Oee(e){return t=>Ge.createElement(MAe,jC({attr:VC({},e.attr)},t),Dee(e.child))}function MAe(e){var t=r=>{var{attr:i,size:n,title:s}=e,a=SAe(e,_Ae),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Ge.createElement("svg",jC({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:VC(VC({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&Ge.createElement("title",null,s),e.children)};return L$!==void 0?Ge.createElement(L$.Consumer,null,r=>t(r)):t(Ree)}function Lee(e){return Oee({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M0.877075 7.49988C0.877075 3.84219 3.84222 0.877045 7.49991 0.877045C11.1576 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1576 14.1227 7.49991 14.1227C3.84222 14.1227 0.877075 11.1575 0.877075 7.49988ZM7.49991 1.82704C4.36689 1.82704 1.82708 4.36686 1.82708 7.49988C1.82708 10.6329 4.36689 13.1727 7.49991 13.1727C10.6329 13.1727 13.1727 10.6329 13.1727 7.49988C13.1727 4.36686 10.6329 1.82704 7.49991 1.82704ZM9.85358 5.14644C10.0488 5.3417 10.0488 5.65829 9.85358 5.85355L8.20713 7.49999L9.85358 9.14644C10.0488 9.3417 10.0488 9.65829 9.85358 9.85355C9.65832 10.0488 9.34173 10.0488 9.14647 9.85355L7.50002 8.2071L5.85358 9.85355C5.65832 10.0488 5.34173 10.0488 5.14647 9.85355C4.95121 9.65829 4.95121 9.3417 5.14647 9.14644L6.79292 7.49999L5.14647 5.85355C4.95121 5.65829 4.95121 5.3417 5.14647 5.14644C5.34173 4.95118 5.65832 4.95118 5.85358 5.14644L7.50002 6.79289L9.14647 5.14644C9.34173 4.95118 9.65832 4.95118 9.85358 5.14644Z",fill:"currentColor"},child:[]}]})(e)}const PAe=()=>{const[e,t]=_.useState([]),r=async()=>{const n=await MJ(Kc),s=await fetch(`/getTracksByIds?ids=${n.join("%2C")}`).then(a=>a.json());t(s.tracks)},i=async n=>{await abe(Kc,n),t(e.filter(s=>s.id!==n))};return _.useEffect(()=>{r()},[]),G.jsx("div",{className:"flex flex-col",children:e.map(n=>G.jsxs("li",{className:"border p-4 mb-4 text-white flex items-center justify-between gap-10",children:[G.jsx("img",{src:n.album.images[2].url,alt:"",className:"basis-1/8"}),G.jsx("span",{className:"text-center text-white basis-1/4",children:n.name+" - "+n.artists[0].name}),G.jsx("audio",{controls:!0,src:n.preview_url,className:"bg-white basis-2/4"}),G.jsx("button",{onClick:()=>i(n.id),children:G.jsx(Lee,{className:"w-8 h-7 text-[#FF0000]"})})]},n.id))})},IAe=()=>G.jsxs("div",{className:"flex flex-col justify-center items-center border-white min-h-32dvh min-w-full max-w-5xl mx-auto my-10 py-10 rounded-xl bg-gray-12 p-10",children:[G.jsxs("div",{className:"flex justify-start w-full",children:[G.jsx("div",{className:"relative",children:G.jsx("img",{src:"/assets/liked.png",alt:"Add new playlist button",className:"w-8 h-8 mr-5"})}),G.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Вам понравилось"})]}),G.jsx("div",{className:"flex flex-col",children:G.jsx(PAe,{})})]});const RAe=({isVisible:e,selectedPlaylist:t,onPlaylistClosed:r})=>{const[i,n]=_.useState([]),[s,a]=_.useState([]),o=c=>{var u;c.stopPropagation();const d=(u=c.currentTarget.parentElement)==null?void 0:u.classList;d==null||d.replace("wrapper","menu__closed"),r()},l=c=>{sbe(Kc,t.id,c).then(()=>{a(d=>d.filter(u=>u.id!==c))})};return _.useEffect(()=>{(async()=>{const d=await lbe(Kc,t.id);n(d)})()},[t.id]),_.useEffect(()=>{(async()=>{if(i.length>0){const{tracks:d}=await fetch(`/getTracksByIds?ids=${i.map(u=>u.trackId).join("%2C")}`).then(u=>u.json());a(d)}})()},[i]),G.jsxs("div",{className:e?"wrapper":"menu__closed overscroll-contain",children:[G.jsx("div",{className:"menu__background",onClick:o}),G.jsxs("div",{className:"menu__opened overflow-y-auto",children:[G.jsxs("div",{className:"flex justify-between",children:[G.jsxs("div",{className:"flex flex-col justify-start",children:[G.jsx("span",{className:"text-3xl font-jost font-bold",children:"ПЛЕЙЛИСТ"}),G.jsx("span",{className:"text-2xl",children:t.title})]}),G.jsx("img",{src:t.imagePath,alt:"Playlist image",className:"h-36 w-36"})]}),G.jsx("button",{className:"flex justify-center min-w-full my-5 hover:cursor-default",children:G.jsx("img",{src:"/assets/playlist_play_button.png",alt:"",className:"w-28 h-28 hover:cursor-pointer"})}),G.jsx("ul",{children:e&&s.map((c,d)=>G.jsxs("li",{className:"border border-gray-12 p-4 mb-4 text-white flex items-center justify-between gap-10",children:[G.jsx("img",{src:c.album.images[2].url.length?c.album.images[2].url:"",alt:"",className:"basis-1/8"}),G.jsx("span",{className:"text-center text-[#000000] text-lg basis-1/4",children:c.name+" - "+c.artists[0].name}),i[d].preview_url!==void 0&&i[d].preview_url!==null?G.jsx("audio",{controls:!0,src:i[d].preview_url,className:"bg-white basis-2/4"}):G.jsx("a",{href:c.external_urls.spotify,className:"text-lg text-[#000000] font-bold text-center basis-2/4",children:"Слушать на Spotify"}),G.jsx("button",{onClick:()=>l(c.id),children:G.jsx(Lee,{className:"w-8 h-7 text-[#FF0000]",alt:"Delete liked track icon"})})]},hF()))})]})]})},DAe=()=>G.jsx("footer",{className:"flex justify-center items-center bg-gray-100 py-6 container mx-auto border-2 rounded-t-2xl border-white px-5 max-w-5xl",children:G.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[G.jsxs("div",{className:"text-center md:text-left",children:[G.jsx("img",{className:"w-64",src:"/assets/logo-transparent.png",alt:"Musicstream logo transparent"}),G.jsxs("p",{className:"text-gray-600 text-center",children:["Все права принадлежат компании ",G.jsx("br",{}),'"Моя компания"']})]}),G.jsxs("div",{className:"text-center md:text-left border-l-white border-2 px-10",children:[G.jsx("h4",{className:"text-lg font-semibold mb-2 text-white",children:"Контакты"}),G.jsxs("ul",{className:"list-image-[url(https://cdn-icons-png.flaticon.com/16/5299/5299035.png)]",children:[G.jsx("li",{children:G.jsx("p",{className:"text-gray-600",children:"Email: example@work.ru"})}),G.jsx("li",{children:G.jsx("p",{className:"text-gray-600",children:"Телефон: 8 (999) 999 99 99"})}),G.jsx("li",{children:G.jsx("p",{className:"text-gray-600",children:"Viber/ICQ: нет"})})]})]}),G.jsxs("div",{className:"text-center md:text-left border-l-white border-2 px-5",children:[G.jsx("h4",{className:"text-lg font-semibold mb-2 text-white",children:"Адрес"}),G.jsx("p",{className:"text-gray-600",children:"Московский пр-т, 1498,"}),G.jsx("p",{className:"text-gray-600",children:"Санкт-Петербург, 196128"})]})]})});var Nee={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var s="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(s=n(s,i(o)))}return s}function i(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return r.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var o in s)t.call(s,o)&&s[o]&&(a=n(a,o));return a}function n(s,a){return a?s?s+" "+a:s+a:s}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(Nee);var OAe=Nee.exports;const Fe=mT(OAe);function Qc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[];return Ge.Children.forEach(e,function(i){i==null&&!t.keepEmpty||(Array.isArray(i)?r=r.concat(Qc(i)):qB.isFragment(i)&&i.props?r=r.concat(Qc(i.props.children,t)):r.push(i))}),r}var M3={},LAe=function(t){};function NAe(e,t){}function kAe(e,t){}function zAe(){M3={}}function kee(e,t,r){!t&&!M3[r]&&(e(!1,r),M3[r]=!0)}function As(e,t){kee(NAe,e,t)}function BAe(e,t){kee(kAe,e,t)}As.preMessage=LAe;As.resetWarned=zAe;As.noteOnce=BAe;function vr(e){"@babel/helpers - typeof";return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr(e)}function FAe(e,t){if(vr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(vr(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zee(e){var t=FAe(e,"string");return vr(t)=="symbol"?t:String(t)}function he(e,t,r){return t=zee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function _e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k$(Object(r),!0).forEach(function(i){he(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k$(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function UC(e){return e instanceof HTMLElement||e instanceof SVGElement}function V1(e){return UC(e)?e:e instanceof Ge.Component?Lg.findDOMNode(e):null}function tw(e,t,r){var i=_.useRef({});return(!("value"in i.current)||r(i.current.condition,t))&&(i.current.value=e(),i.current.condition=t),i.current.value}function fF(e,t){typeof e=="function"?e(t):vr(e)==="object"&&e&&"current"in e&&(e.current=t)}function To(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t.filter(function(n){return n});return i.length<=1?i[0]:function(n){t.forEach(function(s){fF(s,n)})}}function C0(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return tw(function(){return To.apply(void 0,t)},t,function(i,n){return i.length!==n.length||i.every(function(s,a){return s!==n[a]})})}function gd(e){var t,r,i=qB.isMemo(e)?e.type.type:e.type;return!(typeof i=="function"&&!((t=i.prototype)!==null&&t!==void 0&&t.render)||typeof e=="function"&&!((r=e.prototype)!==null&&r!==void 0&&r.render))}function jAe(e){return!_.isValidElement(e)||qB.isFragment(e)?!1:gd(e)}var P3=_.createContext(null);function VAe(e){var t=e.children,r=e.onBatchResize,i=_.useRef(0),n=_.useRef([]),s=_.useContext(P3),a=_.useCallback(function(o,l,c){i.current+=1;var d=i.current;n.current.push({size:o,element:l,data:c}),Promise.resolve().then(function(){d===i.current&&(r==null||r(n.current),n.current=[])}),s==null||s(o,l,c)},[r,s]);return _.createElement(P3.Provider,{value:a},t)}var Bee=function(){if(typeof Map<"u")return Map;function e(t,r){var i=-1;return t.some(function(n,s){return n[0]===r?(i=s,!0):!1}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(r){var i=e(this.__entries__,r),n=this.__entries__[i];return n&&n[1]},t.prototype.set=function(r,i){var n=e(this.__entries__,r);~n?this.__entries__[n][1]=i:this.__entries__.push([r,i])},t.prototype.delete=function(r){var i=this.__entries__,n=e(i,r);~n&&i.splice(n,1)},t.prototype.has=function(r){return!!~e(this.__entries__,r)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(r,i){i===void 0&&(i=null);for(var n=0,s=this.__entries__;n<s.length;n++){var a=s[n];r.call(i,a[1],a[0])}},t}()}(),I3=typeof window<"u"&&typeof document<"u"&&window.document===document,$C=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),UAe=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind($C):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),$Ae=2;function HAe(e,t){var r=!1,i=!1,n=0;function s(){r&&(r=!1,e()),i&&o()}function a(){UAe(s)}function o(){var l=Date.now();if(r){if(l-n<$Ae)return;i=!0}else r=!0,i=!1,setTimeout(a,t);n=l}return o}var WAe=20,GAe=["top","right","bottom","left","width","height","size","weight"],qAe=typeof MutationObserver<"u",XAe=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=HAe(this.refresh.bind(this),WAe)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var r=this.observers_,i=r.indexOf(t);~i&&r.splice(i,1),!r.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return t.forEach(function(r){return r.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!I3||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),qAe?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!I3||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var r=t.propertyName,i=r===void 0?"":r,n=GAe.some(function(s){return!!~i.indexOf(s)});n&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Fee=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},Vv=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||$C},jee=nM(0,0,0,0);function HC(e){return parseFloat(e)||0}function z$(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce(function(i,n){var s=e["border-"+n+"-width"];return i+HC(s)},0)}function YAe(e){for(var t=["top","right","bottom","left"],r={},i=0,n=t;i<n.length;i++){var s=n[i],a=e["padding-"+s];r[s]=HC(a)}return r}function KAe(e){var t=e.getBBox();return nM(0,0,t.width,t.height)}function QAe(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return jee;var i=Vv(e).getComputedStyle(e),n=YAe(i),s=n.left+n.right,a=n.top+n.bottom,o=HC(i.width),l=HC(i.height);if(i.boxSizing==="border-box"&&(Math.round(o+s)!==t&&(o-=z$(i,"left","right")+s),Math.round(l+a)!==r&&(l-=z$(i,"top","bottom")+a)),!JAe(e)){var c=Math.round(o+s)-t,d=Math.round(l+a)-r;Math.abs(c)!==1&&(o-=c),Math.abs(d)!==1&&(l-=d)}return nM(n.left,n.top,o,l)}var ZAe=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof Vv(e).SVGGraphicsElement}:function(e){return e instanceof Vv(e).SVGElement&&typeof e.getBBox=="function"}}();function JAe(e){return e===Vv(e).document.documentElement}function eTe(e){return I3?ZAe(e)?KAe(e):QAe(e):jee}function tTe(e){var t=e.x,r=e.y,i=e.width,n=e.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(s.prototype);return Fee(a,{x:t,y:r,width:i,height:n,top:r,right:t+i,bottom:n+r,left:t}),a}function nM(e,t,r,i){return{x:e,y:t,width:r,height:i}}var rTe=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=nM(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=eTe(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),iTe=function(){function e(t,r){var i=tTe(r);Fee(this,{target:t,contentRect:i})}return e}(),nTe=function(){function e(t,r,i){if(this.activeObservations_=[],this.observations_=new Bee,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=r,this.callbackCtx_=i}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Vv(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(t)||(r.set(t,new rTe(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Vv(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(t)&&(r.delete(t),r.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&t.activeObservations_.push(r)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,r=this.activeObservations_.map(function(i){return new iTe(i.target,i.broadcastRect())});this.callback_.call(t,r,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Vee=typeof WeakMap<"u"?new WeakMap:new Bee,Uee=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=XAe.getInstance(),i=new nTe(t,r,this);Vee.set(this,i)}return e}();["observe","unobserve","disconnect"].forEach(function(e){Uee.prototype[e]=function(){var t;return(t=Vee.get(this))[e].apply(t,arguments)}});var sTe=function(){return typeof $C.ResizeObserver<"u"?$C.ResizeObserver:Uee}(),nh=new Map;function aTe(e){e.forEach(function(t){var r,i=t.target;(r=nh.get(i))===null||r===void 0||r.forEach(function(n){return n(i)})})}var $ee=new sTe(aTe);function oTe(e,t){nh.has(e)||(nh.set(e,new Set),$ee.observe(e)),nh.get(e).add(t)}function lTe(e,t){nh.has(e)&&(nh.get(e).delete(t),nh.get(e).size||($ee.unobserve(e),nh.delete(e)))}function Ds(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B$(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,zee(i.key),i)}}function Os(e,t,r){return t&&B$(e.prototype,t),r&&B$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kp(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kC(e,t)}function WC(e){return WC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WC(e)}function cTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uTe(e,t){if(t&&(vr(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nr(e)}function Qp(e){var t=cTe();return function(){var i=WC(e),n;if(t){var s=WC(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return uTe(this,n)}}var dTe=function(e){Kp(r,e);var t=Qp(r);function r(){return Ds(this,r),t.apply(this,arguments)}return Os(r,[{key:"render",value:function(){return this.props.children}}]),r}(_.Component);function hTe(e,t){var r=e.children,i=e.disabled,n=_.useRef(null),s=_.useRef(null),a=_.useContext(P3),o=typeof r=="function",l=o?r(n):r,c=_.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),d=!o&&_.isValidElement(l)&&gd(l),u=d?l.ref:null,h=C0(u,n),f=function(){var v;return V1(n.current)||(n.current&&vr(n.current)==="object"?V1((v=n.current)===null||v===void 0?void 0:v.nativeElement):null)||V1(s.current)};_.useImperativeHandle(t,function(){return f()});var p=_.useRef(e);p.current=e;var m=_.useCallback(function(g){var v=p.current,y=v.onResize,b=v.data,x=g.getBoundingClientRect(),S=x.width,w=x.height,E=g.offsetWidth,C=g.offsetHeight,T=Math.floor(S),A=Math.floor(w);if(c.current.width!==T||c.current.height!==A||c.current.offsetWidth!==E||c.current.offsetHeight!==C){var M={width:T,height:A,offsetWidth:E,offsetHeight:C};c.current=M;var P=E===Math.round(S)?S:E,I=C===Math.round(w)?w:C,R=_e(_e({},M),{},{offsetWidth:P,offsetHeight:I});a==null||a(R,g,b),y&&Promise.resolve().then(function(){y(R,g)})}},[]);return _.useEffect(function(){var g=f();return g&&!i&&oTe(g,m),function(){return lTe(g,m)}},[n.current,i]),_.createElement(dTe,{ref:s},d?_.cloneElement(l,{ref:h}):l)}var fTe=_.forwardRef(hTe),pTe="rc-observer-key";function mTe(e,t){var r=e.children,i=typeof r=="function"?[r]:Qc(r);return i.map(function(n,s){var a=(n==null?void 0:n.key)||"".concat(pTe,"-").concat(s);return _.createElement(fTe,ae({},e,{key:a,ref:s===0?t:void 0}),n)})}var Zh=_.forwardRef(mTe);Zh.Collection=VAe;function Pa(e,t){var r=_e({},e);return Array.isArray(t)&&t.forEach(function(i){delete r[i]}),r}function R3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function gTe(e){if(Array.isArray(e))return R3(e)}function Hee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pF(e,t){if(e){if(typeof e=="string")return R3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R3(e,t)}}function vTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ft(e){return gTe(e)||Hee(e)||pF(e)||vTe()}var Wee=function(t){return+setTimeout(t,16)},Gee=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(Wee=function(t){return window.requestAnimationFrame(t)},Gee=function(t){return window.cancelAnimationFrame(t)});var F$=0,mF=new Map;function qee(e){mF.delete(e)}var Lr=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;F$+=1;var i=F$;function n(s){if(s===0)qee(i),t();else{var a=Wee(function(){n(s-1)});mF.set(i,a)}}return n(r),i};Lr.cancel=function(e){var t=mF.get(e);return qee(e),Gee(t)};function Xee(e){if(Array.isArray(e))return e}function yTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var i,n,s,a,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=s.call(r)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(d){c=!0,n=d}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw n}}return o}}function Yee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pe(e,t){return Xee(e)||yTe(e,t)||pF(e,t)||Yee()}function GC(e){for(var t=0,r,i=0,n=e.length;n>=4;++i,n-=4)r=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(n){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}function _a(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function bTe(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var r=t;r;){if(r===e)return!0;r=r.parentNode}return!1}var j$="data-rc-order",V$="data-rc-priority",xTe="rc-util-key",D3=new Map;function Kee(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.mark;return t?t.startsWith("data-")?t:"data-".concat(t):xTe}function sM(e){if(e.attachTo)return e.attachTo;var t=document.querySelector("head");return t||document.body}function wTe(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function Qee(e){return Array.from((D3.get(e)||e).children).filter(function(t){return t.tagName==="STYLE"})}function Zee(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!_a())return null;var r=t.csp,i=t.prepend,n=t.priority,s=n===void 0?0:n,a=wTe(i),o=a==="prependQueue",l=document.createElement("style");l.setAttribute(j$,a),o&&s&&l.setAttribute(V$,"".concat(s)),r!=null&&r.nonce&&(l.nonce=r==null?void 0:r.nonce),l.innerHTML=e;var c=sM(t),d=c.firstChild;if(i){if(o){var u=Qee(c).filter(function(h){if(!["prepend","prependQueue"].includes(h.getAttribute(j$)))return!1;var f=Number(h.getAttribute(V$)||0);return s>=f});if(u.length)return c.insertBefore(l,u[u.length-1].nextSibling),l}c.insertBefore(l,d)}else c.appendChild(l);return l}function Jee(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=sM(t);return Qee(r).find(function(i){return i.getAttribute(Kee(t))===e})}function qb(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Jee(e,t);if(r){var i=sM(t);i.removeChild(r)}}function _Te(e,t){var r=D3.get(e);if(!r||!bTe(document,r)){var i=Zee("",t),n=i.parentNode;D3.set(e,n),e.removeChild(i)}}function jh(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=sM(r);_Te(i,r);var n=Jee(t,r);if(n){var s,a;if((s=r.csp)!==null&&s!==void 0&&s.nonce&&n.nonce!==((a=r.csp)===null||a===void 0?void 0:a.nonce)){var o;n.nonce=(o=r.csp)===null||o===void 0?void 0:o.nonce}return n.innerHTML!==e&&(n.innerHTML=e),n}var l=Zee(e,r);return l.setAttribute(Kee(r),t),l}function hr(e,t){if(e==null)return{};var r=ar(e,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function aM(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function n(s,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,l=i.has(s);if(As(!l,"Warning: There may be circular references"),l)return!1;if(s===a)return!0;if(r&&o>1)return!1;i.add(s);var c=o+1;if(Array.isArray(s)){if(!Array.isArray(a)||s.length!==a.length)return!1;for(var d=0;d<s.length;d++)if(!n(s[d],a[d],c))return!1;return!0}if(s&&a&&vr(s)==="object"&&vr(a)==="object"){var u=Object.keys(s);return u.length!==Object.keys(a).length?!1:u.every(function(h){return n(s[h],a[h],c)})}return!1}return n(e,t)}var U$="%",STe=function(){function e(t){Ds(this,e),he(this,"instanceId",void 0),he(this,"cache",new Map),this.instanceId=t}return Os(e,[{key:"get",value:function(r){return this.cache.get(r.join(U$))||null}},{key:"update",value:function(r,i){var n=r.join(U$),s=this.cache.get(n),a=i(s);a===null?this.cache.delete(n):this.cache.set(n,a)}}]),e}(),Uv="data-token-hash",Bl="data-css-hash",sh="__cssinjs_instance__";function ETe(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var t=document.body.querySelectorAll("style[".concat(Bl,"]"))||[],r=document.head.firstChild;Array.from(t).forEach(function(n){n[sh]=n[sh]||e,n[sh]===e&&document.head.insertBefore(n,r)});var i={};Array.from(document.querySelectorAll("style[".concat(Bl,"]"))).forEach(function(n){var s=n.getAttribute(Bl);if(i[s]){if(n[sh]===e){var a;(a=n.parentNode)===null||a===void 0||a.removeChild(n)}}else i[s]=!0})}return new STe(e)}var oM=_.createContext({hashPriority:"low",cache:ETe(),defaultCache:!0});function CTe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}var gF=function(){function e(){Ds(this,e),he(this,"cache",void 0),he(this,"keys",void 0),he(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Os(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(r){var i,n,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a={map:this.cache};return r.forEach(function(o){if(!a)a=void 0;else{var l;a=(l=a)===null||l===void 0||(l=l.map)===null||l===void 0?void 0:l.get(o)}}),(i=a)!==null&&i!==void 0&&i.value&&s&&(a.value[1]=this.cacheCallTimes++),(n=a)===null||n===void 0?void 0:n.value}},{key:"get",value:function(r){var i;return(i=this.internalGet(r,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(r){return!!this.internalGet(r)}},{key:"set",value:function(r,i){var n=this;if(!this.has(r)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var s=this.keys.reduce(function(c,d){var u=Pe(c,2),h=u[1];return n.internalGet(d)[1]<h?[d,n.internalGet(d)[1]]:c},[this.keys[0],this.cacheCallTimes]),a=Pe(s,1),o=a[0];this.delete(o)}this.keys.push(r)}var l=this.cache;r.forEach(function(c,d){if(d===r.length-1)l.set(c,{value:[i,n.cacheCallTimes++]});else{var u=l.get(c);u?u.map||(u.map=new Map):l.set(c,{map:new Map}),l=l.get(c).map}})}},{key:"deleteByPath",value:function(r,i){var n=r.get(i[0]);if(i.length===1){var s;return n.map?r.set(i[0],{map:n.map}):r.delete(i[0]),(s=n.value)===null||s===void 0?void 0:s[0]}var a=this.deleteByPath(n.map,i.slice(1));return(!n.map||n.map.size===0)&&!n.value&&r.delete(i[0]),a}},{key:"delete",value:function(r){if(this.has(r))return this.keys=this.keys.filter(function(i){return!CTe(i,r)}),this.deleteByPath(this.cache,r)}}]),e}();he(gF,"MAX_CACHE_SIZE",20);he(gF,"MAX_CACHE_OFFSET",5);var $$=0,ete=function(){function e(t){Ds(this,e),he(this,"derivatives",void 0),he(this,"id",void 0),this.derivatives=Array.isArray(t)?t:[t],this.id=$$,t.length===0&&(t.length>0,void 0),$$+=1}return Os(e,[{key:"getDerivativeToken",value:function(r){return this.derivatives.reduce(function(i,n){return n(r,i)},void 0)}}]),e}(),lI=new gF;function O3(e){var t=Array.isArray(e)?e:[e];return lI.has(t)||lI.set(t,new ete(t)),lI.get(t)}var ATe=new WeakMap,cI={};function TTe(e,t){for(var r=ATe,i=0;i<t.length;i+=1){var n=t[i];r.has(n)||r.set(n,new WeakMap),r=r.get(n)}return r.has(cI)||r.set(cI,e()),r.get(cI)}var H$=new WeakMap;function U1(e){var t=H$.get(e)||"";return t||(Object.keys(e).forEach(function(r){var i=e[r];t+=r,i instanceof ete?t+=i.id:i&&vr(i)==="object"?t+=U1(i):t+=i}),H$.set(e,t)),t}function W$(e,t){return GC("".concat(t,"_").concat(U1(e)))}var $1="random-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),tte="_bAmBoO_";function MTe(e,t,r){if(_a()){var i,n;jh(e,$1);var s=document.createElement("div");s.style.position="fixed",s.style.left="0",s.style.top="0",t==null||t(s),document.body.appendChild(s);var a=r?r(s):(i=getComputedStyle(s).content)===null||i===void 0?void 0:i.includes(tte);return(n=s.parentNode)===null||n===void 0||n.removeChild(s),qb($1),a}return!1}var uI=void 0;function PTe(){return uI===void 0&&(uI=MTe("@layer ".concat($1," { .").concat($1,' { content: "').concat(tte,'"!important; } }'),function(e){e.className=$1})),uI}var L3=_a();function lt(e){return typeof e=="number"?"".concat(e,"px"):e}function qC(e,t,r){var i,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(s)return e;var a=_e(_e({},n),{},(i={},he(i,Uv,t),he(i,Bl,r),i)),o=Object.keys(a).map(function(l){var c=a[l];return c?"".concat(l,'="').concat(c,'"'):null}).filter(function(l){return l}).join(" ");return"<style ".concat(o,">").concat(e,"</style>")}var rte=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(r?"".concat(r,"-"):"").concat(t).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},ITe=function(t,r,i){return Object.keys(t).length?".".concat(r).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(t).map(function(n){var s=Pe(n,2),a=s[0],o=s[1];return"".concat(a,":").concat(o,";")}).join(""),"}"):""},ite=function(t,r,i){var n={},s={};return Object.entries(t).forEach(function(a){var o,l,c=Pe(a,2),d=c[0],u=c[1];if(i!=null&&(o=i.preserve)!==null&&o!==void 0&&o[d])s[d]=u;else if((typeof u=="string"||typeof u=="number")&&!(i!=null&&(l=i.ignore)!==null&&l!==void 0&&l[d])){var h,f=rte(d,i==null?void 0:i.prefix);n[f]=typeof u=="number"&&!(i!=null&&(h=i.unitless)!==null&&h!==void 0&&h[d])?"".concat(u,"px"):String(u),s[d]="var(".concat(f,")")}}),[s,ITe(n,r,{scope:i==null?void 0:i.scope})]},G$=_a()?_.useLayoutEffect:_.useEffect,mi=function(t,r){var i=_.useRef(!0);G$(function(){return t(i.current)},r),G$(function(){return i.current=!1,function(){i.current=!0}},[])},H1=function(t,r){mi(function(i){if(!i)return t()},r)},RTe=_e({},Zu),q$=RTe.useInsertionEffect,DTe=function(t,r,i){_.useMemo(t,i),mi(function(){return r(!0)},i)},OTe=q$?function(e,t,r){return q$(function(){return e(),t()},r)}:DTe,LTe=_e({},Zu),NTe=LTe.useInsertionEffect,kTe=function(t){var r=[],i=!1;function n(s){i||r.push(s)}return _.useEffect(function(){return i=!1,function(){i=!0,r.length&&r.forEach(function(s){return s()})}},t),n},zTe=function(){return function(t){t()}},BTe=typeof NTe<"u"?kTe:zTe;function vF(e,t,r,i,n){var s=_.useContext(oM),a=s.cache,o=[e].concat(ft(t)),l=o.join("_"),c=BTe([l]),d=function(p){a.update(o,function(m){var g=m||[void 0,void 0],v=Pe(g,2),y=v[0],b=y===void 0?0:y,x=v[1],S=x,w=S||r(),E=[b,w];return p?p(E):E})};_.useMemo(function(){d()},[l]);var u=a.get(o),h=u[1];return OTe(function(){n==null||n(h)},function(f){return d(function(p){var m=Pe(p,2),g=m[0],v=m[1];return f&&g===0&&(n==null||n(h)),[g+1,v]}),function(){a.update(o,function(p){var m=p||[],g=Pe(m,2),v=g[0],y=v===void 0?0:v,b=g[1],x=y-1;return x===0?(c(function(){(f||!a.get(o))&&(i==null||i(b,!1))}),null):[y-1,b]})}},[l]),h}var FTe={},jTe="css",Tf=new Map;function VTe(e){Tf.set(e,(Tf.get(e)||0)+1)}function UTe(e,t){if(typeof document<"u"){var r=document.querySelectorAll("style[".concat(Uv,'="').concat(e,'"]'));r.forEach(function(i){if(i[sh]===t){var n;(n=i.parentNode)===null||n===void 0||n.removeChild(i)}})}}var $Te=0;function HTe(e,t){Tf.set(e,(Tf.get(e)||0)-1);var r=Array.from(Tf.keys()),i=r.filter(function(n){var s=Tf.get(n)||0;return s<=0});r.length-i.length>$Te&&i.forEach(function(n){UTe(n,t),Tf.delete(n)})}var WTe=function(t,r,i,n){var s=i.getDerivativeToken(t),a=_e(_e({},s),r);return n&&(a=n(a)),a},nte="token";function GTe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=_.useContext(oM),n=i.cache.instanceId,s=i.container,a=r.salt,o=a===void 0?"":a,l=r.override,c=l===void 0?FTe:l,d=r.formatToken,u=r.getComputedToken,h=r.cssVar,f=TTe(function(){return Object.assign.apply(Object,[{}].concat(ft(t)))},t),p=U1(f),m=U1(c),g=h?U1(h):"",v=vF(nte,[o,e.id,p,m,g],function(){var y,b=u?u(f,c,e):WTe(f,c,e,d),x=_e({},b),S="";if(h){var w=ite(b,h.key,{prefix:h.prefix,ignore:h.ignore,unitless:h.unitless,preserve:h.preserve}),E=Pe(w,2);b=E[0],S=E[1]}var C=W$(b,o);b._tokenKey=C,x._tokenKey=W$(x,o);var T=(y=h==null?void 0:h.key)!==null&&y!==void 0?y:C;b._themeKey=T,VTe(T);var A="".concat(jTe,"-").concat(GC(C));return b._hashId=A,[b,A,x,S,(h==null?void 0:h.key)||""]},function(y){HTe(y[0]._themeKey,n)},function(y){var b=Pe(y,4),x=b[0],S=b[3];if(h&&S){var w=jh(S,GC("css-variables-".concat(x._themeKey)),{mark:Bl,prepend:"queue",attachTo:s,priority:-999});w[sh]=n,w.setAttribute(Uv,x._themeKey)}});return v}var qTe=function(t,r,i){var n=Pe(t,5),s=n[2],a=n[3],o=n[4],l=i||{},c=l.plain;if(!a)return null;var d=s._tokenKey,u=-999,h={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)},f=qC(a,o,d,h,c);return[u,d,f]},XTe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},X$="data-ant-cssinjs-cache-path",ste="_FILE_STYLE__",np,ate=!0;function YTe(){if(!np&&(np={},_a())){var e=document.createElement("div");e.className=X$,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var t=getComputedStyle(e).content||"";t=t.replace(/^"/,"").replace(/"$/,""),t.split(";").forEach(function(n){var s=n.split(":"),a=Pe(s,2),o=a[0],l=a[1];np[o]=l});var r=document.querySelector("style[".concat(X$,"]"));if(r){var i;ate=!1,(i=r.parentNode)===null||i===void 0||i.removeChild(r)}document.body.removeChild(e)}}function KTe(e){return YTe(),!!np[e]}function QTe(e){var t=np[e],r=null;if(t&&_a())if(ate)r=ste;else{var i=document.querySelector("style[".concat(Bl,'="').concat(np[e],'"]'));i?r=i.innerHTML:delete np[e]}return[r,t]}var ZTe="_skip_check_",ote="_multi_value_";function N3(e){var t=ip(BJ(e),FJ);return t.replace(/\{%%%\:[^;];}/g,";")}function JTe(e){return vr(e)==="object"&&e&&(ZTe in e||ote in e)}function e2e(e,t,r){if(!t)return e;var i=".".concat(t),n=r==="low"?":where(".concat(i,")"):i,s=e.split(",").map(function(a){var o,l=a.trim().split(/\s+/),c=l[0]||"",d=((o=c.match(/^\w+/))===null||o===void 0?void 0:o[0])||"";return c="".concat(d).concat(n).concat(c.slice(d.length)),[c].concat(ft(l.slice(1))).join(" ")});return s.join(",")}var t2e=function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},n=i.root,s=i.injectHash,a=i.parentSelectors,o=r.hashId,l=r.layer;r.path;var c=r.hashPriority,d=r.transformers,u=d===void 0?[]:d;r.linters;var h="",f={};function p(b){var x=b.getName(o);if(!f[x]){var S=e(b.style,r,{root:!1,parentSelectors:a}),w=Pe(S,1),E=w[0];f[x]="@keyframes ".concat(b.getName(o)).concat(E)}}function m(b){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return b.forEach(function(S){Array.isArray(S)?m(S,x):S&&x.push(S)}),x}var g=m(Array.isArray(t)?t:[t]);if(g.forEach(function(b){var x=typeof b=="string"&&!n?{}:b;if(typeof x=="string")h+="".concat(x,`
`);else if(x._keyframe)p(x);else{var S=u.reduce(function(w,E){var C;return(E==null||(C=E.visit)===null||C===void 0?void 0:C.call(E,w))||w},x);Object.keys(S).forEach(function(w){var E=S[w];if(vr(E)==="object"&&E&&(w!=="animationName"||!E._keyframe)&&!JTe(E)){var C=!1,T=w.trim(),A=!1;(n||s)&&o?T.startsWith("@")?C=!0:T=e2e(w,o,c):n&&!o&&(T==="&"||T==="")&&(T="",A=!0);var M=e(E,r,{root:A,injectHash:C,parentSelectors:[].concat(ft(a),[T])}),P=Pe(M,2),I=P[0],R=P[1];f=_e(_e({},f),R),h+="".concat(T).concat(I)}else{let O=function(D,B){var z=D.replace(/[A-Z]/g,function(V){return"-".concat(V.toLowerCase())}),F=B;!XTe[D]&&typeof F=="number"&&F!==0&&(F="".concat(F,"px")),D==="animationName"&&B!==null&&B!==void 0&&B._keyframe&&(p(B),F=B.getName(o)),h+="".concat(z,":").concat(F,";")};var N,k=(N=E==null?void 0:E.value)!==null&&N!==void 0?N:E;vr(E)==="object"&&E!==null&&E!==void 0&&E[ote]&&Array.isArray(k)?k.forEach(function(D){O(w,D)}):O(w,k)}})}}),!n)h="{".concat(h,"}");else if(l&&PTe()){var v=l.split(","),y=v[v.length-1].trim();h="@layer ".concat(y," {").concat(h,"}"),v.length>1&&(h="@layer ".concat(l,"{%%%:%}").concat(h))}return[h,f]};function lte(e,t){return GC("".concat(e.join("%")).concat(t))}function r2e(){return null}var cte="style";function k3(e,t){var r=e.token,i=e.path,n=e.hashId,s=e.layer,a=e.nonce,o=e.clientOnly,l=e.order,c=l===void 0?0:l,d=_.useContext(oM),u=d.autoClear;d.mock;var h=d.defaultCache,f=d.hashPriority,p=d.container,m=d.ssrInline,g=d.transformers,v=d.linters,y=d.cache,b=r._tokenKey,x=[b].concat(ft(i)),S=L3,w=vF(cte,x,function(){var M=x.join("|");if(KTe(M)){var P=QTe(M),I=Pe(P,2),R=I[0],N=I[1];if(R)return[R,b,N,{},o,c]}var k=t(),O=t2e(k,{hashId:n,hashPriority:f,layer:s,path:i.join("-"),transformers:g,linters:v}),D=Pe(O,2),B=D[0],z=D[1],F=N3(B),V=lte(x,F);return[F,b,V,z,o,c]},function(M,P){var I=Pe(M,3),R=I[2];(P||u)&&L3&&qb(R,{mark:Bl})},function(M){var P=Pe(M,4),I=P[0];P[1];var R=P[2],N=P[3];if(S&&I!==ste){var k={mark:Bl,prepend:"queue",attachTo:p,priority:c},O=typeof a=="function"?a():a;O&&(k.csp={nonce:O});var D=jh(I,R,k);D[sh]=y.instanceId,D.setAttribute(Uv,b),Object.keys(N).forEach(function(B){jh(N3(N[B]),"_effect-".concat(B),k)})}}),E=Pe(w,3),C=E[0],T=E[1],A=E[2];return function(M){var P;if(!m||S||!h)P=_.createElement(r2e,null);else{var I;P=_.createElement("style",ae({},(I={},he(I,Uv,T),he(I,Bl,A),I),{dangerouslySetInnerHTML:{__html:C}}))}return _.createElement(_.Fragment,null,P,M)}}var i2e=function(t,r,i){var n=Pe(t,6),s=n[0],a=n[1],o=n[2],l=n[3],c=n[4],d=n[5],u=i||{},h=u.plain;if(c)return null;var f=s,p={"data-rc-order":"prependQueue","data-rc-priority":"".concat(d)};return f=qC(s,a,o,p,h),l&&Object.keys(l).forEach(function(m){if(!r[m]){r[m]=!0;var g=N3(l[m]);f+=qC(g,a,"_effect-".concat(m),p,h)}}),[d,o,f]},ute="cssVar",n2e=function(t,r){var i=t.key,n=t.prefix,s=t.unitless,a=t.ignore,o=t.token,l=t.scope,c=l===void 0?"":l,d=_.useContext(oM),u=d.cache.instanceId,h=d.container,f=o._tokenKey,p=[].concat(ft(t.path),[i,c,f]),m=vF(ute,p,function(){var g=r(),v=ite(g,i,{prefix:n,unitless:s,ignore:a,scope:c}),y=Pe(v,2),b=y[0],x=y[1],S=lte(p,x);return[b,x,S,i]},function(g){var v=Pe(g,3),y=v[2];L3&&qb(y,{mark:Bl})},function(g){var v=Pe(g,3),y=v[1],b=v[2];if(y){var x=jh(y,b,{mark:Bl,prepend:"queue",attachTo:h,priority:-999});x[sh]=u,x.setAttribute(Uv,i)}});return m},s2e=function(t,r,i){var n=Pe(t,4),s=n[1],a=n[2],o=n[3],l=i||{},c=l.plain;if(!s)return null;var d=-999,u={"data-rc-order":"prependQueue","data-rc-priority":"".concat(d)},h=qC(s,o,a,u,c);return[d,a,h]},py;py={},he(py,cte,i2e),he(py,nte,qTe),he(py,ute,s2e);var Rr=function(){function e(t,r){Ds(this,e),he(this,"name",void 0),he(this,"style",void 0),he(this,"_keyframe",!0),this.name=t,this.style=r}return Os(e,[{key:"getName",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return r?"".concat(r,"-").concat(this.name):this.name}}]),e}();function ym(e){return e.notSplit=!0,e}ym(["borderTop","borderBottom"]),ym(["borderTop"]),ym(["borderBottom"]),ym(["borderLeft","borderRight"]),ym(["borderLeft"]),ym(["borderRight"]);var a2e=_.createContext({});const yF=a2e;function dte(e){return Xee(e)||Hee(e)||pF(e)||Yee()}function Rc(e,t){for(var r=e,i=0;i<t.length;i+=1){if(r==null)return;r=r[t[i]]}return r}function hte(e,t,r,i){if(!t.length)return r;var n=dte(t),s=n[0],a=n.slice(1),o;return!e&&typeof s=="number"?o=[]:Array.isArray(e)?o=ft(e):o=_e({},e),i&&r===void 0&&a.length===1?delete o[s][a[0]]:o[s]=hte(o[s],a,r,i),o}function El(e,t,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.length&&i&&r===void 0&&!Rc(e,t.slice(0,-1))?e:hte(e,t,r,i)}function o2e(e){return vr(e)==="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function Y$(e){return Array.isArray(e)?[]:{}}var l2e=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function zg(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=Y$(t[0]);return t.forEach(function(n){function s(a,o){var l=new Set(o),c=Rc(n,a),d=Array.isArray(c);if(d||o2e(c)){if(!l.has(c)){l.add(c);var u=Rc(i,a);d?i=El(i,a,[]):(!u||vr(u)!=="object")&&(i=El(i,a,Y$(c))),l2e(c).forEach(function(h){s([].concat(ft(a),[h]),l)})}}else i=El(i,a,c)}s([])}),i}function c2e(){}const u2e=_.createContext({}),rw=()=>{const e=()=>{};return e.deprecated=c2e,e},fte=_.createContext(void 0);var d2e={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},h2e={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};const f2e={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},pte=f2e,p2e={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},h2e),timePickerLocale:Object.assign({},pte)},K$=p2e,to="${label} is not a valid ${type}",m2e={locale:"en",Pagination:d2e,DatePicker:K$,TimePicker:pte,Calendar:K$,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:to,method:to,array:to,object:to,number:to,date:to,boolean:to,integer:to,float:to,regexp:to,email:to,url:to,hex:to},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"},ColorPicker:{presetEmpty:"Empty"}},Rp=m2e;Object.assign({},Rp.Modal);let pE=[];const Q$=()=>pE.reduce((e,t)=>Object.assign(Object.assign({},e),t),Rp.Modal);function g2e(e){if(e){const t=Object.assign({},e);return pE.push(t),Q$(),()=>{pE=pE.filter(r=>r!==t),Q$()}}Object.assign({},Rp.Modal)}const v2e=_.createContext(void 0),bF=v2e,y2e=(e,t)=>{const r=_.useContext(bF),i=_.useMemo(()=>{var s;const a=t||Rp[e],o=(s=r==null?void 0:r[e])!==null&&s!==void 0?s:{};return Object.assign(Object.assign({},typeof a=="function"?a():a),o||{})},[e,t,r]),n=_.useMemo(()=>{const s=r==null?void 0:r.locale;return r!=null&&r.exist&&!s?Rp.locale:s},[r]);return[i,n]},mte=y2e,b2e="internalMark",x2e=e=>{const{locale:t={},children:r,_ANT_MARK__:i}=e;_.useEffect(()=>g2e(t&&t.Modal),[t]);const n=_.useMemo(()=>Object.assign(Object.assign({},t),{exist:!0}),[t]);return _.createElement(bF.Provider,{value:n},r)},w2e=x2e;function Ts(e,t){_2e(e)&&(e="100%");var r=S2e(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function l_(e){return Math.min(1,Math.max(0,e))}function _2e(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function S2e(e){return typeof e=="string"&&e.indexOf("%")!==-1}function gte(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function c_(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Ff(e){return e.length===1?"0"+e:String(e)}function E2e(e,t,r){return{r:Ts(e,255)*255,g:Ts(t,255)*255,b:Ts(r,255)*255}}function Z$(e,t,r){e=Ts(e,255),t=Ts(t,255),r=Ts(r,255);var i=Math.max(e,t,r),n=Math.min(e,t,r),s=0,a=0,o=(i+n)/2;if(i===n)a=0,s=0;else{var l=i-n;switch(a=o>.5?l/(2-i-n):l/(i+n),i){case e:s=(t-r)/l+(t<r?6:0);break;case t:s=(r-e)/l+2;break;case r:s=(e-t)/l+4;break}s/=6}return{h:s,s:a,l:o}}function dI(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*(6*r):r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function C2e(e,t,r){var i,n,s;if(e=Ts(e,360),t=Ts(t,100),r=Ts(r,100),t===0)n=r,s=r,i=r;else{var a=r<.5?r*(1+t):r+t-r*t,o=2*r-a;i=dI(o,a,e+1/3),n=dI(o,a,e),s=dI(o,a,e-1/3)}return{r:i*255,g:n*255,b:s*255}}function z3(e,t,r){e=Ts(e,255),t=Ts(t,255),r=Ts(r,255);var i=Math.max(e,t,r),n=Math.min(e,t,r),s=0,a=i,o=i-n,l=i===0?0:o/i;if(i===n)s=0;else{switch(i){case e:s=(t-r)/o+(t<r?6:0);break;case t:s=(r-e)/o+2;break;case r:s=(e-t)/o+4;break}s/=6}return{h:s,s:l,v:a}}function A2e(e,t,r){e=Ts(e,360)*6,t=Ts(t,100),r=Ts(r,100);var i=Math.floor(e),n=e-i,s=r*(1-t),a=r*(1-n*t),o=r*(1-(1-n)*t),l=i%6,c=[r,a,s,s,o,r][l],d=[o,r,r,a,s,s][l],u=[s,s,o,r,r,a][l];return{r:c*255,g:d*255,b:u*255}}function B3(e,t,r,i){var n=[Ff(Math.round(e).toString(16)),Ff(Math.round(t).toString(16)),Ff(Math.round(r).toString(16))];return i&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function T2e(e,t,r,i,n){var s=[Ff(Math.round(e).toString(16)),Ff(Math.round(t).toString(16)),Ff(Math.round(r).toString(16)),Ff(M2e(i))];return n&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function M2e(e){return Math.round(parseFloat(e)*255).toString(16)}function J$(e){return so(e)/255}function so(e){return parseInt(e,16)}function P2e(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var F3={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function pg(e){var t={r:0,g:0,b:0},r=1,i=null,n=null,s=null,a=!1,o=!1;return typeof e=="string"&&(e=D2e(e)),typeof e=="object"&&(lu(e.r)&&lu(e.g)&&lu(e.b)?(t=E2e(e.r,e.g,e.b),a=!0,o=String(e.r).substr(-1)==="%"?"prgb":"rgb"):lu(e.h)&&lu(e.s)&&lu(e.v)?(i=c_(e.s),n=c_(e.v),t=A2e(e.h,i,n),a=!0,o="hsv"):lu(e.h)&&lu(e.s)&&lu(e.l)&&(i=c_(e.s),s=c_(e.l),t=C2e(e.h,i,s),a=!0,o="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=gte(r),{ok:a,format:e.format||o,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}var I2e="[-\\+]?\\d+%?",R2e="[-\\+]?\\d*\\.\\d+%?",ah="(?:".concat(R2e,")|(?:").concat(I2e,")"),hI="[\\s|\\(]+(".concat(ah,")[,|\\s]+(").concat(ah,")[,|\\s]+(").concat(ah,")\\s*\\)?"),fI="[\\s|\\(]+(".concat(ah,")[,|\\s]+(").concat(ah,")[,|\\s]+(").concat(ah,")[,|\\s]+(").concat(ah,")\\s*\\)?"),xl={CSS_UNIT:new RegExp(ah),rgb:new RegExp("rgb"+hI),rgba:new RegExp("rgba"+fI),hsl:new RegExp("hsl"+hI),hsla:new RegExp("hsla"+fI),hsv:new RegExp("hsv"+hI),hsva:new RegExp("hsva"+fI),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function D2e(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(F3[e])e=F3[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r=xl.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=xl.rgba.exec(e),r?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=xl.hsl.exec(e),r?{h:r[1],s:r[2],l:r[3]}:(r=xl.hsla.exec(e),r?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=xl.hsv.exec(e),r?{h:r[1],s:r[2],v:r[3]}:(r=xl.hsva.exec(e),r?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=xl.hex8.exec(e),r?{r:so(r[1]),g:so(r[2]),b:so(r[3]),a:J$(r[4]),format:t?"name":"hex8"}:(r=xl.hex6.exec(e),r?{r:so(r[1]),g:so(r[2]),b:so(r[3]),format:t?"name":"hex"}:(r=xl.hex4.exec(e),r?{r:so(r[1]+r[1]),g:so(r[2]+r[2]),b:so(r[3]+r[3]),a:J$(r[4]+r[4]),format:t?"name":"hex8"}:(r=xl.hex3.exec(e),r?{r:so(r[1]+r[1]),g:so(r[2]+r[2]),b:so(r[3]+r[3]),format:t?"name":"hex"}:!1)))))))))}function lu(e){return!!xl.CSS_UNIT.exec(String(e))}var Bn=function(){function e(t,r){t===void 0&&(t=""),r===void 0&&(r={});var i;if(t instanceof e)return t;typeof t=="number"&&(t=P2e(t)),this.originalInput=t;var n=pg(t);this.originalInput=t,this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this.roundA=Math.round(100*this.a)/100,this.format=(i=r.format)!==null&&i!==void 0?i:n.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=n.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),r,i,n,s=t.r/255,a=t.g/255,o=t.b/255;return s<=.03928?r=s/12.92:r=Math.pow((s+.055)/1.055,2.4),a<=.03928?i=a/12.92:i=Math.pow((a+.055)/1.055,2.4),o<=.03928?n=o/12.92:n=Math.pow((o+.055)/1.055,2.4),.2126*r+.7152*i+.0722*n},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=gte(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=z3(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=z3(this.r,this.g,this.b),r=Math.round(t.h*360),i=Math.round(t.s*100),n=Math.round(t.v*100);return this.a===1?"hsv(".concat(r,", ").concat(i,"%, ").concat(n,"%)"):"hsva(".concat(r,", ").concat(i,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=Z$(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=Z$(this.r,this.g,this.b),r=Math.round(t.h*360),i=Math.round(t.s*100),n=Math.round(t.l*100);return this.a===1?"hsl(".concat(r,", ").concat(i,"%, ").concat(n,"%)"):"hsla(".concat(r,", ").concat(i,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),B3(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),T2e(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),r=Math.round(this.g),i=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(r,", ").concat(i,")"):"rgba(".concat(t,", ").concat(r,", ").concat(i,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(r){return"".concat(Math.round(Ts(r,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(r){return Math.round(Ts(r,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+B3(this.r,this.g,this.b,!1),r=0,i=Object.entries(F3);r<i.length;r++){var n=i[r],s=n[0],a=n[1];if(t===a)return s}return!1},e.prototype.toString=function(t){var r=!!t;t=t??this.format;var i=!1,n=this.a<1&&this.a>=0,s=!r&&n&&(t.startsWith("hex")||t==="name");return s?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(i=this.toRgbString()),t==="prgb"&&(i=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(i=this.toHexString()),t==="hex3"&&(i=this.toHexString(!0)),t==="hex4"&&(i=this.toHex8String(!0)),t==="hex8"&&(i=this.toHex8String()),t==="name"&&(i=this.toName()),t==="hsl"&&(i=this.toHslString()),t==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=l_(r.l),new e(r)},e.prototype.brighten=function(t){t===void 0&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(t/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(t/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(t/100)))),new e(r)},e.prototype.darken=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=l_(r.l),new e(r)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=l_(r.s),new e(r)},e.prototype.saturate=function(t){t===void 0&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=l_(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),i=(r.h+t)%360;return r.h=i<0?360+i:i,new e(r)},e.prototype.mix=function(t,r){r===void 0&&(r=50);var i=this.toRgb(),n=new e(t).toRgb(),s=r/100,a={r:(n.r-i.r)*s+i.r,g:(n.g-i.g)*s+i.g,b:(n.b-i.b)*s+i.b,a:(n.a-i.a)*s+i.a};return new e(a)},e.prototype.analogous=function(t,r){t===void 0&&(t=6),r===void 0&&(r=30);var i=this.toHsl(),n=360/r,s=[this];for(i.h=(i.h-(n*t>>1)+720)%360;--t;)i.h=(i.h+n)%360,s.push(new e(i));return s},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var r=this.toHsv(),i=r.h,n=r.s,s=r.v,a=[],o=1/t;t--;)a.push(new e({h:i,s:n,v:s})),s=(s+o)%1;return a},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),i=new e(t).toRgb(),n=r.a+i.a*(1-r.a);return new e({r:(r.r*r.a+i.r*i.a*(1-r.a))/n,g:(r.g*r.a+i.g*i.a*(1-r.a))/n,b:(r.b*r.a+i.b*i.a*(1-r.a))/n,a:n})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),i=r.h,n=[this],s=360/t,a=1;a<t;a++)n.push(new e({h:(i+a*s)%360,s:r.s,l:r.l}));return n},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}(),u_=2,e6=.16,O2e=.05,L2e=.05,N2e=.15,vte=5,yte=4,k2e=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function t6(e){var t=e.r,r=e.g,i=e.b,n=z3(t,r,i);return{h:n.h*360,s:n.s,v:n.v}}function d_(e){var t=e.r,r=e.g,i=e.b;return"#".concat(B3(t,r,i,!1))}function z2e(e,t,r){var i=r/100,n={r:(t.r-e.r)*i+e.r,g:(t.g-e.g)*i+e.g,b:(t.b-e.b)*i+e.b};return n}function r6(e,t,r){var i;return Math.round(e.h)>=60&&Math.round(e.h)<=240?i=r?Math.round(e.h)-u_*t:Math.round(e.h)+u_*t:i=r?Math.round(e.h)+u_*t:Math.round(e.h)-u_*t,i<0?i+=360:i>=360&&(i-=360),i}function i6(e,t,r){if(e.h===0&&e.s===0)return e.s;var i;return r?i=e.s-e6*t:t===yte?i=e.s+e6:i=e.s+O2e*t,i>1&&(i=1),r&&t===vte&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function n6(e,t,r){var i;return r?i=e.v+L2e*t:i=e.v-N2e*t,i>1&&(i=1),Number(i.toFixed(2))}function Dp(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[],i=pg(e),n=vte;n>0;n-=1){var s=t6(i),a=d_(pg({h:r6(s,n,!0),s:i6(s,n,!0),v:n6(s,n,!0)}));r.push(a)}r.push(d_(i));for(var o=1;o<=yte;o+=1){var l=t6(i),c=d_(pg({h:r6(l,o),s:i6(l,o),v:n6(l,o)}));r.push(c)}return t.theme==="dark"?k2e.map(function(d){var u=d.index,h=d.opacity,f=d_(z2e(pg(t.backgroundColor||"#141414"),pg(r[u]),h*100));return f}):r}var pI={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},mE={},mI={};Object.keys(pI).forEach(function(e){mE[e]=Dp(pI[e]),mE[e].primary=mE[e][5],mI[e]=Dp(pI[e],{theme:"dark",backgroundColor:"#141414"}),mI[e].primary=mI[e][5]});var B2e=mE.blue;const F2e=e=>{const{controlHeight:t}=e;return{controlHeightSM:t*.75,controlHeightXS:t*.5,controlHeightLG:t*1.25}},j2e=F2e;function V2e(e){const{sizeUnit:t,sizeStep:r}=e;return{sizeXXL:t*(r+8),sizeXL:t*(r+4),sizeLG:t*(r+2),sizeMD:t*(r+1),sizeMS:t*r,size:t*r,sizeSM:t*(r-1),sizeXS:t*(r-2),sizeXXS:t*(r-3)}}const bte={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},U2e=Object.assign(Object.assign({},bte),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),Xb=U2e;function $2e(e,t){let{generateColorPalettes:r,generateNeutralColorPalettes:i}=t;const{colorSuccess:n,colorWarning:s,colorError:a,colorInfo:o,colorPrimary:l,colorBgBase:c,colorTextBase:d}=e,u=r(l),h=r(n),f=r(s),p=r(a),m=r(o),g=i(c,d),v=e.colorLink||e.colorInfo,y=r(v);return Object.assign(Object.assign({},g),{colorPrimaryBg:u[1],colorPrimaryBgHover:u[2],colorPrimaryBorder:u[3],colorPrimaryBorderHover:u[4],colorPrimaryHover:u[5],colorPrimary:u[6],colorPrimaryActive:u[7],colorPrimaryTextHover:u[8],colorPrimaryText:u[9],colorPrimaryTextActive:u[10],colorSuccessBg:h[1],colorSuccessBgHover:h[2],colorSuccessBorder:h[3],colorSuccessBorderHover:h[4],colorSuccessHover:h[4],colorSuccess:h[6],colorSuccessActive:h[7],colorSuccessTextHover:h[8],colorSuccessText:h[9],colorSuccessTextActive:h[10],colorErrorBg:p[1],colorErrorBgHover:p[2],colorErrorBorder:p[3],colorErrorBorderHover:p[4],colorErrorHover:p[5],colorError:p[6],colorErrorActive:p[7],colorErrorTextHover:p[8],colorErrorText:p[9],colorErrorTextActive:p[10],colorWarningBg:f[1],colorWarningBgHover:f[2],colorWarningBorder:f[3],colorWarningBorderHover:f[4],colorWarningHover:f[4],colorWarning:f[6],colorWarningActive:f[7],colorWarningTextHover:f[8],colorWarningText:f[9],colorWarningTextActive:f[10],colorInfoBg:m[1],colorInfoBgHover:m[2],colorInfoBorder:m[3],colorInfoBorderHover:m[4],colorInfoHover:m[4],colorInfo:m[6],colorInfoActive:m[7],colorInfoTextHover:m[8],colorInfoText:m[9],colorInfoTextActive:m[10],colorLinkHover:y[4],colorLink:y[6],colorLinkActive:y[7],colorBgMask:new Bn("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const H2e=e=>{let t=e,r=e,i=e,n=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?r=4:e<8&&e>=7?r=5:e<14&&e>=8?r=6:e<16&&e>=14?r=7:e>=16&&(r=8),e<6&&e>=2?i=1:e>=6&&(i=2),e>4&&e<8?n=4:e>=8&&(n=6),{borderRadius:e,borderRadiusXS:i,borderRadiusSM:r,borderRadiusLG:t,borderRadiusOuter:n}},W2e=H2e;function G2e(e){const{motionUnit:t,motionBase:r,borderRadius:i,lineWidth:n}=e;return Object.assign({motionDurationFast:`${(r+t).toFixed(1)}s`,motionDurationMid:`${(r+t*2).toFixed(1)}s`,motionDurationSlow:`${(r+t*3).toFixed(1)}s`,lineWidthBold:n+1},W2e(i))}const cu=(e,t)=>new Bn(e).setAlpha(t).toRgbString(),my=(e,t)=>new Bn(e).darken(t).toHexString(),q2e=e=>{const t=Dp(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}},X2e=(e,t)=>{const r=e||"#fff",i=t||"#000";return{colorBgBase:r,colorTextBase:i,colorText:cu(i,.88),colorTextSecondary:cu(i,.65),colorTextTertiary:cu(i,.45),colorTextQuaternary:cu(i,.25),colorFill:cu(i,.15),colorFillSecondary:cu(i,.06),colorFillTertiary:cu(i,.04),colorFillQuaternary:cu(i,.02),colorBgLayout:my(r,4),colorBgContainer:my(r,0),colorBgElevated:my(r,0),colorBgSpotlight:cu(i,.85),colorBgBlur:"transparent",colorBorder:my(r,15),colorBorderSecondary:my(r,6)}};function Y2e(e){const t=new Array(10).fill(null).map((r,i)=>{const n=i-1,s=e*Math.pow(2.71828,n/5),a=i>1?Math.floor(s):Math.ceil(s);return Math.floor(a/2)*2});return t[1]=e,t.map(r=>{const i=r+8;return{size:r,lineHeight:i/r}})}const K2e=e=>{const t=Y2e(e),r=t.map(d=>d.size),i=t.map(d=>d.lineHeight),n=r[1],s=r[0],a=r[2],o=i[1],l=i[0],c=i[2];return{fontSizeSM:s,fontSize:n,fontSizeLG:a,fontSizeXL:r[3],fontSizeHeading1:r[6],fontSizeHeading2:r[5],fontSizeHeading3:r[4],fontSizeHeading4:r[3],fontSizeHeading5:r[2],lineHeight:o,lineHeightLG:c,lineHeightSM:l,fontHeight:Math.round(o*n),fontHeightLG:Math.round(c*a),fontHeightSM:Math.round(l*s),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}},Q2e=K2e;function Z2e(e){const t=Object.keys(bte).map(r=>{const i=Dp(e[r]);return new Array(10).fill(1).reduce((n,s,a)=>(n[`${r}-${a+1}`]=i[a],n[`${r}${a+1}`]=i[a],n),{})}).reduce((r,i)=>(r=Object.assign(Object.assign({},r),i),r),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),$2e(e,{generateColorPalettes:q2e,generateNeutralColorPalettes:X2e})),Q2e(e.fontSize)),V2e(e)),j2e(e)),G2e(e))}const xte=O3(Z2e),wte={token:Xb,override:{override:Xb},hashed:!0},_te=Ge.createContext(wte),xF="anticon",J2e=(e,t)=>t||(e?`ant-${e}`:"ant"),br=_.createContext({getPrefixCls:J2e,iconPrefixCls:xF}),eMe=`-ant-${Date.now()}-${Math.random()}`;function tMe(e,t){const r={},i=(a,o)=>{let l=a.clone();return l=(o==null?void 0:o(l))||l,l.toRgbString()},n=(a,o)=>{const l=new Bn(a),c=Dp(l.toRgbString());r[`${o}-color`]=i(l),r[`${o}-color-disabled`]=c[1],r[`${o}-color-hover`]=c[4],r[`${o}-color-active`]=c[6],r[`${o}-color-outline`]=l.clone().setAlpha(.2).toRgbString(),r[`${o}-color-deprecated-bg`]=c[0],r[`${o}-color-deprecated-border`]=c[2]};if(t.primaryColor){n(t.primaryColor,"primary");const a=new Bn(t.primaryColor),o=Dp(a.toRgbString());o.forEach((c,d)=>{r[`primary-${d+1}`]=c}),r["primary-color-deprecated-l-35"]=i(a,c=>c.lighten(35)),r["primary-color-deprecated-l-20"]=i(a,c=>c.lighten(20)),r["primary-color-deprecated-t-20"]=i(a,c=>c.tint(20)),r["primary-color-deprecated-t-50"]=i(a,c=>c.tint(50)),r["primary-color-deprecated-f-12"]=i(a,c=>c.setAlpha(c.getAlpha()*.12));const l=new Bn(o[0]);r["primary-color-active-deprecated-f-30"]=i(l,c=>c.setAlpha(c.getAlpha()*.3)),r["primary-color-active-deprecated-d-02"]=i(l,c=>c.darken(2))}return t.successColor&&n(t.successColor,"success"),t.warningColor&&n(t.warningColor,"warning"),t.errorColor&&n(t.errorColor,"error"),t.infoColor&&n(t.infoColor,"info"),`
  :root {
    ${Object.keys(r).map(a=>`--${e}-${a}: ${r[a]};`).join(`
`)}
  }
  `.trim()}function rMe(e,t){const r=tMe(e,t);_a()&&jh(r,`${eMe}-dynamic-theme`)}const j3=_.createContext(!1),Ste=e=>{let{children:t,disabled:r}=e;const i=_.useContext(j3);return _.createElement(j3.Provider,{value:r??i},t)},Jh=j3,V3=_.createContext(void 0),iMe=e=>{let{children:t,size:r}=e;const i=_.useContext(V3);return _.createElement(V3.Provider,{value:r||i},t)},iw=V3;function nMe(){const e=_.useContext(Jh),t=_.useContext(iw);return{componentDisabled:e,componentSize:t}}const Yb=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],sMe="5.12.8";function gI(e){return e>=0&&e<=255}function h_(e,t){const{r,g:i,b:n,a:s}=new Bn(e).toRgb();if(s<1)return e;const{r:a,g:o,b:l}=new Bn(t).toRgb();for(let c=.01;c<=1;c+=.01){const d=Math.round((r-a*(1-c))/c),u=Math.round((i-o*(1-c))/c),h=Math.round((n-l*(1-c))/c);if(gI(d)&&gI(u)&&gI(h))return new Bn({r:d,g:u,b:h,a:Math.round(c*100)/100}).toRgbString()}return new Bn({r,g:i,b:n,a:1}).toRgbString()}var aMe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function Ete(e){const{override:t}=e,r=aMe(e,["override"]),i=Object.assign({},t);Object.keys(Xb).forEach(h=>{delete i[h]});const n=Object.assign(Object.assign({},r),i),s=480,a=576,o=768,l=992,c=1200,d=1600;if(n.motion===!1){const h="0s";n.motionDurationFast=h,n.motionDurationMid=h,n.motionDurationSlow=h}return Object.assign(Object.assign(Object.assign({},n),{colorFillContent:n.colorFillSecondary,colorFillContentHover:n.colorFill,colorFillAlter:n.colorFillQuaternary,colorBgContainerDisabled:n.colorFillTertiary,colorBorderBg:n.colorBgContainer,colorSplit:h_(n.colorBorderSecondary,n.colorBgContainer),colorTextPlaceholder:n.colorTextQuaternary,colorTextDisabled:n.colorTextQuaternary,colorTextHeading:n.colorText,colorTextLabel:n.colorTextSecondary,colorTextDescription:n.colorTextTertiary,colorTextLightSolid:n.colorWhite,colorHighlight:n.colorError,colorBgTextHover:n.colorFillSecondary,colorBgTextActive:n.colorFill,colorIcon:n.colorTextTertiary,colorIconHover:n.colorText,colorErrorOutline:h_(n.colorErrorBg,n.colorBgContainer),colorWarningOutline:h_(n.colorWarningBg,n.colorBgContainer),fontSizeIcon:n.fontSizeSM,lineWidthFocus:n.lineWidth*4,lineWidth:n.lineWidth,controlOutlineWidth:n.lineWidth*2,controlInteractiveSize:n.controlHeight/2,controlItemBgHover:n.colorFillTertiary,controlItemBgActive:n.colorPrimaryBg,controlItemBgActiveHover:n.colorPrimaryBgHover,controlItemBgActiveDisabled:n.colorFill,controlTmpOutline:n.colorFillQuaternary,controlOutline:h_(n.colorPrimaryBg,n.colorBgContainer),lineType:n.lineType,borderRadius:n.borderRadius,borderRadiusXS:n.borderRadiusXS,borderRadiusSM:n.borderRadiusSM,borderRadiusLG:n.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:n.sizeXXS,paddingXS:n.sizeXS,paddingSM:n.sizeSM,padding:n.size,paddingMD:n.sizeMD,paddingLG:n.sizeLG,paddingXL:n.sizeXL,paddingContentHorizontalLG:n.sizeLG,paddingContentVerticalLG:n.sizeMS,paddingContentHorizontal:n.sizeMS,paddingContentVertical:n.sizeSM,paddingContentHorizontalSM:n.size,paddingContentVerticalSM:n.sizeXS,marginXXS:n.sizeXXS,marginXS:n.sizeXS,marginSM:n.sizeSM,margin:n.size,marginMD:n.sizeMD,marginLG:n.sizeLG,marginXL:n.sizeXL,marginXXL:n.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:s,screenXSMin:s,screenXSMax:a-1,screenSM:a,screenSMMin:a,screenSMMax:o-1,screenMD:o,screenMDMin:o,screenMDMax:l-1,screenLG:l,screenLGMin:l,screenLGMax:c-1,screenXL:c,screenXLMin:c,screenXLMax:d-1,screenXXL:d,screenXXLMin:d,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Bn("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Bn("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Bn("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var s6=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Cte={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0},Ate={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},oMe={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},Tte=(e,t,r)=>{const i=r.getDerivativeToken(e),{override:n}=t,s=s6(t,["override"]);let a=Object.assign(Object.assign({},i),{override:n});return a=Ete(a),s&&Object.entries(s).forEach(o=>{let[l,c]=o;const{theme:d}=c,u=s6(c,["theme"]);let h=u;d&&(h=Tte(Object.assign(Object.assign({},a),u),{override:u},d)),a[l]=h}),a};function ia(){const{token:e,hashed:t,theme:r,override:i,cssVar:n}=Ge.useContext(_te),s=`${sMe}-${t||""}`,a=r||xte,[o,l,c]=GTe(a,[Xb,e],{salt:s,override:i,getComputedToken:Tte,formatToken:Ete,cssVar:n&&{prefix:n.prefix,key:n.key,unitless:Cte,ignore:Ate,preserve:oMe}});return[a,c,t?l:"",o,n]}function ma(e){var t=_.useRef();t.current=e;var r=_.useCallback(function(){for(var i,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(s))},[]);return r}function sp(e){var t=_.useRef(!1),r=_.useState(e),i=Pe(r,2),n=i[0],s=i[1];_.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function a(o,l){l&&t.current||s(o)}return[n,a]}function vI(e){return e!==void 0}function Ka(e,t){var r=t||{},i=r.defaultValue,n=r.value,s=r.onChange,a=r.postState,o=sp(function(){return vI(n)?n:vI(i)?typeof i=="function"?i():i:typeof e=="function"?e():e}),l=Pe(o,2),c=l[0],d=l[1],u=n!==void 0?n:c,h=a?a(u):u,f=ma(s),p=sp([u]),m=Pe(p,2),g=m[0],v=m[1];H1(function(){var b=g[0];c!==b&&f(c,b)},[g]),H1(function(){vI(n)||d(n)},[n]);var y=ma(function(b,x){d(b,x),v([u],x)});return[h,y]}const XC={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},Vn=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:t?"inherit":e.fontFamily}},nw=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),U3=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),lMe=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active,\n  &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),cMe=(e,t)=>{const{fontFamily:r,fontSize:i}=e,n=`[class^="${t}"], [class*=" ${t}"]`;return{[n]:{fontFamily:r,fontSize:i,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[n]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},wF=e=>({outline:`${lt(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),$3=e=>({"&:focus-visible":Object.assign({},wF(e))});let uMe=Os(function e(){Ds(this,e)});const Mte=uMe;let dMe=function(e){Kp(r,e);var t=Qp(r);function r(i){var n;return Ds(this,r),n=t.call(this),n.result=0,i instanceof r?n.result=i.result:typeof i=="number"&&(n.result=i),n}return Os(r,[{key:"add",value:function(n){return n instanceof r?this.result+=n.result:typeof n=="number"&&(this.result+=n),this}},{key:"sub",value:function(n){return n instanceof r?this.result-=n.result:typeof n=="number"&&(this.result-=n),this}},{key:"mul",value:function(n){return n instanceof r?this.result*=n.result:typeof n=="number"&&(this.result*=n),this}},{key:"div",value:function(n){return n instanceof r?this.result/=n.result:typeof n=="number"&&(this.result/=n),this}},{key:"equal",value:function(){return this.result}}]),r}(Mte);const Pte="CALC_UNIT";function yI(e){return typeof e=="number"?`${e}${Pte}`:e}let hMe=function(e){Kp(r,e);var t=Qp(r);function r(i){var n;return Ds(this,r),n=t.call(this),n.result="",i instanceof r?n.result=`(${i.result})`:typeof i=="number"?n.result=yI(i):typeof i=="string"&&(n.result=i),n}return Os(r,[{key:"add",value:function(n){return n instanceof r?this.result=`${this.result} + ${n.getResult()}`:(typeof n=="number"||typeof n=="string")&&(this.result=`${this.result} + ${yI(n)}`),this.lowPriority=!0,this}},{key:"sub",value:function(n){return n instanceof r?this.result=`${this.result} - ${n.getResult()}`:(typeof n=="number"||typeof n=="string")&&(this.result=`${this.result} - ${yI(n)}`),this.lowPriority=!0,this}},{key:"mul",value:function(n){return this.lowPriority&&(this.result=`(${this.result})`),n instanceof r?this.result=`${this.result} * ${n.getResult(!0)}`:(typeof n=="number"||typeof n=="string")&&(this.result=`${this.result} * ${n}`),this.lowPriority=!1,this}},{key:"div",value:function(n){return this.lowPriority&&(this.result=`(${this.result})`),n instanceof r?this.result=`${this.result} / ${n.getResult(!0)}`:(typeof n=="number"||typeof n=="string")&&(this.result=`${this.result} / ${n}`),this.lowPriority=!1,this}},{key:"getResult",value:function(n){return this.lowPriority||n?`(${this.result})`:this.result}},{key:"equal",value:function(n){const{unit:s=!0}=n||{},a=new RegExp(`${Pte}`,"g");return this.result=this.result.replace(a,s?"px":""),typeof this.lowPriority<"u"?`calc(${this.result})`:this.result}}]),r}(Mte);const fMe=e=>{const t=e==="css"?hMe:dMe;return r=>new t(r)},pMe=fMe;function mMe(e){return e==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return`max(${r.map(n=>lt(n)).join(",")})`},min:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return`min(${r.map(n=>lt(n)).join(",")})`}}}const Ite=typeof CSSINJS_STATISTIC<"u";let H3=!0;function zr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!Ite)return Object.assign.apply(Object,[{}].concat(t));H3=!1;const i={};return t.forEach(n=>{Object.keys(n).forEach(a=>{Object.defineProperty(i,a,{configurable:!0,enumerable:!0,get:()=>n[a]})})}),H3=!0,i}const a6={};function gMe(){}const vMe=e=>{let t,r=e,i=gMe;return Ite&&typeof Proxy<"u"&&(t=new Set,r=new Proxy(e,{get(n,s){return H3&&t.add(s),n[s]}}),i=(n,s)=>{var a;a6[n]={global:Array.from(t),component:Object.assign(Object.assign({},(a=a6[n])===null||a===void 0?void 0:a.component),s)}}),{token:r,keys:t,flush:i}},yMe=(e,t)=>{const[r,i]=ia();return k3({theme:r,token:i,hashId:"",path:["ant-design-icons",e],nonce:()=>t==null?void 0:t.nonce},()=>[{[`.${e}`]:Object.assign(Object.assign({},nw()),{[`.${e} .${e}-icon`]:{display:"block"}})}])},Rte=yMe,Dte=(e,t,r)=>{var i;return typeof r=="function"?r(zr(t,(i=t[e])!==null&&i!==void 0?i:{})):r??{}},Ote=(e,t,r,i)=>{const n=Object.assign({},t[e]);if(i!=null&&i.deprecatedTokens){const{deprecatedTokens:a}=i;a.forEach(o=>{let[l,c]=o;var d;(n!=null&&n[l]||n!=null&&n[c])&&((d=n[c])!==null&&d!==void 0||(n[c]=n==null?void 0:n[l]))})}let s=Object.assign(Object.assign({},r),n);return i!=null&&i.format&&(s=i.format(s)),Object.keys(s).forEach(a=>{s[a]===t[a]&&delete s[a]}),s},bMe=(e,t)=>`${[t,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-")}`;function _F(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const n=Array.isArray(e)?e:[e,e],[s]=n,a=n.join("-");return o=>{const[l,c,d,u,h]=ia(),{getPrefixCls:f,iconPrefixCls:p,csp:m}=_.useContext(br),g=f(),v=h?"css":"js",y=pMe(v),{max:b,min:x}=mMe(v),S={theme:l,token:u,hashId:d,nonce:()=>m==null?void 0:m.nonce,clientOnly:i.clientOnly,order:i.order||-999};return k3(Object.assign(Object.assign({},S),{clientOnly:!1,path:["Shared",g]}),()=>[{"&":lMe(u)}]),Rte(p,m),[k3(Object.assign(Object.assign({},S),{path:[a,o,p]}),()=>{if(i.injectStyle===!1)return[];const{token:E,flush:C}=vMe(u),T=Dte(s,c,r),A=`.${o}`,M=Ote(s,c,T,{deprecatedTokens:i.deprecatedTokens,format:i.format});h&&Object.keys(T).forEach(R=>{T[R]=`var(${rte(R,bMe(s,h.prefix))})`});const P=zr(E,{componentCls:A,prefixCls:o,iconCls:`.${p}`,antCls:`.${g}`,calc:y,max:b,min:x},h?T:M),I=t(P,{hashId:d,prefixCls:o,rootPrefixCls:g,iconPrefixCls:p});return C(s,M),[i.resetStyle===!1?null:cMe(P,o),I]}),d]}}const SF=(e,t,r,i)=>{const n=_F(e,t,r,Object.assign({resetStyle:!1,order:-998},i));return a=>{let{prefixCls:o}=a;return n(o),null}},xMe=(e,t,r)=>{function i(c){return`${e}${c.slice(0,1).toUpperCase()}${c.slice(1)}`}const{unitless:n={},injectStyle:s=!0}=r??{},a={[i("zIndexPopup")]:!0};Object.keys(n).forEach(c=>{a[i(c)]=n[c]});const o=c=>{let{rootCls:d,cssVar:u}=c;const[,h]=ia();return n2e({path:[e],prefix:u.prefix,key:u==null?void 0:u.key,unitless:Object.assign(Object.assign({},Cte),a),ignore:Ate,token:h,scope:d},()=>{const f=Dte(e,h,t),p=Ote(e,h,f,{format:r==null?void 0:r.format,deprecatedTokens:r==null?void 0:r.deprecatedTokens});return Object.keys(f).forEach(m=>{p[i(m)]=p[m],delete p[m]}),p}),null};return c=>{const[,,,,d]=ia();return[u=>s&&d?Ge.createElement(Ge.Fragment,null,Ge.createElement(o,{rootCls:c,cssVar:d,component:e}),u):u,d==null?void 0:d.key]}},sa=(e,t,r,i)=>{const n=_F(e,t,r,i),s=xMe(Array.isArray(e)?e[0]:e,r,i);return function(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a;const[,l]=n(a),[c,d]=s(o);return[c,l,d]}};function wMe(e,t){return Yb.reduce((r,i)=>{const n=e[`${i}1`],s=e[`${i}3`],a=e[`${i}6`],o=e[`${i}7`];return Object.assign(Object.assign({},r),t(i,{lightColor:n,lightBorderColor:s,darkColor:a,textColor:o}))},{})}const _Me=Object.assign({},Zu),{useId:o6}=_Me,SMe=()=>"",EMe=typeof o6>"u"?SMe:o6,CMe=EMe;function AMe(e,t){rw();const r=e||{},i=r.inherit===!1||!t?wte:t,n=CMe();return tw(()=>{var s,a;if(!e)return t;const o=Object.assign({},i.components);Object.keys(e.components||{}).forEach(d=>{o[d]=Object.assign(Object.assign({},o[d]),e.components[d])});const l=`css-var-${n.replace(/:/g,"")}`,c=((s=r.cssVar)!==null&&s!==void 0?s:i.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:"ant"},typeof i.cssVar=="object"?i.cssVar:{}),typeof r.cssVar=="object"?r.cssVar:{}),{key:typeof r.cssVar=="object"&&((a=r.cssVar)===null||a===void 0?void 0:a.key)||l});return Object.assign(Object.assign(Object.assign({},i),r),{token:Object.assign(Object.assign({},i.token),r.token),components:o,cssVar:c})},[r,i],(s,a)=>s.some((o,l)=>{const c=a[l];return!aM(o,c,!0)}))}var TMe=["children"],Lte=_.createContext({});function MMe(e){var t=e.children,r=hr(e,TMe);return _.createElement(Lte.Provider,{value:r},t)}var PMe=function(e){Kp(r,e);var t=Qp(r);function r(){return Ds(this,r),t.apply(this,arguments)}return Os(r,[{key:"render",value:function(){return this.props.children}}]),r}(_.Component),xf="none",f_="appear",p_="enter",m_="leave",l6="none",Cl="prepare",Bg="start",Fg="active",EF="end",Nte="prepared";function c6(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit".concat(e)]="webkit".concat(t),r["Moz".concat(e)]="moz".concat(t),r["ms".concat(e)]="MS".concat(t),r["O".concat(e)]="o".concat(t.toLowerCase()),r}function IMe(e,t){var r={animationend:c6("Animation","AnimationEnd"),transitionend:c6("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete r.animationend.animation,"TransitionEvent"in t||delete r.transitionend.transition),r}var RMe=IMe(_a(),typeof window<"u"?window:{}),kte={};if(_a()){var DMe=document.createElement("div");kte=DMe.style}var g_={};function zte(e){if(g_[e])return g_[e];var t=RMe[e];if(t)for(var r=Object.keys(t),i=r.length,n=0;n<i;n+=1){var s=r[n];if(Object.prototype.hasOwnProperty.call(t,s)&&s in kte)return g_[e]=t[s],g_[e]}return""}var Bte=zte("animationend"),Fte=zte("transitionend"),jte=!!(Bte&&Fte),u6=Bte||"animationend",d6=Fte||"transitionend";function h6(e,t){if(!e)return null;if(vr(e)==="object"){var r=t.replace(/-\w/g,function(i){return i[1].toUpperCase()});return e[r]}return"".concat(e,"-").concat(t)}const OMe=function(e){var t=_.useRef(),r=_.useRef(e);r.current=e;var i=_.useCallback(function(a){r.current(a)},[]);function n(a){a&&(a.removeEventListener(d6,i),a.removeEventListener(u6,i))}function s(a){t.current&&t.current!==a&&n(t.current),a&&a!==t.current&&(a.addEventListener(d6,i),a.addEventListener(u6,i),t.current=a)}return _.useEffect(function(){return function(){n(t.current)}},[]),[s,n]};var Vte=_a()?_.useLayoutEffect:_.useEffect;const LMe=function(){var e=_.useRef(null);function t(){Lr.cancel(e.current)}function r(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;t();var s=Lr(function(){n<=1?i({isCanceled:function(){return s!==e.current}}):r(i,n-1)});e.current=s}return _.useEffect(function(){return function(){t()}},[]),[r,t]};var NMe=[Cl,Bg,Fg,EF],kMe=[Cl,Nte],Ute=!1,zMe=!0;function $te(e){return e===Fg||e===EF}const BMe=function(e,t,r){var i=sp(l6),n=Pe(i,2),s=n[0],a=n[1],o=LMe(),l=Pe(o,2),c=l[0],d=l[1];function u(){a(Cl,!0)}var h=t?kMe:NMe;return Vte(function(){if(s!==l6&&s!==EF){var f=h.indexOf(s),p=h[f+1],m=r(s);m===Ute?a(p,!0):p&&c(function(g){function v(){g.isCanceled()||a(p,!0)}m===!0?v():Promise.resolve(m).then(v)})}},[e,s]),_.useEffect(function(){return function(){d()}},[]),[u,s]};function FMe(e,t,r,i){var n=i.motionEnter,s=n===void 0?!0:n,a=i.motionAppear,o=a===void 0?!0:a,l=i.motionLeave,c=l===void 0?!0:l,d=i.motionDeadline,u=i.motionLeaveImmediately,h=i.onAppearPrepare,f=i.onEnterPrepare,p=i.onLeavePrepare,m=i.onAppearStart,g=i.onEnterStart,v=i.onLeaveStart,y=i.onAppearActive,b=i.onEnterActive,x=i.onLeaveActive,S=i.onAppearEnd,w=i.onEnterEnd,E=i.onLeaveEnd,C=i.onVisibleChanged,T=sp(),A=Pe(T,2),M=A[0],P=A[1],I=sp(xf),R=Pe(I,2),N=R[0],k=R[1],O=sp(null),D=Pe(O,2),B=D[0],z=D[1],F=_.useRef(!1),V=_.useRef(null);function Y(){return r()}var W=_.useRef(!1);function X(){k(xf,!0),z(null,!0)}function H(de){var be=Y();if(!(de&&!de.deadline&&de.target!==be)){var ye=W.current,q;N===f_&&ye?q=S==null?void 0:S(be,de):N===p_&&ye?q=w==null?void 0:w(be,de):N===m_&&ye&&(q=E==null?void 0:E(be,de)),N!==xf&&ye&&q!==!1&&X()}}var ie=OMe(H),Q=Pe(ie,1),Z=Q[0],ee=function(be){var ye,q,U;switch(be){case f_:return ye={},he(ye,Cl,h),he(ye,Bg,m),he(ye,Fg,y),ye;case p_:return q={},he(q,Cl,f),he(q,Bg,g),he(q,Fg,b),q;case m_:return U={},he(U,Cl,p),he(U,Bg,v),he(U,Fg,x),U;default:return{}}},re=_.useMemo(function(){return ee(N)},[N]),ne=BMe(N,!e,function(de){if(de===Cl){var be=re[Cl];return be?be(Y()):Ute}if(me in re){var ye;z(((ye=re[me])===null||ye===void 0?void 0:ye.call(re,Y(),null))||null)}return me===Fg&&(Z(Y()),d>0&&(clearTimeout(V.current),V.current=setTimeout(function(){H({deadline:!0})},d))),me===Nte&&X(),zMe}),se=Pe(ne,2),fe=se[0],me=se[1],Oe=$te(me);W.current=Oe,Vte(function(){P(t);var de=F.current;F.current=!0;var be;!de&&t&&o&&(be=f_),de&&t&&s&&(be=p_),(de&&!t&&c||!de&&u&&!t&&c)&&(be=m_);var ye=ee(be);be&&(e||ye[Cl])?(k(be),fe()):k(xf)},[t]),_.useEffect(function(){(N===f_&&!o||N===p_&&!s||N===m_&&!c)&&k(xf)},[o,s,c]),_.useEffect(function(){return function(){F.current=!1,clearTimeout(V.current)}},[]);var Ee=_.useRef(!1);_.useEffect(function(){M&&(Ee.current=!0),M!==void 0&&N===xf&&((Ee.current||M)&&(C==null||C(M)),Ee.current=!0)},[M,N]);var Se=B;return re[Cl]&&me===Bg&&(Se=_e({transition:"none"},Se)),[N,me,Se,M??t]}function jMe(e){var t=e;vr(e)==="object"&&(t=e.transitionSupport);function r(n,s){return!!(n.motionName&&t&&s!==!1)}var i=_.forwardRef(function(n,s){var a=n.visible,o=a===void 0?!0:a,l=n.removeOnLeave,c=l===void 0?!0:l,d=n.forceRender,u=n.children,h=n.motionName,f=n.leavedClassName,p=n.eventProps,m=_.useContext(Lte),g=m.motion,v=r(n,g),y=_.useRef(),b=_.useRef();function x(){try{return y.current instanceof HTMLElement?y.current:V1(b.current)}catch{return null}}var S=FMe(v,o,x,n),w=Pe(S,4),E=w[0],C=w[1],T=w[2],A=w[3],M=_.useRef(A);A&&(M.current=!0);var P=_.useCallback(function(z){y.current=z,fF(s,z)},[s]),I,R=_e(_e({},p),{},{visible:o});if(!u)I=null;else if(E===xf)A?I=u(_e({},R),P):!c&&M.current&&f?I=u(_e(_e({},R),{},{className:f}),P):d||!c&&!f?I=u(_e(_e({},R),{},{style:{display:"none"}}),P):I=null;else{var N,k;C===Cl?k="prepare":$te(C)?k="active":C===Bg&&(k="start");var O=h6(h,"".concat(E,"-").concat(k));I=u(_e(_e({},R),{},{className:Fe(h6(h,E),(N={},he(N,O,O&&k),he(N,h,typeof h=="string"),N)),style:T}),P)}if(_.isValidElement(I)&&gd(I)){var D=I,B=D.ref;B||(I=_.cloneElement(I,{ref:P}))}return _.createElement(PMe,{ref:b},I)});return i.displayName="CSSMotion",i}const Zp=jMe(jte);var W3="add",G3="keep",q3="remove",bI="removed";function VMe(e){var t;return e&&vr(e)==="object"&&"key"in e?t=e:t={key:e},_e(_e({},t),{},{key:String(t.key)})}function X3(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(VMe)}function UMe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=[],i=0,n=t.length,s=X3(e),a=X3(t);s.forEach(function(c){for(var d=!1,u=i;u<n;u+=1){var h=a[u];if(h.key===c.key){i<u&&(r=r.concat(a.slice(i,u).map(function(f){return _e(_e({},f),{},{status:W3})})),i=u),r.push(_e(_e({},h),{},{status:G3})),i+=1,d=!0;break}}d||r.push(_e(_e({},c),{},{status:q3}))}),i<n&&(r=r.concat(a.slice(i).map(function(c){return _e(_e({},c),{},{status:W3})})));var o={};r.forEach(function(c){var d=c.key;o[d]=(o[d]||0)+1});var l=Object.keys(o).filter(function(c){return o[c]>1});return l.forEach(function(c){r=r.filter(function(d){var u=d.key,h=d.status;return u!==c||h!==q3}),r.forEach(function(d){d.key===c&&(d.status=G3)})}),r}var $Me=["component","children","onVisibleChanged","onAllRemoved"],HMe=["status"],WMe=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function GMe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zp,r=function(i){Kp(s,i);var n=Qp(s);function s(){var a;Ds(this,s);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return a=n.call.apply(n,[this].concat(l)),he(Nr(a),"state",{keyEntities:[]}),he(Nr(a),"removeKey",function(d){var u=a.state.keyEntities,h=u.map(function(f){return f.key!==d?f:_e(_e({},f),{},{status:bI})});return a.setState({keyEntities:h}),h.filter(function(f){var p=f.status;return p!==bI}).length}),a}return Os(s,[{key:"render",value:function(){var o=this,l=this.state.keyEntities,c=this.props,d=c.component,u=c.children,h=c.onVisibleChanged,f=c.onAllRemoved,p=hr(c,$Me),m=d||_.Fragment,g={};return WMe.forEach(function(v){g[v]=p[v],delete p[v]}),delete p.keys,_.createElement(m,p,l.map(function(v,y){var b=v.status,x=hr(v,HMe),S=b===W3||b===G3;return _.createElement(t,ae({},g,{key:x.key,visible:S,eventProps:x,onVisibleChanged:function(E){if(h==null||h(E,{key:x.key}),!E){var C=o.removeKey(x.key);C===0&&f&&f()}}}),function(w,E){return u(_e(_e({},w),{},{index:y}),E)})}))}}],[{key:"getDerivedStateFromProps",value:function(o,l){var c=o.keys,d=l.keyEntities,u=X3(c),h=UMe(d,u);return{keyEntities:h.filter(function(f){var p=d.find(function(m){var g=m.key;return f.key===g});return!(p&&p.status===bI&&f.status===q3)})}}}]),s}(_.Component);return he(r,"defaultProps",{component:"div"}),r}const Hte=GMe(jte);function qMe(e){const{children:t}=e,[,r]=ia(),{motion:i}=r,n=_.useRef(!1);return n.current=n.current||i===!1,n.current?_.createElement(MMe,{motion:i},t):t}const XMe=()=>null;var YMe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const KMe=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select","button"],QMe="ant";let YC,Wte,Gte;function gE(){return YC||QMe}function ZMe(){return Wte||xF}function JMe(e){return Object.keys(e).some(t=>t.endsWith("Color"))}const ePe=e=>{let{prefixCls:t,iconPrefixCls:r,theme:i}=e;t!==void 0&&(YC=t),r!==void 0&&(Wte=r),i&&(JMe(i)?rMe(gE(),i):Gte=i)},qte=()=>({getPrefixCls:(e,t)=>t||(e?`${gE()}-${e}`:gE()),getIconPrefixCls:ZMe,getRootPrefixCls:()=>YC||gE(),getTheme:()=>Gte}),tPe=e=>{const{children:t,csp:r,autoInsertSpaceInButton:i,alert:n,anchor:s,form:a,locale:o,componentSize:l,direction:c,space:d,virtual:u,dropdownMatchSelectWidth:h,popupMatchSelectWidth:f,popupOverflow:p,legacyLocale:m,parentContext:g,iconPrefixCls:v,theme:y,componentDisabled:b,segmented:x,statistic:S,spin:w,calendar:E,carousel:C,cascader:T,collapse:A,typography:M,checkbox:P,descriptions:I,divider:R,drawer:N,skeleton:k,steps:O,image:D,layout:B,list:z,mentions:F,modal:V,progress:Y,result:W,slider:X,breadcrumb:H,menu:ie,pagination:Q,input:Z,empty:ee,badge:re,radio:ne,rate:se,switch:fe,transfer:me,avatar:Oe,message:Ee,tag:Se,table:de,card:be,tabs:ye,timeline:q,timePicker:U,upload:ce,notification:xe,tree:j,colorPicker:Be,datePicker:ze,rangePicker:Ve,flex:pe,wave:Me,dropdown:Ue,warning:Re}=e,et=_.useCallback((He,gt)=>{const{prefixCls:ot}=e;if(gt)return gt;const at=ot||g.getPrefixCls("");return He?`${at}-${He}`:at},[g.getPrefixCls,e.prefixCls]),Xe=v||g.iconPrefixCls||xF,Ze=r||g.csp;Rte(Xe,Ze);const Mt=AMe(y,g.theme),Gt={csp:Ze,autoInsertSpaceInButton:i,alert:n,anchor:s,locale:o||m,direction:c,space:d,virtual:u,popupMatchSelectWidth:f??h,popupOverflow:p,getPrefixCls:et,iconPrefixCls:Xe,theme:Mt,segmented:x,statistic:S,spin:w,calendar:E,carousel:C,cascader:T,collapse:A,typography:M,checkbox:P,descriptions:I,divider:R,drawer:N,skeleton:k,steps:O,image:D,input:Z,layout:B,list:z,mentions:F,modal:V,progress:Y,result:W,slider:X,breadcrumb:H,menu:ie,pagination:Q,empty:ee,badge:re,radio:ne,rate:se,switch:fe,transfer:me,avatar:Oe,message:Ee,tag:Se,table:de,card:be,tabs:ye,timeline:q,timePicker:U,upload:ce,notification:xe,tree:j,colorPicker:Be,datePicker:ze,rangePicker:Ve,flex:pe,wave:Me,dropdown:Ue,warning:Re},ue=Object.assign({},g);Object.keys(Gt).forEach(He=>{Gt[He]!==void 0&&(ue[He]=Gt[He])}),KMe.forEach(He=>{const gt=e[He];gt&&(ue[He]=gt)});const Ae=tw(()=>ue,ue,(He,gt)=>{const ot=Object.keys(He),at=Object.keys(gt);return ot.length!==at.length||ot.some(Qe=>He[Qe]!==gt[Qe])}),ke=_.useMemo(()=>({prefixCls:Xe,csp:Ze}),[Xe,Ze]);let Ie=_.createElement(_.Fragment,null,_.createElement(XMe,{dropdownMatchSelectWidth:h}),t);const $e=_.useMemo(()=>{var He,gt,ot,at;return zg(((He=Rp.Form)===null||He===void 0?void 0:He.defaultValidateMessages)||{},((ot=(gt=Ae.locale)===null||gt===void 0?void 0:gt.Form)===null||ot===void 0?void 0:ot.defaultValidateMessages)||{},((at=Ae.form)===null||at===void 0?void 0:at.validateMessages)||{},(a==null?void 0:a.validateMessages)||{})},[Ae,a==null?void 0:a.validateMessages]);Object.keys($e).length>0&&(Ie=_.createElement(fte.Provider,{value:$e},Ie)),o&&(Ie=_.createElement(w2e,{locale:o,_ANT_MARK__:b2e},Ie)),(Xe||Ze)&&(Ie=_.createElement(yF.Provider,{value:ke},Ie)),l&&(Ie=_.createElement(iMe,{size:l},Ie)),Ie=_.createElement(qMe,null,Ie);const tt=_.useMemo(()=>{const He=Mt||{},{algorithm:gt,token:ot,components:at,cssVar:Qe}=He,ut=YMe(He,["algorithm","token","components","cssVar"]),yt=gt&&(!Array.isArray(gt)||gt.length>0)?O3(gt):xte,xt={};Object.entries(at||{}).forEach(Jt=>{let[te,we]=Jt;const Te=Object.assign({},we);"algorithm"in Te&&(Te.algorithm===!0?Te.theme=yt:(Array.isArray(Te.algorithm)||typeof Te.algorithm=="function")&&(Te.theme=O3(Te.algorithm)),delete Te.algorithm),xt[te]=Te});const or=Object.assign(Object.assign({},Xb),ot);return Object.assign(Object.assign({},ut),{theme:yt,token:or,components:xt,override:Object.assign({override:or},xt),cssVar:Qe})},[Mt]);return y&&(Ie=_.createElement(_te.Provider,{value:tt},Ie)),Ae.warning&&(Ie=_.createElement(u2e.Provider,{value:Ae.warning},Ie)),b!==void 0&&(Ie=_.createElement(Ste,{disabled:b},Ie)),_.createElement(br.Provider,{value:Ae},Ie)},A0=e=>{const t=_.useContext(br),r=_.useContext(bF);return _.createElement(tPe,Object.assign({parentContext:t,legacyLocale:r},e))};A0.ConfigContext=br;A0.SizeContext=iw;A0.config=ePe;A0.useConfig=nMe;Object.defineProperty(A0,"SizeContext",{get:()=>iw});const lM=A0;var rPe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};const iPe=rPe;function Xte(e){var t;return e==null||(t=e.getRootNode)===null||t===void 0?void 0:t.call(e)}function nPe(e){return Xte(e)instanceof ShadowRoot}function KC(e){return nPe(e)?Xte(e):null}function sPe(e){return e.replace(/-(.)/g,function(t,r){return r.toUpperCase()})}function aPe(e,t){As(e,"[@ant-design/icons] ".concat(t))}function f6(e){return vr(e)==="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(vr(e.icon)==="object"||typeof e.icon=="function")}function p6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(t,r){var i=e[r];switch(r){case"class":t.className=i,delete t.class;break;default:delete t[r],t[sPe(r)]=i}return t},{})}function Y3(e,t,r){return r?Ge.createElement(e.tag,_e(_e({key:t},p6(e.attrs)),r),(e.children||[]).map(function(i,n){return Y3(i,"".concat(t,"-").concat(e.tag,"-").concat(n))})):Ge.createElement(e.tag,_e({key:t},p6(e.attrs)),(e.children||[]).map(function(i,n){return Y3(i,"".concat(t,"-").concat(e.tag,"-").concat(n))}))}function Yte(e){return Dp(e)[0]}function Kte(e){return e?Array.isArray(e)?e:[e]:[]}var oPe=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,lPe=function(t){var r=_.useContext(yF),i=r.csp,n=r.prefixCls,s=oPe;n&&(s=s.replace(/anticon/g,n)),_.useEffect(function(){var a=t.current,o=KC(a);jh(s,"@ant-design-icons",{prepend:!0,csp:i,attachTo:o})},[])},cPe=["icon","className","onClick","style","primaryColor","secondaryColor"],W1={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function uPe(e){var t=e.primaryColor,r=e.secondaryColor;W1.primaryColor=t,W1.secondaryColor=r||Yte(t),W1.calculated=!!r}function dPe(){return _e({},W1)}var cM=function(t){var r=t.icon,i=t.className,n=t.onClick,s=t.style,a=t.primaryColor,o=t.secondaryColor,l=hr(t,cPe),c=_.useRef(),d=W1;if(a&&(d={primaryColor:a,secondaryColor:o||Yte(a)}),lPe(c),aPe(f6(r),"icon should be icon definiton, but got ".concat(r)),!f6(r))return null;var u=r;return u&&typeof u.icon=="function"&&(u=_e(_e({},u),{},{icon:u.icon(d.primaryColor,d.secondaryColor)})),Y3(u.icon,"svg-".concat(u.name),_e(_e({className:i,onClick:n,style:s,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},l),{},{ref:c}))};cM.displayName="IconReact";cM.getTwoToneColors=dPe;cM.setTwoToneColors=uPe;const CF=cM;function Qte(e){var t=Kte(e),r=Pe(t,2),i=r[0],n=r[1];return CF.setTwoToneColors({primaryColor:i,secondaryColor:n})}function hPe(){var e=CF.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var fPe=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];Qte(B2e.primary);var uM=_.forwardRef(function(e,t){var r,i=e.className,n=e.icon,s=e.spin,a=e.rotate,o=e.tabIndex,l=e.onClick,c=e.twoToneColor,d=hr(e,fPe),u=_.useContext(yF),h=u.prefixCls,f=h===void 0?"anticon":h,p=u.rootClassName,m=Fe(p,f,(r={},he(r,"".concat(f,"-").concat(n.name),!!n.name),he(r,"".concat(f,"-spin"),!!s||n.name==="loading"),r),i),g=o;g===void 0&&l&&(g=-1);var v=a?{msTransform:"rotate(".concat(a,"deg)"),transform:"rotate(".concat(a,"deg)")}:void 0,y=Kte(c),b=Pe(y,2),x=b[0],S=b[1];return _.createElement("span",ae({role:"img","aria-label":n.name},d,{ref:t,tabIndex:g,onClick:l,className:m}),_.createElement(CF,{icon:n,primaryColor:x,secondaryColor:S,style:v}))});uM.displayName="AntdIcon";uM.getTwoToneColor=hPe;uM.setTwoToneColor=Qte;const Ia=uM;var pPe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:iPe}))};const Zte=_.forwardRef(pPe);var mPe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};const gPe=mPe;var vPe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:gPe}))};const sw=_.forwardRef(vPe);var yPe={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"};const bPe=yPe;var xPe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:bPe}))};const Jte=_.forwardRef(xPe);var wPe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"};const _Pe=wPe;var SPe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:_Pe}))};const ere=_.forwardRef(SPe);var EPe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"};const CPe=EPe;var APe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:CPe}))};const TPe=_.forwardRef(APe);var MPe=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,PPe=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,IPe="".concat(MPe," ").concat(PPe).split(/[\s\n]+/),RPe="aria-",DPe="data-";function m6(e,t){return e.indexOf(t)===0}function QC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r;t===!1?r={aria:!0,data:!0,attr:!0}:t===!0?r={aria:!0}:r=_e({},t);var i={};return Object.keys(e).forEach(function(n){(r.aria&&(n==="role"||m6(n,RPe))||r.data&&m6(n,DPe)||r.attr&&IPe.includes(n))&&(i[n]=e[n])}),i}const{isValidElement:Gl}=Zu;function tre(e){return e&&Gl(e)&&e.type===_.Fragment}function OPe(e,t,r){return Gl(e)?_.cloneElement(e,typeof r=="function"?r(e.props||{}):r):t}function nl(e,t){return OPe(e,e,t)}const g6=e=>typeof e=="object"&&e!=null&&e.nodeType===1,v6=(e,t)=>(!t||e!=="hidden")&&e!=="visible"&&e!=="clip",xI=(e,t)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){const r=getComputedStyle(e,null);return v6(r.overflowY,t)||v6(r.overflowX,t)||(i=>{const n=(s=>{if(!s.ownerDocument||!s.ownerDocument.defaultView)return null;try{return s.ownerDocument.defaultView.frameElement}catch{return null}})(i);return!!n&&(n.clientHeight<i.scrollHeight||n.clientWidth<i.scrollWidth)})(e)}return!1},v_=(e,t,r,i,n,s,a,o)=>s<e&&a>t||s>e&&a<t?0:s<=e&&o<=r||a>=t&&o>=r?s-e-i:a>t&&o<r||s<e&&o>r?a-t+n:0,LPe=e=>{const t=e.parentElement;return t??(e.getRootNode().host||null)},y6=(e,t)=>{var r,i,n,s;if(typeof document>"u")return[];const{scrollMode:a,block:o,inline:l,boundary:c,skipOverflowHiddenElements:d}=t,u=typeof c=="function"?c:k=>k!==c;if(!g6(e))throw new TypeError("Invalid target");const h=document.scrollingElement||document.documentElement,f=[];let p=e;for(;g6(p)&&u(p);){if(p=LPe(p),p===h){f.push(p);break}p!=null&&p===document.body&&xI(p)&&!xI(document.documentElement)||p!=null&&xI(p,d)&&f.push(p)}const m=(i=(r=window.visualViewport)==null?void 0:r.width)!=null?i:innerWidth,g=(s=(n=window.visualViewport)==null?void 0:n.height)!=null?s:innerHeight,{scrollX:v,scrollY:y}=window,{height:b,width:x,top:S,right:w,bottom:E,left:C}=e.getBoundingClientRect(),{top:T,right:A,bottom:M,left:P}=(k=>{const O=window.getComputedStyle(k);return{top:parseFloat(O.scrollMarginTop)||0,right:parseFloat(O.scrollMarginRight)||0,bottom:parseFloat(O.scrollMarginBottom)||0,left:parseFloat(O.scrollMarginLeft)||0}})(e);let I=o==="start"||o==="nearest"?S-T:o==="end"?E+M:S+b/2-T+M,R=l==="center"?C+x/2-P+A:l==="end"?w+A:C-P;const N=[];for(let k=0;k<f.length;k++){const O=f[k],{height:D,width:B,top:z,right:F,bottom:V,left:Y}=O.getBoundingClientRect();if(a==="if-needed"&&S>=0&&C>=0&&E<=g&&w<=m&&S>=z&&E<=V&&C>=Y&&w<=F)return N;const W=getComputedStyle(O),X=parseInt(W.borderLeftWidth,10),H=parseInt(W.borderTopWidth,10),ie=parseInt(W.borderRightWidth,10),Q=parseInt(W.borderBottomWidth,10);let Z=0,ee=0;const re="offsetWidth"in O?O.offsetWidth-O.clientWidth-X-ie:0,ne="offsetHeight"in O?O.offsetHeight-O.clientHeight-H-Q:0,se="offsetWidth"in O?O.offsetWidth===0?0:B/O.offsetWidth:0,fe="offsetHeight"in O?O.offsetHeight===0?0:D/O.offsetHeight:0;if(h===O)Z=o==="start"?I:o==="end"?I-g:o==="nearest"?v_(y,y+g,g,H,Q,y+I,y+I+b,b):I-g/2,ee=l==="start"?R:l==="center"?R-m/2:l==="end"?R-m:v_(v,v+m,m,X,ie,v+R,v+R+x,x),Z=Math.max(0,Z+y),ee=Math.max(0,ee+v);else{Z=o==="start"?I-z-H:o==="end"?I-V+Q+ne:o==="nearest"?v_(z,V,D,H,Q+ne,I,I+b,b):I-(z+D/2)+ne/2,ee=l==="start"?R-Y-X:l==="center"?R-(Y+B/2)+re/2:l==="end"?R-F+ie+re:v_(Y,F,B,X,ie+re,R,R+x,x);const{scrollLeft:me,scrollTop:Oe}=O;Z=fe===0?0:Math.max(0,Math.min(Oe+Z/fe,O.scrollHeight-D/fe+ne)),ee=se===0?0:Math.max(0,Math.min(me+ee/se,O.scrollWidth-B/se+re)),I+=Oe-Z,R+=me-ee}N.push({el:O,top:Z,left:ee})}return N},NPe=e=>e===!1?{block:"end",inline:"nearest"}:(t=>t===Object(t)&&Object.keys(t).length!==0)(e)?e:{block:"start",inline:"nearest"};function kPe(e,t){if(!e.isConnected||!(n=>{let s=n;for(;s&&s.parentNode;){if(s.parentNode===document)return!0;s=s.parentNode instanceof ShadowRoot?s.parentNode.host:s.parentNode}return!1})(e))return;const r=(n=>{const s=window.getComputedStyle(n);return{top:parseFloat(s.scrollMarginTop)||0,right:parseFloat(s.scrollMarginRight)||0,bottom:parseFloat(s.scrollMarginBottom)||0,left:parseFloat(s.scrollMarginLeft)||0}})(e);if((n=>typeof n=="object"&&typeof n.behavior=="function")(t))return t.behavior(y6(e,t));const i=typeof t=="boolean"||t==null?void 0:t.behavior;for(const{el:n,top:s,left:a}of y6(e,NPe(t))){const o=s-r.top+r.bottom,l=a-r.left+r.right;n.scroll({top:o,left:l,behavior:i})}}const zPe=e=>{const[,,,,t]=ia();return t?`${e}-css-var`:""},Mo=zPe;var rt={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var r=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||r>=rt.F1&&r<=rt.F12)return!1;switch(r){case rt.ALT:case rt.CAPS_LOCK:case rt.CONTEXT_MENU:case rt.CTRL:case rt.DOWN:case rt.END:case rt.ESC:case rt.HOME:case rt.INSERT:case rt.LEFT:case rt.MAC_FF_META:case rt.META:case rt.NUMLOCK:case rt.NUM_CENTER:case rt.PAGE_DOWN:case rt.PAGE_UP:case rt.PAUSE:case rt.PRINT_SCREEN:case rt.RIGHT:case rt.SHIFT:case rt.UP:case rt.WIN_KEY:case rt.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=rt.ZERO&&t<=rt.NINE||t>=rt.NUM_ZERO&&t<=rt.NUM_MULTIPLY||t>=rt.A&&t<=rt.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case rt.SPACE:case rt.QUESTION_MARK:case rt.NUM_PLUS:case rt.NUM_MINUS:case rt.NUM_PERIOD:case rt.NUM_DIVISION:case rt.SEMICOLON:case rt.DASH:case rt.EQUALS:case rt.COMMA:case rt.PERIOD:case rt.SLASH:case rt.APOSTROPHE:case rt.SINGLE_QUOTE:case rt.OPEN_SQUARE_BRACKET:case rt.BACKSLASH:case rt.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},rre=_.forwardRef(function(e,t){var r=e.prefixCls,i=e.style,n=e.className,s=e.duration,a=s===void 0?4.5:s,o=e.eventKey,l=e.content,c=e.closable,d=e.closeIcon,u=d===void 0?"x":d,h=e.props,f=e.onClick,p=e.onNoticeClose,m=e.times,g=e.hovering,v=_.useState(!1),y=Pe(v,2),b=y[0],x=y[1],S=g||b,w=function(){p(o)},E=function(A){(A.key==="Enter"||A.code==="Enter"||A.keyCode===rt.ENTER)&&w()};_.useEffect(function(){if(!S&&a>0){var T=setTimeout(function(){w()},a*1e3);return function(){clearTimeout(T)}}},[a,S,m]);var C="".concat(r,"-notice");return _.createElement("div",ae({},h,{ref:t,className:Fe(C,n,he({},"".concat(C,"-closable"),c)),style:i,onMouseEnter:function(A){var M;x(!0),h==null||(M=h.onMouseEnter)===null||M===void 0||M.call(h,A)},onMouseLeave:function(A){var M;x(!1),h==null||(M=h.onMouseLeave)===null||M===void 0||M.call(h,A)},onClick:f}),_.createElement("div",{className:"".concat(C,"-content")},l),c&&_.createElement("a",{tabIndex:0,className:"".concat(C,"-close"),onKeyDown:E,onClick:function(A){A.preventDefault(),A.stopPropagation(),w()}},u))}),ire=Ge.createContext({}),BPe=function(t){var r=t.children,i=t.classNames;return Ge.createElement(ire.Provider,{value:{classNames:i}},r)},b6=8,x6=3,w6=16,FPe=function(t){var r={offset:b6,threshold:x6,gap:w6};if(t&&vr(t)==="object"){var i,n,s;r.offset=(i=t.offset)!==null&&i!==void 0?i:b6,r.threshold=(n=t.threshold)!==null&&n!==void 0?n:x6,r.gap=(s=t.gap)!==null&&s!==void 0?s:w6}return[!!t,r]},jPe=["className","style","classNames","styles"],VPe=function(t){var r,i=t.configList,n=t.placement,s=t.prefixCls,a=t.className,o=t.style,l=t.motion,c=t.onAllNoticeRemoved,d=t.onNoticeClose,u=t.stack,h=_.useContext(ire),f=h.classNames,p=_.useRef({}),m=_.useState(null),g=Pe(m,2),v=g[0],y=g[1],b=_.useState([]),x=Pe(b,2),S=x[0],w=x[1],E=i.map(function(O){return{config:O,key:String(O.key)}}),C=FPe(u),T=Pe(C,2),A=T[0],M=T[1],P=M.offset,I=M.threshold,R=M.gap,N=A&&(S.length>0||E.length<=I),k=typeof l=="function"?l(n):l;return _.useEffect(function(){A&&S.length>1&&w(function(O){return O.filter(function(D){return E.some(function(B){var z=B.key;return D===z})})})},[S,E,A]),_.useEffect(function(){var O;if(A&&p.current[(O=E[E.length-1])===null||O===void 0?void 0:O.key]){var D;y(p.current[(D=E[E.length-1])===null||D===void 0?void 0:D.key])}},[E,A]),Ge.createElement(Hte,ae({key:n,className:Fe(s,"".concat(s,"-").concat(n),f==null?void 0:f.list,a,(r={},he(r,"".concat(s,"-stack"),!!A),he(r,"".concat(s,"-stack-expanded"),N),r)),style:o,keys:E,motionAppear:!0},k,{onAllRemoved:function(){c(n)}}),function(O,D){var B=O.config,z=O.className,F=O.style,V=O.index,Y=B,W=Y.key,X=Y.times,H=String(W),ie=B,Q=ie.className,Z=ie.style,ee=ie.classNames,re=ie.styles,ne=hr(ie,jPe),se=E.findIndex(function(xe){return xe.key===H}),fe={};if(A){var me=E.length-1-(se>-1?se:V-1),Oe=n==="top"||n==="bottom"?"-50%":"0";if(me>0){var Ee,Se,de;fe.height=N?(Ee=p.current[H])===null||Ee===void 0?void 0:Ee.offsetHeight:v==null?void 0:v.offsetHeight;for(var be=0,ye=0;ye<me;ye++){var q;be+=((q=p.current[E[E.length-1-ye].key])===null||q===void 0?void 0:q.offsetHeight)+R}var U=(N?be:me*P)*(n.startsWith("top")?1:-1),ce=!N&&v!==null&&v!==void 0&&v.offsetWidth&&(Se=p.current[H])!==null&&Se!==void 0&&Se.offsetWidth?((v==null?void 0:v.offsetWidth)-P*2*(me<3?me:3))/((de=p.current[H])===null||de===void 0?void 0:de.offsetWidth):1;fe.transform="translate3d(".concat(Oe,", ").concat(U,"px, 0) scaleX(").concat(ce,")")}else fe.transform="translate3d(".concat(Oe,", 0, 0)")}return Ge.createElement("div",{ref:D,className:Fe("".concat(s,"-notice-wrapper"),z,ee==null?void 0:ee.wrapper),style:_e(_e(_e({},F),fe),re==null?void 0:re.wrapper),onMouseEnter:function(){return w(function(j){return j.includes(H)?j:[].concat(ft(j),[H])})},onMouseLeave:function(){return w(function(j){return j.filter(function(Be){return Be!==H})})}},Ge.createElement(rre,ae({},ne,{ref:function(j){se>-1?p.current[H]=j:delete p.current[H]},prefixCls:s,classNames:ee,styles:re,className:Fe(Q,f==null?void 0:f.notice),style:Z,times:X,key:W,eventKey:W,onNoticeClose:d,hovering:A&&S.length>0})))})},UPe=_.forwardRef(function(e,t){var r=e.prefixCls,i=r===void 0?"rc-notification":r,n=e.container,s=e.motion,a=e.maxCount,o=e.className,l=e.style,c=e.onAllRemoved,d=e.stack,u=e.renderNotifications,h=_.useState([]),f=Pe(h,2),p=f[0],m=f[1],g=function(T){var A,M=p.find(function(P){return P.key===T});M==null||(A=M.onClose)===null||A===void 0||A.call(M),m(function(P){return P.filter(function(I){return I.key!==T})})};_.useImperativeHandle(t,function(){return{open:function(T){m(function(A){var M=ft(A),P=M.findIndex(function(N){return N.key===T.key}),I=_e({},T);if(P>=0){var R;I.times=(((R=A[P])===null||R===void 0?void 0:R.times)||0)+1,M[P]=I}else I.times=0,M.push(I);return a>0&&M.length>a&&(M=M.slice(-a)),M})},close:function(T){g(T)},destroy:function(){m([])}}});var v=_.useState({}),y=Pe(v,2),b=y[0],x=y[1];_.useEffect(function(){var C={};p.forEach(function(T){var A=T.placement,M=A===void 0?"topRight":A;M&&(C[M]=C[M]||[],C[M].push(T))}),Object.keys(b).forEach(function(T){C[T]=C[T]||[]}),x(C)},[p]);var S=function(T){x(function(A){var M=_e({},A),P=M[T]||[];return P.length||delete M[T],M})},w=_.useRef(!1);if(_.useEffect(function(){Object.keys(b).length>0?w.current=!0:w.current&&(c==null||c(),w.current=!1)},[b]),!n)return null;var E=Object.keys(b);return Vl.createPortal(_.createElement(_.Fragment,null,E.map(function(C){var T=b[C],A=_.createElement(VPe,{key:C,configList:T,placement:C,prefixCls:i,className:o==null?void 0:o(C),style:l==null?void 0:l(C),motion:s,onNoticeClose:g,onAllNoticeRemoved:S,stack:d});return u?u(A,{prefixCls:i,key:C}):A})),n)}),$Pe=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],HPe=function(){return document.body},_6=0;function WPe(){for(var e={},t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return r.forEach(function(n){n&&Object.keys(n).forEach(function(s){var a=n[s];a!==void 0&&(e[s]=a)})}),e}function GPe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.getContainer,r=t===void 0?HPe:t,i=e.motion,n=e.prefixCls,s=e.maxCount,a=e.className,o=e.style,l=e.onAllRemoved,c=e.stack,d=e.renderNotifications,u=hr(e,$Pe),h=_.useState(),f=Pe(h,2),p=f[0],m=f[1],g=_.useRef(),v=_.createElement(UPe,{container:p,ref:g,prefixCls:n,motion:i,maxCount:s,className:a,style:o,onAllRemoved:l,stack:c,renderNotifications:d}),y=_.useState([]),b=Pe(y,2),x=b[0],S=b[1],w=_.useMemo(function(){return{open:function(C){var T=WPe(u,C);(T.key===null||T.key===void 0)&&(T.key="rc-notification-".concat(_6),_6+=1),S(function(A){return[].concat(ft(A),[{type:"open",config:T}])})},close:function(C){S(function(T){return[].concat(ft(T),[{type:"close",key:C}])})},destroy:function(){S(function(C){return[].concat(ft(C),[{type:"destroy"}])})}}},[]);return _.useEffect(function(){m(r())}),_.useEffect(function(){g.current&&x.length&&(x.forEach(function(E){switch(E.type){case"open":g.current.open(E.config);break;case"close":g.current.close(E.key);break;case"destroy":g.current.destroy();break}}),S(function(E){return E.filter(function(C){return!x.includes(C)})}))},[x]),[w,v]}var qPe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};const XPe=qPe;var YPe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:XPe}))};const dM=_.forwardRef(YPe),KPe=Ge.createContext(void 0),AF=KPe,wf=100,QPe=10,nre=wf*QPe,sre={Modal:wf,Drawer:wf,Popover:wf,Popconfirm:wf,Tooltip:wf,Tour:wf},ZPe={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function JPe(e){return e in sre}function hM(e,t){const[,r]=ia(),i=Ge.useContext(AF),n=JPe(e);if(t!==void 0)return[t,t];let s=i??0;return n?(s+=(i?0:r.zIndexPopupBase)+sre[e],s=Math.min(s,r.zIndexPopupBase+nre)):s+=ZPe[e],[i===void 0?t:s,s]}function Sa(){Sa=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(k,O,D){k[O]=D.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(k,O,D){return Object.defineProperty(k,O,{value:D,enumerable:!0,configurable:!0,writable:!0}),k[O]}try{c({},"")}catch{c=function(D,B,z){return D[B]=z}}function d(k,O,D,B){var z=O&&O.prototype instanceof v?O:v,F=Object.create(z.prototype),V=new R(B||[]);return n(F,"_invoke",{value:A(k,D,V)}),F}function u(k,O,D){try{return{type:"normal",arg:k.call(O,D)}}catch(B){return{type:"throw",arg:B}}}t.wrap=d;var h="suspendedStart",f="suspendedYield",p="executing",m="completed",g={};function v(){}function y(){}function b(){}var x={};c(x,a,function(){return this});var S=Object.getPrototypeOf,w=S&&S(S(N([])));w&&w!==r&&i.call(w,a)&&(x=w);var E=b.prototype=v.prototype=Object.create(x);function C(k){["next","throw","return"].forEach(function(O){c(k,O,function(D){return this._invoke(O,D)})})}function T(k,O){function D(z,F,V,Y){var W=u(k[z],k,F);if(W.type!=="throw"){var X=W.arg,H=X.value;return H&&vr(H)=="object"&&i.call(H,"__await")?O.resolve(H.__await).then(function(ie){D("next",ie,V,Y)},function(ie){D("throw",ie,V,Y)}):O.resolve(H).then(function(ie){X.value=ie,V(X)},function(ie){return D("throw",ie,V,Y)})}Y(W.arg)}var B;n(this,"_invoke",{value:function(F,V){function Y(){return new O(function(W,X){D(F,V,W,X)})}return B=B?B.then(Y,Y):Y()}})}function A(k,O,D){var B=h;return function(z,F){if(B===p)throw new Error("Generator is already running");if(B===m){if(z==="throw")throw F;return{value:e,done:!0}}for(D.method=z,D.arg=F;;){var V=D.delegate;if(V){var Y=M(V,D);if(Y){if(Y===g)continue;return Y}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(B===h)throw B=m,D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);B=p;var W=u(k,O,D);if(W.type==="normal"){if(B=D.done?m:f,W.arg===g)continue;return{value:W.arg,done:D.done}}W.type==="throw"&&(B=m,D.method="throw",D.arg=W.arg)}}}function M(k,O){var D=O.method,B=k.iterator[D];if(B===e)return O.delegate=null,D==="throw"&&k.iterator.return&&(O.method="return",O.arg=e,M(k,O),O.method==="throw")||D!=="return"&&(O.method="throw",O.arg=new TypeError("The iterator does not provide a '"+D+"' method")),g;var z=u(B,k.iterator,O.arg);if(z.type==="throw")return O.method="throw",O.arg=z.arg,O.delegate=null,g;var F=z.arg;return F?F.done?(O[k.resultName]=F.value,O.next=k.nextLoc,O.method!=="return"&&(O.method="next",O.arg=e),O.delegate=null,g):F:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,g)}function P(k){var O={tryLoc:k[0]};1 in k&&(O.catchLoc=k[1]),2 in k&&(O.finallyLoc=k[2],O.afterLoc=k[3]),this.tryEntries.push(O)}function I(k){var O=k.completion||{};O.type="normal",delete O.arg,k.completion=O}function R(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(P,this),this.reset(!0)}function N(k){if(k||k===""){var O=k[a];if(O)return O.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var D=-1,B=function z(){for(;++D<k.length;)if(i.call(k,D))return z.value=k[D],z.done=!1,z;return z.value=e,z.done=!0,z};return B.next=B}}throw new TypeError(vr(k)+" is not iterable")}return y.prototype=b,n(E,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(k){var O=typeof k=="function"&&k.constructor;return!!O&&(O===y||(O.displayName||O.name)==="GeneratorFunction")},t.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,b):(k.__proto__=b,c(k,l,"GeneratorFunction")),k.prototype=Object.create(E),k},t.awrap=function(k){return{__await:k}},C(T.prototype),c(T.prototype,o,function(){return this}),t.AsyncIterator=T,t.async=function(k,O,D,B,z){z===void 0&&(z=Promise);var F=new T(d(k,O,D,B),z);return t.isGeneratorFunction(O)?F:F.next().then(function(V){return V.done?V.value:F.next()})},C(E),c(E,l,"Generator"),c(E,a,function(){return this}),c(E,"toString",function(){return"[object Generator]"}),t.keys=function(k){var O=Object(k),D=[];for(var B in O)D.push(B);return D.reverse(),function z(){for(;D.length;){var F=D.pop();if(F in O)return z.value=F,z.done=!1,z}return z.done=!0,z}},t.values=N,R.prototype={constructor:R,reset:function(O){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!O)for(var D in this)D.charAt(0)==="t"&&i.call(this,D)&&!isNaN(+D.slice(1))&&(this[D]=e)},stop:function(){this.done=!0;var O=this.tryEntries[0].completion;if(O.type==="throw")throw O.arg;return this.rval},dispatchException:function(O){if(this.done)throw O;var D=this;function B(X,H){return V.type="throw",V.arg=O,D.next=X,H&&(D.method="next",D.arg=e),!!H}for(var z=this.tryEntries.length-1;z>=0;--z){var F=this.tryEntries[z],V=F.completion;if(F.tryLoc==="root")return B("end");if(F.tryLoc<=this.prev){var Y=i.call(F,"catchLoc"),W=i.call(F,"finallyLoc");if(Y&&W){if(this.prev<F.catchLoc)return B(F.catchLoc,!0);if(this.prev<F.finallyLoc)return B(F.finallyLoc)}else if(Y){if(this.prev<F.catchLoc)return B(F.catchLoc,!0)}else{if(!W)throw new Error("try statement without catch or finally");if(this.prev<F.finallyLoc)return B(F.finallyLoc)}}}},abrupt:function(O,D){for(var B=this.tryEntries.length-1;B>=0;--B){var z=this.tryEntries[B];if(z.tryLoc<=this.prev&&i.call(z,"finallyLoc")&&this.prev<z.finallyLoc){var F=z;break}}F&&(O==="break"||O==="continue")&&F.tryLoc<=D&&D<=F.finallyLoc&&(F=null);var V=F?F.completion:{};return V.type=O,V.arg=D,F?(this.method="next",this.next=F.finallyLoc,g):this.complete(V)},complete:function(O,D){if(O.type==="throw")throw O.arg;return O.type==="break"||O.type==="continue"?this.next=O.arg:O.type==="return"?(this.rval=this.arg=O.arg,this.method="return",this.next="end"):O.type==="normal"&&D&&(this.next=D),g},finish:function(O){for(var D=this.tryEntries.length-1;D>=0;--D){var B=this.tryEntries[D];if(B.finallyLoc===O)return this.complete(B.completion,B.afterLoc),I(B),g}},catch:function(O){for(var D=this.tryEntries.length-1;D>=0;--D){var B=this.tryEntries[D];if(B.tryLoc===O){var z=B.completion;if(z.type==="throw"){var F=z.arg;I(B)}return F}}throw new Error("illegal catch attempt")},delegateYield:function(O,D,B){return this.delegate={iterator:N(O),resultName:D,nextLoc:B},this.method==="next"&&(this.arg=e),g}},t}function S6(e,t,r,i,n,s,a){try{var o=e[s](a),l=o.value}catch(c){r(c);return}o.done?t(l):Promise.resolve(l).then(i,n)}function Jp(e){return function(){var t=this,r=arguments;return new Promise(function(i,n){var s=e.apply(t,r);function a(l){S6(s,i,n,a,o,"next",l)}function o(l){S6(s,i,n,a,o,"throw",l)}a(void 0)})}}var aw=_e({},Nde),eIe=aw.version,tIe=aw.render,rIe=aw.unmountComponentAtNode,fM;try{var iIe=Number((eIe||"").split(".")[0]);iIe>=18&&(fM=aw.createRoot)}catch{}function E6(e){var t=aw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&vr(t)==="object"&&(t.usingClientEntryPoint=e)}var ZC="__rc_react_root__";function nIe(e,t){E6(!0);var r=t[ZC]||fM(t);E6(!1),r.render(e),t[ZC]=r}function sIe(e,t){tIe(e,t)}function are(e,t){if(fM){nIe(e,t);return}sIe(e,t)}function aIe(e){return K3.apply(this,arguments)}function K3(){return K3=Jp(Sa().mark(function e(t){return Sa().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve().then(function(){var n;(n=t[ZC])===null||n===void 0||n.unmount(),delete t[ZC]}));case 1:case"end":return i.stop()}},e)})),K3.apply(this,arguments)}function oIe(e){rIe(e)}function lIe(e){return Q3.apply(this,arguments)}function Q3(){return Q3=Jp(Sa().mark(function e(t){return Sa().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(fM===void 0){i.next=2;break}return i.abrupt("return",aIe(t));case 2:oIe(t);case 3:case"end":return i.stop()}},e)})),Q3.apply(this,arguments)}const wI=()=>({height:0,opacity:0}),C6=e=>{const{scrollHeight:t}=e;return{height:t,opacity:1}},cIe=e=>({height:e?e.offsetHeight:0}),_I=(e,t)=>(t==null?void 0:t.deadline)===!0||t.propertyName==="height",uIe=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:wI,onEnterStart:wI,onAppearActive:C6,onEnterActive:C6,onLeaveStart:cIe,onLeaveActive:wI,onAppearEnd:_I,onEnterEnd:_I,onLeaveEnd:_I,motionDeadline:500}},TF=(e,t,r)=>r!==void 0?r:`${e}-${t}`,Z3=uIe,pM=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),r=t.width,i=t.height;if(r||i)return!0}if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),s=n.width,a=n.height;if(s||a)return!0}}return!1},dIe=e=>{const{componentCls:t,colorPrimary:r}=e;return{[t]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${r})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow 0.3s ${e.motionEaseInOut}`,`opacity 0.35s ${e.motionEaseInOut}`].join(",")}}}}},hIe=_F("Wave",e=>[dIe(e)]);function fIe(e){const t=(e||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return t&&t[1]&&t[2]&&t[3]?!(t[1]===t[2]&&t[2]===t[3]):!0}function SI(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&fIe(e)&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function pIe(e){const{borderTopColor:t,borderColor:r,backgroundColor:i}=getComputedStyle(e);return SI(t)?t:SI(r)?r:SI(i)?i:null}const MF="ant-wave-target";function EI(e){return Number.isNaN(e)?0:e}const mIe=e=>{const{className:t,target:r,component:i}=e,n=_.useRef(null),[s,a]=_.useState(null),[o,l]=_.useState([]),[c,d]=_.useState(0),[u,h]=_.useState(0),[f,p]=_.useState(0),[m,g]=_.useState(0),[v,y]=_.useState(!1),b={left:c,top:u,width:f,height:m,borderRadius:o.map(w=>`${w}px`).join(" ")};s&&(b["--wave-color"]=s);function x(){const w=getComputedStyle(r);a(pIe(r));const E=w.position==="static",{borderLeftWidth:C,borderTopWidth:T}=w;d(E?r.offsetLeft:EI(-parseFloat(C))),h(E?r.offsetTop:EI(-parseFloat(T))),p(r.offsetWidth),g(r.offsetHeight);const{borderTopLeftRadius:A,borderTopRightRadius:M,borderBottomLeftRadius:P,borderBottomRightRadius:I}=w;l([A,M,I,P].map(R=>EI(parseFloat(R))))}if(_.useEffect(()=>{if(r){const w=Lr(()=>{x(),y(!0)});let E;return typeof ResizeObserver<"u"&&(E=new ResizeObserver(x),E.observe(r)),()=>{Lr.cancel(w),E==null||E.disconnect()}}},[]),!v)return null;const S=(i==="Checkbox"||i==="Radio")&&(r==null?void 0:r.classList.contains(MF));return _.createElement(Zp,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(w,E)=>{var C;if(E.deadline||E.propertyName==="opacity"){const T=(C=n.current)===null||C===void 0?void 0:C.parentElement;lIe(T).then(()=>{T==null||T.remove()})}return!1}},w=>{let{className:E}=w;return _.createElement("div",{ref:n,className:Fe(t,{"wave-quick":S},E),style:b})})},gIe=(e,t)=>{var r;const{component:i}=t;if(i==="Checkbox"&&!(!((r=e.querySelector("input"))===null||r===void 0)&&r.checked))return;const n=document.createElement("div");n.style.position="absolute",n.style.left="0px",n.style.top="0px",e==null||e.insertBefore(n,e==null?void 0:e.firstChild),are(_.createElement(mIe,Object.assign({},t,{target:e})),n)},vIe=gIe;function yIe(e,t,r){const{wave:i}=_.useContext(br),[,n,s]=ia(),a=ma(c=>{const d=e.current;if(i!=null&&i.disabled||!d)return;const u=d.querySelector(`.${MF}`)||d,{showEffect:h}=i||{};(h||vIe)(u,{className:t,token:n,component:r,event:c,hashId:s})}),o=_.useRef();return c=>{Lr.cancel(o.current),o.current=Lr(()=>{a(c)})}}const bIe=e=>{const{children:t,disabled:r,component:i}=e,{getPrefixCls:n}=_.useContext(br),s=_.useRef(null),a=n("wave"),[,o]=hIe(a),l=yIe(s,Fe(a,o),i);if(Ge.useEffect(()=>{const d=s.current;if(!d||d.nodeType!==1||r)return;const u=h=>{!pM(h.target)||!d.getAttribute||d.getAttribute("disabled")||d.disabled||d.className.includes("disabled")||d.className.includes("-leave")||l(h)};return d.addEventListener("click",u,!0),()=>{d.removeEventListener("click",u,!0)}},[r]),!Ge.isValidElement(t))return t??null;const c=gd(t)?To(t.ref,s):s;return nl(t,{ref:c})},ore=bIe,xIe=e=>{const t=Ge.useContext(iw);return Ge.useMemo(()=>e?typeof e=="string"?e??t:e instanceof Function?e(t):t:t,[e,t])},ef=xIe,wIe=e=>{const{componentCls:t}=e;return{[t]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},_Ie=wIe,SIe=e=>{const{componentCls:t}=e;return{[t]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${t}-item:empty`]:{display:"none"}}}},EIe=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-row-small":{rowGap:e.spaceGapSmallSize},"&-gap-row-middle":{rowGap:e.spaceGapMiddleSize},"&-gap-row-large":{rowGap:e.spaceGapLargeSize},"&-gap-col-small":{columnGap:e.spaceGapSmallSize},"&-gap-col-middle":{columnGap:e.spaceGapMiddleSize},"&-gap-col-large":{columnGap:e.spaceGapLargeSize}}}},lre=sa("Space",e=>{const t=zr(e,{spaceGapSmallSize:e.paddingXS,spaceGapMiddleSize:e.padding,spaceGapLargeSize:e.paddingLG});return[SIe(t),EIe(t),_Ie(t)]},()=>({}),{resetStyle:!1});var cre=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const mM=_.createContext(null),T0=(e,t)=>{const r=_.useContext(mM),i=_.useMemo(()=>{if(!r)return"";const{compactDirection:n,isFirstItem:s,isLastItem:a}=r,o=n==="vertical"?"-vertical-":"-";return Fe(`${e}-compact${o}item`,{[`${e}-compact${o}first-item`]:s,[`${e}-compact${o}last-item`]:a,[`${e}-compact${o}item-rtl`]:t==="rtl"})},[e,t,r]);return{compactSize:r==null?void 0:r.compactSize,compactDirection:r==null?void 0:r.compactDirection,compactItemClassnames:i}},$v=e=>{let{children:t}=e;return _.createElement(mM.Provider,{value:null},t)},CIe=e=>{var{children:t}=e,r=cre(e,["children"]);return _.createElement(mM.Provider,{value:r},t)},AIe=e=>{const{getPrefixCls:t,direction:r}=_.useContext(br),{size:i,direction:n,block:s,prefixCls:a,className:o,rootClassName:l,children:c}=e,d=cre(e,["size","direction","block","prefixCls","className","rootClassName","children"]),u=ef(b=>i??b),h=t("space-compact",a),[f,p]=lre(h),m=Fe(h,p,{[`${h}-rtl`]:r==="rtl",[`${h}-block`]:s,[`${h}-vertical`]:n==="vertical"},o,l),g=_.useContext(mM),v=Qc(c),y=_.useMemo(()=>v.map((b,x)=>{const S=b&&b.key||`${h}-item-${x}`;return _.createElement(CIe,{key:S,compactSize:u,compactDirection:n,isFirstItem:x===0&&(!g||(g==null?void 0:g.isFirstItem)),isLastItem:x===v.length-1&&(!g||(g==null?void 0:g.isLastItem))},b)}),[i,v,g]);return v.length===0?null:f(_.createElement("div",Object.assign({className:m},d),y))},TIe=AIe;var MIe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const ure=_.createContext(void 0),PIe=e=>{const{getPrefixCls:t,direction:r}=_.useContext(br),{prefixCls:i,size:n,className:s}=e,a=MIe(e,["prefixCls","size","className"]),o=t("btn-group",i),[,,l]=ia();let c="";switch(n){case"large":c="lg";break;case"small":c="sm";break}const d=Fe(o,{[`${o}-${c}`]:c,[`${o}-rtl`]:r==="rtl"},s,l);return _.createElement(ure.Provider,{value:n},_.createElement("div",Object.assign({},a,{className:d})))},IIe=PIe,A6=/^[\u4e00-\u9fa5]{2}$/,J3=A6.test.bind(A6);function T6(e){return typeof e=="string"}function CI(e){return e==="text"||e==="link"}function RIe(e,t){if(e==null)return;const r=t?" ":"";return typeof e!="string"&&typeof e!="number"&&T6(e.type)&&J3(e.props.children)?nl(e,{children:e.props.children.split("").join(r)}):T6(e)?J3(e)?Ge.createElement("span",null,e.split("").join(r)):Ge.createElement("span",null,e):tre(e)?Ge.createElement("span",null,e):e}function DIe(e,t){let r=!1;const i=[];return Ge.Children.forEach(e,n=>{const s=typeof n,a=s==="string"||s==="number";if(r&&a){const o=i.length-1,l=i[o];i[o]=`${l}${n}`}else i.push(n);r=a}),Ge.Children.map(i,n=>RIe(n,t))}const OIe=_.forwardRef((e,t)=>{const{className:r,style:i,children:n,prefixCls:s}=e,a=Fe(`${s}-icon`,r);return Ge.createElement("span",{ref:t,className:a,style:i},n)}),dre=OIe,M6=_.forwardRef((e,t)=>{let{prefixCls:r,className:i,style:n,iconClassName:s}=e;const a=Fe(`${r}-loading-icon`,i);return Ge.createElement(dre,{prefixCls:r,className:a,style:n,ref:t},Ge.createElement(dM,{className:s}))}),AI=()=>({width:0,opacity:0,transform:"scale(0)"}),TI=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),LIe=e=>{const{prefixCls:t,loading:r,existIcon:i,className:n,style:s}=e,a=!!r;return i?Ge.createElement(M6,{prefixCls:t,className:n,style:s}):Ge.createElement(Zp,{visible:a,motionName:`${t}-loading-icon-motion`,motionLeave:a,removeOnLeave:!0,onAppearStart:AI,onAppearActive:TI,onEnterStart:AI,onEnterActive:TI,onLeaveStart:TI,onLeaveActive:AI},(o,l)=>{let{className:c,style:d}=o;return Ge.createElement(M6,{prefixCls:t,className:n,style:Object.assign(Object.assign({},s),d),ref:l,iconClassName:c})})},NIe=LIe,P6=(e,t)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:t}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:t}}}}}),kIe=e=>{const{componentCls:t,fontSize:r,lineWidth:i,groupBorderColor:n,colorErrorHover:s}=e;return{[`${t}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:e.calc(i).mul(-1).equal(),[`&, & > ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[t]:{position:"relative",zIndex:1,"&:hover,\n          &:focus,\n          &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${t}-icon-only`]:{fontSize:r}},P6(`${t}-primary`,n),P6(`${t}-danger`,s)]}},zIe=kIe,BIe=e=>{const{componentCls:t,iconCls:r,fontWeight:i}=e;return{[t]:{outline:"none",position:"relative",display:"inline-block",fontWeight:i,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${lt(e.lineWidth)} ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:e.lineHeight,color:e.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${t}-icon`]:{lineHeight:0},[`> ${r} + span, > span + ${r}`]:{marginInlineStart:e.marginXS},[`&:not(${t}-icon-only) > ${t}-icon`]:{[`&${t}-loading-icon, &:not(:last-child)`]:{marginInlineEnd:e.marginXS}},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},$3(e)),[`&${t}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${t}-two-chinese-chars > *:not(${r})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},[`&-icon-only${t}-compact-item`]:{flex:"none"}}}},ld=(e,t,r)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":t,"&:active":r}}),FIe=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),jIe=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.calc(e.controlHeight).div(2).equal(),paddingInlineEnd:e.calc(e.controlHeight).div(2).equal()}),VIe=e=>({cursor:"not-allowed",borderColor:e.borderColorDisabled,color:e.colorTextDisabled,background:e.colorBgContainerDisabled,boxShadow:"none"}),Kb=(e,t,r,i,n,s,a,o)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:r||void 0,background:t,borderColor:i||void 0,boxShadow:"none"},ld(e,Object.assign({background:t},a),Object.assign({background:t},o))),{"&:disabled":{cursor:"not-allowed",color:n||void 0,borderColor:s||void 0}})}),PF=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},VIe(e))}),hre=e=>Object.assign({},PF(e)),JC=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),fre=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},hre(e)),{background:e.defaultBg,borderColor:e.defaultBorderColor,color:e.defaultColor,boxShadow:e.defaultShadow}),ld(e.componentCls,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),Kb(e.componentCls,e.ghostBg,e.defaultGhostColor,e.defaultGhostBorderColor,e.colorTextDisabled,e.colorBorder)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:e.colorError,borderColor:e.colorError},ld(e.componentCls,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),Kb(e.componentCls,e.ghostBg,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder)),PF(e))}),UIe=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},hre(e)),{color:e.primaryColor,background:e.colorPrimary,boxShadow:e.primaryShadow}),ld(e.componentCls,{color:e.colorTextLightSolid,background:e.colorPrimaryHover},{color:e.colorTextLightSolid,background:e.colorPrimaryActive})),Kb(e.componentCls,e.ghostBg,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({background:e.colorError,boxShadow:e.dangerShadow,color:e.dangerColor},ld(e.componentCls,{background:e.colorErrorHover},{background:e.colorErrorActive})),Kb(e.componentCls,e.ghostBg,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),PF(e))}),$Ie=e=>Object.assign(Object.assign({},fre(e)),{borderStyle:"dashed"}),HIe=e=>Object.assign(Object.assign(Object.assign({color:e.colorLink},ld(e.componentCls,{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),JC(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},ld(e.componentCls,{color:e.colorErrorHover},{color:e.colorErrorActive})),JC(e))}),WIe=e=>Object.assign(Object.assign(Object.assign({},ld(e.componentCls,{color:e.colorText,background:e.textHoverBg},{color:e.colorText,background:e.colorBgTextActive})),JC(e)),{[`&${e.componentCls}-dangerous`]:Object.assign(Object.assign({color:e.colorError},JC(e)),ld(e.componentCls,{color:e.colorErrorHover,background:e.colorErrorBg},{color:e.colorErrorHover,background:e.colorErrorBg}))}),GIe=e=>{const{componentCls:t}=e;return{[`${t}-default`]:fre(e),[`${t}-primary`]:UIe(e),[`${t}-dashed`]:$Ie(e),[`${t}-link`]:HIe(e),[`${t}-text`]:WIe(e),[`${t}-ghost`]:Kb(e.componentCls,e.ghostBg,e.colorBgContainer,e.colorBgContainer,e.colorTextDisabled,e.colorBorder)}},IF=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:r,controlHeight:i,fontSize:n,borderRadius:s,buttonPaddingHorizontal:a,iconCls:o,buttonPaddingVertical:l}=e,c=`${r}-icon-only`;return[{[`${r}${t}`]:{fontSize:n,height:i,padding:`${lt(l)} ${lt(a)}`,borderRadius:s,[`&${c}`]:{width:i,paddingInlineStart:0,paddingInlineEnd:0,[`&${r}-round`]:{width:"auto"},[o]:{fontSize:e.buttonIconOnlyFontSize}},[`&${r}-loading`]:{opacity:e.opacityLoading,cursor:"default"},[`${r}-loading-icon`]:{transition:`width ${e.motionDurationSlow} ${e.motionEaseInOut}, opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`}}},{[`${r}${r}-circle${t}`]:FIe(e)},{[`${r}${r}-round${t}`]:jIe(e)}]},qIe=e=>IF(zr(e,{fontSize:e.contentFontSize})),XIe=e=>{const t=zr(e,{controlHeight:e.controlHeightSM,fontSize:e.contentFontSizeSM,padding:e.paddingXS,buttonPaddingHorizontal:e.paddingInlineSM,buttonPaddingVertical:e.paddingBlockSM,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.onlyIconSizeSM});return IF(t,`${e.componentCls}-sm`)},YIe=e=>{const t=zr(e,{controlHeight:e.controlHeightLG,fontSize:e.contentFontSizeLG,buttonPaddingHorizontal:e.paddingInlineLG,buttonPaddingVertical:e.paddingBlockLG,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.onlyIconSizeLG});return IF(t,`${e.componentCls}-lg`)},KIe=e=>{const{componentCls:t}=e;return{[t]:{[`&${t}-block`]:{width:"100%"}}}},pre=e=>{const{paddingInline:t,onlyIconSize:r,paddingBlock:i}=e;return zr(e,{buttonPaddingHorizontal:t,buttonPaddingVertical:i,buttonIconOnlyFontSize:r})},mre=e=>{const t=e.fontSize,r=e.fontSize,i=e.fontSizeLG;return{fontWeight:400,defaultShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`,primaryShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`,dangerShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`,primaryColor:e.colorTextLightSolid,dangerColor:e.colorTextLightSolid,borderColorDisabled:e.colorBorder,defaultGhostColor:e.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:e.colorBgContainer,paddingInline:e.paddingContentHorizontal-e.lineWidth,paddingInlineLG:e.paddingContentHorizontal-e.lineWidth,paddingInlineSM:8-e.lineWidth,paddingBlock:Math.max((e.controlHeight-t*e.lineHeight)/2-e.lineWidth,0),paddingBlockSM:Math.max((e.controlHeightSM-r*e.lineHeight)/2-e.lineWidth,0),paddingBlockLG:Math.max((e.controlHeightLG-i*e.lineHeight)/2-e.lineWidth,0),onlyIconSize:e.fontSizeLG,onlyIconSizeSM:e.fontSizeLG-2,onlyIconSizeLG:e.fontSizeLG+2,groupBorderColor:e.colorPrimaryHover,linkHoverBg:"transparent",textHoverBg:e.colorBgTextHover,defaultColor:e.colorText,defaultBg:e.colorBgContainer,defaultBorderColor:e.colorBorder,defaultBorderColorDisabled:e.colorBorder,contentFontSize:t,contentFontSizeSM:r,contentFontSizeLG:i}},QIe=sa("Button",e=>{const t=pre(e);return[BIe(t),XIe(t),qIe(t),YIe(t),KIe(t),GIe(t),zIe(t)]},mre,{unitless:{fontWeight:!0}});function ZIe(e,t,r){const{focusElCls:i,focus:n,borderElCls:s}=r,a=s?"> *":"",o=["hover",n?"focus":null,"active"].filter(Boolean).map(l=>`&:${l} ${a}`).join(",");return{[`&-item:not(${t}-last-item)`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[o]:{zIndex:2}},i?{[`&${i}`]:{zIndex:2}}:{}),{[`&[disabled] ${a}`]:{zIndex:0}})}}function JIe(e,t,r){const{borderElCls:i}=r,n=i?`> ${i}`:"";return{[`&-item:not(${t}-first-item):not(${t}-last-item) ${n}`]:{borderRadius:0},[`&-item:not(${t}-last-item)${t}-first-item`]:{[`& ${n}, &${e}-sm ${n}, &${e}-lg ${n}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${t}-first-item)${t}-last-item`]:{[`& ${n}, &${e}-sm ${n}, &${e}-lg ${n}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function gM(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:r}=e,i=`${r}-compact`;return{[i]:Object.assign(Object.assign({},ZIe(e,i,t)),JIe(r,i,t))}}function eRe(e,t){return{[`&-item:not(${t}-last-item)`]:{marginBottom:e.calc(e.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function tRe(e,t){return{[`&-item:not(${t}-first-item):not(${t}-last-item)`]:{borderRadius:0},[`&-item${t}-first-item:not(${t}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${t}-last-item:not(${t}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function rRe(e){const t=`${e.componentCls}-compact-vertical`;return{[t]:Object.assign(Object.assign({},eRe(e,t)),tRe(e.componentCls,t))}}const iRe=e=>{const{componentCls:t,calc:r}=e;return{[t]:{[`&-compact-item${t}-primary`]:{[`&:not([disabled]) + ${t}-compact-item${t}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:r(e.lineWidth).mul(-1).equal(),insetInlineStart:r(e.lineWidth).mul(-1).equal(),display:"inline-block",width:e.lineWidth,height:`calc(100% + ${lt(e.lineWidth)} * 2)`,backgroundColor:e.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${t}-primary`]:{[`&:not([disabled]) + ${t}-compact-vertical-item${t}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:r(e.lineWidth).mul(-1).equal(),insetInlineStart:r(e.lineWidth).mul(-1).equal(),display:"inline-block",width:`calc(100% + ${lt(e.lineWidth)} * 2)`,height:e.lineWidth,backgroundColor:e.colorPrimaryHover,content:'""'}}}}}}},nRe=SF(["Button","compact"],e=>{const t=pre(e);return[gM(t),rRe(t),iRe(t)]},mre);var sRe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function aRe(e){if(typeof e=="object"&&e){let t=e==null?void 0:e.delay;return t=!Number.isNaN(t)&&typeof t=="number"?t:0,{loading:t<=0,delay:t}}return{loading:!!e,delay:0}}const oRe=(e,t)=>{var r,i;const{loading:n=!1,prefixCls:s,type:a="default",danger:o,shape:l="default",size:c,styles:d,disabled:u,className:h,rootClassName:f,children:p,icon:m,ghost:g=!1,block:v=!1,htmlType:y="button",classNames:b,style:x={}}=e,S=sRe(e,["loading","prefixCls","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","ghost","block","htmlType","classNames","style"]),{getPrefixCls:w,autoInsertSpaceInButton:E,direction:C,button:T}=_.useContext(br),A=w("btn",s),[M,P,I]=QIe(A),R=_.useContext(Jh),N=u??R,k=_.useContext(ure),O=_.useMemo(()=>aRe(n),[n]),[D,B]=_.useState(O.loading),[z,F]=_.useState(!1),Y=To(t,_.createRef()),W=_.Children.count(p)===1&&!m&&!CI(a);_.useEffect(()=>{let ye=null;O.delay>0?ye=setTimeout(()=>{ye=null,B(!0)},O.delay):B(O.loading);function q(){ye&&(clearTimeout(ye),ye=null)}return q},[O]),_.useEffect(()=>{if(!Y||!Y.current||E===!1)return;const ye=Y.current.textContent;W&&J3(ye)?z||F(!0):z&&F(!1)},[Y]);const X=ye=>{const{onClick:q}=e;if(D||N){ye.preventDefault();return}q==null||q(ye)},H=E!==!1,{compactSize:ie,compactItemClassnames:Q}=T0(A,C),Z={large:"lg",small:"sm",middle:void 0},ee=ef(ye=>{var q,U;return(U=(q=c??ie)!==null&&q!==void 0?q:k)!==null&&U!==void 0?U:ye}),re=ee&&Z[ee]||"",ne=D?"loading":m,se=Pa(S,["navigate"]),fe=Fe(A,P,I,{[`${A}-${l}`]:l!=="default"&&l,[`${A}-${a}`]:a,[`${A}-${re}`]:re,[`${A}-icon-only`]:!p&&p!==0&&!!ne,[`${A}-background-ghost`]:g&&!CI(a),[`${A}-loading`]:D,[`${A}-two-chinese-chars`]:z&&H&&!D,[`${A}-block`]:v,[`${A}-dangerous`]:!!o,[`${A}-rtl`]:C==="rtl"},Q,h,f,T==null?void 0:T.className),me=Object.assign(Object.assign({},T==null?void 0:T.style),x),Oe=Fe(b==null?void 0:b.icon,(r=T==null?void 0:T.classNames)===null||r===void 0?void 0:r.icon),Ee=Object.assign(Object.assign({},(d==null?void 0:d.icon)||{}),((i=T==null?void 0:T.styles)===null||i===void 0?void 0:i.icon)||{}),Se=m&&!D?Ge.createElement(dre,{prefixCls:A,className:Oe,style:Ee},m):Ge.createElement(NIe,{existIcon:!!m,prefixCls:A,loading:!!D}),de=p||p===0?DIe(p,W&&H):null;if(se.href!==void 0)return M(Ge.createElement("a",Object.assign({},se,{className:Fe(fe,{[`${A}-disabled`]:N}),href:N?void 0:se.href,style:me,onClick:X,ref:Y,tabIndex:N?-1:0}),Se,de));let be=Ge.createElement("button",Object.assign({},S,{type:y,className:fe,style:me,onClick:X,disabled:N,ref:Y}),Se,de,Q&&Ge.createElement(nRe,{key:"compact",prefixCls:A}));return CI(a)||(be=Ge.createElement(ore,{component:"Button",disabled:!!D},be)),M(be)},RF=_.forwardRef(oRe);RF.Group=IIe;RF.__ANT_BUTTON=!0;const ql=RF;var gre=_.createContext(null),I6=[];function lRe(e,t){var r=_.useState(function(){if(!_a())return null;var p=document.createElement("div");return p}),i=Pe(r,1),n=i[0],s=_.useRef(!1),a=_.useContext(gre),o=_.useState(I6),l=Pe(o,2),c=l[0],d=l[1],u=a||(s.current?void 0:function(p){d(function(m){var g=[p].concat(ft(m));return g})});function h(){n.parentElement||document.body.appendChild(n),s.current=!0}function f(){var p;(p=n.parentElement)===null||p===void 0||p.removeChild(n),s.current=!1}return mi(function(){return e?a?a(h):h():f(),f},[e]),mi(function(){c.length&&(c.forEach(function(p){return p()}),d(I6))},[c]),[n,u]}var MI;function cRe(e){if(typeof document>"u")return 0;if(e||MI===void 0){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var r=document.createElement("div"),i=r.style;i.position="absolute",i.top="0",i.left="0",i.pointerEvents="none",i.visibility="hidden",i.width="200px",i.height="150px",i.overflow="hidden",r.appendChild(t),document.body.appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var s=t.offsetWidth;n===s&&(s=r.clientWidth),document.body.removeChild(r),MI=n-s}return MI}function R6(e){var t=e.match(/^(.*)px$/),r=Number(t==null?void 0:t[1]);return Number.isNaN(r)?cRe():r}function uRe(e){if(typeof document>"u"||!e||!(e instanceof Element))return{width:0,height:0};var t=getComputedStyle(e,"::-webkit-scrollbar"),r=t.width,i=t.height;return{width:R6(r),height:R6(i)}}function dRe(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var hRe="rc-util-locker-".concat(Date.now()),D6=0;function fRe(e){var t=!!e,r=_.useState(function(){return D6+=1,"".concat(hRe,"_").concat(D6)}),i=Pe(r,1),n=i[0];mi(function(){if(t){var s=uRe(document.body).width,a=dRe();jh(`
html body {
  overflow-y: hidden;
  `.concat(a?"width: calc(100% - ".concat(s,"px);"):"",`
}`),n)}else qb(n);return function(){qb(n)}},[t,n])}var O6=!1;function pRe(e){return typeof e=="boolean"&&(O6=e),O6}var L6=function(t){return t===!1?!1:!_a()||!t?null:typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t},vre=_.forwardRef(function(e,t){var r=e.open,i=e.autoLock,n=e.getContainer;e.debug;var s=e.autoDestroy,a=s===void 0?!0:s,o=e.children,l=_.useState(r),c=Pe(l,2),d=c[0],u=c[1],h=d||r;_.useEffect(function(){(a||r)&&u(r)},[r,a]);var f=_.useState(function(){return L6(n)}),p=Pe(f,2),m=p[0],g=p[1];_.useEffect(function(){var M=L6(n);g(M??null)});var v=lRe(h&&!m),y=Pe(v,2),b=y[0],x=y[1],S=m??b;fRe(i&&r&&_a()&&(S===b||S===document.body));var w=null;if(o&&gd(o)&&t){var E=o;w=E.ref}var C=C0(w,t);if(!h||!_a()||m===void 0)return null;var T=S===!1||pRe(),A=o;return t&&(A=_.cloneElement(o,{ref:C})),_.createElement(gre.Provider,{value:x},T?A:Vl.createPortal(A,S))});function mRe(){var e=_e({},Zu);return e.useId}var N6=0,k6=mRe();const gRe=k6?function(t){var r=k6();return t||r}:function(t){var r=_.useState("ssr-id"),i=Pe(r,2),n=i[0],s=i[1];return _.useEffect(function(){var a=N6;N6+=1,s("rc_unique_".concat(a))},[]),t||n};var jf="RC_FORM_INTERNAL_HOOKS",ai=function(){As(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Op=_.createContext({getFieldValue:ai,getFieldsValue:ai,getFieldError:ai,getFieldWarning:ai,getFieldsError:ai,isFieldsTouched:ai,isFieldTouched:ai,isFieldValidating:ai,isFieldsValidating:ai,resetFields:ai,setFields:ai,setFieldValue:ai,setFieldsValue:ai,validateFields:ai,submit:ai,getInternalHooks:function(){return ai(),{dispatch:ai,initEntityValue:ai,registerField:ai,useSubscribe:ai,setInitialValues:ai,destroyForm:ai,setCallbacks:ai,registerWatch:ai,getFields:ai,setValidateMessages:ai,setPreserve:ai,getInitialValue:ai}}}),Qb=_.createContext(null);function eL(e){return e==null?[]:Array.isArray(e)?e:[e]}function vRe(e){return e&&!!e._init}function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Vf.apply(this,arguments)}function yRe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Zb(e,t)}function tL(e){return tL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tL(e)}function Zb(e,t){return Zb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},Zb(e,t)}function bRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vE(e,t,r){return bRe()?vE=Reflect.construct.bind():vE=function(n,s,a){var o=[null];o.push.apply(o,s);var l=Function.bind.apply(n,o),c=new l;return a&&Zb(c,a.prototype),c},vE.apply(null,arguments)}function xRe(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function rL(e){var t=typeof Map=="function"?new Map:void 0;return rL=function(i){if(i===null||!xRe(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,n)}function n(){return vE(i,arguments,tL(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Zb(n,i)},rL(e)}var wRe=/%[sdj%]/g,_Re=function(){};typeof process<"u"&&process.env;function iL(e){if(!e||!e.length)return null;var t={};return e.forEach(function(r){var i=r.field;t[i]=t[i]||[],t[i].push(r)}),t}function po(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var n=0,s=r.length;if(typeof e=="function")return e.apply(null,r);if(typeof e=="string"){var a=e.replace(wRe,function(o){if(o==="%%")return"%";if(n>=s)return o;switch(o){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch{return"[Circular]"}break;default:return o}});return a}return e}function SRe(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function $n(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||SRe(t)&&typeof e=="string"&&!e)}function ERe(e,t,r){var i=[],n=0,s=e.length;function a(o){i.push.apply(i,o||[]),n++,n===s&&r(i)}e.forEach(function(o){t(o,a)})}function z6(e,t,r){var i=0,n=e.length;function s(a){if(a&&a.length){r(a);return}var o=i;i=i+1,o<n?t(e[o],s):r([])}s([])}function CRe(e){var t=[];return Object.keys(e).forEach(function(r){t.push.apply(t,e[r]||[])}),t}var B6=function(e){yRe(t,e);function t(r,i){var n;return n=e.call(this,"Async Validation Error")||this,n.errors=r,n.fields=i,n}return t}(rL(Error));function ARe(e,t,r,i,n){if(t.first){var s=new Promise(function(h,f){var p=function(v){return i(v),v.length?f(new B6(v,iL(v))):h(n)},m=CRe(e);z6(m,r,p)});return s.catch(function(h){return h}),s}var a=t.firstFields===!0?Object.keys(e):t.firstFields||[],o=Object.keys(e),l=o.length,c=0,d=[],u=new Promise(function(h,f){var p=function(g){if(d.push.apply(d,g),c++,c===l)return i(d),d.length?f(new B6(d,iL(d))):h(n)};o.length||(i(d),h(n)),o.forEach(function(m){var g=e[m];a.indexOf(m)!==-1?z6(g,r,p):ERe(g,r,p)})});return u.catch(function(h){return h}),u}function TRe(e){return!!(e&&e.message!==void 0)}function MRe(e,t){for(var r=e,i=0;i<t.length;i++){if(r==null)return r;r=r[t[i]]}return r}function F6(e,t){return function(r){var i;return e.fullFields?i=MRe(t,e.fullFields):i=t[r.field||e.fullField],TRe(r)?(r.field=r.field||e.fullField,r.fieldValue=i,r):{message:typeof r=="function"?r():r,fieldValue:i,field:r.field||e.fullField}}}function j6(e,t){if(t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];typeof i=="object"&&typeof e[r]=="object"?e[r]=Vf({},e[r],i):e[r]=i}}return e}var yre=function(t,r,i,n,s,a){t.required&&(!i.hasOwnProperty(t.field)||$n(r,a||t.type))&&n.push(po(s.messages.required,t.fullField))},PRe=function(t,r,i,n,s){(/^\s+$/.test(r)||r==="")&&n.push(po(s.messages.whitespace,t.fullField))},y_,IRe=function(){if(y_)return y_;var e="[a-fA-F\\d:]",t=function(x){return x&&x.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},r="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",n=(`
(?:
(?:`+i+":){7}(?:"+i+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+i+":){6}(?:"+r+"|:"+i+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+i+":){5}(?::"+r+"|(?::"+i+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+i+":){4}(?:(?::"+i+"){0,1}:"+r+"|(?::"+i+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+i+":){3}(?:(?::"+i+"){0,2}:"+r+"|(?::"+i+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+i+":){2}(?:(?::"+i+"){0,3}:"+r+"|(?::"+i+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+i+":){1}(?:(?::"+i+"){0,4}:"+r+"|(?::"+i+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+i+"){0,5}:"+r+"|(?::"+i+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp("(?:^"+r+"$)|(?:^"+n+"$)"),a=new RegExp("^"+r+"$"),o=new RegExp("^"+n+"$"),l=function(x){return x&&x.exact?s:new RegExp("(?:"+t(x)+r+t(x)+")|(?:"+t(x)+n+t(x)+")","g")};l.v4=function(b){return b&&b.exact?a:new RegExp(""+t(b)+r+t(b),"g")},l.v6=function(b){return b&&b.exact?o:new RegExp(""+t(b)+n+t(b),"g")};var c="(?:(?:[a-z]+:)?//)",d="(?:\\S+(?::\\S*)?@)?",u=l.v4().source,h=l.v6().source,f="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",p="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",m="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",g="(?::\\d{2,5})?",v='(?:[/?#][^\\s"]*)?',y="(?:"+c+"|www\\.)"+d+"(?:localhost|"+u+"|"+h+"|"+f+p+m+")"+g+v;return y_=new RegExp("(?:^"+y+"$)","i"),y_},V6={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},u1={integer:function(t){return u1.number(t)&&parseInt(t,10)===t},float:function(t){return u1.number(t)&&!u1.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!u1.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(V6.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(IRe())},hex:function(t){return typeof t=="string"&&!!t.match(V6.hex)}},RRe=function(t,r,i,n,s){if(t.required&&r===void 0){yre(t,r,i,n,s);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=t.type;a.indexOf(o)>-1?u1[o](r)||n.push(po(s.messages.types[o],t.fullField,t.type)):o&&typeof r!==t.type&&n.push(po(s.messages.types[o],t.fullField,t.type))},DRe=function(t,r,i,n,s){var a=typeof t.len=="number",o=typeof t.min=="number",l=typeof t.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d=r,u=null,h=typeof r=="number",f=typeof r=="string",p=Array.isArray(r);if(h?u="number":f?u="string":p&&(u="array"),!u)return!1;p&&(d=r.length),f&&(d=r.replace(c,"_").length),a?d!==t.len&&n.push(po(s.messages[u].len,t.fullField,t.len)):o&&!l&&d<t.min?n.push(po(s.messages[u].min,t.fullField,t.min)):l&&!o&&d>t.max?n.push(po(s.messages[u].max,t.fullField,t.max)):o&&l&&(d<t.min||d>t.max)&&n.push(po(s.messages[u].range,t.fullField,t.min,t.max))},bm="enum",ORe=function(t,r,i,n,s){t[bm]=Array.isArray(t[bm])?t[bm]:[],t[bm].indexOf(r)===-1&&n.push(po(s.messages[bm],t.fullField,t[bm].join(", ")))},LRe=function(t,r,i,n,s){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(r)||n.push(po(s.messages.pattern.mismatch,t.fullField,r,t.pattern));else if(typeof t.pattern=="string"){var a=new RegExp(t.pattern);a.test(r)||n.push(po(s.messages.pattern.mismatch,t.fullField,r,t.pattern))}}},Er={required:yre,whitespace:PRe,type:RRe,range:DRe,enum:ORe,pattern:LRe},NRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r,"string")&&!t.required)return i();Er.required(t,r,n,a,s,"string"),$n(r,"string")||(Er.type(t,r,n,a,s),Er.range(t,r,n,a,s),Er.pattern(t,r,n,a,s),t.whitespace===!0&&Er.whitespace(t,r,n,a,s))}i(a)},kRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&Er.type(t,r,n,a,s)}i(a)},zRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if(r===""&&(r=void 0),$n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&(Er.type(t,r,n,a,s),Er.range(t,r,n,a,s))}i(a)},BRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&Er.type(t,r,n,a,s)}i(a)},FRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),$n(r)||Er.type(t,r,n,a,s)}i(a)},jRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&(Er.type(t,r,n,a,s),Er.range(t,r,n,a,s))}i(a)},VRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&(Er.type(t,r,n,a,s),Er.range(t,r,n,a,s))}i(a)},URe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if(r==null&&!t.required)return i();Er.required(t,r,n,a,s,"array"),r!=null&&(Er.type(t,r,n,a,s),Er.range(t,r,n,a,s))}i(a)},$Re=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&Er.type(t,r,n,a,s)}i(a)},HRe="enum",WRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s),r!==void 0&&Er[HRe](t,r,n,a,s)}i(a)},GRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r,"string")&&!t.required)return i();Er.required(t,r,n,a,s),$n(r,"string")||Er.pattern(t,r,n,a,s)}i(a)},qRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r,"date")&&!t.required)return i();if(Er.required(t,r,n,a,s),!$n(r,"date")){var l;r instanceof Date?l=r:l=new Date(r),Er.type(t,l,n,a,s),l&&Er.range(t,l.getTime(),n,a,s)}}i(a)},XRe=function(t,r,i,n,s){var a=[],o=Array.isArray(r)?"array":typeof r;Er.required(t,r,n,a,s,o),i(a)},PI=function(t,r,i,n,s){var a=t.type,o=[],l=t.required||!t.required&&n.hasOwnProperty(t.field);if(l){if($n(r,a)&&!t.required)return i();Er.required(t,r,n,o,s,a),$n(r,a)||Er.type(t,r,n,o,s)}i(o)},YRe=function(t,r,i,n,s){var a=[],o=t.required||!t.required&&n.hasOwnProperty(t.field);if(o){if($n(r)&&!t.required)return i();Er.required(t,r,n,a,s)}i(a)},G1={string:NRe,method:kRe,number:zRe,boolean:BRe,regexp:FRe,integer:jRe,float:VRe,array:URe,object:$Re,enum:WRe,pattern:GRe,date:qRe,url:PI,hex:PI,email:PI,required:XRe,any:YRe};function nL(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var sL=nL(),ow=function(){function e(r){this.rules=null,this._messages=sL,this.define(r)}var t=e.prototype;return t.define=function(i){var n=this;if(!i)throw new Error("Cannot configure a schema with no rules");if(typeof i!="object"||Array.isArray(i))throw new Error("Rules must be an object");this.rules={},Object.keys(i).forEach(function(s){var a=i[s];n.rules[s]=Array.isArray(a)?a:[a]})},t.messages=function(i){return i&&(this._messages=j6(nL(),i)),this._messages},t.validate=function(i,n,s){var a=this;n===void 0&&(n={}),s===void 0&&(s=function(){});var o=i,l=n,c=s;if(typeof l=="function"&&(c=l,l={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,o),Promise.resolve(o);function d(m){var g=[],v={};function y(x){if(Array.isArray(x)){var S;g=(S=g).concat.apply(S,x)}else g.push(x)}for(var b=0;b<m.length;b++)y(m[b]);g.length?(v=iL(g),c(g,v)):c(null,o)}if(l.messages){var u=this.messages();u===sL&&(u=nL()),j6(u,l.messages),l.messages=u}else l.messages=this.messages();var h={},f=l.keys||Object.keys(this.rules);f.forEach(function(m){var g=a.rules[m],v=o[m];g.forEach(function(y){var b=y;typeof b.transform=="function"&&(o===i&&(o=Vf({},o)),v=o[m]=b.transform(v)),typeof b=="function"?b={validator:b}:b=Vf({},b),b.validator=a.getValidationMethod(b),b.validator&&(b.field=m,b.fullField=b.fullField||m,b.type=a.getType(b),h[m]=h[m]||[],h[m].push({rule:b,value:v,source:o,field:m}))})});var p={};return ARe(h,l,function(m,g){var v=m.rule,y=(v.type==="object"||v.type==="array")&&(typeof v.fields=="object"||typeof v.defaultField=="object");y=y&&(v.required||!v.required&&m.value),v.field=m.field;function b(w,E){return Vf({},E,{fullField:v.fullField+"."+w,fullFields:v.fullFields?[].concat(v.fullFields,[w]):[w]})}function x(w){w===void 0&&(w=[]);var E=Array.isArray(w)?w:[w];!l.suppressWarning&&E.length&&e.warning("async-validator:",E),E.length&&v.message!==void 0&&(E=[].concat(v.message));var C=E.map(F6(v,o));if(l.first&&C.length)return p[v.field]=1,g(C);if(!y)g(C);else{if(v.required&&!m.value)return v.message!==void 0?C=[].concat(v.message).map(F6(v,o)):l.error&&(C=[l.error(v,po(l.messages.required,v.field))]),g(C);var T={};v.defaultField&&Object.keys(m.value).map(function(P){T[P]=v.defaultField}),T=Vf({},T,m.rule.fields);var A={};Object.keys(T).forEach(function(P){var I=T[P],R=Array.isArray(I)?I:[I];A[P]=R.map(b.bind(null,P))});var M=new e(A);M.messages(l.messages),m.rule.options&&(m.rule.options.messages=l.messages,m.rule.options.error=l.error),M.validate(m.value,m.rule.options||l,function(P){var I=[];C&&C.length&&I.push.apply(I,C),P&&P.length&&I.push.apply(I,P),g(I.length?I:null)})}}var S;if(v.asyncValidator)S=v.asyncValidator(v,m.value,x,m.source,l);else if(v.validator){try{S=v.validator(v,m.value,x,m.source,l)}catch(w){console.error==null||console.error(w),l.suppressValidatorError||setTimeout(function(){throw w},0),x(w.message)}S===!0?x():S===!1?x(typeof v.message=="function"?v.message(v.fullField||v.field):v.message||(v.fullField||v.field)+" fails"):S instanceof Array?x(S):S instanceof Error&&x(S.message)}S&&S.then&&S.then(function(){return x()},function(w){return x(w)})},function(m){d(m)},o)},t.getType=function(i){if(i.type===void 0&&i.pattern instanceof RegExp&&(i.type="pattern"),typeof i.validator!="function"&&i.type&&!G1.hasOwnProperty(i.type))throw new Error(po("Unknown rule type %s",i.type));return i.type||"string"},t.getValidationMethod=function(i){if(typeof i.validator=="function")return i.validator;var n=Object.keys(i),s=n.indexOf("message");return s!==-1&&n.splice(s,1),n.length===1&&n[0]==="required"?G1.required:G1[this.getType(i)]||void 0},e}();ow.register=function(t,r){if(typeof r!="function")throw new Error("Cannot register a validator by type, validator is not a function");G1[t]=r};ow.warning=_Re;ow.messages=sL;ow.validators=G1;var ro="'${name}' is not a valid ${type}",bre={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:ro,method:ro,array:ro,object:ro,number:ro,date:ro,boolean:ro,integer:ro,float:ro,regexp:ro,email:ro,url:ro,hex:ro},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},U6=ow;function KRe(e,t){return e.replace(/\$\{\w+\}/g,function(r){var i=r.slice(2,-1);return t[i]})}var $6="CODE_LOGIC_ERROR";function aL(e,t,r,i,n){return oL.apply(this,arguments)}function oL(){return oL=Jp(Sa().mark(function e(t,r,i,n,s){var a,o,l,c,d,u,h,f,p;return Sa().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a=_e({},i),delete a.ruleIndex,U6.warning=function(){},a.validator&&(o=a.validator,a.validator=function(){try{return o.apply(void 0,arguments)}catch(v){return console.error(v),Promise.reject($6)}}),l=null,a&&a.type==="array"&&a.defaultField&&(l=a.defaultField,delete a.defaultField),c=new U6(he({},t,[a])),d=zg(bre,n.validateMessages),c.messages(d),u=[],g.prev=10,g.next=13,Promise.resolve(c.validate(he({},t,r),_e({},n)));case 13:g.next=18;break;case 15:g.prev=15,g.t0=g.catch(10),g.t0.errors&&(u=g.t0.errors.map(function(v,y){var b=v.message,x=b===$6?d.default:b;return _.isValidElement(x)?_.cloneElement(x,{key:"error_".concat(y)}):x}));case 18:if(!(!u.length&&l)){g.next=23;break}return g.next=21,Promise.all(r.map(function(v,y){return aL("".concat(t,".").concat(y),v,l,n,s)}));case 21:return h=g.sent,g.abrupt("return",h.reduce(function(v,y){return[].concat(ft(v),ft(y))},[]));case 23:return f=_e(_e({},i),{},{name:t,enum:(i.enum||[]).join(", ")},s),p=u.map(function(v){return typeof v=="string"?KRe(v,f):v}),g.abrupt("return",p);case 26:case"end":return g.stop()}},e,null,[[10,15]])})),oL.apply(this,arguments)}function QRe(e,t,r,i,n,s){var a=e.join("."),o=r.map(function(d,u){var h=d.validator,f=_e(_e({},d),{},{ruleIndex:u});return h&&(f.validator=function(p,m,g){var v=!1,y=function(){for(var S=arguments.length,w=new Array(S),E=0;E<S;E++)w[E]=arguments[E];Promise.resolve().then(function(){As(!v,"Your validator function has already return a promise. `callback` will be ignored."),v||g.apply(void 0,w)})},b=h(p,m,y);v=b&&typeof b.then=="function"&&typeof b.catch=="function",As(v,"`callback` is deprecated. Please return a promise instead."),v&&b.then(function(){g()}).catch(function(x){g(x||" ")})}),f}).sort(function(d,u){var h=d.warningOnly,f=d.ruleIndex,p=u.warningOnly,m=u.ruleIndex;return!!h==!!p?f-m:h?1:-1}),l;if(n===!0)l=new Promise(function(){var d=Jp(Sa().mark(function u(h,f){var p,m,g;return Sa().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:p=0;case 1:if(!(p<o.length)){y.next=12;break}return m=o[p],y.next=5,aL(a,t,m,i,s);case 5:if(g=y.sent,!g.length){y.next=9;break}return f([{errors:g,rule:m}]),y.abrupt("return");case 9:p+=1,y.next=1;break;case 12:h([]);case 13:case"end":return y.stop()}},u)}));return function(u,h){return d.apply(this,arguments)}}());else{var c=o.map(function(d){return aL(a,t,d,i,s).then(function(u){return{errors:u,rule:d}})});l=(n?JRe(c):ZRe(c)).then(function(d){return Promise.reject(d)})}return l.catch(function(d){return d}),l}function ZRe(e){return lL.apply(this,arguments)}function lL(){return lL=Jp(Sa().mark(function e(t){return Sa().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.all(t).then(function(n){var s,a=(s=[]).concat.apply(s,ft(n));return a}));case 1:case"end":return i.stop()}},e)})),lL.apply(this,arguments)}function JRe(e){return cL.apply(this,arguments)}function cL(){return cL=Jp(Sa().mark(function e(t){var r;return Sa().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=0,n.abrupt("return",new Promise(function(s){t.forEach(function(a){a.then(function(o){o.errors.length&&s([o]),r+=1,r===t.length&&s([])})})}));case 2:case"end":return n.stop()}},e)})),cL.apply(this,arguments)}function sn(e){return eL(e)}function H6(e,t){var r={};return t.forEach(function(i){var n=Rc(e,i);r=El(r,i,n)}),r}function sv(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e&&e.some(function(i){return xre(t,i,r)})}function xre(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!e||!t||!r&&e.length!==t.length?!1:t.every(function(i,n){return e[n]===i})}function eDe(e,t){if(e===t)return!0;if(!e&&t||e&&!t||!e||!t||vr(e)!=="object"||vr(t)!=="object")return!1;var r=Object.keys(e),i=Object.keys(t),n=new Set([].concat(r,i));return ft(n).every(function(s){var a=e[s],o=t[s];return typeof a=="function"&&typeof o=="function"?!0:a===o})}function tDe(e){var t=arguments.length<=1?void 0:arguments[1];return t&&t.target&&vr(t.target)==="object"&&e in t.target?t.target[e]:t}function W6(e,t,r){var i=e.length;if(t<0||t>=i||r<0||r>=i)return e;var n=e[t],s=t-r;return s>0?[].concat(ft(e.slice(0,r)),[n],ft(e.slice(r,t)),ft(e.slice(t+1,i))):s<0?[].concat(ft(e.slice(0,t)),ft(e.slice(t+1,r+1)),[n],ft(e.slice(r+1,i))):e}var rDe=["name"],Ro=[];function G6(e,t,r,i,n,s){return typeof e=="function"?e(t,r,"source"in s?{source:s.source}:{}):i!==n}var DF=function(e){Kp(r,e);var t=Qp(r);function r(i){var n;if(Ds(this,r),n=t.call(this,i),he(Nr(n),"state",{resetCount:0}),he(Nr(n),"cancelRegisterFunc",null),he(Nr(n),"mounted",!1),he(Nr(n),"touched",!1),he(Nr(n),"dirty",!1),he(Nr(n),"validatePromise",void 0),he(Nr(n),"prevValidating",void 0),he(Nr(n),"errors",Ro),he(Nr(n),"warnings",Ro),he(Nr(n),"cancelRegister",function(){var l=n.props,c=l.preserve,d=l.isListField,u=l.name;n.cancelRegisterFunc&&n.cancelRegisterFunc(d,c,sn(u)),n.cancelRegisterFunc=null}),he(Nr(n),"getNamePath",function(){var l=n.props,c=l.name,d=l.fieldContext,u=d.prefixName,h=u===void 0?[]:u;return c!==void 0?[].concat(ft(h),ft(c)):[]}),he(Nr(n),"getRules",function(){var l=n.props,c=l.rules,d=c===void 0?[]:c,u=l.fieldContext;return d.map(function(h){return typeof h=="function"?h(u):h})}),he(Nr(n),"refresh",function(){n.mounted&&n.setState(function(l){var c=l.resetCount;return{resetCount:c+1}})}),he(Nr(n),"metaCache",null),he(Nr(n),"triggerMetaEvent",function(l){var c=n.props.onMetaChange;if(c){var d=_e(_e({},n.getMeta()),{},{destroy:l});aM(n.metaCache,d)||c(d),n.metaCache=d}else n.metaCache=null}),he(Nr(n),"onStoreChange",function(l,c,d){var u=n.props,h=u.shouldUpdate,f=u.dependencies,p=f===void 0?[]:f,m=u.onReset,g=d.store,v=n.getNamePath(),y=n.getValue(l),b=n.getValue(g),x=c&&sv(c,v);switch(d.type==="valueUpdate"&&d.source==="external"&&y!==b&&(n.touched=!0,n.dirty=!0,n.validatePromise=null,n.errors=Ro,n.warnings=Ro,n.triggerMetaEvent()),d.type){case"reset":if(!c||x){n.touched=!1,n.dirty=!1,n.validatePromise=void 0,n.errors=Ro,n.warnings=Ro,n.triggerMetaEvent(),m==null||m(),n.refresh();return}break;case"remove":{if(h){n.reRender();return}break}case"setField":{var S=d.data;if(x){"touched"in S&&(n.touched=S.touched),"validating"in S&&!("originRCField"in S)&&(n.validatePromise=S.validating?Promise.resolve([]):null),"errors"in S&&(n.errors=S.errors||Ro),"warnings"in S&&(n.warnings=S.warnings||Ro),n.dirty=!0,n.triggerMetaEvent(),n.reRender();return}else if("value"in S&&sv(c,v,!0)){n.reRender();return}if(h&&!v.length&&G6(h,l,g,y,b,d)){n.reRender();return}break}case"dependenciesUpdate":{var w=p.map(sn);if(w.some(function(E){return sv(d.relatedFields,E)})){n.reRender();return}break}default:if(x||(!p.length||v.length||h)&&G6(h,l,g,y,b,d)){n.reRender();return}break}h===!0&&n.reRender()}),he(Nr(n),"validateRules",function(l){var c=n.getNamePath(),d=n.getValue(),u=l||{},h=u.triggerName,f=u.validateOnly,p=f===void 0?!1:f,m=Promise.resolve().then(Jp(Sa().mark(function g(){var v,y,b,x,S,w,E;return Sa().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(n.mounted){T.next=2;break}return T.abrupt("return",[]);case 2:if(v=n.props,y=v.validateFirst,b=y===void 0?!1:y,x=v.messageVariables,S=v.validateDebounce,w=n.getRules(),h&&(w=w.filter(function(A){return A}).filter(function(A){var M=A.validateTrigger;if(!M)return!0;var P=eL(M);return P.includes(h)})),!(S&&h)){T.next=10;break}return T.next=8,new Promise(function(A){setTimeout(A,S)});case 8:if(n.validatePromise===m){T.next=10;break}return T.abrupt("return",[]);case 10:return E=QRe(c,d,w,l,b,x),E.catch(function(A){return A}).then(function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ro;if(n.validatePromise===m){var M;n.validatePromise=null;var P=[],I=[];(M=A.forEach)===null||M===void 0||M.call(A,function(R){var N=R.rule.warningOnly,k=R.errors,O=k===void 0?Ro:k;N?I.push.apply(I,ft(O)):P.push.apply(P,ft(O))}),n.errors=P,n.warnings=I,n.triggerMetaEvent(),n.reRender()}}),T.abrupt("return",E);case 13:case"end":return T.stop()}},g)})));return p||(n.validatePromise=m,n.dirty=!0,n.errors=Ro,n.warnings=Ro,n.triggerMetaEvent(),n.reRender()),m}),he(Nr(n),"isFieldValidating",function(){return!!n.validatePromise}),he(Nr(n),"isFieldTouched",function(){return n.touched}),he(Nr(n),"isFieldDirty",function(){if(n.dirty||n.props.initialValue!==void 0)return!0;var l=n.props.fieldContext,c=l.getInternalHooks(jf),d=c.getInitialValue;return d(n.getNamePath())!==void 0}),he(Nr(n),"getErrors",function(){return n.errors}),he(Nr(n),"getWarnings",function(){return n.warnings}),he(Nr(n),"isListField",function(){return n.props.isListField}),he(Nr(n),"isList",function(){return n.props.isList}),he(Nr(n),"isPreserve",function(){return n.props.preserve}),he(Nr(n),"getMeta",function(){n.prevValidating=n.isFieldValidating();var l={touched:n.isFieldTouched(),validating:n.prevValidating,errors:n.errors,warnings:n.warnings,name:n.getNamePath(),validated:n.validatePromise===null};return l}),he(Nr(n),"getOnlyChild",function(l){if(typeof l=="function"){var c=n.getMeta();return _e(_e({},n.getOnlyChild(l(n.getControlled(),c,n.props.fieldContext))),{},{isFunction:!0})}var d=Qc(l);return d.length!==1||!_.isValidElement(d[0])?{child:d,isFunction:!1}:{child:d[0],isFunction:!1}}),he(Nr(n),"getValue",function(l){var c=n.props.fieldContext.getFieldsValue,d=n.getNamePath();return Rc(l||c(!0),d)}),he(Nr(n),"getControlled",function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=n.props,d=c.trigger,u=c.validateTrigger,h=c.getValueFromEvent,f=c.normalize,p=c.valuePropName,m=c.getValueProps,g=c.fieldContext,v=u!==void 0?u:g.validateTrigger,y=n.getNamePath(),b=g.getInternalHooks,x=g.getFieldsValue,S=b(jf),w=S.dispatch,E=n.getValue(),C=m||function(P){return he({},p,P)},T=l[d],A=_e(_e({},l),C(E));A[d]=function(){n.touched=!0,n.dirty=!0,n.triggerMetaEvent();for(var P,I=arguments.length,R=new Array(I),N=0;N<I;N++)R[N]=arguments[N];h?P=h.apply(void 0,R):P=tDe.apply(void 0,[p].concat(R)),f&&(P=f(P,E,x(!0))),w({type:"updateValue",namePath:y,value:P}),T&&T.apply(void 0,R)};var M=eL(v||[]);return M.forEach(function(P){var I=A[P];A[P]=function(){I&&I.apply(void 0,arguments);var R=n.props.rules;R&&R.length&&w({type:"validateField",namePath:y,triggerName:P})}}),A}),i.fieldContext){var s=i.fieldContext.getInternalHooks,a=s(jf),o=a.initEntityValue;o(Nr(n))}return n}return Os(r,[{key:"componentDidMount",value:function(){var n=this.props,s=n.shouldUpdate,a=n.fieldContext;if(this.mounted=!0,a){var o=a.getInternalHooks,l=o(jf),c=l.registerField;this.cancelRegisterFunc=c(this)}s===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var n=this.state.resetCount,s=this.props.children,a=this.getOnlyChild(s),o=a.child,l=a.isFunction,c;return l?c=o:_.isValidElement(o)?c=_.cloneElement(o,this.getControlled(o.props)):(As(!o,"`children` of Field is not validate ReactElement."),c=o),_.createElement(_.Fragment,{key:n},c)}}]),r}(_.Component);he(DF,"contextType",Op);he(DF,"defaultProps",{trigger:"onChange",valuePropName:"value"});function OF(e){var t=e.name,r=hr(e,rDe),i=_.useContext(Op),n=_.useContext(Qb),s=t!==void 0?sn(t):void 0,a="keep";return r.isListField||(a="_".concat((s||[]).join("_"))),_.createElement(DF,ae({key:a,name:s,isListField:!!n},r,{fieldContext:i}))}function wre(e){var t=e.name,r=e.initialValue,i=e.children,n=e.rules,s=e.validateTrigger,a=e.isListField,o=_.useContext(Op),l=_.useContext(Qb),c=_.useRef({keys:[],id:0}),d=c.current,u=_.useMemo(function(){var m=sn(o.prefixName)||[];return[].concat(ft(m),ft(sn(t)))},[o.prefixName,t]),h=_.useMemo(function(){return _e(_e({},o),{},{prefixName:u})},[o,u]),f=_.useMemo(function(){return{getKey:function(g){var v=u.length,y=g[v];return[d.keys[y],g.slice(v+1)]}}},[u]);if(typeof i!="function")return As(!1,"Form.List only accepts function as children."),null;var p=function(g,v,y){var b=y.source;return b==="internal"?!1:g!==v};return _.createElement(Qb.Provider,{value:f},_.createElement(Op.Provider,{value:h},_.createElement(OF,{name:[],shouldUpdate:p,rules:n,validateTrigger:s,initialValue:r,isList:!0,isListField:a??!!l},function(m,g){var v=m.value,y=v===void 0?[]:v,b=m.onChange,x=o.getFieldValue,S=function(){var T=x(u||[]);return T||[]},w={add:function(T,A){var M=S();A>=0&&A<=M.length?(d.keys=[].concat(ft(d.keys.slice(0,A)),[d.id],ft(d.keys.slice(A))),b([].concat(ft(M.slice(0,A)),[T],ft(M.slice(A))))):(d.keys=[].concat(ft(d.keys),[d.id]),b([].concat(ft(M),[T]))),d.id+=1},remove:function(T){var A=S(),M=new Set(Array.isArray(T)?T:[T]);M.size<=0||(d.keys=d.keys.filter(function(P,I){return!M.has(I)}),b(A.filter(function(P,I){return!M.has(I)})))},move:function(T,A){if(T!==A){var M=S();T<0||T>=M.length||A<0||A>=M.length||(d.keys=W6(d.keys,T,A),b(W6(M,T,A)))}}},E=y||[];return Array.isArray(E)||(E=[]),i(E.map(function(C,T){var A=d.keys[T];return A===void 0&&(d.keys[T]=d.id,A=d.keys[T],d.id+=1),{name:T,key:A,isListField:!0}}),w,g)})))}function iDe(e){var t=!1,r=e.length,i=[];return e.length?new Promise(function(n,s){e.forEach(function(a,o){a.catch(function(l){return t=!0,l}).then(function(l){r-=1,i[o]=l,!(r>0)&&(t&&s(i),n(i))})})}):Promise.resolve([])}var _re="__@field_split__";function II(e){return e.map(function(t){return"".concat(vr(t),":").concat(t)}).join(_re)}var xm=function(){function e(){Ds(this,e),he(this,"kvs",new Map)}return Os(e,[{key:"set",value:function(r,i){this.kvs.set(II(r),i)}},{key:"get",value:function(r){return this.kvs.get(II(r))}},{key:"update",value:function(r,i){var n=this.get(r),s=i(n);s?this.set(r,s):this.delete(r)}},{key:"delete",value:function(r){this.kvs.delete(II(r))}},{key:"map",value:function(r){return ft(this.kvs.entries()).map(function(i){var n=Pe(i,2),s=n[0],a=n[1],o=s.split(_re);return r({key:o.map(function(l){var c=l.match(/^([^:]*):(.*)$/),d=Pe(c,3),u=d[1],h=d[2];return u==="number"?Number(h):h}),value:a})})}},{key:"toJSON",value:function(){var r={};return this.map(function(i){var n=i.key,s=i.value;return r[n.join(".")]=s,null}),r}}]),e}(),nDe=["name"],sDe=Os(function e(t){var r=this;Ds(this,e),he(this,"formHooked",!1),he(this,"forceRootUpdate",void 0),he(this,"subscribable",!0),he(this,"store",{}),he(this,"fieldEntities",[]),he(this,"initialValues",{}),he(this,"callbacks",{}),he(this,"validateMessages",null),he(this,"preserve",null),he(this,"lastValidatePromise",null),he(this,"getForm",function(){return{getFieldValue:r.getFieldValue,getFieldsValue:r.getFieldsValue,getFieldError:r.getFieldError,getFieldWarning:r.getFieldWarning,getFieldsError:r.getFieldsError,isFieldsTouched:r.isFieldsTouched,isFieldTouched:r.isFieldTouched,isFieldValidating:r.isFieldValidating,isFieldsValidating:r.isFieldsValidating,resetFields:r.resetFields,setFields:r.setFields,setFieldValue:r.setFieldValue,setFieldsValue:r.setFieldsValue,validateFields:r.validateFields,submit:r.submit,_init:!0,getInternalHooks:r.getInternalHooks}}),he(this,"getInternalHooks",function(i){return i===jf?(r.formHooked=!0,{dispatch:r.dispatch,initEntityValue:r.initEntityValue,registerField:r.registerField,useSubscribe:r.useSubscribe,setInitialValues:r.setInitialValues,destroyForm:r.destroyForm,setCallbacks:r.setCallbacks,setValidateMessages:r.setValidateMessages,getFields:r.getFields,setPreserve:r.setPreserve,getInitialValue:r.getInitialValue,registerWatch:r.registerWatch}):(As(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),he(this,"useSubscribe",function(i){r.subscribable=i}),he(this,"prevWithoutPreserves",null),he(this,"setInitialValues",function(i,n){if(r.initialValues=i||{},n){var s,a=zg(i,r.store);(s=r.prevWithoutPreserves)===null||s===void 0||s.map(function(o){var l=o.key;a=El(a,l,Rc(i,l))}),r.prevWithoutPreserves=null,r.updateStore(a)}}),he(this,"destroyForm",function(){var i=new xm;r.getFieldEntities(!0).forEach(function(n){r.isMergedPreserve(n.isPreserve())||i.set(n.getNamePath(),!0)}),r.prevWithoutPreserves=i}),he(this,"getInitialValue",function(i){var n=Rc(r.initialValues,i);return i.length?zg(n):n}),he(this,"setCallbacks",function(i){r.callbacks=i}),he(this,"setValidateMessages",function(i){r.validateMessages=i}),he(this,"setPreserve",function(i){r.preserve=i}),he(this,"watchList",[]),he(this,"registerWatch",function(i){return r.watchList.push(i),function(){r.watchList=r.watchList.filter(function(n){return n!==i})}}),he(this,"notifyWatch",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(r.watchList.length){var n=r.getFieldsValue(),s=r.getFieldsValue(!0);r.watchList.forEach(function(a){a(n,s,i)})}}),he(this,"timeoutId",null),he(this,"warningUnhooked",function(){}),he(this,"updateStore",function(i){r.store=i}),he(this,"getFieldEntities",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return i?r.fieldEntities.filter(function(n){return n.getNamePath().length}):r.fieldEntities}),he(this,"getFieldsMap",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=new xm;return r.getFieldEntities(i).forEach(function(s){var a=s.getNamePath();n.set(a,s)}),n}),he(this,"getFieldEntitiesForNamePathList",function(i){if(!i)return r.getFieldEntities(!0);var n=r.getFieldsMap(!0);return i.map(function(s){var a=sn(s);return n.get(a)||{INVALIDATE_NAME_PATH:sn(s)}})}),he(this,"getFieldsValue",function(i,n){r.warningUnhooked();var s,a,o;if(i===!0||Array.isArray(i)?(s=i,a=n):i&&vr(i)==="object"&&(o=i.strict,a=i.filter),s===!0&&!a)return r.store;var l=r.getFieldEntitiesForNamePathList(Array.isArray(s)?s:null),c=[];return l.forEach(function(d){var u,h,f="INVALIDATE_NAME_PATH"in d?d.INVALIDATE_NAME_PATH:d.getNamePath();if(o){var p,m;if((p=(m=d).isList)!==null&&p!==void 0&&p.call(m))return}else if(!s&&(u=(h=d).isListField)!==null&&u!==void 0&&u.call(h))return;if(!a)c.push(f);else{var g="getMeta"in d?d.getMeta():null;a(g)&&c.push(f)}}),H6(r.store,c.map(sn))}),he(this,"getFieldValue",function(i){r.warningUnhooked();var n=sn(i);return Rc(r.store,n)}),he(this,"getFieldsError",function(i){r.warningUnhooked();var n=r.getFieldEntitiesForNamePathList(i);return n.map(function(s,a){return s&&!("INVALIDATE_NAME_PATH"in s)?{name:s.getNamePath(),errors:s.getErrors(),warnings:s.getWarnings()}:{name:sn(i[a]),errors:[],warnings:[]}})}),he(this,"getFieldError",function(i){r.warningUnhooked();var n=sn(i),s=r.getFieldsError([n])[0];return s.errors}),he(this,"getFieldWarning",function(i){r.warningUnhooked();var n=sn(i),s=r.getFieldsError([n])[0];return s.warnings}),he(this,"isFieldsTouched",function(){r.warningUnhooked();for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];var a=n[0],o=n[1],l,c=!1;n.length===0?l=null:n.length===1?Array.isArray(a)?(l=a.map(sn),c=!1):(l=null,c=a):(l=a.map(sn),c=o);var d=r.getFieldEntities(!0),u=function(g){return g.isFieldTouched()};if(!l)return c?d.every(u):d.some(u);var h=new xm;l.forEach(function(m){h.set(m,[])}),d.forEach(function(m){var g=m.getNamePath();l.forEach(function(v){v.every(function(y,b){return g[b]===y})&&h.update(v,function(y){return[].concat(ft(y),[m])})})});var f=function(g){return g.some(u)},p=h.map(function(m){var g=m.value;return g});return c?p.every(f):p.some(f)}),he(this,"isFieldTouched",function(i){return r.warningUnhooked(),r.isFieldsTouched([i])}),he(this,"isFieldsValidating",function(i){r.warningUnhooked();var n=r.getFieldEntities();if(!i)return n.some(function(a){return a.isFieldValidating()});var s=i.map(sn);return n.some(function(a){var o=a.getNamePath();return sv(s,o)&&a.isFieldValidating()})}),he(this,"isFieldValidating",function(i){return r.warningUnhooked(),r.isFieldsValidating([i])}),he(this,"resetWithFieldInitialValue",function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=new xm,s=r.getFieldEntities(!0);s.forEach(function(l){var c=l.props.initialValue,d=l.getNamePath();if(c!==void 0){var u=n.get(d)||new Set;u.add({entity:l,value:c}),n.set(d,u)}});var a=function(c){c.forEach(function(d){var u=d.props.initialValue;if(u!==void 0){var h=d.getNamePath(),f=r.getInitialValue(h);if(f!==void 0)As(!1,"Form already set 'initialValues' with path '".concat(h.join("."),"'. Field can not overwrite it."));else{var p=n.get(h);if(p&&p.size>1)As(!1,"Multiple Field with path '".concat(h.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(p){var m=r.getFieldValue(h),g=d.isListField();!g&&(!i.skipExist||m===void 0)&&r.updateStore(El(r.store,h,ft(p)[0].value))}}}})},o;i.entities?o=i.entities:i.namePathList?(o=[],i.namePathList.forEach(function(l){var c=n.get(l);if(c){var d;(d=o).push.apply(d,ft(ft(c).map(function(u){return u.entity})))}})):o=s,a(o)}),he(this,"resetFields",function(i){r.warningUnhooked();var n=r.store;if(!i){r.updateStore(zg(r.initialValues)),r.resetWithFieldInitialValue(),r.notifyObservers(n,null,{type:"reset"}),r.notifyWatch();return}var s=i.map(sn);s.forEach(function(a){var o=r.getInitialValue(a);r.updateStore(El(r.store,a,o))}),r.resetWithFieldInitialValue({namePathList:s}),r.notifyObservers(n,s,{type:"reset"}),r.notifyWatch(s)}),he(this,"setFields",function(i){r.warningUnhooked();var n=r.store,s=[];i.forEach(function(a){var o=a.name,l=hr(a,nDe),c=sn(o);s.push(c),"value"in l&&r.updateStore(El(r.store,c,l.value)),r.notifyObservers(n,[c],{type:"setField",data:a})}),r.notifyWatch(s)}),he(this,"getFields",function(){var i=r.getFieldEntities(!0),n=i.map(function(s){var a=s.getNamePath(),o=s.getMeta(),l=_e(_e({},o),{},{name:a,value:r.getFieldValue(a)});return Object.defineProperty(l,"originRCField",{value:!0}),l});return n}),he(this,"initEntityValue",function(i){var n=i.props.initialValue;if(n!==void 0){var s=i.getNamePath(),a=Rc(r.store,s);a===void 0&&r.updateStore(El(r.store,s,n))}}),he(this,"isMergedPreserve",function(i){var n=i!==void 0?i:r.preserve;return n??!0}),he(this,"registerField",function(i){r.fieldEntities.push(i);var n=i.getNamePath();if(r.notifyWatch([n]),i.props.initialValue!==void 0){var s=r.store;r.resetWithFieldInitialValue({entities:[i],skipExist:!0}),r.notifyObservers(s,[i.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(a,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(r.fieldEntities=r.fieldEntities.filter(function(u){return u!==i}),!r.isMergedPreserve(o)&&(!a||l.length>1)){var c=a?void 0:r.getInitialValue(n);if(n.length&&r.getFieldValue(n)!==c&&r.fieldEntities.every(function(u){return!xre(u.getNamePath(),n)})){var d=r.store;r.updateStore(El(d,n,c,!0)),r.notifyObservers(d,[n],{type:"remove"}),r.triggerDependenciesUpdate(d,n)}}r.notifyWatch([n])}}),he(this,"dispatch",function(i){switch(i.type){case"updateValue":{var n=i.namePath,s=i.value;r.updateValue(n,s);break}case"validateField":{var a=i.namePath,o=i.triggerName;r.validateFields([a],{triggerName:o});break}}}),he(this,"notifyObservers",function(i,n,s){if(r.subscribable){var a=_e(_e({},s),{},{store:r.getFieldsValue(!0)});r.getFieldEntities().forEach(function(o){var l=o.onStoreChange;l(i,n,a)})}else r.forceRootUpdate()}),he(this,"triggerDependenciesUpdate",function(i,n){var s=r.getDependencyChildrenFields(n);return s.length&&r.validateFields(s),r.notifyObservers(i,s,{type:"dependenciesUpdate",relatedFields:[n].concat(ft(s))}),s}),he(this,"updateValue",function(i,n){var s=sn(i),a=r.store;r.updateStore(El(r.store,s,n)),r.notifyObservers(a,[s],{type:"valueUpdate",source:"internal"}),r.notifyWatch([s]);var o=r.triggerDependenciesUpdate(a,s),l=r.callbacks.onValuesChange;if(l){var c=H6(r.store,[s]);l(c,r.getFieldsValue())}r.triggerOnFieldsChange([s].concat(ft(o)))}),he(this,"setFieldsValue",function(i){r.warningUnhooked();var n=r.store;if(i){var s=zg(r.store,i);r.updateStore(s)}r.notifyObservers(n,null,{type:"valueUpdate",source:"external"}),r.notifyWatch()}),he(this,"setFieldValue",function(i,n){r.setFields([{name:i,value:n}])}),he(this,"getDependencyChildrenFields",function(i){var n=new Set,s=[],a=new xm;r.getFieldEntities().forEach(function(l){var c=l.props.dependencies;(c||[]).forEach(function(d){var u=sn(d);a.update(u,function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return h.add(l),h})})});var o=function l(c){var d=a.get(c)||new Set;d.forEach(function(u){if(!n.has(u)){n.add(u);var h=u.getNamePath();u.isFieldDirty()&&h.length&&(s.push(h),l(h))}})};return o(i),s}),he(this,"triggerOnFieldsChange",function(i,n){var s=r.callbacks.onFieldsChange;if(s){var a=r.getFields();if(n){var o=new xm;n.forEach(function(c){var d=c.name,u=c.errors;o.set(d,u)}),a.forEach(function(c){c.errors=o.get(c.name)||c.errors})}var l=a.filter(function(c){var d=c.name;return sv(i,d)});l.length&&s(l,a)}}),he(this,"validateFields",function(i,n){r.warningUnhooked();var s,a;Array.isArray(i)||typeof i=="string"||typeof n=="string"?(s=i,a=n):a=i;var o=!!s,l=o?s.map(sn):[],c=[],d=String(Date.now()),u=new Set,h=a||{},f=h.recursive,p=h.dirty;r.getFieldEntities(!0).forEach(function(y){if(o||l.push(y.getNamePath()),!(!y.props.rules||!y.props.rules.length)&&!(p&&!y.isFieldDirty())){var b=y.getNamePath();if(u.add(b.join(d)),!o||sv(l,b,f)){var x=y.validateRules(_e({validateMessages:_e(_e({},bre),r.validateMessages)},a));c.push(x.then(function(){return{name:b,errors:[],warnings:[]}}).catch(function(S){var w,E=[],C=[];return(w=S.forEach)===null||w===void 0||w.call(S,function(T){var A=T.rule.warningOnly,M=T.errors;A?C.push.apply(C,ft(M)):E.push.apply(E,ft(M))}),E.length?Promise.reject({name:b,errors:E,warnings:C}):{name:b,errors:E,warnings:C}}))}}});var m=iDe(c);r.lastValidatePromise=m,m.catch(function(y){return y}).then(function(y){var b=y.map(function(x){var S=x.name;return S});r.notifyObservers(r.store,b,{type:"validateFinish"}),r.triggerOnFieldsChange(b,y)});var g=m.then(function(){return r.lastValidatePromise===m?Promise.resolve(r.getFieldsValue(l)):Promise.reject([])}).catch(function(y){var b=y.filter(function(x){return x&&x.errors.length});return Promise.reject({values:r.getFieldsValue(l),errorFields:b,outOfDate:r.lastValidatePromise!==m})});g.catch(function(y){return y});var v=l.filter(function(y){return u.has(y.join(d))});return r.triggerOnFieldsChange(v),g}),he(this,"submit",function(){r.warningUnhooked(),r.validateFields().then(function(i){var n=r.callbacks.onFinish;if(n)try{n(i)}catch(s){console.error(s)}}).catch(function(i){var n=r.callbacks.onFinishFailed;n&&n(i)})}),this.forceRootUpdate=t});function LF(e){var t=_.useRef(),r=_.useState({}),i=Pe(r,2),n=i[1];if(!t.current)if(e)t.current=e;else{var s=function(){n({})},a=new sDe(s);t.current=a.getForm()}return[t.current]}var uL=_.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),Sre=function(t){var r=t.validateMessages,i=t.onFormChange,n=t.onFormFinish,s=t.children,a=_.useContext(uL),o=_.useRef({});return _.createElement(uL.Provider,{value:_e(_e({},a),{},{validateMessages:_e(_e({},a.validateMessages),r),triggerFormChange:function(c,d){i&&i(c,{changedFields:d,forms:o.current}),a.triggerFormChange(c,d)},triggerFormFinish:function(c,d){n&&n(c,{values:d,forms:o.current}),a.triggerFormFinish(c,d)},registerForm:function(c,d){c&&(o.current=_e(_e({},o.current),{},he({},c,d))),a.registerForm(c,d)},unregisterForm:function(c){var d=_e({},o.current);delete d[c],o.current=d,a.unregisterForm(c)}})},s)},aDe=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],oDe=function(t,r){var i=t.name,n=t.initialValues,s=t.fields,a=t.form,o=t.preserve,l=t.children,c=t.component,d=c===void 0?"form":c,u=t.validateMessages,h=t.validateTrigger,f=h===void 0?"onChange":h,p=t.onValuesChange,m=t.onFieldsChange,g=t.onFinish,v=t.onFinishFailed,y=hr(t,aDe),b=_.useContext(uL),x=LF(a),S=Pe(x,1),w=S[0],E=w.getInternalHooks(jf),C=E.useSubscribe,T=E.setInitialValues,A=E.setCallbacks,M=E.setValidateMessages,P=E.setPreserve,I=E.destroyForm;_.useImperativeHandle(r,function(){return w}),_.useEffect(function(){return b.registerForm(i,w),function(){b.unregisterForm(i)}},[b,w,i]),M(_e(_e({},b.validateMessages),u)),A({onValuesChange:p,onFieldsChange:function(V){if(b.triggerFormChange(i,V),m){for(var Y=arguments.length,W=new Array(Y>1?Y-1:0),X=1;X<Y;X++)W[X-1]=arguments[X];m.apply(void 0,[V].concat(W))}},onFinish:function(V){b.triggerFormFinish(i,V),g&&g(V)},onFinishFailed:v}),P(o);var R=_.useRef(null);T(n,!R.current),R.current||(R.current=!0),_.useEffect(function(){return I},[]);var N,k=typeof l=="function";if(k){var O=w.getFieldsValue(!0);N=l(O,w)}else N=l;C(!k);var D=_.useRef();_.useEffect(function(){eDe(D.current||[],s||[])||w.setFields(s||[]),D.current=s},[s,w]);var B=_.useMemo(function(){return _e(_e({},w),{},{validateTrigger:f})},[w,f]),z=_.createElement(Qb.Provider,{value:null},_.createElement(Op.Provider,{value:B},N));return d===!1?z:_.createElement(d,ae({},y,{onSubmit:function(V){V.preventDefault(),V.stopPropagation(),w.submit()},onReset:function(V){var Y;V.preventDefault(),w.resetFields(),(Y=y.onReset)===null||Y===void 0||Y.call(y,V)}}),z)};function q6(e){try{return JSON.stringify(e)}catch{return Math.random()}}function Ere(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],n=t[1],s=n===void 0?{}:n,a=vRe(s)?{form:s}:s,o=a.form,l=_.useState(),c=Pe(l,2),d=c[0],u=c[1],h=_.useMemo(function(){return q6(d)},[d]),f=_.useRef(h);f.current=h;var p=_.useContext(Op),m=o||p,g=m&&m._init,v=sn(i),y=_.useRef(v);return y.current=v,_.useEffect(function(){if(g){var b=m.getFieldsValue,x=m.getInternalHooks,S=x(jf),w=S.registerWatch,E=function(M,P){var I=a.preserve?P:M;return typeof i=="function"?i(I):Rc(I,y.current)},C=w(function(A,M){var P=E(A,M),I=q6(P);f.current!==I&&(f.current=I,u(P))}),T=E(b(),b(!0));return d!==T&&u(T),C}},[g]),d}var lDe=_.forwardRef(oDe),M0=lDe;M0.FormProvider=Sre;M0.Field=OF;M0.List=wre;M0.useForm=LF;M0.useWatch=Ere;const cd=_.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),Cre=_.createContext(null),Are=e=>{const t=Pa(e,["prefixCls"]);return _.createElement(Sre,Object.assign({},t))},NF=_.createContext({prefixCls:""}),_o=_.createContext({}),eA=e=>{let{children:t,status:r,override:i}=e;const n=_.useContext(_o),s=_.useMemo(()=>{const a=Object.assign({},n);return i&&delete a.isFormItemInput,r&&(delete a.status,delete a.hasFeedback,delete a.feedbackIcon),a},[r,i,n]);return _.createElement(_o.Provider,{value:s},t)},cDe=e=>({animationDuration:e,animationFillMode:"both"}),uDe=e=>({animationDuration:e,animationFillMode:"both"}),kF=function(e,t,r,i){const s=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${s}${e}-enter,
      ${s}${e}-appear
    `]:Object.assign(Object.assign({},cDe(i)),{animationPlayState:"paused"}),[`${s}${e}-leave`]:Object.assign(Object.assign({},uDe(i)),{animationPlayState:"paused"}),[`
      ${s}${e}-enter${e}-enter-active,
      ${s}${e}-appear${e}-appear-active
    `]:{animationName:t,animationPlayState:"running"},[`${s}${e}-leave${e}-leave-active`]:{animationName:r,animationPlayState:"running",pointerEvents:"none"}}},dDe=new Rr("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),hDe=new Rr("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),fDe=new Rr("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),pDe=new Rr("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),mDe=new Rr("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),gDe=new Rr("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),vDe=new Rr("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),yDe=new Rr("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}}),bDe={"move-up":{inKeyframes:vDe,outKeyframes:yDe},"move-down":{inKeyframes:dDe,outKeyframes:hDe},"move-left":{inKeyframes:fDe,outKeyframes:pDe},"move-right":{inKeyframes:mDe,outKeyframes:gDe}},tA=(e,t)=>{const{antCls:r}=e,i=`${r}-${t}`,{inKeyframes:n,outKeyframes:s}=bDe[t];return[kF(i,n,s,e.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{opacity:0,animationTimingFunction:e.motionEaseOutCirc},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},zF=new Rr("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),BF=new Rr("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),FF=new Rr("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),jF=new Rr("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),xDe=new Rr("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),wDe=new Rr("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),_De=new Rr("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),SDe=new Rr("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),EDe={"slide-up":{inKeyframes:zF,outKeyframes:BF},"slide-down":{inKeyframes:FF,outKeyframes:jF},"slide-left":{inKeyframes:xDe,outKeyframes:wDe},"slide-right":{inKeyframes:_De,outKeyframes:SDe}},Hv=(e,t)=>{const{antCls:r}=e,i=`${r}-${t}`,{inKeyframes:n,outKeyframes:s}=EDe[t];return[kF(i,n,s,e.motionDurationMid),{[`
      ${i}-enter,
      ${i}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]},VF=new Rr("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),CDe=new Rr("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),X6=new Rr("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Y6=new Rr("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),ADe=new Rr("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),TDe=new Rr("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),MDe=new Rr("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),PDe=new Rr("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),IDe=new Rr("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),RDe=new Rr("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),DDe=new Rr("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),ODe=new Rr("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),LDe={zoom:{inKeyframes:VF,outKeyframes:CDe},"zoom-big":{inKeyframes:X6,outKeyframes:Y6},"zoom-big-fast":{inKeyframes:X6,outKeyframes:Y6},"zoom-left":{inKeyframes:MDe,outKeyframes:PDe},"zoom-right":{inKeyframes:IDe,outKeyframes:RDe},"zoom-up":{inKeyframes:ADe,outKeyframes:TDe},"zoom-down":{inKeyframes:DDe,outKeyframes:ODe}},vM=(e,t)=>{const{antCls:r}=e,i=`${r}-${t}`,{inKeyframes:n,outKeyframes:s}=LDe[t];return[kF(i,n,s,t==="zoom-big-fast"?e.motionDurationFast:e.motionDurationMid),{[`
        ${i}-enter,
        ${i}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},NDe=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}}),Tre=NDe,kDe=e=>{const{componentCls:t,notificationMarginEdge:r,animationMaxHeight:i}=e,n=`${t}-notice`,s=new Rr("antNotificationFadeIn",{"0%":{transform:"translate3d(100%, 0, 0)",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",opacity:1}}),a=new Rr("antNotificationTopFadeIn",{"0%":{top:-i,opacity:0},"100%":{top:0,opacity:1}}),o=new Rr("antNotificationBottomFadeIn",{"0%":{bottom:e.calc(i).mul(-1).equal(),opacity:0},"100%":{bottom:0,opacity:1}}),l=new Rr("antNotificationLeftFadeIn",{"0%":{transform:"translate3d(-100%, 0, 0)",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",opacity:1}});return{[t]:{[`&${t}-top, &${t}-bottom`]:{marginInline:0,[n]:{marginInline:"auto auto"}},[`&${t}-top`]:{[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:a}},[`&${t}-bottom`]:{[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:o}},[`&${t}-topRight, &${t}-bottomRight`]:{[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:s}},[`&${t}-topLeft, &${t}-bottomLeft`]:{marginRight:{value:0,_skip_check_:!0},marginLeft:{value:r,_skip_check_:!0},[n]:{marginInlineEnd:"auto",marginInlineStart:0},[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationName:l}}}}},zDe=kDe,BDe=["top","topLeft","topRight","bottom","bottomLeft","bottomRight"],FDe={topLeft:"left",topRight:"right",bottomLeft:"left",bottomRight:"right",top:"left",bottom:"left"},jDe=(e,t)=>{const{componentCls:r}=e;return{[`${r}-${t}`]:{[`&${r}-stack > ${r}-notice-wrapper`]:{[t.startsWith("top")?"top":"bottom"]:0,[FDe[t]]:{value:0,_skip_check_:!0}}}}},VDe=e=>{const t={};for(let r=1;r<e.notificationStackLayer;r++)t[`&:nth-last-child(${r+1})`]={overflow:"hidden",[`& > ${e.componentCls}-notice`]:{opacity:0,transition:`opacity ${e.motionDurationMid}`}};return Object.assign({[`&:not(:nth-last-child(-n+${e.notificationStackLayer}))`]:{opacity:0,overflow:"hidden",color:"transparent",pointerEvents:"none"}},t)},UDe=e=>{const t={};for(let r=1;r<e.notificationStackLayer;r++)t[`&:nth-last-child(${r+1})`]={background:e.colorBgBlur,backdropFilter:"blur(10px)","-webkit-backdrop-filter":"blur(10px)"};return Object.assign({},t)},$De=e=>{const{componentCls:t}=e;return Object.assign({[`${t}-stack`]:{[`& > ${t}-notice-wrapper`]:Object.assign({transition:`all ${e.motionDurationSlow}, backdrop-filter 0s`,position:"absolute"},VDe(e))},[`${t}-stack:not(${t}-stack-expanded)`]:{[`& > ${t}-notice-wrapper`]:Object.assign({},UDe(e))},[`${t}-stack${t}-stack-expanded`]:{[`& > ${t}-notice-wrapper`]:{"&:not(:nth-last-child(-n + 1))":{opacity:1,overflow:"unset",color:"inherit",pointerEvents:"auto",[`& > ${e.componentCls}-notice`]:{opacity:1}},"&:after":{content:'""',position:"absolute",height:e.margin,width:"100%",insetInline:0,bottom:e.calc(e.margin).mul(-1).equal(),background:"transparent",pointerEvents:"auto"}}}},BDe.map(r=>jDe(e,r)).reduce((r,i)=>Object.assign(Object.assign({},r),i),{}))},HDe=$De,Mre=e=>{const{iconCls:t,componentCls:r,boxShadow:i,fontSizeLG:n,notificationMarginBottom:s,borderRadiusLG:a,colorSuccess:o,colorInfo:l,colorWarning:c,colorError:d,colorTextHeading:u,notificationBg:h,notificationPadding:f,notificationMarginEdge:p,fontSize:m,lineHeight:g,width:v,notificationIconSize:y,colorText:b}=e,x=`${r}-notice`;return{position:"relative",marginBottom:s,marginInlineStart:"auto",background:h,borderRadius:a,boxShadow:i,[x]:{padding:f,width:v,maxWidth:`calc(100vw - ${lt(e.calc(p).mul(2).equal())})`,overflow:"hidden",lineHeight:g,wordWrap:"break-word"},[`${r}-close-icon`]:{fontSize:m,cursor:"pointer"},[`${x}-message`]:{marginBottom:e.marginXS,color:u,fontSize:n,lineHeight:e.lineHeightLG},[`${x}-description`]:{fontSize:m,color:b},[`${x}-closable ${x}-message`]:{paddingInlineEnd:e.paddingLG},[`${x}-with-icon ${x}-message`]:{marginBottom:e.marginXS,marginInlineStart:e.calc(e.marginSM).add(y).equal(),fontSize:n},[`${x}-with-icon ${x}-description`]:{marginInlineStart:e.calc(e.marginSM).add(y).equal(),fontSize:m},[`${x}-icon`]:{position:"absolute",fontSize:y,lineHeight:1,[`&-success${t}`]:{color:o},[`&-info${t}`]:{color:l},[`&-warning${t}`]:{color:c},[`&-error${t}`]:{color:d}},[`${x}-close`]:{position:"absolute",top:e.notificationPaddingVertical,insetInlineEnd:e.notificationPaddingHorizontal,color:e.colorIcon,outline:"none",width:e.notificationCloseButtonSize,height:e.notificationCloseButtonSize,borderRadius:e.borderRadiusSM,transition:`background-color ${e.motionDurationMid}, color ${e.motionDurationMid}`,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{color:e.colorIconHover,backgroundColor:e.closeBtnHoverBg}},[`${x}-btn`]:{float:"right",marginTop:e.marginSM}}},WDe=e=>{const{componentCls:t,notificationMarginBottom:r,notificationMarginEdge:i,motionDurationMid:n,motionEaseInOut:s}=e,a=`${t}-notice`,o=new Rr("antNotificationFadeOut",{"0%":{maxHeight:e.animationMaxHeight,marginBottom:r},"100%":{maxHeight:0,marginBottom:0,paddingTop:0,paddingBottom:0,opacity:0}});return[{[t]:Object.assign(Object.assign({},Vn(e)),{position:"fixed",zIndex:e.zIndexPopup,marginRight:{value:i,_skip_check_:!0},[`${t}-hook-holder`]:{position:"relative"},[`${t}-fade-appear-prepare`]:{opacity:"0 !important"},[`${t}-fade-enter, ${t}-fade-appear`]:{animationDuration:e.motionDurationMid,animationTimingFunction:s,animationFillMode:"both",opacity:0,animationPlayState:"paused"},[`${t}-fade-leave`]:{animationTimingFunction:s,animationFillMode:"both",animationDuration:n,animationPlayState:"paused"},[`${t}-fade-enter${t}-fade-enter-active, ${t}-fade-appear${t}-fade-appear-active`]:{animationPlayState:"running"},[`${t}-fade-leave${t}-fade-leave-active`]:{animationName:o,animationPlayState:"running"},"&-rtl":{direction:"rtl",[`${a}-btn`]:{float:"left"}}})},{[t]:{[`${a}-wrapper`]:Object.assign({},Mre(e))}}]},Pre=e=>({zIndexPopup:e.zIndexPopupBase+nre+50,width:384,closeBtnHoverBg:e.wireframe?"transparent":e.colorFillContent}),Ire=e=>{const t=e.paddingMD,r=e.paddingLG;return zr(e,{notificationBg:e.colorBgElevated,notificationPaddingVertical:t,notificationPaddingHorizontal:r,notificationIconSize:e.calc(e.fontSizeLG).mul(e.lineHeightLG).equal(),notificationCloseButtonSize:e.calc(e.controlHeightLG).mul(.55).equal(),notificationMarginBottom:e.margin,notificationPadding:`${lt(e.paddingMD)} ${lt(e.paddingContentHorizontalLG)}`,notificationMarginEdge:e.marginLG,animationMaxHeight:150,notificationStackLayer:3})},Rre=sa("Notification",e=>{const t=Ire(e);return[WDe(t),zDe(t),HDe(t)]},Pre),GDe=SF(["Notification","PurePanel"],e=>{const t=`${e.componentCls}-notice`,r=Ire(e);return{[`${t}-pure-panel`]:Object.assign(Object.assign({},Mre(r)),{width:r.width,maxWidth:`calc(100vw - ${lt(e.calc(r.notificationMarginEdge).mul(2).equal())})`,margin:0})}},Pre);var qDe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function UF(e,t){return t===null||t===!1?null:t||_.createElement("span",{className:`${e}-close-x`},_.createElement(Jte,{className:`${e}-close-icon`}))}const XDe={success:Zte,info:TPe,error:sw,warning:ere},Dre=e=>{const{prefixCls:t,icon:r,type:i,message:n,description:s,btn:a,role:o="alert"}=e;let l=null;return r?l=_.createElement("span",{className:`${t}-icon`},r):i&&(l=_.createElement(XDe[i]||null,{className:Fe(`${t}-icon`,`${t}-icon-${i}`)})),_.createElement("div",{className:Fe({[`${t}-with-icon`]:l}),role:o},l,_.createElement("div",{className:`${t}-message`},n),_.createElement("div",{className:`${t}-description`},s),a&&_.createElement("div",{className:`${t}-btn`},a))},YDe=e=>{const{prefixCls:t,className:r,icon:i,type:n,message:s,description:a,btn:o,closable:l=!0,closeIcon:c,className:d}=e,u=qDe(e,["prefixCls","className","icon","type","message","description","btn","closable","closeIcon","className"]),{getPrefixCls:h}=_.useContext(br),f=t||h("notification"),p=`${f}-notice`,m=Mo(f),[g,v,y]=Rre(f,m);return g(_.createElement("div",{className:Fe(`${p}-pure-panel`,v,r,y,m)},_.createElement(GDe,{prefixCls:f}),_.createElement(rre,Object.assign({},u,{prefixCls:f,eventKey:"pure",duration:null,closable:l,className:Fe({notificationClassName:d}),closeIcon:UF(f,c),content:_.createElement(Dre,{prefixCls:p,icon:i,type:n,message:s,description:a,btn:o})}))))},KDe=YDe;function QDe(e,t,r){let i;switch(e){case"top":i={left:"50%",transform:"translateX(-50%)",right:"auto",top:t,bottom:"auto"};break;case"topLeft":i={left:0,top:t,bottom:"auto"};break;case"topRight":i={right:0,top:t,bottom:"auto"};break;case"bottom":i={left:"50%",transform:"translateX(-50%)",right:"auto",top:"auto",bottom:r};break;case"bottomLeft":i={left:0,top:"auto",bottom:r};break;default:i={right:0,top:"auto",bottom:r};break}return i}function ZDe(e){return{motionName:`${e}-fade`}}var JDe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const K6=24,eOe=4.5,tOe="topRight",rOe=e=>{let{children:t,prefixCls:r}=e;const i=Mo(r),[n,s,a]=Rre(r,i);return n(_.createElement(BPe,{classNames:{list:Fe(s,a,i)}},t))},iOe=(e,t)=>{let{prefixCls:r,key:i}=t;return _.createElement(rOe,{prefixCls:r,key:i},e)},nOe=_.forwardRef((e,t)=>{const{top:r,bottom:i,prefixCls:n,getContainer:s,maxCount:a,rtl:o,onAllRemoved:l,stack:c}=e,{getPrefixCls:d,getPopupContainer:u,notification:h}=_.useContext(br),[,f]=ia(),p=n||d("notification"),m=x=>QDe(x,r??K6,i??K6),g=()=>Fe({[`${p}-rtl`]:o}),v=()=>ZDe(p),[y,b]=GPe({prefixCls:p,style:m,className:g,motion:v,closable:!0,closeIcon:UF(p),duration:eOe,getContainer:()=>(s==null?void 0:s())||(u==null?void 0:u())||document.body,maxCount:a,onAllRemoved:l,renderNotifications:iOe,stack:c===!1?!1:{threshold:typeof c=="object"?c==null?void 0:c.threshold:void 0,offset:8,gap:f.margin}});return _.useImperativeHandle(t,()=>Object.assign(Object.assign({},y),{prefixCls:p,notification:h})),b});function Ore(e){const t=_.useRef(null);return rw(),[_.useMemo(()=>{const i=o=>{var l;if(!t.current)return;const{open:c,prefixCls:d,notification:u}=t.current,h=`${d}-notice`,{message:f,description:p,icon:m,type:g,btn:v,className:y,style:b,role:x="alert",closeIcon:S}=o,w=JDe(o,["message","description","icon","type","btn","className","style","role","closeIcon"]),E=UF(h,S);return c(Object.assign(Object.assign({placement:(l=e==null?void 0:e.placement)!==null&&l!==void 0?l:tOe},w),{content:_.createElement(Dre,{prefixCls:h,icon:m,type:g,message:f,description:p,btn:v,role:x}),className:Fe(g&&`${h}-${g}`,y,u==null?void 0:u.className),style:Object.assign(Object.assign({},u==null?void 0:u.style),b),closeIcon:E,closable:!!E}))},s={open:i,destroy:o=>{var l,c;o!==void 0?(l=t.current)===null||l===void 0||l.close(o):(c=t.current)===null||c===void 0||c.destroy()}};return["success","info","warning","error"].forEach(o=>{s[o]=l=>i(Object.assign(Object.assign({},l),{type:o}))}),s},[]),_.createElement(nOe,Object.assign({key:"notification-holder"},e,{ref:t}))]}function sOe(e){return Ore(e)}function aOe(e){return t=>_.createElement(lM,{theme:{token:{motion:!1,zIndexPopupBase:0}}},_.createElement(e,Object.assign({},t)))}const oOe=(e,t,r,i)=>aOe(s=>{const{prefixCls:a,style:o}=s,l=_.useRef(null),[c,d]=_.useState(0),[u,h]=_.useState(0),[f,p]=Ka(!1,{value:s.open}),{getPrefixCls:m}=_.useContext(br),g=m(t||"select",a);_.useEffect(()=>{if(p(!0),typeof ResizeObserver<"u"){const b=new ResizeObserver(S=>{const w=S[0].target;d(w.offsetHeight+8),h(w.offsetWidth)}),x=setInterval(()=>{var S;const w=r?`.${r(g)}`:`.${g}-dropdown`,E=(S=l.current)===null||S===void 0?void 0:S.querySelector(w);E&&(clearInterval(x),b.observe(E))},10);return()=>{clearInterval(x),b.disconnect()}}},[]);let v=Object.assign(Object.assign({},s),{style:Object.assign(Object.assign({},o),{margin:0}),open:f,visible:f,getPopupContainer:()=>l.current});i&&(v=i(v));const y={paddingBottom:c,position:"relative",minWidth:u};return _.createElement("div",{ref:l,style:y},_.createElement(e,Object.assign({},v)))}),Lre=oOe,$F=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};var yM=function(t){var r=t.className,i=t.customizeIcon,n=t.customizeIconProps,s=t.onMouseDown,a=t.onClick,o=t.children,l;return typeof i=="function"?l=i(n):l=i,_.createElement("span",{className:r,onMouseDown:function(d){d.preventDefault(),s&&s(d)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:a,"aria-hidden":!0},l!==void 0?l:_.createElement("span",{className:Fe(r.split(/\s+/).map(function(c){return"".concat(c,"-icon")}))},o))};function lOe(e,t,r,i,n){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0,l=Ge.useMemo(function(){if(vr(i)==="object")return i.clearIcon;if(n)return n},[i,n]),c=Ge.useMemo(function(){return!!(!s&&i&&(r.length||a)&&!(o==="combobox"&&a===""))},[i,s,r.length,a,o]);return{allowClear:c,clearIcon:Ge.createElement(yM,{className:"".concat(e,"-clear"),onMouseDown:t,customizeIcon:l},"×")}}var Nre=_.createContext(null);function cOe(){return _.useContext(Nre)}function uOe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,t=_.useState(!1),r=Pe(t,2),i=r[0],n=r[1],s=_.useRef(null),a=function(){window.clearTimeout(s.current)};_.useEffect(function(){return a},[]);var o=function(c,d){a(),s.current=window.setTimeout(function(){n(c),d&&d()},e)};return[i,o,a]}function kre(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,t=_.useRef(null),r=_.useRef(null);_.useEffect(function(){return function(){window.clearTimeout(r.current)}},[]);function i(n){(n||t.current===null)&&(t.current=n),window.clearTimeout(r.current),r.current=window.setTimeout(function(){t.current=null},e)}return[function(){return t.current},i]}function dOe(e,t,r,i){var n=_.useRef(null);n.current={open:t,triggerOpen:r,customizedTrigger:i},_.useEffect(function(){function s(a){var o;if(!((o=n.current)!==null&&o!==void 0&&o.customizedTrigger)){var l=a.target;l.shadowRoot&&a.composed&&(l=a.composedPath()[0]||l),n.current.open&&e().filter(function(c){return c}).every(function(c){return!c.contains(l)&&c!==l})&&n.current.triggerOpen(!1)}}return window.addEventListener("mousedown",s),function(){return window.removeEventListener("mousedown",s)}},[])}var hOe=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],wm=void 0;function fOe(e,t){var r=e.prefixCls,i=e.invalidate,n=e.item,s=e.renderItem,a=e.responsive,o=e.responsiveDisabled,l=e.registerSize,c=e.itemKey,d=e.className,u=e.style,h=e.children,f=e.display,p=e.order,m=e.component,g=m===void 0?"div":m,v=hr(e,hOe),y=a&&!f;function b(C){l(c,C)}_.useEffect(function(){return function(){b(null)}},[]);var x=s&&n!==wm?s(n):h,S;i||(S={opacity:y?0:1,height:y?0:wm,overflowY:y?"hidden":wm,order:a?p:wm,pointerEvents:y?"none":wm,position:y?"absolute":wm});var w={};y&&(w["aria-hidden"]=!0);var E=_.createElement(g,ae({className:Fe(!i&&r,d),style:_e(_e({},S),u)},w,v,{ref:t}),x);return a&&(E=_.createElement(Zh,{onResize:function(T){var A=T.offsetWidth;b(A)},disabled:o},E)),E}var q1=_.forwardRef(fOe);q1.displayName="Item";function pOe(e){if(typeof MessageChannel>"u")Lr(e);else{var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(void 0)}}function mOe(){var e=_.useRef(null),t=function(i){e.current||(e.current=[],pOe(function(){Vl.unstable_batchedUpdates(function(){e.current.forEach(function(n){n()}),e.current=null})})),e.current.push(i)};return t}function gy(e,t){var r=_.useState(t),i=Pe(r,2),n=i[0],s=i[1],a=ma(function(o){e(function(){s(o)})});return[n,a]}var rA=Ge.createContext(null),gOe=["component"],vOe=["className"],yOe=["className"],bOe=function(t,r){var i=_.useContext(rA);if(!i){var n=t.component,s=n===void 0?"div":n,a=hr(t,gOe);return _.createElement(s,ae({},a,{ref:r}))}var o=i.className,l=hr(i,vOe),c=t.className,d=hr(t,yOe);return _.createElement(rA.Provider,{value:null},_.createElement(q1,ae({ref:r,className:Fe(o,c)},l,d)))},zre=_.forwardRef(bOe);zre.displayName="RawItem";var xOe=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],Bre="responsive",Fre="invalidate";function wOe(e){return"+ ".concat(e.length," ...")}function _Oe(e,t){var r=e.prefixCls,i=r===void 0?"rc-overflow":r,n=e.data,s=n===void 0?[]:n,a=e.renderItem,o=e.renderRawItem,l=e.itemKey,c=e.itemWidth,d=c===void 0?10:c,u=e.ssr,h=e.style,f=e.className,p=e.maxCount,m=e.renderRest,g=e.renderRawRest,v=e.suffix,y=e.component,b=y===void 0?"div":y,x=e.itemComponent,S=e.onVisibleChange,w=hr(e,xOe),E=u==="full",C=mOe(),T=gy(C,null),A=Pe(T,2),M=A[0],P=A[1],I=M||0,R=gy(C,new Map),N=Pe(R,2),k=N[0],O=N[1],D=gy(C,0),B=Pe(D,2),z=B[0],F=B[1],V=gy(C,0),Y=Pe(V,2),W=Y[0],X=Y[1],H=gy(C,0),ie=Pe(H,2),Q=ie[0],Z=ie[1],ee=_.useState(null),re=Pe(ee,2),ne=re[0],se=re[1],fe=_.useState(null),me=Pe(fe,2),Oe=me[0],Ee=me[1],Se=_.useMemo(function(){return Oe===null&&E?Number.MAX_SAFE_INTEGER:Oe||0},[Oe,M]),de=_.useState(!1),be=Pe(de,2),ye=be[0],q=be[1],U="".concat(i,"-item"),ce=Math.max(z,W),xe=p===Bre,j=s.length&&xe,Be=p===Fre,ze=j||typeof p=="number"&&s.length>p,Ve=_.useMemo(function(){var ot=s;return j?M===null&&E?ot=s:ot=s.slice(0,Math.min(s.length,I/d)):typeof p=="number"&&(ot=s.slice(0,p)),ot},[s,d,M,p,j]),pe=_.useMemo(function(){return j?s.slice(Se+1):s.slice(Ve.length)},[s,Ve,j,Se]),Me=_.useCallback(function(ot,at){var Qe;return typeof l=="function"?l(ot):(Qe=l&&(ot==null?void 0:ot[l]))!==null&&Qe!==void 0?Qe:at},[l]),Ue=_.useCallback(a||function(ot){return ot},[a]);function Re(ot,at,Qe){Oe===ot&&(at===void 0||at===ne)||(Ee(ot),Qe||(q(ot<s.length-1),S==null||S(ot)),at!==void 0&&se(at))}function et(ot,at){P(at.clientWidth)}function Xe(ot,at){O(function(Qe){var ut=new Map(Qe);return at===null?ut.delete(ot):ut.set(ot,at),ut})}function Ze(ot,at){X(at),F(W)}function Mt(ot,at){Z(at)}function Gt(ot){return k.get(Me(Ve[ot],ot))}mi(function(){if(I&&typeof ce=="number"&&Ve){var ot=Q,at=Ve.length,Qe=at-1;if(!at){Re(0,null);return}for(var ut=0;ut<at;ut+=1){var yt=Gt(ut);if(E&&(yt=yt||0),yt===void 0){Re(ut-1,void 0,!0);break}if(ot+=yt,Qe===0&&ot<=I||ut===Qe-1&&ot+Gt(Qe)<=I){Re(Qe,null);break}else if(ot+ce>I){Re(ut-1,ot-yt-Q+W);break}}v&&Gt(0)+Q>I&&se(null)}},[I,k,W,Q,Me,Ve]);var ue=ye&&!!pe.length,Ae={};ne!==null&&j&&(Ae={position:"absolute",left:ne,top:0});var ke={prefixCls:U,responsive:j,component:x,invalidate:Be},Ie=o?function(ot,at){var Qe=Me(ot,at);return _.createElement(rA.Provider,{key:Qe,value:_e(_e({},ke),{},{order:at,item:ot,itemKey:Qe,registerSize:Xe,display:at<=Se})},o(ot,at))}:function(ot,at){var Qe=Me(ot,at);return _.createElement(q1,ae({},ke,{order:at,key:Qe,item:ot,renderItem:Ue,itemKey:Qe,registerSize:Xe,display:at<=Se}))},$e,tt={order:ue?Se:Number.MAX_SAFE_INTEGER,className:"".concat(U,"-rest"),registerSize:Ze,display:ue};if(g)g&&($e=_.createElement(rA.Provider,{value:_e(_e({},ke),tt)},g(pe)));else{var He=m||wOe;$e=_.createElement(q1,ae({},ke,tt),typeof He=="function"?He(pe):He)}var gt=_.createElement(b,ae({className:Fe(!Be&&i,f),style:h,ref:t},w),Ve.map(Ie),ze?$e:null,v&&_.createElement(q1,ae({},ke,{responsive:xe,responsiveDisabled:!j,order:Se,className:"".concat(U,"-suffix"),registerSize:Mt,display:!0,style:Ae}),v));return xe&&(gt=_.createElement(Zh,{onResize:et,disabled:!j},gt)),gt}var $c=_.forwardRef(_Oe);$c.displayName="Overflow";$c.Item=zre;$c.RESPONSIVE=Bre;$c.INVALIDATE=Fre;var SOe=function(t,r){var i,n=t.prefixCls,s=t.id,a=t.inputElement,o=t.disabled,l=t.tabIndex,c=t.autoFocus,d=t.autoComplete,u=t.editable,h=t.activeDescendantId,f=t.value,p=t.maxLength,m=t.onKeyDown,g=t.onMouseDown,v=t.onChange,y=t.onPaste,b=t.onCompositionStart,x=t.onCompositionEnd,S=t.open,w=t.attrs,E=a||_.createElement("input",null),C=E,T=C.ref,A=C.props,M=A.onKeyDown,P=A.onChange,I=A.onMouseDown,R=A.onCompositionStart,N=A.onCompositionEnd,k=A.style;return"maxLength"in E.props,E=_.cloneElement(E,_e(_e(_e({type:"search"},A),{},{id:s,ref:To(r,T),disabled:o,tabIndex:l,autoComplete:d||"off",autoFocus:c,className:Fe("".concat(n,"-selection-search-input"),(i=E)===null||i===void 0||(i=i.props)===null||i===void 0?void 0:i.className),role:"combobox","aria-expanded":S||!1,"aria-haspopup":"listbox","aria-owns":"".concat(s,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(s,"_list"),"aria-activedescendant":S?h:void 0},w),{},{value:u?f:"",maxLength:p,readOnly:!u,unselectable:u?null:"on",style:_e(_e({},k),{},{opacity:u?null:0}),onKeyDown:function(D){m(D),M&&M(D)},onMouseDown:function(D){g(D),I&&I(D)},onChange:function(D){v(D),P&&P(D)},onCompositionStart:function(D){b(D),R&&R(D)},onCompositionEnd:function(D){x(D),N&&N(D)},onPaste:y})),E},HF=_.forwardRef(SOe);HF.displayName="Input";function jre(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}var EOe=typeof window<"u"&&window.document&&window.document.documentElement,COe=EOe;function AOe(e){return e!=null}function TOe(e){return!e&&e!==0}function Q6(e){return["string","number"].includes(vr(e))}function Vre(e){var t=void 0;return e&&(Q6(e.title)?t=e.title.toString():Q6(e.label)&&(t=e.label.toString())),t}function MOe(e,t){COe?_.useLayoutEffect(e,t):_.useEffect(e,t)}function POe(e){var t;return(t=e.key)!==null&&t!==void 0?t:e.value}var Z6=function(t){t.preventDefault(),t.stopPropagation()},IOe=function(t){var r=t.id,i=t.prefixCls,n=t.values,s=t.open,a=t.searchValue,o=t.autoClearSearchValue,l=t.inputRef,c=t.placeholder,d=t.disabled,u=t.mode,h=t.showSearch,f=t.autoFocus,p=t.autoComplete,m=t.activeDescendantId,g=t.tabIndex,v=t.removeIcon,y=t.maxTagCount,b=t.maxTagTextLength,x=t.maxTagPlaceholder,S=x===void 0?function(se){return"+ ".concat(se.length," ...")}:x,w=t.tagRender,E=t.onToggleOpen,C=t.onRemove,T=t.onInputChange,A=t.onInputPaste,M=t.onInputKeyDown,P=t.onInputMouseDown,I=t.onInputCompositionStart,R=t.onInputCompositionEnd,N=_.useRef(null),k=_.useState(0),O=Pe(k,2),D=O[0],B=O[1],z=_.useState(!1),F=Pe(z,2),V=F[0],Y=F[1],W="".concat(i,"-selection"),X=s||u==="multiple"&&o===!1||u==="tags"?a:"",H=u==="tags"||u==="multiple"&&o===!1||h&&(s||V);MOe(function(){B(N.current.scrollWidth)},[X]);function ie(se,fe,me,Oe,Ee){return _.createElement("span",{className:Fe("".concat(W,"-item"),he({},"".concat(W,"-item-disabled"),me)),title:Vre(se)},_.createElement("span",{className:"".concat(W,"-item-content")},fe),Oe&&_.createElement(yM,{className:"".concat(W,"-item-remove"),onMouseDown:Z6,onClick:Ee,customizeIcon:v},"×"))}function Q(se,fe,me,Oe,Ee){var Se=function(be){Z6(be),E(!s)};return _.createElement("span",{onMouseDown:Se},w({label:fe,value:se,disabled:me,closable:Oe,onClose:Ee}))}function Z(se){var fe=se.disabled,me=se.label,Oe=se.value,Ee=!d&&!fe,Se=me;if(typeof b=="number"&&(typeof me=="string"||typeof me=="number")){var de=String(Se);de.length>b&&(Se="".concat(de.slice(0,b),"..."))}var be=function(q){q&&q.stopPropagation(),C(se)};return typeof w=="function"?Q(Oe,Se,fe,Ee,be):ie(se,Se,fe,Ee,be)}function ee(se){var fe=typeof S=="function"?S(se):S;return ie({title:fe},fe,!1)}var re=_.createElement("div",{className:"".concat(W,"-search"),style:{width:D},onFocus:function(){Y(!0)},onBlur:function(){Y(!1)}},_.createElement(HF,{ref:l,open:s,prefixCls:i,id:r,inputElement:null,disabled:d,autoFocus:f,autoComplete:p,editable:H,activeDescendantId:m,value:X,onKeyDown:M,onMouseDown:P,onChange:T,onPaste:A,onCompositionStart:I,onCompositionEnd:R,tabIndex:g,attrs:QC(t,!0)}),_.createElement("span",{ref:N,className:"".concat(W,"-search-mirror"),"aria-hidden":!0},X," ")),ne=_.createElement($c,{prefixCls:"".concat(W,"-overflow"),data:n,renderItem:Z,renderRest:ee,suffix:re,itemKey:POe,maxCount:y});return _.createElement(_.Fragment,null,ne,!n.length&&!X&&_.createElement("span",{className:"".concat(W,"-placeholder")},c))},ROe=function(t){var r=t.inputElement,i=t.prefixCls,n=t.id,s=t.inputRef,a=t.disabled,o=t.autoFocus,l=t.autoComplete,c=t.activeDescendantId,d=t.mode,u=t.open,h=t.values,f=t.placeholder,p=t.tabIndex,m=t.showSearch,g=t.searchValue,v=t.activeValue,y=t.maxLength,b=t.onInputKeyDown,x=t.onInputMouseDown,S=t.onInputChange,w=t.onInputPaste,E=t.onInputCompositionStart,C=t.onInputCompositionEnd,T=t.title,A=_.useState(!1),M=Pe(A,2),P=M[0],I=M[1],R=d==="combobox",N=R||m,k=h[0],O=g||"";R&&v&&!P&&(O=v),_.useEffect(function(){R&&I(!1)},[R,v]);var D=d!=="combobox"&&!u&&!m?!1:!!O,B=T===void 0?Vre(k):T,z=function(){if(k)return null;var V=D?{visibility:"hidden"}:void 0;return _.createElement("span",{className:"".concat(i,"-selection-placeholder"),style:V},f)};return _.createElement(_.Fragment,null,_.createElement("span",{className:"".concat(i,"-selection-search")},_.createElement(HF,{ref:s,prefixCls:i,id:n,open:u,inputElement:r,disabled:a,autoFocus:o,autoComplete:l,editable:N,activeDescendantId:c,value:O,onKeyDown:b,onMouseDown:x,onChange:function(V){I(!0),S(V)},onPaste:w,onCompositionStart:E,onCompositionEnd:C,tabIndex:p,attrs:QC(t,!0),maxLength:R?y:void 0})),!R&&k?_.createElement("span",{className:"".concat(i,"-selection-item"),title:B,style:D?{visibility:"hidden"}:void 0},k.label):null,z())};function DOe(e){return![rt.ESC,rt.SHIFT,rt.BACKSPACE,rt.TAB,rt.WIN_KEY,rt.ALT,rt.META,rt.WIN_KEY_RIGHT,rt.CTRL,rt.SEMICOLON,rt.EQUALS,rt.CAPS_LOCK,rt.CONTEXT_MENU,rt.F1,rt.F2,rt.F3,rt.F4,rt.F5,rt.F6,rt.F7,rt.F8,rt.F9,rt.F10,rt.F11,rt.F12].includes(e)}var OOe=function(t,r){var i=_.useRef(null),n=_.useRef(!1),s=t.prefixCls,a=t.open,o=t.mode,l=t.showSearch,c=t.tokenWithEnter,d=t.autoClearSearchValue,u=t.onSearch,h=t.onSearchSubmit,f=t.onToggleOpen,p=t.onInputKeyDown,m=t.domRef;_.useImperativeHandle(r,function(){return{focus:function(){i.current.focus()},blur:function(){i.current.blur()}}});var g=kre(0),v=Pe(g,2),y=v[0],b=v[1],x=function(O){var D=O.which;(D===rt.UP||D===rt.DOWN)&&O.preventDefault(),p&&p(O),D===rt.ENTER&&o==="tags"&&!n.current&&!a&&(h==null||h(O.target.value)),DOe(D)&&f(!0)},S=function(){b(!0)},w=_.useRef(null),E=function(O){u(O,!0,n.current)!==!1&&f(!0)},C=function(){n.current=!0},T=function(O){n.current=!1,o!=="combobox"&&E(O.target.value)},A=function(O){var D=O.target.value;if(c&&w.current&&/[\r\n]/.test(w.current)){var B=w.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");D=D.replace(B,w.current)}w.current=null,E(D)},M=function(O){var D=O.clipboardData,B=D.getData("text");w.current=B},P=function(O){var D=O.target;if(D!==i.current){var B=document.body.style.msTouchAction!==void 0;B?setTimeout(function(){i.current.focus()}):i.current.focus()}},I=function(O){var D=y();O.target!==i.current&&!D&&o!=="combobox"&&O.preventDefault(),(o!=="combobox"&&(!l||!D)||!a)&&(a&&d!==!1&&u("",!0,!1),f())},R={inputRef:i,onInputKeyDown:x,onInputMouseDown:S,onInputChange:A,onInputPaste:M,onInputCompositionStart:C,onInputCompositionEnd:T},N=o==="multiple"||o==="tags"?_.createElement(IOe,ae({},t,R)):_.createElement(ROe,ae({},t,R));return _.createElement("div",{ref:m,className:"".concat(s,"-selector"),onClick:P,onMouseDown:I},N)},Ure=_.forwardRef(OOe);Ure.displayName="Selector";function LOe(e){var t=e.prefixCls,r=e.align,i=e.arrow,n=e.arrowPos,s=i||{},a=s.className,o=s.content,l=n.x,c=l===void 0?0:l,d=n.y,u=d===void 0?0:d,h=_.useRef();if(!r||!r.points)return null;var f={position:"absolute"};if(r.autoArrow!==!1){var p=r.points[0],m=r.points[1],g=p[0],v=p[1],y=m[0],b=m[1];g===y||!["t","b"].includes(g)?f.top=u:g==="t"?f.top=0:f.bottom=0,v===b||!["l","r"].includes(v)?f.left=c:v==="l"?f.left=0:f.right=0}return _.createElement("div",{ref:h,className:Fe("".concat(t,"-arrow"),a),style:f},o)}function NOe(e){var t=e.prefixCls,r=e.open,i=e.zIndex,n=e.mask,s=e.motion;return n?_.createElement(Zp,ae({},s,{motionAppear:!0,visible:r,removeOnLeave:!0}),function(a){var o=a.className;return _.createElement("div",{style:{zIndex:i},className:Fe("".concat(t,"-mask"),o)})}):null}var kOe=_.memo(function(e){var t=e.children;return t},function(e,t){return t.cache}),zOe=_.forwardRef(function(e,t){var r=e.popup,i=e.className,n=e.prefixCls,s=e.style,a=e.target,o=e.onVisibleChanged,l=e.open,c=e.keepDom,d=e.fresh,u=e.onClick,h=e.mask,f=e.arrow,p=e.arrowPos,m=e.align,g=e.motion,v=e.maskMotion,y=e.forceRender,b=e.getPopupContainer,x=e.autoDestroy,S=e.portal,w=e.zIndex,E=e.onMouseEnter,C=e.onMouseLeave,T=e.onPointerEnter,A=e.ready,M=e.offsetX,P=e.offsetY,I=e.offsetR,R=e.offsetB,N=e.onAlign,k=e.onPrepare,O=e.stretch,D=e.targetWidth,B=e.targetHeight,z=typeof r=="function"?r():r,F=l||c,V=(b==null?void 0:b.length)>0,Y=_.useState(!b||!V),W=Pe(Y,2),X=W[0],H=W[1];if(mi(function(){!X&&V&&a&&H(!0)},[X,V,a]),!X)return null;var ie="auto",Q={left:"-1000vw",top:"-1000vh",right:ie,bottom:ie};if(A||!l){var Z,ee=m.points,re=m.dynamicInset||((Z=m._experimental)===null||Z===void 0?void 0:Z.dynamicInset),ne=re&&ee[0][1]==="r",se=re&&ee[0][0]==="b";ne?(Q.right=I,Q.left=ie):(Q.left=M,Q.right=ie),se?(Q.bottom=R,Q.top=ie):(Q.top=P,Q.bottom=ie)}var fe={};return O&&(O.includes("height")&&B?fe.height=B:O.includes("minHeight")&&B&&(fe.minHeight=B),O.includes("width")&&D?fe.width=D:O.includes("minWidth")&&D&&(fe.minWidth=D)),l||(fe.pointerEvents="none"),_.createElement(S,{open:y||F,getContainer:b&&function(){return b(a)},autoDestroy:x},_.createElement(NOe,{prefixCls:n,open:l,zIndex:w,mask:h,motion:v}),_.createElement(Zh,{onResize:N,disabled:!l},function(me){return _.createElement(Zp,ae({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:y,leavedClassName:"".concat(n,"-hidden")},g,{onAppearPrepare:k,onEnterPrepare:k,visible:l,onVisibleChanged:function(Ee){var Se;g==null||(Se=g.onVisibleChanged)===null||Se===void 0||Se.call(g,Ee),o(Ee)}}),function(Oe,Ee){var Se=Oe.className,de=Oe.style,be=Fe(n,Se,i);return _.createElement("div",{ref:To(me,t,Ee),className:be,style:_e(_e(_e(_e({"--arrow-x":"".concat(p.x||0,"px"),"--arrow-y":"".concat(p.y||0,"px")},Q),fe),de),{},{boxSizing:"border-box",zIndex:w},s),onMouseEnter:E,onMouseLeave:C,onPointerEnter:T,onClick:u},f&&_.createElement(LOe,{prefixCls:n,arrow:f,arrowPos:p,align:m}),_.createElement(kOe,{cache:!l&&!d},z))})}))}),BOe=_.forwardRef(function(e,t){var r=e.children,i=e.getTriggerDOMNode,n=gd(r),s=_.useCallback(function(o){fF(t,i?i(o):o)},[i]),a=C0(s,r.ref);return n?_.cloneElement(r,{ref:a}):r}),J6=_.createContext(null);function eH(e){return e?Array.isArray(e)?e:[e]:[]}function FOe(e,t,r,i){return _.useMemo(function(){var n=eH(r??t),s=eH(i??t),a=new Set(n),o=new Set(s);return e&&(a.has("hover")&&(a.delete("hover"),a.add("click")),o.has("hover")&&(o.delete("hover"),o.add("click"))),[a,o]},[e,t,r,i])}function jOe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return r?e[0]===t[0]:e[0]===t[0]&&e[1]===t[1]}function VOe(e,t,r,i){for(var n=r.points,s=Object.keys(e),a=0;a<s.length;a+=1){var o,l=s[a];if(jOe((o=e[l])===null||o===void 0?void 0:o.points,n,i))return"".concat(t,"-placement-").concat(l)}return""}function tH(e,t,r,i){return t||(r?{motionName:"".concat(e,"-").concat(r)}:i?{motionName:i}:null)}function lw(e){return e.ownerDocument.defaultView}function dL(e){for(var t=[],r=e==null?void 0:e.parentElement,i=["hidden","scroll","clip","auto"];r;){var n=lw(r).getComputedStyle(r),s=n.overflowX,a=n.overflowY,o=n.overflow;[s,a,o].some(function(l){return i.includes(l)})&&t.push(r),r=r.parentElement}return t}function Jb(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(e)?t:e}function vy(e){return Jb(parseFloat(e),0)}function rH(e,t){var r=_e({},e);return(t||[]).forEach(function(i){if(!(i instanceof HTMLBodyElement||i instanceof HTMLHtmlElement)){var n=lw(i).getComputedStyle(i),s=n.overflow,a=n.overflowClipMargin,o=n.borderTopWidth,l=n.borderBottomWidth,c=n.borderLeftWidth,d=n.borderRightWidth,u=i.getBoundingClientRect(),h=i.offsetHeight,f=i.clientHeight,p=i.offsetWidth,m=i.clientWidth,g=vy(o),v=vy(l),y=vy(c),b=vy(d),x=Jb(Math.round(u.width/p*1e3)/1e3),S=Jb(Math.round(u.height/h*1e3)/1e3),w=(p-m-y-b)*x,E=(h-f-g-v)*S,C=g*S,T=v*S,A=y*x,M=b*x,P=0,I=0;if(s==="clip"){var R=vy(a);P=R*x,I=R*S}var N=u.x+A-P,k=u.y+C-I,O=N+u.width+2*P-A-M-w,D=k+u.height+2*I-C-T-E;r.left=Math.max(r.left,N),r.top=Math.max(r.top,k),r.right=Math.min(r.right,O),r.bottom=Math.min(r.bottom,D)}}),r}function iH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r="".concat(t),i=r.match(/^(.*)\%$/);return i?e*(parseFloat(i[1])/100):parseFloat(r)}function nH(e,t){var r=t||[],i=Pe(r,2),n=i[0],s=i[1];return[iH(e.width,n),iH(e.height,s)]}function sH(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function _m(e,t){var r=t[0],i=t[1],n,s;return r==="t"?s=e.y:r==="b"?s=e.y+e.height:s=e.y+e.height/2,i==="l"?n=e.x:i==="r"?n=e.x+e.width:n=e.x+e.width/2,{x:n,y:s}}function Ed(e,t){var r={t:"b",b:"t",l:"r",r:"l"};return e.map(function(i,n){return n===t?r[i]||"c":i}).join("")}function UOe(e,t,r,i,n,s,a){var o=_.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:n[i]||{}}),l=Pe(o,2),c=l[0],d=l[1],u=_.useRef(0),h=_.useMemo(function(){return t?dL(t):[]},[t]),f=_.useRef({}),p=function(){f.current={}};e||p();var m=ma(function(){if(t&&r&&e){let Io=function(ou,sf){var lm=arguments.length>2&&arguments[2]!==void 0?arguments[2]:be,cm=z.x+ou,K0=z.y+sf,Q0=cm+Z,Iw=K0+Q,rP=Math.max(cm,lm.left),iP=Math.max(K0,lm.top),nP=Math.min(Q0,lm.right),sP=Math.min(Iw,lm.bottom);return Math.max(0,(nP-rP)*(sP-iP))},Pw=function(){ve=z.y+He,Le=ve+Q,mt=z.x+tt,Pt=mt+Z};var y,b,x=t,S=x.ownerDocument,w=lw(x),E=w.getComputedStyle(x),C=E.width,T=E.height,A=E.position,M=x.style.left,P=x.style.top,I=x.style.right,R=x.style.bottom,N=x.style.overflow,k=_e(_e({},n[i]),s),O=S.createElement("div");(y=x.parentElement)===null||y===void 0||y.appendChild(O),O.style.left="".concat(x.offsetLeft,"px"),O.style.top="".concat(x.offsetTop,"px"),O.style.position=A,O.style.height="".concat(x.offsetHeight,"px"),O.style.width="".concat(x.offsetWidth,"px"),x.style.left="0",x.style.top="0",x.style.right="auto",x.style.bottom="auto",x.style.overflow="hidden";var D;if(Array.isArray(r))D={x:r[0],y:r[1],width:0,height:0};else{var B=r.getBoundingClientRect();D={x:B.x,y:B.y,width:B.width,height:B.height}}var z=x.getBoundingClientRect(),F=S.documentElement,V=F.clientWidth,Y=F.clientHeight,W=F.scrollWidth,X=F.scrollHeight,H=F.scrollTop,ie=F.scrollLeft,Q=z.height,Z=z.width,ee=D.height,re=D.width,ne={left:0,top:0,right:V,bottom:Y},se={left:-ie,top:-H,right:W-ie,bottom:X-H},fe=k.htmlRegion,me="visible",Oe="visibleFirst";fe!=="scroll"&&fe!==Oe&&(fe=me);var Ee=fe===Oe,Se=rH(se,h),de=rH(ne,h),be=fe===me?de:Se,ye=Ee?de:be;x.style.left="auto",x.style.top="auto",x.style.right="0",x.style.bottom="0";var q=x.getBoundingClientRect();x.style.left=M,x.style.top=P,x.style.right=I,x.style.bottom=R,x.style.overflow=N,(b=x.parentElement)===null||b===void 0||b.removeChild(O);var U=Jb(Math.round(Z/parseFloat(C)*1e3)/1e3),ce=Jb(Math.round(Q/parseFloat(T)*1e3)/1e3);if(U===0||ce===0||UC(r)&&!pM(r))return;var xe=k.offset,j=k.targetOffset,Be=nH(z,xe),ze=Pe(Be,2),Ve=ze[0],pe=ze[1],Me=nH(D,j),Ue=Pe(Me,2),Re=Ue[0],et=Ue[1];D.x-=Re,D.y-=et;var Xe=k.points||[],Ze=Pe(Xe,2),Mt=Ze[0],Gt=Ze[1],ue=sH(Gt),Ae=sH(Mt),ke=_m(D,ue),Ie=_m(z,Ae),$e=_e({},k),tt=ke.x-Ie.x+Ve,He=ke.y-Ie.y+pe,gt=Io(tt,He),ot=Io(tt,He,de),at=_m(D,["t","l"]),Qe=_m(z,["t","l"]),ut=_m(D,["b","r"]),yt=_m(z,["b","r"]),xt=k.overflow||{},or=xt.adjustX,Jt=xt.adjustY,te=xt.shiftX,we=xt.shiftY,Te=function(sf){return typeof sf=="boolean"?sf:sf>=0},ve,Le,mt,Pt;Pw();var it=Te(Jt),qe=Ae[0]===ue[0];if(it&&Ae[0]==="t"&&(Le>ye.bottom||f.current.bt)){var pt=He;qe?pt-=Q-ee:pt=at.y-yt.y-pe;var St=Io(tt,pt),Ot=Io(tt,pt,de);St>gt||St===gt&&(!Ee||Ot>=ot)?(f.current.bt=!0,He=pt,pe=-pe,$e.points=[Ed(Ae,0),Ed(ue,0)]):f.current.bt=!1}if(it&&Ae[0]==="b"&&(ve<ye.top||f.current.tb)){var Ct=He;qe?Ct+=Q-ee:Ct=ut.y-Qe.y-pe;var Br=Io(tt,Ct),hi=Io(tt,Ct,de);Br>gt||Br===gt&&(!Ee||hi>=ot)?(f.current.tb=!0,He=Ct,pe=-pe,$e.points=[Ed(Ae,0),Ed(ue,0)]):f.current.tb=!1}var ji=Te(or),Ar=Ae[1]===ue[1];if(ji&&Ae[1]==="l"&&(Pt>ye.right||f.current.rl)){var kt=tt;Ar?kt-=Z-re:kt=at.x-yt.x-Ve;var fn=Io(kt,He),qt=Io(kt,He,de);fn>gt||fn===gt&&(!Ee||qt>=ot)?(f.current.rl=!0,tt=kt,Ve=-Ve,$e.points=[Ed(Ae,1),Ed(ue,1)]):f.current.rl=!1}if(ji&&Ae[1]==="r"&&(mt<ye.left||f.current.lr)){var yi=tt;Ar?yi+=Z-re:yi=ut.x-Qe.x-Ve;var Ns=Io(yi,He),pn=Io(yi,He,de);Ns>gt||Ns===gt&&(!Ee||pn>=ot)?(f.current.lr=!0,tt=yi,Ve=-Ve,$e.points=[Ed(Ae,1),Ed(ue,1)]):f.current.lr=!1}Pw();var Ci=te===!0?0:te;typeof Ci=="number"&&(mt<de.left&&(tt-=mt-de.left-Ve,D.x+re<de.left+Ci&&(tt+=D.x-de.left+re-Ci)),Pt>de.right&&(tt-=Pt-de.right-Ve,D.x>de.right-Ci&&(tt+=D.x-de.right+Ci)));var $=we===!0?0:we;typeof $=="number"&&(ve<de.top&&(He-=ve-de.top-pe,D.y+ee<de.top+$&&(He+=D.y-de.top+ee-$)),Le>de.bottom&&(He-=Le-de.bottom-pe,D.y>de.bottom-$&&(He+=D.y-de.bottom+$)));var K=z.x+tt,le=K+Z,J=z.y+He,ge=J+Q,De=D.x,dt=De+re,Bt=D.y,Kt=Bt+ee,pr=Math.max(K,De),wr=Math.min(le,dt),Ai=(pr+wr)/2,eo=Ai-K,Da=Math.max(J,Bt),Oa=Math.min(ge,Kt),aa=(Da+Oa)/2,Po=aa-J;a==null||a(t,$e);var xd=q.right-z.x-(tt+z.width),Y0=q.bottom-z.y-(He+z.height);d({ready:!0,offsetX:tt/U,offsetY:He/ce,offsetR:xd/U,offsetB:Y0/ce,arrowX:eo/U,arrowY:Po/ce,scaleX:U,scaleY:ce,align:$e})}}),g=function(){u.current+=1;var b=u.current;Promise.resolve().then(function(){u.current===b&&m()})},v=function(){d(function(b){return _e(_e({},b),{},{ready:!1})})};return mi(v,[i]),mi(function(){e||v()},[e]),[c.ready,c.offsetX,c.offsetY,c.offsetR,c.offsetB,c.arrowX,c.arrowY,c.scaleX,c.scaleY,c.align,g]}function $Oe(e,t,r,i,n){mi(function(){if(e&&t&&r){let u=function(){i(),n()};var s=t,a=r,o=dL(s),l=dL(a),c=lw(a),d=new Set([c].concat(ft(o),ft(l)));return d.forEach(function(h){h.addEventListener("scroll",u,{passive:!0})}),c.addEventListener("resize",u,{passive:!0}),i(),function(){d.forEach(function(h){h.removeEventListener("scroll",u),c.removeEventListener("resize",u)})}}},[e,t,r])}function HOe(e,t,r,i,n,s,a,o){var l=_.useRef(e),c=_.useRef(!1);l.current!==e&&(c.current=!0,l.current=e),_.useEffect(function(){var d=Lr(function(){c.current=!1});return function(){Lr.cancel(d)}},[e]),_.useEffect(function(){if(t&&i&&(!n||s)){var d=function(){var w=!1,E=function(A){var M=A.target;w=a(M)},C=function(A){var M=A.target;!c.current&&l.current&&!w&&!a(M)&&o(!1)};return[E,C]},u=d(),h=Pe(u,2),f=h[0],p=h[1],m=d(),g=Pe(m,2),v=g[0],y=g[1],b=lw(i);b.addEventListener("mousedown",f,!0),b.addEventListener("click",p,!0),b.addEventListener("contextmenu",p,!0);var x=KC(r);return x&&(x.addEventListener("mousedown",v,!0),x.addEventListener("click",y,!0),x.addEventListener("contextmenu",y,!0)),function(){b.removeEventListener("mousedown",f,!0),b.removeEventListener("click",p,!0),b.removeEventListener("contextmenu",p,!0),x&&(x.removeEventListener("mousedown",v,!0),x.removeEventListener("click",y,!0),x.removeEventListener("contextmenu",y,!0))}}},[t,r,i,n,s])}var WOe=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function GOe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vre,t=_.forwardRef(function(r,i){var n=r.prefixCls,s=n===void 0?"rc-trigger-popup":n,a=r.children,o=r.action,l=o===void 0?"hover":o,c=r.showAction,d=r.hideAction,u=r.popupVisible,h=r.defaultPopupVisible,f=r.onPopupVisibleChange,p=r.afterPopupVisibleChange,m=r.mouseEnterDelay,g=r.mouseLeaveDelay,v=g===void 0?.1:g,y=r.focusDelay,b=r.blurDelay,x=r.mask,S=r.maskClosable,w=S===void 0?!0:S,E=r.getPopupContainer,C=r.forceRender,T=r.autoDestroy,A=r.destroyPopupOnHide,M=r.popup,P=r.popupClassName,I=r.popupStyle,R=r.popupPlacement,N=r.builtinPlacements,k=N===void 0?{}:N,O=r.popupAlign,D=r.zIndex,B=r.stretch,z=r.getPopupClassNameFromAlign,F=r.fresh,V=r.alignPoint,Y=r.onPopupClick,W=r.onPopupAlign,X=r.arrow,H=r.popupMotion,ie=r.maskMotion,Q=r.popupTransitionName,Z=r.popupAnimation,ee=r.maskTransitionName,re=r.maskAnimation,ne=r.className,se=r.getTriggerDOMNode,fe=hr(r,WOe),me=T||A||!1,Oe=_.useState(!1),Ee=Pe(Oe,2),Se=Ee[0],de=Ee[1];mi(function(){de($F())},[]);var be=_.useRef({}),ye=_.useContext(J6),q=_.useMemo(function(){return{registerSubPopup:function(lr,Vi){be.current[lr]=Vi,ye==null||ye.registerSubPopup(lr,Vi)}}},[ye]),U=gRe(),ce=_.useState(null),xe=Pe(ce,2),j=xe[0],Be=xe[1],ze=ma(function(Rt){UC(Rt)&&j!==Rt&&Be(Rt),ye==null||ye.registerSubPopup(U,Rt)}),Ve=_.useState(null),pe=Pe(Ve,2),Me=pe[0],Ue=pe[1],Re=_.useRef(null),et=ma(function(Rt){UC(Rt)&&Me!==Rt&&(Ue(Rt),Re.current=Rt)}),Xe=_.Children.only(a),Ze=(Xe==null?void 0:Xe.props)||{},Mt={},Gt=ma(function(Rt){var lr,Vi,In=Me;return(In==null?void 0:In.contains(Rt))||((lr=KC(In))===null||lr===void 0?void 0:lr.host)===Rt||Rt===In||(j==null?void 0:j.contains(Rt))||((Vi=KC(j))===null||Vi===void 0?void 0:Vi.host)===Rt||Rt===j||Object.values(be.current).some(function(Ui){return(Ui==null?void 0:Ui.contains(Rt))||Rt===Ui})}),ue=tH(s,H,Z,Q),Ae=tH(s,ie,re,ee),ke=_.useState(h||!1),Ie=Pe(ke,2),$e=Ie[0],tt=Ie[1],He=u??$e,gt=ma(function(Rt){u===void 0&&tt(Rt)});mi(function(){tt(u||!1)},[u]);var ot=_.useRef(He);ot.current=He;var at=_.useRef([]);at.current=[];var Qe=ma(function(Rt){var lr;gt(Rt),((lr=at.current[at.current.length-1])!==null&&lr!==void 0?lr:He)!==Rt&&(at.current.push(Rt),f==null||f(Rt))}),ut=_.useRef(),yt=function(){clearTimeout(ut.current)},xt=function(lr){var Vi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;yt(),Vi===0?Qe(lr):ut.current=setTimeout(function(){Qe(lr)},Vi*1e3)};_.useEffect(function(){return yt},[]);var or=_.useState(!1),Jt=Pe(or,2),te=Jt[0],we=Jt[1];mi(function(Rt){(!Rt||He)&&we(!0)},[He]);var Te=_.useState(null),ve=Pe(Te,2),Le=ve[0],mt=ve[1],Pt=_.useState([0,0]),it=Pe(Pt,2),qe=it[0],pt=it[1],St=function(lr){pt([lr.clientX,lr.clientY])},Ot=UOe(He,j,V?qe:Me,R,k,O,W),Ct=Pe(Ot,11),Br=Ct[0],hi=Ct[1],ji=Ct[2],Ar=Ct[3],kt=Ct[4],fn=Ct[5],qt=Ct[6],yi=Ct[7],Ns=Ct[8],pn=Ct[9],Ci=Ct[10],$=FOe(Se,l,c,d),K=Pe($,2),le=K[0],J=K[1],ge=le.has("click"),De=J.has("click")||J.has("contextMenu"),dt=ma(function(){te||Ci()}),Bt=function(){ot.current&&V&&De&&xt(!1)};$Oe(He,Me,j,dt,Bt),mi(function(){dt()},[qe,R]),mi(function(){He&&!(k!=null&&k[R])&&dt()},[JSON.stringify(O)]);var Kt=_.useMemo(function(){var Rt=VOe(k,s,pn,V);return Fe(Rt,z==null?void 0:z(pn))},[pn,z,k,s,V]);_.useImperativeHandle(i,function(){return{nativeElement:Re.current,forceAlign:dt}});var pr=_.useState(0),wr=Pe(pr,2),Ai=wr[0],eo=wr[1],Da=_.useState(0),Oa=Pe(Da,2),aa=Oa[0],Po=Oa[1],xd=function(){if(B&&Me){var lr=Me.getBoundingClientRect();eo(lr.width),Po(lr.height)}},Y0=function(){xd(),dt()},Io=function(lr){we(!1),Ci(),p==null||p(lr)},Pw=function(){return new Promise(function(lr){xd(),mt(function(){return lr})})};mi(function(){Le&&(Ci(),Le(),mt(null))},[Le]);function ou(Rt,lr,Vi,In){Mt[Rt]=function(Ui){var Rw;In==null||In(Ui),xt(lr,Vi);for(var aP=arguments.length,eV=new Array(aP>1?aP-1:0),Dw=1;Dw<aP;Dw++)eV[Dw-1]=arguments[Dw];(Rw=Ze[Rt])===null||Rw===void 0||Rw.call.apply(Rw,[Ze,Ui].concat(eV))}}(ge||De)&&(Mt.onClick=function(Rt){var lr;ot.current&&De?xt(!1):!ot.current&&ge&&(St(Rt),xt(!0));for(var Vi=arguments.length,In=new Array(Vi>1?Vi-1:0),Ui=1;Ui<Vi;Ui++)In[Ui-1]=arguments[Ui];(lr=Ze.onClick)===null||lr===void 0||lr.call.apply(lr,[Ze,Rt].concat(In))}),HOe(He,De,Me,j,x,w,Gt,xt);var sf=le.has("hover"),lm=J.has("hover"),cm,K0;sf&&(ou("onMouseEnter",!0,m,function(Rt){St(Rt)}),ou("onPointerEnter",!0,m,function(Rt){St(Rt)}),cm=function(){(He||te)&&xt(!0,m)},V&&(Mt.onMouseMove=function(Rt){var lr;(lr=Ze.onMouseMove)===null||lr===void 0||lr.call(Ze,Rt)})),lm&&(ou("onMouseLeave",!1,v),ou("onPointerLeave",!1,v),K0=function(){xt(!1,v)}),le.has("focus")&&ou("onFocus",!0,y),J.has("focus")&&ou("onBlur",!1,b),le.has("contextMenu")&&(Mt.onContextMenu=function(Rt){var lr;ot.current&&J.has("contextMenu")?xt(!1):(St(Rt),xt(!0)),Rt.preventDefault();for(var Vi=arguments.length,In=new Array(Vi>1?Vi-1:0),Ui=1;Ui<Vi;Ui++)In[Ui-1]=arguments[Ui];(lr=Ze.onContextMenu)===null||lr===void 0||lr.call.apply(lr,[Ze,Rt].concat(In))}),ne&&(Mt.className=Fe(Ze.className,ne));var Q0=_e(_e({},Ze),Mt),Iw={},rP=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];rP.forEach(function(Rt){fe[Rt]&&(Iw[Rt]=function(){for(var lr,Vi=arguments.length,In=new Array(Vi),Ui=0;Ui<Vi;Ui++)In[Ui]=arguments[Ui];(lr=Q0[Rt])===null||lr===void 0||lr.call.apply(lr,[Q0].concat(In)),fe[Rt].apply(fe,In)})});var iP=_.cloneElement(Xe,_e(_e({},Q0),Iw)),nP={x:fn,y:qt},sP=X?_e({},X!==!0?X:{}):null;return _.createElement(_.Fragment,null,_.createElement(Zh,{disabled:!He,ref:et,onResize:Y0},_.createElement(BOe,{getTriggerDOMNode:se},iP)),_.createElement(J6.Provider,{value:q},_.createElement(zOe,{portal:e,ref:ze,prefixCls:s,popup:M,className:Fe(P,Kt),style:I,target:Me,onMouseEnter:cm,onMouseLeave:K0,onPointerEnter:cm,zIndex:D,open:He,keepDom:te,fresh:F,onClick:Y,mask:x,motion:ue,maskMotion:Ae,onVisibleChanged:Io,onPrepare:Pw,forceRender:C,autoDestroy:me,getPopupContainer:E,align:pn,arrow:sP,arrowPos:nP,ready:Br,offsetX:hi,offsetY:ji,offsetR:Ar,offsetB:kt,onAlign:dt,stretch:B,targetWidth:Ai/yi,targetHeight:aa/Ns})))});return t}const bM=GOe(vre);var qOe=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],XOe=function(t){var r=t===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:r,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:r,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:r,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:r,adjustY:1},htmlRegion:"scroll"}}},YOe=function(t,r){var i=t.prefixCls;t.disabled;var n=t.visible,s=t.children,a=t.popupElement,o=t.animation,l=t.transitionName,c=t.dropdownStyle,d=t.dropdownClassName,u=t.direction,h=u===void 0?"ltr":u,f=t.placement,p=t.builtinPlacements,m=t.dropdownMatchSelectWidth,g=t.dropdownRender,v=t.dropdownAlign,y=t.getPopupContainer,b=t.empty,x=t.getTriggerDOMNode,S=t.onPopupVisibleChange,w=t.onPopupMouseEnter,E=hr(t,qOe),C="".concat(i,"-dropdown"),T=a;g&&(T=g(a));var A=_.useMemo(function(){return p||XOe(m)},[p,m]),M=o?"".concat(C,"-").concat(o):l,P=typeof m=="number",I=_.useMemo(function(){return P?null:m===!1?"minWidth":"width"},[m,P]),R=c;P&&(R=_e(_e({},R),{},{width:m}));var N=_.useRef(null);return _.useImperativeHandle(r,function(){return{getPopupElement:function(){return N.current}}}),_.createElement(bM,ae({},E,{showAction:S?["click"]:[],hideAction:S?["click"]:[],popupPlacement:f||(h==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:A,prefixCls:C,popupTransitionName:M,popup:_.createElement("div",{ref:N,onMouseEnter:w},T),stretch:I,popupAlign:v,popupVisible:n,getPopupContainer:y,popupClassName:Fe(d,he({},"".concat(C,"-empty"),b)),popupStyle:R,getTriggerDOMNode:x,onPopupVisibleChange:S}),s)},$re=_.forwardRef(YOe);$re.displayName="SelectTrigger";function aH(e,t){var r=e.key,i;return"value"in e&&(i=e.value),r??(i!==void 0?i:"rc-index-key-".concat(t))}function Hre(e,t){var r=e||{},i=r.label,n=r.value,s=r.options,a=r.groupLabel,o=i||(t?"children":"label");return{label:o,value:n||"value",options:s||"options",groupLabel:a||o}}function KOe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.fieldNames,i=t.childrenAsData,n=[],s=Hre(r,!1),a=s.label,o=s.value,l=s.options,c=s.groupLabel;function d(u,h){u.forEach(function(f){if(h||!(l in f)){var p=f[o];n.push({key:aH(f,n.length),groupOption:h,data:f,label:f[a],value:p})}else{var m=f[c];m===void 0&&i&&(m=f.label),n.push({key:aH(f,n.length),group:!0,data:f,label:m}),d(f[l],!0)}})}return d(e,!1),n}function hL(e){var t=_e({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return As(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),t}}),t}function QOe(e,t){if(!t||!t.length)return null;var r=!1;function i(s,a){var o=dte(a),l=o[0],c=o.slice(1);if(!l)return[s];var d=s.split(l);return r=r||d.length>1,d.reduce(function(u,h){return[].concat(ft(u),ft(i(h,c)))},[]).filter(function(u){return u})}var n=i(e,t);return r?n:null}var ZOe=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],JOe=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"];function fL(e){return e==="tags"||e==="multiple"}var e3e=_.forwardRef(function(e,t){var r,i,n=e.id,s=e.prefixCls,a=e.className,o=e.showSearch,l=e.tagRender,c=e.direction,d=e.omitDomProps,u=e.displayValues,h=e.onDisplayValuesChange,f=e.emptyOptions,p=e.notFoundContent,m=p===void 0?"Not Found":p,g=e.onClear,v=e.mode,y=e.disabled,b=e.loading,x=e.getInputElement,S=e.getRawInputElement,w=e.open,E=e.defaultOpen,C=e.onDropdownVisibleChange,T=e.activeValue,A=e.onActiveValueChange,M=e.activeDescendantId,P=e.searchValue,I=e.autoClearSearchValue,R=e.onSearch,N=e.onSearchSplit,k=e.tokenSeparators,O=e.allowClear,D=e.suffixIcon,B=e.clearIcon,z=e.OptionList,F=e.animation,V=e.transitionName,Y=e.dropdownStyle,W=e.dropdownClassName,X=e.dropdownMatchSelectWidth,H=e.dropdownRender,ie=e.dropdownAlign,Q=e.placement,Z=e.builtinPlacements,ee=e.getPopupContainer,re=e.showAction,ne=re===void 0?[]:re,se=e.onFocus,fe=e.onBlur,me=e.onKeyUp,Oe=e.onKeyDown,Ee=e.onMouseDown,Se=hr(e,ZOe),de=fL(v),be=(o!==void 0?o:de)||v==="combobox",ye=_e({},Se);JOe.forEach(function(De){delete ye[De]}),d==null||d.forEach(function(De){delete ye[De]});var q=_.useState(!1),U=Pe(q,2),ce=U[0],xe=U[1];_.useEffect(function(){xe($F())},[]);var j=_.useRef(null),Be=_.useRef(null),ze=_.useRef(null),Ve=_.useRef(null),pe=_.useRef(null),Me=_.useRef(!1),Ue=uOe(),Re=Pe(Ue,3),et=Re[0],Xe=Re[1],Ze=Re[2];_.useImperativeHandle(t,function(){var De,dt;return{focus:(De=Ve.current)===null||De===void 0?void 0:De.focus,blur:(dt=Ve.current)===null||dt===void 0?void 0:dt.blur,scrollTo:function(Kt){var pr;return(pr=pe.current)===null||pr===void 0?void 0:pr.scrollTo(Kt)}}});var Mt=_.useMemo(function(){var De;if(v!=="combobox")return P;var dt=(De=u[0])===null||De===void 0?void 0:De.value;return typeof dt=="string"||typeof dt=="number"?String(dt):""},[P,v,u]),Gt=v==="combobox"&&typeof x=="function"&&x()||null,ue=typeof S=="function"&&S(),Ae=C0(Be,ue==null||(r=ue.props)===null||r===void 0?void 0:r.ref),ke=_.useState(!1),Ie=Pe(ke,2),$e=Ie[0],tt=Ie[1];mi(function(){tt(!0)},[]);var He=Ka(!1,{defaultValue:E,value:w}),gt=Pe(He,2),ot=gt[0],at=gt[1],Qe=$e?ot:!1,ut=!m&&f;(y||ut&&Qe&&v==="combobox")&&(Qe=!1);var yt=ut?!1:Qe,xt=_.useCallback(function(De){var dt=De!==void 0?De:!Qe;y||(at(dt),Qe!==dt&&(C==null||C(dt)))},[y,Qe,at,C]),or=_.useMemo(function(){return(k||[]).some(function(De){return[`
`,`\r
`].includes(De)})},[k]),Jt=function(dt,Bt,Kt){var pr=!0,wr=dt;A==null||A(null);var Ai=Kt?null:QOe(dt,k);return v!=="combobox"&&Ai&&(wr="",N==null||N(Ai),xt(!1),pr=!1),R&&Mt!==wr&&R(wr,{source:Bt?"typing":"effect"}),pr},te=function(dt){!dt||!dt.trim()||R(dt,{source:"submit"})};_.useEffect(function(){!Qe&&!de&&v!=="combobox"&&Jt("",!1,!1)},[Qe]),_.useEffect(function(){ot&&y&&at(!1),y&&!Me.current&&Xe(!1)},[y]);var we=kre(),Te=Pe(we,2),ve=Te[0],Le=Te[1],mt=function(dt){var Bt=ve(),Kt=dt.which;if(Kt===rt.ENTER&&(v!=="combobox"&&dt.preventDefault(),Qe||xt(!0)),Le(!!Mt),Kt===rt.BACKSPACE&&!Bt&&de&&!Mt&&u.length){for(var pr=ft(u),wr=null,Ai=pr.length-1;Ai>=0;Ai-=1){var eo=pr[Ai];if(!eo.disabled){pr.splice(Ai,1),wr=eo;break}}wr&&h(pr,{type:"remove",values:[wr]})}for(var Da=arguments.length,Oa=new Array(Da>1?Da-1:0),aa=1;aa<Da;aa++)Oa[aa-1]=arguments[aa];if(Qe&&pe.current){var Po;(Po=pe.current).onKeyDown.apply(Po,[dt].concat(Oa))}Oe==null||Oe.apply(void 0,[dt].concat(Oa))},Pt=function(dt){for(var Bt=arguments.length,Kt=new Array(Bt>1?Bt-1:0),pr=1;pr<Bt;pr++)Kt[pr-1]=arguments[pr];if(Qe&&pe.current){var wr;(wr=pe.current).onKeyUp.apply(wr,[dt].concat(Kt))}me==null||me.apply(void 0,[dt].concat(Kt))},it=function(dt){var Bt=u.filter(function(Kt){return Kt!==dt});h(Bt,{type:"remove",values:[dt]})},qe=_.useRef(!1),pt=function(){Xe(!0),y||(se&&!qe.current&&se.apply(void 0,arguments),ne.includes("focus")&&xt(!0)),qe.current=!0},St=function(){Me.current=!0,Xe(!1,function(){qe.current=!1,Me.current=!1,xt(!1)}),!y&&(Mt&&(v==="tags"?R(Mt,{source:"submit"}):v==="multiple"&&R("",{source:"blur"})),fe&&fe.apply(void 0,arguments))},Ot=[];_.useEffect(function(){return function(){Ot.forEach(function(De){return clearTimeout(De)}),Ot.splice(0,Ot.length)}},[]);var Ct=function(dt){var Bt,Kt=dt.target,pr=(Bt=ze.current)===null||Bt===void 0?void 0:Bt.getPopupElement();if(pr&&pr.contains(Kt)){var wr=setTimeout(function(){var Oa=Ot.indexOf(wr);if(Oa!==-1&&Ot.splice(Oa,1),Ze(),!ce&&!pr.contains(document.activeElement)){var aa;(aa=Ve.current)===null||aa===void 0||aa.focus()}});Ot.push(wr)}for(var Ai=arguments.length,eo=new Array(Ai>1?Ai-1:0),Da=1;Da<Ai;Da++)eo[Da-1]=arguments[Da];Ee==null||Ee.apply(void 0,[dt].concat(eo))},Br=_.useState({}),hi=Pe(Br,2),ji=hi[1];function Ar(){ji({})}var kt;ue&&(kt=function(dt){xt(dt)}),dOe(function(){var De;return[j.current,(De=ze.current)===null||De===void 0?void 0:De.getPopupElement()]},yt,xt,!!ue);var fn=_.useMemo(function(){return _e(_e({},e),{},{notFoundContent:m,open:Qe,triggerOpen:yt,id:n,showSearch:be,multiple:de,toggleOpen:xt})},[e,m,yt,Qe,n,be,de,xt]),qt=!!D||b,yi;qt&&(yi=_.createElement(yM,{className:Fe("".concat(s,"-arrow"),he({},"".concat(s,"-arrow-loading"),b)),customizeIcon:D,customizeIconProps:{loading:b,searchValue:Mt,open:Qe,focused:et,showSearch:be}}));var Ns=function(){var dt;g==null||g(),(dt=Ve.current)===null||dt===void 0||dt.focus(),h([],{type:"clear",values:u}),Jt("",!1,!1)},pn=lOe(s,Ns,u,O,B,y,Mt,v),Ci=pn.allowClear,$=pn.clearIcon,K=_.createElement(z,{ref:pe}),le=Fe(s,a,(i={},he(i,"".concat(s,"-focused"),et),he(i,"".concat(s,"-multiple"),de),he(i,"".concat(s,"-single"),!de),he(i,"".concat(s,"-allow-clear"),O),he(i,"".concat(s,"-show-arrow"),qt),he(i,"".concat(s,"-disabled"),y),he(i,"".concat(s,"-loading"),b),he(i,"".concat(s,"-open"),Qe),he(i,"".concat(s,"-customize-input"),Gt),he(i,"".concat(s,"-show-search"),be),i)),J=_.createElement($re,{ref:ze,disabled:y,prefixCls:s,visible:yt,popupElement:K,animation:F,transitionName:V,dropdownStyle:Y,dropdownClassName:W,direction:c,dropdownMatchSelectWidth:X,dropdownRender:H,dropdownAlign:ie,placement:Q,builtinPlacements:Z,getPopupContainer:ee,empty:f,getTriggerDOMNode:function(){return Be.current},onPopupVisibleChange:kt,onPopupMouseEnter:Ar},ue?_.cloneElement(ue,{ref:Ae}):_.createElement(Ure,ae({},e,{domRef:Be,prefixCls:s,inputElement:Gt,ref:Ve,id:n,showSearch:be,autoClearSearchValue:I,mode:v,activeDescendantId:M,tagRender:l,values:u,open:Qe,onToggleOpen:xt,activeValue:T,searchValue:Mt,onSearch:Jt,onSearchSubmit:te,onRemove:it,tokenWithEnter:or}))),ge;return ue?ge=J:ge=_.createElement("div",ae({className:le},ye,{ref:j,onMouseDown:Ct,onKeyDown:mt,onKeyUp:Pt,onFocus:pt,onBlur:St}),et&&!Qe&&_.createElement("span",{style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0},"aria-live":"polite"},"".concat(u.map(function(De){var dt=De.label,Bt=De.value;return["number","string"].includes(vr(dt))?dt:Bt}).join(", "))),J,yi,Ci&&$),_.createElement(Nre.Provider,{value:fn},ge)}),WF=function(){return null};WF.isSelectOptGroup=!0;var GF=function(){return null};GF.isSelectOption=!0;var Wre=_.forwardRef(function(e,t){var r=e.height,i=e.offsetY,n=e.offsetX,s=e.children,a=e.prefixCls,o=e.onInnerResize,l=e.innerProps,c=e.rtl,d=e.extra,u={},h={display:"flex",flexDirection:"column"};if(i!==void 0){var f;u={height:r,position:"relative",overflow:"hidden"},h=_e(_e({},h),{},(f={transform:"translateY(".concat(i,"px)")},he(f,c?"marginRight":"marginLeft",-n),he(f,"position","absolute"),he(f,"left",0),he(f,"right",0),he(f,"top",0),f))}return _.createElement("div",{style:u},_.createElement(Zh,{onResize:function(m){var g=m.offsetHeight;g&&o&&o()}},_.createElement("div",ae({style:h,className:Fe(he({},"".concat(a,"-holder-inner"),a)),ref:t},l),s,d)))});Wre.displayName="Filler";function oH(e,t){var r="touches"in e?e.touches[0]:e;return r[t?"pageX":"pageY"]}var lH=_.forwardRef(function(e,t){var r,i=e.prefixCls,n=e.rtl,s=e.scrollOffset,a=e.scrollRange,o=e.onStartMove,l=e.onStopMove,c=e.onScroll,d=e.horizontal,u=e.spinSize,h=e.containerSize,f=e.style,p=e.thumbStyle,m=_.useState(!1),g=Pe(m,2),v=g[0],y=g[1],b=_.useState(null),x=Pe(b,2),S=x[0],w=x[1],E=_.useState(null),C=Pe(E,2),T=C[0],A=C[1],M=!n,P=_.useRef(),I=_.useRef(),R=_.useState(!1),N=Pe(R,2),k=N[0],O=N[1],D=_.useRef(),B=function(){clearTimeout(D.current),O(!0),D.current=setTimeout(function(){O(!1)},3e3)},z=a-h||0,F=h-u||0,V=z>0,Y=_.useMemo(function(){if(s===0||z===0)return 0;var ne=s/z;return ne*F},[s,z,F]),W=function(se){se.stopPropagation(),se.preventDefault()},X=_.useRef({top:Y,dragging:v,pageY:S,startTop:T});X.current={top:Y,dragging:v,pageY:S,startTop:T};var H=function(se){y(!0),w(oH(se,d)),A(X.current.top),o(),se.stopPropagation(),se.preventDefault()};_.useEffect(function(){var ne=function(Oe){Oe.preventDefault()},se=P.current,fe=I.current;return se.addEventListener("touchstart",ne),fe.addEventListener("touchstart",H),function(){se.removeEventListener("touchstart",ne),fe.removeEventListener("touchstart",H)}},[]);var ie=_.useRef();ie.current=z;var Q=_.useRef();Q.current=F,_.useEffect(function(){if(v){var ne,se=function(Oe){var Ee=X.current,Se=Ee.dragging,de=Ee.pageY,be=Ee.startTop;if(Lr.cancel(ne),Se){var ye=oH(Oe,d)-de,q=be;!M&&d?q-=ye:q+=ye;var U=ie.current,ce=Q.current,xe=ce?q/ce:0,j=Math.ceil(xe*U);j=Math.max(j,0),j=Math.min(j,U),ne=Lr(function(){c(j,d)})}},fe=function(){y(!1),l()};return window.addEventListener("mousemove",se),window.addEventListener("touchmove",se),window.addEventListener("mouseup",fe),window.addEventListener("touchend",fe),function(){window.removeEventListener("mousemove",se),window.removeEventListener("touchmove",se),window.removeEventListener("mouseup",fe),window.removeEventListener("touchend",fe),Lr.cancel(ne)}}},[v]),_.useEffect(function(){B()},[s]),_.useImperativeHandle(t,function(){return{delayHidden:B}});var Z="".concat(i,"-scrollbar"),ee={position:"absolute",visibility:k&&V?null:"hidden"},re={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return d?(ee.height=8,ee.left=0,ee.right=0,ee.bottom=0,re.height="100%",re.width=u,M?re.left=Y:re.right=Y):(ee.width=8,ee.top=0,ee.bottom=0,M?ee.right=0:ee.left=0,re.width="100%",re.height=u,re.top=Y),_.createElement("div",{ref:P,className:Fe(Z,(r={},he(r,"".concat(Z,"-horizontal"),d),he(r,"".concat(Z,"-vertical"),!d),he(r,"".concat(Z,"-visible"),k),r)),style:_e(_e({},ee),f),onMouseDown:W,onMouseMove:B},_.createElement("div",{ref:I,className:Fe("".concat(Z,"-thumb"),he({},"".concat(Z,"-thumb-moving"),v)),style:_e(_e({},re),p),onMouseDown:H}))});function t3e(e){var t=e.children,r=e.setRef,i=_.useCallback(function(n){r(n)},[]);return _.cloneElement(t,{ref:i})}function r3e(e,t,r,i,n,s,a){var o=a.getKey;return e.slice(t,r+1).map(function(l,c){var d=t+c,u=s(l,d,{style:{width:i}}),h=o(l);return _.createElement(t3e,{key:h,setRef:function(p){return n(l,p)}},u)})}var i3e=function(){function e(){Ds(this,e),this.maps=void 0,this.id=0,this.maps=Object.create(null)}return Os(e,[{key:"set",value:function(r,i){this.maps[r]=i,this.id+=1}},{key:"get",value:function(r){return this.maps[r]}}]),e}();function n3e(e,t,r){var i=_.useState(0),n=Pe(i,2),s=n[0],a=n[1],o=_.useRef(new Map),l=_.useRef(new i3e),c=_.useRef();function d(){Lr.cancel(c.current)}function u(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;d();var p=function(){o.current.forEach(function(g,v){if(g&&g.offsetParent){var y=V1(g),b=y.offsetHeight;l.current.get(v)!==b&&l.current.set(v,y.offsetHeight)}}),a(function(g){return g+1})};f?p():c.current=Lr(p)}function h(f,p){var m=e(f),g=o.current.get(m);p?(o.current.set(m,p),u()):o.current.delete(m),!g!=!p&&(p?t==null||t(f):r==null||r(f))}return _.useEffect(function(){return d},[]),[h,u,l.current,s]}var s3e=10;function a3e(e,t,r,i,n,s,a,o){var l=_.useRef(),c=_.useState(null),d=Pe(c,2),u=d[0],h=d[1];return mi(function(){if(u&&u.times<s3e){if(!e.current){h(function(B){return _e({},B)});return}s();var f=u.targetAlign,p=u.originAlign,m=u.index,g=u.offset,v=e.current.clientHeight,y=!1,b=f,x=null;if(v){for(var S=f||p,w=0,E=0,C=0,T=Math.min(t.length-1,m),A=0;A<=T;A+=1){var M=n(t[A]);E=w;var P=r.get(M);C=E+(P===void 0?i:P),w=C}for(var I=S==="top"?g:v-g,R=T;R>=0;R-=1){var N=n(t[R]),k=r.get(N);if(k===void 0){y=!0;break}if(I-=k,I<=0)break}switch(S){case"top":x=E-g;break;case"bottom":x=C-v+g;break;default:{var O=e.current.scrollTop,D=O+v;E<O?b="top":C>D&&(b="bottom")}}x!==null&&a(x),x!==u.lastTop&&(y=!0)}y&&h(_e(_e({},u),{},{times:u.times+1,targetAlign:b,lastTop:x}))}},[u,e.current]),function(f){if(f==null){o();return}if(Lr.cancel(l.current),typeof f=="number")a(f);else if(f&&vr(f)==="object"){var p,m=f.align;"index"in f?p=f.index:p=t.findIndex(function(y){return n(y)===f.key});var g=f.offset,v=g===void 0?0:g;h({times:0,index:p,offset:v,originAlign:m})}}}function o3e(e,t,r){var i=e.length,n=t.length,s,a;if(i===0&&n===0)return null;i<n?(s=e,a=t):(s=t,a=e);var o={__EMPTY_ITEM__:!0};function l(p){return p!==void 0?r(p):o}for(var c=null,d=Math.abs(i-n)!==1,u=0;u<a.length;u+=1){var h=l(s[u]),f=l(a[u]);if(h!==f){c=u,d=d||h!==l(a[u+1]);break}}return c===null?null:{index:c,multiple:d}}function l3e(e,t,r){var i=_.useState(e),n=Pe(i,2),s=n[0],a=n[1],o=_.useState(null),l=Pe(o,2),c=l[0],d=l[1];return _.useEffect(function(){var u=o3e(s||[],e||[],t);(u==null?void 0:u.index)!==void 0&&(r==null||r(u.index),d(e[u.index])),a(e)},[e]),[c]}var cH=(typeof navigator>"u"?"undefined":vr(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const Gre=function(e,t){var r=_.useRef(!1),i=_.useRef(null);function n(){clearTimeout(i.current),r.current=!0,i.current=setTimeout(function(){r.current=!1},50)}var s=_.useRef({top:e,bottom:t});return s.current.top=e,s.current.bottom=t,function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=a<0&&s.current.top||a>0&&s.current.bottom;return o&&l?(clearTimeout(i.current),r.current=!1):(!l||r.current)&&n(),!r.current&&l}};function c3e(e,t,r,i,n){var s=_.useRef(0),a=_.useRef(null),o=_.useRef(null),l=_.useRef(!1),c=Gre(t,r);function d(g,v){Lr.cancel(a.current),s.current+=v,o.current=v,!c(v)&&(cH||g.preventDefault(),a.current=Lr(function(){var y=l.current?10:1;n(s.current*y),s.current=0}))}function u(g,v){n(v,!0),cH||g.preventDefault()}var h=_.useRef(null),f=_.useRef(null);function p(g){if(e){Lr.cancel(f.current),f.current=Lr(function(){h.current=null},2);var v=g.deltaX,y=g.deltaY,b=g.shiftKey,x=v,S=y;(h.current==="sx"||!h.current&&b&&y&&!v)&&(x=y,S=0,h.current="sx");var w=Math.abs(x),E=Math.abs(S);h.current===null&&(h.current=i&&w>E?"x":"y"),h.current==="y"?d(g,S):u(g,x)}}function m(g){e&&(l.current=g.detail===o.current)}return[p,m]}var u3e=14/15;function d3e(e,t,r){var i=_.useRef(!1),n=_.useRef(0),s=_.useRef(null),a=_.useRef(null),o,l=function(h){if(i.current){var f=Math.ceil(h.touches[0].pageY),p=n.current-f;n.current=f,r(p)&&h.preventDefault(),clearInterval(a.current),a.current=setInterval(function(){p*=u3e,(!r(p,!0)||Math.abs(p)<=.1)&&clearInterval(a.current)},16)}},c=function(){i.current=!1,o()},d=function(h){o(),h.touches.length===1&&!i.current&&(i.current=!0,n.current=Math.ceil(h.touches[0].pageY),s.current=h.target,s.current.addEventListener("touchmove",l),s.current.addEventListener("touchend",c))};o=function(){s.current&&(s.current.removeEventListener("touchmove",l),s.current.removeEventListener("touchend",c))},mi(function(){return e&&t.current.addEventListener("touchstart",d),function(){var u;(u=t.current)===null||u===void 0||u.removeEventListener("touchstart",d),o(),clearInterval(a.current)}},[e])}var h3e=20;function uH(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e/t*100;return isNaN(r)&&(r=0),r=Math.max(r,h3e),r=Math.min(r,e/2),Math.floor(r)}function f3e(e,t,r,i){var n=_.useMemo(function(){return[new Map,[]]},[e,r.id,i]),s=Pe(n,2),a=s[0],o=s[1],l=function(d){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,h=a.get(d),f=a.get(u);if(h===void 0||f===void 0)for(var p=e.length,m=o.length;m<p;m+=1){var g,v=e[m],y=t(v);a.set(y,m);var b=(g=r.get(y))!==null&&g!==void 0?g:i;if(o[m]=(o[m-1]||0)+b,y===d&&(h=m),y===u&&(f=m),h!==void 0&&f!==void 0)break}return{top:o[h-1]||0,bottom:o[f]}};return l}var p3e=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],m3e=[],g3e={overflowY:"auto",overflowAnchor:"none"};function v3e(e,t){var r=e.prefixCls,i=r===void 0?"rc-virtual-list":r,n=e.className,s=e.height,a=e.itemHeight,o=e.fullHeight,l=o===void 0?!0:o,c=e.style,d=e.data,u=e.children,h=e.itemKey,f=e.virtual,p=e.direction,m=e.scrollWidth,g=e.component,v=g===void 0?"div":g,y=e.onScroll,b=e.onVirtualScroll,x=e.onVisibleChange,S=e.innerProps,w=e.extraRender,E=e.styles,C=hr(e,p3e),T=!!(f!==!1&&s&&a),A=T&&d&&(a*d.length>s||!!m),M=p==="rtl",P=Fe(i,he({},"".concat(i,"-rtl"),M),n),I=d||m3e,R=_.useRef(),N=_.useRef(),k=_.useState(0),O=Pe(k,2),D=O[0],B=O[1],z=_.useState(0),F=Pe(z,2),V=F[0],Y=F[1],W=_.useState(!1),X=Pe(W,2),H=X[0],ie=X[1],Q=function(){ie(!0)},Z=function(){ie(!1)},ee=_.useCallback(function(it){return typeof h=="function"?h(it):it==null?void 0:it[h]},[h]),re={getKey:ee};function ne(it){B(function(qe){var pt;typeof it=="function"?pt=it(qe):pt=it;var St=Ae(pt);return R.current.scrollTop=St,St})}var se=_.useRef({start:0,end:I.length}),fe=_.useRef(),me=l3e(I,ee),Oe=Pe(me,1),Ee=Oe[0];fe.current=Ee;var Se=n3e(ee,null,null),de=Pe(Se,4),be=de[0],ye=de[1],q=de[2],U=de[3],ce=_.useMemo(function(){if(!T)return{scrollHeight:void 0,start:0,end:I.length-1,offset:void 0};if(!A){var it;return{scrollHeight:((it=N.current)===null||it===void 0?void 0:it.offsetHeight)||0,start:0,end:I.length-1,offset:void 0}}for(var qe=0,pt,St,Ot,Ct=I.length,Br=0;Br<Ct;Br+=1){var hi=I[Br],ji=ee(hi),Ar=q.get(ji),kt=qe+(Ar===void 0?a:Ar);kt>=D&&pt===void 0&&(pt=Br,St=qe),kt>D+s&&Ot===void 0&&(Ot=Br),qe=kt}return pt===void 0&&(pt=0,St=0,Ot=Math.ceil(s/a)),Ot===void 0&&(Ot=I.length-1),Ot=Math.min(Ot+1,I.length-1),{scrollHeight:qe,start:pt,end:Ot,offset:St}},[A,T,D,I,U,s]),xe=ce.scrollHeight,j=ce.start,Be=ce.end,ze=ce.offset;se.current.start=j,se.current.end=Be;var Ve=_.useState({width:0,height:s}),pe=Pe(Ve,2),Me=pe[0],Ue=pe[1],Re=function(qe){Ue({width:qe.width||qe.offsetWidth,height:qe.height||qe.offsetHeight})},et=_.useRef(),Xe=_.useRef(),Ze=_.useMemo(function(){return uH(Me.width,m)},[Me.width,m]),Mt=_.useMemo(function(){return uH(Me.height,xe)},[Me.height,xe]),Gt=xe-s,ue=_.useRef(Gt);ue.current=Gt;function Ae(it){var qe=it;return Number.isNaN(ue.current)||(qe=Math.min(qe,ue.current)),qe=Math.max(qe,0),qe}var ke=D<=0,Ie=D>=Gt,$e=Gre(ke,Ie),tt=function(){return{x:M?-V:V,y:D}},He=_.useRef(tt()),gt=ma(function(){if(b){var it=tt();(He.current.x!==it.x||He.current.y!==it.y)&&(b(it),He.current=it)}});function ot(it,qe){var pt=it;qe?(Vl.flushSync(function(){Y(pt)}),gt()):ne(pt)}function at(it){var qe=it.currentTarget.scrollTop;qe!==D&&ne(qe),y==null||y(it),gt()}var Qe=function(qe){var pt=qe,St=m-Me.width;return pt=Math.max(pt,0),pt=Math.min(pt,St),pt},ut=ma(function(it,qe){qe?(Vl.flushSync(function(){Y(function(pt){var St=pt+(M?-it:it);return Qe(St)})}),gt()):ne(function(pt){var St=pt+it;return St})}),yt=c3e(T,ke,Ie,!!m,ut),xt=Pe(yt,2),or=xt[0],Jt=xt[1];d3e(T,R,function(it,qe){return $e(it,qe)?!1:(or({preventDefault:function(){},deltaY:it}),!0)}),mi(function(){function it(pt){T&&pt.preventDefault()}var qe=R.current;return qe.addEventListener("wheel",or),qe.addEventListener("DOMMouseScroll",Jt),qe.addEventListener("MozMousePixelScroll",it),function(){qe.removeEventListener("wheel",or),qe.removeEventListener("DOMMouseScroll",Jt),qe.removeEventListener("MozMousePixelScroll",it)}},[T]),mi(function(){m&&Y(function(it){return Qe(it)})},[Me.width,m]);var te=function(){var qe,pt;(qe=et.current)===null||qe===void 0||qe.delayHidden(),(pt=Xe.current)===null||pt===void 0||pt.delayHidden()},we=a3e(R,I,q,a,ee,function(){return ye(!0)},ne,te);_.useImperativeHandle(t,function(){return{getScrollInfo:tt,scrollTo:function(qe){function pt(St){return St&&vr(St)==="object"&&("left"in St||"top"in St)}pt(qe)?(qe.left!==void 0&&Y(Qe(qe.left)),we(qe.top)):we(qe)}}}),mi(function(){if(x){var it=I.slice(j,Be+1);x(it,I)}},[j,Be,I]);var Te=f3e(I,ee,q,a),ve=w==null?void 0:w({start:j,end:Be,virtual:A,offsetX:V,offsetY:ze,rtl:M,getSize:Te}),Le=r3e(I,j,Be,m,be,u,re),mt=null;s&&(mt=_e(he({},l?"height":"maxHeight",s),g3e),T&&(mt.overflowY="hidden",m&&(mt.overflowX="hidden"),H&&(mt.pointerEvents="none")));var Pt={};return M&&(Pt.dir="rtl"),_.createElement("div",ae({style:_e(_e({},c),{},{position:"relative"}),className:P},Pt,C),_.createElement(Zh,{onResize:Re},_.createElement(v,{className:"".concat(i,"-holder"),style:mt,ref:R,onScroll:at,onMouseEnter:te},_.createElement(Wre,{prefixCls:i,height:xe,offsetX:V,offsetY:ze,scrollWidth:m,onInnerResize:ye,ref:N,innerProps:S,rtl:M,extra:ve},Le))),A&&xe>s&&_.createElement(lH,{ref:et,prefixCls:i,scrollOffset:D,scrollRange:xe,rtl:M,onScroll:ot,onStartMove:Q,onStopMove:Z,spinSize:Mt,containerSize:Me.height,style:E==null?void 0:E.verticalScrollBar,thumbStyle:E==null?void 0:E.verticalScrollBarThumb}),A&&m&&_.createElement(lH,{ref:Xe,prefixCls:i,scrollOffset:V,scrollRange:m,rtl:M,onScroll:ot,onStartMove:Q,onStopMove:Z,spinSize:Ze,containerSize:Me.width,horizontal:!0,style:E==null?void 0:E.horizontalScrollBar,thumbStyle:E==null?void 0:E.horizontalScrollBarThumb}))}var qre=_.forwardRef(v3e);qre.displayName="List";var Xre=_.createContext(null);function y3e(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var b3e=["disabled","title","children","style","className"];function dH(e){return typeof e=="string"||typeof e=="number"}var x3e=function(t,r){var i=cOe(),n=i.prefixCls,s=i.id,a=i.open,o=i.multiple,l=i.mode,c=i.searchValue,d=i.toggleOpen,u=i.notFoundContent,h=i.onPopupScroll,f=_.useContext(Xre),p=f.flattenOptions,m=f.onActiveValue,g=f.defaultActiveFirstOption,v=f.onSelect,y=f.menuItemSelectedIcon,b=f.rawValues,x=f.fieldNames,S=f.virtual,w=f.direction,E=f.listHeight,C=f.listItemHeight,T=f.optionRender,A="".concat(n,"-item"),M=tw(function(){return p},[a,p],function(Q,Z){return Z[0]&&Q[1]!==Z[1]}),P=_.useRef(null),I=function(Z){Z.preventDefault()},R=function(Z){P.current&&P.current.scrollTo(typeof Z=="number"?{index:Z}:Z)},N=function(Z){for(var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,re=M.length,ne=0;ne<re;ne+=1){var se=(Z+ne*ee+re)%re,fe=M[se],me=fe.group,Oe=fe.data;if(!me&&!Oe.disabled)return se}return-1},k=_.useState(function(){return N(0)}),O=Pe(k,2),D=O[0],B=O[1],z=function(Z){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;B(Z);var re={source:ee?"keyboard":"mouse"},ne=M[Z];if(!ne){m(null,-1,re);return}m(ne.value,Z,re)};_.useEffect(function(){z(g!==!1?N(0):-1)},[M.length,c]);var F=_.useCallback(function(Q){return b.has(Q)&&l!=="combobox"},[l,ft(b).toString(),b.size]);_.useEffect(function(){var Q=setTimeout(function(){if(!o&&a&&b.size===1){var ee=Array.from(b)[0],re=M.findIndex(function(ne){var se=ne.data;return se.value===ee});re!==-1&&(z(re),R(re))}});if(a){var Z;(Z=P.current)===null||Z===void 0||Z.scrollTo(void 0)}return function(){return clearTimeout(Q)}},[a,c]);var V=function(Z){Z!==void 0&&v(Z,{selected:!b.has(Z)}),o||d(!1)};if(_.useImperativeHandle(r,function(){return{onKeyDown:function(Z){var ee=Z.which,re=Z.ctrlKey;switch(ee){case rt.N:case rt.P:case rt.UP:case rt.DOWN:{var ne=0;if(ee===rt.UP?ne=-1:ee===rt.DOWN?ne=1:y3e()&&re&&(ee===rt.N?ne=1:ee===rt.P&&(ne=-1)),ne!==0){var se=N(D+ne,ne);R(se),z(se,!0)}break}case rt.ENTER:{var fe=M[D];fe&&!fe.data.disabled?V(fe.value):V(void 0),a&&Z.preventDefault();break}case rt.ESC:d(!1),a&&Z.stopPropagation()}},onKeyUp:function(){},scrollTo:function(Z){R(Z)}}}),M.length===0)return _.createElement("div",{role:"listbox",id:"".concat(s,"_list"),className:"".concat(A,"-empty"),onMouseDown:I},u);var Y=Object.keys(x).map(function(Q){return x[Q]}),W=function(Z){return Z.label};function X(Q,Z){var ee=Q.group;return{role:ee?"presentation":"option",id:"".concat(s,"_list_").concat(Z)}}var H=function(Z){var ee=M[Z];if(!ee)return null;var re=ee.data||{},ne=re.value,se=ee.group,fe=QC(re,!0),me=W(ee);return ee?_.createElement("div",ae({"aria-label":typeof me=="string"&&!se?me:null},fe,{key:Z},X(ee,Z),{"aria-selected":F(ne)}),ne):null},ie={role:"listbox",id:"".concat(s,"_list")};return _.createElement(_.Fragment,null,S&&_.createElement("div",ae({},ie,{style:{height:0,width:0,overflow:"hidden"}}),H(D-1),H(D),H(D+1)),_.createElement(qre,{itemKey:"key",ref:P,data:M,height:E,itemHeight:C,fullHeight:!1,onMouseDown:I,onScroll:h,virtual:S,direction:w,innerProps:S?null:ie},function(Q,Z){var ee,re=Q.group,ne=Q.groupOption,se=Q.data,fe=Q.label,me=Q.value,Oe=se.key;if(re){var Ee,Se=(Ee=se.title)!==null&&Ee!==void 0?Ee:dH(fe)?fe.toString():void 0;return _.createElement("div",{className:Fe(A,"".concat(A,"-group")),title:Se},fe!==void 0?fe:Oe)}var de=se.disabled,be=se.title;se.children;var ye=se.style,q=se.className,U=hr(se,b3e),ce=Pa(U,Y),xe=F(me),j="".concat(A,"-option"),Be=Fe(A,j,q,(ee={},he(ee,"".concat(j,"-grouped"),ne),he(ee,"".concat(j,"-active"),D===Z&&!de),he(ee,"".concat(j,"-disabled"),de),he(ee,"".concat(j,"-selected"),xe),ee)),ze=W(Q),Ve=!y||typeof y=="function"||xe,pe=typeof ze=="number"?ze:ze||me,Me=dH(pe)?pe.toString():void 0;return be!==void 0&&(Me=be),_.createElement("div",ae({},QC(ce),S?{}:X(Q,Z),{"aria-selected":xe,className:Be,title:Me,onMouseMove:function(){D===Z||de||z(Z)},onClick:function(){de||V(me)},style:ye}),_.createElement("div",{className:"".concat(j,"-content")},typeof T=="function"?T(Q,{index:Z}):pe),_.isValidElement(y)||xe,Ve&&_.createElement(yM,{className:"".concat(A,"-option-state"),customizeIcon:y,customizeIconProps:{value:me,disabled:de,isSelected:xe}},xe?"✓":null))}))},Yre=_.forwardRef(x3e);Yre.displayName="OptionList";const w3e=function(e,t){var r=_.useRef({values:new Map,options:new Map}),i=_.useMemo(function(){var s=r.current,a=s.values,o=s.options,l=e.map(function(u){if(u.label===void 0){var h;return _e(_e({},u),{},{label:(h=a.get(u.value))===null||h===void 0?void 0:h.label})}return u}),c=new Map,d=new Map;return l.forEach(function(u){c.set(u.value,u),d.set(u.value,t.get(u.value)||o.get(u.value))}),r.current.values=c,r.current.options=d,l},[e,t]),n=_.useCallback(function(s){return t.get(s)||r.current.options.get(s)},[t]);return[i,n]};function RI(e,t){return jre(e).join("").toUpperCase().includes(t)}const _3e=function(e,t,r,i,n){return _.useMemo(function(){if(!r||i===!1)return e;var s=t.options,a=t.label,o=t.value,l=[],c=typeof i=="function",d=r.toUpperCase(),u=c?i:function(f,p){return n?RI(p[n],d):p[s]?RI(p[a!=="children"?a:"label"],d):RI(p[o],d)},h=c?function(f){return hL(f)}:function(f){return f};return e.forEach(function(f){if(f[s]){var p=u(r,h(f));if(p)l.push(f);else{var m=f[s].filter(function(g){return u(r,h(g))});m.length&&l.push(_e(_e({},f),{},he({},s,m)))}return}u(r,h(f))&&l.push(f)}),l},[e,i,n,r,t])};var hH=0,S3e=_a();function E3e(){var e;return S3e?(e=hH,hH+=1):e="TEST_OR_SSR",e}function C3e(e){var t=_.useState(),r=Pe(t,2),i=r[0],n=r[1];return _.useEffect(function(){n("rc_select_".concat(E3e()))},[]),e||i}var A3e=["children","value"],T3e=["children"];function M3e(e){var t=e,r=t.key,i=t.props,n=i.children,s=i.value,a=hr(i,A3e);return _e({key:r,value:s!==void 0?s:r,children:n},a)}function Kre(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Qc(e).map(function(r,i){if(!_.isValidElement(r)||!r.type)return null;var n=r,s=n.type.isSelectOptGroup,a=n.key,o=n.props,l=o.children,c=hr(o,T3e);return t||!s?M3e(r):_e(_e({key:"__RC_SELECT_GRP__".concat(a===null?i:a,"__"),label:a},c),{},{options:Kre(l)})}).filter(function(r){return r})}function P3e(e,t,r,i,n){return _.useMemo(function(){var s=e,a=!e;a&&(s=Kre(t));var o=new Map,l=new Map,c=function(h,f,p){p&&typeof p=="string"&&h.set(f[p],f)};function d(u){for(var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f=0;f<u.length;f+=1){var p=u[f];!p[r.options]||h?(o.set(p[r.value],p),c(l,p,r.label),c(l,p,i),c(l,p,n)):d(p[r.options],!0)}}return d(s),{options:s,valueOptions:o,labelOptions:l}},[e,t,r,i,n])}function fH(e){var t=_.useRef();t.current=e;var r=_.useCallback(function(){return t.current.apply(t,arguments)},[]);return r}var I3e=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange"],R3e=["inputValue"];function D3e(e){return!e||vr(e)!=="object"}var O3e=_.forwardRef(function(e,t){var r=e.id,i=e.mode,n=e.prefixCls,s=n===void 0?"rc-select":n,a=e.backfill,o=e.fieldNames,l=e.inputValue,c=e.searchValue,d=e.onSearch,u=e.autoClearSearchValue,h=u===void 0?!0:u,f=e.onSelect,p=e.onDeselect,m=e.dropdownMatchSelectWidth,g=m===void 0?!0:m,v=e.filterOption,y=e.filterSort,b=e.optionFilterProp,x=e.optionLabelProp,S=e.options,w=e.optionRender,E=e.children,C=e.defaultActiveFirstOption,T=e.menuItemSelectedIcon,A=e.virtual,M=e.direction,P=e.listHeight,I=P===void 0?200:P,R=e.listItemHeight,N=R===void 0?20:R,k=e.value,O=e.defaultValue,D=e.labelInValue,B=e.onChange,z=hr(e,I3e),F=C3e(r),V=fL(i),Y=!!(!S&&E),W=_.useMemo(function(){return v===void 0&&i==="combobox"?!1:v},[v,i]),X=_.useMemo(function(){return Hre(o,Y)},[JSON.stringify(o),Y]),H=Ka("",{value:c!==void 0?c:l,postState:function(ut){return ut||""}}),ie=Pe(H,2),Q=ie[0],Z=ie[1],ee=P3e(S,E,X,b,x),re=ee.valueOptions,ne=ee.labelOptions,se=ee.options,fe=_.useCallback(function(Qe){var ut=jre(Qe);return ut.map(function(yt){var xt,or,Jt,te,we;if(D3e(yt))xt=yt;else{var Te;Jt=yt.key,or=yt.label,xt=(Te=yt.value)!==null&&Te!==void 0?Te:Jt}var ve=re.get(xt);if(ve){var Le;or===void 0&&(or=ve==null?void 0:ve[x||X.label]),Jt===void 0&&(Jt=(Le=ve==null?void 0:ve.key)!==null&&Le!==void 0?Le:xt),te=ve==null?void 0:ve.disabled,we=ve==null?void 0:ve.title}return{label:or,value:xt,key:Jt,disabled:te,title:we}})},[X,x,re]),me=Ka(O,{value:k}),Oe=Pe(me,2),Ee=Oe[0],Se=Oe[1],de=_.useMemo(function(){var Qe,ut=fe(Ee);return i==="combobox"&&TOe((Qe=ut[0])===null||Qe===void 0?void 0:Qe.value)?[]:ut},[Ee,fe,i]),be=w3e(de,re),ye=Pe(be,2),q=ye[0],U=ye[1],ce=_.useMemo(function(){if(!i&&q.length===1){var Qe=q[0];if(Qe.value===null&&(Qe.label===null||Qe.label===void 0))return[]}return q.map(function(ut){var yt;return _e(_e({},ut),{},{label:(yt=ut.label)!==null&&yt!==void 0?yt:ut.value})})},[i,q]),xe=_.useMemo(function(){return new Set(q.map(function(Qe){return Qe.value}))},[q]);_.useEffect(function(){if(i==="combobox"){var Qe,ut=(Qe=q[0])===null||Qe===void 0?void 0:Qe.value;Z(AOe(ut)?String(ut):"")}},[q]);var j=fH(function(Qe,ut){var yt,xt=ut??Qe;return yt={},he(yt,X.value,Qe),he(yt,X.label,xt),yt}),Be=_.useMemo(function(){if(i!=="tags")return se;var Qe=ft(se),ut=function(xt){return re.has(xt)};return ft(q).sort(function(yt,xt){return yt.value<xt.value?-1:1}).forEach(function(yt){var xt=yt.value;ut(xt)||Qe.push(j(xt,yt.label))}),Qe},[j,se,re,q,i]),ze=_3e(Be,X,Q,W,b),Ve=_.useMemo(function(){return i!=="tags"||!Q||ze.some(function(Qe){return Qe[b||"value"]===Q})||ze.some(function(Qe){return Qe[X.value]===Q})?ze:[j(Q)].concat(ft(ze))},[j,b,i,ze,Q,X]),pe=_.useMemo(function(){return y?ft(Ve).sort(function(Qe,ut){return y(Qe,ut)}):Ve},[Ve,y]),Me=_.useMemo(function(){return KOe(pe,{fieldNames:X,childrenAsData:Y})},[pe,X,Y]),Ue=function(ut){var yt=fe(ut);if(Se(yt),B&&(yt.length!==q.length||yt.some(function(Jt,te){var we;return((we=q[te])===null||we===void 0?void 0:we.value)!==(Jt==null?void 0:Jt.value)}))){var xt=D?yt:yt.map(function(Jt){return Jt.value}),or=yt.map(function(Jt){return hL(U(Jt.value))});B(V?xt:xt[0],V?or:or[0])}},Re=_.useState(null),et=Pe(Re,2),Xe=et[0],Ze=et[1],Mt=_.useState(0),Gt=Pe(Mt,2),ue=Gt[0],Ae=Gt[1],ke=C!==void 0?C:i!=="combobox",Ie=_.useCallback(function(Qe,ut){var yt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},xt=yt.source,or=xt===void 0?"keyboard":xt;Ae(ut),a&&i==="combobox"&&Qe!==null&&or==="keyboard"&&Ze(String(Qe))},[a,i]),$e=function(ut,yt,xt){var or=function(){var qe,pt=U(ut);return[D?{label:pt==null?void 0:pt[X.label],value:ut,key:(qe=pt==null?void 0:pt.key)!==null&&qe!==void 0?qe:ut}:ut,hL(pt)]};if(yt&&f){var Jt=or(),te=Pe(Jt,2),we=te[0],Te=te[1];f(we,Te)}else if(!yt&&p&&xt!=="clear"){var ve=or(),Le=Pe(ve,2),mt=Le[0],Pt=Le[1];p(mt,Pt)}},tt=fH(function(Qe,ut){var yt,xt=V?ut.selected:!0;xt?yt=V?[].concat(ft(q),[Qe]):[Qe]:yt=q.filter(function(or){return or.value!==Qe}),Ue(yt),$e(Qe,xt),i==="combobox"?Ze(""):(!fL||h)&&(Z(""),Ze(""))}),He=function(ut,yt){Ue(ut);var xt=yt.type,or=yt.values;(xt==="remove"||xt==="clear")&&or.forEach(function(Jt){$e(Jt.value,!1,xt)})},gt=function(ut,yt){if(Z(ut),Ze(null),yt.source==="submit"){var xt=(ut||"").trim();if(xt){var or=Array.from(new Set([].concat(ft(xe),[xt])));Ue(or),$e(xt,!0),Z("")}return}yt.source!=="blur"&&(i==="combobox"&&Ue(ut),d==null||d(ut))},ot=function(ut){var yt=ut;i!=="tags"&&(yt=ut.map(function(or){var Jt=ne.get(or);return Jt==null?void 0:Jt.value}).filter(function(or){return or!==void 0}));var xt=Array.from(new Set([].concat(ft(xe),ft(yt))));Ue(xt),xt.forEach(function(or){$e(or,!0)})},at=_.useMemo(function(){var Qe=A!==!1&&g!==!1;return _e(_e({},ee),{},{flattenOptions:Me,onActiveValue:Ie,defaultActiveFirstOption:ke,onSelect:tt,menuItemSelectedIcon:T,rawValues:xe,fieldNames:X,virtual:Qe,direction:M,listHeight:I,listItemHeight:N,childrenAsData:Y,optionRender:w})},[ee,Me,Ie,ke,tt,T,xe,X,A,g,I,N,Y,w]);return _.createElement(Xre.Provider,{value:at},_.createElement(e3e,ae({},z,{id:F,prefixCls:s,ref:t,omitDomProps:R3e,mode:i,displayValues:ce,onDisplayValuesChange:He,direction:M,searchValue:Q,onSearch:gt,autoClearSearchValue:h,onSearchSplit:ot,dropdownMatchSelectWidth:g,OptionList:Yre,emptyOptions:!Me.length,activeValue:Xe,activeDescendantId:"".concat(F,"_list_").concat(ue)})))}),qF=O3e;qF.Option=GF;qF.OptGroup=WF;function qu(e,t,r){return Fe({[`${e}-status-success`]:t==="success",[`${e}-status-warning`]:t==="warning",[`${e}-status-error`]:t==="error",[`${e}-status-validating`]:t==="validating",[`${e}-has-feedback`]:r})}const xM=(e,t)=>t||e,L3e=()=>{const[,e]=ia(),r=new Bn(e.colorBgBase).toHsl().l<.5?{opacity:.65}:{};return _.createElement("svg",{style:r,width:"184",height:"152",viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg"},_.createElement("g",{fill:"none",fillRule:"evenodd"},_.createElement("g",{transform:"translate(24 31.67)"},_.createElement("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),_.createElement("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),_.createElement("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),_.createElement("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),_.createElement("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})),_.createElement("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),_.createElement("g",{transform:"translate(149.65 15.383)",fill:"#FFF"},_.createElement("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),_.createElement("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"}))))},N3e=L3e,k3e=()=>{const[,e]=ia(),{colorFill:t,colorFillTertiary:r,colorFillQuaternary:i,colorBgContainer:n}=e,{borderColor:s,shadowColor:a,contentColor:o}=_.useMemo(()=>({borderColor:new Bn(t).onBackground(n).toHexShortString(),shadowColor:new Bn(r).onBackground(n).toHexShortString(),contentColor:new Bn(i).onBackground(n).toHexShortString()}),[t,r,i,n]);return _.createElement("svg",{width:"64",height:"41",viewBox:"0 0 64 41",xmlns:"http://www.w3.org/2000/svg"},_.createElement("g",{transform:"translate(0 1)",fill:"none",fillRule:"evenodd"},_.createElement("ellipse",{fill:a,cx:"32",cy:"33",rx:"32",ry:"7"}),_.createElement("g",{fillRule:"nonzero",stroke:s},_.createElement("path",{d:"M55 12.76L44.854 1.258C44.367.474 43.656 0 42.907 0H21.093c-.749 0-1.46.474-1.947 1.257L9 12.761V22h46v-9.24z"}),_.createElement("path",{d:"M41.613 15.931c0-1.605.994-2.93 2.227-2.931H55v18.137C55 33.26 53.68 35 52.05 35h-40.1C10.32 35 9 33.259 9 31.137V13h11.16c1.233 0 2.227 1.323 2.227 2.928v.022c0 1.605 1.005 2.901 2.237 2.901h14.752c1.232 0 2.237-1.308 2.237-2.913v-.007z",fill:o}))))},z3e=k3e,B3e=e=>{const{componentCls:t,margin:r,marginXS:i,marginXL:n,fontSize:s,lineHeight:a}=e;return{[t]:{marginInline:i,fontSize:s,lineHeight:a,textAlign:"center",[`${t}-image`]:{height:e.emptyImgHeight,marginBottom:i,opacity:e.opacityImage,img:{height:"100%"},svg:{maxWidth:"100%",height:"100%",margin:"auto"}},[`${t}-description`]:{color:e.colorText},[`${t}-footer`]:{marginTop:r},"&-normal":{marginBlock:n,color:e.colorTextDisabled,[`${t}-description`]:{color:e.colorTextDisabled},[`${t}-image`]:{height:e.emptyImgHeightMD}},"&-small":{marginBlock:i,color:e.colorTextDisabled,[`${t}-image`]:{height:e.emptyImgHeightSM}}}}},F3e=sa("Empty",e=>{const{componentCls:t,controlHeightLG:r,calc:i}=e,n=zr(e,{emptyImgCls:`${t}-img`,emptyImgHeight:i(r).mul(2.5).equal(),emptyImgHeightMD:r,emptyImgHeightSM:i(r).mul(.875).equal()});return[B3e(n)]});var j3e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Qre=_.createElement(N3e,null),Zre=_.createElement(z3e,null),XF=e=>{var{className:t,rootClassName:r,prefixCls:i,image:n=Qre,description:s,children:a,imageStyle:o,style:l}=e,c=j3e(e,["className","rootClassName","prefixCls","image","description","children","imageStyle","style"]);const{getPrefixCls:d,direction:u,empty:h}=_.useContext(br),f=d("empty",i),[p,m,g]=F3e(f),[v]=mte("Empty"),y=typeof s<"u"?s:v==null?void 0:v.description,b=typeof y=="string"?y:"empty";let x=null;return typeof n=="string"?x=_.createElement("img",{alt:b,src:n}):x=n,p(_.createElement("div",Object.assign({className:Fe(m,g,f,h==null?void 0:h.className,{[`${f}-normal`]:n===Zre,[`${f}-rtl`]:u==="rtl"},t,r),style:Object.assign(Object.assign({},h==null?void 0:h.style),l)},c),_.createElement("div",{className:`${f}-image`,style:o},x),y&&_.createElement("div",{className:`${f}-description`},y),a&&_.createElement("div",{className:`${f}-footer`},a)))};XF.PRESENTED_IMAGE_DEFAULT=Qre;XF.PRESENTED_IMAGE_SIMPLE=Zre;const yy=XF,V3e=e=>{const{componentName:t}=e,{getPrefixCls:r}=_.useContext(br),i=r("empty");switch(t){case"Table":case"List":return Ge.createElement(yy,{image:yy.PRESENTED_IMAGE_SIMPLE});case"Select":case"TreeSelect":case"Cascader":case"Transfer":case"Mentions":return Ge.createElement(yy,{image:yy.PRESENTED_IMAGE_SIMPLE,className:`${i}-small`});default:return Ge.createElement(yy,null)}},U3e=V3e,$3e=e=>{const r={overflow:{adjustX:!0,adjustY:!0,shiftY:!0},htmlRegion:e==="scroll"?"scroll":"visible",dynamicInset:!0};return{bottomLeft:Object.assign(Object.assign({},r),{points:["tl","bl"],offset:[0,4]}),bottomRight:Object.assign(Object.assign({},r),{points:["tr","br"],offset:[0,4]}),topLeft:Object.assign(Object.assign({},r),{points:["bl","tl"],offset:[0,-4]}),topRight:Object.assign(Object.assign({},r),{points:["br","tr"],offset:[0,-4]})}};function H3e(e,t){return e||$3e(t)}const W3e=e=>{const{optionHeight:t,optionFontSize:r,optionLineHeight:i,optionPadding:n}=e;return{position:"relative",display:"block",minHeight:t,padding:n,color:e.colorText,fontWeight:"normal",fontSize:r,lineHeight:i,boxSizing:"border-box"}},G3e=e=>{const{antCls:t,componentCls:r}=e,i=`${r}-item`,n=`&${t}-slide-up-enter${t}-slide-up-enter-active`,s=`&${t}-slide-up-appear${t}-slide-up-appear-active`,a=`&${t}-slide-up-leave${t}-slide-up-leave-active`,o=`${r}-dropdown-placement-`;return[{[`${r}-dropdown`]:Object.assign(Object.assign({},Vn(e)),{position:"absolute",top:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",padding:e.paddingXXS,overflow:"hidden",fontSize:e.fontSize,fontVariant:"initial",backgroundColor:e.colorBgElevated,borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary,[`
          ${n}${o}bottomLeft,
          ${s}${o}bottomLeft
        `]:{animationName:zF},[`
          ${n}${o}topLeft,
          ${s}${o}topLeft,
          ${n}${o}topRight,
          ${s}${o}topRight
        `]:{animationName:FF},[`${a}${o}bottomLeft`]:{animationName:BF},[`
          ${a}${o}topLeft,
          ${a}${o}topRight
        `]:{animationName:jF},"&-hidden":{display:"none"},[`${i}`]:Object.assign(Object.assign({},W3e(e)),{cursor:"pointer",transition:`background ${e.motionDurationSlow} ease`,borderRadius:e.borderRadiusSM,"&-group":{color:e.colorTextDescription,fontSize:e.fontSizeSM,cursor:"default"},"&-option":{display:"flex","&-content":Object.assign({flex:"auto"},XC),"&-state":{flex:"none",display:"flex",alignItems:"center"},[`&-active:not(${i}-option-disabled)`]:{backgroundColor:e.optionActiveBg},[`&-selected:not(${i}-option-disabled)`]:{color:e.optionSelectedColor,fontWeight:e.optionSelectedFontWeight,backgroundColor:e.optionSelectedBg,[`${i}-option-state`]:{color:e.colorPrimary},[`&:has(+ ${i}-option-selected:not(${i}-option-disabled))`]:{borderEndStartRadius:0,borderEndEndRadius:0,[`& + ${i}-option-selected:not(${i}-option-disabled)`]:{borderStartStartRadius:0,borderStartEndRadius:0}}},"&-disabled":{[`&${i}-option-selected`]:{backgroundColor:e.colorBgContainerDisabled},color:e.colorTextDisabled,cursor:"not-allowed"},"&-grouped":{paddingInlineStart:e.calc(e.controlPaddingHorizontal).mul(2).equal()}}}),"&-rtl":{direction:"rtl"}})},Hv(e,"slide-up"),Hv(e,"slide-down"),tA(e,"move-up"),tA(e,"move-down")]},q3e=G3e,Sm=2,X3e=e=>{const{multipleSelectItemHeight:t,selectHeight:r,lineWidth:i}=e;return e.calc(r).sub(t).div(2).sub(i).equal()};function DI(e,t){const{componentCls:r,iconCls:i}=e,n=`${r}-selection-overflow`,s=e.multipleSelectItemHeight,a=X3e(e),o=t?`${r}-${t}`:"";return{[`${r}-multiple${o}`]:{fontSize:e.fontSize,[n]:{position:"relative",display:"flex",flex:"auto",flexWrap:"wrap",maxWidth:"100%","&-item":{flex:"none",alignSelf:"center",maxWidth:"100%",display:"inline-flex"}},[`${r}-selector`]:{display:"flex",flexWrap:"wrap",alignItems:"center",height:"100%",paddingInline:e.calc(Sm).mul(2).equal(),paddingBlock:e.calc(a).sub(Sm).equal(),borderRadius:e.borderRadius,[`${r}-show-search&`]:{cursor:"text"},[`${r}-disabled&`]:{background:e.multipleSelectorBgDisabled,cursor:"not-allowed"},"&:after":{display:"inline-block",width:0,margin:`${lt(Sm)} 0`,lineHeight:lt(s),visibility:"hidden",content:'"\\a0"'}},[`
        &${r}-show-arrow ${r}-selector,
        &${r}-allow-clear ${r}-selector
      `]:{paddingInlineEnd:e.calc(e.fontSizeIcon).add(e.controlPaddingHorizontal).equal()},[`${r}-selection-item`]:{display:"flex",alignSelf:"center",flex:"none",boxSizing:"border-box",maxWidth:"100%",height:s,marginTop:Sm,marginBottom:Sm,lineHeight:lt(e.calc(s).sub(e.calc(e.lineWidth).mul(2)).equal()),background:e.multipleItemBg,border:`${lt(e.lineWidth)} ${e.lineType} ${e.multipleItemBorderColor}`,borderRadius:e.borderRadiusSM,cursor:"default",transition:`font-size ${e.motionDurationSlow}, line-height ${e.motionDurationSlow}, height ${e.motionDurationSlow}`,marginInlineEnd:e.calc(Sm).mul(2).equal(),paddingInlineStart:e.paddingXS,paddingInlineEnd:e.calc(e.paddingXS).div(2).equal(),[`${r}-disabled&`]:{color:e.multipleItemColorDisabled,borderColor:e.multipleItemBorderColorDisabled,cursor:"not-allowed"},"&-content":{display:"inline-block",marginInlineEnd:e.calc(e.paddingXS).div(2).equal(),overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis"},"&-remove":Object.assign(Object.assign({},nw()),{display:"inline-flex",alignItems:"center",color:e.colorIcon,fontWeight:"bold",fontSize:10,lineHeight:"inherit",cursor:"pointer",[`> ${i}`]:{verticalAlign:"-0.2em"},"&:hover":{color:e.colorIconHover}})},[`${n}-item + ${n}-item`]:{[`${r}-selection-search`]:{marginInlineStart:0}},[`${n}-item-suffix`]:{height:"100%"},[`${r}-selection-search`]:{display:"inline-flex",position:"relative",maxWidth:"100%",marginInlineStart:e.calc(e.inputPaddingHorizontalBase).sub(a).equal(),"\n          &-input,\n          &-mirror\n        ":{height:s,fontFamily:e.fontFamily,lineHeight:lt(s),transition:`all ${e.motionDurationSlow}`},"&-input":{width:"100%",minWidth:4.1},"&-mirror":{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:"auto",zIndex:999,whiteSpace:"pre",visibility:"hidden"}},[`${r}-selection-placeholder`]:{position:"absolute",top:"50%",insetInlineStart:e.inputPaddingHorizontalBase,insetInlineEnd:e.inputPaddingHorizontalBase,transform:"translateY(-50%)",transition:`all ${e.motionDurationSlow}`}}}}const Y3e=e=>{const{componentCls:t}=e,r=zr(e,{selectHeight:e.controlHeightSM,multipleSelectItemHeight:e.controlHeightXS,borderRadius:e.borderRadiusSM,borderRadiusSM:e.borderRadiusXS}),i=zr(e,{fontSize:e.fontSizeLG,selectHeight:e.controlHeightLG,multipleSelectItemHeight:e.multipleItemHeightLG,borderRadius:e.borderRadiusLG,borderRadiusSM:e.borderRadius});return[DI(e),DI(r,"sm"),{[`${t}-multiple${t}-sm`]:{[`${t}-selection-placeholder`]:{insetInline:e.calc(e.controlPaddingHorizontalSM).sub(e.lineWidth).equal()},[`${t}-selection-search`]:{marginInlineStart:2}}},DI(i,"lg")]},K3e=Y3e;function OI(e,t){const{componentCls:r,inputPaddingHorizontalBase:i,borderRadius:n}=e,s=e.calc(e.controlHeight).sub(e.calc(e.lineWidth).mul(2)).equal(),a=t?`${r}-${t}`:"";return{[`${r}-single${a}`]:{fontSize:e.fontSize,height:e.controlHeight,[`${r}-selector`]:Object.assign(Object.assign({},Vn(e,!0)),{display:"flex",borderRadius:n,[`${r}-selection-search`]:{position:"absolute",top:0,insetInlineStart:i,insetInlineEnd:i,bottom:0,"&-input":{width:"100%",WebkitAppearance:"textfield"}},[`
          ${r}-selection-item,
          ${r}-selection-placeholder
        `]:{padding:0,lineHeight:lt(s),transition:`all ${e.motionDurationSlow}, visibility 0s`,alignSelf:"center"},[`${r}-selection-placeholder`]:{transition:"none",pointerEvents:"none"},[["&:after",`${r}-selection-item:empty:after`,`${r}-selection-placeholder:empty:after`].join(",")]:{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'}}),[`
        &${r}-show-arrow ${r}-selection-item,
        &${r}-show-arrow ${r}-selection-placeholder
      `]:{paddingInlineEnd:e.showArrowPaddingInlineEnd},[`&${r}-open ${r}-selection-item`]:{color:e.colorTextPlaceholder},[`&:not(${r}-customize-input)`]:{[`${r}-selector`]:{width:"100%",height:"100%",padding:`0 ${lt(i)}`,[`${r}-selection-search-input`]:{height:s},"&:after":{lineHeight:lt(s)}}},[`&${r}-customize-input`]:{[`${r}-selector`]:{"&:after":{display:"none"},[`${r}-selection-search`]:{position:"static",width:"100%"},[`${r}-selection-placeholder`]:{position:"absolute",insetInlineStart:0,insetInlineEnd:0,padding:`0 ${lt(i)}`,"&:after":{display:"none"}}}}}}}function Q3e(e){const{componentCls:t}=e,r=e.calc(e.controlPaddingHorizontalSM).sub(e.lineWidth).equal();return[OI(e),OI(zr(e,{controlHeight:e.controlHeightSM,borderRadius:e.borderRadiusSM}),"sm"),{[`${t}-single${t}-sm`]:{[`&:not(${t}-customize-input)`]:{[`${t}-selection-search`]:{insetInlineStart:r,insetInlineEnd:r},[`${t}-selector`]:{padding:`0 ${lt(r)}`},[`&${t}-show-arrow ${t}-selection-search`]:{insetInlineEnd:e.calc(r).add(e.calc(e.fontSize).mul(1.5)).equal()},[`
            &${t}-show-arrow ${t}-selection-item,
            &${t}-show-arrow ${t}-selection-placeholder
          `]:{paddingInlineEnd:e.calc(e.fontSize).mul(1.5).equal()}}}},OI(zr(e,{controlHeight:e.singleItemHeightLG,fontSize:e.fontSizeLG,borderRadius:e.borderRadiusLG}),"lg")]}const Z3e=e=>{const{componentCls:t,selectorBg:r}=e;return{position:"relative",backgroundColor:r,border:`${lt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,input:{cursor:"pointer"},[`${t}-show-search&`]:{cursor:"text",input:{cursor:"auto",color:"inherit",height:"100%"}},[`${t}-disabled&`]:{color:e.colorTextDisabled,background:e.colorBgContainerDisabled,cursor:"not-allowed",[`${t}-multiple&`]:{background:e.multipleSelectorBgDisabled},input:{cursor:"not-allowed"}}}},LI=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{componentCls:i,borderHoverColor:n,antCls:s,borderActiveColor:a,outlineColor:o,controlOutlineWidth:l}=t,c=r?{[`${i}-selector`]:{borderColor:a}}:{};return{[e]:{[`&:not(${i}-disabled):not(${i}-customize-input):not(${s}-pagination-size-changer)`]:Object.assign(Object.assign({},c),{[`&:hover ${i}-selector`]:{borderColor:n},[`${i}-focused& ${i}-selector`]:{borderColor:a,boxShadow:`0 0 0 ${lt(l)} ${o}`,outline:0}})}}},J3e=e=>{const{componentCls:t}=e;return{[`${t}-selection-search-input`]:{margin:0,padding:0,background:"transparent",border:"none",outline:"none",appearance:"none",fontFamily:"inherit","&::-webkit-search-cancel-button":{display:"none","-webkit-appearance":"none"}}}},eLe=e=>{const{antCls:t,componentCls:r,inputPaddingHorizontalBase:i,iconCls:n}=e;return{[r]:Object.assign(Object.assign({},Vn(e)),{position:"relative",display:"inline-block",cursor:"pointer",[`&:not(${r}-customize-input) ${r}-selector`]:Object.assign(Object.assign({},Z3e(e)),J3e(e)),[`${r}-selection-item`]:Object.assign(Object.assign({flex:1,fontWeight:"normal",position:"relative",userSelect:"none"},XC),{[`> ${t}-typography`]:{display:"inline"}}),[`${r}-selection-placeholder`]:Object.assign(Object.assign({},XC),{flex:1,color:e.colorTextPlaceholder,pointerEvents:"none"}),[`${r}-arrow`]:Object.assign(Object.assign({},nw()),{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,height:e.fontSizeIcon,marginTop:e.calc(e.fontSizeIcon).mul(-1).div(2).equal(),color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,lineHeight:1,textAlign:"center",pointerEvents:"none",display:"flex",alignItems:"center",[n]:{verticalAlign:"top",transition:`transform ${e.motionDurationSlow}`,"> svg":{verticalAlign:"top"},[`&:not(${r}-suffix)`]:{pointerEvents:"auto"}},[`${r}-disabled &`]:{cursor:"not-allowed"},"> *:not(:last-child)":{marginInlineEnd:8}}),[`${r}-clear`]:{position:"absolute",top:"50%",insetInlineStart:"auto",insetInlineEnd:i,zIndex:1,display:"inline-block",width:e.fontSizeIcon,height:e.fontSizeIcon,marginTop:e.calc(e.fontSizeIcon).mul(-1).div(2).equal(),color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,fontStyle:"normal",lineHeight:1,textAlign:"center",textTransform:"none",background:e.clearBg,cursor:"pointer",opacity:0,transition:`color ${e.motionDurationMid} ease, opacity ${e.motionDurationSlow} ease`,textRendering:"auto","&:before":{display:"block"},"&:hover":{color:e.colorTextTertiary}},"&:hover":{[`${r}-clear`]:{opacity:1}}}),[`${r}-has-feedback`]:{[`${r}-clear`]:{insetInlineEnd:e.calc(i).add(e.fontSize).add(e.paddingXS).equal()}}}},tLe=e=>{const{componentCls:t}=e;return[{[t]:{[`&-borderless ${t}-selector`]:{backgroundColor:"transparent !important",borderColor:"transparent !important",boxShadow:"none !important"},[`&${t}-in-form-item`]:{width:"100%"}}},eLe(e),Q3e(e),K3e(e),q3e(e),{[`${t}-rtl`]:{direction:"rtl"}},LI(t,zr(e,{borderHoverColor:e.colorPrimaryHover,borderActiveColor:e.colorPrimary,outlineColor:e.controlOutline})),LI(`${t}-status-error`,zr(e,{borderHoverColor:e.colorErrorHover,borderActiveColor:e.colorError,outlineColor:e.colorErrorOutline}),!0),LI(`${t}-status-warning`,zr(e,{borderHoverColor:e.colorWarningHover,borderActiveColor:e.colorWarning,outlineColor:e.colorWarningOutline}),!0),gM(e,{borderElCls:`${t}-selector`,focusElCls:`${t}-focused`})]},rLe=e=>{const{fontSize:t,lineHeight:r,controlHeight:i,controlPaddingHorizontal:n,zIndexPopupBase:s,colorText:a,fontWeightStrong:o,controlItemBgActive:l,controlItemBgHover:c,colorBgContainer:d,colorFillSecondary:u,controlHeightLG:h,controlHeightSM:f,colorBgContainerDisabled:p,colorTextDisabled:m}=e;return{zIndexPopup:s+50,optionSelectedColor:a,optionSelectedFontWeight:o,optionSelectedBg:l,optionActiveBg:c,optionPadding:`${(i-t*r)/2}px ${n}px`,optionFontSize:t,optionLineHeight:r,optionHeight:i,selectorBg:d,clearBg:d,singleItemHeightLG:h,multipleItemBg:u,multipleItemBorderColor:"transparent",multipleItemHeight:f,multipleItemHeightLG:i,multipleSelectorBgDisabled:p,multipleItemColorDisabled:m,multipleItemBorderColorDisabled:"transparent",showArrowPaddingInlineEnd:Math.ceil(e.fontSize*1.25)}},iLe=sa("Select",(e,t)=>{let{rootPrefixCls:r}=t;const i=zr(e,{rootPrefixCls:r,inputPaddingHorizontalBase:e.calc(e.paddingSM).sub(1).equal(),multipleSelectItemHeight:e.multipleItemHeight,selectHeight:e.controlHeight});return[tLe(i)]},rLe,{unitless:{optionLineHeight:!0,optionSelectedFontWeight:!0}});var nLe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"};const sLe=nLe;var aLe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:sLe}))};const oLe=_.forwardRef(aLe);var lLe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"};const cLe=lLe;var uLe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:cLe}))};const Jre=_.forwardRef(uLe);var dLe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"};const hLe=dLe;var fLe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:hLe}))};const eie=_.forwardRef(fLe);function pLe(e){let{suffixIcon:t,clearIcon:r,menuItemSelectedIcon:i,removeIcon:n,loading:s,multiple:a,hasFeedback:o,prefixCls:l,showSuffixIcon:c,feedbackIcon:d,showArrow:u,componentName:h}=e;const f=r??_.createElement(sw,null),p=y=>t===null&&!o&&!u?null:_.createElement(_.Fragment,null,c!==!1&&y,o&&d);let m=null;if(t!==void 0)m=p(t);else if(s)m=p(_.createElement(dM,{spin:!0}));else{const y=`${l}-suffix`;m=b=>{let{open:x,showSearch:S}=b;return p(x&&S?_.createElement(eie,{className:y}):_.createElement(Jre,{className:y}))}}let g=null;i!==void 0?g=i:a?g=_.createElement(oLe,null):g=null;let v=null;return n!==void 0?v=n:v=_.createElement(Jte,null),{clearIcon:f,suffixIcon:m,itemIcon:g,removeIcon:v}}function mLe(e,t){return t!==void 0?t:e!==null}var gLe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const tie="SECRET_COMBOBOX_MODE_DO_NOT_USE",vLe=(e,t)=>{var r,i,{prefixCls:n,bordered:s=!0,className:a,rootClassName:o,getPopupContainer:l,popupClassName:c,dropdownClassName:d,listHeight:u=256,placement:h,listItemHeight:f,size:p,disabled:m,notFoundContent:g,status:v,builtinPlacements:y,dropdownMatchSelectWidth:b,popupMatchSelectWidth:x,direction:S,style:w,allowClear:E}=e,C=gLe(e,["prefixCls","bordered","className","rootClassName","getPopupContainer","popupClassName","dropdownClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","builtinPlacements","dropdownMatchSelectWidth","popupMatchSelectWidth","direction","style","allowClear"]);const{getPopupContainer:T,getPrefixCls:A,renderEmpty:M,direction:P,virtual:I,popupMatchSelectWidth:R,popupOverflow:N,select:k}=_.useContext(br),[,O]=ia(),D=f??(O==null?void 0:O.controlHeight),B=A("select",n),z=A(),F=S??P,{compactSize:V,compactItemClassnames:Y}=T0(B,F),W=Mo(B),[X,H,ie]=iLe(B,W),Q=_.useMemo(()=>{const{mode:Me}=C;if(Me!=="combobox")return Me===tie?"combobox":Me},[C.mode]),Z=Q==="multiple"||Q==="tags",ee=mLe(C.suffixIcon,C.showArrow),re=(r=x??b)!==null&&r!==void 0?r:R,{status:ne,hasFeedback:se,isFormItemInput:fe,feedbackIcon:me}=_.useContext(_o),Oe=xM(ne,v);let Ee;g!==void 0?Ee=g:Q==="combobox"?Ee=null:Ee=(M==null?void 0:M("Select"))||_.createElement(U3e,{componentName:"Select"});const{suffixIcon:Se,itemIcon:de,removeIcon:be,clearIcon:ye}=pLe(Object.assign(Object.assign({},C),{multiple:Z,hasFeedback:se,feedbackIcon:me,showSuffixIcon:ee,prefixCls:B,showArrow:C.showArrow,componentName:"Select"})),q=E===!0?{clearIcon:ye}:E,U=Pa(C,["suffixIcon","itemIcon"]),ce=Fe(c||d,{[`${B}-dropdown-${F}`]:F==="rtl"},o,ie,W,H),xe=ef(Me=>{var Ue;return(Ue=p??V)!==null&&Ue!==void 0?Ue:Me}),j=_.useContext(Jh),Be=m??j,ze=Fe({[`${B}-lg`]:xe==="large",[`${B}-sm`]:xe==="small",[`${B}-rtl`]:F==="rtl",[`${B}-borderless`]:!s,[`${B}-in-form-item`]:fe},qu(B,Oe,se),Y,k==null?void 0:k.className,a,o,ie,W,H),Ve=_.useMemo(()=>h!==void 0?h:F==="rtl"?"bottomRight":"bottomLeft",[h,F]),[pe]=hM("SelectLike",(i=C.dropdownStyle)===null||i===void 0?void 0:i.zIndex);return X(_.createElement(qF,Object.assign({ref:t,virtual:I,showSearch:k==null?void 0:k.showSearch},U,{style:Object.assign(Object.assign({},k==null?void 0:k.style),w),dropdownMatchSelectWidth:re,builtinPlacements:H3e(y,N),transitionName:TF(z,"slide-up",C.transitionName),listHeight:u,listItemHeight:D,mode:Q,prefixCls:B,placement:Ve,direction:F,suffixIcon:Se,menuItemSelectedIcon:de,removeIcon:be,allowClear:q,notFoundContent:Ee,className:ze,getPopupContainer:l||T,dropdownClassName:ce,disabled:Be,dropdownStyle:Object.assign(Object.assign({},C==null?void 0:C.dropdownStyle),{zIndex:pe})})))},P0=_.forwardRef(vLe),yLe=Lre(P0);P0.SECRET_COMBOBOX_MODE_DO_NOT_USE=tie;P0.Option=GF;P0.OptGroup=WF;P0._InternalPanelDoNotUseOrYouWillBeFired=yLe;const b_=P0,ex=["xxl","xl","lg","md","sm","xs"],bLe=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`}),xLe=e=>{const t=e,r=[].concat(ex).reverse();return r.forEach((i,n)=>{const s=i.toUpperCase(),a=`screen${s}Min`,o=`screen${s}`;if(!(t[a]<=t[o]))throw new Error(`${a}<=${o} fails : !(${t[a]}<=${t[o]})`);if(n<r.length-1){const l=`screen${s}Max`;if(!(t[o]<=t[l]))throw new Error(`${o}<=${l} fails : !(${t[o]}<=${t[l]})`);const d=`screen${r[n+1].toUpperCase()}Min`;if(!(t[l]<=t[d]))throw new Error(`${l}<=${d} fails : !(${t[l]}<=${t[d]})`)}}),e};function wLe(){const[,e]=ia(),t=bLe(xLe(e));return Ge.useMemo(()=>{const r=new Map;let i=-1,n={};return{matchHandlers:{},dispatch(s){return n=s,r.forEach(a=>a(n)),r.size>=1},subscribe(s){return r.size||this.register(),i+=1,r.set(i,s),s(n),i},unsubscribe(s){r.delete(s),r.size||this.unregister()},unregister(){Object.keys(t).forEach(s=>{const a=t[s],o=this.matchHandlers[a];o==null||o.mql.removeListener(o==null?void 0:o.listener)}),r.clear()},register(){Object.keys(t).forEach(s=>{const a=t[s],o=c=>{let{matches:d}=c;this.dispatch(Object.assign(Object.assign({},n),{[s]:d}))},l=window.matchMedia(a);l.addListener(o),this.matchHandlers[a]={mql:l,listener:o},o(l)})},responsiveMap:t}},[e])}const iA=e=>e?typeof e=="function"?e():e:null;function YF(e){var t=e.children,r=e.prefixCls,i=e.id,n=e.overlayInnerStyle,s=e.className,a=e.style;return _.createElement("div",{className:Fe("".concat(r,"-content"),s),style:a},_.createElement("div",{className:"".concat(r,"-inner"),id:i,role:"tooltip",style:n},typeof t=="function"?t():t))}var Em={shiftX:64,adjustY:1},Cm={adjustX:1,shiftY:!0},Do=[0,0],_Le={left:{points:["cr","cl"],overflow:Cm,offset:[-4,0],targetOffset:Do},right:{points:["cl","cr"],overflow:Cm,offset:[4,0],targetOffset:Do},top:{points:["bc","tc"],overflow:Em,offset:[0,-4],targetOffset:Do},bottom:{points:["tc","bc"],overflow:Em,offset:[0,4],targetOffset:Do},topLeft:{points:["bl","tl"],overflow:Em,offset:[0,-4],targetOffset:Do},leftTop:{points:["tr","tl"],overflow:Cm,offset:[-4,0],targetOffset:Do},topRight:{points:["br","tr"],overflow:Em,offset:[0,-4],targetOffset:Do},rightTop:{points:["tl","tr"],overflow:Cm,offset:[4,0],targetOffset:Do},bottomRight:{points:["tr","br"],overflow:Em,offset:[0,4],targetOffset:Do},rightBottom:{points:["bl","br"],overflow:Cm,offset:[4,0],targetOffset:Do},bottomLeft:{points:["tl","bl"],overflow:Em,offset:[0,4],targetOffset:Do},leftBottom:{points:["br","bl"],overflow:Cm,offset:[-4,0],targetOffset:Do}},SLe=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],ELe=function(t,r){var i=t.overlayClassName,n=t.trigger,s=n===void 0?["hover"]:n,a=t.mouseEnterDelay,o=a===void 0?0:a,l=t.mouseLeaveDelay,c=l===void 0?.1:l,d=t.overlayStyle,u=t.prefixCls,h=u===void 0?"rc-tooltip":u,f=t.children,p=t.onVisibleChange,m=t.afterVisibleChange,g=t.transitionName,v=t.animation,y=t.motion,b=t.placement,x=b===void 0?"right":b,S=t.align,w=S===void 0?{}:S,E=t.destroyTooltipOnHide,C=E===void 0?!1:E,T=t.defaultVisible,A=t.getTooltipContainer,M=t.overlayInnerStyle;t.arrowContent;var P=t.overlay,I=t.id,R=t.showArrow,N=R===void 0?!0:R,k=hr(t,SLe),O=_.useRef(null);_.useImperativeHandle(r,function(){return O.current});var D=_e({},k);"visible"in t&&(D.popupVisible=t.visible);var B=function(){return _.createElement(YF,{key:"content",prefixCls:h,id:I,overlayInnerStyle:M},P)};return _.createElement(bM,ae({popupClassName:i,prefixCls:h,popup:B,action:s,builtinPlacements:_Le,popupPlacement:x,ref:O,popupAlign:w,getPopupContainer:A,onPopupVisibleChange:p,afterPopupVisibleChange:m,popupTransitionName:g,popupAnimation:v,popupMotion:y,defaultPopupVisible:T,autoDestroy:C,mouseLeaveDelay:c,popupStyle:d,mouseEnterDelay:o,arrow:N},D),f)};const CLe=_.forwardRef(ELe);function KF(e){const{sizePopupArrow:t,borderRadiusXS:r,borderRadiusOuter:i}=e,n=t/2,s=0,a=n,o=i*1/Math.sqrt(2),l=n-i*(1-1/Math.sqrt(2)),c=n-r*(1/Math.sqrt(2)),d=i*(Math.sqrt(2)-1)+r*(1/Math.sqrt(2)),u=2*n-c,h=d,f=2*n-o,p=l,m=2*n-s,g=a,v=n*Math.sqrt(2)+i*(Math.sqrt(2)-2),y=i*(Math.sqrt(2)-1),b=`polygon(${y}px 100%, 50% ${y}px, ${2*n-y}px 100%, ${y}px 100%)`,x=`path('M ${s} ${a} A ${i} ${i} 0 0 0 ${o} ${l} L ${c} ${d} A ${r} ${r} 0 0 1 ${u} ${h} L ${f} ${p} A ${i} ${i} 0 0 0 ${m} ${g} Z')`;return{arrowShadowWidth:v,arrowPath:x,arrowPolygon:b}}const ALe=(e,t,r)=>{const{sizePopupArrow:i,arrowPolygon:n,arrowPath:s,arrowShadowWidth:a,borderRadiusXS:o,calc:l}=e;return{pointerEvents:"none",width:i,height:i,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:i,height:l(i).div(2).equal(),background:t,clipPath:{_multi_value_:!0,value:[n,s]},content:'""'},"&::after":{content:'""',position:"absolute",width:a,height:a,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${lt(o)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:r,zIndex:0,background:"transparent"}}},rie=8;function wM(e){const{contentRadius:t,limitVerticalRadius:r}=e,i=t>12?t+2:12;return{arrowOffsetHorizontal:i,arrowOffsetVertical:r?rie:i}}function x_(e,t){return e?t:{}}function QF(e,t,r){const{componentCls:i,boxShadowPopoverArrow:n,arrowOffsetVertical:s,arrowOffsetHorizontal:a}=e,{arrowDistance:o=0,arrowPlacement:l={left:!0,right:!0,top:!0,bottom:!0}}=r||{};return{[i]:Object.assign(Object.assign(Object.assign(Object.assign({[`${i}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},ALe(e,t,n)),{"&:before":{background:t}})]},x_(!!l.top,{[[`&-placement-top > ${i}-arrow`,`&-placement-topLeft > ${i}-arrow`,`&-placement-topRight > ${i}-arrow`].join(",")]:{bottom:o,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft > ${i}-arrow`]:{left:{_skip_check_:!0,value:a}},[`&-placement-topRight > ${i}-arrow`]:{right:{_skip_check_:!0,value:a}}})),x_(!!l.bottom,{[[`&-placement-bottom > ${i}-arrow`,`&-placement-bottomLeft > ${i}-arrow`,`&-placement-bottomRight > ${i}-arrow`].join(",")]:{top:o,transform:"translateY(-100%)"},[`&-placement-bottom > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft > ${i}-arrow`]:{left:{_skip_check_:!0,value:a}},[`&-placement-bottomRight > ${i}-arrow`]:{right:{_skip_check_:!0,value:a}}})),x_(!!l.left,{[[`&-placement-left > ${i}-arrow`,`&-placement-leftTop > ${i}-arrow`,`&-placement-leftBottom > ${i}-arrow`].join(",")]:{right:{_skip_check_:!0,value:o},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${i}-arrow`]:{top:s},[`&-placement-leftBottom > ${i}-arrow`]:{bottom:s}})),x_(!!l.right,{[[`&-placement-right > ${i}-arrow`,`&-placement-rightTop > ${i}-arrow`,`&-placement-rightBottom > ${i}-arrow`].join(",")]:{left:{_skip_check_:!0,value:o},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${i}-arrow`]:{top:s},[`&-placement-rightBottom > ${i}-arrow`]:{bottom:s}}))}}function TLe(e,t,r,i){if(i===!1)return{adjustX:!1,adjustY:!1};const n=i&&typeof i=="object"?i:{},s={};switch(e){case"top":case"bottom":s.shiftX=t.arrowOffsetHorizontal*2+r,s.shiftY=!0,s.adjustY=!0;break;case"left":case"right":s.shiftY=t.arrowOffsetVertical*2+r,s.shiftX=!0,s.adjustX=!0;break}const a=Object.assign(Object.assign({},s),n);return a.shiftX||(a.adjustX=!0),a.shiftY||(a.adjustY=!0),a}const pH={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},MLe={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},PLe=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function iie(e){const{arrowWidth:t,autoAdjustOverflow:r,arrowPointAtCenter:i,offset:n,borderRadius:s,visibleFirst:a}=e,o=t/2,l={};return Object.keys(pH).forEach(c=>{const d=i&&MLe[c]||pH[c],u=Object.assign(Object.assign({},d),{offset:[0,0],dynamicInset:!0});switch(l[c]=u,PLe.has(c)&&(u.autoArrow=!1),c){case"top":case"topLeft":case"topRight":u.offset[1]=-o-n;break;case"bottom":case"bottomLeft":case"bottomRight":u.offset[1]=o+n;break;case"left":case"leftTop":case"leftBottom":u.offset[0]=-o-n;break;case"right":case"rightTop":case"rightBottom":u.offset[0]=o+n;break}const h=wM({contentRadius:s,limitVerticalRadius:!0});if(i)switch(c){case"topLeft":case"bottomLeft":u.offset[0]=-h.arrowOffsetHorizontal-o;break;case"topRight":case"bottomRight":u.offset[0]=h.arrowOffsetHorizontal+o;break;case"leftTop":case"rightTop":u.offset[1]=-h.arrowOffsetHorizontal-o;break;case"leftBottom":case"rightBottom":u.offset[1]=h.arrowOffsetHorizontal+o;break}u.overflow=TLe(c,h,t,r),a&&(u.htmlRegion="visibleFirst")}),l}const ILe=e=>{const{componentCls:t,tooltipMaxWidth:r,tooltipColor:i,tooltipBg:n,tooltipBorderRadius:s,zIndexPopup:a,controlHeight:o,boxShadowSecondary:l,paddingSM:c,paddingXS:d}=e;return[{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},Vn(e)),{position:"absolute",zIndex:a,display:"block",width:"max-content",maxWidth:r,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":n,[`${t}-inner`]:{minWidth:o,minHeight:o,padding:`${lt(e.calc(c).div(2).equal())} ${lt(d)}`,color:i,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:n,borderRadius:s,boxShadow:l,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${t}-inner`]:{borderRadius:e.min(s,rie)}},[`${t}-content`]:{position:"relative"}}),wMe(e,(u,h)=>{let{darkColor:f}=h;return{[`&${t}-${u}`]:{[`${t}-inner`]:{backgroundColor:f},[`${t}-arrow`]:{"--antd-arrow-background-color":f}}}})),{"&-rtl":{direction:"rtl"}})},QF(e,"var(--antd-arrow-background-color)"),{[`${t}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},RLe=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+70},wM({contentRadius:e.borderRadius,limitVerticalRadius:!0})),KF(zr(e,{borderRadiusOuter:Math.min(e.borderRadiusOuter,4)}))),nie=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return sa("Tooltip",i=>{const{borderRadius:n,colorTextLightSolid:s,colorBgSpotlight:a}=i,o=zr(i,{tooltipMaxWidth:250,tooltipColor:s,tooltipBorderRadius:n,tooltipBg:a});return[ILe(o),vM(i,"zoom-big-fast")]},RLe,{resetStyle:!1,injectStyle:t})(e)},DLe=Yb.map(e=>`${e}-inverse`);function OLe(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(ft(DLe),ft(Yb)).includes(e):Yb.includes(e)}function sie(e,t){const r=OLe(t),i=Fe({[`${e}-${t}`]:t&&r}),n={},s={};return t&&!r&&(n.background=t,s["--antd-arrow-background-color"]=t),{className:i,overlayStyle:n,arrowStyle:s}}const LLe=e=>{const{prefixCls:t,className:r,placement:i="top",title:n,color:s,overlayInnerStyle:a}=e,{getPrefixCls:o}=_.useContext(br),l=o("tooltip",t),[c,d,u]=nie(l),h=sie(l,s),f=h.arrowStyle,p=Object.assign(Object.assign({},a),h.overlayStyle),m=Fe(d,u,l,`${l}-pure`,`${l}-placement-${i}`,r,h.className);return c(_.createElement("div",{className:m,style:f},_.createElement("div",{className:`${l}-arrow`}),_.createElement(YF,Object.assign({},e,{className:d,prefixCls:l,overlayInnerStyle:p}),n)))},NLe=LLe;var kLe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const aie=_.forwardRef((e,t)=>{var r,i;const{prefixCls:n,openClassName:s,getTooltipContainer:a,overlayClassName:o,color:l,overlayInnerStyle:c,children:d,afterOpenChange:u,afterVisibleChange:h,destroyTooltipOnHide:f,arrow:p=!0,title:m,overlay:g,builtinPlacements:v,arrowPointAtCenter:y=!1,autoAdjustOverflow:b=!0}=e,x=!!p,[,S]=ia(),{getPopupContainer:w,getPrefixCls:E,direction:C}=_.useContext(br),T=rw(),A=_.useRef(null),M=()=>{var U;(U=A.current)===null||U===void 0||U.forceAlign()};_.useImperativeHandle(t,()=>({forceAlign:M,forcePopupAlign:()=>{T.deprecated(!1,"forcePopupAlign","forceAlign"),M()}}));const[P,I]=Ka(!1,{value:(r=e.open)!==null&&r!==void 0?r:e.visible,defaultValue:(i=e.defaultOpen)!==null&&i!==void 0?i:e.defaultVisible}),R=!m&&!g&&m!==0,N=U=>{var ce,xe;I(R?!1:U),R||((ce=e.onOpenChange)===null||ce===void 0||ce.call(e,U),(xe=e.onVisibleChange)===null||xe===void 0||xe.call(e,U))},k=_.useMemo(()=>{var U,ce;let xe=y;return typeof p=="object"&&(xe=(ce=(U=p.pointAtCenter)!==null&&U!==void 0?U:p.arrowPointAtCenter)!==null&&ce!==void 0?ce:y),v||iie({arrowPointAtCenter:xe,autoAdjustOverflow:b,arrowWidth:x?S.sizePopupArrow:0,borderRadius:S.borderRadius,offset:S.marginXXS,visibleFirst:!0})},[y,p,v,S]),O=_.useMemo(()=>m===0?m:g||m||"",[g,m]),D=_.createElement($v,null,typeof O=="function"?O():O),{getPopupContainer:B,placement:z="top",mouseEnterDelay:F=.1,mouseLeaveDelay:V=.1,overlayStyle:Y,rootClassName:W}=e,X=kLe(e,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),H=E("tooltip",n),ie=E(),Q=e["data-popover-inject"];let Z=P;!("open"in e)&&!("visible"in e)&&R&&(Z=!1);const ee=Gl(d)&&!tre(d)?d:_.createElement("span",null,d),re=ee.props,ne=!re.className||typeof re.className=="string"?Fe(re.className,s||`${H}-open`):re.className,[se,fe,me]=nie(H,!Q),Oe=sie(H,l),Ee=Oe.arrowStyle,Se=Object.assign(Object.assign({},c),Oe.overlayStyle),de=Fe(o,{[`${H}-rtl`]:C==="rtl"},Oe.className,W,fe,me),[be,ye]=hM("Tooltip",X.zIndex),q=_.createElement(CLe,Object.assign({},X,{zIndex:be,showArrow:x,placement:z,mouseEnterDelay:F,mouseLeaveDelay:V,prefixCls:H,overlayClassName:de,overlayStyle:Object.assign(Object.assign({},Ee),Y),getTooltipContainer:B||a||w,ref:A,builtinPlacements:k,overlay:D,visible:Z,onVisibleChange:N,afterVisibleChange:u??h,overlayInnerStyle:Se,arrowContent:_.createElement("span",{className:`${H}-arrow-content`}),motion:{motionName:TF(ie,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!f}),Z?nl(ee,{className:ne}):ee);return se(_.createElement(AF.Provider,{value:ye},q))});aie._InternalPanelDoNotUseOrYouWillBeFired=NLe;const ZF=aie,zLe=e=>{const{componentCls:t,popoverColor:r,titleMinWidth:i,fontWeightStrong:n,innerPadding:s,boxShadowSecondary:a,colorTextHeading:o,borderRadiusLG:l,zIndexPopup:c,titleMarginBottom:d,colorBgElevated:u,popoverBg:h,titleBorderBottom:f,innerContentPadding:p,titlePadding:m}=e;return[{[t]:Object.assign(Object.assign({},Vn(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:c,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","--antd-arrow-background-color":u,"&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${t}-content`]:{position:"relative"},[`${t}-inner`]:{backgroundColor:h,backgroundClip:"padding-box",borderRadius:l,boxShadow:a,padding:s},[`${t}-title`]:{minWidth:i,marginBottom:d,color:o,fontWeight:n,borderBottom:f,padding:m},[`${t}-inner-content`]:{color:r,padding:p}})},QF(e,"var(--antd-arrow-background-color)"),{[`${t}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",[`${t}-content`]:{display:"inline-block"}}}]},BLe=e=>{const{componentCls:t}=e;return{[t]:Yb.map(r=>{const i=e[`${r}6`];return{[`&${t}-${r}`]:{"--antd-arrow-background-color":i,[`${t}-inner`]:{backgroundColor:i},[`${t}-arrow`]:{background:"transparent"}}}})}},FLe=e=>{const{lineWidth:t,controlHeight:r,fontHeight:i,padding:n,wireframe:s,zIndexPopupBase:a,borderRadiusLG:o,marginXS:l,lineType:c,colorSplit:d,paddingSM:u}=e,h=r-i,f=h/2,p=h/2-t,m=n;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:a+30},KF(e)),wM({contentRadius:o,limitVerticalRadius:!0})),{innerPadding:s?0:12,titleMarginBottom:s?0:l,titlePadding:s?`${f}px ${m}px ${p}px`:0,titleBorderBottom:s?`${t}px ${c} ${d}`:"none",innerContentPadding:s?`${u}px ${m}px`:0})},oie=sa("Popover",e=>{const{colorBgElevated:t,colorText:r}=e,i=zr(e,{popoverBg:t,popoverColor:r});return[zLe(i),BLe(i),vM(i,"zoom-big")]},FLe,{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var jLe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const VLe=(e,t,r)=>!t&&!r?null:_.createElement(_.Fragment,null,t&&_.createElement("div",{className:`${e}-title`},iA(t)),_.createElement("div",{className:`${e}-inner-content`},iA(r))),ULe=e=>{const{hashId:t,prefixCls:r,className:i,style:n,placement:s="top",title:a,content:o,children:l}=e;return _.createElement("div",{className:Fe(t,r,`${r}-pure`,`${r}-placement-${s}`,i),style:n},_.createElement("div",{className:`${r}-arrow`}),_.createElement(YF,Object.assign({},e,{className:t,prefixCls:r}),l||VLe(r,a,o)))},$Le=e=>{const{prefixCls:t,className:r}=e,i=jLe(e,["prefixCls","className"]),{getPrefixCls:n}=_.useContext(br),s=n("popover",t),[a,o,l]=oie(s);return a(_.createElement(ULe,Object.assign({},i,{prefixCls:s,hashId:o,className:Fe(r,l)})))},HLe=$Le;var WLe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const GLe=e=>{let{title:t,content:r,prefixCls:i}=e;return _.createElement(_.Fragment,null,t&&_.createElement("div",{className:`${i}-title`},iA(t)),_.createElement("div",{className:`${i}-inner-content`},iA(r)))},lie=_.forwardRef((e,t)=>{const{prefixCls:r,title:i,content:n,overlayClassName:s,placement:a="top",trigger:o="hover",mouseEnterDelay:l=.1,mouseLeaveDelay:c=.1,overlayStyle:d={}}=e,u=WLe(e,["prefixCls","title","content","overlayClassName","placement","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle"]),{getPrefixCls:h}=_.useContext(br),f=h("popover",r),[p,m,g]=oie(f),v=h(),y=Fe(s,m,g);return p(_.createElement(ZF,Object.assign({placement:a,trigger:o,mouseEnterDelay:l,mouseLeaveDelay:c,overlayStyle:d},u,{prefixCls:f,overlayClassName:y,ref:t,overlay:i||n?_.createElement(GLe,{prefixCls:f,title:i,content:n}):null,transitionName:TF(v,"zoom-big",u.transitionName),"data-popover-inject":!0})))});lie._InternalPanelDoNotUseOrYouWillBeFired=HLe;const qLe=lie;var XLe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"};const YLe=XLe;var KLe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:YLe}))};const QLe=_.forwardRef(KLe);var ZLe=rt.ESC,JLe=rt.TAB;function eNe(e){var t=e.visible,r=e.triggerRef,i=e.onVisibleChange,n=e.autoFocus,s=e.overlayRef,a=_.useRef(!1),o=function(){if(t){var u,h;(u=r.current)===null||u===void 0||(h=u.focus)===null||h===void 0||h.call(u),i==null||i(!1)}},l=function(){var u;return(u=s.current)!==null&&u!==void 0&&u.focus?(s.current.focus(),a.current=!0,!0):!1},c=function(u){switch(u.keyCode){case ZLe:o();break;case JLe:{var h=!1;a.current||(h=l()),h?u.preventDefault():o();break}}};_.useEffect(function(){return t?(window.addEventListener("keydown",c),n&&Lr(l,3),function(){window.removeEventListener("keydown",c),a.current=!1}):function(){a.current=!1}},[t])}var tNe=_.forwardRef(function(e,t){var r=e.overlay,i=e.arrow,n=e.prefixCls,s=_.useMemo(function(){var o;return typeof r=="function"?o=r():o=r,o},[r]),a=To(t,s==null?void 0:s.ref);return Ge.createElement(Ge.Fragment,null,i&&Ge.createElement("div",{className:"".concat(n,"-arrow")}),Ge.cloneElement(s,{ref:gd(s)?a:void 0}))}),Am={adjustX:1,adjustY:1},Tm=[0,0],rNe={topLeft:{points:["bl","tl"],overflow:Am,offset:[0,-4],targetOffset:Tm},top:{points:["bc","tc"],overflow:Am,offset:[0,-4],targetOffset:Tm},topRight:{points:["br","tr"],overflow:Am,offset:[0,-4],targetOffset:Tm},bottomLeft:{points:["tl","bl"],overflow:Am,offset:[0,4],targetOffset:Tm},bottom:{points:["tc","bc"],overflow:Am,offset:[0,4],targetOffset:Tm},bottomRight:{points:["tr","br"],overflow:Am,offset:[0,4],targetOffset:Tm}},iNe=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function nNe(e,t){var r,i=e.arrow,n=i===void 0?!1:i,s=e.prefixCls,a=s===void 0?"rc-dropdown":s,o=e.transitionName,l=e.animation,c=e.align,d=e.placement,u=d===void 0?"bottomLeft":d,h=e.placements,f=h===void 0?rNe:h,p=e.getPopupContainer,m=e.showAction,g=e.hideAction,v=e.overlayClassName,y=e.overlayStyle,b=e.visible,x=e.trigger,S=x===void 0?["hover"]:x,w=e.autoFocus,E=e.overlay,C=e.children,T=e.onVisibleChange,A=hr(e,iNe),M=Ge.useState(),P=Pe(M,2),I=P[0],R=P[1],N="visible"in e?b:I,k=Ge.useRef(null),O=Ge.useRef(null),D=Ge.useRef(null);Ge.useImperativeHandle(t,function(){return k.current});var B=function(Q){R(Q),T==null||T(Q)};eNe({visible:N,triggerRef:D,onVisibleChange:B,autoFocus:w,overlayRef:O});var z=function(Q){var Z=e.onOverlayClick;R(!1),Z&&Z(Q)},F=function(){return Ge.createElement(tNe,{ref:O,overlay:E,prefixCls:a,arrow:n})},V=function(){return typeof E=="function"?F:F()},Y=function(){var Q=e.minOverlayWidthMatchTrigger,Z=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?Q:!Z},W=function(){var Q=e.openClassName;return Q!==void 0?Q:"".concat(a,"-open")},X=Ge.cloneElement(C,{className:Fe((r=C.props)===null||r===void 0?void 0:r.className,N&&W()),ref:gd(C)?To(D,C.ref):void 0}),H=g;return!H&&S.indexOf("contextMenu")!==-1&&(H=["click"]),Ge.createElement(bM,ae({builtinPlacements:f},A,{prefixCls:a,ref:k,popupClassName:Fe(v,he({},"".concat(a,"-show-arrow"),n)),popupStyle:y,action:S,showAction:m,hideAction:H,popupPlacement:u,popupAlign:c,popupTransitionName:o,popupAnimation:l,popupVisible:N,stretch:Y()?"minWidth":"",popup:V(),onPopupVisibleChange:B,onPopupClick:z,getPopupContainer:p}),X)}const sNe=Ge.forwardRef(nNe);var cie=_.createContext(null);function uie(e,t){return e===void 0?null:"".concat(e,"-").concat(t)}function die(e){var t=_.useContext(cie);return uie(t,e)}var aNe=["children","locked"],Xl=_.createContext(null);function oNe(e,t){var r=_e({},e);return Object.keys(t).forEach(function(i){var n=t[i];n!==void 0&&(r[i]=n)}),r}function tx(e){var t=e.children,r=e.locked,i=hr(e,aNe),n=_.useContext(Xl),s=tw(function(){return oNe(n,i)},[n,i],function(a,o){return!r&&(a[0]!==o[0]||!aM(a[1],o[1],!0))});return _.createElement(Xl.Provider,{value:s},t)}var lNe=[],hie=_.createContext(null);function _M(){return _.useContext(hie)}var fie=_.createContext(lNe);function I0(e){var t=_.useContext(fie);return _.useMemo(function(){return e!==void 0?[].concat(ft(t),[e]):t},[t,e])}var pie=_.createContext(null),JF=_.createContext({});function mH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(pM(e)){var r=e.nodeName.toLowerCase(),i=["input","select","textarea","button"].includes(r)||e.isContentEditable||r==="a"&&!!e.getAttribute("href"),n=e.getAttribute("tabindex"),s=Number(n),a=null;return n&&!Number.isNaN(s)?a=s:i&&a===null&&(a=0),i&&e.disabled&&(a=null),a!==null&&(a>=0||t&&a<0)}return!1}function cNe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=ft(e.querySelectorAll("*")).filter(function(i){return mH(i,t)});return mH(e,t)&&r.unshift(e),r}var pL=rt.LEFT,mL=rt.RIGHT,gL=rt.UP,yE=rt.DOWN,bE=rt.ENTER,mie=rt.ESC,by=rt.HOME,xy=rt.END,gH=[gL,yE,pL,mL];function uNe(e,t,r,i){var n,s,a,o,l="prev",c="next",d="children",u="parent";if(e==="inline"&&i===bE)return{inlineTrigger:!0};var h=(n={},he(n,gL,l),he(n,yE,c),n),f=(s={},he(s,pL,r?c:l),he(s,mL,r?l:c),he(s,yE,d),he(s,bE,d),s),p=(a={},he(a,gL,l),he(a,yE,c),he(a,bE,d),he(a,mie,u),he(a,pL,r?d:u),he(a,mL,r?u:d),a),m={inline:h,horizontal:f,vertical:p,inlineSub:h,horizontalSub:p,verticalSub:p},g=(o=m["".concat(e).concat(t?"":"Sub")])===null||o===void 0?void 0:o[i];switch(g){case l:return{offset:-1,sibling:!0};case c:return{offset:1,sibling:!0};case u:return{offset:-1,sibling:!1};case d:return{offset:1,sibling:!1};default:return null}}function dNe(e){for(var t=e;t;){if(t.getAttribute("data-menu-list"))return t;t=t.parentElement}return null}function hNe(e,t){for(var r=e||document.activeElement;r;){if(t.has(r))return r;r=r.parentElement}return null}function e4(e,t){var r=cNe(e,!0);return r.filter(function(i){return t.has(i)})}function vH(e,t,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!e)return null;var n=e4(e,t),s=n.length,a=n.findIndex(function(o){return r===o});return i<0?a===-1?a=s-1:a-=1:i>0&&(a+=1),a=(a+s)%s,n[a]}var vL=function(t,r){var i=new Set,n=new Map,s=new Map;return t.forEach(function(a){var o=document.querySelector("[data-menu-id='".concat(uie(r,a),"']"));o&&(i.add(o),s.set(o,a),n.set(a,o))}),{elements:i,key2element:n,element2key:s}};function fNe(e,t,r,i,n,s,a,o,l,c){var d=_.useRef(),u=_.useRef();u.current=t;var h=function(){Lr.cancel(d.current)};return _.useEffect(function(){return function(){h()}},[]),function(f){var p=f.which;if([].concat(gH,[bE,mie,by,xy]).includes(p)){var m=s(),g=vL(m,i),v=g,y=v.elements,b=v.key2element,x=v.element2key,S=b.get(t),w=hNe(S,y),E=x.get(w),C=uNe(e,a(E,!0).length===1,r,p);if(!C&&p!==by&&p!==xy)return;(gH.includes(p)||[by,xy].includes(p))&&f.preventDefault();var T=function(O){if(O){var D=O,B=O.querySelector("a");B!=null&&B.getAttribute("href")&&(D=B);var z=x.get(O);o(z),h(),d.current=Lr(function(){u.current===z&&D.focus()})}};if([by,xy].includes(p)||C.sibling||!w){var A;!w||e==="inline"?A=n.current:A=dNe(w);var M,P=e4(A,y);p===by?M=P[0]:p===xy?M=P[P.length-1]:M=vH(A,y,w,C.offset),T(M)}else if(C.inlineTrigger)l(E);else if(C.offset>0)l(E,!0),h(),d.current=Lr(function(){g=vL(m,i);var k=w.getAttribute("aria-controls"),O=document.getElementById(k),D=vH(O,g.elements);T(D)},5);else if(C.offset<0){var I=a(E,!0),R=I[I.length-2],N=b.get(R);l(R,!1),T(N)}}c==null||c(f)}}function pNe(e){Promise.resolve().then(e)}var t4="__RC_UTIL_PATH_SPLIT__",yH=function(t){return t.join(t4)},mNe=function(t){return t.split(t4)},yL="rc-menu-more";function gNe(){var e=_.useState({}),t=Pe(e,2),r=t[1],i=_.useRef(new Map),n=_.useRef(new Map),s=_.useState([]),a=Pe(s,2),o=a[0],l=a[1],c=_.useRef(0),d=_.useRef(!1),u=function(){d.current||r({})},h=_.useCallback(function(b,x){var S=yH(x);n.current.set(S,b),i.current.set(b,S),c.current+=1;var w=c.current;pNe(function(){w===c.current&&u()})},[]),f=_.useCallback(function(b,x){var S=yH(x);n.current.delete(S),i.current.delete(b)},[]),p=_.useCallback(function(b){l(b)},[]),m=_.useCallback(function(b,x){var S=i.current.get(b)||"",w=mNe(S);return x&&o.includes(w[0])&&w.unshift(yL),w},[o]),g=_.useCallback(function(b,x){return b.some(function(S){var w=m(S,!0);return w.includes(x)})},[m]),v=function(){var x=ft(i.current.keys());return o.length&&x.push(yL),x},y=_.useCallback(function(b){var x="".concat(i.current.get(b)).concat(t4),S=new Set;return ft(n.current.keys()).forEach(function(w){w.startsWith(x)&&S.add(n.current.get(w))}),S},[]);return _.useEffect(function(){return function(){d.current=!0}},[]),{registerPath:h,unregisterPath:f,refreshOverflowKeys:p,isSubPathKey:g,getKeyPath:m,getKeys:v,getSubPathKeys:y}}function d1(e){var t=_.useRef(e);t.current=e;var r=_.useCallback(function(){for(var i,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(s))},[]);return e?r:void 0}var vNe=Math.random().toFixed(5).toString().slice(2),bH=0;function yNe(e){var t=Ka(e,{value:e}),r=Pe(t,2),i=r[0],n=r[1];return _.useEffect(function(){bH+=1;var s="".concat(vNe,"-").concat(bH);n("rc-menu-uuid-".concat(s))},[]),i}function gie(e,t,r,i){var n=_.useContext(Xl),s=n.activeKey,a=n.onActive,o=n.onInactive,l={active:s===e};return t||(l.onMouseEnter=function(c){r==null||r({key:e,domEvent:c}),a(e)},l.onMouseLeave=function(c){i==null||i({key:e,domEvent:c}),o(e)}),l}function vie(e){var t=_.useContext(Xl),r=t.mode,i=t.rtl,n=t.inlineIndent;if(r!=="inline")return null;var s=e;return i?{paddingRight:s*n}:{paddingLeft:s*n}}function yie(e){var t=e.icon,r=e.props,i=e.children,n;return t===null||t===!1?null:(typeof t=="function"?n=_.createElement(t,_e({},r)):typeof t!="boolean"&&(n=t),n||i||null)}var bNe=["item"];function nA(e){var t=e.item,r=hr(e,bNe);return Object.defineProperty(r,"item",{get:function(){return As(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),t}}),r}var xNe=["title","attribute","elementRef"],wNe=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],_Ne=["active"],SNe=function(e){Kp(r,e);var t=Qp(r);function r(){return Ds(this,r),t.apply(this,arguments)}return Os(r,[{key:"render",value:function(){var n=this.props,s=n.title,a=n.attribute,o=n.elementRef,l=hr(n,xNe),c=Pa(l,["eventKey","popupClassName","popupOffset","onTitleClick"]);return As(!a,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),_.createElement($c.Item,ae({},a,{title:typeof s=="string"?s:void 0},c,{ref:o}))}}]),r}(_.Component),ENe=_.forwardRef(function(e,t){var r,i=e.style,n=e.className,s=e.eventKey;e.warnKey;var a=e.disabled,o=e.itemIcon,l=e.children,c=e.role,d=e.onMouseEnter,u=e.onMouseLeave,h=e.onClick,f=e.onKeyDown,p=e.onFocus,m=hr(e,wNe),g=die(s),v=_.useContext(Xl),y=v.prefixCls,b=v.onItemClick,x=v.disabled,S=v.overflowDisabled,w=v.itemIcon,E=v.selectedKeys,C=v.onActive,T=_.useContext(JF),A=T._internalRenderMenuItem,M="".concat(y,"-item"),P=_.useRef(),I=_.useRef(),R=x||a,N=C0(t,I),k=I0(s),O=function(ee){return{key:s,keyPath:ft(k).reverse(),item:P.current,domEvent:ee}},D=o||w,B=gie(s,R,d,u),z=B.active,F=hr(B,_Ne),V=E.includes(s),Y=vie(k.length),W=function(ee){if(!R){var re=O(ee);h==null||h(nA(re)),b(re)}},X=function(ee){if(f==null||f(ee),ee.which===rt.ENTER){var re=O(ee);h==null||h(nA(re)),b(re)}},H=function(ee){C(s),p==null||p(ee)},ie={};e.role==="option"&&(ie["aria-selected"]=V);var Q=_.createElement(SNe,ae({ref:P,elementRef:N,role:c===null?"none":c||"menuitem",tabIndex:a?null:-1,"data-menu-id":S&&g?null:g},m,F,ie,{component:"li","aria-disabled":a,style:_e(_e({},Y),i),className:Fe(M,(r={},he(r,"".concat(M,"-active"),z),he(r,"".concat(M,"-selected"),V),he(r,"".concat(M,"-disabled"),R),r),n),onClick:W,onKeyDown:X,onFocus:H}),l,_.createElement(yie,{props:_e(_e({},e),{},{isSelected:V}),icon:D}));return A&&(Q=A(Q,e,{selected:V})),Q});function CNe(e,t){var r=e.eventKey,i=_M(),n=I0(r);return _.useEffect(function(){if(i)return i.registerPath(r,n),function(){i.unregisterPath(r,n)}},[n]),i?null:_.createElement(ENe,ae({},e,{ref:t}))}const SM=_.forwardRef(CNe);var ANe=["className","children"],TNe=function(t,r){var i=t.className,n=t.children,s=hr(t,ANe),a=_.useContext(Xl),o=a.prefixCls,l=a.mode,c=a.rtl;return _.createElement("ul",ae({className:Fe(o,c&&"".concat(o,"-rtl"),"".concat(o,"-sub"),"".concat(o,"-").concat(l==="inline"?"inline":"vertical"),i),role:"menu"},s,{"data-menu-list":!0,ref:r}),n)},r4=_.forwardRef(TNe);r4.displayName="SubMenuList";function i4(e,t){return Qc(e).map(function(r,i){if(_.isValidElement(r)){var n,s,a=r.key,o=(n=(s=r.props)===null||s===void 0?void 0:s.eventKey)!==null&&n!==void 0?n:a,l=o==null;l&&(o="tmp_key-".concat([].concat(ft(t),[i]).join("-")));var c={key:o,eventKey:o};return _.cloneElement(r,c)}return r})}var Us={adjustX:1,adjustY:1},MNe={topLeft:{points:["bl","tl"],overflow:Us},topRight:{points:["br","tr"],overflow:Us},bottomLeft:{points:["tl","bl"],overflow:Us},bottomRight:{points:["tr","br"],overflow:Us},leftTop:{points:["tr","tl"],overflow:Us},leftBottom:{points:["br","bl"],overflow:Us},rightTop:{points:["tl","tr"],overflow:Us},rightBottom:{points:["bl","br"],overflow:Us}},PNe={topLeft:{points:["bl","tl"],overflow:Us},topRight:{points:["br","tr"],overflow:Us},bottomLeft:{points:["tl","bl"],overflow:Us},bottomRight:{points:["tr","br"],overflow:Us},rightTop:{points:["tr","tl"],overflow:Us},rightBottom:{points:["br","bl"],overflow:Us},leftTop:{points:["tl","tr"],overflow:Us},leftBottom:{points:["bl","br"],overflow:Us}};function bie(e,t,r){if(t)return t;if(r)return r[e]||r.other}var INe={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function RNe(e){var t=e.prefixCls,r=e.visible,i=e.children,n=e.popup,s=e.popupStyle,a=e.popupClassName,o=e.popupOffset,l=e.disabled,c=e.mode,d=e.onVisibleChange,u=_.useContext(Xl),h=u.getPopupContainer,f=u.rtl,p=u.subMenuOpenDelay,m=u.subMenuCloseDelay,g=u.builtinPlacements,v=u.triggerSubMenuAction,y=u.forceSubMenuRender,b=u.rootClassName,x=u.motion,S=u.defaultMotions,w=_.useState(!1),E=Pe(w,2),C=E[0],T=E[1],A=_e(f?_e({},PNe):_e({},MNe),g),M=INe[c],P=bie(c,x,S),I=_.useRef(P);c!=="inline"&&(I.current=P);var R=_e(_e({},I.current),{},{leavedClassName:"".concat(t,"-hidden"),removeOnLeave:!1,motionAppear:!0}),N=_.useRef();return _.useEffect(function(){return N.current=Lr(function(){T(r)}),function(){Lr.cancel(N.current)}},[r]),_.createElement(bM,{prefixCls:t,popupClassName:Fe("".concat(t,"-popup"),he({},"".concat(t,"-rtl"),f),a,b),stretch:c==="horizontal"?"minWidth":null,getPopupContainer:h,builtinPlacements:A,popupPlacement:M,popupVisible:C,popup:n,popupStyle:s,popupAlign:o&&{offset:o},action:l?[]:[v],mouseEnterDelay:p,mouseLeaveDelay:m,onPopupVisibleChange:d,forceRender:y,popupMotion:R,fresh:!0},i)}function DNe(e){var t=e.id,r=e.open,i=e.keyPath,n=e.children,s="inline",a=_.useContext(Xl),o=a.prefixCls,l=a.forceSubMenuRender,c=a.motion,d=a.defaultMotions,u=a.mode,h=_.useRef(!1);h.current=u===s;var f=_.useState(!h.current),p=Pe(f,2),m=p[0],g=p[1],v=h.current?r:!1;_.useEffect(function(){h.current&&g(!1)},[u]);var y=_e({},bie(s,c,d));i.length>1&&(y.motionAppear=!1);var b=y.onVisibleChanged;return y.onVisibleChanged=function(x){return!h.current&&!x&&g(!0),b==null?void 0:b(x)},m?null:_.createElement(tx,{mode:s,locked:!h.current},_.createElement(Zp,ae({visible:v},y,{forceRender:l,removeOnLeave:!1,leavedClassName:"".concat(o,"-hidden")}),function(x){var S=x.className,w=x.style;return _.createElement(r4,{id:t,className:S,style:w},n)}))}var ONe=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],LNe=["active"],NNe=function(t){var r,i=t.style,n=t.className,s=t.title,a=t.eventKey;t.warnKey;var o=t.disabled,l=t.internalPopupClose,c=t.children,d=t.itemIcon,u=t.expandIcon,h=t.popupClassName,f=t.popupOffset,p=t.popupStyle,m=t.onClick,g=t.onMouseEnter,v=t.onMouseLeave,y=t.onTitleClick,b=t.onTitleMouseEnter,x=t.onTitleMouseLeave,S=hr(t,ONe),w=die(a),E=_.useContext(Xl),C=E.prefixCls,T=E.mode,A=E.openKeys,M=E.disabled,P=E.overflowDisabled,I=E.activeKey,R=E.selectedKeys,N=E.itemIcon,k=E.expandIcon,O=E.onItemClick,D=E.onOpenChange,B=E.onActive,z=_.useContext(JF),F=z._internalRenderSubMenuItem,V=_.useContext(pie),Y=V.isSubPathKey,W=I0(),X="".concat(C,"-submenu"),H=M||o,ie=_.useRef(),Q=_.useRef(),Z=d??N,ee=u??k,re=A.includes(a),ne=!P&&re,se=Y(R,a),fe=gie(a,H,b,x),me=fe.active,Oe=hr(fe,LNe),Ee=_.useState(!1),Se=Pe(Ee,2),de=Se[0],be=Se[1],ye=function(Ze){H||be(Ze)},q=function(Ze){ye(!0),g==null||g({key:a,domEvent:Ze})},U=function(Ze){ye(!1),v==null||v({key:a,domEvent:Ze})},ce=_.useMemo(function(){return me||(T!=="inline"?de||Y([I],a):!1)},[T,me,I,de,a,Y]),xe=vie(W.length),j=function(Ze){H||(y==null||y({key:a,domEvent:Ze}),T==="inline"&&D(a,!re))},Be=d1(function(Xe){m==null||m(nA(Xe)),O(Xe)}),ze=function(Ze){T!=="inline"&&D(a,Ze)},Ve=function(){B(a)},pe=w&&"".concat(w,"-popup"),Me=_.createElement("div",ae({role:"menuitem",style:xe,className:"".concat(X,"-title"),tabIndex:H?null:-1,ref:ie,title:typeof s=="string"?s:null,"data-menu-id":P&&w?null:w,"aria-expanded":ne,"aria-haspopup":!0,"aria-controls":pe,"aria-disabled":H,onClick:j,onFocus:Ve},Oe),s,_.createElement(yie,{icon:T!=="horizontal"?ee:void 0,props:_e(_e({},t),{},{isOpen:ne,isSubMenu:!0})},_.createElement("i",{className:"".concat(X,"-arrow")}))),Ue=_.useRef(T);if(T!=="inline"&&W.length>1?Ue.current="vertical":Ue.current=T,!P){var Re=Ue.current;Me=_.createElement(RNe,{mode:Re,prefixCls:X,visible:!l&&ne&&T!=="inline",popupClassName:h,popupOffset:f,popupStyle:p,popup:_.createElement(tx,{mode:Re==="horizontal"?"vertical":Re},_.createElement(r4,{id:pe,ref:Q},c)),disabled:H,onVisibleChange:ze},Me)}var et=_.createElement($c.Item,ae({role:"none"},S,{component:"li",style:i,className:Fe(X,"".concat(X,"-").concat(T),n,(r={},he(r,"".concat(X,"-open"),ne),he(r,"".concat(X,"-active"),ce),he(r,"".concat(X,"-selected"),se),he(r,"".concat(X,"-disabled"),H),r)),onMouseEnter:q,onMouseLeave:U}),Me,!P&&_.createElement(DNe,{id:pe,open:ne,keyPath:W},c));return F&&(et=F(et,t,{selected:se,active:ce,open:ne,disabled:H})),_.createElement(tx,{onItemClick:Be,mode:T==="horizontal"?"vertical":T,itemIcon:Z,expandIcon:ee},et)};function EM(e){var t=e.eventKey,r=e.children,i=I0(t),n=i4(r,i),s=_M();_.useEffect(function(){if(s)return s.registerPath(t,i),function(){s.unregisterPath(t,i)}},[i]);var a;return s?a=n:a=_.createElement(NNe,e,n),_.createElement(fie.Provider,{value:i},a)}var kNe=["className","title","eventKey","children"],zNe=["children"],BNe=function(t){var r=t.className,i=t.title;t.eventKey;var n=t.children,s=hr(t,kNe),a=_.useContext(Xl),o=a.prefixCls,l="".concat(o,"-item-group");return _.createElement("li",ae({role:"presentation"},s,{onClick:function(d){return d.stopPropagation()},className:Fe(l,r)}),_.createElement("div",{role:"presentation",className:"".concat(l,"-title"),title:typeof i=="string"?i:void 0},i),_.createElement("ul",{role:"group",className:"".concat(l,"-list")},n))};function CM(e){var t=e.children,r=hr(e,zNe),i=I0(r.eventKey),n=i4(t,i),s=_M();return s?n:_.createElement(BNe,Pa(r,["warnKey"]),n)}function n4(e){var t=e.className,r=e.style,i=_.useContext(Xl),n=i.prefixCls,s=_M();return s?null:_.createElement("li",{role:"separator",className:Fe("".concat(n,"-item-divider"),t),style:r})}var FNe=["label","children","key","type"];function bL(e){return(e||[]).map(function(t,r){if(t&&vr(t)==="object"){var i=t,n=i.label,s=i.children,a=i.key,o=i.type,l=hr(i,FNe),c=a??"tmp-".concat(r);return s||o==="group"?o==="group"?_.createElement(CM,ae({key:c},l,{title:n}),bL(s)):_.createElement(EM,ae({key:c},l,{title:n}),bL(s)):o==="divider"?_.createElement(n4,ae({key:c},l)):_.createElement(SM,ae({key:c},l),n)}return null}).filter(function(t){return t})}function jNe(e,t,r){var i=e;return t&&(i=bL(t)),i4(i,r)}var VNe=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],Mm=[],UNe=_.forwardRef(function(e,t){var r,i,n=e,s=n.prefixCls,a=s===void 0?"rc-menu":s,o=n.rootClassName,l=n.style,c=n.className,d=n.tabIndex,u=d===void 0?0:d,h=n.items,f=n.children,p=n.direction,m=n.id,g=n.mode,v=g===void 0?"vertical":g,y=n.inlineCollapsed,b=n.disabled,x=n.disabledOverflow,S=n.subMenuOpenDelay,w=S===void 0?.1:S,E=n.subMenuCloseDelay,C=E===void 0?.1:E,T=n.forceSubMenuRender,A=n.defaultOpenKeys,M=n.openKeys,P=n.activeKey,I=n.defaultActiveFirst,R=n.selectable,N=R===void 0?!0:R,k=n.multiple,O=k===void 0?!1:k,D=n.defaultSelectedKeys,B=n.selectedKeys,z=n.onSelect,F=n.onDeselect,V=n.inlineIndent,Y=V===void 0?24:V,W=n.motion,X=n.defaultMotions,H=n.triggerSubMenuAction,ie=H===void 0?"hover":H,Q=n.builtinPlacements,Z=n.itemIcon,ee=n.expandIcon,re=n.overflowedIndicator,ne=re===void 0?"...":re,se=n.overflowedIndicatorPopupClassName,fe=n.getPopupContainer,me=n.onClick,Oe=n.onOpenChange,Ee=n.onKeyDown;n.openAnimation,n.openTransitionName;var Se=n._internalRenderMenuItem,de=n._internalRenderSubMenuItem,be=hr(n,VNe),ye=_.useMemo(function(){return jNe(f,h,Mm)},[f,h]),q=_.useState(!1),U=Pe(q,2),ce=U[0],xe=U[1],j=_.useRef(),Be=yNe(m),ze=p==="rtl",Ve=Ka(A,{value:M,postState:function(Bt){return Bt||Mm}}),pe=Pe(Ve,2),Me=pe[0],Ue=pe[1],Re=function(Bt){var Kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function pr(){Ue(Bt),Oe==null||Oe(Bt)}Kt?Vl.flushSync(pr):pr()},et=_.useState(Me),Xe=Pe(et,2),Ze=Xe[0],Mt=Xe[1],Gt=_.useRef(!1),ue=_.useMemo(function(){return(v==="inline"||v==="vertical")&&y?["vertical",y]:[v,!1]},[v,y]),Ae=Pe(ue,2),ke=Ae[0],Ie=Ae[1],$e=ke==="inline",tt=_.useState(ke),He=Pe(tt,2),gt=He[0],ot=He[1],at=_.useState(Ie),Qe=Pe(at,2),ut=Qe[0],yt=Qe[1];_.useEffect(function(){ot(ke),yt(Ie),Gt.current&&($e?Ue(Ze):Re(Mm))},[ke,Ie]);var xt=_.useState(0),or=Pe(xt,2),Jt=or[0],te=or[1],we=Jt>=ye.length-1||gt!=="horizontal"||x;_.useEffect(function(){$e&&Mt(Me)},[Me]),_.useEffect(function(){return Gt.current=!0,function(){Gt.current=!1}},[]);var Te=gNe(),ve=Te.registerPath,Le=Te.unregisterPath,mt=Te.refreshOverflowKeys,Pt=Te.isSubPathKey,it=Te.getKeyPath,qe=Te.getKeys,pt=Te.getSubPathKeys,St=_.useMemo(function(){return{registerPath:ve,unregisterPath:Le}},[ve,Le]),Ot=_.useMemo(function(){return{isSubPathKey:Pt}},[Pt]);_.useEffect(function(){mt(we?Mm:ye.slice(Jt+1).map(function(dt){return dt.key}))},[Jt,we]);var Ct=Ka(P||I&&((r=ye[0])===null||r===void 0?void 0:r.key),{value:P}),Br=Pe(Ct,2),hi=Br[0],ji=Br[1],Ar=d1(function(dt){ji(dt)}),kt=d1(function(){ji(void 0)});_.useImperativeHandle(t,function(){return{list:j.current,focus:function(Bt){var Kt,pr=qe(),wr=vL(pr,Be),Ai=wr.elements,eo=wr.key2element,Da=wr.element2key,Oa=e4(j.current,Ai),aa=hi??(Oa[0]?Da.get(Oa[0]):(Kt=ye.find(function(Y0){return!Y0.props.disabled}))===null||Kt===void 0?void 0:Kt.key),Po=eo.get(aa);if(aa&&Po){var xd;Po==null||(xd=Po.focus)===null||xd===void 0||xd.call(Po,Bt)}}}});var fn=Ka(D||[],{value:B,postState:function(Bt){return Array.isArray(Bt)?Bt:Bt==null?Mm:[Bt]}}),qt=Pe(fn,2),yi=qt[0],Ns=qt[1],pn=function(Bt){if(N){var Kt=Bt.key,pr=yi.includes(Kt),wr;O?pr?wr=yi.filter(function(eo){return eo!==Kt}):wr=[].concat(ft(yi),[Kt]):wr=[Kt],Ns(wr);var Ai=_e(_e({},Bt),{},{selectedKeys:wr});pr?F==null||F(Ai):z==null||z(Ai)}!O&&Me.length&&gt!=="inline"&&Re(Mm)},Ci=d1(function(dt){me==null||me(nA(dt)),pn(dt)}),$=d1(function(dt,Bt){var Kt=Me.filter(function(wr){return wr!==dt});if(Bt)Kt.push(dt);else if(gt!=="inline"){var pr=pt(dt);Kt=Kt.filter(function(wr){return!pr.has(wr)})}aM(Me,Kt,!0)||Re(Kt,!0)}),K=function(Bt,Kt){var pr=Kt??!Me.includes(Bt);$(Bt,pr)},le=fNe(gt,hi,ze,Be,j,qe,it,ji,K,Ee);_.useEffect(function(){xe(!0)},[]);var J=_.useMemo(function(){return{_internalRenderMenuItem:Se,_internalRenderSubMenuItem:de}},[Se,de]),ge=gt!=="horizontal"||x?ye:ye.map(function(dt,Bt){return _.createElement(tx,{key:dt.key,overflowDisabled:Bt>Jt},dt)}),De=_.createElement($c,ae({id:m,ref:j,prefixCls:"".concat(a,"-overflow"),component:"ul",itemComponent:SM,className:Fe(a,"".concat(a,"-root"),"".concat(a,"-").concat(gt),c,(i={},he(i,"".concat(a,"-inline-collapsed"),ut),he(i,"".concat(a,"-rtl"),ze),i),o),dir:p,style:l,role:"menu",tabIndex:u,data:ge,renderRawItem:function(Bt){return Bt},renderRawRest:function(Bt){var Kt=Bt.length,pr=Kt?ye.slice(-Kt):null;return _.createElement(EM,{eventKey:yL,title:ne,disabled:we,internalPopupClose:Kt===0,popupClassName:se},pr)},maxCount:gt!=="horizontal"||x?$c.INVALIDATE:$c.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(Bt){te(Bt)},onKeyDown:le},be));return _.createElement(JF.Provider,{value:J},_.createElement(cie.Provider,{value:Be},_.createElement(tx,{prefixCls:a,rootClassName:o,mode:gt,openKeys:Me,rtl:ze,disabled:b,motion:ce?W:null,defaultMotions:ce?X:null,activeKey:hi,onActive:Ar,onInactive:kt,selectedKeys:yi,inlineIndent:Y,subMenuOpenDelay:w,subMenuCloseDelay:C,forceSubMenuRender:T,builtinPlacements:Q,triggerSubMenuAction:ie,getPopupContainer:fe,itemIcon:Z,expandIcon:ee,onItemClick:Ci,onOpenChange:$},_.createElement(pie.Provider,{value:Ot},De),_.createElement("div",{style:{display:"none"},"aria-hidden":!0},_.createElement(hie.Provider,{value:St},ye)))))}),cw=UNe;cw.Item=SM;cw.SubMenu=EM;cw.ItemGroup=CM;cw.Divider=n4;globalThis&&globalThis.__rest;const xie=_.createContext({});var $Ne=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const HNe=e=>{const{prefixCls:t,className:r,dashed:i}=e,n=$Ne(e,["prefixCls","className","dashed"]),{getPrefixCls:s}=_.useContext(br),a=s("menu",t),o=Fe({[`${a}-item-divider-dashed`]:!!i},r);return _.createElement(n4,Object.assign({className:o},n))},wie=HNe,WNe=_.createContext({prefixCls:"",firstLevel:!0,inlineCollapsed:!1}),sA=WNe,GNe=e=>{var t;const{className:r,children:i,icon:n,title:s,danger:a}=e,{prefixCls:o,firstLevel:l,direction:c,disableMenuItemTitleTooltip:d,inlineCollapsed:u}=_.useContext(sA),h=y=>{const b=_.createElement("span",{className:`${o}-title-content`},i);return(!n||Gl(i)&&i.type==="span")&&i&&y&&l&&typeof i=="string"?_.createElement("div",{className:`${o}-inline-collapsed-noicon`},i.charAt(0)):b},{siderCollapsed:f}=_.useContext(xie);let p=s;typeof s>"u"?p=l?i:"":s===!1&&(p="");const m={title:p};!f&&!u&&(m.title=null,m.open=!1);const g=Qc(i).length;let v=_.createElement(SM,Object.assign({},Pa(e,["title","icon","danger"]),{className:Fe({[`${o}-item-danger`]:a,[`${o}-item-only-child`]:(n?g+1:g)===1},r),title:typeof s=="string"?s:void 0}),nl(n,{className:Fe(Gl(n)?(t=n.props)===null||t===void 0?void 0:t.className:"",`${o}-item-icon`)}),h(u));return d||(v=_.createElement(ZF,Object.assign({},m,{placement:c==="rtl"?"left":"right",overlayClassName:`${o}-inline-collapsed-tooltip`}),v)),v},_ie=GNe,qNe=e=>{var t;const{popupClassName:r,icon:i,title:n,theme:s}=e,a=_.useContext(sA),{prefixCls:o,inlineCollapsed:l,theme:c}=a,d=I0();let u;if(!i)u=l&&!d.length&&n&&typeof n=="string"?_.createElement("div",{className:`${o}-inline-collapsed-noicon`},n.charAt(0)):_.createElement("span",{className:`${o}-title-content`},n);else{const p=Gl(n)&&n.type==="span";u=_.createElement(_.Fragment,null,nl(i,{className:Fe(Gl(i)?(t=i.props)===null||t===void 0?void 0:t.className:"",`${o}-item-icon`)}),p?n:_.createElement("span",{className:`${o}-title-content`},n))}const h=_.useMemo(()=>Object.assign(Object.assign({},a),{firstLevel:!1}),[a]),[f]=hM("Menu");return _.createElement(sA.Provider,{value:h},_.createElement(EM,Object.assign({},Pa(e,["icon"]),{title:u,popupClassName:Fe(o,r,`${o}-${s||c}`),popupStyle:{zIndex:f}})))},Sie=qNe;var XNe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"};const YNe=XNe;var KNe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:YNe}))};const Eie=_.forwardRef(KNe);var QNe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function xL(e){return(e||[]).map((t,r)=>{if(t&&typeof t=="object"){const i=t,{label:n,children:s,key:a,type:o}=i,l=QNe(i,["label","children","key","type"]),c=a??`tmp-${r}`;return s||o==="group"?o==="group"?_.createElement(CM,Object.assign({key:c},l,{title:n}),xL(s)):_.createElement(Sie,Object.assign({key:c},l,{title:n}),xL(s)):o==="divider"?_.createElement(wie,Object.assign({key:c},l)):_.createElement(_ie,Object.assign({key:c},l),n)}return null}).filter(t=>t)}function ZNe(e){return _.useMemo(()=>e&&xL(e),[e])}var JNe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const aA=_.createContext(null),eke=_.forwardRef((e,t)=>{const{children:r}=e,i=JNe(e,["children"]),n=_.useContext(aA),s=_.useMemo(()=>Object.assign(Object.assign({},n),i),[n,i.prefixCls,i.mode,i.selectable,i.rootClassName]),a=jAe(r),o=C0(t,a?r.ref:null);return _.createElement(aA.Provider,{value:s},_.createElement($v,null,a?_.cloneElement(r,{ref:o}):r))}),tke=e=>{const{componentCls:t,motionDurationSlow:r,horizontalLineHeight:i,colorSplit:n,lineWidth:s,lineType:a,itemPaddingInline:o}=e;return{[`${t}-horizontal`]:{lineHeight:i,border:0,borderBottom:`${lt(s)} ${a} ${n}`,boxShadow:"none","&::after":{display:"block",clear:"both",height:0,content:'"\\20"'},[`${t}-item, ${t}-submenu`]:{position:"relative",display:"inline-block",verticalAlign:"bottom",paddingInline:o},[`> ${t}-item:hover,
        > ${t}-item-active,
        > ${t}-submenu ${t}-submenu-title:hover`]:{backgroundColor:"transparent"},[`${t}-item, ${t}-submenu-title`]:{transition:[`border-color ${r}`,`background ${r}`].join(",")},[`${t}-submenu-arrow`]:{display:"none"}}}},rke=tke,ike=e=>{let{componentCls:t,menuArrowOffset:r,calc:i}=e;return{[`${t}-rtl`]:{direction:"rtl"},[`${t}-submenu-rtl`]:{transformOrigin:"100% 0"},[`${t}-rtl${t}-vertical,
    ${t}-submenu-rtl ${t}-vertical`]:{[`${t}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateY(${lt(i(r).mul(-1).equal())})`},"&::after":{transform:`rotate(45deg) translateY(${lt(r)})`}}}}},nke=ike,xH=e=>Object.assign({},wF(e)),ske=(e,t)=>{const{componentCls:r,itemColor:i,itemSelectedColor:n,groupTitleColor:s,itemBg:a,subMenuItemBg:o,itemSelectedBg:l,activeBarHeight:c,activeBarWidth:d,activeBarBorderWidth:u,motionDurationSlow:h,motionEaseInOut:f,motionEaseOut:p,itemPaddingInline:m,motionDurationMid:g,itemHoverColor:v,lineType:y,colorSplit:b,itemDisabledColor:x,dangerItemColor:S,dangerItemHoverColor:w,dangerItemSelectedColor:E,dangerItemActiveBg:C,dangerItemSelectedBg:T,itemHoverBg:A,itemActiveBg:M,menuSubMenuBg:P,horizontalItemSelectedColor:I,horizontalItemSelectedBg:R,horizontalItemBorderRadius:N,horizontalItemHoverBg:k,popupBg:O}=e;return{[`${r}-${t}, ${r}-${t} > ${r}`]:{color:i,background:a,[`&${r}-root:focus-visible`]:Object.assign({},xH(e)),[`${r}-item-group-title`]:{color:s},[`${r}-submenu-selected`]:{[`> ${r}-submenu-title`]:{color:n}},[`${r}-item-disabled, ${r}-submenu-disabled`]:{color:`${x} !important`},[`${r}-item:not(${r}-item-selected):not(${r}-submenu-selected)`]:{[`&:hover, > ${r}-submenu-title:hover`]:{color:v}},[`&:not(${r}-horizontal)`]:{[`${r}-item:not(${r}-item-selected)`]:{"&:hover":{backgroundColor:A},"&:active":{backgroundColor:M}},[`${r}-submenu-title`]:{"&:hover":{backgroundColor:A},"&:active":{backgroundColor:M}}},[`${r}-item-danger`]:{color:S,[`&${r}-item:hover`]:{[`&:not(${r}-item-selected):not(${r}-submenu-selected)`]:{color:w}},[`&${r}-item:active`]:{background:C}},[`${r}-item a`]:{"&, &:hover":{color:"inherit"}},[`${r}-item-selected`]:{color:n,[`&${r}-item-danger`]:{color:E},"a, a:hover":{color:"inherit"}},[`& ${r}-item-selected`]:{backgroundColor:l,[`&${r}-item-danger`]:{backgroundColor:T}},[`${r}-item, ${r}-submenu-title`]:{[`&:not(${r}-item-disabled):focus-visible`]:Object.assign({},xH(e))},[`&${r}-submenu > ${r}`]:{backgroundColor:P},[`&${r}-popup > ${r}`]:{backgroundColor:O},[`&${r}-horizontal`]:Object.assign(Object.assign({},t==="dark"?{borderBottom:0}:{}),{[`> ${r}-item, > ${r}-submenu`]:{top:u,marginTop:e.calc(u).mul(-1).equal(),marginBottom:0,borderRadius:N,"&::after":{position:"absolute",insetInline:m,bottom:0,borderBottom:`${lt(c)} solid transparent`,transition:`border-color ${h} ${f}`,content:'""'},"&:hover, &-active, &-open":{background:k,"&::after":{borderBottomWidth:c,borderBottomColor:I}},"&-selected":{color:I,backgroundColor:R,"&:hover":{backgroundColor:R},"&::after":{borderBottomWidth:c,borderBottomColor:I}}}}),[`&${r}-root`]:{[`&${r}-inline, &${r}-vertical`]:{borderInlineEnd:`${lt(u)} ${y} ${b}`}},[`&${r}-inline`]:{[`${r}-sub${r}-inline`]:{background:o},[`${r}-item`]:{position:"relative","&::after":{position:"absolute",insetBlock:0,insetInlineEnd:0,borderInlineEnd:`${lt(d)} solid ${n}`,transform:"scaleY(0.0001)",opacity:0,transition:[`transform ${g} ${p}`,`opacity ${g} ${p}`].join(","),content:'""'},[`&${r}-item-danger`]:{"&::after":{borderInlineEndColor:E}}},[`${r}-selected, ${r}-item-selected`]:{"&::after":{transform:"scaleY(1)",opacity:1,transition:[`transform ${g} ${f}`,`opacity ${g} ${f}`].join(",")}}}}}},wH=ske,_H=e=>{const{componentCls:t,itemHeight:r,itemMarginInline:i,padding:n,menuArrowSize:s,marginXS:a,itemMarginBlock:o,itemWidth:l}=e,c=e.calc(s).add(n).add(a).equal();return{[`${t}-item`]:{position:"relative",overflow:"hidden"},[`${t}-item, ${t}-submenu-title`]:{height:r,lineHeight:lt(r),paddingInline:n,overflow:"hidden",textOverflow:"ellipsis",marginInline:i,marginBlock:o,width:l},[`> ${t}-item,
            > ${t}-submenu > ${t}-submenu-title`]:{height:r,lineHeight:lt(r)},[`${t}-item-group-list ${t}-submenu-title,
            ${t}-submenu-title`]:{paddingInlineEnd:c}}},ake=e=>{const{componentCls:t,iconCls:r,itemHeight:i,colorTextLightSolid:n,dropdownWidth:s,controlHeightLG:a,motionDurationMid:o,motionEaseOut:l,paddingXL:c,itemMarginInline:d,fontSizeLG:u,motionDurationSlow:h,paddingXS:f,boxShadowSecondary:p,collapsedWidth:m,collapsedIconSize:g}=e,v={height:i,lineHeight:lt(i),listStylePosition:"inside",listStyleType:"disc"};return[{[t]:{"&-inline, &-vertical":Object.assign({[`&${t}-root`]:{boxShadow:"none"}},_H(e))},[`${t}-submenu-popup`]:{[`${t}-vertical`]:Object.assign(Object.assign({},_H(e)),{boxShadow:p})}},{[`${t}-submenu-popup ${t}-vertical${t}-sub`]:{minWidth:s,maxHeight:`calc(100vh - ${lt(e.calc(a).mul(2.5).equal())})`,padding:"0",overflow:"hidden",borderInlineEnd:0,"&:not([class*='-active'])":{overflowX:"hidden",overflowY:"auto"}}},{[`${t}-inline`]:{width:"100%",[`&${t}-root`]:{[`${t}-item, ${t}-submenu-title`]:{display:"flex",alignItems:"center",transition:[`border-color ${h}`,`background ${h}`,`padding ${o} ${l}`].join(","),[`> ${t}-title-content`]:{flex:"auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},"> *":{flex:"none"}}},[`${t}-sub${t}-inline`]:{padding:0,border:0,borderRadius:0,boxShadow:"none",[`& > ${t}-submenu > ${t}-submenu-title`]:v,[`& ${t}-item-group-title`]:{paddingInlineStart:c}},[`${t}-item`]:v}},{[`${t}-inline-collapsed`]:{width:m,[`&${t}-root`]:{[`${t}-item, ${t}-submenu ${t}-submenu-title`]:{[`> ${t}-inline-collapsed-noicon`]:{fontSize:u,textAlign:"center"}}},[`> ${t}-item,
          > ${t}-item-group > ${t}-item-group-list > ${t}-item,
          > ${t}-item-group > ${t}-item-group-list > ${t}-submenu > ${t}-submenu-title,
          > ${t}-submenu > ${t}-submenu-title`]:{insetInlineStart:0,paddingInline:`calc(50% - ${lt(e.calc(u).div(2).equal())} - ${lt(d)})`,textOverflow:"clip",[`
            ${t}-submenu-arrow,
            ${t}-submenu-expand-icon
          `]:{opacity:0},[`${t}-item-icon, ${r}`]:{margin:0,fontSize:g,lineHeight:lt(i),"+ span":{display:"inline-block",opacity:0}}},[`${t}-item-icon, ${r}`]:{display:"inline-block"},"&-tooltip":{pointerEvents:"none",[`${t}-item-icon, ${r}`]:{display:"none"},"a, a:hover":{color:n}},[`${t}-item-group-title`]:Object.assign(Object.assign({},XC),{paddingInline:f})}}]},oke=ake,SH=e=>{const{componentCls:t,motionDurationSlow:r,motionDurationMid:i,motionEaseInOut:n,motionEaseOut:s,iconCls:a,iconSize:o,iconMarginInlineEnd:l}=e;return{[`${t}-item, ${t}-submenu-title`]:{position:"relative",display:"block",margin:0,whiteSpace:"nowrap",cursor:"pointer",transition:[`border-color ${r}`,`background ${r}`,`padding ${r} ${n}`].join(","),[`${t}-item-icon, ${a}`]:{minWidth:o,fontSize:o,transition:[`font-size ${i} ${s}`,`margin ${r} ${n}`,`color ${r}`].join(","),"+ span":{marginInlineStart:l,opacity:1,transition:[`opacity ${r} ${n}`,`margin ${r}`,`color ${r}`].join(",")}},[`${t}-item-icon`]:Object.assign({},nw()),[`&${t}-item-only-child`]:{[`> ${a}, > ${t}-item-icon`]:{marginInlineEnd:0}}},[`${t}-item-disabled, ${t}-submenu-disabled`]:{background:"none !important",cursor:"not-allowed","&::after":{borderColor:"transparent !important"},a:{color:"inherit !important"},[`> ${t}-submenu-title`]:{color:"inherit !important",cursor:"not-allowed"}}}},EH=e=>{const{componentCls:t,motionDurationSlow:r,motionEaseInOut:i,borderRadius:n,menuArrowSize:s,menuArrowOffset:a}=e;return{[`${t}-submenu`]:{"&-expand-icon, &-arrow":{position:"absolute",top:"50%",insetInlineEnd:e.margin,width:s,color:"currentcolor",transform:"translateY(-50%)",transition:`transform ${r} ${i}, opacity ${r}`},"&-arrow":{"&::before, &::after":{position:"absolute",width:e.calc(s).mul(.6).equal(),height:e.calc(s).mul(.15).equal(),backgroundColor:"currentcolor",borderRadius:n,transition:[`background ${r} ${i}`,`transform ${r} ${i}`,`top ${r} ${i}`,`color ${r} ${i}`].join(","),content:'""'},"&::before":{transform:`rotate(45deg) translateY(${lt(e.calc(a).mul(-1).equal())})`},"&::after":{transform:`rotate(-45deg) translateY(${lt(a)})`}}}}},lke=e=>{const{antCls:t,componentCls:r,fontSize:i,motionDurationSlow:n,motionDurationMid:s,motionEaseInOut:a,paddingXS:o,padding:l,colorSplit:c,lineWidth:d,zIndexPopup:u,borderRadiusLG:h,subMenuItemBorderRadius:f,menuArrowSize:p,menuArrowOffset:m,lineType:g,menuPanelMaskInset:v,groupTitleLineHeight:y,groupTitleFontSize:b}=e;return[{"":{[`${r}`]:Object.assign(Object.assign({},U3()),{"&-hidden":{display:"none"}})},[`${r}-submenu-hidden`]:{display:"none"}},{[r]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Vn(e)),U3()),{marginBottom:0,paddingInlineStart:0,fontSize:i,lineHeight:0,listStyle:"none",outline:"none",transition:`width ${n} cubic-bezier(0.2, 0, 0, 1) 0s`,"ul, ol":{margin:0,padding:0,listStyle:"none"},"&-overflow":{display:"flex",[`${r}-item`]:{flex:"none"}},[`${r}-item, ${r}-submenu, ${r}-submenu-title`]:{borderRadius:e.itemBorderRadius},[`${r}-item-group-title`]:{padding:`${lt(o)} ${lt(l)}`,fontSize:b,lineHeight:y,transition:`all ${n}`},[`&-horizontal ${r}-submenu`]:{transition:[`border-color ${n} ${a}`,`background ${n} ${a}`].join(",")},[`${r}-submenu, ${r}-submenu-inline`]:{transition:[`border-color ${n} ${a}`,`background ${n} ${a}`,`padding ${s} ${a}`].join(",")},[`${r}-submenu ${r}-sub`]:{cursor:"initial",transition:[`background ${n} ${a}`,`padding ${n} ${a}`].join(",")},[`${r}-title-content`]:{transition:`color ${n}`,[`> ${t}-typography-ellipsis-single-line`]:{display:"inline",verticalAlign:"unset"}},[`${r}-item a`]:{"&::before":{position:"absolute",inset:0,backgroundColor:"transparent",content:'""'}},[`${r}-item-divider`]:{overflow:"hidden",lineHeight:0,borderColor:c,borderStyle:g,borderWidth:0,borderTopWidth:d,marginBlock:d,padding:0,"&-dashed":{borderStyle:"dashed"}}}),SH(e)),{[`${r}-item-group`]:{[`${r}-item-group-list`]:{margin:0,padding:0,[`${r}-item, ${r}-submenu-title`]:{paddingInline:`${lt(e.calc(i).mul(2).equal())} ${lt(l)}`}}},"&-submenu":{"&-popup":{position:"absolute",zIndex:u,borderRadius:h,boxShadow:"none",transformOrigin:"0 0",[`&${r}-submenu`]:{background:"transparent"},"&::before":{position:"absolute",inset:`${lt(v)} 0 0`,zIndex:-1,width:"100%",height:"100%",opacity:0,content:'""'}},"&-placement-rightTop::before":{top:0,insetInlineStart:v},"\n          &-placement-leftTop,\n          &-placement-bottomRight,\n          ":{transformOrigin:"100% 0"},"\n          &-placement-leftBottom,\n          &-placement-topRight,\n          ":{transformOrigin:"100% 100%"},"\n          &-placement-rightBottom,\n          &-placement-topLeft,\n          ":{transformOrigin:"0 100%"},"\n          &-placement-bottomLeft,\n          &-placement-rightTop,\n          ":{transformOrigin:"0 0"},"\n          &-placement-leftTop,\n          &-placement-leftBottom\n          ":{paddingInlineEnd:e.paddingXS},"\n          &-placement-rightTop,\n          &-placement-rightBottom\n          ":{paddingInlineStart:e.paddingXS},"\n          &-placement-topRight,\n          &-placement-topLeft\n          ":{paddingBottom:e.paddingXS},"\n          &-placement-bottomRight,\n          &-placement-bottomLeft\n          ":{paddingTop:e.paddingXS},[`> ${r}`]:Object.assign(Object.assign(Object.assign({borderRadius:h},SH(e)),EH(e)),{[`${r}-item, ${r}-submenu > ${r}-submenu-title`]:{borderRadius:f},[`${r}-submenu-title::after`]:{transition:`transform ${n} ${a}`}})}}),EH(e)),{[`&-inline-collapsed ${r}-submenu-arrow,
        &-inline ${r}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateX(${lt(m)})`},"&::after":{transform:`rotate(45deg) translateX(${lt(e.calc(m).mul(-1).equal())})`}},[`${r}-submenu-open${r}-submenu-inline > ${r}-submenu-title > ${r}-submenu-arrow`]:{transform:`translateY(${lt(e.calc(p).mul(.2).mul(-1).equal())})`,"&::after":{transform:`rotate(-45deg) translateX(${lt(e.calc(m).mul(-1).equal())})`},"&::before":{transform:`rotate(45deg) translateX(${lt(m)})`}}})},{[`${t}-layout-header`]:{[r]:{lineHeight:"inherit"}}}]},cke=e=>{const{colorPrimary:t,colorError:r,colorTextDisabled:i,colorErrorBg:n,colorText:s,colorTextDescription:a,colorBgContainer:o,colorFillAlter:l,colorFillContent:c,lineWidth:d,lineWidthBold:u,controlItemBgActive:h,colorBgTextHover:f,controlHeightLG:p,lineHeight:m,colorBgElevated:g,marginXXS:v,padding:y,fontSize:b,controlHeightSM:x,fontSizeLG:S,colorTextLightSolid:w,colorErrorHover:E}=e,C=new Bn(w).setAlpha(.65).toRgbString();return{dropdownWidth:160,zIndexPopup:e.zIndexPopupBase+50,radiusItem:e.borderRadiusLG,itemBorderRadius:e.borderRadiusLG,radiusSubMenuItem:e.borderRadiusSM,subMenuItemBorderRadius:e.borderRadiusSM,colorItemText:s,itemColor:s,colorItemTextHover:s,itemHoverColor:s,colorItemTextHoverHorizontal:t,horizontalItemHoverColor:t,colorGroupTitle:a,groupTitleColor:a,colorItemTextSelected:t,itemSelectedColor:t,colorItemTextSelectedHorizontal:t,horizontalItemSelectedColor:t,colorItemBg:o,itemBg:o,colorItemBgHover:f,itemHoverBg:f,colorItemBgActive:c,itemActiveBg:h,colorSubItemBg:l,subMenuItemBg:l,colorItemBgSelected:h,itemSelectedBg:h,colorItemBgSelectedHorizontal:"transparent",horizontalItemSelectedBg:"transparent",colorActiveBarWidth:0,activeBarWidth:0,colorActiveBarHeight:u,activeBarHeight:u,colorActiveBarBorderSize:d,activeBarBorderWidth:d,colorItemTextDisabled:i,itemDisabledColor:i,colorDangerItemText:r,dangerItemColor:r,colorDangerItemTextHover:r,dangerItemHoverColor:r,colorDangerItemTextSelected:r,dangerItemSelectedColor:r,colorDangerItemBgActive:n,dangerItemActiveBg:n,colorDangerItemBgSelected:n,dangerItemSelectedBg:n,itemMarginInline:e.marginXXS,horizontalItemBorderRadius:0,horizontalItemHoverBg:"transparent",itemHeight:p,groupTitleLineHeight:m,collapsedWidth:p*2,popupBg:g,itemMarginBlock:v,itemPaddingInline:y,horizontalLineHeight:`${p*1.15}px`,iconSize:b,iconMarginInlineEnd:x-b,collapsedIconSize:S,groupTitleFontSize:b,darkItemDisabledColor:new Bn(w).setAlpha(.25).toRgbString(),darkItemColor:C,darkDangerItemColor:r,darkItemBg:"#001529",darkPopupBg:"#001529",darkSubMenuItemBg:"#000c17",darkItemSelectedColor:w,darkItemSelectedBg:t,darkDangerItemSelectedBg:r,darkItemHoverBg:"transparent",darkGroupTitleColor:C,darkItemHoverColor:w,darkDangerItemHoverColor:E,darkDangerItemSelectedColor:w,darkDangerItemActiveBg:r,itemWidth:""}},uke=e=>Object.assign(Object.assign({},e),{itemWidth:e.activeBarWidth?`calc(100% + ${e.activeBarBorderWidth}px)`:`calc(100% - ${e.itemMarginInline*2}px)`}),dke=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return sa("Menu",n=>{const{colorBgElevated:s,colorPrimary:a,colorTextLightSolid:o,controlHeightLG:l,fontSize:c,darkItemColor:d,darkDangerItemColor:u,darkItemBg:h,darkSubMenuItemBg:f,darkItemSelectedColor:p,darkItemSelectedBg:m,darkDangerItemSelectedBg:g,darkItemHoverBg:v,darkGroupTitleColor:y,darkItemHoverColor:b,darkItemDisabledColor:x,darkDangerItemHoverColor:S,darkDangerItemSelectedColor:w,darkDangerItemActiveBg:E}=n,C=n.calc(c).div(7).mul(5).equal(),T=zr(n,{menuArrowSize:C,menuHorizontalHeight:n.calc(l).mul(1.15).equal(),menuArrowOffset:n.calc(C).mul(.25).equal(),menuPanelMaskInset:-7,menuSubMenuBg:s,calc:n.calc}),A=zr(T,{itemColor:d,itemHoverColor:b,groupTitleColor:y,itemSelectedColor:p,itemBg:h,popupBg:h,subMenuItemBg:f,itemActiveBg:"transparent",itemSelectedBg:m,activeBarHeight:0,activeBarBorderWidth:0,itemHoverBg:v,itemDisabledColor:x,dangerItemColor:u,dangerItemHoverColor:S,dangerItemSelectedColor:w,dangerItemActiveBg:E,dangerItemSelectedBg:g,menuSubMenuBg:f,horizontalItemSelectedColor:o,horizontalItemSelectedBg:a});return[lke(T),rke(T),oke(T),wH(T,"light"),wH(A,"dark"),nke(T),Tre(T),Hv(T,"slide-up"),Hv(T,"slide-down"),vM(T,"zoom-big")]},cke,{deprecatedTokens:[["colorGroupTitle","groupTitleColor"],["radiusItem","itemBorderRadius"],["radiusSubMenuItem","subMenuItemBorderRadius"],["colorItemText","itemColor"],["colorItemTextHover","itemHoverColor"],["colorItemTextHoverHorizontal","horizontalItemHoverColor"],["colorItemTextSelected","itemSelectedColor"],["colorItemTextSelectedHorizontal","horizontalItemSelectedColor"],["colorItemTextDisabled","itemDisabledColor"],["colorDangerItemText","dangerItemColor"],["colorDangerItemTextHover","dangerItemHoverColor"],["colorDangerItemTextSelected","dangerItemSelectedColor"],["colorDangerItemBgActive","dangerItemActiveBg"],["colorDangerItemBgSelected","dangerItemSelectedBg"],["colorItemBg","itemBg"],["colorItemBgHover","itemHoverBg"],["colorSubItemBg","subMenuItemBg"],["colorItemBgActive","itemActiveBg"],["colorItemBgSelectedHorizontal","horizontalItemSelectedBg"],["colorActiveBarWidth","activeBarWidth"],["colorActiveBarHeight","activeBarHeight"],["colorActiveBarBorderSize","activeBarBorderWidth"],["colorItemBgSelected","itemSelectedBg"]],format:uke,injectStyle:r,unitless:{groupTitleLineHeight:!0}})(e,t)};var hke=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const fke=_.forwardRef((e,t)=>{var r,i;const n=_.useContext(aA),s=n||{},{getPrefixCls:a,getPopupContainer:o,direction:l,menu:c}=_.useContext(br),d=a(),{prefixCls:u,className:h,style:f,theme:p="light",expandIcon:m,_internalDisableMenuItemTitleTooltip:g,inlineCollapsed:v,siderCollapsed:y,items:b,children:x,rootClassName:S,mode:w,selectable:E,onClick:C,overflowedIndicatorPopupClassName:T}=e,A=hke(e,["prefixCls","className","style","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","items","children","rootClassName","mode","selectable","onClick","overflowedIndicatorPopupClassName"]),M=Pa(A,["collapsedWidth"]),P=ZNe(b)||x;(r=s.validator)===null||r===void 0||r.call(s,{mode:w});const I=ma(function(){var H;C==null||C.apply(void 0,arguments),(H=s.onClick)===null||H===void 0||H.call(s)}),R=s.mode||w,N=E??s.selectable,k=_.useMemo(()=>y!==void 0?y:v,[v,y]),O={horizontal:{motionName:`${d}-slide-up`},inline:Z3(d),other:{motionName:`${d}-zoom-big`}},D=a("menu",u||s.prefixCls),B=Mo(D),[z,F,V]=dke(D,B,!n),Y=Fe(`${D}-${p}`,c==null?void 0:c.className,h);let W;if(typeof m=="function")W=m;else if(m===null||m===!1)W=null;else if(s.expandIcon===null||s.expandIcon===!1)W=null;else{const H=m??s.expandIcon;W=nl(H,{className:Fe(`${D}-submenu-expand-icon`,Gl(H)?(i=H.props)===null||i===void 0?void 0:i.className:"")})}const X=_.useMemo(()=>({prefixCls:D,inlineCollapsed:k||!1,direction:l,firstLevel:!0,theme:p,mode:R,disableMenuItemTitleTooltip:g}),[D,k,l,g,p]);return z(_.createElement(aA.Provider,{value:null},_.createElement(sA.Provider,{value:X},_.createElement(cw,Object.assign({getPopupContainer:o,overflowedIndicator:_.createElement(Eie,null),overflowedIndicatorPopupClassName:Fe(D,`${D}-${p}`,T),mode:R,selectable:N,onClick:I},M,{inlineCollapsed:k,style:Object.assign(Object.assign({},c==null?void 0:c.style),f),className:Y,prefixCls:D,direction:l,defaultMotions:O,expandIcon:W,ref:t,rootClassName:Fe(S,F,s.rootClassName,V,B)}),P))))}),pke=fke,uw=_.forwardRef((e,t)=>{const r=_.useRef(null),i=_.useContext(xie);return _.useImperativeHandle(t,()=>({menu:r.current,focus:n=>{var s;(s=r.current)===null||s===void 0||s.focus(n)}})),_.createElement(pke,Object.assign({ref:r},e,i))});uw.Item=_ie;uw.SubMenu=Sie;uw.Divider=wie;uw.ItemGroup=CM;const mke=uw,gke=e=>{const{componentCls:t,menuCls:r,colorError:i,colorTextLightSolid:n}=e,s=`${r}-item`;return{[`${t}, ${t}-menu-submenu`]:{[`${r} ${s}`]:{[`&${s}-danger:not(${s}-disabled)`]:{color:i,"&:hover":{color:n,backgroundColor:i}}}}}},vke=gke,yke=e=>{const{componentCls:t,menuCls:r,zIndexPopup:i,dropdownArrowDistance:n,sizePopupArrow:s,antCls:a,iconCls:o,motionDurationMid:l,paddingBlock:c,fontSize:d,dropdownEdgeChildPadding:u,colorTextDisabled:h,fontSizeIcon:f,controlPaddingHorizontal:p,colorBgElevated:m}=e;return[{[t]:Object.assign(Object.assign({},Vn(e)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:i,display:"block","&::before":{position:"absolute",insetBlock:e.calc(s).div(2).sub(n).equal(),zIndex:-9999,opacity:1e-4,content:'""'},[`&-trigger${a}-btn`]:{[`& > ${o}-down, & > ${a}-btn-icon > ${o}-down`]:{fontSize:f}},[`${t}-wrap`]:{position:"relative",[`${a}-btn > ${o}-down`]:{fontSize:f},[`${o}-down::before`]:{transition:`transform ${l}`}},[`${t}-wrap-open`]:{[`${o}-down::before`]:{transform:"rotate(180deg)"}},"\n        &-hidden,\n        &-menu-hidden,\n        &-menu-submenu-hidden\n      ":{display:"none"},[`&${a}-slide-down-enter${a}-slide-down-enter-active${t}-placement-bottomLeft,
          &${a}-slide-down-appear${a}-slide-down-appear-active${t}-placement-bottomLeft,
          &${a}-slide-down-enter${a}-slide-down-enter-active${t}-placement-bottom,
          &${a}-slide-down-appear${a}-slide-down-appear-active${t}-placement-bottom,
          &${a}-slide-down-enter${a}-slide-down-enter-active${t}-placement-bottomRight,
          &${a}-slide-down-appear${a}-slide-down-appear-active${t}-placement-bottomRight`]:{animationName:zF},[`&${a}-slide-up-enter${a}-slide-up-enter-active${t}-placement-topLeft,
          &${a}-slide-up-appear${a}-slide-up-appear-active${t}-placement-topLeft,
          &${a}-slide-up-enter${a}-slide-up-enter-active${t}-placement-top,
          &${a}-slide-up-appear${a}-slide-up-appear-active${t}-placement-top,
          &${a}-slide-up-enter${a}-slide-up-enter-active${t}-placement-topRight,
          &${a}-slide-up-appear${a}-slide-up-appear-active${t}-placement-topRight`]:{animationName:FF},[`&${a}-slide-down-leave${a}-slide-down-leave-active${t}-placement-bottomLeft,
          &${a}-slide-down-leave${a}-slide-down-leave-active${t}-placement-bottom,
          &${a}-slide-down-leave${a}-slide-down-leave-active${t}-placement-bottomRight`]:{animationName:BF},[`&${a}-slide-up-leave${a}-slide-up-leave-active${t}-placement-topLeft,
          &${a}-slide-up-leave${a}-slide-up-leave-active${t}-placement-top,
          &${a}-slide-up-leave${a}-slide-up-leave-active${t}-placement-topRight`]:{animationName:jF}})},QF(e,m,{arrowPlacement:{top:!0,bottom:!0}}),{[`${t} ${r}`]:{position:"relative",margin:0},[`${r}-submenu-popup`]:{position:"absolute",zIndex:i,background:"transparent",boxShadow:"none",transformOrigin:"0 0","ul, li":{listStyle:"none",margin:0}},[`${t}, ${t}-menu-submenu`]:{[r]:Object.assign(Object.assign({padding:u,listStyleType:"none",backgroundColor:m,backgroundClip:"padding-box",borderRadius:e.borderRadiusLG,outline:"none",boxShadow:e.boxShadowSecondary},$3(e)),{[`${r}-item-group-title`]:{padding:`${lt(c)} ${lt(p)}`,color:e.colorTextDescription,transition:`all ${l}`},[`${r}-item`]:{position:"relative",display:"flex",alignItems:"center"},[`${r}-item-icon`]:{minWidth:d,marginInlineEnd:e.marginXS,fontSize:e.fontSizeSM},[`${r}-title-content`]:{flex:"auto","> a":{color:"inherit",transition:`all ${l}`,"&:hover":{color:"inherit"},"&::after":{position:"absolute",inset:0,content:'""'}}},[`${r}-item, ${r}-submenu-title`]:Object.assign(Object.assign({clear:"both",margin:0,padding:`${lt(c)} ${lt(p)}`,color:e.colorText,fontWeight:"normal",fontSize:d,lineHeight:e.lineHeight,cursor:"pointer",transition:`all ${l}`,borderRadius:e.borderRadiusSM,"&:hover, &-active":{backgroundColor:e.controlItemBgHover}},$3(e)),{"&-selected":{color:e.colorPrimary,backgroundColor:e.controlItemBgActive,"&:hover, &-active":{backgroundColor:e.controlItemBgActiveHover}},"&-disabled":{color:h,cursor:"not-allowed","&:hover":{color:h,backgroundColor:m,cursor:"not-allowed"},a:{pointerEvents:"none"}},"&-divider":{height:1,margin:`${lt(e.marginXXS)} 0`,overflow:"hidden",lineHeight:0,backgroundColor:e.colorSplit},[`${t}-menu-submenu-expand-icon`]:{position:"absolute",insetInlineEnd:e.paddingXS,[`${t}-menu-submenu-arrow-icon`]:{marginInlineEnd:"0 !important",color:e.colorTextDescription,fontSize:f,fontStyle:"normal"}}}),[`${r}-item-group-list`]:{margin:`0 ${lt(e.marginXS)}`,padding:0,listStyle:"none"},[`${r}-submenu-title`]:{paddingInlineEnd:e.calc(p).add(e.fontSizeSM).equal()},[`${r}-submenu-vertical`]:{position:"relative"},[`${r}-submenu${r}-submenu-disabled ${t}-menu-submenu-title`]:{[`&, ${t}-menu-submenu-arrow-icon`]:{color:h,backgroundColor:m,cursor:"not-allowed"}},[`${r}-submenu-selected ${t}-menu-submenu-title`]:{color:e.colorPrimary}})}},[Hv(e,"slide-up"),Hv(e,"slide-down"),tA(e,"move-up"),tA(e,"move-down"),vM(e,"zoom-big")]]},bke=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+50,paddingBlock:(e.controlHeight-e.fontSize*e.lineHeight)/2},wM({contentRadius:e.borderRadiusLG,limitVerticalRadius:!0})),KF(e)),xke=sa("Dropdown",e=>{const{marginXXS:t,sizePopupArrow:r,paddingXXS:i,componentCls:n}=e,s=zr(e,{menuCls:`${n}-menu`,dropdownArrowDistance:e.calc(r).div(2).add(t).equal(),dropdownEdgeChildPadding:i});return[yke(s),vke(s)]},bke),s4=e=>{const{menu:t,arrow:r,prefixCls:i,children:n,trigger:s,disabled:a,dropdownRender:o,getPopupContainer:l,overlayClassName:c,rootClassName:d,overlayStyle:u,open:h,onOpenChange:f,visible:p,onVisibleChange:m,mouseEnterDelay:g=.15,mouseLeaveDelay:v=.1,autoAdjustOverflow:y=!0,placement:b="",overlay:x,transitionName:S}=e,{getPopupContainer:w,getPrefixCls:E,direction:C,dropdown:T}=_.useContext(br);rw();const A=_.useMemo(()=>{const ne=E();return S!==void 0?S:b.includes("top")?`${ne}-slide-down`:`${ne}-slide-up`},[E,b,S]),M=_.useMemo(()=>b?b.includes("Center")?b.slice(0,b.indexOf("Center")):b:C==="rtl"?"bottomRight":"bottomLeft",[b,C]),P=E("dropdown",i),I=Mo(P),[R,N,k]=xke(P,I),[,O]=ia(),D=_.Children.only(n),B=nl(D,{className:Fe(`${P}-trigger`,{[`${P}-rtl`]:C==="rtl"},D.props.className),disabled:a}),z=a?[]:s;let F;z&&z.includes("contextMenu")&&(F=!0);const[V,Y]=Ka(!1,{value:h??p}),W=ma(ne=>{f==null||f(ne,{source:"trigger"}),m==null||m(ne),Y(ne)}),X=Fe(c,d,N,k,I,T==null?void 0:T.className,{[`${P}-rtl`]:C==="rtl"}),H=iie({arrowPointAtCenter:typeof r=="object"&&r.pointAtCenter,autoAdjustOverflow:y,offset:O.marginXXS,arrowWidth:r?O.sizePopupArrow:0,borderRadius:O.borderRadius}),ie=_.useCallback(()=>{t!=null&&t.selectable&&(t!=null&&t.multiple)||(f==null||f(!1,{source:"menu"}),Y(!1))},[t==null?void 0:t.selectable,t==null?void 0:t.multiple]),Q=()=>{let ne;return t!=null&&t.items?ne=_.createElement(mke,Object.assign({},t)):typeof x=="function"?ne=x():ne=x,o&&(ne=o(ne)),ne=_.Children.only(typeof ne=="string"?_.createElement("span",null,ne):ne),_.createElement(eke,{prefixCls:`${P}-menu`,rootClassName:k,expandIcon:_.createElement("span",{className:`${P}-menu-submenu-arrow`},_.createElement(QLe,{className:`${P}-menu-submenu-arrow-icon`})),mode:"vertical",selectable:!1,onClick:ie,validator:se=>{}},ne)},[Z,ee]=hM("Dropdown",u==null?void 0:u.zIndex);let re=_.createElement(sNe,Object.assign({alignPoint:F},Pa(e,["rootClassName"]),{mouseEnterDelay:g,mouseLeaveDelay:v,visible:V,builtinPlacements:H,arrow:!!r,overlayClassName:X,prefixCls:P,getPopupContainer:l||w,transitionName:A,trigger:z,overlay:Q,placement:M,onVisibleChange:W,overlayStyle:Object.assign(Object.assign(Object.assign({},T==null?void 0:T.style),u),{zIndex:Z})}),B);return Z&&(re=_.createElement(AF.Provider,{value:ee},re)),R(re)};function wke(e){return Object.assign(Object.assign({},e),{align:{overflow:{adjustX:!1,adjustY:!1}}})}const _ke=Lre(s4,"dropdown",e=>e,wke),Ske=e=>_.createElement(_ke,Object.assign({},e),_.createElement("span",null));s4._InternalPanelDoNotUseOrYouWillBeFired=Ske;const Cie=s4;var Eke=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],Cke=_.forwardRef(function(e,t){var r,i=e.prefixCls,n=i===void 0?"rc-checkbox":i,s=e.className,a=e.style,o=e.checked,l=e.disabled,c=e.defaultChecked,d=c===void 0?!1:c,u=e.type,h=u===void 0?"checkbox":u,f=e.title,p=e.onChange,m=hr(e,Eke),g=_.useRef(null),v=Ka(d,{value:o}),y=Pe(v,2),b=y[0],x=y[1];_.useImperativeHandle(t,function(){return{focus:function(){var C;(C=g.current)===null||C===void 0||C.focus()},blur:function(){var C;(C=g.current)===null||C===void 0||C.blur()},input:g.current}});var S=Fe(n,s,(r={},he(r,"".concat(n,"-checked"),b),he(r,"".concat(n,"-disabled"),l),r)),w=function(C){l||("checked"in e||x(C.target.checked),p==null||p({target:_e(_e({},e),{},{type:h,checked:C.target.checked}),stopPropagation:function(){C.stopPropagation()},preventDefault:function(){C.preventDefault()},nativeEvent:C.nativeEvent}))};return _.createElement("span",{className:S,title:f,style:a},_.createElement("input",ae({},m,{className:"".concat(n,"-input"),ref:g,onChange:w,disabled:l,checked:!!b,type:h})),_.createElement("span",{className:"".concat(n,"-inner")}))});const Aie=e=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:e,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),Tie=e=>({borderColor:e.hoverBorderColor,backgroundColor:e.hoverBg}),wL=e=>({borderColor:e.activeBorderColor,boxShadow:e.activeShadow,outline:0,backgroundColor:e.activeBg}),a4=e=>({color:e.colorTextDisabled,backgroundColor:e.colorBgContainerDisabled,borderColor:e.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"&:hover:not([disabled])":Object.assign({},Tie(zr(e,{hoverBorderColor:e.colorBorder,hoverBg:e.colorBgContainerDisabled})))}),Mie=e=>{const{paddingBlockLG:t,fontSizeLG:r,lineHeightLG:i,borderRadiusLG:n,paddingInlineLG:s}=e;return{padding:`${lt(t)} ${lt(s)}`,fontSize:r,lineHeight:i,borderRadius:n}},Pie=e=>({padding:`${lt(e.paddingBlockSM)} ${lt(e.paddingInlineSM)}`,borderRadius:e.borderRadiusSM}),AM=(e,t)=>{const{componentCls:r,colorError:i,colorWarning:n,errorActiveShadow:s,warningActiveShadow:a,colorErrorBorderHover:o,colorWarningBorderHover:l}=e;return{[`&-status-error:not(${t}-disabled):not(${t}-borderless)${t}`]:{borderColor:i,"&:hover":{borderColor:o},"&:focus, &:focus-within":Object.assign({},wL(zr(e,{activeBorderColor:i,activeShadow:s}))),[`${r}-prefix, ${r}-suffix`]:{color:i}},[`&-status-warning:not(${t}-disabled):not(${t}-borderless)${t}`]:{borderColor:n,"&:hover":{borderColor:l},"&:focus, &:focus-within":Object.assign({},wL(zr(e,{activeBorderColor:n,activeShadow:a}))),[`${r}-prefix, ${r}-suffix`]:{color:n}}}},TM=e=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${lt(e.paddingBlock)} ${lt(e.paddingInline)}`,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,backgroundColor:e.colorBgContainer,backgroundImage:"none",borderWidth:e.lineWidth,borderStyle:e.lineType,borderColor:e.colorBorder,borderRadius:e.borderRadius,transition:`all ${e.motionDurationMid}`},Aie(e.colorTextPlaceholder)),{"&:hover":Object.assign({},Tie(e)),"&:focus, &:focus-within":Object.assign({},wL(e)),"&-disabled, &[disabled]":Object.assign({},a4(e)),"&-borderless":{"&, &:hover, &:focus, &-focused, &-disabled, &[disabled]":{backgroundColor:"transparent",border:"none",boxShadow:"none"}},"textarea&":{maxWidth:"100%",height:"auto",minHeight:e.controlHeight,lineHeight:e.lineHeight,verticalAlign:"bottom",transition:`all ${e.motionDurationSlow}, height 0s`,resize:"vertical"},"&-lg":Object.assign({},Mie(e)),"&-sm":Object.assign({},Pie(e)),"&-rtl":{direction:"rtl"},"&-textarea-rtl":{direction:"rtl"}}),Iie=e=>{const{componentCls:t,antCls:r}=e;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:e.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${t}, &-lg > ${t}-group-addon`]:Object.assign({},Mie(e)),[`&-sm ${t}, &-sm > ${t}-group-addon`]:Object.assign({},Pie(e)),[`&-lg ${r}-select-single ${r}-select-selector`]:{height:e.controlHeightLG},[`&-sm ${r}-select-single ${r}-select-selector`]:{height:e.controlHeightSM},[`> ${t}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${t}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${lt(e.paddingInline)}`,color:e.colorText,fontWeight:"normal",fontSize:e.fontSize,textAlign:"center",backgroundColor:e.addonBg,border:`${lt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadius,transition:`all ${e.motionDurationSlow}`,lineHeight:1,[`${r}-select`]:{margin:`${lt(e.calc(e.paddingBlock).add(1).mul(-1).equal())} ${lt(e.calc(e.paddingInline).mul(-1).equal())}`,[`&${r}-select-single:not(${r}-select-customize-input):not(${r}-pagination-size-changer)`]:{[`${r}-select-selector`]:{backgroundColor:"inherit",border:`${lt(e.lineWidth)} ${e.lineType} transparent`,boxShadow:"none"}},"&-open, &-focused":{[`${r}-select-selector`]:{color:e.colorPrimary}}},[`${r}-cascader-picker`]:{margin:`-9px ${lt(e.calc(e.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${r}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}},[`${t}`]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${t}-search-with-button &`]:{zIndex:0}}},[`> ${t}:first-child, ${t}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${r}-select ${r}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${t}-affix-wrapper`]:{[`&:not(:first-child) ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${t}:last-child, ${t}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${r}-select ${r}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${t}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${t}-search &`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius}},[`&:not(:first-child), ${t}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${t}-group-compact`]:Object.assign(Object.assign({display:"block"},U3()),{[`${t}-group-addon, ${t}-group-wrap, > ${t}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:e.lineWidth,"&:hover":{zIndex:1},"&:focus":{zIndex:1}}},"& > *":{display:"inline-block",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${t}-affix-wrapper,
        & > ${t}-number-affix-wrapper,
        & > ${r}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal(),borderInlineEndWidth:e.lineWidth},[`${t}`]:{float:"none"},[`& > ${r}-select > ${r}-select-selector,
      & > ${r}-select-auto-complete ${t},
      & > ${r}-cascader-picker ${t},
      & > ${t}-group-wrapper ${t}`]:{borderInlineEndWidth:e.lineWidth,borderRadius:0,"&:hover":{zIndex:1},"&:focus":{zIndex:1}},[`& > ${r}-select-focused`]:{zIndex:1},[`& > ${r}-select > ${r}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${r}-select:first-child > ${r}-select-selector,
      & > ${r}-select-auto-complete:first-child ${t},
      & > ${r}-cascader-picker:first-child ${t}`]:{borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius},[`& > *:last-child,
      & > ${r}-select:last-child > ${r}-select-selector,
      & > ${r}-cascader-picker:last-child ${t},
      & > ${r}-cascader-picker-focused:last-child ${t}`]:{borderInlineEndWidth:e.lineWidth,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius},[`& > ${r}-select-auto-complete ${t}`]:{verticalAlign:"top"},[`${t}-group-wrapper + ${t}-group-wrapper`]:{marginInlineStart:e.calc(e.lineWidth).mul(-1).equal(),[`${t}-affix-wrapper`]:{borderRadius:0}},[`${t}-group-wrapper:not(:last-child)`]:{[`&${t}-search > ${t}-group`]:{[`& > ${t}-group-addon > ${t}-search-button`]:{borderRadius:0},[`& > ${t}`]:{borderStartStartRadius:e.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:e.borderRadius}}}})}},Ake=e=>{const{componentCls:t,controlHeightSM:r,lineWidth:i,calc:n}=e,s=16,a=n(r).sub(n(i).mul(2)).sub(s).div(2).equal();return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},Vn(e)),TM(e)),AM(e,t)),{'&[type="color"]':{height:e.controlHeight,[`&${t}-lg`]:{height:e.controlHeightLG},[`&${t}-sm`]:{height:r,paddingTop:a,paddingBottom:a}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{"-webkit-appearance":"none"}})}},Tke=e=>{const{componentCls:t}=e;return{[`${t}-clear-icon`]:{margin:0,color:e.colorTextQuaternary,fontSize:e.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"&:hover":{color:e.colorTextTertiary},"&:active":{color:e.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${lt(e.inputAffixPadding)}`}}}},Mke=e=>{const{componentCls:t,inputAffixPadding:r,colorTextDescription:i,motionDurationSlow:n,colorIcon:s,colorIconHover:a,iconCls:o}=e;return{[`${t}-affix-wrapper`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TM(e)),{display:"inline-flex",[`&:not(${t}-affix-wrapper-disabled):hover`]:{zIndex:1,[`${t}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},"&-disabled":{[`${t}[disabled]`]:{background:"transparent"}},[`> input${t}`]:{padding:0,fontSize:"inherit",border:"none",borderRadius:0,outline:"none","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${t}`]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:e.paddingXS}},"&-show-count-suffix":{color:i},"&-show-count-has-suffix":{marginInlineEnd:e.paddingXXS},"&-prefix":{marginInlineEnd:r},"&-suffix":{marginInlineStart:r}}}),Tke(e)),{[`${o}${t}-password-icon`]:{color:s,cursor:"pointer",transition:`all ${n}`,"&:hover":{color:a}}}),AM(e,`${t}-affix-wrapper`))}},Pke=e=>{const{componentCls:t,colorError:r,colorWarning:i,borderRadiusLG:n,borderRadiusSM:s}=e;return{[`${t}-group`]:Object.assign(Object.assign(Object.assign({},Vn(e)),Iie(e)),{"&-rtl":{direction:"rtl"},"&-wrapper":{display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${t}-group-addon`]:{borderRadius:n,fontSize:e.fontSizeLG}},"&-sm":{[`${t}-group-addon`]:{borderRadius:s}},"&-status-error":{[`${t}-group-addon`]:{color:r,borderColor:r}},"&-status-warning":{[`${t}-group-addon`]:{color:i,borderColor:i}},"&-disabled":{[`${t}-group-addon`]:Object.assign({},a4(e))},[`&:not(${t}-compact-first-item):not(${t}-compact-last-item)${t}-compact-item`]:{[`${t}, ${t}-group-addon`]:{borderRadius:0}},[`&:not(${t}-compact-last-item)${t}-compact-first-item`]:{[`${t}, ${t}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${t}-compact-first-item)${t}-compact-last-item`]:{[`${t}, ${t}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}})}},Ike=e=>{const{componentCls:t,antCls:r}=e,i=`${t}-search`;return{[i]:{[`${t}`]:{"&:hover, &:focus":{borderColor:e.colorPrimaryHover,[`+ ${t}-group-addon ${i}-button:not(${r}-btn-primary)`]:{borderInlineStartColor:e.colorPrimaryHover}}},[`${t}-affix-wrapper`]:{borderRadius:0},[`${t}-lg`]:{lineHeight:e.calc(e.lineHeightLG).sub(2e-4).equal({unit:!1})},[`> ${t}-group`]:{[`> ${t}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${i}-button`]:{paddingTop:0,paddingBottom:0,borderStartStartRadius:0,borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius,borderEndStartRadius:0,boxShadow:"none"},[`${i}-button:not(${r}-btn-primary)`]:{color:e.colorTextDescription,"&:hover":{color:e.colorPrimaryHover},"&:active":{color:e.colorPrimaryActive},[`&${r}-btn-loading::before`]:{insetInlineStart:0,insetInlineEnd:0,insetBlockStart:0,insetBlockEnd:0}}}},[`${i}-button`]:{height:e.controlHeight,"&:hover, &:focus":{zIndex:1}},[`&-large ${i}-button`]:{height:e.controlHeightLG},[`&-small ${i}-button`]:{height:e.controlHeightSM},"&-rtl":{direction:"rtl"},[`&${t}-compact-item`]:{[`&:not(${t}-compact-last-item)`]:{[`${t}-group-addon`]:{[`${t}-search-button`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${t}-compact-first-item)`]:{[`${t},${t}-affix-wrapper`]:{borderRadius:0}},[`> ${t}-group-addon ${t}-search-button,
        > ${t},
        ${t}-affix-wrapper`]:{"&:hover,&:focus,&:active":{zIndex:2}},[`> ${t}-affix-wrapper-focused`]:{zIndex:2}}}}},Rke=e=>{const{componentCls:t,paddingLG:r}=e,i=`${t}-textarea`;return{[i]:{position:"relative","&-show-count":{[`> ${t}`]:{height:"100%"},[`${t}-data-count`]:{position:"absolute",bottom:e.calc(e.fontSize).mul(e.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:e.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},"&-allow-clear":{[`> ${t}`]:{paddingInlineEnd:r}},[`&-affix-wrapper${i}-has-feedback`]:{[`${t}`]:{paddingInlineEnd:r}},[`&-affix-wrapper${t}-affix-wrapper`]:{padding:0,[`> textarea${t}`]:{fontSize:"inherit",border:"none",outline:"none","&:focus":{boxShadow:"none !important"}},[`${t}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${t}-clear-icon`]:{position:"absolute",insetInlineEnd:e.paddingXS,insetBlockStart:e.paddingXS},[`${i}-suffix`]:{position:"absolute",top:0,insetInlineEnd:e.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}}}}},Dke=e=>{const{componentCls:t}=e;return{[`${t}-out-of-range`]:{[`&, & input, & textarea, ${t}-show-count-suffix, ${t}-data-count`]:{color:e.colorError}}}};function Rie(e){return zr(e,{inputAffixPadding:e.paddingXXS})}const Die=e=>{const{controlHeight:t,fontSize:r,lineHeight:i,lineWidth:n,controlHeightSM:s,controlHeightLG:a,fontSizeLG:o,lineHeightLG:l,paddingSM:c,controlPaddingHorizontalSM:d,controlPaddingHorizontal:u,colorFillAlter:h,colorPrimaryHover:f,colorPrimary:p,controlOutlineWidth:m,controlOutline:g,colorErrorOutline:v,colorWarningOutline:y}=e;return{paddingBlock:Math.max(Math.round((t-r*i)/2*10)/10-n,0),paddingBlockSM:Math.max(Math.round((s-r*i)/2*10)/10-n,0),paddingBlockLG:Math.ceil((a-o*l)/2*10)/10-n,paddingInline:c-n,paddingInlineSM:d-n,paddingInlineLG:u-n,addonBg:h,activeBorderColor:p,hoverBorderColor:f,activeShadow:`0 0 0 ${m}px ${g}`,errorActiveShadow:`0 0 0 ${m}px ${v}`,warningActiveShadow:`0 0 0 ${m}px ${y}`,hoverBg:"",activeBg:""}},o4=sa("Input",e=>{const t=zr(e,Rie(e));return[Ake(t),Rke(t),Mke(t),Pke(t),Ike(t),Dke(t),gM(t)]},Die);function Oke(e,t,r){var i=r||{},n=i.noTrailing,s=n===void 0?!1:n,a=i.noLeading,o=a===void 0?!1:a,l=i.debounceMode,c=l===void 0?void 0:l,d,u=!1,h=0;function f(){d&&clearTimeout(d)}function p(g){var v=g||{},y=v.upcomingOnly,b=y===void 0?!1:y;f(),u=!b}function m(){for(var g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];var b=this,x=Date.now()-h;if(u)return;function S(){h=Date.now(),t.apply(b,v)}function w(){d=void 0}!o&&c&&!d&&S(),f(),c===void 0&&x>e?o?(h=Date.now(),s||(d=setTimeout(c?w:S,e))):S():s!==!0&&(d=setTimeout(c?w:S,c===void 0?e-x:e))}return m.cancel=p,m}function Lke(e,t,r){var i=r||{},n=i.atBegin,s=n===void 0?!1:n;return Oke(e,t,{debounceMode:s!==!1})}const Nke=e=>{const{checkboxCls:t}=e,r=`${t}-wrapper`;return[{[`${t}-group`]:Object.assign(Object.assign({},Vn(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[r]:Object.assign(Object.assign({},Vn(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${r}`]:{marginInlineStart:0},[`&${r}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[t]:Object.assign(Object.assign({},Vn(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:e.borderRadiusSM,alignSelf:"center",[`${t}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${t}-inner`]:Object.assign({},wF(e))},[`${t}-inner`]:{boxSizing:"border-box",display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${lt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:e.calc(e.checkboxSize).div(14).mul(5).equal(),height:e.calc(e.checkboxSize).div(14).mul(8).equal(),border:`${lt(e.lineWidthBold)} solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[`
        ${r}:not(${r}-disabled),
        ${t}:not(${t}-disabled)
      `]:{[`&:hover ${t}-inner`]:{borderColor:e.colorPrimary}},[`${r}:not(${r}-disabled)`]:{[`&:hover ${t}-checked:not(${t}-disabled) ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${t}-checked:not(${t}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${t}-checked`]:{[`${t}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}}},[`
        ${r}-checked:not(${r}-disabled),
        ${t}-checked:not(${t}-disabled)
      `]:{[`&:hover ${t}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"}}},{[t]:{"&-indeterminate":{[`${t}-inner`]:{backgroundColor:e.colorBgContainer,borderColor:e.colorBorder,"&:after":{top:"50%",insetInlineStart:"50%",width:e.calc(e.fontSizeLG).div(2).equal(),height:e.calc(e.fontSizeLG).div(2).equal(),backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}}}}},{[`${r}-disabled`]:{cursor:"not-allowed"},[`${t}-disabled`]:{[`&, ${t}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${t}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${t}-indeterminate ${t}-inner::after`]:{background:e.colorTextDisabled}}}]};function kke(e,t){const r=zr(t,{checkboxCls:`.${e}`,checkboxSize:t.controlInteractiveSize});return[Nke(r)]}const Oie=sa("Checkbox",(e,t)=>{let{prefixCls:r}=t;return[kke(r,e)]}),zke=Ge.createContext(null),Lie=zke;var Bke=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Fke=(e,t)=>{var r;const{prefixCls:i,className:n,rootClassName:s,children:a,indeterminate:o=!1,style:l,onMouseEnter:c,onMouseLeave:d,skipGroup:u=!1,disabled:h}=e,f=Bke(e,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]),{getPrefixCls:p,direction:m,checkbox:g}=_.useContext(br),v=_.useContext(Lie),{isFormItemInput:y}=_.useContext(_o),b=_.useContext(Jh),x=(r=(v==null?void 0:v.disabled)||h)!==null&&r!==void 0?r:b,S=_.useRef(f.value);_.useEffect(()=>{v==null||v.registerValue(f.value)},[]),_.useEffect(()=>{if(!u)return f.value!==S.current&&(v==null||v.cancelValue(S.current),v==null||v.registerValue(f.value),S.current=f.value),()=>v==null?void 0:v.cancelValue(f.value)},[f.value]);const w=p("checkbox",i),E=Mo(w),[C,T,A]=Oie(w,E),M=Object.assign({},f);v&&!u&&(M.onChange=function(){f.onChange&&f.onChange.apply(f,arguments),v.toggleOption&&v.toggleOption({label:a,value:f.value})},M.name=v.name,M.checked=v.value.includes(f.value));const P=Fe(`${w}-wrapper`,{[`${w}-rtl`]:m==="rtl",[`${w}-wrapper-checked`]:M.checked,[`${w}-wrapper-disabled`]:x,[`${w}-wrapper-in-form-item`]:y},g==null?void 0:g.className,n,s,A,E,T),I=Fe({[`${w}-indeterminate`]:o},MF,T),R=o?"mixed":void 0;return C(_.createElement(ore,{component:"Checkbox",disabled:x},_.createElement("label",{className:P,style:Object.assign(Object.assign({},g==null?void 0:g.style),l),onMouseEnter:c,onMouseLeave:d},_.createElement(Cke,Object.assign({"aria-checked":R},M,{prefixCls:w,className:I,disabled:x,ref:t})),a!==void 0&&_.createElement("span",null,a))))},jke=_.forwardRef(Fke),Nie=jke;var Vke=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Uke=(e,t)=>{const{defaultValue:r,children:i,options:n=[],prefixCls:s,className:a,rootClassName:o,style:l,onChange:c}=e,d=Vke(e,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]),{getPrefixCls:u,direction:h}=_.useContext(br),[f,p]=_.useState(d.value||r||[]),[m,g]=_.useState([]);_.useEffect(()=>{"value"in d&&p(d.value||[])},[d.value]);const v=_.useMemo(()=>n.map(N=>typeof N=="string"||typeof N=="number"?{label:N,value:N}:N),[n]),y=N=>{g(k=>k.filter(O=>O!==N))},b=N=>{g(k=>[].concat(ft(k),[N]))},x=N=>{const k=f.indexOf(N.value),O=ft(f);k===-1?O.push(N.value):O.splice(k,1),"value"in d||p(O),c==null||c(O.filter(D=>m.includes(D)).sort((D,B)=>{const z=v.findIndex(V=>V.value===D),F=v.findIndex(V=>V.value===B);return z-F}))},S=u("checkbox",s),w=`${S}-group`,E=Mo(S),[C,T,A]=Oie(S,E),M=Pa(d,["value","disabled"]),P=n.length?v.map(N=>_.createElement(Nie,{prefixCls:S,key:N.value.toString(),disabled:"disabled"in N?N.disabled:d.disabled,value:N.value,checked:f.includes(N.value),onChange:N.onChange,className:`${w}-item`,style:N.style,title:N.title,id:N.id,required:N.required},N.label)):i,I={toggleOption:x,value:f,disabled:d.disabled,name:d.name,registerValue:b,cancelValue:y},R=Fe(w,{[`${w}-rtl`]:h==="rtl"},a,o,A,E,T);return C(_.createElement("div",Object.assign({className:R,style:l},M,{ref:t}),_.createElement(Lie.Provider,{value:I},P)))},$ke=_.forwardRef(Uke),Hke=_.memo($ke),l4=Nie;l4.Group=Hke;l4.__ANT_CHECKBOX=!0;const kie=l4,Wke=_.createContext({}),zie=Wke,Gke=e=>{const{componentCls:t}=e;return{[t]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},qke=e=>{const{componentCls:t}=e;return{[t]:{position:"relative",maxWidth:"100%",minHeight:1}}},Xke=(e,t)=>{const{componentCls:r,gridColumns:i}=e,n={};for(let s=i;s>=0;s--)s===0?(n[`${r}${t}-${s}`]={display:"none"},n[`${r}-push-${s}`]={insetInlineStart:"auto"},n[`${r}-pull-${s}`]={insetInlineEnd:"auto"},n[`${r}${t}-push-${s}`]={insetInlineStart:"auto"},n[`${r}${t}-pull-${s}`]={insetInlineEnd:"auto"},n[`${r}${t}-offset-${s}`]={marginInlineStart:0},n[`${r}${t}-order-${s}`]={order:0}):(n[`${r}${t}-${s}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${s/i*100}%`,maxWidth:`${s/i*100}%`}],n[`${r}${t}-push-${s}`]={insetInlineStart:`${s/i*100}%`},n[`${r}${t}-pull-${s}`]={insetInlineEnd:`${s/i*100}%`},n[`${r}${t}-offset-${s}`]={marginInlineStart:`${s/i*100}%`},n[`${r}${t}-order-${s}`]={order:s});return n},_L=(e,t)=>Xke(e,t),Yke=(e,t,r)=>({[`@media (min-width: ${lt(t)})`]:Object.assign({},_L(e,r))}),Kke=()=>({}),Qke=()=>({}),Zke=sa("Grid",Gke,Kke),Jke=sa("Grid",e=>{const t=zr(e,{gridColumns:24}),r={"-sm":t.screenSMMin,"-md":t.screenMDMin,"-lg":t.screenLGMin,"-xl":t.screenXLMin,"-xxl":t.screenXXLMin};return[qke(t),_L(t,""),_L(t,"-xs"),Object.keys(r).map(i=>Yke(t,r[i],i)).reduce((i,n)=>Object.assign(Object.assign({},i),n),{})]},Qke);var eze=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function tze(e){return typeof e=="number"?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}const rze=["xs","sm","md","lg","xl","xxl"],ize=_.forwardRef((e,t)=>{const{getPrefixCls:r,direction:i}=_.useContext(br),{gutter:n,wrap:s}=_.useContext(zie),{prefixCls:a,span:o,order:l,offset:c,push:d,pull:u,className:h,children:f,flex:p,style:m}=e,g=eze(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),v=r("col",a),[y,b,x]=Jke(v);let S={};rze.forEach(C=>{let T={};const A=e[C];typeof A=="number"?T.span=A:typeof A=="object"&&(T=A||{}),delete g[C],S=Object.assign(Object.assign({},S),{[`${v}-${C}-${T.span}`]:T.span!==void 0,[`${v}-${C}-order-${T.order}`]:T.order||T.order===0,[`${v}-${C}-offset-${T.offset}`]:T.offset||T.offset===0,[`${v}-${C}-push-${T.push}`]:T.push||T.push===0,[`${v}-${C}-pull-${T.pull}`]:T.pull||T.pull===0,[`${v}-${C}-flex-${T.flex}`]:T.flex||T.flex==="auto",[`${v}-rtl`]:i==="rtl"})});const w=Fe(v,{[`${v}-${o}`]:o!==void 0,[`${v}-order-${l}`]:l,[`${v}-offset-${c}`]:c,[`${v}-push-${d}`]:d,[`${v}-pull-${u}`]:u},h,S,b,x),E={};if(n&&n[0]>0){const C=n[0]/2;E.paddingLeft=C,E.paddingRight=C}return p&&(E.flex=tze(p),s===!1&&!E.minWidth&&(E.minWidth=0)),y(_.createElement("div",Object.assign({},g,{style:Object.assign(Object.assign({},E),m),className:w,ref:t}),f))}),Bie=ize;var nze=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function CH(e,t){const[r,i]=_.useState(typeof e=="string"?e:""),n=()=>{if(typeof e=="string"&&i(e),typeof e=="object")for(let s=0;s<ex.length;s++){const a=ex[s];if(!t[a])continue;const o=e[a];if(o!==void 0){i(o);return}}};return _.useEffect(()=>{n()},[JSON.stringify(e),t]),r}const sze=_.forwardRef((e,t)=>{const{prefixCls:r,justify:i,align:n,className:s,style:a,children:o,gutter:l=0,wrap:c}=e,d=nze(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:u,direction:h}=_.useContext(br),[f,p]=_.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[m,g]=_.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),v=CH(n,m),y=CH(i,m),b=_.useRef(l),x=wLe();_.useEffect(()=>{const O=x.subscribe(D=>{g(D);const B=b.current||0;(!Array.isArray(B)&&typeof B=="object"||Array.isArray(B)&&(typeof B[0]=="object"||typeof B[1]=="object"))&&p(D)});return()=>x.unsubscribe(O)},[]);const S=()=>{const O=[void 0,void 0];return(Array.isArray(l)?l:[l,void 0]).forEach((B,z)=>{if(typeof B=="object")for(let F=0;F<ex.length;F++){const V=ex[F];if(f[V]&&B[V]!==void 0){O[z]=B[V];break}}else O[z]=B}),O},w=u("row",r),[E,C,T]=Zke(w),A=S(),M=Fe(w,{[`${w}-no-wrap`]:c===!1,[`${w}-${y}`]:y,[`${w}-${v}`]:v,[`${w}-rtl`]:h==="rtl"},s,C,T),P={},I=A[0]!=null&&A[0]>0?A[0]/-2:void 0;I&&(P.marginLeft=I,P.marginRight=I),[,P.rowGap]=A;const[R,N]=A,k=_.useMemo(()=>({gutter:[R,N],wrap:c}),[R,N,c]);return E(_.createElement(zie.Provider,{value:k},_.createElement("div",Object.assign({},d,{className:M,style:Object.assign(Object.assign({},P),a),ref:t}),o)))}),aze=sze;var oze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"};const lze=oze;var cze=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:lze}))};const uze=_.forwardRef(cze);function SL(){return typeof BigInt=="function"}function Fie(e){return!e&&e!==0&&!Number.isNaN(e)||!String(e).trim()}function ap(e){var t=e.trim(),r=t.startsWith("-");r&&(t=t.slice(1)),t=t.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,""),t.startsWith(".")&&(t="0".concat(t));var i=t||"0",n=i.split("."),s=n[0]||"0",a=n[1]||"0";s==="0"&&a==="0"&&(r=!1);var o=r?"-":"";return{negative:r,negativeStr:o,trimStr:i,integerStr:s,decimalStr:a,fullStr:"".concat(o).concat(i)}}function c4(e){var t=String(e);return!Number.isNaN(Number(t))&&t.includes("e")}function Uf(e){var t=String(e);if(c4(e)){var r=Number(t.slice(t.indexOf("e-")+2)),i=t.match(/\.(\d+)/);return i!=null&&i[1]&&(r+=i[1].length),r}return t.includes(".")&&u4(t)?t.length-t.indexOf(".")-1:0}function MM(e){var t=String(e);if(c4(e)){if(e>Number.MAX_SAFE_INTEGER)return String(SL()?BigInt(e).toString():Number.MAX_SAFE_INTEGER);if(e<Number.MIN_SAFE_INTEGER)return String(SL()?BigInt(e).toString():Number.MIN_SAFE_INTEGER);t=e.toFixed(Uf(t))}return ap(t).fullStr}function u4(e){return typeof e=="number"?!Number.isNaN(e):e?/^\s*-?\d+(\.\d+)?\s*$/.test(e)||/^\s*-?\d+\.\s*$/.test(e)||/^\s*-?\.\d+\s*$/.test(e):!1}var dze=function(){function e(t){if(Ds(this,e),he(this,"origin",""),he(this,"negative",void 0),he(this,"integer",void 0),he(this,"decimal",void 0),he(this,"decimalLen",void 0),he(this,"empty",void 0),he(this,"nan",void 0),Fie(t)){this.empty=!0;return}if(this.origin=String(t),t==="-"||Number.isNaN(t)){this.nan=!0;return}var r=t;if(c4(r)&&(r=Number(r)),r=typeof r=="string"?r:MM(r),u4(r)){var i=ap(r);this.negative=i.negative;var n=i.trimStr.split(".");this.integer=BigInt(n[0]);var s=n[1]||"0";this.decimal=BigInt(s),this.decimalLen=s.length}else this.nan=!0}return Os(e,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(r){var i="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(r,"0"));return BigInt(i)}},{key:"negate",value:function(){var r=new e(this.toString());return r.negative=!r.negative,r}},{key:"cal",value:function(r,i,n){var s=Math.max(this.getDecimalStr().length,r.getDecimalStr().length),a=this.alignDecimal(s),o=r.alignDecimal(s),l=i(a,o).toString(),c=n(s),d=ap(l),u=d.negativeStr,h=d.trimStr,f="".concat(u).concat(h.padStart(c+1,"0"));return new e("".concat(f.slice(0,-c),".").concat(f.slice(-c)))}},{key:"add",value:function(r){if(this.isInvalidate())return new e(r);var i=new e(r);return i.isInvalidate()?this:this.cal(i,function(n,s){return n+s},function(n){return n})}},{key:"multi",value:function(r){var i=new e(r);return this.isInvalidate()||i.isInvalidate()?new e(NaN):this.cal(i,function(n,s){return n*s},function(n){return n*2})}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(r){return this.toString()===(r==null?void 0:r.toString())}},{key:"lessEquals",value:function(r){return this.add(r.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return r?this.isInvalidate()?"":ap("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),e}(),hze=function(){function e(t){if(Ds(this,e),he(this,"origin",""),he(this,"number",void 0),he(this,"empty",void 0),Fie(t)){this.empty=!0;return}this.origin=String(t),this.number=Number(t)}return Os(e,[{key:"negate",value:function(){return new e(-this.toNumber())}},{key:"add",value:function(r){if(this.isInvalidate())return new e(r);var i=Number(r);if(Number.isNaN(i))return this;var n=this.number+i;if(n>Number.MAX_SAFE_INTEGER)return new e(Number.MAX_SAFE_INTEGER);if(n<Number.MIN_SAFE_INTEGER)return new e(Number.MIN_SAFE_INTEGER);var s=Math.max(Uf(this.number),Uf(i));return new e(n.toFixed(s))}},{key:"multi",value:function(r){var i=Number(r);if(this.isInvalidate()||Number.isNaN(i))return new e(NaN);var n=this.number*i;if(n>Number.MAX_SAFE_INTEGER)return new e(Number.MAX_SAFE_INTEGER);if(n<Number.MIN_SAFE_INTEGER)return new e(Number.MIN_SAFE_INTEGER);var s=Math.max(Uf(this.number),Uf(i));return new e(n.toFixed(s))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(r){return this.toNumber()===(r==null?void 0:r.toNumber())}},{key:"lessEquals",value:function(r){return this.add(r.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return r?this.isInvalidate()?"":MM(this.number):this.origin}}]),e}();function wl(e){return SL()?new dze(e):new hze(e)}function xE(e,t,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e==="")return"";var n=ap(e),s=n.negativeStr,a=n.integerStr,o=n.decimalStr,l="".concat(t).concat(o),c="".concat(s).concat(a);if(r>=0){var d=Number(o[r]);if(d>=5&&!i){var u=wl(e).add("".concat(s,"0.").concat("0".repeat(r)).concat(10-d));return xE(u.toString(),t,r,i)}return r===0?c:"".concat(c).concat(t).concat(o.padEnd(r,"0").slice(0,r))}return l===".0"?c:"".concat(c).concat(l)}function Pm(e){return!!(e.addonBefore||e.addonAfter)}function NI(e){return!!(e.prefix||e.suffix||e.allowClear)}function oA(e,t,r,i){if(r){var n=t;if(t.type==="click"){var s=e.cloneNode(!0);n=Object.create(t,{target:{value:s},currentTarget:{value:s}}),s.value="",r(n);return}if(i!==void 0){var a=e.cloneNode(!0);n=Object.create(t,{target:{value:a},currentTarget:{value:a}}),a.type!=="file"&&(a.value=i),r(n);return}r(n)}}function jie(e,t){if(e){e.focus(t);var r=t||{},i=r.cursor;if(i){var n=e.value.length;switch(i){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(n,n);break;default:e.setSelectionRange(0,n)}}}}var d4=function(t){var r,i,n=t.inputElement,s=t.prefixCls,a=t.prefix,o=t.suffix,l=t.addonBefore,c=t.addonAfter,d=t.className,u=t.style,h=t.disabled,f=t.readOnly,p=t.focused,m=t.triggerFocus,g=t.allowClear,v=t.value,y=t.handleReset,b=t.hidden,x=t.classes,S=t.classNames,w=t.dataAttrs,E=t.styles,C=t.components,T=(C==null?void 0:C.affixWrapper)||"span",A=(C==null?void 0:C.groupWrapper)||"span",M=(C==null?void 0:C.wrapper)||"span",P=(C==null?void 0:C.groupAddon)||"span",I=_.useRef(null),R=function(H){var ie;(ie=I.current)!==null&&ie!==void 0&&ie.contains(H.target)&&(m==null||m())},N=function(){var H;if(!g)return null;var ie=!h&&!f&&v,Q="".concat(s,"-clear-icon"),Z=vr(g)==="object"&&g!==null&&g!==void 0&&g.clearIcon?g.clearIcon:"✖";return Ge.createElement("span",{onClick:y,onMouseDown:function(re){return re.preventDefault()},className:Fe(Q,(H={},he(H,"".concat(Q,"-hidden"),!ie),he(H,"".concat(Q,"-has-suffix"),!!o),H)),role:"button",tabIndex:-1},Z)},k=_.cloneElement(n,{value:v,hidden:b,className:Fe((r=n.props)===null||r===void 0?void 0:r.className,!NI(t)&&!Pm(t)&&d)||null,style:_e(_e({},(i=n.props)===null||i===void 0?void 0:i.style),!NI(t)&&!Pm(t)?u:{})});if(NI(t)){var O,D="".concat(s,"-affix-wrapper"),B=Fe(D,(O={},he(O,"".concat(D,"-disabled"),h),he(O,"".concat(D,"-focused"),p),he(O,"".concat(D,"-readonly"),f),he(O,"".concat(D,"-input-with-clear-btn"),o&&g&&v),O),!Pm(t)&&d,x==null?void 0:x.affixWrapper,S==null?void 0:S.affixWrapper),z=(o||g)&&Ge.createElement("span",{className:Fe("".concat(s,"-suffix"),S==null?void 0:S.suffix),style:E==null?void 0:E.suffix},N(),o);k=Ge.createElement(T,ae({className:B,style:_e(_e({},Pm(t)?void 0:u),E==null?void 0:E.affixWrapper),hidden:!Pm(t)&&b,onClick:R},w==null?void 0:w.affixWrapper,{ref:I}),a&&Ge.createElement("span",{className:Fe("".concat(s,"-prefix"),S==null?void 0:S.prefix),style:E==null?void 0:E.prefix},a),_.cloneElement(n,{value:v,hidden:null}),z)}if(Pm(t)){var F="".concat(s,"-group"),V="".concat(F,"-addon"),Y=Fe("".concat(s,"-wrapper"),F,x==null?void 0:x.wrapper),W=Fe("".concat(s,"-group-wrapper"),d,x==null?void 0:x.group);return Ge.createElement(A,{className:W,style:u,hidden:b},Ge.createElement(M,{className:Y},l&&Ge.createElement(P,{className:V},l),_.cloneElement(k,{hidden:null}),c&&Ge.createElement(P,{className:V},c)))}return k},fze=["show"];function Vie(e,t){return _.useMemo(function(){var r={};t&&(r.show=vr(t)==="object"&&t.formatter?t.formatter:!!t),r=_e(_e({},r),e);var i=r,n=i.show,s=hr(i,fze);return _e(_e({},s),{},{show:!!n,showFormatter:typeof n=="function"?n:void 0,strategy:s.strategy||function(a){return a.length}})},[e,t])}var pze=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],mze=_.forwardRef(function(e,t){var r=e.autoComplete,i=e.onChange,n=e.onFocus,s=e.onBlur,a=e.onPressEnter,o=e.onKeyDown,l=e.prefixCls,c=l===void 0?"rc-input":l,d=e.disabled,u=e.htmlSize,h=e.className,f=e.maxLength,p=e.suffix,m=e.showCount,g=e.count,v=e.type,y=v===void 0?"text":v,b=e.classes,x=e.classNames,S=e.styles,w=e.onCompositionStart,E=e.onCompositionEnd,C=hr(e,pze),T=_.useState(!1),A=Pe(T,2),M=A[0],P=A[1],I=Ge.useRef(!1),R=_.useRef(null),N=function(be){R.current&&jie(R.current,be)},k=Ka(e.defaultValue,{value:e.value}),O=Pe(k,2),D=O[0],B=O[1],z=D==null?"":String(D),F=Ge.useState(null),V=Pe(F,2),Y=V[0],W=V[1],X=Vie(g,m),H=X.max||f,ie=X.strategy(z),Q=!!H&&ie>H;_.useImperativeHandle(t,function(){return{focus:N,blur:function(){var be;(be=R.current)===null||be===void 0||be.blur()},setSelectionRange:function(be,ye,q){var U;(U=R.current)===null||U===void 0||U.setSelectionRange(be,ye,q)},select:function(){var be;(be=R.current)===null||be===void 0||be.select()},input:R.current}}),_.useEffect(function(){P(function(de){return de&&d?!1:de})},[d]);var Z=function(be,ye){var q=ye;if(!I.current&&X.exceedFormatter&&X.max&&X.strategy(ye)>X.max&&(q=X.exceedFormatter(ye,{max:X.max}),ye!==q)){var U,ce;W([((U=R.current)===null||U===void 0?void 0:U.selectionStart)||0,((ce=R.current)===null||ce===void 0?void 0:ce.selectionEnd)||0])}B(q),R.current&&oA(R.current,be,i,q)};Ge.useEffect(function(){if(Y){var de;(de=R.current)===null||de===void 0||de.setSelectionRange.apply(de,ft(Y))}},[Y]);var ee=function(be){Z(be,be.target.value)},re=function(be){I.current=!1,Z(be,be.currentTarget.value),E==null||E(be)},ne=function(be){a&&be.key==="Enter"&&a(be),o==null||o(be)},se=function(be){P(!0),n==null||n(be)},fe=function(be){P(!1),s==null||s(be)},me=function(be){B(""),N(),R.current&&oA(R.current,be,i)},Oe=Q&&"".concat(c,"-out-of-range"),Ee=function(){var be=Pa(e,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames"]);return Ge.createElement("input",ae({autoComplete:r},be,{onChange:ee,onFocus:se,onBlur:fe,onKeyDown:ne,className:Fe(c,he({},"".concat(c,"-disabled"),d),x==null?void 0:x.input),style:S==null?void 0:S.input,ref:R,size:u,type:y,onCompositionStart:function(q){I.current=!0,w==null||w(q)},onCompositionEnd:re}))},Se=function(){var be=Number(H)>0;if(p||X.show){var ye=X.showFormatter?X.showFormatter({value:z,count:ie,maxLength:H}):"".concat(ie).concat(be?" / ".concat(H):"");return Ge.createElement(Ge.Fragment,null,X.show&&Ge.createElement("span",{className:Fe("".concat(c,"-show-count-suffix"),he({},"".concat(c,"-show-count-has-suffix"),!!p),x==null?void 0:x.count),style:_e({},S==null?void 0:S.count)},ye),p)}return null};return Ge.createElement(d4,ae({},C,{prefixCls:c,className:Fe(h,Oe),inputElement:Ee(),handleReset:me,value:z,focused:M,triggerFocus:N,suffix:Se(),disabled:d,classes:b,classNames:x,styles:S}))});function gze(e,t){var r=_.useRef(null);function i(){try{var s=e.selectionStart,a=e.selectionEnd,o=e.value,l=o.substring(0,s),c=o.substring(a);r.current={start:s,end:a,value:o,beforeTxt:l,afterTxt:c}}catch{}}function n(){if(e&&r.current&&t)try{var s=e.value,a=r.current,o=a.beforeTxt,l=a.afterTxt,c=a.start,d=s.length;if(s.endsWith(l))d=s.length-r.current.afterTxt.length;else if(s.startsWith(o))d=o.length;else{var u=o[c-1],h=s.indexOf(u,c-1);h!==-1&&(d=h+1)}e.setSelectionRange(d,d)}catch(f){As(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(f.message))}}return[i,n]}var vze=function(){var t=_.useState(!1),r=Pe(t,2),i=r[0],n=r[1];return mi(function(){n($F())},[]),i},yze=200,bze=600;function xze(e){var t=e.prefixCls,r=e.upNode,i=e.downNode,n=e.upDisabled,s=e.downDisabled,a=e.onStep,o=_.useRef(),l=_.useRef([]),c=_.useRef();c.current=a;var d=function(){clearTimeout(o.current)},u=function(b,x){b.preventDefault(),d(),c.current(x);function S(){c.current(x),o.current=setTimeout(S,yze)}o.current=setTimeout(S,bze)};_.useEffect(function(){return function(){d(),l.current.forEach(function(y){return Lr.cancel(y)})}},[]);var h=vze();if(h)return null;var f="".concat(t,"-handler"),p=Fe(f,"".concat(f,"-up"),he({},"".concat(f,"-up-disabled"),n)),m=Fe(f,"".concat(f,"-down"),he({},"".concat(f,"-down-disabled"),s)),g=function(){return l.current.push(Lr(d))},v={unselectable:"on",role:"button",onMouseUp:g,onMouseLeave:g};return _.createElement("div",{className:"".concat(f,"-wrap")},_.createElement("span",ae({},v,{onMouseDown:function(b){u(b,!0)},"aria-label":"Increase Value","aria-disabled":n,className:p}),r||_.createElement("span",{unselectable:"on",className:"".concat(t,"-handler-up-inner")})),_.createElement("span",ae({},v,{onMouseDown:function(b){u(b,!1)},"aria-label":"Decrease Value","aria-disabled":s,className:m}),i||_.createElement("span",{unselectable:"on",className:"".concat(t,"-handler-down-inner")})))}function AH(e){var t=typeof e=="number"?MM(e):ap(e).fullStr,r=t.includes(".");return r?ap(t.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}const wze=function(){var e=_.useRef(0),t=function(){Lr.cancel(e.current)};return _.useEffect(function(){return t},[]),function(r){t(),e.current=Lr(function(){r()})}};var _ze=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","classNames","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep","changeOnBlur"],Sze=["disabled","style","prefixCls","value","prefix","suffix","addonBefore","addonAfter","classes","className","classNames"],TH=function(t,r){return t||r.isEmpty()?r.toString():r.toNumber()},MH=function(t){var r=wl(t);return r.isInvalidate()?null:r},Eze=_.forwardRef(function(e,t){var r,i=e.prefixCls,n=i===void 0?"rc-input-number":i,s=e.className,a=e.style,o=e.min,l=e.max,c=e.step,d=c===void 0?1:c,u=e.defaultValue,h=e.value,f=e.disabled,p=e.readOnly,m=e.upHandler,g=e.downHandler,v=e.keyboard,y=e.controls,b=y===void 0?!0:y,x=e.classNames,S=e.stringMode,w=e.parser,E=e.formatter,C=e.precision,T=e.decimalSeparator,A=e.onChange,M=e.onInput,P=e.onPressEnter,I=e.onStep,R=e.changeOnBlur,N=R===void 0?!0:R,k=hr(e,_ze),O="".concat(n,"-input"),D=_.useRef(null),B=_.useState(!1),z=Pe(B,2),F=z[0],V=z[1],Y=_.useRef(!1),W=_.useRef(!1),X=_.useRef(!1),H=_.useState(function(){return wl(h??u)}),ie=Pe(H,2),Q=ie[0],Z=ie[1];function ee(Ie){h===void 0&&Z(Ie)}var re=_.useCallback(function(Ie,$e){if(!$e)return C>=0?C:Math.max(Uf(Ie),Uf(d))},[C,d]),ne=_.useCallback(function(Ie){var $e=String(Ie);if(w)return w($e);var tt=$e;return T&&(tt=tt.replace(T,".")),tt.replace(/[^\w.-]+/g,"")},[w,T]),se=_.useRef(""),fe=_.useCallback(function(Ie,$e){if(E)return E(Ie,{userTyping:$e,input:String(se.current)});var tt=typeof Ie=="number"?MM(Ie):Ie;if(!$e){var He=re(tt,$e);if(u4(tt)&&(T||He>=0)){var gt=T||".";tt=xE(tt,gt,He)}}return tt},[E,re,T]),me=_.useState(function(){var Ie=u??h;return Q.isInvalidate()&&["string","number"].includes(vr(Ie))?Number.isNaN(Ie)?"":Ie:fe(Q.toString(),!1)}),Oe=Pe(me,2),Ee=Oe[0],Se=Oe[1];se.current=Ee;function de(Ie,$e){Se(fe(Ie.isInvalidate()?Ie.toString(!1):Ie.toString(!$e),$e))}var be=_.useMemo(function(){return MH(l)},[l,C]),ye=_.useMemo(function(){return MH(o)},[o,C]),q=_.useMemo(function(){return!be||!Q||Q.isInvalidate()?!1:be.lessEquals(Q)},[be,Q]),U=_.useMemo(function(){return!ye||!Q||Q.isInvalidate()?!1:Q.lessEquals(ye)},[ye,Q]),ce=gze(D.current,F),xe=Pe(ce,2),j=xe[0],Be=xe[1],ze=function($e){return be&&!$e.lessEquals(be)?be:ye&&!ye.lessEquals($e)?ye:null},Ve=function($e){return!ze($e)},pe=function($e,tt){var He=$e,gt=Ve(He)||He.isEmpty();if(!He.isEmpty()&&!tt&&(He=ze(He)||He,gt=!0),!p&&!f&&gt){var ot=He.toString(),at=re(ot,tt);return at>=0&&(He=wl(xE(ot,".",at)),Ve(He)||(He=wl(xE(ot,".",at,!0)))),He.equals(Q)||(ee(He),A==null||A(He.isEmpty()?null:TH(S,He)),h===void 0&&de(He,tt)),He}return Q},Me=wze(),Ue=function Ie($e){if(j(),se.current=$e,Se($e),!W.current){var tt=ne($e),He=wl(tt);He.isNaN()||pe(He,!0)}M==null||M($e),Me(function(){var gt=$e;w||(gt=$e.replace(/。/g,".")),gt!==$e&&Ie(gt)})},Re=function(){W.current=!0},et=function(){W.current=!1,Ue(D.current.value)},Xe=function($e){Ue($e.target.value)},Ze=function($e){var tt;if(!($e&&q||!$e&&U)){Y.current=!1;var He=wl(X.current?AH(d):d);$e||(He=He.negate());var gt=(Q||wl(0)).add(He.toString()),ot=pe(gt,!1);I==null||I(TH(S,ot),{offset:X.current?AH(d):d,type:$e?"up":"down"}),(tt=D.current)===null||tt===void 0||tt.focus()}},Mt=function($e){var tt=wl(ne(Ee)),He=tt;tt.isNaN()?He=pe(Q,$e):He=pe(tt,$e),h!==void 0?de(Q,!1):He.isNaN()||de(He,!1)},Gt=function(){Y.current=!0},ue=function($e){var tt=$e.key,He=$e.shiftKey;Y.current=!0,X.current=He,tt==="Enter"&&(W.current||(Y.current=!1),Mt(!1),P==null||P($e)),v!==!1&&!W.current&&["Up","ArrowUp","Down","ArrowDown"].includes(tt)&&(Ze(tt==="Up"||tt==="ArrowUp"),$e.preventDefault())},Ae=function(){Y.current=!1,X.current=!1},ke=function(){N&&Mt(!1),V(!1),Y.current=!1};return H1(function(){Q.isInvalidate()||de(Q,!1)},[C,E]),H1(function(){var Ie=wl(h);Z(Ie);var $e=wl(ne(Ee));(!Ie.equals($e)||!Y.current||E)&&de(Ie,Y.current)},[h]),H1(function(){E&&Be()},[Ee]),_.createElement("div",{className:Fe(n,x==null?void 0:x.input,s,(r={},he(r,"".concat(n,"-focused"),F),he(r,"".concat(n,"-disabled"),f),he(r,"".concat(n,"-readonly"),p),he(r,"".concat(n,"-not-a-number"),Q.isNaN()),he(r,"".concat(n,"-out-of-range"),!Q.isInvalidate()&&!Ve(Q)),r)),style:a,onFocus:function(){V(!0)},onBlur:ke,onKeyDown:ue,onKeyUp:Ae,onCompositionStart:Re,onCompositionEnd:et,onBeforeInput:Gt},b&&_.createElement(xze,{prefixCls:n,upNode:m,downNode:g,upDisabled:q,downDisabled:U,onStep:Ze}),_.createElement("div",{className:"".concat(O,"-wrap")},_.createElement("input",ae({autoComplete:"off",role:"spinbutton","aria-valuemin":o,"aria-valuemax":l,"aria-valuenow":Q.isInvalidate()?null:Q.toString(),step:d},k,{ref:To(D,t),className:O,value:Ee,onChange:Xe,disabled:f,readOnly:p}))))}),Uie=_.forwardRef(function(e,t){var r=e.disabled,i=e.style,n=e.prefixCls,s=e.value,a=e.prefix,o=e.suffix,l=e.addonBefore,c=e.addonAfter,d=e.classes,u=e.className,h=e.classNames,f=hr(e,Sze),p=_.useRef(null),m=function(v){p.current&&jie(p.current,v)};return _.createElement(d4,{inputElement:_.createElement(Eze,ae({prefixCls:n,disabled:r,classNames:h,ref:To(p,t)},f)),className:u,triggerFocus:m,prefixCls:n,value:s,disabled:r,style:i,prefix:a,suffix:o,addonAfter:c,addonBefore:l,classes:d,classNames:h,components:{affixWrapper:"div",groupWrapper:"div",wrapper:"div",groupAddon:"div"}})});Uie.displayName="InputNumber";const PH=(e,t)=>{let{componentCls:r,borderRadiusSM:i,borderRadiusLG:n}=e;const s=t==="lg"?n:i;return{[`&-${t}`]:{[`${r}-handler-wrap`]:{borderStartEndRadius:s,borderEndEndRadius:s},[`${r}-handler-up`]:{borderStartEndRadius:s},[`${r}-handler-down`]:{borderEndEndRadius:s}}}},Cze=e=>{const{componentCls:t,lineWidth:r,lineType:i,colorBorder:n,borderRadius:s,fontSizeLG:a,controlHeightLG:o,controlHeightSM:l,colorError:c,paddingInlineSM:d,colorTextDescription:u,motionDurationMid:h,handleHoverColor:f,paddingInline:p,paddingBlock:m,handleBg:g,handleActiveBg:v,colorTextDisabled:y,borderRadiusSM:b,borderRadiusLG:x,controlWidth:S,handleOpacity:w,handleBorderColor:E,calc:C}=e;return[{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},Vn(e)),TM(e)),AM(e,t)),{display:"inline-block",width:S,margin:0,padding:0,border:`${lt(r)} ${i} ${n}`,borderRadius:s,"&-rtl":{direction:"rtl",[`${t}-input`]:{direction:"rtl"}},"&-lg":{padding:0,fontSize:a,borderRadius:x,[`input${t}-input`]:{height:C(o).sub(C(r).mul(2)).equal()}},"&-sm":{padding:0,borderRadius:b,[`input${t}-input`]:{height:C(l).sub(C(r).mul(2)).equal(),padding:`0 ${lt(d)}`}},"&-out-of-range":{[`${t}-input-wrap`]:{input:{color:c}}},"&-group":Object.assign(Object.assign(Object.assign({},Vn(e)),Iie(e)),{"&-wrapper":{display:"inline-block",textAlign:"start",verticalAlign:"top",[`${t}-affix-wrapper`]:{width:"100%"},"&-lg":{[`${t}-group-addon`]:{borderRadius:x,fontSize:e.fontSizeLG}},"&-sm":{[`${t}-group-addon`]:{borderRadius:b}},[`${t}-wrapper-disabled > ${t}-group-addon`]:Object.assign({},a4(e)),[`&:not(${t}-compact-first-item):not(${t}-compact-last-item)${t}-compact-item`]:{[`${t}, ${t}-group-addon`]:{borderRadius:0}},[`&:not(${t}-compact-last-item)${t}-compact-first-item`]:{[`${t}, ${t}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${t}-compact-first-item)${t}-compact-last-item`]:{[`${t}, ${t}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}),[`&-disabled ${t}-input`]:{cursor:"not-allowed"},[t]:{"&-input":Object.assign(Object.assign(Object.assign(Object.assign({},Vn(e)),{width:"100%",padding:`${lt(m)} ${lt(p)}`,textAlign:"start",backgroundColor:"transparent",border:0,borderRadius:s,outline:0,transition:`all ${h} linear`,appearance:"textfield",fontSize:"inherit"}),Aie(e.colorTextPlaceholder)),{'&[type="number"]::-webkit-inner-spin-button, &[type="number"]::-webkit-outer-spin-button':{margin:0,webkitAppearance:"none",appearance:"none"}})}})},{[t]:Object.assign(Object.assign(Object.assign({[`&:hover ${t}-handler-wrap, &-focused ${t}-handler-wrap`]:{opacity:1},[`${t}-handler-wrap`]:{position:"absolute",insetBlockStart:0,insetInlineEnd:0,width:e.handleWidth,height:"100%",background:g,borderStartStartRadius:0,borderStartEndRadius:s,borderEndEndRadius:s,borderEndStartRadius:0,opacity:w,display:"flex",flexDirection:"column",alignItems:"stretch",transition:`opacity ${h} linear ${h}`,[`${t}-handler`]:{display:"flex",alignItems:"center",justifyContent:"center",flex:"auto",height:"40%",[`
              ${t}-handler-up-inner,
              ${t}-handler-down-inner
            `]:{marginInlineEnd:0,fontSize:e.handleFontSize}}},[`${t}-handler`]:{height:"50%",overflow:"hidden",color:u,fontWeight:"bold",lineHeight:0,textAlign:"center",cursor:"pointer",borderInlineStart:`${lt(r)} ${i} ${E}`,transition:`all ${h} linear`,"&:active":{background:v},"&:hover":{height:"60%",[`
              ${t}-handler-up-inner,
              ${t}-handler-down-inner
            `]:{color:f}},"&-up-inner, &-down-inner":Object.assign(Object.assign({},nw()),{color:u,transition:`all ${h} linear`,userSelect:"none"})},[`${t}-handler-up`]:{borderStartEndRadius:s},[`${t}-handler-down`]:{borderBlockStart:`${lt(r)} ${i} ${E}`,borderEndEndRadius:s}},PH(e,"lg")),PH(e,"sm")),{"&-disabled, &-readonly":{[`${t}-handler-wrap`]:{display:"none"},[`${t}-input`]:{color:"inherit"}},[`
          ${t}-handler-up-disabled,
          ${t}-handler-down-disabled
        `]:{cursor:"not-allowed"},[`
          ${t}-handler-up-disabled:hover &-handler-up-inner,
          ${t}-handler-down-disabled:hover &-handler-down-inner
        `]:{color:y}})},{[`${t}-borderless`]:{borderColor:"transparent",boxShadow:"none",[`${t}-handler-down`]:{borderBlockStartWidth:0}}}]},Aze=e=>{const{componentCls:t,paddingBlock:r,paddingInline:i,inputAffixPadding:n,controlWidth:s,borderRadiusLG:a,borderRadiusSM:o}=e;return{[`${t}-affix-wrapper`]:Object.assign(Object.assign(Object.assign({},TM(e)),AM(e,`${t}-affix-wrapper`)),{position:"relative",display:"inline-flex",width:s,padding:0,paddingInlineStart:i,"&-lg":{borderRadius:a},"&-sm":{borderRadius:o},[`&:not(${t}-affix-wrapper-disabled):hover`]:{zIndex:1},"&-focused, &:focus":{zIndex:1},[`&-disabled > ${t}-disabled`]:{background:"transparent"},[`> div${t}`]:{width:"100%",border:"none",outline:"none",[`&${t}-focused`]:{boxShadow:"none !important"}},[`input${t}-input`]:{padding:`${lt(r)} 0`},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[`${t}-handler-wrap`]:{zIndex:2},[t]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center",pointerEvents:"none"},"&-prefix":{marginInlineEnd:n},"&-suffix":{position:"absolute",insetBlockStart:0,insetInlineEnd:0,zIndex:1,height:"100%",marginInlineEnd:i,marginInlineStart:n}}})}},Tze=e=>Object.assign(Object.assign({},Die(e)),{controlWidth:90,handleWidth:e.controlHeightSM-e.lineWidth*2,handleFontSize:e.fontSize/2,handleVisible:"auto",handleActiveBg:e.colorFillAlter,handleBg:e.colorBgContainer,handleHoverColor:e.colorPrimary,handleBorderColor:e.colorBorder,handleOpacity:0}),Mze=e=>Object.assign(Object.assign({},e),{handleOpacity:e.handleVisible===!0?1:0}),Pze=sa("InputNumber",e=>{const t=zr(e,Rie(e));return[Cze(t),Aze(t),gM(t)]},Tze,{format:Mze,unitless:{handleOpacity:!0}});var Ize=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const $ie=_.forwardRef((e,t)=>{const{getPrefixCls:r,direction:i}=_.useContext(br),n=_.useRef(null);_.useImperativeHandle(t,()=>n.current);const{className:s,rootClassName:a,size:o,disabled:l,prefixCls:c,addonBefore:d,addonAfter:u,prefix:h,bordered:f=!0,readOnly:p,status:m,controls:g}=e,v=Ize(e,["className","rootClassName","size","disabled","prefixCls","addonBefore","addonAfter","prefix","bordered","readOnly","status","controls"]),y=r("input-number",c),b=Mo(y),[x,S,w]=Pze(y,b),{compactSize:E,compactItemClassnames:C}=T0(y,i);let T=_.createElement(uze,{className:`${y}-handler-up-inner`}),A=_.createElement(Jre,{className:`${y}-handler-down-inner`});const M=typeof g=="boolean"?g:void 0;typeof g=="object"&&(T=typeof g.upIcon>"u"?T:_.createElement("span",{className:`${y}-handler-up-inner`},g.upIcon),A=typeof g.downIcon>"u"?A:_.createElement("span",{className:`${y}-handler-down-inner`},g.downIcon));const{hasFeedback:P,status:I,isFormItemInput:R,feedbackIcon:N}=_.useContext(_o),k=xM(I,m),O=ef(W=>{var X;return(X=o??E)!==null&&X!==void 0?X:W}),D=_.useContext(Jh),B=l??D,z=Fe({[`${y}-lg`]:O==="large",[`${y}-sm`]:O==="small",[`${y}-rtl`]:i==="rtl",[`${y}-borderless`]:!f,[`${y}-in-form-item`]:R},qu(y,k),S),F=`${y}-group`,V=P&&_.createElement(_.Fragment,null,N),Y=_.createElement(Uie,Object.assign({ref:n,disabled:B,className:Fe(w,b,s,a,C),upHandler:T,downHandler:A,prefixCls:y,readOnly:p,controls:M,prefix:h,suffix:V,addonAfter:u&&_.createElement($v,null,_.createElement(eA,{override:!0,status:!0},u)),addonBefore:d&&_.createElement($v,null,_.createElement(eA,{override:!0,status:!0},d)),classNames:{input:z},classes:{affixWrapper:Fe(qu(`${y}-affix-wrapper`,k,P),{[`${y}-affix-wrapper-sm`]:O==="small",[`${y}-affix-wrapper-lg`]:O==="large",[`${y}-affix-wrapper-rtl`]:i==="rtl",[`${y}-affix-wrapper-borderless`]:!f},S),wrapper:Fe({[`${F}-rtl`]:i==="rtl",[`${y}-wrapper-disabled`]:B},S),group:Fe({[`${y}-group-wrapper-sm`]:O==="small",[`${y}-group-wrapper-lg`]:O==="large",[`${y}-group-wrapper-rtl`]:i==="rtl"},qu(`${y}-group-wrapper`,k,P),S)}},v));return x(Y)}),Hie=$ie,Rze=e=>_.createElement(lM,{theme:{components:{InputNumber:{handleVisible:!0}}}},_.createElement($ie,Object.assign({},e)));Hie._InternalPanelDoNotUseOrYouWillBeFired=Rze;const Dze=Hie,Oze=e=>{const{getPrefixCls:t,direction:r}=_.useContext(br),{prefixCls:i,className:n}=e,s=t("input-group",i),a=t("input"),[o,l]=o4(a),c=Fe(s,{[`${s}-lg`]:e.size==="large",[`${s}-sm`]:e.size==="small",[`${s}-compact`]:e.compact,[`${s}-rtl`]:r==="rtl"},l,n),d=_.useContext(_o),u=_.useMemo(()=>Object.assign(Object.assign({},d),{isFormItemInput:!1}),[d]);return o(_.createElement("span",{className:c,style:e.style,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onFocus:e.onFocus,onBlur:e.onBlur},_.createElement(_o.Provider,{value:u},e.children)))},Lze=Oze;function Wie(e,t){const r=_.useRef([]),i=()=>{r.current.push(setTimeout(()=>{var n,s,a,o;!((n=e.current)===null||n===void 0)&&n.input&&((s=e.current)===null||s===void 0?void 0:s.input.getAttribute("type"))==="password"&&(!((a=e.current)===null||a===void 0)&&a.input.hasAttribute("value"))&&((o=e.current)===null||o===void 0||o.input.removeAttribute("value"))}))};return _.useEffect(()=>(t&&i(),()=>r.current.forEach(n=>{n&&clearTimeout(n)})),[]),i}function Nze(e){return!!(e.prefix||e.suffix||e.allowClear)}var kze=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function zze(e,t){if(!e)return;e.focus(t);const{cursor:r}=t||{};if(r){const i=e.value.length;switch(r){case"start":e.setSelectionRange(0,0);break;case"end":e.setSelectionRange(i,i);break;default:e.setSelectionRange(0,i);break}}}const Bze=_.forwardRef((e,t)=>{var r;const{prefixCls:i,bordered:n=!0,status:s,size:a,disabled:o,onBlur:l,onFocus:c,suffix:d,allowClear:u,addonAfter:h,addonBefore:f,className:p,style:m,styles:g,rootClassName:v,onChange:y,classNames:b}=e,x=kze(e,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames"]),{getPrefixCls:S,direction:w,input:E}=Ge.useContext(br),C=S("input",i),T=_.useRef(null),A=Mo(C),[M,P,I]=o4(C,A),{compactSize:R,compactItemClassnames:N}=T0(C,w),k=ef(ee=>{var re;return(re=a??R)!==null&&re!==void 0?re:ee}),O=Ge.useContext(Jh),D=o??O,{status:B,hasFeedback:z,feedbackIcon:F}=_.useContext(_o),V=xM(B,s),Y=Nze(e)||!!z;_.useRef(Y);const W=Wie(T,!0),X=ee=>{W(),l==null||l(ee)},H=ee=>{W(),c==null||c(ee)},ie=ee=>{W(),y==null||y(ee)},Q=(z||d)&&Ge.createElement(Ge.Fragment,null,d,z&&F);let Z;return typeof u=="object"&&(u!=null&&u.clearIcon)?Z=u:u&&(Z={clearIcon:Ge.createElement(sw,null)}),M(Ge.createElement(mze,Object.assign({ref:To(t,T),prefixCls:C,autoComplete:E==null?void 0:E.autoComplete},x,{disabled:D,onBlur:X,onFocus:H,style:Object.assign(Object.assign({},E==null?void 0:E.style),m),styles:Object.assign(Object.assign({},E==null?void 0:E.styles),g),suffix:Q,allowClear:Z,className:Fe(p,v,I,A,P,N,E==null?void 0:E.className),onChange:ie,addonAfter:h&&Ge.createElement($v,null,Ge.createElement(eA,{override:!0,status:!0},h)),addonBefore:f&&Ge.createElement($v,null,Ge.createElement(eA,{override:!0,status:!0},f)),classNames:Object.assign(Object.assign(Object.assign({},b),E==null?void 0:E.classNames),{input:Fe({[`${C}-sm`]:k==="small",[`${C}-lg`]:k==="large",[`${C}-rtl`]:w==="rtl",[`${C}-borderless`]:!n},!Y&&qu(C,V),b==null?void 0:b.input,(r=E==null?void 0:E.classNames)===null||r===void 0?void 0:r.input,P)}),classes:{affixWrapper:Fe({[`${C}-affix-wrapper-sm`]:k==="small",[`${C}-affix-wrapper-lg`]:k==="large",[`${C}-affix-wrapper-rtl`]:w==="rtl",[`${C}-affix-wrapper-borderless`]:!n},qu(`${C}-affix-wrapper`,V,z),P),wrapper:Fe({[`${C}-group-rtl`]:w==="rtl"},P),group:Fe({[`${C}-group-wrapper-sm`]:k==="small",[`${C}-group-wrapper-lg`]:k==="large",[`${C}-group-wrapper-rtl`]:w==="rtl",[`${C}-group-wrapper-disabled`]:D},qu(`${C}-group-wrapper`,V,z),P)}})))}),h4=Bze;var Fze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};const jze=Fze;var Vze=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:jze}))};const Uze=_.forwardRef(Vze);var $ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"};const Hze=$ze;var Wze=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:Hze}))};const Gze=_.forwardRef(Wze);var qze=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Xze=e=>e?_.createElement(Gze,null):_.createElement(Uze,null),Yze={click:"onClick",hover:"onMouseOver"},Kze=_.forwardRef((e,t)=>{const{visibilityToggle:r=!0}=e,i=typeof r=="object"&&r.visible!==void 0,[n,s]=_.useState(()=>i?r.visible:!1),a=_.useRef(null);_.useEffect(()=>{i&&s(r.visible)},[i,r]);const o=Wie(a),l=()=>{const{disabled:S}=e;S||(n&&o(),s(w=>{var E;const C=!w;return typeof r=="object"&&((E=r.onVisibleChange)===null||E===void 0||E.call(r,C)),C}))},c=S=>{const{action:w="click",iconRender:E=Xze}=e,C=Yze[w]||"",T=E(n),A={[C]:l,className:`${S}-icon`,key:"passwordIcon",onMouseDown:M=>{M.preventDefault()},onMouseUp:M=>{M.preventDefault()}};return _.cloneElement(_.isValidElement(T)?T:_.createElement("span",null,T),A)},{className:d,prefixCls:u,inputPrefixCls:h,size:f}=e,p=qze(e,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:m}=_.useContext(br),g=m("input",h),v=m("input-password",u),y=r&&c(v),b=Fe(v,d,{[`${v}-${f}`]:!!f}),x=Object.assign(Object.assign({},Pa(p,["suffix","iconRender","visibilityToggle"])),{type:n?"text":"password",className:b,prefixCls:g,suffix:y});return f&&(x.size=f),_.createElement(h4,Object.assign({ref:To(t,a)},x))}),Qze=Kze;var Zze=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Jze=_.forwardRef((e,t)=>{const{prefixCls:r,inputPrefixCls:i,className:n,size:s,suffix:a,enterButton:o=!1,addonAfter:l,loading:c,disabled:d,onSearch:u,onChange:h,onCompositionStart:f,onCompositionEnd:p}=e,m=Zze(e,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd"]),{getPrefixCls:g,direction:v}=_.useContext(br),y=_.useRef(!1),b=g("input-search",r),x=g("input",i),{compactSize:S}=T0(b,v),w=ef(z=>{var F;return(F=s??S)!==null&&F!==void 0?F:z}),E=_.useRef(null),C=z=>{z&&z.target&&z.type==="click"&&u&&u(z.target.value,z,{source:"clear"}),h&&h(z)},T=z=>{var F;document.activeElement===((F=E.current)===null||F===void 0?void 0:F.input)&&z.preventDefault()},A=z=>{var F,V;u&&u((V=(F=E.current)===null||F===void 0?void 0:F.input)===null||V===void 0?void 0:V.value,z,{source:"input"})},M=z=>{y.current||c||A(z)},P=typeof o=="boolean"?_.createElement(eie,null):null,I=`${b}-button`;let R;const N=o||{},k=N.type&&N.type.__ANT_BUTTON===!0;k||N.type==="button"?R=nl(N,Object.assign({onMouseDown:T,onClick:z=>{var F,V;(V=(F=N==null?void 0:N.props)===null||F===void 0?void 0:F.onClick)===null||V===void 0||V.call(F,z),A(z)},key:"enterButton"},k?{className:I,size:w}:{})):R=_.createElement(ql,{className:I,type:o?"primary":void 0,size:w,disabled:d,key:"enterButton",onMouseDown:T,onClick:A,loading:c,icon:P},o),l&&(R=[R,nl(l,{key:"addonAfter"})]);const O=Fe(b,{[`${b}-rtl`]:v==="rtl",[`${b}-${w}`]:!!w,[`${b}-with-button`]:!!o},n),D=z=>{y.current=!0,f==null||f(z)},B=z=>{y.current=!1,p==null||p(z)};return _.createElement(h4,Object.assign({ref:To(E,t),onPressEnter:M},m,{size:w,onCompositionStart:D,onCompositionEnd:B,prefixCls:x,addonAfter:R,suffix:a,onChange:C,className:O,disabled:d}))}),eBe=Jze;var tBe=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,rBe=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],kI={},Oo;function iBe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&kI[r])return kI[r];var i=window.getComputedStyle(e),n=i.getPropertyValue("box-sizing")||i.getPropertyValue("-moz-box-sizing")||i.getPropertyValue("-webkit-box-sizing"),s=parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("padding-top")),a=parseFloat(i.getPropertyValue("border-bottom-width"))+parseFloat(i.getPropertyValue("border-top-width")),o=rBe.map(function(c){return"".concat(c,":").concat(i.getPropertyValue(c))}).join(";"),l={sizingStyle:o,paddingSize:s,borderSize:a,boxSizing:n};return t&&r&&(kI[r]=l),l}function nBe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;Oo||(Oo=document.createElement("textarea"),Oo.setAttribute("tab-index","-1"),Oo.setAttribute("aria-hidden","true"),document.body.appendChild(Oo)),e.getAttribute("wrap")?Oo.setAttribute("wrap",e.getAttribute("wrap")):Oo.removeAttribute("wrap");var n=iBe(e,t),s=n.paddingSize,a=n.borderSize,o=n.boxSizing,l=n.sizingStyle;Oo.setAttribute("style","".concat(l,";").concat(tBe)),Oo.value=e.value||e.placeholder||"";var c=void 0,d=void 0,u,h=Oo.scrollHeight;if(o==="border-box"?h+=a:o==="content-box"&&(h-=s),r!==null||i!==null){Oo.value=" ";var f=Oo.scrollHeight-s;r!==null&&(c=f*r,o==="border-box"&&(c=c+s+a),h=Math.max(c,h)),i!==null&&(d=f*i,o==="border-box"&&(d=d+s+a),u=h>d?"":"hidden",h=Math.min(d,h))}var p={height:h,overflowY:u,resize:"none"};return c&&(p.minHeight=c),d&&(p.maxHeight=d),p}var sBe=["prefixCls","onPressEnter","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],zI=0,BI=1,FI=2,aBe=_.forwardRef(function(e,t){var r=e,i=r.prefixCls;r.onPressEnter;var n=r.defaultValue,s=r.value,a=r.autoSize,o=r.onResize,l=r.className,c=r.style,d=r.disabled,u=r.onChange;r.onInternalAutoSize;var h=hr(r,sBe),f=Ka(n,{value:s,postState:function(W){return W??""}}),p=Pe(f,2),m=p[0],g=p[1],v=function(W){g(W.target.value),u==null||u(W)},y=_.useRef();_.useImperativeHandle(t,function(){return{textArea:y.current}});var b=_.useMemo(function(){return a&&vr(a)==="object"?[a.minRows,a.maxRows]:[]},[a]),x=Pe(b,2),S=x[0],w=x[1],E=!!a,C=function(){try{if(document.activeElement===y.current){var W=y.current,X=W.selectionStart,H=W.selectionEnd,ie=W.scrollTop;y.current.setSelectionRange(X,H),y.current.scrollTop=ie}}catch{}},T=_.useState(FI),A=Pe(T,2),M=A[0],P=A[1],I=_.useState(),R=Pe(I,2),N=R[0],k=R[1],O=function(){P(zI)};mi(function(){E&&O()},[s,S,w,E]),mi(function(){if(M===zI)P(BI);else if(M===BI){var Y=nBe(y.current,!1,S,w);P(FI),k(Y)}else C()},[M]);var D=_.useRef(),B=function(){Lr.cancel(D.current)},z=function(W){M===FI&&(o==null||o(W),a&&(B(),D.current=Lr(function(){O()})))};_.useEffect(function(){return B},[]);var F=E?N:null,V=_e(_e({},c),F);return(M===zI||M===BI)&&(V.overflowY="hidden",V.overflowX="hidden"),_.createElement(Zh,{onResize:z,disabled:!(a||o)},_.createElement("textarea",ae({},h,{ref:y,style:V,className:Fe(i,l,he({},"".concat(i,"-disabled"),d)),disabled:d,value:m,onChange:v})))}),oBe=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","classes","showCount","count","className","style","disabled","hidden","classNames","styles","onResize"],lBe=Ge.forwardRef(function(e,t){var r,i,n=e.defaultValue,s=e.value,a=e.onFocus,o=e.onBlur,l=e.onChange,c=e.allowClear,d=e.maxLength,u=e.onCompositionStart,h=e.onCompositionEnd,f=e.suffix,p=e.prefixCls,m=p===void 0?"rc-textarea":p,g=e.classes,v=e.showCount,y=e.count,b=e.className,x=e.style,S=e.disabled,w=e.hidden,E=e.classNames,C=e.styles,T=e.onResize,A=hr(e,oBe),M=Ka(n,{value:s,defaultValue:n}),P=Pe(M,2),I=P[0],R=P[1],N=I==null?"":String(I),k=Ge.useState(!1),O=Pe(k,2),D=O[0],B=O[1],z=Ge.useRef(!1),F=Ge.useState(null),V=Pe(F,2),Y=V[0],W=V[1],X=_.useRef(null),H=function(){var Me;return(Me=X.current)===null||Me===void 0?void 0:Me.textArea},ie=function(){H().focus()};_.useImperativeHandle(t,function(){return{resizableTextArea:X.current,focus:ie,blur:function(){H().blur()}}}),_.useEffect(function(){B(function(pe){return!S&&pe})},[S]);var Q=Ge.useState(null),Z=Pe(Q,2),ee=Z[0],re=Z[1];Ge.useEffect(function(){if(ee){var pe;(pe=H()).setSelectionRange.apply(pe,ft(ee))}},[ee]);var ne=Vie(y,v),se=(r=ne.max)!==null&&r!==void 0?r:d,fe=Number(se)>0,me=ne.strategy(N),Oe=!!se&&me>se,Ee=function(Me,Ue){var Re=Ue;!z.current&&ne.exceedFormatter&&ne.max&&ne.strategy(Ue)>ne.max&&(Re=ne.exceedFormatter(Ue,{max:ne.max}),Ue!==Re&&re([H().selectionStart||0,H().selectionEnd||0])),R(Re),oA(Me.currentTarget,Me,l,Re)},Se=function(Me){z.current=!0,u==null||u(Me)},de=function(Me){z.current=!1,Ee(Me,Me.currentTarget.value),h==null||h(Me)},be=function(Me){Ee(Me,Me.target.value)},ye=function(Me){var Ue=A.onPressEnter,Re=A.onKeyDown;Me.key==="Enter"&&Ue&&Ue(Me),Re==null||Re(Me)},q=function(Me){B(!0),a==null||a(Me)},U=function(Me){B(!1),o==null||o(Me)},ce=function(Me){R(""),ie(),oA(H(),Me,l)},xe=f,j;ne.show&&(ne.showFormatter?j=ne.showFormatter({value:N,count:me,maxLength:se}):j="".concat(me).concat(fe?" / ".concat(se):""),xe=Ge.createElement(Ge.Fragment,null,xe,Ge.createElement("span",{className:Fe("".concat(m,"-data-count"),E==null?void 0:E.count),style:C==null?void 0:C.count},j)));var Be=function(Me){var Ue;T==null||T(Me),(Ue=H())!==null&&Ue!==void 0&&Ue.style.height&&W(!0)},ze=!A.autoSize&&!v&&!c,Ve=Ge.createElement(d4,{value:N,allowClear:c,handleReset:ce,suffix:xe,prefixCls:m,classes:{affixWrapper:Fe(g==null?void 0:g.affixWrapper,(i={},he(i,"".concat(m,"-show-count"),v),he(i,"".concat(m,"-textarea-allow-clear"),c),i))},disabled:S,focused:D,className:Fe(b,Oe&&"".concat(m,"-out-of-range")),style:_e(_e({},x),Y&&!ze?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof j=="string"?j:void 0}},hidden:w,inputElement:Ge.createElement(aBe,ae({},A,{maxLength:d,onKeyDown:ye,onChange:be,onFocus:q,onBlur:U,onCompositionStart:Se,onCompositionEnd:de,className:Fe(E==null?void 0:E.textarea),style:_e(_e({},C==null?void 0:C.textarea),{},{resize:x==null?void 0:x.resize}),disabled:S,prefixCls:m,onResize:Be,ref:X}))});return Ve}),cBe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const uBe=_.forwardRef((e,t)=>{var r;const{prefixCls:i,bordered:n=!0,size:s,disabled:a,status:o,allowClear:l,classNames:c,rootClassName:d,className:u}=e,h=cBe(e,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className"]),{getPrefixCls:f,direction:p}=_.useContext(br),m=ef(s),g=_.useContext(Jh),v=a??g,{status:y,hasFeedback:b,feedbackIcon:x}=_.useContext(_o),S=xM(y,o),w=_.useRef(null);_.useImperativeHandle(t,()=>{var I;return{resizableTextArea:(I=w.current)===null||I===void 0?void 0:I.resizableTextArea,focus:R=>{var N,k;zze((k=(N=w.current)===null||N===void 0?void 0:N.resizableTextArea)===null||k===void 0?void 0:k.textArea,R)},blur:()=>{var R;return(R=w.current)===null||R===void 0?void 0:R.blur()}}});const E=f("input",i);let C;typeof l=="object"&&(l!=null&&l.clearIcon)?C=l:l&&(C={clearIcon:_.createElement(sw,null)});const T=Mo(E),[A,M,P]=o4(E,T);return A(_.createElement(lBe,Object.assign({},h,{disabled:v,allowClear:C,className:Fe(P,T,u,d),classes:{affixWrapper:Fe(`${E}-textarea-affix-wrapper`,{[`${E}-affix-wrapper-rtl`]:p==="rtl",[`${E}-affix-wrapper-borderless`]:!n,[`${E}-affix-wrapper-sm`]:m==="small",[`${E}-affix-wrapper-lg`]:m==="large",[`${E}-textarea-show-count`]:e.showCount||((r=e.count)===null||r===void 0?void 0:r.show)},qu(`${E}-affix-wrapper`,S),M)},classNames:Object.assign(Object.assign({},c),{textarea:Fe({[`${E}-borderless`]:!n,[`${E}-sm`]:m==="small",[`${E}-lg`]:m==="large"},qu(E,S),M,c==null?void 0:c.textarea)}),prefixCls:E,suffix:b&&_.createElement("span",{className:`${E}-textarea-suffix`},x),ref:w})))}),dBe=uBe,dw=h4;dw.Group=Lze;dw.Search=eBe;dw.TextArea=dBe;dw.Password=Qze;const lA=dw;function IH(e){return["small","middle","large"].includes(e)}function RH(e){return e?typeof e=="number"&&!Number.isNaN(e):!1}const Gie=Ge.createContext({latestIndex:0}),hBe=Gie.Provider,fBe=e=>{let{className:t,index:r,children:i,split:n,style:s}=e;const{latestIndex:a}=_.useContext(Gie);return i==null?null:_.createElement(_.Fragment,null,_.createElement("div",{className:t,style:s},i),r<a&&n&&_.createElement("span",{className:`${t}-split`},n))},pBe=fBe;var mBe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const gBe=_.forwardRef((e,t)=>{var r,i;const{getPrefixCls:n,space:s,direction:a}=_.useContext(br),{size:o=(s==null?void 0:s.size)||"small",align:l,className:c,rootClassName:d,children:u,direction:h="horizontal",prefixCls:f,split:p,style:m,wrap:g=!1,classNames:v,styles:y}=e,b=mBe(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[x,S]=Array.isArray(o)?o:[o,o],w=IH(S),E=IH(x),C=RH(S),T=RH(x),A=Qc(u,{keepEmpty:!0}),M=l===void 0&&h==="horizontal"?"center":l,P=n("space",f),[I,R,N]=lre(P),k=Fe(P,s==null?void 0:s.className,R,`${P}-${h}`,{[`${P}-rtl`]:a==="rtl",[`${P}-align-${M}`]:M,[`${P}-gap-row-${S}`]:w,[`${P}-gap-col-${x}`]:E},c,d,N),O=Fe(`${P}-item`,(r=v==null?void 0:v.item)!==null&&r!==void 0?r:(i=s==null?void 0:s.classNames)===null||i===void 0?void 0:i.item);let D=0;const B=A.map((V,Y)=>{var W,X;V!=null&&(D=Y);const H=V&&V.key||`${O}-${Y}`;return _.createElement(pBe,{className:O,key:H,index:Y,split:p,style:(W=y==null?void 0:y.item)!==null&&W!==void 0?W:(X=s==null?void 0:s.styles)===null||X===void 0?void 0:X.item},V)}),z=_.useMemo(()=>({latestIndex:D}),[D]);if(A.length===0)return null;const F={};return g&&(F.flexWrap="wrap"),!E&&T&&(F.columnGap=x),!w&&C&&(F.rowGap=S),I(_.createElement("div",Object.assign({ref:t,className:k,style:Object.assign(Object.assign(Object.assign({},F),s==null?void 0:s.style),m)},b),_.createElement(hBe,{value:z},B)))}),qie=gBe;qie.Compact=TIe;const f4=qie;var vBe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const Xie=e=>{const{getPopupContainer:t,getPrefixCls:r,direction:i}=_.useContext(br),{prefixCls:n,type:s="default",danger:a,disabled:o,loading:l,onClick:c,htmlType:d,children:u,className:h,menu:f,arrow:p,autoFocus:m,overlay:g,trigger:v,align:y,open:b,onOpenChange:x,placement:S,getPopupContainer:w,href:E,icon:C=_.createElement(Eie,null),title:T,buttonsRender:A=Q=>Q,mouseEnterDelay:M,mouseLeaveDelay:P,overlayClassName:I,overlayStyle:R,destroyPopupOnHide:N,dropdownRender:k}=e,O=vBe(e,["prefixCls","type","danger","disabled","loading","onClick","htmlType","children","className","menu","arrow","autoFocus","overlay","trigger","align","open","onOpenChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","dropdownRender"]),D=r("dropdown",n),B=`${D}-button`,z={menu:f,arrow:p,autoFocus:m,align:y,disabled:o,trigger:o?[]:v,onOpenChange:x,getPopupContainer:w||t,mouseEnterDelay:M,mouseLeaveDelay:P,overlayClassName:I,overlayStyle:R,destroyPopupOnHide:N,dropdownRender:k},{compactSize:F,compactItemClassnames:V}=T0(D,i),Y=Fe(B,V,h);"overlay"in e&&(z.overlay=g),"open"in e&&(z.open=b),"placement"in e?z.placement=S:z.placement=i==="rtl"?"bottomLeft":"bottomRight";const W=_.createElement(ql,{type:s,danger:a,disabled:o,loading:l,onClick:c,htmlType:d,href:E,title:T},u),X=_.createElement(ql,{type:s,danger:a,icon:C}),[H,ie]=A([W,X]);return _.createElement(f4.Compact,Object.assign({className:Y,size:F,block:!0},O),H,_.createElement(Cie,Object.assign({},z),ie))};Xie.__ANT_BUTTON=!0;const yBe=Xie,Yie=Cie;Yie.Button=yBe;const bBe=Yie;function cA(e){const[t,r]=_.useState(e);return _.useEffect(()=>{const i=setTimeout(()=>{r(e)},e.length?0:10);return()=>{clearTimeout(i)}},[e]),t}const xBe=e=>{const{componentCls:t}=e,r=`${t}-show-help`,i=`${t}-show-help-item`;return{[r]:{transition:`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[i]:{overflow:"hidden",transition:`height ${e.motionDurationSlow} ${e.motionEaseInOut},
                     opacity ${e.motionDurationSlow} ${e.motionEaseInOut},
                     transform ${e.motionDurationSlow} ${e.motionEaseInOut} !important`,[`&${i}-appear, &${i}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${i}-leave-active`]:{transform:"translateY(-5px)"}}}}},wBe=xBe,_Be=e=>({legend:{display:"block",width:"100%",marginBottom:e.marginLG,padding:0,color:e.colorTextDescription,fontSize:e.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${lt(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},label:{fontSize:e.fontSize},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${lt(e.controlOutlineWidth)} ${e.controlOutline}`},output:{display:"block",paddingTop:15,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight}}),DH=(e,t)=>{const{formItemCls:r}=e;return{[r]:{[`${r}-label > label`]:{height:t},[`${r}-control-input`]:{minHeight:t}}}},SBe=e=>{const{componentCls:t}=e;return{[e.componentCls]:Object.assign(Object.assign(Object.assign({},Vn(e)),_Be(e)),{[`${t}-text`]:{display:"inline-block",paddingInlineEnd:e.paddingSM},"&-small":Object.assign({},DH(e,e.controlHeightSM)),"&-large":Object.assign({},DH(e,e.controlHeightLG))})}},EBe=e=>{const{formItemCls:t,iconCls:r,componentCls:i,rootPrefixCls:n,labelRequiredMarkColor:s,labelColor:a,labelFontSize:o,labelHeight:l,labelColonMarginInlineStart:c,labelColonMarginInlineEnd:d,itemMarginBottom:u}=e;return{[t]:Object.assign(Object.assign({},Vn(e)),{marginBottom:u,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden.${n}-row`]:{display:"none"},"&-has-warning":{[`${t}-split`]:{color:e.colorError}},"&-has-error":{[`${t}-split`]:{color:e.colorWarning}},[`${t}-label`]:{flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:e.lineHeight,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:l,color:a,fontSize:o,[`> ${r}`]:{fontSize:e.fontSize,verticalAlign:"top"},[`&${t}-required:not(${t}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:e.marginXXS,color:s,fontSize:e.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${i}-hide-required-mark &`]:{display:"none"}},[`${t}-optional`]:{display:"inline-block",marginInlineStart:e.marginXXS,color:e.colorTextDescription,[`${i}-hide-required-mark &`]:{display:"none"}},[`${t}-tooltip`]:{color:e.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:e.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:c,marginInlineEnd:d},[`&${t}-no-colon::after`]:{content:'"\\a0"'}}},[`${t}-control`]:{"--ant-display":"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${n}-col-'"]):not([class*="' ${n}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:e.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[t]:{"&-explain, &-extra":{clear:"both",color:e.colorTextDescription,fontSize:e.fontSize,lineHeight:e.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:e.controlHeightSM,transition:`color ${e.motionDurationMid} ${e.motionEaseOut}`},"&-explain":{"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning}}},[`&-with-help ${t}-explain`]:{height:"auto",opacity:1},[`${t}-feedback-icon`]:{fontSize:e.fontSize,textAlign:"center",visibility:"visible",animationName:VF,animationDuration:e.motionDurationMid,animationTimingFunction:e.motionEaseOutBack,pointerEvents:"none","&-success":{color:e.colorSuccess},"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning},"&-validating":{color:e.colorPrimary}}})}},CBe=e=>{const{componentCls:t,formItemCls:r}=e;return{[`${t}-horizontal`]:{[`${r}-label`]:{flexGrow:0},[`${r}-control`]:{flex:"1 1 0",minWidth:0},[`${r}-label[class$='-24'], ${r}-label[class*='-24 ']`]:{[`& + ${r}-control`]:{minWidth:"unset"}}}}},ABe=e=>{const{componentCls:t,formItemCls:r}=e;return{[`${t}-inline`]:{display:"flex",flexWrap:"wrap",[r]:{flex:"none",marginInlineEnd:e.margin,marginBottom:0,"&-row":{flexWrap:"nowrap"},[`> ${r}-label,
        > ${r}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${r}-label`]:{flex:"none"},[`${t}-text`]:{display:"inline-block"},[`${r}-has-feedback`]:{display:"inline-block"}}}}},mg=e=>({padding:e.verticalLabelPadding,margin:e.verticalLabelMargin,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{visibility:"hidden"}}}),TBe=e=>{const{componentCls:t,formItemCls:r,rootPrefixCls:i}=e;return{[`${r} ${r}-label`]:mg(e),[`${t}:not(${t}-inline)`]:{[r]:{flexWrap:"wrap",[`${r}-label, ${r}-control`]:{[`&:not([class*=" ${i}-col-xs"])`]:{flex:"0 0 100%",maxWidth:"100%"}}}}}},MBe=e=>{const{componentCls:t,formItemCls:r,rootPrefixCls:i}=e;return{[`${t}-vertical`]:{[r]:{"&-row":{flexDirection:"column"},"&-label > label":{height:"auto"},[`${t}-item-control`]:{width:"100%"}}},[`${t}-vertical ${r}-label,
      .${i}-col-24${r}-label,
      .${i}-col-xl-24${r}-label`]:mg(e),[`@media (max-width: ${lt(e.screenXSMax)})`]:[TBe(e),{[t]:{[`.${i}-col-xs-24${r}-label`]:mg(e)}}],[`@media (max-width: ${lt(e.screenSMMax)})`]:{[t]:{[`.${i}-col-sm-24${r}-label`]:mg(e)}},[`@media (max-width: ${lt(e.screenMDMax)})`]:{[t]:{[`.${i}-col-md-24${r}-label`]:mg(e)}},[`@media (max-width: ${lt(e.screenLGMax)})`]:{[t]:{[`.${i}-col-lg-24${r}-label`]:mg(e)}}}},PBe=e=>({labelRequiredMarkColor:e.colorError,labelColor:e.colorTextHeading,labelFontSize:e.fontSize,labelHeight:e.controlHeight,labelColonMarginInlineStart:e.marginXXS/2,labelColonMarginInlineEnd:e.marginXS,itemMarginBottom:e.marginLG,verticalLabelPadding:`0 0 ${e.paddingXS}px`,verticalLabelMargin:0}),Kie=(e,t)=>zr(e,{formItemCls:`${e.componentCls}-item`,rootPrefixCls:t}),p4=sa("Form",(e,t)=>{let{rootPrefixCls:r}=t;const i=Kie(e,r);return[SBe(i),EBe(i),wBe(i),CBe(i),ABe(i),MBe(i),Tre(i),VF]},PBe,{order:-1e3}),OH=[];function jI(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof e=="string"?e:`${t}-${i}`,error:e,errorStatus:r}}const IBe=e=>{let{help:t,helpStatus:r,errors:i=OH,warnings:n=OH,className:s,fieldId:a,onVisibleChanged:o}=e;const{prefixCls:l}=_.useContext(NF),c=`${l}-item-explain`,d=Mo(l),[u,h,f]=p4(l,d),p=_.useMemo(()=>Z3(l),[l]),m=cA(i),g=cA(n),v=_.useMemo(()=>t!=null?[jI(t,"help",r)]:[].concat(ft(m.map((b,x)=>jI(b,"error","error",x))),ft(g.map((b,x)=>jI(b,"warning","warning",x)))),[t,r,m,g]),y={};return a&&(y.id=`${a}_help`),u(_.createElement(Zp,{motionDeadline:p.motionDeadline,motionName:`${l}-show-help`,visible:!!v.length,onVisibleChanged:o},b=>{const{className:x,style:S}=b;return _.createElement("div",Object.assign({},y,{className:Fe(c,x,f,d,s,h),style:S,role:"alert"}),_.createElement(Hte,Object.assign({keys:v},Z3(l),{motionName:`${l}-show-help-item`,component:!1}),w=>{const{key:E,error:C,errorStatus:T,className:A,style:M}=w;return _.createElement("div",{key:E,className:Fe(A,{[`${c}-${T}`]:T}),style:M},C)}))}))},Qie=IBe,RBe=["parentNode"],DBe="form_item";function X1(e){return e===void 0||e===!1?[]:Array.isArray(e)?e:[e]}function Zie(e,t){if(!e.length)return;const r=e.join("_");return t?`${t}_${r}`:RBe.includes(r)?`${DBe}_${r}`:r}function Jie(e,t,r,i,n,s){let a=i;return s!==void 0?a=s:r.validating?a="validating":e.length?a="error":t.length?a="warning":(r.touched||n&&r.validated)&&(a="success"),a}function LH(e){return X1(e).join("_")}function ene(e){const[t]=LF(),r=_.useRef({}),i=_.useMemo(()=>e??Object.assign(Object.assign({},t),{__INTERNAL__:{itemRef:n=>s=>{const a=LH(n);s?r.current[a]=s:delete r.current[a]}},scrollToField:function(n){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=X1(n),o=Zie(a,i.__INTERNAL__.name),l=o?document.getElementById(o):null;l&&kPe(l,Object.assign({scrollMode:"if-needed",block:"nearest"},s))},getFieldInstance:n=>{const s=LH(n);return r.current[s]}}),[e,t]);return[i]}var OBe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const LBe=(e,t)=>{const r=_.useContext(Jh),{getPrefixCls:i,direction:n,form:s}=_.useContext(br),{prefixCls:a,className:o,rootClassName:l,size:c,disabled:d=r,form:u,colon:h,labelAlign:f,labelWrap:p,labelCol:m,wrapperCol:g,hideRequiredMark:v,layout:y="horizontal",scrollToFirstError:b,requiredMark:x,onFinishFailed:S,name:w,style:E,feedbackIcons:C}=e,T=OBe(e,["prefixCls","className","rootClassName","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name","style","feedbackIcons"]),A=ef(c),M=_.useContext(fte),P=_.useMemo(()=>x!==void 0?x:v?!1:s&&s.requiredMark!==void 0?s.requiredMark:!0,[v,x,s]),I=h??(s==null?void 0:s.colon),R=i("form",a),N=Mo(R),[k,O,D]=p4(R,N),B=Fe(R,`${R}-${y}`,{[`${R}-hide-required-mark`]:P===!1,[`${R}-rtl`]:n==="rtl",[`${R}-${A}`]:A},D,N,O,s==null?void 0:s.className,o,l),[z]=ene(u),{__INTERNAL__:F}=z;F.name=w;const V=_.useMemo(()=>({name:w,labelAlign:f,labelCol:m,labelWrap:p,wrapperCol:g,vertical:y==="vertical",colon:I,requiredMark:P,itemRef:F.itemRef,form:z,feedbackIcons:C}),[w,f,m,g,y,I,P,z,C]);_.useImperativeHandle(t,()=>z);const Y=(X,H)=>{if(X){let ie={block:"nearest"};typeof X=="object"&&(ie=X),z.scrollToField(H,ie)}},W=X=>{if(S==null||S(X),X.errorFields.length){const H=X.errorFields[0].name;if(b!==void 0){Y(b,H);return}s&&s.scrollToFirstError!==void 0&&Y(s.scrollToFirstError,H)}};return k(_.createElement(Ste,{disabled:d},_.createElement(iw.Provider,{value:A},_.createElement(Are,{validateMessages:M},_.createElement(cd.Provider,{value:V},_.createElement(M0,Object.assign({id:w},T,{name:w,onFinishFailed:W,form:z,style:Object.assign(Object.assign({},s==null?void 0:s.style),E),className:B})))))))},NBe=_.forwardRef(LBe),kBe=NBe;function zBe(e){if(typeof e=="function")return e;const t=Qc(e);return t.length<=1?t[0]:t}const tne=()=>{const{status:e,errors:t=[],warnings:r=[]}=_.useContext(_o);return{status:e,errors:t,warnings:r}};tne.Context=_o;const BBe=tne;function FBe(e){const[t,r]=_.useState(e),i=_.useRef(null),n=_.useRef([]),s=_.useRef(!1);_.useEffect(()=>(s.current=!1,()=>{s.current=!0,Lr.cancel(i.current),i.current=null}),[]);function a(o){s.current||(i.current===null&&(n.current=[],i.current=Lr(()=>{i.current=null,r(l=>{let c=l;return n.current.forEach(d=>{c=d(c)}),c})})),n.current.push(o))}return[t,a]}function jBe(){const{itemRef:e}=_.useContext(cd),t=_.useRef({});function r(i,n){const s=n&&typeof n=="object"&&n.ref,a=i.join("_");return(t.current.name!==a||t.current.originRef!==s)&&(t.current.name=a,t.current.originRef=s,t.current.ref=To(e(i),s)),t.current.ref}return r}const VBe=e=>{const{formItemCls:t}=e;return{"@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)":{[`${t}-control`]:{display:"flex"}}}},UBe=SF(["Form","item-item"],(e,t)=>{let{rootPrefixCls:r}=t;const i=Kie(e,r);return[VBe(i)]}),$Be=e=>{const{prefixCls:t,status:r,wrapperCol:i,children:n,errors:s,warnings:a,_internalItemRender:o,extra:l,help:c,fieldId:d,marginBottom:u,onErrorVisibleChanged:h}=e,f=`${t}-item`,p=_.useContext(cd),m=i||p.wrapperCol||{},g=Fe(`${f}-control`,m.className),v=_.useMemo(()=>Object.assign({},p),[p]);delete v.labelCol,delete v.wrapperCol;const y=_.createElement("div",{className:`${f}-control-input`},_.createElement("div",{className:`${f}-control-input-content`},n)),b=_.useMemo(()=>({prefixCls:t,status:r}),[t,r]),x=u!==null||s.length||a.length?_.createElement("div",{style:{display:"flex",flexWrap:"nowrap"}},_.createElement(NF.Provider,{value:b},_.createElement(Qie,{fieldId:d,errors:s,warnings:a,help:c,helpStatus:r,className:`${f}-explain-connected`,onVisibleChanged:h})),!!u&&_.createElement("div",{style:{width:0,height:u}})):null,S={};d&&(S.id=`${d}_extra`);const w=l?_.createElement("div",Object.assign({},S,{className:`${f}-extra`}),l):null,E=o&&o.mark==="pro_table_render"&&o.render?o.render(e,{input:y,errorList:x,extra:w}):_.createElement(_.Fragment,null,y,x,w);return _.createElement(cd.Provider,{value:v},_.createElement(Bie,Object.assign({},m,{className:g}),E),_.createElement(UBe,{prefixCls:t}))},HBe=$Be;var WBe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};const GBe=WBe;var qBe=function(t,r){return _.createElement(Ia,ae({},t,{ref:r,icon:GBe}))};const XBe=_.forwardRef(qBe);var YBe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function KBe(e){return e?typeof e=="object"&&!_.isValidElement(e)?e:{title:e}:null}const QBe=e=>{let{prefixCls:t,label:r,htmlFor:i,labelCol:n,labelAlign:s,colon:a,required:o,requiredMark:l,tooltip:c}=e;var d;const[u]=mte("Form"),{vertical:h,labelAlign:f,labelCol:p,labelWrap:m,colon:g}=_.useContext(cd);if(!r)return null;const v=n||p||{},y=s||f,b=`${t}-item-label`,x=Fe(b,y==="left"&&`${b}-left`,v.className,{[`${b}-wrap`]:!!m});let S=r;const w=a===!0||g!==!1&&a!==!1;w&&!h&&typeof r=="string"&&r.trim()!==""&&(S=r.replace(/[:|：]\s*$/,""));const C=KBe(c);if(C){const{icon:P=_.createElement(XBe,null)}=C,I=YBe(C,["icon"]),R=_.createElement(ZF,Object.assign({},I),_.cloneElement(P,{className:`${t}-item-tooltip`,title:"",onClick:N=>{N.preventDefault()},tabIndex:null}));S=_.createElement(_.Fragment,null,S,R)}const T=l==="optional",A=typeof l=="function";A?S=l(S,{required:!!o}):T&&!o&&(S=_.createElement(_.Fragment,null,S,_.createElement("span",{className:`${t}-item-optional`,title:""},(u==null?void 0:u.optional)||((d=Rp.Form)===null||d===void 0?void 0:d.optional))));const M=Fe({[`${t}-item-required`]:o,[`${t}-item-required-mark-optional`]:T||A,[`${t}-item-no-colon`]:!w});return _.createElement(Bie,Object.assign({},v,{className:x}),_.createElement("label",{htmlFor:i,className:M,title:typeof r=="string"?r:""},S))},ZBe=QBe,JBe={success:Zte,warning:ere,error:sw,validating:dM};function rne(e){let{children:t,errors:r,warnings:i,hasFeedback:n,validateStatus:s,prefixCls:a,meta:o,noStyle:l}=e;const c=`${a}-item`,{feedbackIcons:d}=_.useContext(cd),u=Jie(r,i,o,null,!!n,s),{isFormItemInput:h,status:f,hasFeedback:p,feedbackIcon:m}=_.useContext(_o),g=_.useMemo(()=>{var v;let y;if(n){const x=n!==!0&&n.icons||d,S=u&&((v=x==null?void 0:x({status:u,errors:r,warnings:i}))===null||v===void 0?void 0:v[u]),w=u&&JBe[u];y=S!==!1&&w?_.createElement("span",{className:Fe(`${c}-feedback-icon`,`${c}-feedback-icon-${u}`)},S||_.createElement(w,null)):null}const b={status:u||"",errors:r,warnings:i,hasFeedback:!!n,feedbackIcon:y,isFormItemInput:!0};return l&&(b.status=(u??f)||"",b.isFormItemInput=h,b.hasFeedback=!!(n??p),b.feedbackIcon=n!==void 0?b.feedbackIcon:m),b},[u,n,l,h,f]);return _.createElement(_o.Provider,{value:g},t)}var eFe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function tFe(e){const{prefixCls:t,className:r,rootClassName:i,style:n,help:s,errors:a,warnings:o,validateStatus:l,meta:c,hasFeedback:d,hidden:u,children:h,fieldId:f,required:p,isRequired:m,onSubItemMetaChange:g}=e,v=eFe(e,["prefixCls","className","rootClassName","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","required","isRequired","onSubItemMetaChange"]),y=`${t}-item`,{requiredMark:b}=_.useContext(cd),x=_.useRef(null),S=cA(a),w=cA(o),E=s!=null,C=!!(E||a.length||o.length),T=!!x.current&&pM(x.current),[A,M]=_.useState(null);mi(()=>{if(C&&x.current){const k=getComputedStyle(x.current);M(parseInt(k.marginBottom,10))}},[C,T]);const P=k=>{k||M(null)},R=function(){let k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const O=k?S:c.errors,D=k?w:c.warnings;return Jie(O,D,c,"",!!d,l)}(),N=Fe(y,r,i,{[`${y}-with-help`]:E||S.length||w.length,[`${y}-has-feedback`]:R&&d,[`${y}-has-success`]:R==="success",[`${y}-has-warning`]:R==="warning",[`${y}-has-error`]:R==="error",[`${y}-is-validating`]:R==="validating",[`${y}-hidden`]:u});return _.createElement("div",{className:N,style:n,ref:x},_.createElement(aze,Object.assign({className:`${y}-row`},Pa(v,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol","validateDebounce"])),_.createElement(ZBe,Object.assign({htmlFor:f},e,{requiredMark:b,required:p??m,prefixCls:t})),_.createElement(HBe,Object.assign({},e,c,{errors:S,warnings:w,prefixCls:t,status:R,help:s,marginBottom:A,onErrorVisibleChanged:P}),_.createElement(Cre.Provider,{value:g},_.createElement(rne,{prefixCls:t,meta:c,errors:c.errors,warnings:c.warnings,hasFeedback:d,validateStatus:R},h)))),!!A&&_.createElement("div",{className:`${y}-margin-offset`,style:{marginBottom:-A}}))}const rFe="__SPLIT__";function iFe(e,t){const r=Object.keys(e),i=Object.keys(t);return r.length===i.length&&r.every(n=>{const s=e[n],a=t[n];return s===a||typeof s=="function"||typeof a=="function"})}const nFe=_.memo(e=>{let{children:t}=e;return t},(e,t)=>iFe(e.control,t.control)&&e.update===t.update&&e.childProps.length===t.childProps.length&&e.childProps.every((r,i)=>r===t.childProps[i]));function NH(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}}function sFe(e){const{name:t,noStyle:r,className:i,dependencies:n,prefixCls:s,shouldUpdate:a,rules:o,children:l,required:c,label:d,messageVariables:u,trigger:h="onChange",validateTrigger:f,hidden:p,help:m}=e,{getPrefixCls:g}=_.useContext(br),{name:v}=_.useContext(cd),y=zBe(l),b=typeof y=="function",x=_.useContext(Cre),{validateTrigger:S}=_.useContext(Op),w=f!==void 0?f:S,E=t!=null,C=g("form",s),T=Mo(C),[A,M,P]=p4(C,T);rw();const I=_.useContext(Qb),R=_.useRef(),[N,k]=FBe({}),[O,D]=sp(()=>NH()),B=H=>{const ie=I==null?void 0:I.getKey(H.name);if(D(H.destroy?NH():H,!0),r&&m!==!1&&x){let Q=H.name;if(H.destroy)Q=R.current||Q;else if(ie!==void 0){const[Z,ee]=ie;Q=[Z].concat(ft(ee)),R.current=Q}x(H,Q)}},z=(H,ie)=>{k(Q=>{const Z=Object.assign({},Q),re=[].concat(ft(H.name.slice(0,-1)),ft(ie)).join(rFe);return H.destroy?delete Z[re]:Z[re]=H,Z})},[F,V]=_.useMemo(()=>{const H=ft(O.errors),ie=ft(O.warnings);return Object.values(N).forEach(Q=>{H.push.apply(H,ft(Q.errors||[])),ie.push.apply(ie,ft(Q.warnings||[]))}),[H,ie]},[N,O.errors,O.warnings]),Y=jBe();function W(H,ie,Q){return r&&!p?_.createElement(rne,{prefixCls:C,hasFeedback:e.hasFeedback,validateStatus:e.validateStatus,meta:O,errors:F,warnings:V,noStyle:!0},H):_.createElement(tFe,Object.assign({key:"row"},e,{className:Fe(i,P,T,M),prefixCls:C,fieldId:ie,isRequired:Q,errors:F,warnings:V,meta:O,onSubItemMetaChange:z}),H)}if(!E&&!b&&!n)return A(W(y));let X={};return typeof d=="string"?X.label=d:t&&(X.label=String(t)),u&&(X=Object.assign(Object.assign({},X),u)),A(_.createElement(OF,Object.assign({},e,{messageVariables:X,trigger:h,validateTrigger:w,onMetaChange:B}),(H,ie,Q)=>{const Z=X1(t).length&&ie?ie.name:[],ee=Zie(Z,v),re=c!==void 0?c:!!(o&&o.some(fe=>{if(fe&&typeof fe=="object"&&fe.required&&!fe.warningOnly)return!0;if(typeof fe=="function"){const me=fe(Q);return me&&me.required&&!me.warningOnly}return!1})),ne=Object.assign({},H);let se=null;if(Array.isArray(y)&&E)se=y;else if(!(b&&(!(a||n)||E))){if(!(n&&!b&&!E))if(Gl(y)){const fe=Object.assign(Object.assign({},y.props),ne);if(fe.id||(fe.id=ee),m||F.length>0||V.length>0||e.extra){const Ee=[];(m||F.length>0)&&Ee.push(`${ee}_help`),e.extra&&Ee.push(`${ee}_extra`),fe["aria-describedby"]=Ee.join(" ")}F.length>0&&(fe["aria-invalid"]="true"),re&&(fe["aria-required"]="true"),gd(y)&&(fe.ref=Y(Z,y)),new Set([].concat(ft(X1(h)),ft(X1(w)))).forEach(Ee=>{fe[Ee]=function(){for(var Se,de,be,ye,q,U=arguments.length,ce=new Array(U),xe=0;xe<U;xe++)ce[xe]=arguments[xe];(be=ne[Ee])===null||be===void 0||(Se=be).call.apply(Se,[ne].concat(ce)),(q=(ye=y.props)[Ee])===null||q===void 0||(de=q).call.apply(de,[ye].concat(ce))}});const Oe=[fe["aria-required"],fe["aria-invalid"],fe["aria-describedby"]];se=_.createElement(nFe,{control:ne,update:y,childProps:Oe},nl(y,fe))}else b&&(a||n)&&!E?se=y(Q):se=y}return W(se,ee,re)}))}const ine=sFe;ine.useStatus=BBe;const aFe=ine;var oFe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};const lFe=e=>{var{prefixCls:t,children:r}=e,i=oFe(e,["prefixCls","children"]);const{getPrefixCls:n}=_.useContext(br),s=n("form",t),a=_.useMemo(()=>({prefixCls:s,status:"error"}),[s]);return _.createElement(wre,Object.assign({},i),(o,l,c)=>_.createElement(NF.Provider,{value:a},r(o.map(d=>Object.assign(Object.assign({},d),{fieldKey:d.key})),l,{errors:c.errors,warnings:c.warnings})))},cFe=lFe;function uFe(){const{form:e}=_.useContext(cd);return e}const vd=kBe;vd.Item=aFe;vd.List=cFe;vd.ErrorList=Qie;vd.useForm=ene;vd.useFormInstance=uFe;vd.useWatch=Ere;vd.Provider=Are;vd.create=()=>{};const oo=vd,dFe=new Rr("antSpinMove",{to:{opacity:1}}),hFe=new Rr("antRotate",{to:{transform:"rotate(405deg)"}}),fFe=e=>{const{componentCls:t,calc:r}=e;return{[`${t}`]:Object.assign(Object.assign({},Vn(e)),{position:"absolute",display:"none",color:e.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`,"&-spinning":{position:"static",display:"inline-block",opacity:1},[`${t}-text`]:{fontSize:e.fontSize,paddingTop:r(r(e.dotSize).sub(e.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:e.colorBgMask,zIndex:e.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${e.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[`${t}-dot ${t}-dot-item`]:{backgroundColor:e.colorWhite},[`${t}-text`]:{color:e.colorTextLightSolid}},"&-nested-loading":{position:"relative",[`> div > ${t}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:e.contentHeight,[`${t}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:r(e.dotSize).mul(-1).div(2).equal()},[`${t}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${e.colorBgContainer}`},[`&${t}-show-text ${t}-dot`]:{marginTop:r(e.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${t}-dot`]:{margin:r(e.dotSizeSM).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:r(r(e.dotSizeSM).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:r(e.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${t}-dot`]:{margin:r(e.dotSizeLG).mul(-1).div(2).equal()},[`${t}-text`]:{paddingTop:r(r(e.dotSizeLG).sub(e.fontSize)).div(2).add(2).equal()},[`&${t}-show-text ${t}-dot`]:{marginTop:r(e.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${t}-container`]:{position:"relative",transition:`opacity ${e.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:e.colorBgContainer,opacity:0,transition:`all ${e.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${t}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:e.spinDotDefault},[`${t}-dot`]:{position:"relative",display:"inline-block",fontSize:e.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:r(e.dotSize).sub(r(e.marginXXS).div(2)).div(2).equal(),height:r(e.dotSize).sub(r(e.marginXXS).div(2)).div(2).equal(),backgroundColor:e.colorPrimary,borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:dFe,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:hFe,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&-sm ${t}-dot`]:{fontSize:e.dotSizeSM,i:{width:r(r(e.dotSizeSM).sub(r(e.marginXXS).div(2))).div(2).equal(),height:r(r(e.dotSizeSM).sub(r(e.marginXXS).div(2))).div(2).equal()}},[`&-lg ${t}-dot`]:{fontSize:e.dotSizeLG,i:{width:r(r(e.dotSizeLG).sub(e.marginXXS)).div(2).equal(),height:r(r(e.dotSizeLG).sub(e.marginXXS)).div(2).equal()}},[`&${t}-show-text ${t}-text`]:{display:"block"}})}},pFe=e=>{const{controlHeightLG:t,controlHeight:r}=e;return{contentHeight:400,dotSize:t/2,dotSizeSM:t*.35,dotSizeLG:r}},mFe=sa("Spin",e=>{const t=zr(e,{spinDotDefault:e.colorTextDescription});return[fFe(t)]},pFe);var gFe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};let wE=null;function vFe(e,t){const{indicator:r}=t,i=`${e}-dot`;return r===null?null:Gl(r)?nl(r,{className:Fe(r.props.className,i)}):Gl(wE)?nl(wE,{className:Fe(wE.props.className,i)}):_.createElement("span",{className:Fe(i,`${e}-dot-spin`)},_.createElement("i",{className:`${e}-dot-item`,key:1}),_.createElement("i",{className:`${e}-dot-item`,key:2}),_.createElement("i",{className:`${e}-dot-item`,key:3}),_.createElement("i",{className:`${e}-dot-item`,key:4}))}function yFe(e,t){return!!e&&!!t&&!isNaN(Number(t))}const nne=e=>{const{prefixCls:t,spinning:r=!0,delay:i=0,className:n,rootClassName:s,size:a="default",tip:o,wrapperClassName:l,style:c,children:d,fullscreen:u}=e,h=gFe(e,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen"]),{getPrefixCls:f}=_.useContext(br),p=f("spin",t),[m,g,v]=mFe(p),[y,b]=_.useState(()=>r&&!yFe(r,i));_.useEffect(()=>{if(r){const P=Lke(i,()=>{b(!0)});return P(),()=>{var I;(I=P==null?void 0:P.cancel)===null||I===void 0||I.call(P)}}b(!1)},[i,r]);const x=_.useMemo(()=>typeof d<"u"&&!u,[d,u]),{direction:S,spin:w}=_.useContext(br),E=Fe(p,w==null?void 0:w.className,{[`${p}-sm`]:a==="small",[`${p}-lg`]:a==="large",[`${p}-spinning`]:y,[`${p}-show-text`]:!!o,[`${p}-fullscreen`]:u,[`${p}-fullscreen-show`]:u&&y,[`${p}-rtl`]:S==="rtl"},n,s,g,v),C=Fe(`${p}-container`,{[`${p}-blur`]:y}),T=Pa(h,["indicator"]),A=Object.assign(Object.assign({},w==null?void 0:w.style),c),M=_.createElement("div",Object.assign({},T,{style:A,className:E,"aria-live":"polite","aria-busy":y}),vFe(p,e),o&&(x||u)?_.createElement("div",{className:`${p}-text`},o):null);return m(x?_.createElement("div",Object.assign({},T,{className:Fe(`${p}-nested-loading`,l,g,v)}),y&&_.createElement("div",{key:"loading"},M),_.createElement("div",{className:C,key:"container"},d)):M)};nne.setDefaultIndicator=e=>{wE=e};const bFe=nne;let Al=null,_E=e=>e(),uA=[],dA={};function kH(){const{prefixCls:e,getContainer:t,rtl:r,maxCount:i,top:n,bottom:s}=dA,a=e??qte().getPrefixCls("notification"),o=(t==null?void 0:t())||document.body;return{prefixCls:a,getContainer:()=>o,rtl:r,maxCount:i,top:n,bottom:s}}const xFe=_.forwardRef((e,t)=>{const[r,i]=_.useState(kH),[n,s]=Ore(r),a=qte(),o=a.getRootPrefixCls(),l=a.getIconPrefixCls(),c=a.getTheme(),d=()=>{i(kH)};return _.useEffect(d,[]),_.useImperativeHandle(t,()=>{const u=Object.assign({},n);return Object.keys(u).forEach(h=>{u[h]=function(){return d(),n[h].apply(n,arguments)}}),{instance:u,sync:d}}),_.createElement(lM,{prefixCls:o,iconPrefixCls:l,theme:c},s)});function m4(){if(!Al){const e=document.createDocumentFragment(),t={fragment:e};Al=t,_E(()=>{are(_.createElement(xFe,{ref:r=>{const{instance:i,sync:n}=r||{};Promise.resolve().then(()=>{!t.instance&&i&&(t.instance=i,t.sync=n,m4())})}}),e)});return}Al.instance&&(uA.forEach(e=>{switch(e.type){case"open":{_E(()=>{Al.instance.open(Object.assign(Object.assign({},dA),e.config))});break}case"destroy":_E(()=>{Al==null||Al.instance.destroy(e.key)});break}}),uA=[])}function wFe(e){dA=Object.assign(Object.assign({},dA),e),_E(()=>{var t;(t=Al==null?void 0:Al.sync)===null||t===void 0||t.call(Al)})}function sne(e){uA.push({type:"open",config:e}),m4()}function _Fe(e){uA.push({type:"destroy",key:e}),m4()}const SFe=["success","info","warning","error"],EFe={open:sne,destroy:_Fe,config:wFe,useNotification:sOe,_InternalPanelDoNotUseOrYouWillBeFired:KDe},ane=EFe;SFe.forEach(e=>{ane[e]=t=>sne(Object.assign(Object.assign({},t),{type:e}))});const one=ane,CFe=({children:e,isProfileOpen:t,onProfileOpen:r})=>G.jsx(qLe,{content:G.jsx(AFe,{}),trigger:"click",open:t,onOpenChange:r,children:e}),AFe=()=>{const e=Ix(),t=PJ(),r=()=>{e("/"),localStorage.clear()};return G.jsxs("div",{className:"flex flex-col justify-center items-center text-lg gap-3",children:[G.jsx("span",{className:"font-bold",children:"Профиль"}),G.jsxs("div",{className:"flex items-center gap-5",children:[G.jsx("div",{className:"rounded-3xl border-2 border-black h-12 w-12 flex items-center justify-center",children:G.jsx("img",{src:t,alt:"",className:"w-10 h-10 rounded-3xl"})}),G.jsxs("div",{className:"flex flex-col",children:[G.jsx("span",{children:"Email: vlad.solyankin@mail.ru"}),G.jsx("span",{children:"Phone: +7911111111"})]})]}),G.jsx(ql,{size:"large",children:"Сменить почту"}),G.jsx(ql,{size:"middle",type:"primary",danger:!0,onClick:()=>r(),children:"Выйти"})]})};function TFe(e){return Oee({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M64 384h384v-42.666H64V384zm0-106.666h384v-42.667H64v42.667zM64 128v42.665h384V128H64z"},child:[]}]})(e)}const MFe=({children:e})=>{const t=Ix(),r=(n,s,a)=>G.jsx("div",{className:`text-2xl ${a?`${a}:hidden`:""} flex transition duration-300 hover:-translate-y-1 hover:font-bold`,onClick:()=>t(s),children:n}),i=[{label:G.jsx("div",{className:"text-3xl font-bold flex justify-center",children:"Навигация"}),key:"0"},{label:r("Треки","/tracks","lg"),key:"1"},{label:r("Исполнители","/creators","lg"),key:"2"},{label:r("Моя музыка","/my_music","xl"),key:"3"},{label:r("Библиотека","/library","xl"),key:"4"}];return G.jsx(bBe,{className:"xl:hidden",menu:{items:i},trigger:["click"],placement:"bottomRight",arrow:{pointAtCenter:!0},children:e})},PFe=()=>{const[e,t]=_.useState(!1),r=Ix(),i=()=>t(!e);return G.jsx("div",{className:"flex justify-center items-center w-full bg-gray-12",children:G.jsxs("div",{className:"flex justify-start items-center h-32 mb-4 gap-20",children:[G.jsxs("ul",{className:"flex items-center justify-between text-white text-3xl font-jost mx-auto gap-32",children:[G.jsx("img",{onClick:()=>r("/main"),src:"/assets/logo-transparent.png",className:"w-52 cursor-pointer",alt:"Musicstream logo"}),G.jsx("li",{className:"cursor-pointer hidden lg:block",onClick:()=>r("/tracks"),children:"Треки"}),G.jsx("li",{className:"cursor-pointer hidden lg:block",onClick:()=>r("/creators"),children:"Исполнители"}),G.jsx("li",{className:"cursor-pointer hidden xl:block",onClick:()=>r("/my_music"),children:"Моя музыка"}),G.jsx("li",{className:"cursor-pointer hidden xl:block",onClick:()=>r("/other"),children:"Библиотека"})]}),G.jsx(CFe,{open:e,onOpenChange:i,children:G.jsx("div",{className:"flex flex-col items-center min-w-[56px] min-h-[56px]",onClick:()=>i,children:G.jsx("img",{src:"/assets/sign_in_icon.png",alt:"User profile button",className:"cursor-pointer w-16 h-16 object-fill"})})}),G.jsx(MFe,{children:G.jsx(TFe,{className:"text-white w-16 h-16 lg:block xl:hidden cursor-pointer"})})]})})},hw=({children:e})=>G.jsxs("div",{className:"flex flex-col justify-between min-h-screen",children:[G.jsx(PFe,{}),e,G.jsx(DAe,{})]}),IFe=()=>{const[e,t]=_.useState(!1),[r,i]=_.useState({}),n=a=>{t(!0),i(a),document.body.style.overflow="hidden"},s=()=>{t(!1),document.body.style.overflow=""};return G.jsxs(hw,{children:[G.jsx(wAe,{onPlaylistSelect:n}),G.jsx(IAe,{}),e&&G.jsx(RAe,{isVisible:e,onPlaylistClosed:s,selectedPlaylist:r})]})},RFe=()=>G.jsx("div",{className:"flex items-center justify-center mt-10 max-w-5xl mx-auto",children:G.jsx("img",{src:"/assets/mainpage_hero.png",alt:"Headphones hero image",className:"rounded-xl duration-300 hover:scale-95"})}),DFe=()=>G.jsxs("div",{className:"flex flex-col items-center max-w-5xl mx-auto my-10 gap-20 md:flex-row md:gap-30",children:[G.jsx("div",{className:"flex items-end justify-center p-10 text-center h-64 w-48 rounded-xl bg-gray-12 bg-new-tracks bg-no-repeat bg-cover bg-center shadow-white shadow-cardShadow hover:scale-110 transition-transform",children:G.jsx("span",{className:"text-lg text-white",children:"Новые треки"})}),G.jsx("div",{className:"flex items-end justify-center p-10 text-center h-64 w-48 rounded-xl bg-gray-12 bg-trending bg-no-repeat bg-cover bg-center shadow-white shadow-cardShadow hover:scale-110 transition-transform",children:G.jsx("span",{className:"text-lg text-white",children:"Вечные хиты"})}),G.jsx("div",{className:"flex items-end justify-center p-10 text-center h-64 w-48 rounded-xl bg-gray-12 bg-top-songs bg-no-repeat bg-cover bg-center shadow-white shadow-cardShadow hover:scale-110 transition-transform",children:G.jsx("span",{className:"text-lg text-white",children:"В тренде"})})]}),OFe={width:"100%",overflow:"hidden"},LFe={display:"flex",transition:"transform 0.5s ease"},NFe={minWidth:"100%"},VI=["/assets/carousel1.jpg","/assets/carousel2.jpg","/assets/carousel3.jpg"],kFe=()=>{const[e,t]=_.useState(0),r=()=>{t(n=>n===VI.length-1?0:n+1)},i=()=>{t(n=>n===0?VI.length-1:n-1)};return G.jsxs("div",{className:"relative max-w-6xl mx-auto overflow-hidden flex items-center py-20 gap-3",children:[G.jsx("svg",{onClick:i,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"black",className:"w-16 h-12 bg-white rounded-3xl",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15m0 0l6.75 6.75M4.5 12l6.75-6.75"})}),G.jsxs("div",{style:OFe,className:"border-t-2 rounded-3xl",children:[G.jsx("div",{style:{...LFe,transform:`translateX(-${e*100}%)`},children:VI.map((n,s)=>G.jsx("div",{style:NFe,children:G.jsx("img",{src:n,alt:`slide-${s}`})},s))}),G.jsxs("div",{className:"bg-gray-12 min-w-max h-24 flex flex-col justify-center px-10",children:[G.jsx("h2",{className:"text-white text-xl",children:"Лучшая музыка за месяц"}),G.jsx("span",{className:"text-gray-600",children:"Пополните свою коллекцию новыми треками..."})]})]}),G.jsx("svg",{onClick:r,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"black",className:"w-16 h-12 bg-white rounded-3xl",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12h15m0 0l-6.75-6.75M19.5 12l-6.75 6.75"})})]})},zFe=()=>G.jsxs(hw,{children:[G.jsx(RFe,{}),G.jsx(DFe,{}),G.jsx(kFe,{})]}),BFe=({setQuery:e,onTrackSearch:t})=>G.jsx("div",{children:G.jsxs("div",{className:"flex justify-between items-center bg-gray-12 max-w-5xl mx-auto h-16 border-2 border-white rounded-3xl p-6 my-14 text-lg",children:[G.jsx("input",{onChange:r=>e(r.target.value),className:"flex items-center pl-5 rounded-3xl bg-gray-600 w-2/3 h-8 text-white",placeholder:"Найдите ваши треки..."}),G.jsx("button",{onClick:t,children:G.jsx("img",{src:"/assets/search_icon.png",alt:"Search icon",className:"w-8 h-8"})})]})}),FFe=({tracks:e,onLikeClick:t})=>{const[r,i]=_.useState([]);_.useEffect(()=>{n()},[]);const n=async()=>{const a=await MJ(Kc);i(a)},s=async a=>{await nbe(Kc,a),n()};return G.jsx("div",{className:"my-5",children:G.jsx("ol",{className:"flex-col",children:e.map(a=>G.jsxs("li",{className:"border p-4 mb-4 text-white flex items-center justify-between gap-10 bg-gray-12",children:[G.jsx("img",{src:a.album.images[2].url,alt:"",className:"basis-1/8"}),G.jsx("span",{className:"text-center text-white basis-1/4",children:a.name+" - "+a.artists[0].name}),a.preview_url?G.jsx("audio",{controls:!0,src:a.preview_url,className:"bg-black basis-2/4"}):G.jsx("a",{href:a.external_urls.spotify,className:"text-lg text-[white] font-bold text-center basis-2/4",children:"Слушать на Spotify"}),G.jsx("button",{onClick:()=>s(a.id),children:G.jsx("img",{src:r.includes(a.id)?"/assets/liked.png":"/assets/unliked.png",alt:"",className:"w-8 h-7"})}),G.jsx("button",{onClick:()=>t(a.id),children:G.jsx("img",{src:"/assets/add_playlist_button.png",alt:"",className:"w-8 h-7 bg-[#000000]"})})]},a.id))})})},jFe=({onPageChange:e})=>G.jsx("ul",{className:"flex justify-between gap-10 text-white",children:Array.from({length:9},(t,r)=>G.jsx("li",{className:"border-white border-2 p-4 px-5 font-bold text-2xl hover:bg-gray-600",onClick:()=>e(r),children:r+1},r))}),zH=e=>{let t;const r=new Set,i=(l,c)=>{const d=typeof l=="function"?l(t):l;if(!Object.is(d,t)){const u=t;t=c??(typeof d!="object"||d===null)?d:Object.assign({},t,d),r.forEach(h=>h(t,u))}},n=()=>t,o={setState:i,getState:n,subscribe:l=>(r.add(l),()=>r.delete(l)),destroy:()=>{r.clear()}};return t=e(i,n,o),o},VFe=e=>e?zH(e):zH;var lne={exports:{}},cne={},une={exports:{}},dne={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wv=_;function UFe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $Fe=typeof Object.is=="function"?Object.is:UFe,HFe=Wv.useState,WFe=Wv.useEffect,GFe=Wv.useLayoutEffect,qFe=Wv.useDebugValue;function XFe(e,t){var r=t(),i=HFe({inst:{value:r,getSnapshot:t}}),n=i[0].inst,s=i[1];return GFe(function(){n.value=r,n.getSnapshot=t,UI(n)&&s({inst:n})},[e,r,t]),WFe(function(){return UI(n)&&s({inst:n}),e(function(){UI(n)&&s({inst:n})})},[e]),qFe(r),r}function UI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!$Fe(e,r)}catch{return!0}}function YFe(e,t){return t()}var KFe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?YFe:XFe;dne.useSyncExternalStore=Wv.useSyncExternalStore!==void 0?Wv.useSyncExternalStore:KFe;une.exports=dne;var QFe=une.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PM=_,ZFe=QFe;function JFe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var e4e=typeof Object.is=="function"?Object.is:JFe,t4e=ZFe.useSyncExternalStore,r4e=PM.useRef,i4e=PM.useEffect,n4e=PM.useMemo,s4e=PM.useDebugValue;cne.useSyncExternalStoreWithSelector=function(e,t,r,i,n){var s=r4e(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=n4e(function(){function l(f){if(!c){if(c=!0,d=f,f=i(f),n!==void 0&&a.hasValue){var p=a.value;if(n(p,f))return u=p}return u=f}if(p=u,e4e(d,f))return p;var m=i(f);return n!==void 0&&n(p,m)?p:(d=f,u=m)}var c=!1,d,u,h=r===void 0?null:r;return[function(){return l(t())},h===null?void 0:function(){return l(h())}]},[t,r,i,n]);var o=t4e(e,s[0],s[1]);return i4e(function(){a.hasValue=!0,a.value=o},[o]),s4e(o),o};lne.exports=cne;var a4e=lne.exports;const o4e=mT(a4e),{useDebugValue:l4e}=Ge,{useSyncExternalStoreWithSelector:c4e}=o4e;function u4e(e,t=e.getState,r){const i=c4e(e.subscribe,e.getState,e.getServerState||e.getState,t,r);return l4e(i),i}const BH=e=>{const t=typeof e=="function"?VFe(e):e,r=(i,n)=>u4e(t,i,n);return Object.assign(r,t),r},g4=e=>e?BH(e):BH,hne=g4(e=>({query:"",page:0,tracks:[],isFunctionExecuted:!1,likedTracksIds:[],setQuery:t=>e({query:t}),setPage:t=>e({page:t}),setTracks:t=>e({tracks:t}),setIsFunctionExecuted:t=>e({isFunctionExecuted:t}),setLikedTracksIds:t=>e({likedTracksIds:t}),currentUser:""}));g4(e=>({isPickerOpen:!1,selectedTrackId:"",selectedTrackPreview:"",showPicker:(t,r)=>e(()=>({isPickerOpen:!0,selectedTrackId:t,selectedTrackPreview:r})),hidePicker:()=>e(()=>({isPickerOpen:!1,selectedTrackId:"",selectedTrackPreview:""}))}));g4(e=>({isDialogOpen:!1,topArtistTracks:{},likedTrackIds:[],onLikeClick:()=>{},openDialog:()=>e({isDialogOpen:!0}),closeDialog:()=>e({isDialogOpen:!1}),setTopArtistTracks:t=>e({topArtistTracks:t}),setLikedTrackIds:t=>e({likedTrackIds:t})}));const d4e=()=>{const{query:e,page:t,tracks:r,isFunctionExecuted:i,likedTracksIds:n,setQuery:s,setPage:a,setTracks:o,setIsFunctionExecuted:l,setLikedTracksIds:c}=hne(),d=async()=>{try{const f=await fetch(`/getSearchedTracks?q=${e}&offset=${t*10}`).then(p=>p.json());o(f.tracks.items),l(!0)}catch(f){console.error("Error searching tracks:",f.message)}},u=f=>{n.includes(f)?c(n.filter(p=>p!==f)):c([...n,f]),console.log(n)},h=f=>{a(f)};return _.useEffect(()=>{i&&d()},[t,i]),G.jsxs("div",{className:"max-w-5xl mx-auto mb-52 min-h-screen",children:[G.jsx(BFe,{setQuery:s,onTrackSearch:d}),i?G.jsx(FFe,{likedTracksIds:n,tracks:r,onLikeClick:u}):G.jsx("div",{className:"min-h-screen flex justify-center items-center text-white text-5xl",children:G.jsx("b",{children:"Тут будут ваши треки..."})}),G.jsx(jFe,{onPageChange:h})]})},h4e=()=>G.jsx(hw,{children:G.jsx(d4e,{})}),f4e=({onSelect:e,onChange:t,defaultValue:r,...i})=>G.jsx(lM,{theme:{components:{Select:{optionFontSize:24}}},children:G.jsx(f4,{align:"end",direction:"vertical",className:"w-full my-5",children:G.jsxs(b_,{defaultValue:r,size:"large",style:{width:180,height:60},onChange:t,onSelect:e,...i,children:[G.jsx(b_.Option,{value:"sort",disabled:!0,children:"Сортировка"}),G.jsx(b_.Option,{value:"asc",children:"A-Z"}),G.jsx(b_.Option,{value:"desc",children:"Z-A"})]})})}),p4e=({playlist:e,trackId:t,previewUrl:r,onPlaylistSelect:i})=>G.jsxs("div",{children:[G.jsx("div",{className:"bg-gray-100 p-2 rounded flex items-center",children:G.jsx("button",{onClick:()=>{ibe(Kc,e.id,r,t),i()},children:G.jsx("img",{className:"w-44 h-44 rounded mr-2 hover:scale-90 duration-150",src:e.imagePath,alt:e.title})})}),G.jsx("h2",{className:"text-white text-xl text-center",children:e.title})]},e.id),m4e=({isPickerOpen:e,onPickerClose:t,trackId:r,previewUrl:i})=>{const[n,s]=_.useState([]);return IJ(s,Kc),G.jsxs(oF,{open:e,onClose:t,maxWidth:"lg",children:[G.jsx(cF,{className:"text-center",children:"Выберите плейлист для добавления"}),G.jsx(lF,{className:"grid grid-cols-5 bg-gray-12",children:n.map(a=>G.jsx(p4e,{playlist:a,trackId:r,previewUrl:i,onPlaylistSelect:()=>t()},hF()))})]})};var g4e=[{id:"fa",name:"Font Awesome",projectUrl:"https://fontawesome.com/",license:"CC BY 4.0 License",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"},{id:"io",name:"Ionicons 4",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"io5",name:"Ionicons 5",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"md",name:"Material Design icons",projectUrl:"http://google.github.io/material-design-icons/",license:"Apache License Version 2.0",licenseUrl:"https://github.com/google/material-design-icons/blob/master/LICENSE"},{id:"ti",name:"Typicons",projectUrl:"http://s-ings.com/typicons/",license:"CC BY-SA 3.0",licenseUrl:"https://creativecommons.org/licenses/by-sa/3.0/"},{id:"go",name:"Github Octicons icons",projectUrl:"https://octicons.github.com/",license:"MIT",licenseUrl:"https://github.com/primer/octicons/blob/master/LICENSE"},{id:"fi",name:"Feather",projectUrl:"https://feathericons.com/",license:"MIT",licenseUrl:"https://github.com/feathericons/feather/blob/master/LICENSE"},{id:"gi",name:"Game Icons",projectUrl:"https://game-icons.net/",license:"CC BY 3.0",licenseUrl:"https://creativecommons.org/licenses/by/3.0/"},{id:"wi",name:"Weather Icons",projectUrl:"https://erikflowers.github.io/weather-icons/",license:"SIL OFL 1.1",licenseUrl:"http://scripts.sil.org/OFL"},{id:"di",name:"Devicons",projectUrl:"https://vorillaz.github.io/devicons/",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ai",name:"Ant Design Icons",projectUrl:"https://github.com/ant-design/ant-design-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"bs",name:"Bootstrap Icons",projectUrl:"https://github.com/twbs/icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ri",name:"Remix Icon",projectUrl:"https://github.com/Remix-Design/RemixIcon",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"fc",name:"Flat Color Icons",projectUrl:"https://github.com/icons8/flat-color-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"gr",name:"Grommet-Icons",projectUrl:"https://github.com/grommet/grommet-icons",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"hi",name:"Heroicons",projectUrl:"https://github.com/refactoringui/heroicons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"si",name:"Simple Icons",projectUrl:"https://simpleicons.org/",license:"CC0 1.0 Universal",licenseUrl:"https://creativecommons.org/publicdomain/zero/1.0/"},{id:"im",name:"IcoMoon Free",projectUrl:"https://github.com/Keyamoon/IcoMoon-Free",license:"CC BY 4.0 License"},{id:"bi",name:"BoxIcons",projectUrl:"https://github.com/atisawd/boxicons",license:"CC BY 4.0 License"},{id:"cg",name:"css.gg",projectUrl:"https://github.com/astrit/css.gg",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"vsc",name:"VS Code Icons",projectUrl:"https://github.com/microsoft/vscode-codicons",license:"CC BY 4.0",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"}],v4={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},EL=Ge.createContext&&Ge.createContext(v4),Mh=globalThis&&globalThis.__assign||function(){return Mh=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Mh.apply(this,arguments)},v4e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function fne(e){return e&&e.map(function(t,r){return Ge.createElement(t.tag,Mh({key:r},t.attr),fne(t.child))})}function y4e(e){return function(t){return Ge.createElement(pne,Mh({attr:Mh({},e.attr)},t),fne(e.child))}}function pne(e){var t=function(r){var i=e.attr,n=e.size,s=e.title,a=v4e(e,["attr","size","title"]),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Ge.createElement("svg",Mh({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:Mh(Mh({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&Ge.createElement("title",null,s),e.children)};return EL!==void 0?Ge.createElement(EL.Consumer,null,function(r){return t(r)}):t(v4)}const b4e=Object.freeze(Object.defineProperty({__proto__:null,DefaultContext:v4,GenIcon:y4e,IconBase:pne,IconContext:EL,IconsManifest:g4e},Symbol.toStringTag,{value:"Module"})),x4e=uce(b4e);var w4e=x4e.GenIcon,_4e=function(t){return w4e({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"square",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288m144-144H112"}}]})(t)};const S4e=({tracks:e,onLikeClick:t,likedTracksIds:r})=>{const[i,n]=_.useState(!1),[s,a]=_.useState(""),[o,l]=_.useState(""),c=(u,h)=>{n(!0),a(u),l(h)},d=()=>n(!1);return G.jsxs("div",{className:"my-5",children:[G.jsx("ol",{className:"flex-col",children:e.items.map(u=>G.jsxs("li",{className:"border p-4 mb-4 text-white flex items-center justify-between gap-10 bg-gray-12",children:[G.jsx("img",{src:u.album.images[2].url,alt:"",className:"basis-1/8"}),G.jsx("span",{className:"text-center text-white basis-1/4",children:u.name+" - "+u.artists[0].name}),u.preview_url&&G.jsx("audio",{controls:!0,src:u.preview_url,className:"bg-white basis-2/4"})||G.jsx("a",{className:"h-8 hover:font-bold text-center text-xl transform duration-150 basis-2/4",href:u.external_urls.spotify,children:"Слушать на Spotify"}),G.jsx("button",{onClick:()=>t(u.id),children:G.jsx("img",{src:"/assets/liked.png",alt:"",className:"w-8 h-7"})}),G.jsx("button",{onClick:()=>c(u.id,u.preview_url),children:G.jsx(_4e,{className:"w-12 h-12"})})]},u.id))}),G.jsx(m4e,{isPickerOpen:i,onPickerClose:d,trackId:s,previewUrl:o})]})},E4e=({isDialogOpen:e,onDialogClose:t,topArtistTracks:r,likedTrackIds:i,onLikeClick:n})=>G.jsxs(oF,{open:e,onClose:t,maxWidth:"lg",children:[G.jsx(cF,{className:"text-center",children:"Популярные треки исполнителя"}),G.jsx(lF,{className:"bg-gray-12",children:G.jsx(S4e,{tracks:r.tracks,likedTracksIds:i,onLikeClick:n})})]}),C4e=({isSpinning:e})=>G.jsxs("div",{className:"flex flex-col gap-5",children:[G.jsx(bFe,{indicator:G.jsx(dM,{style:{fontSize:48}}),spinning:e}),G.jsx("span",{className:"text-2xl text-white",children:"Loading..."})]}),A4e=()=>{const{likedTrackIds:e}=hne(),[t,r]=_.useState([]),[i,n]=_.useState({}),[s,a]=_.useState(!1),[o,l]=_.useState(!1),[c,d]=_.useState(!0),u=()=>{setTimeout(()=>{d(!1)},3e3)},h=()=>{const y=[],b="A".charCodeAt(0),x="Z".charCodeAt(0);for(let S=b;S<=x;S++)y.push(String.fromCharCode(S));return y},f=async y=>{try{return(await(await fetch(`/getArtists?q=${y}`)).json()).artists.items.map(S=>({name:S.name,image:S.images[0].url||S.images[1]||S.images[2]}))}catch(b){return console.error("Error fetching artists:",b.message),[]}},p=async y=>{try{const x=await(await fetch(`/getTracks?q=${y}`)).json();console.log(x),n(x)}catch(b){return console.error("Error fetching tracks: ",b.message),[]}};_.useEffect(()=>{u(),(async()=>{const b=await Promise.all(h().map(async x=>{const S=await f(x);return{letter:x,artists:S}}));r(b)})(),console.log(t)},[]);const m=async y=>{await p(y),a(!0)},g=()=>{a(!1)},v=y=>{(!o&&y==="desc"||o&&y==="asc")&&(r(t.slice().reverse()),l(!o))};return G.jsxs("div",{className:"flex justify-center",children:[!c&&G.jsxs("div",{children:[G.jsx(f4e,{defaultValue:"Сортировка",onChange:()=>{},onSelect:v}),G.jsxs("div",{className:"flex flex-col items-center gap-20 my-10",children:[G.jsx("div",{children:t.map((y,b)=>G.jsxs("div",{className:"flex flex-col gap-3",children:[G.jsxs("span",{className:"text-white text-5xl font-jost",children:[y.letter,":"]}),G.jsx("div",{className:"grid gap-20 2xl:grid-cols-playlistsWrap-2xl xl:grid-cols-playlistsWrap-xl lg:grid-cols-playlistsWrap-lg md:grid-cols-playlistsWrap-md sm:grid-cols-playlistsWrap-sm text-white gap-5",children:y.artists.map((x,S)=>G.jsxs("div",{className:"flex flex-col items-center gap-2",children:[G.jsx("button",{onClick:()=>m(x.name),children:G.jsx("img",{className:"w-64 h-64 rounded-xl hover:scale-105",src:x.image||"",alt:"Artist image"})}),G.jsx("span",{className:"text-2xl text-white w-48 text-center",children:x.name})]},S))},b)]},y.toString()+b.toString()))}),G.jsx(E4e,{isDialogOpen:s,onDialogClose:g,topArtistTracks:i,likedTrackIds:e,onLikeClick:()=>{}})]})]}),c&&G.jsx(C4e,{isSpinning:c})]})},T4e=()=>G.jsx("div",{className:"flex flex-col justify-between min-h-screen",children:G.jsx(hw,{children:G.jsx(A4e,{})})}),M4e=iF(G.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),P4e=iF(G.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"}),"DownloadOutlined"),I4e=()=>(console.log(PJ()),G.jsxs("div",{className:"min-h-screen flex flex-col mx-auto w-[100dvw] max-w-6xl mt-10",children:[G.jsxs("div",{className:"flex items-center justify-between",children:[G.jsx("div",{children:G.jsx("h2",{className:"text-white text-4xl",children:"Библиотека треков"})}),G.jsxs("div",{className:"flex flex-center items-center gap-5",children:[G.jsx(ql,{className:"border-white flex items-center",type:"primary",shape:"default",icon:G.jsx(P4e,{}),size:"large",children:"Скачать всё"}),G.jsx(ql,{className:"border-white flex items-center",type:"primary",shape:"default",icon:G.jsx(M4e,{}),size:"large",children:"Новый трек"})]})]}),G.jsx("div",{className:"flex flex-col items-center justify-between",children:G.jsx("audio",{src:""})})]})),R4e=()=>G.jsx(hw,{children:G.jsx(I4e,{})}),D4e="modulepreload",O4e=function(e,t){return new URL(e,t).href},FH={},R0=function(t,r,i){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(s=>{if(s=O4e(s,i),s in FH)return;FH[s]=!0;const a=s.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!i)for(let d=n.length-1;d>=0;d--){const u=n[d];if(u.href===s&&(!a||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":D4e,a||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),a)return new Promise((d,u)=>{c.addEventListener("load",d),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};var L4e=Object.create,IM=Object.defineProperty,N4e=Object.getOwnPropertyDescriptor,k4e=Object.getOwnPropertyNames,z4e=Object.getPrototypeOf,B4e=Object.prototype.hasOwnProperty,F4e=(e,t,r)=>t in e?IM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,us=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),j4e=(e,t)=>{for(var r in t)IM(e,r,{get:t[r],enumerable:!0})},V4e=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of k4e(t))!B4e.call(e,n)&&n!==r&&IM(e,n,{get:()=>t[n],enumerable:!(i=N4e(t,n))||i.enumerable});return e},Pn=(e,t,r)=>(r=e!=null?L4e(z4e(e)):{},V4e(t||!e||!e.__esModule?IM(r,"default",{value:e,enumerable:!0}):r,e)),fa=(e,t,r)=>(F4e(e,typeof t!="symbol"?t+"":t,r),r),U4e=us((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var s=new r;return s.importState(n),s},r;function r(){return function(n){var s=0,a=0,o=0,l=1;n.length==0&&(n=[+new Date]);var c=i();s=c(" "),a=c(" "),o=c(" ");for(var d=0;d<n.length;d++)s-=c(n[d]),s<0&&(s+=1),a-=c(n[d]),a<0&&(a+=1),o-=c(n[d]),o<0&&(o+=1);c=null;var u=function(){var h=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=h-(l=h|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=n,u.exportState=function(){return[s,a,o,l]},u.importState=function(h){s=+h[0]||0,a=+h[1]||0,o=+h[2]||0,l=+h[3]||0},u}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){n+=a.charCodeAt(o);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),mne=us((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,d,u,h,f,p,m,g,v,y,b,x=i[0].length,S=i.length;if(S<x)throw new TypeError("Invalid matrix: m < n");for(var w=[],E=[],C=[],T=n==="f"?S:x,A=v=p=0;A<S;A++)E[A]=new Array(T).fill(0);for(A=0;A<x;A++)C[A]=new Array(x).fill(0);var M,P=new Array(x).fill(0);for(A=0;A<S;A++)for(l=0;l<x;l++)E[A][l]=i[A][l];for(A=0;A<x;A++){for(w[A]=p,g=0,d=A+1,l=A;l<S;l++)g+=Math.pow(E[l][A],2);if(g<o)p=0;else for(m=(f=E[A][A])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,E[A][A]=f-p,l=d;l<x;l++){for(g=0,c=A;c<S;c++)g+=E[c][A]*E[c][l];for(f=g/m,c=A;c<S;c++)E[c][l]=E[c][l]+f*E[c][A]}for(P[A]=p,g=0,l=d;l<x;l++)g+=Math.pow(E[A][l],2);if(g<o)p=0;else{for(m=(f=E[A][A+1])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,E[A][A+1]=f-p,l=d;l<x;l++)w[l]=E[A][l]/m;for(l=d;l<S;l++){for(g=0,c=d;c<x;c++)g+=E[l][c]*E[A][c];for(c=d;c<x;c++)E[l][c]=E[l][c]+g*w[c]}}v<(y=Math.abs(P[A])+Math.abs(w[A]))&&(v=y)}if(s)for(A=x-1;0<=A;A--){if(p!==0){for(m=E[A][A+1]*p,l=d;l<x;l++)C[l][A]=E[A][l]/m;for(l=d;l<x;l++){for(g=0,c=d;c<x;c++)g+=E[A][c]*C[c][l];for(c=d;c<x;c++)C[c][l]=C[c][l]+g*C[c][A]}}for(l=d;l<x;l++)C[A][l]=0,C[l][A]=0;C[A][A]=1,p=w[A],d=A}if(n){if(n==="f")for(A=x;A<S;A++){for(l=x;l<S;l++)E[A][l]=0;E[A][A]=1}for(A=x-1;0<=A;A--){for(d=A+1,p=P[A],l=d;l<T;l++)E[A][l]=0;if(p!==0){for(m=E[A][A]*p,l=d;l<T;l++){for(g=0,c=d;c<S;c++)g+=E[c][A]*E[c][l];for(f=g/m,c=A;c<S;c++)E[c][l]=E[c][l]+f*E[c][A]}for(l=A;l<S;l++)E[l][A]=E[l][A]/p}else for(l=A;l<S;l++)E[l][A]=0;E[A][A]=E[A][A]+1}}for(a*=v,c=x-1;0<=c;c--)for(var I=0;I<50;I++){for(M=!1,d=c;0<=d;d--){if(Math.abs(w[d])<=a){M=!0;break}if(Math.abs(P[d-1])<=a)break}if(!M){for(h=0,u=d-(g=1),A=d;A<c+1&&(f=g*w[A],w[A]=h*w[A],!(Math.abs(f)<=a));A++)if(p=P[A],P[A]=Math.sqrt(f*f+p*p),h=p/(m=P[A]),g=-f/m,n)for(l=0;l<S;l++)y=E[l][u],b=E[l][A],E[l][u]=y*h+b*g,E[l][A]=-y*g+b*h}if(b=P[c],d===c){if(b<0&&(P[c]=-b,s))for(l=0;l<x;l++)C[l][c]=-C[l][c];break}for(v=P[d],f=(((y=P[c-1])-b)*(y+b)+((p=w[c-1])-(m=w[c]))*(p+m))/(2*m*y),p=Math.sqrt(f*f+1),f=((v-b)*(v+b)+m*(y/(f<0?f-p:f+p)-m))/v,A=d+(g=h=1);A<c+1;A++){if(p=w[A],y=P[A],m=g*p,p*=h,b=Math.sqrt(f*f+m*m),f=v*(h=f/(w[A-1]=b))+p*(g=m/b),p=-v*g+p*h,m=y*g,y*=h,s)for(l=0;l<x;l++)v=C[l][A-1],b=C[l][A],C[l][A-1]=v*h+b*g,C[l][A]=-v*g+b*h;if(b=Math.sqrt(f*f+m*m),f=(h=f/(P[A-1]=b))*p+(g=m/b)*y,v=-g*p+h*y,n)for(l=0;l<S;l++)y=E[l][A-1],b=E[l][A],E[l][A-1]=y*h+b*g,E[l][A]=-y*g+b*h}w[d]=0,w[c]=f,P[c]=v}for(A=0;A<x;A++)P[A]<a&&(P[A]=0);return{u:E,q:P,v:C}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),$4e=us((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())})(e,function(){var r=function(n,s){if(n===void 0&&(n=[]),s===void 0&&(s=i),this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};r.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(n){for(var s=this,a=s.data,o=s.compare,l=a[n];n>0;){var c=n-1>>1,d=a[c];if(o(l,d)>=0)break;a[n]=d,n=c}a[n]=l},r.prototype._down=function(n){for(var s=this,a=s.data,o=s.compare,l=this.length>>1,c=a[n];n<l;){var d=(n<<1)+1,u=a[d],h=d+1;if(h<this.length&&o(a[h],u)<0&&(d=h,u=a[h]),o(u,c)>=0)break;a[n]=u,n=d}a[n]=c};function i(n,s){return n<s?-1:n>s?1:0}return r})}),H4e=us((e,t)=>{var r=$4e();r.default&&(r=r.default),t.exports=i,t.exports.default=i;function i(c,d,u){d=d||1;for(var h,f,p,m,g=0;g<c[0].length;g++){var v=c[0][g];(!g||v[0]<h)&&(h=v[0]),(!g||v[1]<f)&&(f=v[1]),(!g||v[0]>p)&&(p=v[0]),(!g||v[1]>m)&&(m=v[1])}var y=p-h,b=m-f,x=Math.min(y,b),S=x/2;if(x===0){var w=[h,f];return w.distance=0,w}for(var E=new r(void 0,n),C=h;C<p;C+=x)for(var T=f;T<m;T+=x)E.push(new s(C+S,T+S,S,c));var A=o(c),M=new s(h+y/2,f+b/2,0,c);M.d>A.d&&(A=M);for(var P=E.length;E.length;){var I=E.pop();I.d>A.d&&(A=I,u&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,P)),!(I.max-A.d<=d)&&(S=I.h/2,E.push(new s(I.x-S,I.y-S,S,c)),E.push(new s(I.x+S,I.y-S,S,c)),E.push(new s(I.x-S,I.y+S,S,c)),E.push(new s(I.x+S,I.y+S,S,c)),P+=4)}u&&(console.log("num probes: "+P),console.log("best distance: "+A.d));var R=[A.x,A.y];return R.distance=A.d,R}function n(c,d){return d.max-c.max}function s(c,d,u,h){this.x=c,this.y=d,this.h=u,this.d=a(c,d,h),this.max=this.d+this.h*Math.SQRT2}function a(c,d,u){for(var h=!1,f=1/0,p=0;p<u.length;p++)for(var m=u[p],g=0,v=m.length,y=v-1;g<v;y=g++){var b=m[g],x=m[y];b[1]>d!=x[1]>d&&c<(x[0]-b[0])*(d-b[1])/(x[1]-b[1])+b[0]&&(h=!h),f=Math.min(f,l(c,d,b,x))}return f===0?0:(h?1:-1)*Math.sqrt(f)}function o(c){for(var d=0,u=0,h=0,f=c[0],p=0,m=f.length,g=m-1;p<m;g=p++){var v=f[p],y=f[g],b=v[0]*y[1]-y[0]*v[1];u+=(v[0]+y[0])*b,h+=(v[1]+y[1])*b,d+=b*3}return d===0?new s(f[0][0],f[0][1],0,c):new s(u/d,h/d,0,c)}function l(c,d,u,h){var f=u[0],p=u[1],m=h[0]-f,g=h[1]-p;if(m!==0||g!==0){var v=((c-f)*m+(d-p)*g)/(m*m+g*g);v>1?(f=h[0],p=h[1]):v>0&&(f+=m*v,p+=g*v)}return m=c-f,g=d-p,m*m+g*g}}),W4e=us((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}t.exports=e.default}),G4e=us((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}t.exports=e.default}),q4e=us(e=>{(function(){var t=function(){this.init()};t.prototype={init:function(){var u=this||r;return u._counter=1e3,u._html5AudioPool=[],u.html5PoolSize=10,u._codecs={},u._howls=[],u._muted=!1,u._volume=1,u._canPlayEvent="canplaythrough",u._navigator=typeof window<"u"&&window.navigator?window.navigator:null,u.masterGain=null,u.noAudio=!1,u.usingWebAudio=!0,u.autoSuspend=!0,u.ctx=null,u.autoUnlock=!0,u._setup(),u},volume:function(u){var h=this||r;if(u=parseFloat(u),h.ctx||d(),typeof u<"u"&&u>=0&&u<=1){if(h._volume=u,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(u,r.ctx.currentTime);for(var f=0;f<h._howls.length;f++)if(!h._howls[f]._webAudio)for(var p=h._howls[f]._getSoundIds(),m=0;m<p.length;m++){var g=h._howls[f]._soundById(p[m]);g&&g._node&&(g._node.volume=g._volume*u)}return h}return h._volume},mute:function(u){var h=this||r;h.ctx||d(),h._muted=u,h.usingWebAudio&&h.masterGain.gain.setValueAtTime(u?0:h._volume,r.ctx.currentTime);for(var f=0;f<h._howls.length;f++)if(!h._howls[f]._webAudio)for(var p=h._howls[f]._getSoundIds(),m=0;m<p.length;m++){var g=h._howls[f]._soundById(p[m]);g&&g._node&&(g._node.muted=u?!0:g._muted)}return h},stop:function(){for(var u=this||r,h=0;h<u._howls.length;h++)u._howls[h].stop();return u},unload:function(){for(var u=this||r,h=u._howls.length-1;h>=0;h--)u._howls[h].unload();return u.usingWebAudio&&u.ctx&&typeof u.ctx.close<"u"&&(u.ctx.close(),u.ctx=null,d()),u},codecs:function(u){return(this||r)._codecs[u.replace(/^x-/,"")]},_setup:function(){var u=this||r;if(u.state=u.ctx&&u.ctx.state||"suspended",u._autoSuspend(),!u.usingWebAudio)if(typeof Audio<"u")try{var h=new Audio;typeof h.oncanplaythrough>"u"&&(u._canPlayEvent="canplay")}catch{u.noAudio=!0}else u.noAudio=!0;try{var h=new Audio;h.muted&&(u.noAudio=!0)}catch{}return u.noAudio||u._setupCodecs(),u},_setupCodecs:function(){var u=this||r,h=null;try{h=typeof Audio<"u"?new Audio:null}catch{return u}if(!h||typeof h.canPlayType!="function")return u;var f=h.canPlayType("audio/mpeg;").replace(/^no$/,""),p=u._navigator?u._navigator.userAgent:"",m=p.match(/OPR\/([0-6].)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,v=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,y=p.match(/Version\/(.*?) /),b=v&&y&&parseInt(y[1],10)<15;return u._codecs={mp3:!!(!g&&(f||h.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(h.canPlayType('audio/wav; codecs="1"')||h.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(h.canPlayType("audio/x-m4b;")||h.canPlayType("audio/m4b;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},u},_unlockAudio:function(){var u=this||r;if(!(u._audioUnlocked||!u.ctx)){u._audioUnlocked=!1,u.autoUnlock=!1,!u._mobileUnloaded&&u.ctx.sampleRate!==44100&&(u._mobileUnloaded=!0,u.unload()),u._scratchBuffer=u.ctx.createBuffer(1,1,22050);var h=function(f){for(;u._html5AudioPool.length<u.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,u._releaseHtml5Audio(p)}catch{u.noAudio=!0;break}for(var m=0;m<u._howls.length;m++)if(!u._howls[m]._webAudio)for(var g=u._howls[m]._getSoundIds(),v=0;v<g.length;v++){var y=u._howls[m]._soundById(g[v]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}u._autoResume();var b=u.ctx.createBufferSource();b.buffer=u._scratchBuffer,b.connect(u.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof u.ctx.resume=="function"&&u.ctx.resume(),b.onended=function(){b.disconnect(0),u._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0),document.removeEventListener("keydown",h,!0);for(var x=0;x<u._howls.length;x++)u._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),document.addEventListener("keydown",h,!0),u}},_obtainHtml5Audio:function(){var u=this||r;if(u._html5AudioPool.length)return u._html5AudioPool.pop();var h=new Audio().play();return h&&typeof Promise<"u"&&(h instanceof Promise||typeof h.then=="function")&&h.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(u){var h=this||r;return u._unlocked&&h._html5AudioPool.push(u),h},_autoSuspend:function(){var u=this;if(!(!u.autoSuspend||!u.ctx||typeof u.ctx.suspend>"u"||!r.usingWebAudio)){for(var h=0;h<u._howls.length;h++)if(u._howls[h]._webAudio){for(var f=0;f<u._howls[h]._sounds.length;f++)if(!u._howls[h]._sounds[f]._paused)return u}return u._suspendTimer&&clearTimeout(u._suspendTimer),u._suspendTimer=setTimeout(function(){if(u.autoSuspend){u._suspendTimer=null,u.state="suspending";var p=function(){u.state="suspended",u._resumeAfterSuspend&&(delete u._resumeAfterSuspend,u._autoResume())};u.ctx.suspend().then(p,p)}},3e4),u}},_autoResume:function(){var u=this;if(!(!u.ctx||typeof u.ctx.resume>"u"||!r.usingWebAudio))return u.state==="running"&&u.ctx.state!=="interrupted"&&u._suspendTimer?(clearTimeout(u._suspendTimer),u._suspendTimer=null):u.state==="suspended"||u.state==="running"&&u.ctx.state==="interrupted"?(u.ctx.resume().then(function(){u.state="running";for(var h=0;h<u._howls.length;h++)u._howls[h]._emit("resume")}),u._suspendTimer&&(clearTimeout(u._suspendTimer),u._suspendTimer=null)):u.state==="suspending"&&(u._resumeAfterSuspend=!0),u}};var r=new t,i=function(u){var h=this;if(!u.src||u.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}h.init(u)};i.prototype={init:function(u){var h=this;return r.ctx||d(),h._autoplay=u.autoplay||!1,h._format=typeof u.format!="string"?u.format:[u.format],h._html5=u.html5||!1,h._muted=u.mute||!1,h._loop=u.loop||!1,h._pool=u.pool||5,h._preload=typeof u.preload=="boolean"||u.preload==="metadata"?u.preload:!0,h._rate=u.rate||1,h._sprite=u.sprite||{},h._src=typeof u.src!="string"?u.src:[u.src],h._volume=u.volume!==void 0?u.volume:1,h._xhr={method:u.xhr&&u.xhr.method?u.xhr.method:"GET",headers:u.xhr&&u.xhr.headers?u.xhr.headers:null,withCredentials:u.xhr&&u.xhr.withCredentials?u.xhr.withCredentials:!1},h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=u.onend?[{fn:u.onend}]:[],h._onfade=u.onfade?[{fn:u.onfade}]:[],h._onload=u.onload?[{fn:u.onload}]:[],h._onloaderror=u.onloaderror?[{fn:u.onloaderror}]:[],h._onplayerror=u.onplayerror?[{fn:u.onplayerror}]:[],h._onpause=u.onpause?[{fn:u.onpause}]:[],h._onplay=u.onplay?[{fn:u.onplay}]:[],h._onstop=u.onstop?[{fn:u.onstop}]:[],h._onmute=u.onmute?[{fn:u.onmute}]:[],h._onvolume=u.onvolume?[{fn:u.onvolume}]:[],h._onrate=u.onrate?[{fn:u.onrate}]:[],h._onseek=u.onseek?[{fn:u.onseek}]:[],h._onunlock=u.onunlock?[{fn:u.onunlock}]:[],h._onresume=[],h._webAudio=r.usingWebAudio&&!h._html5,typeof r.ctx<"u"&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h._preload!=="none"&&h.load(),h},load:function(){var u=this,h=null;if(r.noAudio){u._emit("loaderror",null,"No audio support.");return}typeof u._src=="string"&&(u._src=[u._src]);for(var f=0;f<u._src.length;f++){var p,m;if(u._format&&u._format[f])p=u._format[f];else{if(m=u._src[f],typeof m!="string"){u._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(m),p||(p=/\.([^.]+)$/.exec(m.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&r.codecs(p)){h=u._src[f];break}}if(!h){u._emit("loaderror",null,"No codec support for selected audio sources.");return}return u._src=h,u._state="loading",window.location.protocol==="https:"&&h.slice(0,5)==="http:"&&(u._html5=!0,u._webAudio=!1),new n(u),u._webAudio&&a(u),u},play:function(u,h){var f=this,p=null;if(typeof u=="number")p=u,u=null;else{if(typeof u=="string"&&f._state==="loaded"&&!f._sprite[u])return null;if(typeof u>"u"&&(u="__default",!f._playLock)){for(var m=0,g=0;g<f._sounds.length;g++)f._sounds[g]._paused&&!f._sounds[g]._ended&&(m++,p=f._sounds[g]._id);m===1?u=null:p=null}}var v=p?f._soundById(p):f._inactiveSound();if(!v)return null;if(p&&!u&&(u=v._sprite||"__default"),f._state!=="loaded"){v._sprite=u,v._ended=!1;var y=v._id;return f._queue.push({event:"play",action:function(){f.play(y)}}),y}if(p&&!v._paused)return h||f._loadQueue("play"),v._id;f._webAudio&&r._autoResume();var b=Math.max(0,v._seek>0?v._seek:f._sprite[u][0]/1e3),x=Math.max(0,(f._sprite[u][0]+f._sprite[u][1])/1e3-b),S=x*1e3/Math.abs(v._rate),w=f._sprite[u][0]/1e3,E=(f._sprite[u][0]+f._sprite[u][1])/1e3;v._sprite=u,v._ended=!1;var C=function(){v._paused=!1,v._seek=b,v._start=w,v._stop=E,v._loop=!!(v._loop||f._sprite[u][2])};if(b>=E){f._ended(v);return}var T=v._node;if(f._webAudio){var A=function(){f._playLock=!1,C(),f._refreshBuffer(v);var R=v._muted||f._muted?0:v._volume;T.gain.setValueAtTime(R,r.ctx.currentTime),v._playStart=r.ctx.currentTime,typeof T.bufferSource.start>"u"?v._loop?T.bufferSource.noteGrainOn(0,b,86400):T.bufferSource.noteGrainOn(0,b,x):v._loop?T.bufferSource.start(0,b,86400):T.bufferSource.start(0,b,x),S!==1/0&&(f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),S)),h||setTimeout(function(){f._emit("play",v._id),f._loadQueue()},0)};r.state==="running"&&r.ctx.state!=="interrupted"?A():(f._playLock=!0,f.once("resume",A),f._clearTimer(v._id))}else{var M=function(){T.currentTime=b,T.muted=v._muted||f._muted||r._muted||T.muted,T.volume=v._volume*r.volume(),T.playbackRate=v._rate;try{var R=T.play();if(R&&typeof Promise<"u"&&(R instanceof Promise||typeof R.then=="function")?(f._playLock=!0,C(),R.then(function(){f._playLock=!1,T._unlocked=!0,h?f._loadQueue():f._emit("play",v._id)}).catch(function(){f._playLock=!1,f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):h||(f._playLock=!1,C(),f._emit("play",v._id)),T.playbackRate=v._rate,T.paused){f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}u!=="__default"||v._loop?f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),S):(f._endTimers[v._id]=function(){f._ended(v),T.removeEventListener("ended",f._endTimers[v._id],!1)},T.addEventListener("ended",f._endTimers[v._id],!1))}catch(N){f._emit("playerror",v._id,N)}};T.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(T.src=f._src,T.load());var P=window&&window.ejecta||!T.readyState&&r._navigator.isCocoonJS;if(T.readyState>=3||P)M();else{f._playLock=!0,f._state="loading";var I=function(){f._state="loaded",M(),T.removeEventListener(r._canPlayEvent,I,!1)};T.addEventListener(r._canPlayEvent,I,!1),f._clearTimer(v._id)}}return v._id},pause:function(u){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"pause",action:function(){h.pause(u)}}),h;for(var f=h._getSoundIds(u),p=0;p<f.length;p++){h._clearTimer(f[p]);var m=h._soundById(f[p]);if(m&&!m._paused&&(m._seek=h.seek(f[p]),m._rateSeek=0,m._paused=!0,h._stopFade(f[p]),m._node))if(h._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),h._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||h._emit("pause",m?m._id:null)}return h},stop:function(u,h){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(u)}}),f;for(var p=f._getSoundIds(u),m=0;m<p.length;m++){f._clearTimer(p[m]);var g=f._soundById(p[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,f._stopFade(p[m]),g._node&&(f._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),f._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&f._clearSound(g._node))),h||f._emit("stop",g._id))}return f},mute:function(u,h){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(u,h)}}),f;if(typeof h>"u")if(typeof u=="boolean")f._muted=u;else return f._muted;for(var p=f._getSoundIds(h),m=0;m<p.length;m++){var g=f._soundById(p[m]);g&&(g._muted=u,g._interval&&f._stopFade(g._id),f._webAudio&&g._node?g._node.gain.setValueAtTime(u?0:g._volume,r.ctx.currentTime):g._node&&(g._node.muted=r._muted?!0:u),f._emit("mute",g._id))}return f},volume:function(){var u=this,h=arguments,f,p;if(h.length===0)return u._volume;if(h.length===1||h.length===2&&typeof h[1]>"u"){var m=u._getSoundIds(),g=m.indexOf(h[0]);g>=0?p=parseInt(h[0],10):f=parseFloat(h[0])}else h.length>=2&&(f=parseFloat(h[0]),p=parseInt(h[1],10));var v;if(typeof f<"u"&&f>=0&&f<=1){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,h)}}),u;typeof p>"u"&&(u._volume=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)v=u._soundById(p[y]),v&&(v._volume=f,h[2]||u._stopFade(p[y]),u._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(f,r.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=f*r.volume()),u._emit("volume",v._id))}else return v=p?u._soundById(p):u._sounds[0],v?v._volume:0;return u},fade:function(u,h,f,p){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(u,h,f,p)}}),m;u=Math.min(Math.max(0,parseFloat(u)),1),h=Math.min(Math.max(0,parseFloat(h)),1),f=parseFloat(f),m.volume(u,p);for(var g=m._getSoundIds(p),v=0;v<g.length;v++){var y=m._soundById(g[v]);if(y){if(p||m._stopFade(g[v]),m._webAudio&&!y._muted){var b=r.ctx.currentTime,x=b+f/1e3;y._volume=u,y._node.gain.setValueAtTime(u,b),y._node.gain.linearRampToValueAtTime(h,x)}m._startFadeInterval(y,u,h,f,g[v],typeof p>"u")}}return m},_startFadeInterval:function(u,h,f,p,m,g){var v=this,y=h,b=f-h,x=Math.abs(b/.01),S=Math.max(4,x>0?p/x:p),w=Date.now();u._fadeTo=f,u._interval=setInterval(function(){var E=(Date.now()-w)/p;w=Date.now(),y+=b*E,y=Math.round(y*100)/100,b<0?y=Math.max(f,y):y=Math.min(f,y),v._webAudio?u._volume=y:v.volume(y,u._id,!0),g&&(v._volume=y),(f<h&&y<=f||f>h&&y>=f)&&(clearInterval(u._interval),u._interval=null,u._fadeTo=null,v.volume(f,u._id),v._emit("fade",u._id))},S)},_stopFade:function(u){var h=this,f=h._soundById(u);return f&&f._interval&&(h._webAudio&&f._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(f._interval),f._interval=null,h.volume(f._fadeTo,u),f._fadeTo=null,h._emit("fade",u)),h},loop:function(){var u=this,h=arguments,f,p,m;if(h.length===0)return u._loop;if(h.length===1)if(typeof h[0]=="boolean")f=h[0],u._loop=f;else return m=u._soundById(parseInt(h[0],10)),m?m._loop:!1;else h.length===2&&(f=h[0],p=parseInt(h[1],10));for(var g=u._getSoundIds(p),v=0;v<g.length;v++)m=u._soundById(g[v]),m&&(m._loop=f,u._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=f,f&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,u.playing(g[v])&&(u.pause(g[v],!0),u.play(g[v],!0)))));return u},rate:function(){var u=this,h=arguments,f,p;if(h.length===0)p=u._sounds[0]._id;else if(h.length===1){var m=u._getSoundIds(),g=m.indexOf(h[0]);g>=0?p=parseInt(h[0],10):f=parseFloat(h[0])}else h.length===2&&(f=parseFloat(h[0]),p=parseInt(h[1],10));var v;if(typeof f=="number"){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,h)}}),u;typeof p>"u"&&(u._rate=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)if(v=u._soundById(p[y]),v){u.playing(p[y])&&(v._rateSeek=u.seek(p[y]),v._playStart=u._webAudio?r.ctx.currentTime:v._playStart),v._rate=f,u._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(f,r.ctx.currentTime):v._node&&(v._node.playbackRate=f);var b=u.seek(p[y]),x=(u._sprite[v._sprite][0]+u._sprite[v._sprite][1])/1e3-b,S=x*1e3/Math.abs(v._rate);(u._endTimers[p[y]]||!v._paused)&&(u._clearTimer(p[y]),u._endTimers[p[y]]=setTimeout(u._ended.bind(u,v),S)),u._emit("rate",v._id)}}else return v=u._soundById(p),v?v._rate:u._rate;return u},seek:function(){var u=this,h=arguments,f,p;if(h.length===0)u._sounds.length&&(p=u._sounds[0]._id);else if(h.length===1){var m=u._getSoundIds(),g=m.indexOf(h[0]);g>=0?p=parseInt(h[0],10):u._sounds.length&&(p=u._sounds[0]._id,f=parseFloat(h[0]))}else h.length===2&&(f=parseFloat(h[0]),p=parseInt(h[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(u._state!=="loaded"||u._playLock))return u._queue.push({event:"seek",action:function(){u.seek.apply(u,h)}}),u;var v=u._soundById(p);if(v)if(typeof f=="number"&&f>=0){var y=u.playing(p);y&&u.pause(p,!0),v._seek=f,v._ended=!1,u._clearTimer(p),!u._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=f);var b=function(){y&&u.play(p,!0),u._emit("seek",p)};if(y&&!u._webAudio){var x=function(){u._playLock?setTimeout(x,0):b()};setTimeout(x,0)}else b()}else if(u._webAudio){var S=u.playing(p)?r.ctx.currentTime-v._playStart:0,w=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(w+S*Math.abs(v._rate))}else return v._node.currentTime;return u},playing:function(u){var h=this;if(typeof u=="number"){var f=h._soundById(u);return f?!f._paused:!1}for(var p=0;p<h._sounds.length;p++)if(!h._sounds[p]._paused)return!0;return!1},duration:function(u){var h=this,f=h._duration,p=h._soundById(u);return p&&(f=h._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var u=this,h=u._sounds,f=0;f<h.length;f++)h[f]._paused||u.stop(h[f]._id),u._webAudio||(u._clearSound(h[f]._node),h[f]._node.removeEventListener("error",h[f]._errorFn,!1),h[f]._node.removeEventListener(r._canPlayEvent,h[f]._loadFn,!1),h[f]._node.removeEventListener("ended",h[f]._endFn,!1),r._releaseHtml5Audio(h[f]._node)),delete h[f]._node,u._clearTimer(h[f]._id);var p=r._howls.indexOf(u);p>=0&&r._howls.splice(p,1);var m=!0;for(f=0;f<r._howls.length;f++)if(r._howls[f]._src===u._src||u._src.indexOf(r._howls[f]._src)>=0){m=!1;break}return s&&m&&delete s[u._src],r.noAudio=!1,u._state="unloaded",u._sounds=[],u=null,null},on:function(u,h,f,p){var m=this,g=m["_on"+u];return typeof h=="function"&&g.push(p?{id:f,fn:h,once:p}:{id:f,fn:h}),m},off:function(u,h,f){var p=this,m=p["_on"+u],g=0;if(typeof h=="number"&&(f=h,h=null),h||f)for(g=0;g<m.length;g++){var v=f===m[g].id;if(h===m[g].fn&&v||!h&&v){m.splice(g,1);break}}else if(u)p["_on"+u]=[];else{var y=Object.keys(p);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(p[y[g]])&&(p[y[g]]=[])}return p},once:function(u,h,f){var p=this;return p.on(u,h,f,1),p},_emit:function(u,h,f){for(var p=this,m=p["_on"+u],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===h||u==="load")&&(setTimeout((function(v){v.call(this,h,f)}).bind(p,m[g].fn),0),m[g].once&&p.off(u,m[g].fn,m[g].id));return p._loadQueue(u),p},_loadQueue:function(u){var h=this;if(h._queue.length>0){var f=h._queue[0];f.event===u&&(h._queue.shift(),h._loadQueue()),u||f.action()}return h},_ended:function(u){var h=this,f=u._sprite;if(!h._webAudio&&u._node&&!u._node.paused&&!u._node.ended&&u._node.currentTime<u._stop)return setTimeout(h._ended.bind(h,u),100),h;var p=!!(u._loop||h._sprite[f][2]);if(h._emit("end",u._id),!h._webAudio&&p&&h.stop(u._id,!0).play(u._id),h._webAudio&&p){h._emit("play",u._id),u._seek=u._start||0,u._rateSeek=0,u._playStart=r.ctx.currentTime;var m=(u._stop-u._start)*1e3/Math.abs(u._rate);h._endTimers[u._id]=setTimeout(h._ended.bind(h,u),m)}return h._webAudio&&!p&&(u._paused=!0,u._ended=!0,u._seek=u._start||0,u._rateSeek=0,h._clearTimer(u._id),h._cleanBuffer(u._node),r._autoSuspend()),!h._webAudio&&!p&&h.stop(u._id,!0),h},_clearTimer:function(u){var h=this;if(h._endTimers[u]){if(typeof h._endTimers[u]!="function")clearTimeout(h._endTimers[u]);else{var f=h._soundById(u);f&&f._node&&f._node.removeEventListener("ended",h._endTimers[u],!1)}delete h._endTimers[u]}return h},_soundById:function(u){for(var h=this,f=0;f<h._sounds.length;f++)if(u===h._sounds[f]._id)return h._sounds[f];return null},_inactiveSound:function(){var u=this;u._drain();for(var h=0;h<u._sounds.length;h++)if(u._sounds[h]._ended)return u._sounds[h].reset();return new n(u)},_drain:function(){var u=this,h=u._pool,f=0,p=0;if(!(u._sounds.length<h)){for(p=0;p<u._sounds.length;p++)u._sounds[p]._ended&&f++;for(p=u._sounds.length-1;p>=0;p--){if(f<=h)return;u._sounds[p]._ended&&(u._webAudio&&u._sounds[p]._node&&u._sounds[p]._node.disconnect(0),u._sounds.splice(p,1),f--)}}},_getSoundIds:function(u){var h=this;if(typeof u>"u"){for(var f=[],p=0;p<h._sounds.length;p++)f.push(h._sounds[p]._id);return f}else return[u]},_refreshBuffer:function(u){var h=this;return u._node.bufferSource=r.ctx.createBufferSource(),u._node.bufferSource.buffer=s[h._src],u._panner?u._node.bufferSource.connect(u._panner):u._node.bufferSource.connect(u._node),u._node.bufferSource.loop=u._loop,u._loop&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop||0),u._node.bufferSource.playbackRate.setValueAtTime(u._rate,r.ctx.currentTime),h},_cleanBuffer:function(u){var h=this,f=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(r._scratchBuffer&&u.bufferSource&&(u.bufferSource.onended=null,u.bufferSource.disconnect(0),f))try{u.bufferSource.buffer=r._scratchBuffer}catch{}return u.bufferSource=null,h},_clearSound:function(u){var h=/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent);h||(u.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(u){this._parent=u,this.init()};n.prototype={init:function(){var u=this,h=u._parent;return u._muted=h._muted,u._loop=h._loop,u._volume=h._volume,u._rate=h._rate,u._seek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++r._counter,h._sounds.push(u),u.create(),u},create:function(){var u=this,h=u._parent,f=r._muted||u._muted||u._parent._muted?0:u._volume;return h._webAudio?(u._node=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),u._node.gain.setValueAtTime(f,r.ctx.currentTime),u._node.paused=!0,u._node.connect(r.masterGain)):r.noAudio||(u._node=r._obtainHtml5Audio(),u._errorFn=u._errorListener.bind(u),u._node.addEventListener("error",u._errorFn,!1),u._loadFn=u._loadListener.bind(u),u._node.addEventListener(r._canPlayEvent,u._loadFn,!1),u._endFn=u._endListener.bind(u),u._node.addEventListener("ended",u._endFn,!1),u._node.src=h._src,u._node.preload=h._preload===!0?"auto":h._preload,u._node.volume=f*r.volume(),u._node.load()),u},reset:function(){var u=this,h=u._parent;return u._muted=h._muted,u._loop=h._loop,u._volume=h._volume,u._rate=h._rate,u._seek=0,u._rateSeek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++r._counter,u},_errorListener:function(){var u=this;u._parent._emit("loaderror",u._id,u._node.error?u._node.error.code:0),u._node.removeEventListener("error",u._errorFn,!1)},_loadListener:function(){var u=this,h=u._parent;h._duration=Math.ceil(u._node.duration*10)/10,Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue()),u._node.removeEventListener(r._canPlayEvent,u._loadFn,!1)},_endListener:function(){var u=this,h=u._parent;h._duration===1/0&&(h._duration=Math.ceil(u._node.duration*10)/10,h._sprite.__default[1]===1/0&&(h._sprite.__default[1]=h._duration*1e3),h._ended(u)),u._node.removeEventListener("ended",u._endFn,!1)}};var s={},a=function(u){var h=u._src;if(s[h]){u._duration=s[h].duration,c(u);return}if(/^data:[^;]+;base64,/.test(h)){for(var f=atob(h.split(",")[1]),p=new Uint8Array(f.length),m=0;m<f.length;++m)p[m]=f.charCodeAt(m);l(p.buffer,u)}else{var g=new XMLHttpRequest;g.open(u._xhr.method,h,!0),g.withCredentials=u._xhr.withCredentials,g.responseType="arraybuffer",u._xhr.headers&&Object.keys(u._xhr.headers).forEach(function(v){g.setRequestHeader(v,u._xhr.headers[v])}),g.onload=function(){var v=(g.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){u._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,u)},g.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete s[h],u.load())},o(g)}},o=function(u){try{u.send()}catch{u.onerror()}},l=function(u,h){var f=function(){h._emit("loaderror",null,"Decoding audio data failed.")},p=function(m){m&&h._sounds.length>0?(s[h._src]=m,c(h,m)):f()};typeof Promise<"u"&&r.ctx.decodeAudioData.length===1?r.ctx.decodeAudioData(u).then(p).catch(f):r.ctx.decodeAudioData(u,p,f)},c=function(u,h){h&&!u._duration&&(u._duration=h.duration),Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue())},d=function(){if(r.usingWebAudio){try{typeof AudioContext<"u"?r.ctx=new AudioContext:typeof webkitAudioContext<"u"?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch{r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var u=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),h=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=h?parseInt(h[1],10):null;if(u&&f&&f<9){var p=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!p&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:r,Howl:i}}),typeof e<"u"&&(e.Howler=r,e.Howl=i),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=r,global.Howl=i,global.Sound=n):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=r,window.Howl=i,window.Sound=n)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(r){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var n=i._howls.length-1;n>=0;n--)i._howls[n].stereo(r);return i},HowlerGlobal.prototype.pos=function(r,i,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,n=typeof n!="number"?s._pos[2]:n,typeof r=="number")s._pos=[r,i,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(r,i,n,s,a,o){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(i=typeof i!="number"?c[1]:i,n=typeof n!="number"?c[2]:n,s=typeof s!="number"?c[3]:s,a=typeof a!="number"?c[4]:a,o=typeof o!="number"?c[5]:o,typeof r=="number")l._orientation=[r,i,n,s,a,o],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(r,i,n,s,a,o);else return c;return l},Howl.prototype.init=function(r){return function(i){var n=this;return n._orientation=i.orientation||[1,0,0],n._stereo=i.stereo||null,n._pos=i.pos||null,n._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},n._onstereo=i.onstereo?[{fn:i.onstereo}]:[],n._onpos=i.onpos?[{fn:i.onpos}]:[],n._onorientation=i.onorientation?[{fn:i.onorientation}]:[],r.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(r,i){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(r,i)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof r=="number")n._stereo=r,n._pos=[r,0,0];else return n._stereo;for(var a=n._getSoundIds(i),o=0;o<a.length;o++){var l=n._soundById(a[o]);if(l)if(typeof r=="number")l._stereo=r,l._pos=[r,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(r,0,0):l._panner.pan.setValueAtTime(r,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(r,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(r,i,n,s)}}),a;if(i=typeof i!="number"?0:i,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof r=="number")a._pos=[r,i,n];else return a._pos;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof r=="number")c._pos=[r,i,n],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setPosition(r,i,n)),a._emit("pos",c._id);else return c._pos}return a},Howl.prototype.orientation=function(r,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(r,i,n,s)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,n=typeof n!="number"?a._orientation[2]:n,typeof s>"u")if(typeof r=="number")a._orientation=[r,i,n];else return a._orientation;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof r=="number")c._orientation=[r,i,n],c._node&&(c._panner||(c._pos||(c._pos=a._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(r,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setOrientation(r,i,n)),a._emit("orientation",c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var r=this,i=arguments,n,s,a;if(!r._webAudio)return r;if(i.length===0)return r._pannerAttr;if(i.length===1)if(typeof i[0]=="object")n=i[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),r._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:r._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:r._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:r._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:r._panningModel});else return a=r._soundById(parseInt(i[0],10)),a?a._pannerAttr:r._pannerAttr;else i.length===2&&(n=i[0],s=parseInt(i[1],10));for(var o=r._getSoundIds(s),l=0;l<o.length;l++)if(a=r._soundById(o[l]),a){var c=a._pannerAttr;c={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:c.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:c.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:c.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:c.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:c.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:c.panningModel};var d=a._panner;d?(d.coneInnerAngle=c.coneInnerAngle,d.coneOuterAngle=c.coneOuterAngle,d.coneOuterGain=c.coneOuterGain,d.distanceModel=c.distanceModel,d.maxDistance=c.maxDistance,d.refDistance=c.refDistance,d.rolloffFactor=c.rolloffFactor,d.panningModel=c.panningModel):(a._pos||(a._pos=r._pos||[0,0,-.5]),t(a,"spatial"))}return r},Sound.prototype.init=function(r){return function(){var i=this,n=i._parent;i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,r.call(this),i._stereo?n.stereo(i._stereo):i._pos&&n.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(r){return function(){var i=this,n=i._parent;return i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,i._stereo?n.stereo(i._stereo):i._pos?n.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,n._refreshBuffer(i)),r.call(this)}}(Sound.prototype.reset);var t=function(r,i){i=i||"spatial",i==="spatial"?(r._panner=Howler.ctx.createPanner(),r._panner.coneInnerAngle=r._pannerAttr.coneInnerAngle,r._panner.coneOuterAngle=r._pannerAttr.coneOuterAngle,r._panner.coneOuterGain=r._pannerAttr.coneOuterGain,r._panner.distanceModel=r._pannerAttr.distanceModel,r._panner.maxDistance=r._pannerAttr.maxDistance,r._panner.refDistance=r._pannerAttr.refDistance,r._panner.rolloffFactor=r._pannerAttr.rolloffFactor,r._panner.panningModel=r._pannerAttr.panningModel,typeof r._panner.positionX<"u"?(r._panner.positionX.setValueAtTime(r._pos[0],Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(r._pos[1],Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(r._pos[2],Howler.ctx.currentTime)):r._panner.setPosition(r._pos[0],r._pos[1],r._pos[2]),typeof r._panner.orientationX<"u"?(r._panner.orientationX.setValueAtTime(r._orientation[0],Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(r._orientation[1],Howler.ctx.currentTime),r._panner.orientationZ.setValueAtTime(r._orientation[2],Howler.ctx.currentTime)):r._panner.setOrientation(r._orientation[0],r._orientation[1],r._orientation[2])):(r._panner=Howler.ctx.createStereoPanner(),r._panner.pan.setValueAtTime(r._stereo,Howler.ctx.currentTime)),r._panner.connect(r._node),r._paused||r._parent.pause(r._id,!0).play(r._id,!0)}}()}),X4e=us((e,t)=>{function r(s,a){function o(){this.constructor=s}o.prototype=a.prototype,s.prototype=new o}function i(s,a,o,l){this.message=s,this.expected=a,this.found=o,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,i)}r(i,Error),i.buildMessage=function(s,a){var o={literal:function(p){return'"'+c(p.text)+'"'},class:function(p){var m="",g;for(g=0;g<p.parts.length;g++)m+=p.parts[g]instanceof Array?d(p.parts[g][0])+"-"+d(p.parts[g][1]):d(p.parts[g]);return"["+(p.inverted?"^":"")+m+"]"},any:function(p){return"any character"},end:function(p){return"end of input"},other:function(p){return p.description}};function l(p){return p.charCodeAt(0).toString(16).toUpperCase()}function c(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+l(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+l(m)})}function d(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+l(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+l(m)})}function u(p){return o[p.type](p)}function h(p){var m=new Array(p.length),g,v;for(g=0;g<p.length;g++)m[g]=u(p[g]);if(m.sort(),m.length>0){for(g=1,v=1;g<m.length;g++)m[g-1]!==m[g]&&(m[v]=m[g],v++);m.length=v}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function f(p){return p?'"'+c(p)+'"':"end of input"}return"Expected "+h(s)+" but "+f(a)+" found."};function n(s,a){a=a!==void 0?a:{};var o={},l={svg_path:Gt},c=Gt,d=function($){if(!$)return[];for(var K=[],le=0;le<$.length;le++)K=K.concat.apply(K,$[le]);var J=K[0];return J&&J.code=="m"&&(delete J.relative,J.code="M"),K},u=function($,K){return yi($,K)},h=/^[Mm]/,f=Ue(["M","m"],!1,!1),p=function($,K,le){var J=Ci($,[K]);return le&&(J=J.concat(Ci($=="M"?"L":"l",le[1]))),J},m=/^[Zz]/,g=Ue(["Z","z"],!1,!1),v=function(){return Ci("Z")},y=/^[Ll]/,b=Ue(["L","l"],!1,!1),x=function($,K){return Ci($,K)},S=/^[Hh]/,w=Ue(["H","h"],!1,!1),E=function($,K){return Ci($,K.map(function(le){return{x:le}}))},C=/^[Vv]/,T=Ue(["V","v"],!1,!1),A=function($,K){return Ci($,K.map(function(le){return{y:le}}))},M=/^[Cc]/,P=Ue(["C","c"],!1,!1),I=function($,K,le){return{x1:$.x,y1:$.y,x2:K.x,y2:K.y,x:le.x,y:le.y}},R=/^[Ss]/,N=Ue(["S","s"],!1,!1),k=function($,K){return{x2:$.x,y2:$.y,x:K.x,y:K.y}},O=/^[Qq]/,D=Ue(["Q","q"],!1,!1),B=function($,K){return{x1:$.x,y1:$.y,x:K.x,y:K.y}},z=/^[Tt]/,F=Ue(["T","t"],!1,!1),V=/^[Aa]/,Y=Ue(["A","a"],!1,!1),W=function($,K,le,J,ge,De){return{rx:$,ry:K,xAxisRotation:le,largeArc:J,sweep:ge,x:De.x,y:De.y}},X=function($,K){return{x:$,y:K}},H=function($){return $*1},ie=function($){return $.join("")*1},Q=/^[01]/,Z=Ue(["0","1"],!1,!1),ee=function($){return $=="1"},re=function(){return""},ne=",",se=Me(",",!1),fe=function($){return $.join("")},me=".",Oe=Me(".",!1),Ee=/^[eE]/,Se=Ue(["e","E"],!1,!1),de=/^[+\-]/,be=Ue(["+","-"],!1,!1),ye=/^[0-9]/,q=Ue([["0","9"]],!1,!1),U=function($){return $.join("")},ce=/^[ \t\n\r]/,xe=Ue([" ","	",`
`,"\r"],!1,!1),j=0,Be=[{line:1,column:1}],ze=0,Ve=[],pe;if("startRule"in a){if(!(a.startRule in l))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');c=l[a.startRule]}function Me($,K){return{type:"literal",text:$,ignoreCase:K}}function Ue($,K,le){return{type:"class",parts:$,inverted:K,ignoreCase:le}}function Re(){return{type:"end"}}function et($){var K=Be[$],le;if(K)return K;for(le=$-1;!Be[le];)le--;for(K=Be[le],K={line:K.line,column:K.column};le<$;)s.charCodeAt(le)===10?(K.line++,K.column=1):K.column++,le++;return Be[$]=K,K}function Xe($,K){var le=et($),J=et(K);return{start:{offset:$,line:le.line,column:le.column},end:{offset:K,line:J.line,column:J.column}}}function Ze($){j<ze||(j>ze&&(ze=j,Ve=[]),Ve.push($))}function Mt($,K,le){return new i(i.buildMessage($,K),$,K,le)}function Gt(){var $,K,le,J,ge;for($=j,K=[],le=qt();le!==o;)K.push(le),le=qt();if(K!==o)if(le=ue(),le===o&&(le=null),le!==o){for(J=[],ge=qt();ge!==o;)J.push(ge),ge=qt();J!==o?(K=d(le),$=K):(j=$,$=o)}else j=$,$=o;else j=$,$=o;return $}function ue(){var $,K,le,J,ge,De;if($=j,K=Ae(),K!==o){for(le=[],J=j,ge=[],De=qt();De!==o;)ge.push(De),De=qt();for(ge!==o?(De=Ae(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;){for(le.push(J),J=j,ge=[],De=qt();De!==o;)ge.push(De),De=qt();ge!==o?(De=Ae(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o)}le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function Ae(){var $,K,le,J,ge,De;if($=j,K=Ie(),K!==o){for(le=[],J=j,ge=[],De=qt();De!==o;)ge.push(De),De=qt();for(ge!==o?(De=ke(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;){for(le.push(J),J=j,ge=[],De=qt();De!==o;)ge.push(De),De=qt();ge!==o?(De=ke(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o)}le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function ke(){var $;return $=$e(),$===o&&($=tt(),$===o&&($=gt(),$===o&&($=at(),$===o&&($=Qe(),$===o&&($=xt(),$===o&&($=te(),$===o&&($=ve(),$===o&&($=mt())))))))),$}function Ie(){var $,K,le,J,ge,De,dt;if($=j,h.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(f)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=qe(),J!==o?(ge=j,De=Ct(),De===o&&(De=null),De!==o?(dt=He(),dt!==o?(De=[De,dt],ge=De):(j=ge,ge=o)):(j=ge,ge=o),ge===o&&(ge=null),ge!==o?(K=p(K,J,ge),$=K):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function $e(){var $,K;return $=j,m.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(g)),K!==o&&(K=v()),$=K,$}function tt(){var $,K,le,J;if($=j,y.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(b)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=He(),J!==o?(K=x(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function He(){var $,K,le,J,ge,De;if($=j,K=qe(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=qe(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=qe(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function gt(){var $,K,le,J;if($=j,S.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(w)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=ot(),J!==o?(K=E(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function ot(){var $,K,le,J,ge,De;if($=j,K=St(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=St(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=St(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function at(){var $,K,le,J;if($=j,C.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(T)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=ot(),J!==o?(K=A(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function Qe(){var $,K,le,J;if($=j,M.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(P)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=ut(),J!==o?(K=x(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function ut(){var $,K,le,J,ge,De;if($=j,K=yt(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=yt(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=yt(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function yt(){var $,K,le,J,ge,De;return $=j,K=qe(),K!==o?(le=Ct(),le===o&&(le=null),le!==o?(J=qe(),J!==o?(ge=Ct(),ge===o&&(ge=null),ge!==o?(De=qe(),De!==o?(K=I(K,J,De),$=K):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o),$}function xt(){var $,K,le,J;if($=j,R.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(N)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=or(),J!==o?(K=x(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function or(){var $,K,le,J,ge,De;if($=j,K=Jt(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=Jt(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=Jt(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function Jt(){var $,K,le,J;return $=j,K=qe(),K!==o?(le=Ct(),le===o&&(le=null),le!==o?(J=qe(),J!==o?(K=k(K,J),$=K):(j=$,$=o)):(j=$,$=o)):(j=$,$=o),$}function te(){var $,K,le,J;if($=j,O.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(D)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=we(),J!==o?(K=x(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function we(){var $,K,le,J,ge,De;if($=j,K=Te(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=Te(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=Te(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function Te(){var $,K,le,J;return $=j,K=qe(),K!==o?(le=Ct(),le===o&&(le=null),le!==o?(J=qe(),J!==o?(K=B(K,J),$=K):(j=$,$=o)):(j=$,$=o)):(j=$,$=o),$}function ve(){var $,K,le,J;if($=j,z.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(F)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=Le(),J!==o?(K=x(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function Le(){var $,K,le,J,ge,De;if($=j,K=qe(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=qe(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=qe(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function mt(){var $,K,le,J;if($=j,V.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(Y)),K!==o){for(le=[],J=qt();J!==o;)le.push(J),J=qt();le!==o?(J=Pt(),J!==o?(K=x(K,J),$=K):(j=$,$=o)):(j=$,$=o)}else j=$,$=o;return $}function Pt(){var $,K,le,J,ge,De;if($=j,K=it(),K!==o){for(le=[],J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=it(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);J!==o;)le.push(J),J=j,ge=Ct(),ge===o&&(ge=null),ge!==o?(De=it(),De!==o?(ge=[ge,De],J=ge):(j=J,J=o)):(j=J,J=o);le!==o?(K=u(K,le),$=K):(j=$,$=o)}else j=$,$=o;return $}function it(){var $,K,le,J,ge,De,dt,Bt,Kt,pr,wr,Ai;return $=j,K=pt(),K!==o?(le=Ct(),le===o&&(le=null),le!==o?(J=pt(),J!==o?(ge=Ct(),ge===o&&(ge=null),ge!==o?(De=St(),De!==o?(dt=Ct(),dt!==o?(Bt=Ot(),Bt!==o?(Kt=Ct(),Kt===o&&(Kt=null),Kt!==o?(pr=Ot(),pr!==o?(wr=Ct(),wr===o&&(wr=null),wr!==o?(Ai=qe(),Ai!==o?(K=W(K,J,De,Bt,pr,Ai),$=K):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o)):(j=$,$=o),$}function qe(){var $,K,le,J;return $=j,K=St(),K!==o?(le=Ct(),le===o&&(le=null),le!==o?(J=St(),J!==o?(K=X(K,J),$=K):(j=$,$=o)):(j=$,$=o)):(j=$,$=o),$}function pt(){var $,K;return $=j,K=hi(),K===o&&(K=fn()),K!==o&&(K=H(K)),$=K,$}function St(){var $,K,le,J;return $=j,K=j,le=kt(),le===o&&(le=null),le!==o?(J=hi(),J!==o?(le=[le,J],K=le):(j=K,K=o)):(j=K,K=o),K===o&&(K=j,le=kt(),le===o&&(le=null),le!==o?(J=fn(),J!==o?(le=[le,J],K=le):(j=K,K=o)):(j=K,K=o)),K!==o&&(K=ie(K)),$=K,$}function Ot(){var $,K;return $=j,Q.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(Z)),K!==o&&(K=ee(K)),$=K,$}function Ct(){var $,K,le,J,ge;if($=j,K=[],le=qt(),le!==o)for(;le!==o;)K.push(le),le=qt();else K=o;if(K!==o)if(le=Br(),le===o&&(le=null),le!==o){for(J=[],ge=qt();ge!==o;)J.push(ge),ge=qt();J!==o?(K=[K,le,J],$=K):(j=$,$=o)}else j=$,$=o;else j=$,$=o;if($===o){if($=j,K=j,le=Br(),le!==o){for(J=[],ge=qt();ge!==o;)J.push(ge),ge=qt();J!==o?(le=[le,J],K=le):(j=K,K=o)}else j=K,K=o;K!==o&&(K=re()),$=K}return $}function Br(){var $;return s.charCodeAt(j)===44?($=ne,j++):($=o,Ze(se)),$}function hi(){var $,K,le,J;return $=j,K=j,le=ji(),le!==o?(J=Ar(),J===o&&(J=null),J!==o?(le=[le,J],K=le):(j=K,K=o)):(j=K,K=o),K===o&&(K=j,le=fn(),le!==o?(J=Ar(),J!==o?(le=[le,J],K=le):(j=K,K=o)):(j=K,K=o)),K!==o&&(K=fe(K)),$=K,$}function ji(){var $,K,le,J,ge;return $=j,K=j,le=fn(),le===o&&(le=null),le!==o?(s.charCodeAt(j)===46?(J=me,j++):(J=o,Ze(Oe)),J!==o?(ge=fn(),ge!==o?(le=[le,J,ge],K=le):(j=K,K=o)):(j=K,K=o)):(j=K,K=o),K===o&&(K=j,le=fn(),le!==o?(s.charCodeAt(j)===46?(J=me,j++):(J=o,Ze(Oe)),J!==o?(le=[le,J],K=le):(j=K,K=o)):(j=K,K=o)),K!==o&&(K=fe(K)),$=K,$}function Ar(){var $,K,le,J,ge;return $=j,K=j,Ee.test(s.charAt(j))?(le=s.charAt(j),j++):(le=o,Ze(Se)),le!==o?(J=kt(),J===o&&(J=null),J!==o?(ge=fn(),ge!==o?(le=[le,J,ge],K=le):(j=K,K=o)):(j=K,K=o)):(j=K,K=o),K!==o&&(K=fe(K)),$=K,$}function kt(){var $;return de.test(s.charAt(j))?($=s.charAt(j),j++):($=o,Ze(be)),$}function fn(){var $,K,le;if($=j,K=[],ye.test(s.charAt(j))?(le=s.charAt(j),j++):(le=o,Ze(q)),le!==o)for(;le!==o;)K.push(le),ye.test(s.charAt(j))?(le=s.charAt(j),j++):(le=o,Ze(q));else K=o;return K!==o&&(K=U(K)),$=K,$}function qt(){var $,K;return $=j,ce.test(s.charAt(j))?(K=s.charAt(j),j++):(K=o,Ze(xe)),K!==o&&(K=re()),$=K,$}function yi($,K){if(!K)return[$];for(var le=[$],J=0,ge=K.length;J<ge;J++)le[J+1]=K[J][1];return le}var Ns={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var pn in Ns)Ns[pn.toUpperCase()]=Ns[pn];function Ci($,K){K||(K=[{}]);for(var le=K.length;le--;){var J={code:$,command:Ns[$]};$==$.toLowerCase()&&(J.relative=!0);for(var ge in K[le])J[ge]=K[le][ge];K[le]=J}return K}if(pe=c(),pe!==o&&j===s.length)return pe;throw pe!==o&&j<s.length&&Ze(Re()),Mt(Ve,ze<s.length?s.charAt(ze):null,ze<s.length?Xe(ze,ze+1):Xe(ze,ze))}t.exports={SyntaxError:i,parse:n}}),gne=us((e,t)=>{var r=X4e().parse;r.parseSVG=r,r.makeAbsolute=i,t.exports=r;function i(n){var s,a={x:0,y:0},o={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(s=l),l.x0=a.x,l.y0=a.y;for(var c in o)c in l&&(l[c]+=l.relative?l[o[c]]:0);"x"in l||(l.x=a.x),"y"in l||(l.y=a.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=s.x,l.y=s.y),a=l}),n}}),Y4e=us((e,t)=>{function r(i){for(var n=new Array(i),s=0;s<i;++s)n[s]=s;return n}t.exports=r}),K4e=us((e,t)=>{t.exports=function(n){return n!=null&&(r(n)||i(n)||!!n._isBuffer)};function r(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function i(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&r(n.slice(0,0))}}),fw=us((e,t)=>{var r=Y4e(),i=K4e(),n=typeof Float64Array<"u";function s(u,h){return u[0]-h[0]}function a(){var u=this.stride,h=new Array(u.length),f;for(f=0;f<h.length;++f)h[f]=[Math.abs(u[f]),f];h.sort(s);var p=new Array(h.length);for(f=0;f<p.length;++f)p[f]=h[f][1];return p}function o(u,h){var f=["View",h,"d",u].join("");h<0&&(f="View_Nil"+u);var p=u==="generic";if(h===-1){var m="function "+f+"(a){this.data=a;};var proto="+f+".prototype;proto.dtype='"+u+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+f+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+f+"(a){return new "+f+"(a);}",A=new Function(m);return A()}else if(h===0){var m="function "+f+"(a,d) {this.data = a;this.offset = d};var proto="+f+".prototype;proto.dtype='"+u+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+f+"_copy() {return new "+f+"(this.data,this.offset)};proto.pick=function "+f+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+f+"_get(){return "+(p?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+f+"_set(v){return "+(p?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+f+"(a,b,c,d){return new "+f+"(a,d)}",A=new Function("TrivialArray",m);return A(c[u][0])}var m=["'use strict'"],g=r(h),v=g.map(function(M){return"i"+M}),y="this.offset+"+g.map(function(M){return"this.stride["+M+"]*i"+M}).join("+"),b=g.map(function(M){return"b"+M}).join(","),x=g.map(function(M){return"c"+M}).join(",");m.push("function "+f+"(a,"+b+","+x+",d){this.data=a","this.shape=["+b+"]","this.stride=["+x+"]","this.offset=d|0}","var proto="+f+".prototype","proto.dtype='"+u+"'","proto.dimension="+h),m.push("Object.defineProperty(proto,'size',{get:function "+f+"_size(){return "+g.map(function(M){return"this.shape["+M+"]"}).join("*"),"}})"),h===1?m.push("proto.order=[0]"):(m.push("Object.defineProperty(proto,'order',{get:"),h<4?(m.push("function "+f+"_order(){"),h===2?m.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):h===3&&m.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):m.push("ORDER})")),m.push("proto.set=function "+f+"_set("+v.join(",")+",v){"),p?m.push("return this.data.set("+y+",v)}"):m.push("return this.data["+y+"]=v}"),m.push("proto.get=function "+f+"_get("+v.join(",")+"){"),p?m.push("return this.data.get("+y+")}"):m.push("return this.data["+y+"]}"),m.push("proto.index=function "+f+"_index(",v.join(),"){return "+y+"}"),m.push("proto.hi=function "+f+"_hi("+v.join(",")+"){return new "+f+"(this.data,"+g.map(function(M){return["(typeof i",M,"!=='number'||i",M,"<0)?this.shape[",M,"]:i",M,"|0"].join("")}).join(",")+","+g.map(function(M){return"this.stride["+M+"]"}).join(",")+",this.offset)}");var S=g.map(function(M){return"a"+M+"=this.shape["+M+"]"}),w=g.map(function(M){return"c"+M+"=this.stride["+M+"]"});m.push("proto.lo=function "+f+"_lo("+v.join(",")+"){var b=this.offset,d=0,"+S.join(",")+","+w.join(","));for(var E=0;E<h;++E)m.push("if(typeof i"+E+"==='number'&&i"+E+">=0){d=i"+E+"|0;b+=c"+E+"*d;a"+E+"-=d}");m.push("return new "+f+"(this.data,"+g.map(function(M){return"a"+M}).join(",")+","+g.map(function(M){return"c"+M}).join(",")+",b)}"),m.push("proto.step=function "+f+"_step("+v.join(",")+"){var "+g.map(function(M){return"a"+M+"=this.shape["+M+"]"}).join(",")+","+g.map(function(M){return"b"+M+"=this.stride["+M+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var E=0;E<h;++E)m.push("if(typeof i"+E+"==='number'){d=i"+E+"|0;if(d<0){c+=b"+E+"*(a"+E+"-1);a"+E+"=ceil(-a"+E+"/d)}else{a"+E+"=ceil(a"+E+"/d)}b"+E+"*=d}");m.push("return new "+f+"(this.data,"+g.map(function(M){return"a"+M}).join(",")+","+g.map(function(M){return"b"+M}).join(",")+",c)}");for(var C=new Array(h),T=new Array(h),E=0;E<h;++E)C[E]="a[i"+E+"]",T[E]="b[i"+E+"]";m.push("proto.transpose=function "+f+"_transpose("+v+"){"+v.map(function(M,P){return M+"=("+M+"===undefined?"+P+":"+M+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+f+"(this.data,"+C.join(",")+","+T.join(",")+",this.offset)}"),m.push("proto.pick=function "+f+"_pick("+v+"){var a=[],b=[],c=this.offset");for(var E=0;E<h;++E)m.push("if(typeof i"+E+"==='number'&&i"+E+">=0){c=(c+this.stride["+E+"]*i"+E+")|0}else{a.push(this.shape["+E+"]);b.push(this.stride["+E+"])}");m.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),m.push("return function construct_"+f+"(data,shape,stride,offset){return new "+f+"(data,"+g.map(function(M){return"shape["+M+"]"}).join(",")+","+g.map(function(M){return"stride["+M+"]"}).join(",")+",offset)}");var A=new Function("CTOR_LIST","ORDER",m.join(`
`));return A(c[u],a)}function l(u){if(i(u))return"buffer";if(n)switch(Object.prototype.toString.call(u)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(u)?"array":"generic"}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function d(u,h,f,p){if(u===void 0){var x=c.array[0];return x([])}else typeof u=="number"&&(u=[u]);h===void 0&&(h=[u.length]);var m=h.length;if(f===void 0){f=new Array(m);for(var g=m-1,v=1;g>=0;--g)f[g]=v,v*=h[g]}if(p===void 0){p=0;for(var g=0;g<m;++g)f[g]<0&&(p-=(h[g]-1)*f[g])}for(var y=l(u),b=c[y];b.length<=m+1;)b.push(o(y,b.length-1));var x=b[m+1];return x(u,h,f,p)}t.exports=d}),Q4e=us((e,t)=>{function r(s,a){for(var o=1,l=s.length,c=s[0],d=s[0],u=1;u<l;++u)if(d=c,c=s[u],a(c,d)){if(u===o){o++;continue}s[o++]=c}return s.length=o,s}function i(s){for(var a=1,o=s.length,l=s[0],c=s[0],d=1;d<o;++d,c=l)if(c=l,l=s[d],l!==c){if(d===a){a++;continue}s[a++]=l}return s.length=a,s}function n(s,a,o){return s.length===0?s:a?(o||s.sort(a),r(s,a)):(o||s.sort(),i(s))}t.exports=n}),Z4e=us((e,t)=>{var r=Q4e();function i(c,d,u){var h=c.length,f=d.arrayArgs.length,p=d.indexArgs.length>0,m=[],g=[],v=0,y=0,b,x;for(b=0;b<h;++b)g.push(["i",b,"=0"].join(""));for(x=0;x<f;++x)for(b=0;b<h;++b)y=v,v=c[b],b===0?g.push(["d",x,"s",b,"=t",x,"p",v].join("")):g.push(["d",x,"s",b,"=(t",x,"p",v,"-s",y,"*t",x,"p",y,")"].join(""));for(g.length>0&&m.push("var "+g.join(",")),b=h-1;b>=0;--b)v=c[b],m.push(["for(i",b,"=0;i",b,"<s",v,";++i",b,"){"].join(""));for(m.push(u),b=0;b<h;++b){for(y=v,v=c[b],x=0;x<f;++x)m.push(["p",x,"+=d",x,"s",b].join(""));p&&(b>0&&m.push(["index[",y,"]-=s",y].join("")),m.push(["++index[",v,"]"].join(""))),m.push("}")}return m.join(`
`)}function n(c,d,u,h){for(var f=d.length,p=u.arrayArgs.length,m=u.blockSize,g=u.indexArgs.length>0,v=[],y=0;y<p;++y)v.push(["var offset",y,"=p",y].join(""));for(var y=c;y<f;++y)v.push(["for(var j"+y+"=SS[",d[y],"]|0;j",y,">0;){"].join("")),v.push(["if(j",y,"<",m,"){"].join("")),v.push(["s",d[y],"=j",y].join("")),v.push(["j",y,"=0"].join("")),v.push(["}else{s",d[y],"=",m].join("")),v.push(["j",y,"-=",m,"}"].join("")),g&&v.push(["index[",d[y],"]=j",y].join(""));for(var y=0;y<p;++y){for(var b=["offset"+y],x=c;x<f;++x)b.push(["j",x,"*t",y,"p",d[x]].join(""));v.push(["p",y,"=(",b.join("+"),")"].join(""))}v.push(i(d,u,h));for(var y=c;y<f;++y)v.push("}");return v.join(`
`)}function s(c){for(var d=0,u=c[0].length;d<u;){for(var h=1;h<c.length;++h)if(c[h][d]!==c[0][d])return d;++d}return d}function a(c,d,u){for(var h=c.body,f=[],p=[],m=0;m<c.args.length;++m){var g=c.args[m];if(!(g.count<=0)){var v=new RegExp(g.name,"g"),y="",b=d.arrayArgs.indexOf(m);switch(d.argTypes[m]){case"offset":var x=d.offsetArgIndex.indexOf(m),S=d.offsetArgs[x];b=S.array,y="+q"+x;case"array":y="p"+b+y;var w="l"+m,E="a"+b;if(d.arrayBlockIndices[b]===0)g.count===1?u[b]==="generic"?g.lvalue?(f.push(["var ",w,"=",E,".get(",y,")"].join("")),h=h.replace(v,w),p.push([E,".set(",y,",",w,")"].join(""))):h=h.replace(v,[E,".get(",y,")"].join("")):h=h.replace(v,[E,"[",y,"]"].join("")):u[b]==="generic"?(f.push(["var ",w,"=",E,".get(",y,")"].join("")),h=h.replace(v,w),g.lvalue&&p.push([E,".set(",y,",",w,")"].join(""))):(f.push(["var ",w,"=",E,"[",y,"]"].join("")),h=h.replace(v,w),g.lvalue&&p.push([E,"[",y,"]=",w].join("")));else{for(var C=[g.name],T=[y],A=0;A<Math.abs(d.arrayBlockIndices[b]);A++)C.push("\\s*\\[([^\\]]+)\\]"),T.push("$"+(A+1)+"*t"+b+"b"+A);if(v=new RegExp(C.join(""),"g"),y=T.join("+"),u[b]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");h=h.replace(v,[E,"[",y,"]"].join(""))}break;case"scalar":h=h.replace(v,"Y"+d.scalarArgs.indexOf(m));break;case"index":h=h.replace(v,"index");break;case"shape":h=h.replace(v,"shape");break}}}return[f.join(`
`),h,p.join(`
`)].join(`
`).trim()}function o(c){for(var d=new Array(c.length),u=!0,h=0;h<c.length;++h){var f=c[h],p=f.match(/\d+/);p?p=p[0]:p="",f.charAt(0)===0?d[h]="u"+f.charAt(1)+p:d[h]=f.charAt(0)+p,h>0&&(u=u&&d[h]===d[h-1])}return u?d[0]:d.join("")}function l(c,d){for(var u=d[1].length-Math.abs(c.arrayBlockIndices[0])|0,h=new Array(c.arrayArgs.length),f=new Array(c.arrayArgs.length),p=0;p<c.arrayArgs.length;++p)f[p]=d[2*p],h[p]=d[2*p+1];for(var m=[],g=[],v=[],y=[],b=[],p=0;p<c.arrayArgs.length;++p){c.arrayBlockIndices[p]<0?(v.push(0),y.push(u),m.push(u),g.push(u+c.arrayBlockIndices[p])):(v.push(c.arrayBlockIndices[p]),y.push(c.arrayBlockIndices[p]+u),m.push(0),g.push(c.arrayBlockIndices[p]));for(var x=[],S=0;S<h[p].length;S++)v[p]<=h[p][S]&&h[p][S]<y[p]&&x.push(h[p][S]-v[p]);b.push(x)}for(var w=["SS"],E=["'use strict'"],C=[],S=0;S<u;++S)C.push(["s",S,"=SS[",S,"]"].join(""));for(var p=0;p<c.arrayArgs.length;++p){w.push("a"+p),w.push("t"+p),w.push("p"+p);for(var S=0;S<u;++S)C.push(["t",p,"p",S,"=t",p,"[",v[p]+S,"]"].join(""));for(var S=0;S<Math.abs(c.arrayBlockIndices[p]);++S)C.push(["t",p,"b",S,"=t",p,"[",m[p]+S,"]"].join(""))}for(var p=0;p<c.scalarArgs.length;++p)w.push("Y"+p);if(c.shapeArgs.length>0&&C.push("shape=SS.slice(0)"),c.indexArgs.length>0){for(var T=new Array(u),p=0;p<u;++p)T[p]="0";C.push(["index=[",T.join(","),"]"].join(""))}for(var p=0;p<c.offsetArgs.length;++p){for(var A=c.offsetArgs[p],M=[],S=0;S<A.offset.length;++S)A.offset[S]!==0&&(A.offset[S]===1?M.push(["t",A.array,"p",S].join("")):M.push([A.offset[S],"*t",A.array,"p",S].join("")));M.length===0?C.push("q"+p+"=0"):C.push(["q",p,"=",M.join("+")].join(""))}var P=r([].concat(c.pre.thisVars).concat(c.body.thisVars).concat(c.post.thisVars));C=C.concat(P),C.length>0&&E.push("var "+C.join(","));for(var p=0;p<c.arrayArgs.length;++p)E.push("p"+p+"|=0");c.pre.body.length>3&&E.push(a(c.pre,c,f));var I=a(c.body,c,f),R=s(b);R<u?E.push(n(R,b[0],c,I)):E.push(i(b[0],c,I)),c.post.body.length>3&&E.push(a(c.post,c,f)),c.debug&&console.log("-----Generated cwise routine for ",d,`:
`+E.join(`
`)+`
----------`);var N=[c.funcName||"unnamed","_cwise_loop_",h[0].join("s"),"m",R,o(f)].join(""),k=new Function(["function ",N,"(",w.join(","),"){",E.join(`
`),"} return ",N].join(""));return k()}t.exports=l}),J4e=us((e,t)=>{var r=Z4e();function i(n){var s=["'use strict'","var CACHED={}"],a=[],o=n.funcName+"_cwise_thunk";s.push(["return function ",o,"(",n.shimArgs.join(","),"){"].join(""));for(var l=[],c=[],d=[["array",n.arrayArgs[0],".shape.slice(",Math.max(0,n.arrayBlockIndices[0]),n.arrayBlockIndices[0]<0?","+n.arrayBlockIndices[0]+")":")"].join("")],u=[],h=[],f=0;f<n.arrayArgs.length;++f){var p=n.arrayArgs[f];a.push(["t",p,"=array",p,".dtype,","r",p,"=array",p,".order"].join("")),l.push("t"+p),l.push("r"+p),c.push("t"+p),c.push("r"+p+".join()"),d.push("array"+p+".data"),d.push("array"+p+".stride"),d.push("array"+p+".offset|0"),f>0&&(u.push("array"+n.arrayArgs[0]+".shape.length===array"+p+".shape.length+"+(Math.abs(n.arrayBlockIndices[0])-Math.abs(n.arrayBlockIndices[f]))),h.push("array"+n.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,n.arrayBlockIndices[0])+"]===array"+p+".shape[shapeIndex+"+Math.max(0,n.arrayBlockIndices[f])+"]"))}n.arrayArgs.length>1&&(s.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),s.push("for(var shapeIndex=array"+n.arrayArgs[0]+".shape.length-"+Math.abs(n.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),s.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),s.push("}"));for(var f=0;f<n.scalarArgs.length;++f)d.push("scalar"+n.scalarArgs[f]);a.push(["type=[",c.join(","),"].join()"].join("")),a.push("proc=CACHED[type]"),s.push("var "+a.join(",")),s.push(["if(!proc){","CACHED[type]=proc=compile([",l.join(","),"])}","return proc(",d.join(","),")}"].join("")),n.debug&&console.log(`-----Generated thunk:
`+s.join(`
`)+`
----------`);var m=new Function("compile",s.join(`
`));return m(r.bind(void 0,n))}t.exports=i}),eje=us((e,t)=>{var r=J4e();function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function n(s){var a=new i;a.pre=s.pre,a.body=s.body,a.post=s.post;var o=s.args.slice(0);a.argTypes=o;for(var l=0;l<o.length;++l){var c=o[l];if(c==="array"||typeof c=="object"&&c.blockIndices){if(a.argTypes[l]="array",a.arrayArgs.push(l),a.arrayBlockIndices.push(c.blockIndices?c.blockIndices:0),a.shimArgs.push("array"+l),l<a.pre.args.length&&a.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array args");if(l<a.post.args.length&&a.post.args[l].count>0)throw new Error("cwise: post() block may not reference array args")}else if(c==="scalar")a.scalarArgs.push(l),a.shimArgs.push("scalar"+l);else if(c==="index"){if(a.indexArgs.push(l),l<a.pre.args.length&&a.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array index");if(l<a.body.args.length&&a.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array index");if(l<a.post.args.length&&a.post.args[l].count>0)throw new Error("cwise: post() block may not reference array index")}else if(c==="shape"){if(a.shapeArgs.push(l),l<a.pre.args.length&&a.pre.args[l].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(l<a.body.args.length&&a.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array shape");if(l<a.post.args.length&&a.post.args[l].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if(typeof c=="object"&&c.offset)a.argTypes[l]="offset",a.offsetArgs.push({array:c.array,offset:c.offset}),a.offsetArgIndex.push(l);else throw new Error("cwise: Unknown argument type "+o[l])}if(a.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(a.pre.args.length>o.length)throw new Error("cwise: Too many arguments in pre() block");if(a.body.args.length>o.length)throw new Error("cwise: Too many arguments in body() block");if(a.post.args.length>o.length)throw new Error("cwise: Too many arguments in post() block");return a.debug=!!s.printCode||!!s.debug,a.funcName=s.funcName||"cwise",a.blockSize=s.blockSize||64,r(a)}t.exports=n}),pw=us(e=>{var t=eje(),r={body:"",args:[],thisVars:[],localVars:[]};function i(h){if(!h)return r;for(var f=0;f<h.args.length;++f){var p=h.args[f];f===0?h.args[f]={name:p,lvalue:!0,rvalue:!!h.rvalue,count:h.count||1}:h.args[f]={name:p,lvalue:!1,rvalue:!0,count:1}}return h.thisVars||(h.thisVars=[]),h.localVars||(h.localVars=[]),h}function n(h){return t({args:h.args,pre:i(h.pre),body:i(h.body),post:i(h.proc),funcName:h.funcName})}function s(h){for(var f=[],p=0;p<h.args.length;++p)f.push("a"+p);var m=new Function("P",["return function ",h.funcName,"_ndarrayops(",f.join(","),") {P(",f.join(","),");return a0}"].join(""));return m(n(h))}var a={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var h in a){var f=a[h];e[h]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+f+"c"},funcName:h}),e[h+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+f+"=b"},rvalue:!0,funcName:h+"eq"}),e[h+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+f+"s"},funcName:h+"s"}),e[h+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+f+"=s"},rvalue:!0,funcName:h+"seq"})}})();var o={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var h in o){var f=o[h];e[h]=s({args:["array","array"],body:{args:["a","b"],body:"a="+f+"b"},funcName:h}),e[h+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+f+"a"},rvalue:!0,count:2,funcName:h+"eq"})}})();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var h in l){var f=l[h];e[h]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+f+"c"},funcName:h}),e[h+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+f+"s"},funcName:h+"s"}),e[h+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+f+"b"},rvalue:!0,count:2,funcName:h+"eq"}),e[h+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+f+"s"},rvalue:!0,count:2,funcName:h+"seq"})}})();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var h=0;h<c.length;++h){var f=c[h];e[f]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f}),e[f+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"})}})();var d=["max","min","atan2","pow"];(function(){for(var h=0;h<d.length;++h){var f=d[h];e[f]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f}),e[f+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"}),e[f+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"}),e[f+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"seq"})}})();var u=["atan2","pow"];(function(){for(var h=0;h<u.length;++h){var f=u[h];e[f+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"}),e[f+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"}),e[f+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opeq"}),e[f+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opseq"})}})(),e.any=t({args:["array"],pre:r,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),e.all=t({args:["array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),e.sum=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),e.prod=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),e.norm2squared=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),e.norm2=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),e.norminf=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),e.norm1=t({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),e.sup=t({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.inf=t({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.argmin=t({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.argmax=t({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),e.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),e.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),e.equals=t({args:["array","array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})}),tje=us((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),s=i.split("."),a=0;a<3;a++){var o=Number(n[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),D0="149",Lo={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},rje=0,jH=1,ije=2,y4=1,nje=2,h1=3,Yl=0,is=1,$a=2,Tn=0,op=1,VH=2,UH=3,$H=4,sje=5,gg=100,aje=101,oje=102,HH=103,WH=104,lje=200,cje=201,uje=202,dje=203,vne=204,yne=205,hje=206,fje=207,pje=208,mje=209,gje=210,vje=0,yje=1,bje=2,CL=3,xje=4,wje=5,_je=6,Sje=7,bne=0,Eje=1,Cje=2,Hc=0,Aje=1,Tje=2,Mje=3,Pje=4,Ije=5,xne=300,Lp=301,Np=302,AL=303,TL=304,mw=306,Vu=1e3,Si=1001,ML=1002,Hr=1003,GH=1004,$I=1005,dr=1006,Rje=1007,Gv=1008,na=1009,Dje=1010,Oje=1011,wne=1012,Lje=1013,Uu=1014,Cn=1015,kp=1016,Nje=1017,kje=1018,lp=1020,zje=1021,ts=1023,Bje=1024,Fje=1025,cp=1026,zp=1027,jje=1028,Vje=1029,hA=1030,Uje=1031,_ne=1033,HI=33776,WI=33777,GI=33778,qI=33779,qH=35840,XH=35841,YH=35842,KH=35843,$je=36196,QH=37492,ZH=37496,JH=37808,eW=37809,tW=37810,rW=37811,iW=37812,nW=37813,sW=37814,aW=37815,oW=37816,lW=37817,cW=37818,uW=37819,dW=37820,hW=37821,XI=36492,Hje=36283,fW=36284,pW=36285,mW=36286,Sne=2200,Ene=2201,b4=2202,fA=2300,pA=2301,YI=2302,jg=2400,Vg=2401,mA=2402,x4=2500,Wje=2501,Kl=3e3,nr=3001,yd=3200,Cne=3201,Gje=0,qje=1,yc="srgb",gA="srgb-linear",KI=7680,Xje=519,PL=35044,Yje=35048,gW="300 es",IL=1035,Ls=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},Fs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],vW=1234567,Y1=Math.PI/180,rx=180/Math.PI;function Jo(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Fs[e&255]+Fs[e>>8&255]+Fs[e>>16&255]+Fs[e>>24&255]+"-"+Fs[t&255]+Fs[t>>8&255]+"-"+Fs[t>>16&15|64]+Fs[t>>24&255]+"-"+Fs[r&63|128]+Fs[r>>8&255]+"-"+Fs[r>>16&255]+Fs[r>>24&255]+Fs[i&255]+Fs[i>>8&255]+Fs[i>>16&255]+Fs[i>>24&255]).toLowerCase()}function wn(e,t,r){return Math.max(t,Math.min(r,e))}function w4(e,t){return(e%t+t)%t}function Kje(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function Qje(e,t,r){return e!==t?(r-e)/(t-e):0}function K1(e,t,r){return(1-r)*e+r*t}function Zje(e,t,r,i){return K1(e,t,1-Math.exp(-r*i))}function Jje(e,t=1){return t-Math.abs(w4(e,t*2)-t)}function eVe(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function tVe(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function rVe(e,t){return e+Math.floor(Math.random()*(t-e+1))}function iVe(e,t){return e+Math.random()*(t-e)}function nVe(e){return e*(.5-Math.random())}function sVe(e){e!==void 0&&(vW=e);let t=vW+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function aVe(e){return e*Y1}function oVe(e){return e*rx}function RL(e){return(e&e-1)===0&&e!==0}function Ane(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function vA(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function lVe(e,t,r,i,n){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),c=s((t+i)/2),d=a((t+i)/2),u=s((t-i)/2),h=a((t-i)/2),f=s((i-t)/2),p=a((i-t)/2);switch(n){case"XYX":e.set(o*d,l*u,l*h,o*c);break;case"YZY":e.set(l*h,o*d,l*u,o*c);break;case"ZXZ":e.set(l*u,l*h,o*d,o*c);break;case"XZX":e.set(o*d,l*p,l*f,o*c);break;case"YXY":e.set(l*f,o*d,l*p,o*c);break;case"ZYZ":e.set(l*p,l*f,o*d,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function $u(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function di(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var Et=Object.freeze({__proto__:null,DEG2RAD:Y1,RAD2DEG:rx,ceilPowerOfTwo:Ane,clamp:wn,damp:Zje,degToRad:aVe,denormalize:$u,euclideanModulo:w4,floorPowerOfTwo:vA,generateUUID:Jo,inverseLerp:Qje,isPowerOfTwo:RL,lerp:K1,mapLinear:Kje,normalize:di,pingpong:Jje,radToDeg:oVe,randFloat:iVe,randFloatSpread:nVe,randInt:rVe,seededRandom:sVe,setQuaternionFromProperEuler:lVe,smootherstep:tVe,smoothstep:eVe}),oe=class{constructor(t=0,r=0){oe.prototype.isVector2=!0,this.x=t,this.y=r}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,r){return this.x=t,this.y=r,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let r=this.x,i=this.y,n=t.elements;return this.x=n[0]*r+n[3]*i+n[6],this.y=n[1]*r+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this}clampScalar(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this}clampLength(t,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let r=this.x-t.x,i=this.y-t.y;return r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this}lerpVectors(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this}rotateAround(t,r){let i=Math.cos(r),n=Math.sin(r),s=this.x-t.x,a=this.y-t.y;return this.x=s*i-a*n+t.x,this.y=s*n+a*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},on=class{constructor(){on.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=n,c[5]=o,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],c=r[4],d=r[7],u=r[2],h=r[5],f=r[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],b=i[7],x=i[2],S=i[5],w=i[8];return n[0]=s*p+a*v+o*x,n[3]=s*m+a*y+o*S,n[6]=s*g+a*b+o*w,n[1]=l*p+c*v+d*x,n[4]=l*m+c*y+d*S,n[7]=l*g+c*b+d*w,n[2]=u*p+h*v+f*x,n[5]=u*m+h*y+f*S,n[8]=u*g+h*b+f*w,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-r*n*c+r*a*o+i*n*l-i*s*o}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],d=c*s-a*l,u=a*o-c*n,h=l*n-s*o,f=t*d+r*u+i*h;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=d*p,e[1]=(i*l-c*r)*p,e[2]=(a*r-i*s)*p,e[3]=u*p,e[4]=(c*t-i*o)*p,e[5]=(i*n-a*t)*p,e[6]=h*p,e[7]=(r*o-l*t)*p,e[8]=(s*t-r*n)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(QI.makeScale(e,t)),this}rotate(e){return this.premultiply(QI.makeRotation(-e)),this}translate(e,t){return this.premultiply(QI.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},QI=new on;function Tne(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var cVe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function w_(e,t){return new cVe[e](t)}function ix(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function up(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function SE(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var ZI={[yc]:{[gA]:up},[gA]:{[yc]:SE}},oa={legacyMode:!0,get workingColorSpace(){return gA},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(ZI[t]&&ZI[t][r]!==void 0){let i=ZI[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},Mne={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Rn={r:0,g:0,b:0},ul={h:0,s:0,l:0},__={h:0,s:0,l:0};function JI(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function S_(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var zt=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=yc){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,oa.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=oa.workingColorSpace){return this.r=e,this.g=t,this.b=r,oa.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=oa.workingColorSpace){if(e=w4(e,1),t=wn(t,0,1),r=wn(r,0,1),t===0)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,s=2*r-n;this.r=JI(s,n,e+1/3),this.g=JI(s,n,e),this.b=JI(s,n,e-1/3)}return oa.toWorkingColorSpace(this,i),this}setStyle(e,t=yc){function r(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,s=i[1],a=i[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,oa.toWorkingColorSpace(this,t),r(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,oa.toWorkingColorSpace(this,t),r(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let o=parseFloat(n[1])/360,l=parseFloat(n[2])/100,c=parseFloat(n[3])/100;return r(n[4]),this.setHSL(o,l,c,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=i[1],s=n.length;if(s===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,oa.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,oa.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=yc){let r=Mne[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=up(e.r),this.g=up(e.g),this.b=up(e.b),this}copyLinearToSRGB(e){return this.r=SE(e.r),this.g=SE(e.g),this.b=SE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=yc){return oa.fromWorkingColorSpace(S_(this,Rn),e),wn(Rn.r*255,0,255)<<16^wn(Rn.g*255,0,255)<<8^wn(Rn.b*255,0,255)<<0}getHexString(e=yc){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=oa.workingColorSpace){oa.fromWorkingColorSpace(S_(this,Rn),t);let r=Rn.r,i=Rn.g,n=Rn.b,s=Math.max(r,i,n),a=Math.min(r,i,n),o,l,c=(a+s)/2;if(a===s)o=0,l=0;else{let d=s-a;switch(l=c<=.5?d/(s+a):d/(2-s-a),s){case r:o=(i-n)/d+(i<n?6:0);break;case i:o=(n-r)/d+2;break;case n:o=(r-i)/d+4;break}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t=oa.workingColorSpace){return oa.fromWorkingColorSpace(S_(this,Rn),t),e.r=Rn.r,e.g=Rn.g,e.b=Rn.b,e}getStyle(e=yc){return oa.fromWorkingColorSpace(S_(this,Rn),e),e!==yc?`color(${e} ${Rn.r} ${Rn.g} ${Rn.b})`:`rgb(${Rn.r*255|0},${Rn.g*255|0},${Rn.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(ul),ul.h+=e,ul.s+=t,ul.l+=r,this.setHSL(ul.h,ul.s,ul.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(ul),e.getHSL(__);let r=K1(ul.h,__.h,t),i=K1(ul.s,__.s,t),n=K1(ul.l,__.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};zt.NAMES=Mne;var Im,Pne=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Im===void 0&&(Im=ix("canvas")),Im.width=e.width,Im.height=e.height;let r=Im.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Im}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=ix("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let s=0;s<n.length;s++)n[s]=up(n[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(up(t[r]/255)*255):t[r]=up(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Ine=class{constructor(e=null){this.isSource=!0,this.uuid=Jo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?n.push(eR(i[s].image)):n.push(eR(i[s]))}else n=eR(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function eR(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?Pne.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var uVe=0,Li=class extends Ls{constructor(e=Li.DEFAULT_IMAGE,t=Li.DEFAULT_MAPPING,r=Si,i=Si,n=dr,s=Gv,a=ts,o=na,l=Li.DEFAULT_ANISOTROPY,c=Kl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:uVe++}),this.uuid=Jo(),this.name="",this.source=new Ine(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new oe(0,0),this.repeat=new oe(1,1),this.center=new oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new on,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==xne)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Vu:e.x=e.x-Math.floor(e.x);break;case Si:e.x=e.x<0?0:1;break;case ML:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Vu:e.y=e.y-Math.floor(e.y);break;case Si:e.y=e.y<0?0:1;break;case ML:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};Li.DEFAULT_IMAGE=null;Li.DEFAULT_MAPPING=xne;Li.DEFAULT_ANISOTROPY=1;var Yt=class{constructor(e=0,t=0,r=0,i=1){Yt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],d=s[5],u=s[9],h=s[2],f=s[6],p=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-h)<.01&&Math.abs(u-f)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+h)<.1&&Math.abs(u+f)<.1&&Math.abs(a+d+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let g=(a+1)/2,v=(d+1)/2,y=(p+1)/2,b=(o+c)/4,x=(l+h)/4,S=(u+f)/4;return g>v&&g>y?g<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(g),i=b/r,n=x/r):v>y?v<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(v),r=b/i,n=S/i):y<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),r=x/n,i=S/n),this.set(r,i,n,t),this}let m=Math.sqrt((f-u)*(f-u)+(l-h)*(l-h)+(c-o)*(c-o));return Math.abs(m)<.001&&(m=1),this.x=(f-u)/m,this.y=(l-h)/m,this.z=(c-o)/m,this.w=Math.acos((a+d+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Wr=class extends Ls{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Yt(0,0,e,t),this.scissorTest=!1,this.viewport=new Yt(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Li(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:dr,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Ine(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Rne=class extends Li{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Hr,this.minFilter=Hr,this.wrapR=Si,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},dVe=class extends Li{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Hr,this.minFilter=Hr,this.wrapR=Si,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},hVe=class extends Wr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<r;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Xt=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,a){let o=r[i+0],l=r[i+1],c=r[i+2],d=r[i+3],u=n[s+0],h=n[s+1],f=n[s+2],p=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=c,e[t+3]=d;return}if(a===1){e[t+0]=u,e[t+1]=h,e[t+2]=f,e[t+3]=p;return}if(d!==p||o!==u||l!==h||c!==f){let m=1-a,g=o*u+l*h+c*f+d*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let x=Math.sqrt(y),S=Math.atan2(x,g*v);m=Math.sin(m*S)/x,a=Math.sin(a*S)/x}let b=a*v;if(o=o*m+u*b,l=l*m+h*b,c=c*m+f*b,d=d*m+p*b,m===1-a){let x=1/Math.sqrt(o*o+l*l+c*c+d*d);o*=x,l*=x,c*=x,d*=x}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,r,i,n,s){let a=r[i],o=r[i+1],l=r[i+2],c=r[i+3],d=n[s],u=n[s+1],h=n[s+2],f=n[s+3];return e[t]=a*f+c*d+o*h-l*u,e[t+1]=o*f+c*u+l*d-a*h,e[t+2]=l*f+c*h+a*u-o*d,e[t+3]=c*f-a*d-o*u-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),c=a(i/2),d=a(n/2),u=o(r/2),h=o(i/2),f=o(n/2);switch(s){case"XYZ":this._x=u*c*d+l*h*f,this._y=l*h*d-u*c*f,this._z=l*c*f+u*h*d,this._w=l*c*d-u*h*f;break;case"YXZ":this._x=u*c*d+l*h*f,this._y=l*h*d-u*c*f,this._z=l*c*f-u*h*d,this._w=l*c*d+u*h*f;break;case"ZXY":this._x=u*c*d-l*h*f,this._y=l*h*d+u*c*f,this._z=l*c*f+u*h*d,this._w=l*c*d-u*h*f;break;case"ZYX":this._x=u*c*d-l*h*f,this._y=l*h*d+u*c*f,this._z=l*c*f-u*h*d,this._w=l*c*d+u*h*f;break;case"YZX":this._x=u*c*d+l*h*f,this._y=l*h*d+u*c*f,this._z=l*c*f-u*h*d,this._w=l*c*d-u*h*f;break;case"XZY":this._x=u*c*d-l*h*f,this._y=l*h*d-u*c*f,this._z=l*c*f+u*h*d,this._w=l*c*d+u*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],d=t[10],u=r+a+d;if(u>0){let h=.5/Math.sqrt(u+1);this._w=.25/h,this._x=(c-o)*h,this._y=(n-l)*h,this._z=(s-i)*h}else if(r>a&&r>d){let h=2*Math.sqrt(1+r-a-d);this._w=(c-o)/h,this._x=.25*h,this._y=(i+s)/h,this._z=(n+l)/h}else if(a>d){let h=2*Math.sqrt(1+a-r-d);this._w=(n-l)/h,this._x=(i+s)/h,this._y=.25*h,this._z=(o+c)/h}else{let h=2*Math.sqrt(1+d-r-a);this._w=(s-i)/h,this._x=(n+l)/h,this._y=(o+c)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wn(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=r*c+s*a+i*l-n*o,this._y=i*c+s*o+n*a-r*l,this._z=n*c+s*l+r*o-i*a,this._w=s*c-r*a-i*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,a=s*e._w+r*e._x+i*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let h=1-t;return this._w=h*s+t*this._w,this._x=h*r+t*this._x,this._y=h*i+t*this._y,this._z=h*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),d=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=s*d+this._w*u,this._x=r*d+this._x*u,this._y=i*d+this._y*u,this._z=n*d+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},L=class{constructor(e=0,t=0,r=0){L.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(yW.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(yW.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*r,c=o*r+a*t-n*i,d=o*i+n*r-s*t,u=-n*t-s*r-a*i;return this.x=l*o+u*-n+c*-a-d*-s,this.y=c*o+u*-s+d*-n-l*-a,this.z=d*o+u*-a+l*-s-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-n*a,this.y=n*s-r*o,this.z=r*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return tR.copy(this).projectOnVector(e),this.sub(tR)}reflect(e){return this.sub(tR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(wn(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},tR=new L,yW=new Xt,un=class{constructor(e=new L(1/0,1/0,1/0),t=new L(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let c=e[o],d=e[o+1],u=e[o+2];c<t&&(t=c),d<r&&(r=d),u<i&&(i=u),c>n&&(n=c),d>s&&(s=d),u>a&&(a=u)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let c=e.getX(o),d=e.getY(o),u=e.getZ(o);c<t&&(t=c),d<r&&(r=d),u<i&&(i=u),c>n&&(n=c),d>s&&(s=d),u>a&&(a=u)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=of.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let s=0,a=n.count;s<a;s++)of.fromBufferAttribute(n,s).applyMatrix4(e.matrixWorld),this.expandByPoint(of)}else r.boundingBox===null&&r.computeBoundingBox(),rR.copy(r.boundingBox),rR.applyMatrix4(e.matrixWorld),this.union(rR);let i=e.children;for(let n=0,s=i.length;n<s;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,of),of.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(wy),E_.subVectors(this.max,wy),Rm.subVectors(e.a,wy),Dm.subVectors(e.b,wy),Om.subVectors(e.c,wy),Cd.subVectors(Dm,Rm),Ad.subVectors(Om,Dm),lf.subVectors(Rm,Om);let t=[0,-Cd.z,Cd.y,0,-Ad.z,Ad.y,0,-lf.z,lf.y,Cd.z,0,-Cd.x,Ad.z,0,-Ad.x,lf.z,0,-lf.x,-Cd.y,Cd.x,0,-Ad.y,Ad.x,0,-lf.y,lf.x,0];return!iR(t,Rm,Dm,Om,E_)||(t=[1,0,0,0,1,0,0,0,1],!iR(t,Rm,Dm,Om,E_))?!1:(C_.crossVectors(Cd,Ad),t=[C_.x,C_.y,C_.z],iR(t,Rm,Dm,Om,E_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return of.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(of).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(uu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),uu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),uu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),uu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),uu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),uu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),uu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),uu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(uu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},uu=[new L,new L,new L,new L,new L,new L,new L,new L],of=new L,rR=new un,Rm=new L,Dm=new L,Om=new L,Cd=new L,Ad=new L,lf=new L,wy=new L,E_=new L,C_=new L,cf=new L;function iR(e,t,r,i,n){for(let s=0,a=e.length-3;s<=a;s+=3){cf.fromArray(e,s);let o=n.x*Math.abs(cf.x)+n.y*Math.abs(cf.y)+n.z*Math.abs(cf.z),l=t.dot(cf),c=r.dot(cf),d=i.dot(cf);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>o)return!1}return!0}var fVe=new un,_y=new L,nR=new L,Za=class{constructor(e=new L,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):fVe.setFromPoints(e).getCenter(r);let i=0;for(let n=0,s=e.length;n<s;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_y.subVectors(e,this.center);let t=_y.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(_y,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(nR.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_y.copy(e.center).add(nR)),this.expandByPoint(_y.copy(e.center).sub(nR))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},du=new L,sR=new L,A_=new L,Td=new L,aR=new L,T_=new L,oR=new L,O0=class{constructor(e=new L,t=new L(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,du)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=du.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(du.copy(this.direction).multiplyScalar(t).add(this.origin),du.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){sR.copy(e).add(t).multiplyScalar(.5),A_.copy(t).sub(e).normalize(),Td.copy(this.origin).sub(sR);let n=e.distanceTo(t)*.5,s=-this.direction.dot(A_),a=Td.dot(this.direction),o=-Td.dot(A_),l=Td.lengthSq(),c=Math.abs(1-s*s),d,u,h,f;if(c>0)if(d=s*o-a,u=s*a-o,f=n*c,d>=0)if(u>=-f)if(u<=f){let p=1/c;d*=p,u*=p,h=d*(d+s*u+2*a)+u*(s*d+u+2*o)+l}else u=n,d=Math.max(0,-(s*u+a)),h=-d*d+u*(u+2*o)+l;else u=-n,d=Math.max(0,-(s*u+a)),h=-d*d+u*(u+2*o)+l;else u<=-f?(d=Math.max(0,-(-s*n+a)),u=d>0?-n:Math.min(Math.max(-n,-o),n),h=-d*d+u*(u+2*o)+l):u<=f?(d=0,u=Math.min(Math.max(-n,-o),n),h=u*(u+2*o)+l):(d=Math.max(0,-(s*n+a)),u=d>0?n:Math.min(Math.max(-n,-o),n),h=-d*d+u*(u+2*o)+l);else u=s>0?-n:n,d=Math.max(0,-(s*u+a)),h=-d*d+u*(u+2*o)+l;return r&&r.copy(this.direction).multiplyScalar(d).add(this.origin),i&&i.copy(A_).multiplyScalar(u).add(sR),h}intersectSphere(e,t){du.subVectors(e.center,this.origin);let r=du.dot(this.direction),i=du.dot(du)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,a,o,l=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,u=this.origin;return l>=0?(r=(e.min.x-u.x)*l,i=(e.max.x-u.x)*l):(r=(e.max.x-u.x)*l,i=(e.min.x-u.x)*l),c>=0?(n=(e.min.y-u.y)*c,s=(e.max.y-u.y)*c):(n=(e.max.y-u.y)*c,s=(e.min.y-u.y)*c),r>s||n>i||((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),d>=0?(a=(e.min.z-u.z)*d,o=(e.max.z-u.z)*d):(a=(e.max.z-u.z)*d,o=(e.min.z-u.z)*d),r>o||a>i)||((a>r||r!==r)&&(r=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,du)!==null}intersectTriangle(e,t,r,i,n){aR.subVectors(t,e),T_.subVectors(r,e),oR.crossVectors(aR,T_);let s=this.direction.dot(oR),a;if(s>0){if(i)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Td.subVectors(this.origin,e);let o=a*this.direction.dot(T_.crossVectors(Td,T_));if(o<0)return null;let l=a*this.direction.dot(aR.cross(Td));if(l<0||o+l>s)return null;let c=-a*Td.dot(oR);return c<0?null:this.at(c/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ke=class{constructor(){Ke.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,r,i,n,s,a,o,l,c,d,u,h,f,p,m,g){let v=this.elements;return v[0]=t,v[4]=r,v[8]=i,v[12]=n,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=c,v[6]=d,v[10]=u,v[14]=h,v[3]=f,v[7]=p,v[11]=m,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ke().fromArray(this.elements)}copy(t){let r=this.elements,i=t.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this}copyPosition(t){let r=this.elements,i=t.elements;return r[12]=i[12],r[13]=i[13],r[14]=i[14],this}setFromMatrix3(t){let r=t.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(t,r,i){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,r,i){return this.set(t.x,r.x,i.x,0,t.y,r.y,i.y,0,t.z,r.z,i.z,0,0,0,0,1),this}extractRotation(t){let r=this.elements,i=t.elements,n=1/Lm.setFromMatrixColumn(t,0).length(),s=1/Lm.setFromMatrixColumn(t,1).length(),a=1/Lm.setFromMatrixColumn(t,2).length();return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=0,r[4]=i[4]*s,r[5]=i[5]*s,r[6]=i[6]*s,r[7]=0,r[8]=i[8]*a,r[9]=i[9]*a,r[10]=i[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(t){let r=this.elements,i=t.x,n=t.y,s=t.z,a=Math.cos(i),o=Math.sin(i),l=Math.cos(n),c=Math.sin(n),d=Math.cos(s),u=Math.sin(s);if(t.order==="XYZ"){let h=a*d,f=a*u,p=o*d,m=o*u;r[0]=l*d,r[4]=-l*u,r[8]=c,r[1]=f+p*c,r[5]=h-m*c,r[9]=-o*l,r[2]=m-h*c,r[6]=p+f*c,r[10]=a*l}else if(t.order==="YXZ"){let h=l*d,f=l*u,p=c*d,m=c*u;r[0]=h+m*o,r[4]=p*o-f,r[8]=a*c,r[1]=a*u,r[5]=a*d,r[9]=-o,r[2]=f*o-p,r[6]=m+h*o,r[10]=a*l}else if(t.order==="ZXY"){let h=l*d,f=l*u,p=c*d,m=c*u;r[0]=h-m*o,r[4]=-a*u,r[8]=p+f*o,r[1]=f+p*o,r[5]=a*d,r[9]=m-h*o,r[2]=-a*c,r[6]=o,r[10]=a*l}else if(t.order==="ZYX"){let h=a*d,f=a*u,p=o*d,m=o*u;r[0]=l*d,r[4]=p*c-f,r[8]=h*c+m,r[1]=l*u,r[5]=m*c+h,r[9]=f*c-p,r[2]=-c,r[6]=o*l,r[10]=a*l}else if(t.order==="YZX"){let h=a*l,f=a*c,p=o*l,m=o*c;r[0]=l*d,r[4]=m-h*u,r[8]=p*u+f,r[1]=u,r[5]=a*d,r[9]=-o*d,r[2]=-c*d,r[6]=f*u+p,r[10]=h-m*u}else if(t.order==="XZY"){let h=a*l,f=a*c,p=o*l,m=o*c;r[0]=l*d,r[4]=-u,r[8]=c*d,r[1]=h*u+m,r[5]=a*d,r[9]=f*u-p,r[2]=p*u-f,r[6]=o*d,r[10]=m*u+h}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(t){return this.compose(pVe,t,mVe)}lookAt(t,r,i){let n=this.elements;return io.subVectors(t,r),io.lengthSq()===0&&(io.z=1),io.normalize(),Md.crossVectors(i,io),Md.lengthSq()===0&&(Math.abs(i.z)===1?io.x+=1e-4:io.z+=1e-4,io.normalize(),Md.crossVectors(i,io)),Md.normalize(),M_.crossVectors(io,Md),n[0]=Md.x,n[4]=M_.x,n[8]=io.x,n[1]=Md.y,n[5]=M_.y,n[9]=io.y,n[2]=Md.z,n[6]=M_.z,n[10]=io.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){let i=t.elements,n=r.elements,s=this.elements,a=i[0],o=i[4],l=i[8],c=i[12],d=i[1],u=i[5],h=i[9],f=i[13],p=i[2],m=i[6],g=i[10],v=i[14],y=i[3],b=i[7],x=i[11],S=i[15],w=n[0],E=n[4],C=n[8],T=n[12],A=n[1],M=n[5],P=n[9],I=n[13],R=n[2],N=n[6],k=n[10],O=n[14],D=n[3],B=n[7],z=n[11],F=n[15];return s[0]=a*w+o*A+l*R+c*D,s[4]=a*E+o*M+l*N+c*B,s[8]=a*C+o*P+l*k+c*z,s[12]=a*T+o*I+l*O+c*F,s[1]=d*w+u*A+h*R+f*D,s[5]=d*E+u*M+h*N+f*B,s[9]=d*C+u*P+h*k+f*z,s[13]=d*T+u*I+h*O+f*F,s[2]=p*w+m*A+g*R+v*D,s[6]=p*E+m*M+g*N+v*B,s[10]=p*C+m*P+g*k+v*z,s[14]=p*T+m*I+g*O+v*F,s[3]=y*w+b*A+x*R+S*D,s[7]=y*E+b*M+x*N+S*B,s[11]=y*C+b*P+x*k+S*z,s[15]=y*T+b*I+x*O+S*F,this}multiplyScalar(t){let r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this}determinant(){let t=this.elements,r=t[0],i=t[4],n=t[8],s=t[12],a=t[1],o=t[5],l=t[9],c=t[13],d=t[2],u=t[6],h=t[10],f=t[14],p=t[3],m=t[7],g=t[11],v=t[15];return p*(+s*l*u-n*c*u-s*o*h+i*c*h+n*o*f-i*l*f)+m*(+r*l*f-r*c*h+s*a*h-n*a*f+n*c*d-s*l*d)+g*(+r*c*u-r*o*f-s*a*u+i*a*f+s*o*d-i*c*d)+v*(-n*o*d-r*l*u+r*o*h+n*a*u-i*a*h+i*l*d)}transpose(){let t=this.elements,r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this}setPosition(t,r,i){let n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=r,n[14]=i),this}invert(){let t=this.elements,r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],d=t[8],u=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=u*g*c-m*h*c+m*l*f-o*g*f-u*l*v+o*h*v,b=p*h*c-d*g*c-p*l*f+a*g*f+d*l*v-a*h*v,x=d*m*c-p*u*c+p*o*f-a*m*f-d*o*v+a*u*v,S=p*u*l-d*m*l-p*o*h+a*m*h+d*o*g-a*u*g,w=r*y+i*b+n*x+s*S;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let E=1/w;return t[0]=y*E,t[1]=(m*h*s-u*g*s-m*n*f+i*g*f+u*n*v-i*h*v)*E,t[2]=(o*g*s-m*l*s+m*n*c-i*g*c-o*n*v+i*l*v)*E,t[3]=(u*l*s-o*h*s-u*n*c+i*h*c+o*n*f-i*l*f)*E,t[4]=b*E,t[5]=(d*g*s-p*h*s+p*n*f-r*g*f-d*n*v+r*h*v)*E,t[6]=(p*l*s-a*g*s-p*n*c+r*g*c+a*n*v-r*l*v)*E,t[7]=(a*h*s-d*l*s+d*n*c-r*h*c-a*n*f+r*l*f)*E,t[8]=x*E,t[9]=(p*u*s-d*m*s-p*i*f+r*m*f+d*i*v-r*u*v)*E,t[10]=(a*m*s-p*o*s+p*i*c-r*m*c-a*i*v+r*o*v)*E,t[11]=(d*o*s-a*u*s-d*i*c+r*u*c+a*i*f-r*o*f)*E,t[12]=S*E,t[13]=(d*m*n-p*u*n+p*i*h-r*m*h-d*i*g+r*u*g)*E,t[14]=(p*o*n-a*m*n-p*i*l+r*m*l+a*i*g-r*o*g)*E,t[15]=(a*u*n-d*o*n+d*i*l-r*u*l-a*i*h+r*o*h)*E,this}scale(t){let r=this.elements,i=t.x,n=t.y,s=t.z;return r[0]*=i,r[4]*=n,r[8]*=s,r[1]*=i,r[5]*=n,r[9]*=s,r[2]*=i,r[6]*=n,r[10]*=s,r[3]*=i,r[7]*=n,r[11]*=s,this}getMaxScaleOnAxis(){let t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,i,n))}makeTranslation(t,r,i){return this.set(1,0,0,t,0,1,0,r,0,0,1,i,0,0,0,1),this}makeRotationX(t){let r=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1),this}makeRotationY(t){let r=Math.cos(t),i=Math.sin(t);return this.set(r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1),this}makeRotationZ(t){let r=Math.cos(t),i=Math.sin(t);return this.set(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,r){let i=Math.cos(r),n=Math.sin(r),s=1-i,a=t.x,o=t.y,l=t.z,c=s*a,d=s*o;return this.set(c*a+i,c*o-n*l,c*l+n*o,0,c*o+n*l,d*o+i,d*l-n*a,0,c*l-n*o,d*l+n*a,s*l*l+i,0,0,0,0,1),this}makeScale(t,r,i){return this.set(t,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,r,i,n,s,a){return this.set(1,i,s,0,t,1,a,0,r,n,1,0,0,0,0,1),this}compose(t,r,i){let n=this.elements,s=r._x,a=r._y,o=r._z,l=r._w,c=s+s,d=a+a,u=o+o,h=s*c,f=s*d,p=s*u,m=a*d,g=a*u,v=o*u,y=l*c,b=l*d,x=l*u,S=i.x,w=i.y,E=i.z;return n[0]=(1-(m+v))*S,n[1]=(f+x)*S,n[2]=(p-b)*S,n[3]=0,n[4]=(f-x)*w,n[5]=(1-(h+v))*w,n[6]=(g+y)*w,n[7]=0,n[8]=(p+b)*E,n[9]=(g-y)*E,n[10]=(1-(h+m))*E,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,r,i){let n=this.elements,s=Lm.set(n[0],n[1],n[2]).length(),a=Lm.set(n[4],n[5],n[6]).length(),o=Lm.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],dl.copy(this);let l=1/s,c=1/a,d=1/o;return dl.elements[0]*=l,dl.elements[1]*=l,dl.elements[2]*=l,dl.elements[4]*=c,dl.elements[5]*=c,dl.elements[6]*=c,dl.elements[8]*=d,dl.elements[9]*=d,dl.elements[10]*=d,r.setFromRotationMatrix(dl),i.x=s,i.y=a,i.z=o,this}makePerspective(t,r,i,n,s,a){let o=this.elements,l=2*s/(r-t),c=2*s/(i-n),d=(r+t)/(r-t),u=(i+n)/(i-n),h=-(a+s)/(a-s),f=-2*a*s/(a-s);return o[0]=l,o[4]=0,o[8]=d,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,r,i,n,s,a){let o=this.elements,l=1/(r-t),c=1/(i-n),d=1/(a-s),u=(r+t)*l,h=(i+n)*c,f=(a+s)*d;return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*d,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){let r=this.elements,i=t.elements;for(let n=0;n<16;n++)if(r[n]!==i[n])return!1;return!0}fromArray(t,r=0){for(let i=0;i<16;i++)this.elements[i]=t[i+r];return this}toArray(t=[],r=0){let i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t[r+9]=i[9],t[r+10]=i[10],t[r+11]=i[11],t[r+12]=i[12],t[r+13]=i[13],t[r+14]=i[14],t[r+15]=i[15],t}},Lm=new L,dl=new Ke,pVe=new L(0,0,0),mVe=new L(1,1,1),Md=new L,M_=new L,io=new L,bW=new Ke,xW=new Xt,kn=class{constructor(e=0,t=0,r=0,i=kn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],d=i[2],u=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(wn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-wn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-d,n),this._z=0);break;case"ZXY":this._x=Math.asin(wn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-wn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(wn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,n)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-wn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return bW.makeRotationFromQuaternion(e),this.setFromRotationMatrix(bW,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return xW.setFromEuler(this),this.setFromQuaternion(xW,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};kn.DEFAULT_ORDER="XYZ";var _4=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},gVe=0,wW=new L,Nm=new Xt,hu=new Ke,P_=new L,Sy=new L,vVe=new L,yVe=new Xt,_W=new L(1,0,0),SW=new L(0,1,0),EW=new L(0,0,1),bVe={type:"added"},CW={type:"removed"},Yr=class extends Ls{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:gVe++}),this.uuid=Jo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Yr.DEFAULT_UP.clone();let e=new L,t=new kn,r=new Xt,i=new L(1,1,1);function n(){r.setFromEuler(t,!1)}function s(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ke},normalMatrix:{value:new on}}),this.matrix=new Ke,this.matrixWorld=new Ke,this.matrixAutoUpdate=Yr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Yr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new _4,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Nm.setFromAxisAngle(e,t),this.quaternion.multiply(Nm),this}rotateOnWorldAxis(e,t){return Nm.setFromAxisAngle(e,t),this.quaternion.premultiply(Nm),this}rotateX(e){return this.rotateOnAxis(_W,e)}rotateY(e){return this.rotateOnAxis(SW,e)}rotateZ(e){return this.rotateOnAxis(EW,e)}translateOnAxis(e,t){return wW.copy(e).applyQuaternion(this.quaternion),this.position.add(wW.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(_W,e)}translateY(e){return this.translateOnAxis(SW,e)}translateZ(e){return this.translateOnAxis(EW,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(hu.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?P_.copy(e):P_.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),Sy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hu.lookAt(Sy,P_,this.up):hu.lookAt(P_,Sy,this.up),this.quaternion.setFromRotationMatrix(hu),i&&(hu.extractRotation(i.matrixWorld),Nm.setFromRotationMatrix(hu),this.quaternion.premultiply(Nm.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(bVe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(CW)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(CW)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),hu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),hu.multiply(e.parent.matrixWorld)),e.applyMatrix4(hu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i].getObjectsByProperty(e,t);s.length>0&&(r=r.concat(s))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sy,e,vVe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sy,yVe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++){let n=t[r];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,s=i.length;n<s;n++){let a=i[n];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,c=o.length;l<c;l++){let d=o[l];n(e.shapes,d)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(n(e.materials,this.material[o]));i.material=a}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];i.animations.push(n(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),c=s(e.images),d=s(e.shapes),u=s(e.skeletons),h=s(e.animations),f=s(e.nodes);a.length>0&&(r.geometries=a),o.length>0&&(r.materials=o),l.length>0&&(r.textures=l),c.length>0&&(r.images=c),d.length>0&&(r.shapes=d),u.length>0&&(r.skeletons=u),h.length>0&&(r.animations=h),f.length>0&&(r.nodes=f)}return r.object=i,r;function s(a){let o=[];for(let l in a){let c=a[l];delete c.metadata,o.push(c)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};Yr.DEFAULT_UP=new L(0,1,0);Yr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Yr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var hl=new L,fu=new L,lR=new L,pu=new L,km=new L,zm=new L,AW=new L,cR=new L,uR=new L,dR=new L,xs=class{constructor(t=new L,r=new L,i=new L){this.a=t,this.b=r,this.c=i}static getNormal(t,r,i,n){n.subVectors(i,r),hl.subVectors(t,r),n.cross(hl);let s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(t,r,i,n,s){hl.subVectors(n,r),fu.subVectors(i,r),lR.subVectors(t,r);let a=hl.dot(hl),o=hl.dot(fu),l=hl.dot(lR),c=fu.dot(fu),d=fu.dot(lR),u=a*c-o*o;if(u===0)return s.set(-2,-1,-1);let h=1/u,f=(c*l-o*d)*h,p=(a*d-o*l)*h;return s.set(1-f-p,p,f)}static containsPoint(t,r,i,n){return this.getBarycoord(t,r,i,n,pu),pu.x>=0&&pu.y>=0&&pu.x+pu.y<=1}static getUV(t,r,i,n,s,a,o,l){return this.getBarycoord(t,r,i,n,pu),l.set(0,0),l.addScaledVector(s,pu.x),l.addScaledVector(a,pu.y),l.addScaledVector(o,pu.z),l}static isFrontFacing(t,r,i,n){return hl.subVectors(i,r),fu.subVectors(t,r),hl.cross(fu).dot(n)<0}set(t,r,i){return this.a.copy(t),this.b.copy(r),this.c.copy(i),this}setFromPointsAndIndices(t,r,i,n){return this.a.copy(t[r]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,r,i,n){return this.a.fromBufferAttribute(t,r),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return hl.subVectors(this.c,this.b),fu.subVectors(this.a,this.b),hl.cross(fu).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return xs.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,r){return xs.getBarycoord(t,this.a,this.b,this.c,r)}getUV(t,r,i,n,s){return xs.getUV(t,this.a,this.b,this.c,r,i,n,s)}containsPoint(t){return xs.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return xs.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,r){let i=this.a,n=this.b,s=this.c,a,o;km.subVectors(n,i),zm.subVectors(s,i),cR.subVectors(t,i);let l=km.dot(cR),c=zm.dot(cR);if(l<=0&&c<=0)return r.copy(i);uR.subVectors(t,n);let d=km.dot(uR),u=zm.dot(uR);if(d>=0&&u<=d)return r.copy(n);let h=l*u-d*c;if(h<=0&&l>=0&&d<=0)return a=l/(l-d),r.copy(i).addScaledVector(km,a);dR.subVectors(t,s);let f=km.dot(dR),p=zm.dot(dR);if(p>=0&&f<=p)return r.copy(s);let m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return o=c/(c-p),r.copy(i).addScaledVector(zm,o);let g=d*p-f*u;if(g<=0&&u-d>=0&&f-p>=0)return AW.subVectors(s,n),o=(u-d)/(u-d+(f-p)),r.copy(n).addScaledVector(AW,o);let v=1/(g+m+h);return a=m*v,o=h*v,r.copy(i).addScaledVector(km,a).addScaledVector(zm,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},xVe=0,gw=class extends Ls{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:xVe++}),this.uuid=Jo(),this.name="",this.type="Material",this.blending=op,this.side=Yl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=vne,this.blendDst=yne,this.blendEquation=gg,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=CL,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Xje,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KI,this.stencilZFail=KI,this.stencilZPass=KI,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==op&&(r.blending=this.blending),this.side!==Yl&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=i(e.textures),s=i(e.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},em=class extends gw{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new zt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=bne,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},mn=new L,I_=new oe,Wt=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=PL,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)I_.fromBufferAttribute(this,t),I_.applyMatrix3(e),this.setXY(t,I_.x,I_.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.applyMatrix3(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.applyMatrix4(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.applyNormalMatrix(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.transformDirection(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=$u(t,this.array)),t}setX(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=$u(t,this.array)),t}setY(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=$u(t,this.array)),t}setZ(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=$u(t,this.array)),t}setW(e,t){return this.normalized&&(t=di(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array),n=di(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==PL&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},Dne=class extends Wt{constructor(e,t,r){super(new Uint16Array(e),t,r)}},av=class extends Wt{constructor(e,t,r){super(new Uint32Array(e),t,r)}},vt=class extends Wt{constructor(e,t,r){super(new Float32Array(e),t,r)}},wVe=0,No=new Ke,hR=new Yr,Bm=new L,no=new un,Ey=new un,qn=new L,Dt=class extends Ls{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:wVe++}),this.uuid=Jo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Tne(e)?av:Dne)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let n=new on().getNormalMatrix(e);r.applyNormalMatrix(n),r.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return No.makeRotationFromQuaternion(e),this.applyMatrix4(No),this}rotateX(e){return No.makeRotationX(e),this.applyMatrix4(No),this}rotateY(e){return No.makeRotationY(e),this.applyMatrix4(No),this}rotateZ(e){return No.makeRotationZ(e),this.applyMatrix4(No),this}translate(e,t,r){return No.makeTranslation(e,t,r),this.applyMatrix4(No),this}scale(e,t,r){return No.makeScale(e,t,r),this.applyMatrix4(No),this}lookAt(e){return hR.lookAt(e),hR.updateMatrix(),this.applyMatrix4(hR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bm).negate(),this.translate(Bm.x,Bm.y,Bm.z),this}setFromPoints(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new vt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new un);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new L(-1/0,-1/0,-1/0),new L(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){let n=t[r];no.setFromBufferAttribute(n),this.morphTargetsRelative?(qn.addVectors(this.boundingBox.min,no.min),this.boundingBox.expandByPoint(qn),qn.addVectors(this.boundingBox.max,no.max),this.boundingBox.expandByPoint(qn)):(this.boundingBox.expandByPoint(no.min),this.boundingBox.expandByPoint(no.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Za);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new L,1/0);return}if(e){let r=this.boundingSphere.center;if(no.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){let a=t[n];Ey.setFromBufferAttribute(a),this.morphTargetsRelative?(qn.addVectors(no.min,Ey.min),no.expandByPoint(qn),qn.addVectors(no.max,Ey.max),no.expandByPoint(qn)):(no.expandByPoint(Ey.min),no.expandByPoint(Ey.max))}no.getCenter(r);let i=0;for(let n=0,s=e.count;n<s;n++)qn.fromBufferAttribute(e,n),i=Math.max(i,r.distanceToSquared(qn));if(t)for(let n=0,s=t.length;n<s;n++){let a=t[n],o=this.morphTargetsRelative;for(let l=0,c=a.count;l<c;l++)qn.fromBufferAttribute(a,l),o&&(Bm.fromBufferAttribute(e,l),qn.add(Bm)),i=Math.max(i,r.distanceToSquared(qn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,i=t.position.array,n=t.normal.array,s=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Wt(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],c=[];for(let T=0;T<a;T++)l[T]=new L,c[T]=new L;let d=new L,u=new L,h=new L,f=new oe,p=new oe,m=new oe,g=new L,v=new L;function y(T,A,M){d.fromArray(i,T*3),u.fromArray(i,A*3),h.fromArray(i,M*3),f.fromArray(s,T*2),p.fromArray(s,A*2),m.fromArray(s,M*2),u.sub(d),h.sub(d),p.sub(f),m.sub(f);let P=1/(p.x*m.y-m.x*p.y);!isFinite(P)||(g.copy(u).multiplyScalar(m.y).addScaledVector(h,-p.y).multiplyScalar(P),v.copy(h).multiplyScalar(p.x).addScaledVector(u,-m.x).multiplyScalar(P),l[T].add(g),l[A].add(g),l[M].add(g),c[T].add(v),c[A].add(v),c[M].add(v))}let b=this.groups;b.length===0&&(b=[{start:0,count:r.length}]);for(let T=0,A=b.length;T<A;++T){let M=b[T],P=M.start,I=M.count;for(let R=P,N=P+I;R<N;R+=3)y(r[R+0],r[R+1],r[R+2])}let x=new L,S=new L,w=new L,E=new L;function C(T){w.fromArray(n,T*3),E.copy(w);let A=l[T];x.copy(A),x.sub(w.multiplyScalar(w.dot(A))).normalize(),S.crossVectors(E,A);let M=S.dot(c[T])<0?-1:1;o[T*4]=x.x,o[T*4+1]=x.y,o[T*4+2]=x.z,o[T*4+3]=M}for(let T=0,A=b.length;T<A;++T){let M=b[T],P=M.start,I=M.count;for(let R=P,N=P+I;R<N;R+=3)C(r[R+0]),C(r[R+1]),C(r[R+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Wt(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let u=0,h=r.count;u<h;u++)r.setXYZ(u,0,0,0);let i=new L,n=new L,s=new L,a=new L,o=new L,l=new L,c=new L,d=new L;if(e)for(let u=0,h=e.count;u<h;u+=3){let f=e.getX(u+0),p=e.getX(u+1),m=e.getX(u+2);i.fromBufferAttribute(t,f),n.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),c.subVectors(s,n),d.subVectors(i,n),c.cross(d),a.fromBufferAttribute(r,f),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,m),a.add(c),o.add(c),l.add(c),r.setXYZ(f,a.x,a.y,a.z),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z)}else for(let u=0,h=t.count;u<h;u+=3)i.fromBufferAttribute(t,u+0),n.fromBufferAttribute(t,u+1),s.fromBufferAttribute(t,u+2),c.subVectors(s,n),d.subVectors(i,n),c.cross(d),r.setXYZ(u+0,c.x,c.y,c.z),r.setXYZ(u+1,c.x,c.y,c.z),r.setXYZ(u+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)qn.fromBufferAttribute(e,t),qn.normalize(),e.setXYZ(t,qn.x,qn.y,qn.z)}toNonIndexed(){function e(a,o){let l=a.array,c=a.itemSize,d=a.normalized,u=new l.constructor(o.length*c),h=0,f=0;for(let p=0,m=o.length;p<m;p++){a.isInterleavedBufferAttribute?h=o[p]*a.data.stride+a.offset:h=o[p]*c;for(let g=0;g<c;g++)u[f++]=l[h++]}return new Wt(u,c,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new Dt,r=this.index.array,i=this.attributes;for(let a in i){let o=i[a],l=e(o,r);t.setAttribute(a,l)}let n=this.morphAttributes;for(let a in n){let o=[],l=n[a];for(let c=0,d=l.length;c<d;c++){let u=l[c],h=e(u,r);o.push(h)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let o in r){let l=r[o];e.data.attributes[o]=l.toJSON(e.data)}let i={},n=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],c=[];for(let d=0,u=l.length;d<u;d++){let h=l[d];c.push(h.toJSON(e.data))}c.length>0&&(i[o]=c,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let i=e.attributes;for(let l in i){let c=i[l];this.setAttribute(l,c.clone(t))}let n=e.morphAttributes;for(let l in n){let c=[],d=n[l];for(let u=0,h=d.length;u<h;u++)c.push(d[u].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let d=s[l];this.addGroup(d.start,d.count,d.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},TW=new Ke,Fm=new O0,fR=new Za,Cy=new L,Ay=new L,Ty=new L,pR=new L,R_=new L,D_=new oe,O_=new oe,L_=new oe,mR=new L,N_=new L,An=class extends Yr{constructor(e=new Dt,t=new em){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(n&&a){R_.set(0,0,0);for(let o=0,l=n.length;o<l;o++){let c=a[o],d=n[o];c!==0&&(pR.fromBufferAttribute(d,e),s?R_.addScaledVector(pR,c):R_.addScaledVector(pR.sub(t),c))}t.add(R_)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),fR.copy(r.boundingSphere),fR.applyMatrix4(n),e.ray.intersectsSphere(fR)===!1)||(TW.copy(n).invert(),Fm.copy(e.ray).applyMatrix4(TW),r.boundingBox!==null&&Fm.intersectsBox(r.boundingBox)===!1))return;let s,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,d=r.groups,u=r.drawRange;if(a!==null)if(Array.isArray(i))for(let h=0,f=d.length;h<f;h++){let p=d[h],m=i[p.materialIndex],g=Math.max(p.start,u.start),v=Math.min(a.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,b=v;y<b;y+=3){let x=a.getX(y),S=a.getX(y+1),w=a.getX(y+2);s=k_(this,m,e,Fm,l,c,x,S,w),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,t.push(s))}}else{let h=Math.max(0,u.start),f=Math.min(a.count,u.start+u.count);for(let p=h,m=f;p<m;p+=3){let g=a.getX(p),v=a.getX(p+1),y=a.getX(p+2);s=k_(this,i,e,Fm,l,c,g,v,y),s&&(s.faceIndex=Math.floor(p/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(i))for(let h=0,f=d.length;h<f;h++){let p=d[h],m=i[p.materialIndex],g=Math.max(p.start,u.start),v=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,b=v;y<b;y+=3){let x=y,S=y+1,w=y+2;s=k_(this,m,e,Fm,l,c,x,S,w),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,t.push(s))}}else{let h=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=h,m=f;p<m;p+=3){let g=p,v=p+1,y=p+2;s=k_(this,i,e,Fm,l,c,g,v,y),s&&(s.faceIndex=Math.floor(p/3),t.push(s))}}}};function _Ve(e,t,r,i,n,s,a,o){let l;if(t.side===is?l=i.intersectTriangle(a,s,n,!0,o):l=i.intersectTriangle(n,s,a,t.side===Yl,o),l===null)return null;N_.copy(o),N_.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(N_);return c<r.near||c>r.far?null:{distance:c,point:N_.clone(),object:e}}function k_(e,t,r,i,n,s,a,o,l){e.getVertexPosition(a,Cy),e.getVertexPosition(o,Ay),e.getVertexPosition(l,Ty);let c=_Ve(e,t,r,i,Cy,Ay,Ty,mR);if(c){n&&(D_.fromBufferAttribute(n,a),O_.fromBufferAttribute(n,o),L_.fromBufferAttribute(n,l),c.uv=xs.getUV(mR,Cy,Ay,Ty,D_,O_,L_,new oe)),s&&(D_.fromBufferAttribute(s,a),O_.fromBufferAttribute(s,o),L_.fromBufferAttribute(s,l),c.uv2=xs.getUV(mR,Cy,Ay,Ty,D_,O_,L_,new oe));let d={a,b:o,c:l,normal:new L,materialIndex:0};xs.getNormal(Cy,Ay,Ty,d.normal),c.face=d}return c}var Ql=class extends Dt{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],c=[],d=[],u=0,h=0;f("z","y","x",-1,-1,r,t,e,s,n,0),f("z","y","x",1,-1,r,t,-e,s,n,1),f("x","z","y",1,1,e,r,t,i,s,2),f("x","z","y",1,-1,e,r,-t,i,s,3),f("x","y","z",1,-1,e,t,r,i,n,4),f("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new vt(l,3)),this.setAttribute("normal",new vt(c,3)),this.setAttribute("uv",new vt(d,2));function f(p,m,g,v,y,b,x,S,w,E,C){let T=b/w,A=x/E,M=b/2,P=x/2,I=S/2,R=w+1,N=E+1,k=0,O=0,D=new L;for(let B=0;B<N;B++){let z=B*A-P;for(let F=0;F<R;F++){let V=F*T-M;D[p]=V*v,D[m]=z*y,D[g]=I,l.push(D.x,D.y,D.z),D[p]=0,D[m]=0,D[g]=S>0?1:-1,c.push(D.x,D.y,D.z),d.push(F/w),d.push(1-B/E),k+=1}}for(let B=0;B<E;B++)for(let z=0;z<w;z++){let F=u+z+R*B,V=u+z+R*(B+1),Y=u+(z+1)+R*(B+1),W=u+(z+1)+R*B;o.push(F,V,W),o.push(V,Y,W),O+=6}a.addGroup(h,O,C),h+=O,u+=k}}static fromJSON(e){return new Ql(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function qv(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function da(e){let t={};for(let r=0;r<e.length;r++){let i=qv(e[r]);for(let n in i)t[n]=i[n]}return t}function SVe(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function One(e){return e.getRenderTarget()===null&&e.outputEncoding===nr?yc:gA}var L0={clone:qv,merge:da},EVe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,CVe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Gr=class extends gw{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=EVe,this.fragmentShader=CVe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=qv(e.uniforms),this.uniformsGroups=SVe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},tm=class extends Yr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ke,this.projectionMatrix=new Ke,this.projectionMatrixInverse=new Ke}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Gs=class extends tm{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=rx*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Y1*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return rx*2*Math.atan(Math.tan(Y1*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Y1*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*i/o,t-=s.offsetY*r/l,i*=s.width/o,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},jm=-90,Vm=1,AVe=class extends Yr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new Gs(jm,Vm,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new Gs(jm,Vm,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new Gs(jm,Vm,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new Gs(jm,Vm,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new Gs(jm,Vm,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new Gs(jm,Vm,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,s,a,o,l]=this.children,c=e.getRenderTarget(),d=e.toneMapping,u=e.xr.enabled;e.toneMapping=Hc,e.xr.enabled=!1;let h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=h,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=d,e.xr.enabled=u,r.texture.needsPMREMUpdate=!0}},S4=class extends Li{constructor(e,t,r,i,n,s,a,o,l,c){e=e!==void 0?e:[],t=t!==void 0?t:Lp,super(e,t,r,i,n,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},TVe=class extends Wr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new S4(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:dr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Ql(5,5,5),n=new Gr({name:"CubemapFromEquirect",uniforms:qv(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:is,blending:Tn});n.uniforms.tEquirect.value=t;let s=new An(i,n),a=t.minFilter;return t.minFilter===Gv&&(t.minFilter=dr),new AVe(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(n)}},gR=new L,MVe=new L,PVe=new on,co=class{constructor(e=new L(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=gR.subVectors(r,t).cross(MVe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(gR),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||PVe.getNormalMatrix(e),i=this.coplanarPoint(gR).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Um=new Za,z_=new L,E4=class{constructor(e=new co,t=new co,r=new co,i=new co,n=new co,s=new co){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],c=r[6],d=r[7],u=r[8],h=r[9],f=r[10],p=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(a-i,d-o,p-u,y-m).normalize(),t[1].setComponents(a+i,d+o,p+u,y+m).normalize(),t[2].setComponents(a+n,d+l,p+h,y+g).normalize(),t[3].setComponents(a-n,d-l,p-h,y-g).normalize(),t[4].setComponents(a-s,d-c,p-f,y-v).normalize(),t[5].setComponents(a+s,d+c,p+f,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Um.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Um)}intersectsSprite(e){return Um.center.set(0,0,0),Um.radius=.7071067811865476,Um.applyMatrix4(e.matrixWorld),this.intersectsSphere(Um)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(z_.x=i.normal.x>0?e.max.x:e.min.x,z_.y=i.normal.y>0?e.max.y:e.min.y,z_.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(z_)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function Lne(){let e=null,t=!1,r=null,i=null;function n(s,a){r(s,a),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){r=s},setContext:function(s){e=s}}}function IVe(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,d){let u=c.array,h=c.usage,f=e.createBuffer();e.bindBuffer(d,f),e.bufferData(d,u,h),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,d,u){let h=d.array,f=d.updateRange;e.bindBuffer(u,c),f.count===-1?e.bufferSubData(u,0,h):(r?e.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):e.bufferSubData(u,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),d.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let d=i.get(c);d&&(e.deleteBuffer(d.buffer),i.delete(c))}function l(c,d){if(c.isGLBufferAttribute){let h=i.get(c);(!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u===void 0?i.set(c,n(c,d)):u.version<c.version&&(s(u.buffer,c,d),u.version=c.version)}return{get:a,remove:o,update:l}}var rm=class extends Dt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,a=Math.floor(r),o=Math.floor(i),l=a+1,c=o+1,d=e/a,u=t/o,h=[],f=[],p=[],m=[];for(let g=0;g<c;g++){let v=g*u-s;for(let y=0;y<l;y++){let b=y*d-n;f.push(b,-v,0),p.push(0,0,1),m.push(y/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let v=0;v<a;v++){let y=v+l*g,b=v+l*(g+1),x=v+1+l*(g+1),S=v+1+l*g;h.push(y,b,S),h.push(b,x,S)}this.setIndex(h),this.setAttribute("position",new vt(f,3)),this.setAttribute("normal",new vt(p,3)),this.setAttribute("uv",new vt(m,2))}static fromJSON(e){return new rm(e.width,e.height,e.widthSegments,e.heightSegments)}},RVe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,DVe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,OVe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,LVe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,NVe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,kVe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,zVe="vec3 transformed = vec3( position );",BVe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,FVe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,jVe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,VVe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,UVe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,$Ve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,HVe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,WVe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,GVe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,qVe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,XVe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,YVe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,KVe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,QVe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,ZVe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,JVe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,e5e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,t5e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,r5e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,i5e="gl_FragColor = linearToOutputTexel( gl_FragColor );",n5e=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,s5e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,a5e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,o5e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,l5e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,c5e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,u5e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,d5e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,h5e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,f5e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,p5e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,m5e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,g5e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,v5e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,y5e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,b5e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,x5e=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,w5e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,_5e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,S5e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,E5e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,C5e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,A5e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,T5e=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,M5e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,P5e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,I5e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,R5e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,D5e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,O5e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,L5e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,N5e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,k5e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,z5e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,B5e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,F5e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,j5e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,V5e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,U5e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,$5e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,H5e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,W5e=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,G5e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,q5e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,X5e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Y5e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,K5e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Q5e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Z5e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,J5e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,eUe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,tUe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,rUe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,iUe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,nUe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,sUe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,aUe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,oUe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,lUe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,cUe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,uUe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,dUe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,hUe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,fUe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,pUe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,mUe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,gUe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,vUe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,yUe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,bUe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,xUe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,wUe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,_Ue=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,SUe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,EUe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,CUe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,AUe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,TUe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,MUe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,PUe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,IUe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,RUe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,DUe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,OUe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,LUe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,NUe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,kUe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,zUe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,BUe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,FUe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,jUe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,VUe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,UUe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$Ue=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,HUe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WUe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,GUe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qUe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,XUe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,YUe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,KUe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,QUe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ZUe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JUe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,e$e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,t$e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,r$e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,i$e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,n$e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,s$e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,a$e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,o$e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,l$e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,cr={alphamap_fragment:RVe,alphamap_pars_fragment:DVe,alphatest_fragment:OVe,alphatest_pars_fragment:LVe,aomap_fragment:NVe,aomap_pars_fragment:kVe,begin_vertex:zVe,beginnormal_vertex:BVe,bsdfs:FVe,iridescence_fragment:jVe,bumpmap_pars_fragment:VVe,clipping_planes_fragment:UVe,clipping_planes_pars_fragment:$Ve,clipping_planes_pars_vertex:HVe,clipping_planes_vertex:WVe,color_fragment:GVe,color_pars_fragment:qVe,color_pars_vertex:XVe,color_vertex:YVe,common:KVe,cube_uv_reflection_fragment:QVe,defaultnormal_vertex:ZVe,displacementmap_pars_vertex:JVe,displacementmap_vertex:e5e,emissivemap_fragment:t5e,emissivemap_pars_fragment:r5e,encodings_fragment:i5e,encodings_pars_fragment:n5e,envmap_fragment:s5e,envmap_common_pars_fragment:a5e,envmap_pars_fragment:o5e,envmap_pars_vertex:l5e,envmap_physical_pars_fragment:x5e,envmap_vertex:c5e,fog_vertex:u5e,fog_pars_vertex:d5e,fog_fragment:h5e,fog_pars_fragment:f5e,gradientmap_pars_fragment:p5e,lightmap_fragment:m5e,lightmap_pars_fragment:g5e,lights_lambert_fragment:v5e,lights_lambert_pars_fragment:y5e,lights_pars_begin:b5e,lights_toon_fragment:w5e,lights_toon_pars_fragment:_5e,lights_phong_fragment:S5e,lights_phong_pars_fragment:E5e,lights_physical_fragment:C5e,lights_physical_pars_fragment:A5e,lights_fragment_begin:T5e,lights_fragment_maps:M5e,lights_fragment_end:P5e,logdepthbuf_fragment:I5e,logdepthbuf_pars_fragment:R5e,logdepthbuf_pars_vertex:D5e,logdepthbuf_vertex:O5e,map_fragment:L5e,map_pars_fragment:N5e,map_particle_fragment:k5e,map_particle_pars_fragment:z5e,metalnessmap_fragment:B5e,metalnessmap_pars_fragment:F5e,morphcolor_vertex:j5e,morphnormal_vertex:V5e,morphtarget_pars_vertex:U5e,morphtarget_vertex:$5e,normal_fragment_begin:H5e,normal_fragment_maps:W5e,normal_pars_fragment:G5e,normal_pars_vertex:q5e,normal_vertex:X5e,normalmap_pars_fragment:Y5e,clearcoat_normal_fragment_begin:K5e,clearcoat_normal_fragment_maps:Q5e,clearcoat_pars_fragment:Z5e,iridescence_pars_fragment:J5e,output_fragment:eUe,packing:tUe,premultiplied_alpha_fragment:rUe,project_vertex:iUe,dithering_fragment:nUe,dithering_pars_fragment:sUe,roughnessmap_fragment:aUe,roughnessmap_pars_fragment:oUe,shadowmap_pars_fragment:lUe,shadowmap_pars_vertex:cUe,shadowmap_vertex:uUe,shadowmask_pars_fragment:dUe,skinbase_vertex:hUe,skinning_pars_vertex:fUe,skinning_vertex:pUe,skinnormal_vertex:mUe,specularmap_fragment:gUe,specularmap_pars_fragment:vUe,tonemapping_fragment:yUe,tonemapping_pars_fragment:bUe,transmission_fragment:xUe,transmission_pars_fragment:wUe,uv_pars_fragment:_Ue,uv_pars_vertex:SUe,uv_vertex:EUe,uv2_pars_fragment:CUe,uv2_pars_vertex:AUe,uv2_vertex:TUe,worldpos_vertex:MUe,background_vert:PUe,background_frag:IUe,backgroundCube_vert:RUe,backgroundCube_frag:DUe,cube_vert:OUe,cube_frag:LUe,depth_vert:NUe,depth_frag:kUe,distanceRGBA_vert:zUe,distanceRGBA_frag:BUe,equirect_vert:FUe,equirect_frag:jUe,linedashed_vert:VUe,linedashed_frag:UUe,meshbasic_vert:$Ue,meshbasic_frag:HUe,meshlambert_vert:WUe,meshlambert_frag:GUe,meshmatcap_vert:qUe,meshmatcap_frag:XUe,meshnormal_vert:YUe,meshnormal_frag:KUe,meshphong_vert:QUe,meshphong_frag:ZUe,meshphysical_vert:JUe,meshphysical_frag:e$e,meshtoon_vert:t$e,meshtoon_frag:r$e,points_vert:i$e,points_frag:n$e,shadow_vert:s$e,shadow_frag:a$e,sprite_vert:o$e,sprite_frag:l$e},ct={common:{diffuse:{value:new zt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new on},uv2Transform:{value:new on},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new zt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new zt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new on}},sprite:{diffuse:{value:new zt(16777215)},opacity:{value:1},center:{value:new oe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new on}}},_c={basic:{uniforms:da([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.fog]),vertexShader:cr.meshbasic_vert,fragmentShader:cr.meshbasic_frag},lambert:{uniforms:da([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,ct.lights,{emissive:{value:new zt(0)}}]),vertexShader:cr.meshlambert_vert,fragmentShader:cr.meshlambert_frag},phong:{uniforms:da([ct.common,ct.specularmap,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,ct.lights,{emissive:{value:new zt(0)},specular:{value:new zt(1118481)},shininess:{value:30}}]),vertexShader:cr.meshphong_vert,fragmentShader:cr.meshphong_frag},standard:{uniforms:da([ct.common,ct.envmap,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.roughnessmap,ct.metalnessmap,ct.fog,ct.lights,{emissive:{value:new zt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:cr.meshphysical_vert,fragmentShader:cr.meshphysical_frag},toon:{uniforms:da([ct.common,ct.aomap,ct.lightmap,ct.emissivemap,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.gradientmap,ct.fog,ct.lights,{emissive:{value:new zt(0)}}]),vertexShader:cr.meshtoon_vert,fragmentShader:cr.meshtoon_frag},matcap:{uniforms:da([ct.common,ct.bumpmap,ct.normalmap,ct.displacementmap,ct.fog,{matcap:{value:null}}]),vertexShader:cr.meshmatcap_vert,fragmentShader:cr.meshmatcap_frag},points:{uniforms:da([ct.points,ct.fog]),vertexShader:cr.points_vert,fragmentShader:cr.points_frag},dashed:{uniforms:da([ct.common,ct.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:cr.linedashed_vert,fragmentShader:cr.linedashed_frag},depth:{uniforms:da([ct.common,ct.displacementmap]),vertexShader:cr.depth_vert,fragmentShader:cr.depth_frag},normal:{uniforms:da([ct.common,ct.bumpmap,ct.normalmap,ct.displacementmap,{opacity:{value:1}}]),vertexShader:cr.meshnormal_vert,fragmentShader:cr.meshnormal_frag},sprite:{uniforms:da([ct.sprite,ct.fog]),vertexShader:cr.sprite_vert,fragmentShader:cr.sprite_frag},background:{uniforms:{uvTransform:{value:new on},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:cr.background_vert,fragmentShader:cr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:cr.backgroundCube_vert,fragmentShader:cr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:cr.cube_vert,fragmentShader:cr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:cr.equirect_vert,fragmentShader:cr.equirect_frag},distanceRGBA:{uniforms:da([ct.common,ct.displacementmap,{referencePosition:{value:new L},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:cr.distanceRGBA_vert,fragmentShader:cr.distanceRGBA_frag},shadow:{uniforms:da([ct.lights,ct.fog,{color:{value:new zt(0)},opacity:{value:1}}]),vertexShader:cr.shadow_vert,fragmentShader:cr.shadow_frag}};_c.physical={uniforms:da([_c.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new oe(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new zt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new oe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new zt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new zt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:cr.meshphysical_vert,fragmentShader:cr.meshphysical_frag};var B_={r:0,b:0,g:0};function c$e(e,t,r,i,n,s,a){let o=new zt(0),l=s===!0?0:1,c,d,u=null,h=0,f=null;function p(g,v){let y=!1,b=v.isScene===!0?v.background:null;b&&b.isTexture&&(b=(v.backgroundBlurriness>0?r:t).get(b));let x=e.xr,S=x.getSession&&x.getSession();S&&S.environmentBlendMode==="additive"&&(b=null),b===null?m(o,l):b&&b.isColor&&(m(b,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),b&&(b.isCubeTexture||b.mapping===mw)?(d===void 0&&(d=new An(new Ql(1,1,1),new Gr({name:"BackgroundCubeMaterial",uniforms:qv(_c.backgroundCube.uniforms),vertexShader:_c.backgroundCube.vertexShader,fragmentShader:_c.backgroundCube.fragmentShader,side:is,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(w,E,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(d)),d.material.uniforms.envMap.value=b,d.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,d.material.toneMapped=b.encoding!==nr,(u!==b||h!==b.version||f!==e.toneMapping)&&(d.material.needsUpdate=!0,u=b,h=b.version,f=e.toneMapping),d.layers.enableAll(),g.unshift(d,d.geometry,d.material,0,0,null)):b&&b.isTexture&&(c===void 0&&(c=new An(new rm(2,2),new Gr({name:"BackgroundMaterial",uniforms:qv(_c.background.uniforms),vertexShader:_c.background.vertexShader,fragmentShader:_c.background.fragmentShader,side:Yl,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=b.encoding!==nr,b.matrixAutoUpdate===!0&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(u!==b||h!==b.version||f!==e.toneMapping)&&(c.material.needsUpdate=!0,u=b,h=b.version,f=e.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function m(g,v){g.getRGB(B_,One(e)),i.buffers.color.setClear(B_.r,B_.g,B_.b,v,a)}return{getClearColor:function(){return o},setClearColor:function(g,v=1){o.set(g),l=v,m(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(o,l)},render:p}}function u$e(e,t,r,i){let n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},l=g(null),c=l,d=!1;function u(R,N,k,O,D){let B=!1;if(a){let z=m(O,k,N);c!==z&&(c=z,f(c.object)),B=v(R,O,k,D),B&&y(R,O,k,D)}else{let z=N.wireframe===!0;(c.geometry!==O.id||c.program!==k.id||c.wireframe!==z)&&(c.geometry=O.id,c.program=k.id,c.wireframe=z,B=!0)}D!==null&&r.update(D,34963),(B||d)&&(d=!1,C(R,N,k,O),D!==null&&e.bindBuffer(34963,r.get(D).buffer))}function h(){return i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function f(R){return i.isWebGL2?e.bindVertexArray(R):s.bindVertexArrayOES(R)}function p(R){return i.isWebGL2?e.deleteVertexArray(R):s.deleteVertexArrayOES(R)}function m(R,N,k){let O=k.wireframe===!0,D=o[R.id];D===void 0&&(D={},o[R.id]=D);let B=D[N.id];B===void 0&&(B={},D[N.id]=B);let z=B[O];return z===void 0&&(z=g(h()),B[O]=z),z}function g(R){let N=[],k=[],O=[];for(let D=0;D<n;D++)N[D]=0,k[D]=0,O[D]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:N,enabledAttributes:k,attributeDivisors:O,object:R,attributes:{},index:null}}function v(R,N,k,O){let D=c.attributes,B=N.attributes,z=0,F=k.getAttributes();for(let V in F)if(F[V].location>=0){let Y=D[V],W=B[V];if(W===void 0&&(V==="instanceMatrix"&&R.instanceMatrix&&(W=R.instanceMatrix),V==="instanceColor"&&R.instanceColor&&(W=R.instanceColor)),Y===void 0||Y.attribute!==W||W&&Y.data!==W.data)return!0;z++}return c.attributesNum!==z||c.index!==O}function y(R,N,k,O){let D={},B=N.attributes,z=0,F=k.getAttributes();for(let V in F)if(F[V].location>=0){let Y=B[V];Y===void 0&&(V==="instanceMatrix"&&R.instanceMatrix&&(Y=R.instanceMatrix),V==="instanceColor"&&R.instanceColor&&(Y=R.instanceColor));let W={};W.attribute=Y,Y&&Y.data&&(W.data=Y.data),D[V]=W,z++}c.attributes=D,c.attributesNum=z,c.index=O}function b(){let R=c.newAttributes;for(let N=0,k=R.length;N<k;N++)R[N]=0}function x(R){S(R,0)}function S(R,N){let k=c.newAttributes,O=c.enabledAttributes,D=c.attributeDivisors;k[R]=1,O[R]===0&&(e.enableVertexAttribArray(R),O[R]=1),D[R]!==N&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,N),D[R]=N)}function w(){let R=c.newAttributes,N=c.enabledAttributes;for(let k=0,O=N.length;k<O;k++)N[k]!==R[k]&&(e.disableVertexAttribArray(k),N[k]=0)}function E(R,N,k,O,D,B){i.isWebGL2===!0&&(k===5124||k===5125)?e.vertexAttribIPointer(R,N,k,D,B):e.vertexAttribPointer(R,N,k,O,D,B)}function C(R,N,k,O){if(i.isWebGL2===!1&&(R.isInstancedMesh||O.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;b();let D=O.attributes,B=k.getAttributes(),z=N.defaultAttributeValues;for(let F in B){let V=B[F];if(V.location>=0){let Y=D[F];if(Y===void 0&&(F==="instanceMatrix"&&R.instanceMatrix&&(Y=R.instanceMatrix),F==="instanceColor"&&R.instanceColor&&(Y=R.instanceColor)),Y!==void 0){let W=Y.normalized,X=Y.itemSize,H=r.get(Y);if(H===void 0)continue;let ie=H.buffer,Q=H.type,Z=H.bytesPerElement;if(Y.isInterleavedBufferAttribute){let ee=Y.data,re=ee.stride,ne=Y.offset;if(ee.isInstancedInterleavedBuffer){for(let se=0;se<V.locationSize;se++)S(V.location+se,ee.meshPerAttribute);R.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let se=0;se<V.locationSize;se++)x(V.location+se);e.bindBuffer(34962,ie);for(let se=0;se<V.locationSize;se++)E(V.location+se,X/V.locationSize,Q,W,re*Z,(ne+X/V.locationSize*se)*Z)}else{if(Y.isInstancedBufferAttribute){for(let ee=0;ee<V.locationSize;ee++)S(V.location+ee,Y.meshPerAttribute);R.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=Y.meshPerAttribute*Y.count)}else for(let ee=0;ee<V.locationSize;ee++)x(V.location+ee);e.bindBuffer(34962,ie);for(let ee=0;ee<V.locationSize;ee++)E(V.location+ee,X/V.locationSize,Q,W,X*Z,X/V.locationSize*ee*Z)}}else if(z!==void 0){let W=z[F];if(W!==void 0)switch(W.length){case 2:e.vertexAttrib2fv(V.location,W);break;case 3:e.vertexAttrib3fv(V.location,W);break;case 4:e.vertexAttrib4fv(V.location,W);break;default:e.vertexAttrib1fv(V.location,W)}}}}w()}function T(){P();for(let R in o){let N=o[R];for(let k in N){let O=N[k];for(let D in O)p(O[D].object),delete O[D];delete N[k]}delete o[R]}}function A(R){if(o[R.id]===void 0)return;let N=o[R.id];for(let k in N){let O=N[k];for(let D in O)p(O[D].object),delete O[D];delete N[k]}delete o[R.id]}function M(R){for(let N in o){let k=o[N];if(k[R.id]===void 0)continue;let O=k[R.id];for(let D in O)p(O[D].object),delete O[D];delete k[R.id]}}function P(){I(),d=!0,c!==l&&(c=l,f(c.object))}function I(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:P,resetDefaultState:I,dispose:T,releaseStatesOfGeometry:A,releaseStatesOfProgram:M,initAttributes:b,enableAttribute:x,disableUnusedAttributes:w}}function d$e(e,t,r,i){let n=i.isWebGL2,s;function a(c){s=c}function o(c,d){e.drawArrays(s,c,d),r.update(d,s,1)}function l(c,d,u){if(u===0)return;let h,f;if(n)h=e,f="drawArraysInstanced";else if(h=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[f](s,c,d,u),r.update(d,s,u)}this.setMode=a,this.render=o,this.renderInstances=l}function h$e(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let E=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(E){if(E==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return E==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=r.precision!==void 0?r.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let c=a||t.has("WEBGL_draw_buffers"),d=r.logarithmicDepthBuffer===!0,u=e.getParameter(34930),h=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),m=e.getParameter(34921),g=e.getParameter(36347),v=e.getParameter(36348),y=e.getParameter(36349),b=h>0,x=a||t.has("OES_texture_float"),S=b&&x,w=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:d,maxTextures:u,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:b,floatFragmentTextures:x,floatVertexTextures:S,maxSamples:w}}function f$e(e){let t=this,r=null,i=0,n=!1,s=!1,a=new co,o=new on,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h){let f=u.length!==0||h||i!==0||n;return n=h,i=u.length,f},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,h){r=d(u,h,0)},this.setState=function(u,h,f){let p=u.clippingPlanes,m=u.clipIntersection,g=u.clipShadows,v=e.get(u);if(!n||p===null||p.length===0||s&&!g)s?d(null):c();else{let y=s?0:i,b=y*4,x=v.clippingState||null;l.value=x,x=d(p,h,b,f);for(let S=0;S!==b;++S)x[S]=r[S];v.clippingState=x,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function d(u,h,f,p){let m=u!==null?u.length:0,g=null;if(m!==0){if(g=l.value,p!==!0||g===null){let v=f+m*4,y=h.matrixWorldInverse;o.getNormalMatrix(y),(g===null||g.length<v)&&(g=new Float32Array(v));for(let b=0,x=f;b!==m;++b,x+=4)a.copy(u[b]).applyMatrix4(y,o),a.normal.toArray(g,x),g[x+3]=a.constant}l.value=g,l.needsUpdate=!0}return t.numPlanes=m,t.numIntersection=0,g}}function p$e(e){let t=new WeakMap;function r(a,o){return o===AL?a.mapping=Lp:o===TL&&(a.mapping=Np),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===AL||o===TL)if(t.has(a)){let l=t.get(a).texture;return r(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let c=new TVe(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",n),r(c.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}var C4=class extends tm{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,a=i+t,o=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=c*this.view.offsetY,o=a-c*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Ug=4,MW=[.125,.215,.35,.446,.526,.582],Mf=20,vR=new C4,PW=new zt,yR=null,_f=(1+Math.sqrt(5))/2,$m=1/_f,IW=[new L(1,1,1),new L(-1,1,1),new L(1,1,-1),new L(-1,1,-1),new L(0,_f,$m),new L(0,_f,-$m),new L($m,0,_f),new L(-$m,0,_f),new L(_f,$m,0),new L(-_f,$m,0)],RW=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){yR=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=LW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=OW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(yR),e.scissorTest=!1,F_(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Lp||e.mapping===Np?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),yR=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:dr,minFilter:dr,generateMipmaps:!1,type:kp,format:ts,encoding:Kl,depthBuffer:!1},i=DW(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=DW(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=m$e(n)),this._blurMaterial=g$e(n,e,t)}return i}_compileMaterial(e){let t=new An(this._lodPlanes[0],e);this._renderer.compile(t,vR)}_sceneToCubeUV(e,t,r,i){let n=new Gs(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(PW),o.toneMapping=Hc,o.autoClear=!1;let d=new em({name:"PMREM.Background",side:is,depthWrite:!1,depthTest:!1}),u=new An(new Ql,d),h=!1,f=e.background;f?f.isColor&&(d.color.copy(f),e.background=null,h=!0):(d.color.copy(PW),h=!0);for(let p=0;p<6;p++){let m=p%3;m===0?(n.up.set(0,s[p],0),n.lookAt(a[p],0,0)):m===1?(n.up.set(0,0,s[p]),n.lookAt(0,a[p],0)):(n.up.set(0,s[p],0),n.lookAt(0,0,a[p]));let g=this._cubeSize;F_(i,m*g,p>2?g:0,g,g),o.setRenderTarget(i),h&&o.render(u,n),o.render(e,n)}u.geometry.dispose(),u.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=f}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===Lp||e.mapping===Np;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=LW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=OW());let n=i?this._cubemapMaterial:this._equirectMaterial,s=new An(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;F_(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,vR)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=IW[(i-1)%IW.length];this._blur(e,i-1,i,n,s)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,d=new An(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[r]-1,f=isFinite(n)?Math.PI/(2*h):2*Math.PI/(2*Mf-1),p=n/f,m=isFinite(n)?1+Math.floor(c*p):Mf;m>Mf&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Mf}`);let g=[],v=0;for(let w=0;w<Mf;++w){let E=w/p,C=Math.exp(-E*E/2);g.push(C),w===0?v+=C:w<m&&(v+=2*C)}for(let w=0;w<g.length;w++)g[w]=g[w]/v;u.envMap.value=e.texture,u.samples.value=m,u.weights.value=g,u.latitudinal.value=s==="latitudinal",a&&(u.poleAxis.value=a);let{_lodMax:y}=this;u.dTheta.value=f,u.mipInt.value=y-r;let b=this._sizeLods[i],x=3*b*(i>y-Ug?i-y+Ug:0),S=4*(this._cubeSize-b);F_(t,x,S,3*b,2*b),o.setRenderTarget(t),o.render(d,vR)}};function m$e(e){let t=[],r=[],i=[],n=e,s=e-Ug+1+MW.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);r.push(o);let l=1/o;a>e-Ug?l=MW[a-e+Ug-1]:a===0&&(l=0),i.push(l);let c=1/(o-2),d=-c,u=1+c,h=[d,d,u,d,u,u,d,d,u,u,d,u],f=6,p=6,m=3,g=2,v=1,y=new Float32Array(m*p*f),b=new Float32Array(g*p*f),x=new Float32Array(v*p*f);for(let w=0;w<f;w++){let E=w%3*2/3-1,C=w>2?0:-1,T=[E,C,0,E+2/3,C,0,E+2/3,C+1,0,E,C,0,E+2/3,C+1,0,E,C+1,0];y.set(T,m*p*w),b.set(h,g*p*w);let A=[w,w,w,w,w,w];x.set(A,v*p*w)}let S=new Dt;S.setAttribute("position",new Wt(y,m)),S.setAttribute("uv",new Wt(b,g)),S.setAttribute("faceIndex",new Wt(x,v)),t.push(S),n>Ug&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function DW(e,t,r){let i=new Wr(e,t,r);return i.texture.mapping=mw,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function F_(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function g$e(e,t,r){let i=new Float32Array(Mf),n=new L(0,1,0);return new Gr({name:"SphericalGaussianBlur",defines:{n:Mf,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:A4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Tn,depthTest:!1,depthWrite:!1})}function OW(){return new Gr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:A4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Tn,depthTest:!1,depthWrite:!1})}function LW(){return new Gr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:A4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Tn,depthTest:!1,depthWrite:!1})}function A4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function v$e(e){let t=new WeakMap,r=null;function i(o){if(o&&o.isTexture){let l=o.mapping,c=l===AL||l===TL,d=l===Lp||l===Np;if(c||d)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let u=t.get(o);return r===null&&(r=new RW(e)),u=c?r.fromEquirectangular(o,u):r.fromCubemap(o,u),t.set(o,u),u.texture}else{if(t.has(o))return t.get(o).texture;{let u=o.image;if(c&&u&&u.height>0||d&&u&&n(u)){r===null&&(r=new RW(e));let h=c?r.fromEquirectangular(o):r.fromCubemap(o);return t.set(o,h),o.addEventListener("dispose",s),h.texture}else return null}}}return o}function n(o){let l=0,c=6;for(let d=0;d<c;d++)o[d]!==void 0&&l++;return l===c}function s(o){let l=o.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:a}}function y$e(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function b$e(e,t,r,i){let n={},s=new WeakMap;function a(u){let h=u.target;h.index!==null&&t.remove(h.index);for(let p in h.attributes)t.remove(h.attributes[p]);h.removeEventListener("dispose",a),delete n[h.id];let f=s.get(h);f&&(t.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,r.memory.geometries--}function o(u,h){return n[h.id]===!0||(h.addEventListener("dispose",a),n[h.id]=!0,r.memory.geometries++),h}function l(u){let h=u.attributes;for(let p in h)t.update(h[p],34962);let f=u.morphAttributes;for(let p in f){let m=f[p];for(let g=0,v=m.length;g<v;g++)t.update(m[g],34962)}}function c(u){let h=[],f=u.index,p=u.attributes.position,m=0;if(f!==null){let y=f.array;m=f.version;for(let b=0,x=y.length;b<x;b+=3){let S=y[b+0],w=y[b+1],E=y[b+2];h.push(S,w,w,E,E,S)}}else{let y=p.array;m=p.version;for(let b=0,x=y.length/3-1;b<x;b+=3){let S=b+0,w=b+1,E=b+2;h.push(S,w,w,E,E,S)}}let g=new(Tne(h)?av:Dne)(h,1);g.version=m;let v=s.get(u);v&&t.remove(v),s.set(u,g)}function d(u){let h=s.get(u);if(h){let f=u.index;f!==null&&h.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:o,update:l,getWireframeAttribute:d}}function x$e(e,t,r,i){let n=i.isWebGL2,s;function a(h){s=h}let o,l;function c(h){o=h.type,l=h.bytesPerElement}function d(h,f){e.drawElements(s,f,o,h*l),r.update(f,s,1)}function u(h,f,p){if(p===0)return;let m,g;if(n)m=e,g="drawElementsInstanced";else if(m=t.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,f,o,h*l,p),r.update(f,s,p)}this.setMode=a,this.setIndex=c,this.render=d,this.renderInstances=u}function w$e(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(r.calls++,a){case 4:r.triangles+=o*(s/3);break;case 1:r.lines+=o*(s/2);break;case 3:r.lines+=o*(s-1);break;case 2:r.lines+=o*s;break;case 0:r.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function _$e(e,t){return e[0]-t[0]}function S$e(e,t){return Math.abs(t[1])-Math.abs(e[1])}function E$e(e,t,r){let i={},n=new Float32Array(8),s=new WeakMap,a=new Yt,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,d,u,h){let f=c.morphTargetInfluences;if(t.isWebGL2===!0){let p=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,m=p!==void 0?p.length:0,g=s.get(d);if(g===void 0||g.count!==m){let b=function(){R.dispose(),s.delete(d),d.removeEventListener("dispose",b)};g!==void 0&&g.texture.dispose();let x=d.morphAttributes.position!==void 0,S=d.morphAttributes.normal!==void 0,w=d.morphAttributes.color!==void 0,E=d.morphAttributes.position||[],C=d.morphAttributes.normal||[],T=d.morphAttributes.color||[],A=0;x===!0&&(A=1),S===!0&&(A=2),w===!0&&(A=3);let M=d.attributes.position.count*A,P=1;M>t.maxTextureSize&&(P=Math.ceil(M/t.maxTextureSize),M=t.maxTextureSize);let I=new Float32Array(M*P*4*m),R=new Rne(I,M,P,m);R.type=Cn,R.needsUpdate=!0;let N=A*4;for(let k=0;k<m;k++){let O=E[k],D=C[k],B=T[k],z=M*P*4*k;for(let F=0;F<O.count;F++){let V=F*N;x===!0&&(a.fromBufferAttribute(O,F),I[z+V+0]=a.x,I[z+V+1]=a.y,I[z+V+2]=a.z,I[z+V+3]=0),S===!0&&(a.fromBufferAttribute(D,F),I[z+V+4]=a.x,I[z+V+5]=a.y,I[z+V+6]=a.z,I[z+V+7]=0),w===!0&&(a.fromBufferAttribute(B,F),I[z+V+8]=a.x,I[z+V+9]=a.y,I[z+V+10]=a.z,I[z+V+11]=B.itemSize===4?a.w:1)}}g={count:m,texture:R,size:new oe(M,P)},s.set(d,g),d.addEventListener("dispose",b)}let v=0;for(let b=0;b<f.length;b++)v+=f[b];let y=d.morphTargetsRelative?1:1-v;h.getUniforms().setValue(e,"morphTargetBaseInfluence",y),h.getUniforms().setValue(e,"morphTargetInfluences",f),h.getUniforms().setValue(e,"morphTargetsTexture",g.texture,r),h.getUniforms().setValue(e,"morphTargetsTextureSize",g.size)}else{let p=f===void 0?0:f.length,m=i[d.id];if(m===void 0||m.length!==p){m=[];for(let x=0;x<p;x++)m[x]=[x,0];i[d.id]=m}for(let x=0;x<p;x++){let S=m[x];S[0]=x,S[1]=f[x]}m.sort(S$e);for(let x=0;x<8;x++)x<p&&m[x][1]?(o[x][0]=m[x][0],o[x][1]=m[x][1]):(o[x][0]=Number.MAX_SAFE_INTEGER,o[x][1]=0);o.sort(_$e);let g=d.morphAttributes.position,v=d.morphAttributes.normal,y=0;for(let x=0;x<8;x++){let S=o[x],w=S[0],E=S[1];w!==Number.MAX_SAFE_INTEGER&&E?(g&&d.getAttribute("morphTarget"+x)!==g[w]&&d.setAttribute("morphTarget"+x,g[w]),v&&d.getAttribute("morphNormal"+x)!==v[w]&&d.setAttribute("morphNormal"+x,v[w]),n[x]=E,y+=E):(g&&d.hasAttribute("morphTarget"+x)===!0&&d.deleteAttribute("morphTarget"+x),v&&d.hasAttribute("morphNormal"+x)===!0&&d.deleteAttribute("morphNormal"+x),n[x]=0)}let b=d.morphTargetsRelative?1:1-y;h.getUniforms().setValue(e,"morphTargetBaseInfluence",b),h.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function C$e(e,t,r,i){let n=new WeakMap;function s(l){let c=i.render.frame,d=l.geometry,u=t.get(l,d);return n.get(u)!==c&&(t.update(u),n.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),u}function a(){n=new WeakMap}function o(l){let c=l.target;c.removeEventListener("dispose",o),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:s,dispose:a}}var Nne=new Li,kne=new Rne,zne=new dVe,Bne=new S4,NW=[],kW=[],zW=new Float32Array(16),BW=new Float32Array(9),FW=new Float32Array(4);function N0(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,s=NW[n];if(s===void 0&&(s=new Float32Array(n),NW[n]=s),t!==0){i.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=r,e[a].toArray(s,o)}return s}function Hn(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Wn(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function RM(e,t){let r=kW[t];r===void 0&&(r=new Int32Array(t),kW[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function A$e(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function T$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Hn(r,t))return;e.uniform2fv(this.addr,t),Wn(r,t)}}function M$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Hn(r,t))return;e.uniform3fv(this.addr,t),Wn(r,t)}}function P$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Hn(r,t))return;e.uniform4fv(this.addr,t),Wn(r,t)}}function I$e(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Hn(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Wn(r,t)}else{if(Hn(r,i))return;FW.set(i),e.uniformMatrix2fv(this.addr,!1,FW),Wn(r,i)}}function R$e(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Hn(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Wn(r,t)}else{if(Hn(r,i))return;BW.set(i),e.uniformMatrix3fv(this.addr,!1,BW),Wn(r,i)}}function D$e(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Hn(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Wn(r,t)}else{if(Hn(r,i))return;zW.set(i),e.uniformMatrix4fv(this.addr,!1,zW),Wn(r,i)}}function O$e(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function L$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Hn(r,t))return;e.uniform2iv(this.addr,t),Wn(r,t)}}function N$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Hn(r,t))return;e.uniform3iv(this.addr,t),Wn(r,t)}}function k$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Hn(r,t))return;e.uniform4iv(this.addr,t),Wn(r,t)}}function z$e(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function B$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Hn(r,t))return;e.uniform2uiv(this.addr,t),Wn(r,t)}}function F$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Hn(r,t))return;e.uniform3uiv(this.addr,t),Wn(r,t)}}function j$e(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Hn(r,t))return;e.uniform4uiv(this.addr,t),Wn(r,t)}}function V$e(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||Nne,n)}function U$e(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||zne,n)}function $$e(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||Bne,n)}function H$e(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||kne,n)}function W$e(e){switch(e){case 5126:return A$e;case 35664:return T$e;case 35665:return M$e;case 35666:return P$e;case 35674:return I$e;case 35675:return R$e;case 35676:return D$e;case 5124:case 35670:return O$e;case 35667:case 35671:return L$e;case 35668:case 35672:return N$e;case 35669:case 35673:return k$e;case 5125:return z$e;case 36294:return B$e;case 36295:return F$e;case 36296:return j$e;case 35678:case 36198:case 36298:case 36306:case 35682:return V$e;case 35679:case 36299:case 36307:return U$e;case 35680:case 36300:case 36308:case 36293:return $$e;case 36289:case 36303:case 36311:case 36292:return H$e}}function G$e(e,t){e.uniform1fv(this.addr,t)}function q$e(e,t){let r=N0(t,this.size,2);e.uniform2fv(this.addr,r)}function X$e(e,t){let r=N0(t,this.size,3);e.uniform3fv(this.addr,r)}function Y$e(e,t){let r=N0(t,this.size,4);e.uniform4fv(this.addr,r)}function K$e(e,t){let r=N0(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function Q$e(e,t){let r=N0(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Z$e(e,t){let r=N0(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function J$e(e,t){e.uniform1iv(this.addr,t)}function e6e(e,t){e.uniform2iv(this.addr,t)}function t6e(e,t){e.uniform3iv(this.addr,t)}function r6e(e,t){e.uniform4iv(this.addr,t)}function i6e(e,t){e.uniform1uiv(this.addr,t)}function n6e(e,t){e.uniform2uiv(this.addr,t)}function s6e(e,t){e.uniform3uiv(this.addr,t)}function a6e(e,t){e.uniform4uiv(this.addr,t)}function o6e(e,t,r){let i=this.cache,n=t.length,s=RM(r,n);Hn(i,s)||(e.uniform1iv(this.addr,s),Wn(i,s));for(let a=0;a!==n;++a)r.setTexture2D(t[a]||Nne,s[a])}function l6e(e,t,r){let i=this.cache,n=t.length,s=RM(r,n);Hn(i,s)||(e.uniform1iv(this.addr,s),Wn(i,s));for(let a=0;a!==n;++a)r.setTexture3D(t[a]||zne,s[a])}function c6e(e,t,r){let i=this.cache,n=t.length,s=RM(r,n);Hn(i,s)||(e.uniform1iv(this.addr,s),Wn(i,s));for(let a=0;a!==n;++a)r.setTextureCube(t[a]||Bne,s[a])}function u6e(e,t,r){let i=this.cache,n=t.length,s=RM(r,n);Hn(i,s)||(e.uniform1iv(this.addr,s),Wn(i,s));for(let a=0;a!==n;++a)r.setTexture2DArray(t[a]||kne,s[a])}function d6e(e){switch(e){case 5126:return G$e;case 35664:return q$e;case 35665:return X$e;case 35666:return Y$e;case 35674:return K$e;case 35675:return Q$e;case 35676:return Z$e;case 5124:case 35670:return J$e;case 35667:case 35671:return e6e;case 35668:case 35672:return t6e;case 35669:case 35673:return r6e;case 5125:return i6e;case 36294:return n6e;case 36295:return s6e;case 36296:return a6e;case 35678:case 36198:case 36298:case 36306:case 35682:return o6e;case 35679:case 36299:case 36307:return l6e;case 35680:case 36300:case 36308:case 36293:return c6e;case 36289:case 36303:case 36311:case 36292:return u6e}}var h6e=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=W$e(t.type)}},f6e=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=d6e(t.type)}},p6e=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let a=i[n];a.setValue(e,t[a.id],r)}}},bR=/(\w+)(\])?(\[|\.)?/g;function jW(e,t){e.seq.push(t),e.map[t.id]=t}function m6e(e,t,r){let i=e.name,n=i.length;for(bR.lastIndex=0;;){let s=bR.exec(i),a=bR.lastIndex,o=s[1],l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===n){jW(r,c===void 0?new h6e(o,e,t):new f6e(o,e,t));break}else{let d=r.map[o];d===void 0&&(d=new p6e(o),jW(r,d)),r=d}}}var EE=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),s=e.getUniformLocation(t,n.name);m6e(n,s,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=r[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let s=e[i];s.id in t&&r.push(s)}return r}};function VW(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var g6e=0;function v6e(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=n;a<s;a++){let o=a+1;i.push(`${o===t?">":" "} ${o}: ${r[a]}`)}return i.join(`
`)}function y6e(e){switch(e){case Kl:return["Linear","( value )"];case nr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function UW(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return r.toUpperCase()+`

`+n+`

`+v6e(e.getShaderSource(t),a)}else return n}function b6e(e,t){let r=y6e(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function x6e(e,t){let r;switch(t){case Aje:r="Linear";break;case Tje:r="Reinhard";break;case Mje:r="OptimizedCineon";break;case Pje:r="ACESFilmic";break;case Ije:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function w6e(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(f1).join(`
`)}function _6e(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function S6e(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),r[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function f1(e){return e!==""}function $W(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function HW(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var E6e=/^[ \t]*#include +<([\w\d./]+)>/gm;function DL(e){return e.replace(E6e,C6e)}function C6e(e,t){let r=cr[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return DL(r)}var A6e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function WW(e){return e.replace(A6e,T6e)}function T6e(e,t,r,i){let n="";for(let s=parseInt(t);s<parseInt(r);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function GW(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function M6e(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===y4?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===nje?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===h1&&(t="SHADOWMAP_TYPE_VSM"),t}function P6e(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Lp:case Np:t="ENVMAP_TYPE_CUBE";break;case mw:t="ENVMAP_TYPE_CUBE_UV";break}return t}function I6e(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Np:t="ENVMAP_MODE_REFRACTION";break}return t}function R6e(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case bne:t="ENVMAP_BLENDING_MULTIPLY";break;case Eje:t="ENVMAP_BLENDING_MIX";break;case Cje:t="ENVMAP_BLENDING_ADD";break}return t}function D6e(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function O6e(e,t,r,i){let n=e.getContext(),s=r.defines,a=r.vertexShader,o=r.fragmentShader,l=M6e(r),c=P6e(r),d=I6e(r),u=R6e(r),h=D6e(r),f=r.isWebGL2?"":w6e(r),p=_6e(s),m=n.createProgram(),g,v,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(g=[p].filter(f1).join(`
`),g.length>0&&(g+=`
`),v=[f,p].filter(f1).join(`
`),v.length>0&&(v+=`
`)):(g=[GW(r),"#define SHADER_NAME "+r.shaderName,p,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(f1).join(`
`),v=[f,GW(r),"#define SHADER_NAME "+r.shaderName,p,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+d:"",r.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Hc?"#define TONE_MAPPING":"",r.toneMapping!==Hc?cr.tonemapping_pars_fragment:"",r.toneMapping!==Hc?x6e("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",cr.encodings_pars_fragment,b6e("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(f1).join(`
`)),a=DL(a),a=$W(a,r),a=HW(a,r),o=DL(o),o=$W(o,r),o=HW(o,r),a=WW(a),o=WW(o),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",r.glslVersion===gW?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===gW?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let b=y+g+a,x=y+v+o,S=VW(n,35633,b),w=VW(n,35632,x);if(n.attachShader(m,S),n.attachShader(m,w),r.index0AttributeName!==void 0?n.bindAttribLocation(m,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),e.debug.checkShaderErrors){let T=n.getProgramInfoLog(m).trim(),A=n.getShaderInfoLog(S).trim(),M=n.getShaderInfoLog(w).trim(),P=!0,I=!0;if(n.getProgramParameter(m,35714)===!1){P=!1;let R=UW(n,S,"vertex"),N=UW(n,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+`

Program Info Log: `+T+`
`+R+`
`+N)}else T!==""?console.warn("THREE.WebGLProgram: Program Info Log:",T):(A===""||M==="")&&(I=!1);I&&(this.diagnostics={runnable:P,programLog:T,vertexShader:{log:A,prefix:g},fragmentShader:{log:M,prefix:v}})}n.deleteShader(S),n.deleteShader(w);let E;this.getUniforms=function(){return E===void 0&&(E=new EE(n,m)),E};let C;return this.getAttributes=function(){return C===void 0&&(C=S6e(n,m)),C},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=g6e++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=w,this}var L6e=0,N6e=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new k6e(e),t.set(e,r)),r}},k6e=class{constructor(e){this.id=L6e++,this.code=e,this.usedTimes=0}};function z6e(e,t,r,i,n,s,a){let o=new _4,l=new N6e,c=[],d=n.isWebGL2,u=n.logarithmicDepthBuffer,h=n.vertexTextures,f=n.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(C,T,A,M,P){let I=M.fog,R=P.geometry,N=C.isMeshStandardMaterial?M.environment:null,k=(C.isMeshStandardMaterial?r:t).get(C.envMap||N),O=k&&k.mapping===mw?k.image.height:null,D=p[C.type];C.precision!==null&&(f=n.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));let B=R.morphAttributes.position||R.morphAttributes.normal||R.morphAttributes.color,z=B!==void 0?B.length:0,F=0;R.morphAttributes.position!==void 0&&(F=1),R.morphAttributes.normal!==void 0&&(F=2),R.morphAttributes.color!==void 0&&(F=3);let V,Y,W,X;if(D){let ee=_c[D];V=ee.vertexShader,Y=ee.fragmentShader}else V=C.vertexShader,Y=C.fragmentShader,l.update(C),W=l.getVertexShaderID(C),X=l.getFragmentShaderID(C);let H=e.getRenderTarget(),ie=C.alphaTest>0,Q=C.clearcoat>0,Z=C.iridescence>0;return{isWebGL2:d,shaderID:D,shaderName:C.type,vertexShader:V,fragmentShader:Y,defines:C.defines,customVertexShaderID:W,customFragmentShaderID:X,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,instancing:P.isInstancedMesh===!0,instancingColor:P.isInstancedMesh===!0&&P.instanceColor!==null,supportsVertexTextures:h,outputEncoding:H===null?e.outputEncoding:H.isXRRenderTarget===!0?H.texture.encoding:Kl,map:!!C.map,matcap:!!C.matcap,envMap:!!k,envMapMode:k&&k.mapping,envMapCubeUVHeight:O,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===qje,tangentSpaceNormalMap:C.normalMapType===Gje,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===nr,clearcoat:Q,clearcoatMap:Q&&!!C.clearcoatMap,clearcoatRoughnessMap:Q&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:Q&&!!C.clearcoatNormalMap,iridescence:Z,iridescenceMap:Z&&!!C.iridescenceMap,iridescenceThicknessMap:Z&&!!C.iridescenceThicknessMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:C.transparent===!1&&C.blending===op,alphaMap:!!C.alphaMap,alphaTest:ie,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!R.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!R.attributes.color&&R.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.iridescenceMap||!!C.iridescenceThicknessMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.iridescenceMap||C.iridescenceThicknessMap||C.transmission>0||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheen>0||C.sheenColorMap||C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!I,useFog:C.fog===!0,fogExp2:I&&I.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:u,skinning:P.isSkinnedMesh===!0,morphTargets:R.morphAttributes.position!==void 0,morphNormals:R.morphAttributes.normal!==void 0,morphColors:R.morphAttributes.color!==void 0,morphTargetsCount:z,morphTextureStride:F,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:C.dithering,shadowMapEnabled:e.shadowMap.enabled&&A.length>0,shadowMapType:e.shadowMap.type,toneMapping:C.toneMapped?e.toneMapping:Hc,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===$a,flipSided:C.side===is,useDepthPacking:!!C.depthPacking,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){let T=[];if(C.shaderID?T.push(C.shaderID):(T.push(C.customVertexShaderID),T.push(C.customFragmentShaderID)),C.defines!==void 0)for(let A in C.defines)T.push(A),T.push(C.defines[A]);return C.isRawShaderMaterial===!1&&(v(T,C),y(T,C),T.push(e.outputEncoding)),T.push(C.customProgramCacheKey),T.join()}function v(C,T){C.push(T.precision),C.push(T.outputEncoding),C.push(T.envMapMode),C.push(T.envMapCubeUVHeight),C.push(T.combine),C.push(T.vertexUvs),C.push(T.fogExp2),C.push(T.sizeAttenuation),C.push(T.morphTargetsCount),C.push(T.morphAttributeCount),C.push(T.numDirLights),C.push(T.numPointLights),C.push(T.numSpotLights),C.push(T.numSpotLightMaps),C.push(T.numHemiLights),C.push(T.numRectAreaLights),C.push(T.numDirLightShadows),C.push(T.numPointLightShadows),C.push(T.numSpotLightShadows),C.push(T.numSpotLightShadowsWithMaps),C.push(T.shadowMapType),C.push(T.toneMapping),C.push(T.numClippingPlanes),C.push(T.numClipIntersection),C.push(T.depthPacking)}function y(C,T){o.disableAll(),T.isWebGL2&&o.enable(0),T.supportsVertexTextures&&o.enable(1),T.instancing&&o.enable(2),T.instancingColor&&o.enable(3),T.map&&o.enable(4),T.matcap&&o.enable(5),T.envMap&&o.enable(6),T.lightMap&&o.enable(7),T.aoMap&&o.enable(8),T.emissiveMap&&o.enable(9),T.bumpMap&&o.enable(10),T.normalMap&&o.enable(11),T.objectSpaceNormalMap&&o.enable(12),T.tangentSpaceNormalMap&&o.enable(13),T.clearcoat&&o.enable(14),T.clearcoatMap&&o.enable(15),T.clearcoatRoughnessMap&&o.enable(16),T.clearcoatNormalMap&&o.enable(17),T.iridescence&&o.enable(18),T.iridescenceMap&&o.enable(19),T.iridescenceThicknessMap&&o.enable(20),T.displacementMap&&o.enable(21),T.specularMap&&o.enable(22),T.roughnessMap&&o.enable(23),T.metalnessMap&&o.enable(24),T.gradientMap&&o.enable(25),T.alphaMap&&o.enable(26),T.alphaTest&&o.enable(27),T.vertexColors&&o.enable(28),T.vertexAlphas&&o.enable(29),T.vertexUvs&&o.enable(30),T.vertexTangents&&o.enable(31),T.uvsVertexOnly&&o.enable(32),C.push(o.mask),o.disableAll(),T.fog&&o.enable(0),T.useFog&&o.enable(1),T.flatShading&&o.enable(2),T.logarithmicDepthBuffer&&o.enable(3),T.skinning&&o.enable(4),T.morphTargets&&o.enable(5),T.morphNormals&&o.enable(6),T.morphColors&&o.enable(7),T.premultipliedAlpha&&o.enable(8),T.shadowMapEnabled&&o.enable(9),T.physicallyCorrectLights&&o.enable(10),T.doubleSided&&o.enable(11),T.flipSided&&o.enable(12),T.useDepthPacking&&o.enable(13),T.dithering&&o.enable(14),T.specularIntensityMap&&o.enable(15),T.specularColorMap&&o.enable(16),T.transmission&&o.enable(17),T.transmissionMap&&o.enable(18),T.thicknessMap&&o.enable(19),T.sheen&&o.enable(20),T.sheenColorMap&&o.enable(21),T.sheenRoughnessMap&&o.enable(22),T.decodeVideoTexture&&o.enable(23),T.opaque&&o.enable(24),C.push(o.mask)}function b(C){let T=p[C.type],A;if(T){let M=_c[T];A=L0.clone(M.uniforms)}else A=C.uniforms;return A}function x(C,T){let A;for(let M=0,P=c.length;M<P;M++){let I=c[M];if(I.cacheKey===T){A=I,++A.usedTimes;break}}return A===void 0&&(A=new O6e(e,T,C,s),c.push(A)),A}function S(C){if(--C.usedTimes===0){let T=c.indexOf(C);c[T]=c[c.length-1],c.pop(),C.destroy()}}function w(C){l.remove(C)}function E(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:b,acquireProgram:x,releaseProgram:S,releaseShaderCache:w,programs:c,dispose:E}}function B6e(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function r(s){e.delete(s)}function i(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function F6e(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function qW(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function XW(){let e=[],t=0,r=[],i=[],n=[];function s(){t=0,r.length=0,i.length=0,n.length=0}function a(u,h,f,p,m,g){let v=e[t];return v===void 0?(v={id:u.id,object:u,geometry:h,material:f,groupOrder:p,renderOrder:u.renderOrder,z:m,group:g},e[t]=v):(v.id=u.id,v.object=u,v.geometry=h,v.material=f,v.groupOrder=p,v.renderOrder=u.renderOrder,v.z=m,v.group=g),t++,v}function o(u,h,f,p,m,g){let v=a(u,h,f,p,m,g);f.transmission>0?i.push(v):f.transparent===!0?n.push(v):r.push(v)}function l(u,h,f,p,m,g){let v=a(u,h,f,p,m,g);f.transmission>0?i.unshift(v):f.transparent===!0?n.unshift(v):r.unshift(v)}function c(u,h){r.length>1&&r.sort(u||F6e),i.length>1&&i.sort(h||qW),n.length>1&&n.sort(h||qW)}function d(){for(let u=t,h=e.length;u<h;u++){let f=e[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:r,transmissive:i,transparent:n,init:s,push:o,unshift:l,finish:d,sort:c}}function j6e(){let e=new WeakMap;function t(i,n){let s=e.get(i),a;return s===void 0?(a=new XW,e.set(i,[a])):n>=s.length?(a=new XW,s.push(a)):a=s[n],a}function r(){e=new WeakMap}return{get:t,dispose:r}}function V6e(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new L,color:new zt};break;case"SpotLight":r={position:new L,direction:new L,color:new zt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new L,color:new zt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new L,skyColor:new zt,groundColor:new zt};break;case"RectAreaLight":r={color:new zt,position:new L,halfWidth:new L,halfHeight:new L};break}return e[t.id]=r,r}}}function U6e(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var $6e=0;function H6e(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function W6e(e,t){let r=new V6e,i=U6e(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)n.probe.push(new L);let s=new L,a=new Ke,o=new Ke;function l(d,u){let h=0,f=0,p=0;for(let M=0;M<9;M++)n.probe[M].set(0,0,0);let m=0,g=0,v=0,y=0,b=0,x=0,S=0,w=0,E=0,C=0;d.sort(H6e);let T=u!==!0?Math.PI:1;for(let M=0,P=d.length;M<P;M++){let I=d[M],R=I.color,N=I.intensity,k=I.distance,O=I.shadow&&I.shadow.map?I.shadow.map.texture:null;if(I.isAmbientLight)h+=R.r*N*T,f+=R.g*N*T,p+=R.b*N*T;else if(I.isLightProbe)for(let D=0;D<9;D++)n.probe[D].addScaledVector(I.sh.coefficients[D],N);else if(I.isDirectionalLight){let D=r.get(I);if(D.color.copy(I.color).multiplyScalar(I.intensity*T),I.castShadow){let B=I.shadow,z=i.get(I);z.shadowBias=B.bias,z.shadowNormalBias=B.normalBias,z.shadowRadius=B.radius,z.shadowMapSize=B.mapSize,n.directionalShadow[m]=z,n.directionalShadowMap[m]=O,n.directionalShadowMatrix[m]=I.shadow.matrix,x++}n.directional[m]=D,m++}else if(I.isSpotLight){let D=r.get(I);D.position.setFromMatrixPosition(I.matrixWorld),D.color.copy(R).multiplyScalar(N*T),D.distance=k,D.coneCos=Math.cos(I.angle),D.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),D.decay=I.decay,n.spot[v]=D;let B=I.shadow;if(I.map&&(n.spotLightMap[E]=I.map,E++,B.updateMatrices(I),I.castShadow&&C++),n.spotLightMatrix[v]=B.matrix,I.castShadow){let z=i.get(I);z.shadowBias=B.bias,z.shadowNormalBias=B.normalBias,z.shadowRadius=B.radius,z.shadowMapSize=B.mapSize,n.spotShadow[v]=z,n.spotShadowMap[v]=O,w++}v++}else if(I.isRectAreaLight){let D=r.get(I);D.color.copy(R).multiplyScalar(N),D.halfWidth.set(I.width*.5,0,0),D.halfHeight.set(0,I.height*.5,0),n.rectArea[y]=D,y++}else if(I.isPointLight){let D=r.get(I);if(D.color.copy(I.color).multiplyScalar(I.intensity*T),D.distance=I.distance,D.decay=I.decay,I.castShadow){let B=I.shadow,z=i.get(I);z.shadowBias=B.bias,z.shadowNormalBias=B.normalBias,z.shadowRadius=B.radius,z.shadowMapSize=B.mapSize,z.shadowCameraNear=B.camera.near,z.shadowCameraFar=B.camera.far,n.pointShadow[g]=z,n.pointShadowMap[g]=O,n.pointShadowMatrix[g]=I.shadow.matrix,S++}n.point[g]=D,g++}else if(I.isHemisphereLight){let D=r.get(I);D.skyColor.copy(I.color).multiplyScalar(N*T),D.groundColor.copy(I.groundColor).multiplyScalar(N*T),n.hemi[b]=D,b++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=ct.LTC_FLOAT_1,n.rectAreaLTC2=ct.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=ct.LTC_HALF_1,n.rectAreaLTC2=ct.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=h,n.ambient[1]=f,n.ambient[2]=p;let A=n.hash;(A.directionalLength!==m||A.pointLength!==g||A.spotLength!==v||A.rectAreaLength!==y||A.hemiLength!==b||A.numDirectionalShadows!==x||A.numPointShadows!==S||A.numSpotShadows!==w||A.numSpotMaps!==E)&&(n.directional.length=m,n.spot.length=v,n.rectArea.length=y,n.point.length=g,n.hemi.length=b,n.directionalShadow.length=x,n.directionalShadowMap.length=x,n.pointShadow.length=S,n.pointShadowMap.length=S,n.spotShadow.length=w,n.spotShadowMap.length=w,n.directionalShadowMatrix.length=x,n.pointShadowMatrix.length=S,n.spotLightMatrix.length=w+E-C,n.spotLightMap.length=E,n.numSpotLightShadowsWithMaps=C,A.directionalLength=m,A.pointLength=g,A.spotLength=v,A.rectAreaLength=y,A.hemiLength=b,A.numDirectionalShadows=x,A.numPointShadows=S,A.numSpotShadows=w,A.numSpotMaps=E,n.version=$6e++)}function c(d,u){let h=0,f=0,p=0,m=0,g=0,v=u.matrixWorldInverse;for(let y=0,b=d.length;y<b;y++){let x=d[y];if(x.isDirectionalLight){let S=n.directional[h];S.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),h++}else if(x.isSpotLight){let S=n.spot[p];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(v),S.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),p++}else if(x.isRectAreaLight){let S=n.rectArea[m];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(v),o.identity(),a.copy(x.matrixWorld),a.premultiply(v),o.extractRotation(a),S.halfWidth.set(x.width*.5,0,0),S.halfHeight.set(0,x.height*.5,0),S.halfWidth.applyMatrix4(o),S.halfHeight.applyMatrix4(o),m++}else if(x.isPointLight){let S=n.point[f];S.position.setFromMatrixPosition(x.matrixWorld),S.position.applyMatrix4(v),f++}else if(x.isHemisphereLight){let S=n.hemi[g];S.direction.setFromMatrixPosition(x.matrixWorld),S.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:n}}function YW(e,t){let r=new W6e(e,t),i=[],n=[];function s(){i.length=0,n.length=0}function a(d){i.push(d)}function o(d){n.push(d)}function l(d){r.setup(i,d)}function c(d){r.setupView(i,d)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function G6e(e,t){let r=new WeakMap;function i(s,a=0){let o=r.get(s),l;return o===void 0?(l=new YW(e,t),r.set(s,[l])):a>=o.length?(l=new YW(e,t),o.push(l)):l=o[a],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var Fne=class extends gw{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=yd,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},q6e=class extends gw{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new L,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},X6e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Y6e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function K6e(e,t,r){let i=new E4,n=new oe,s=new oe,a=new Yt,o=new Fne({depthPacking:Cne}),l=new q6e,c={},d=r.maxTextureSize,u={[Yl]:is,[is]:Yl,[$a]:$a},h=new Gr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new oe},radius:{value:4}},vertexShader:X6e,fragmentShader:Y6e}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let p=new Dt;p.setAttribute("position",new Wt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new An(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=y4,this.render=function(x,S,w){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||x.length===0)return;let E=e.getRenderTarget(),C=e.getActiveCubeFace(),T=e.getActiveMipmapLevel(),A=e.state;A.setBlending(Tn),A.buffers.color.setClear(1,1,1,1),A.buffers.depth.setTest(!0),A.setScissorTest(!1);for(let M=0,P=x.length;M<P;M++){let I=x[M],R=I.shadow;if(R===void 0){console.warn("THREE.WebGLShadowMap:",I,"has no shadow.");continue}if(R.autoUpdate===!1&&R.needsUpdate===!1)continue;n.copy(R.mapSize);let N=R.getFrameExtents();if(n.multiply(N),s.copy(R.mapSize),(n.x>d||n.y>d)&&(n.x>d&&(s.x=Math.floor(d/N.x),n.x=s.x*N.x,R.mapSize.x=s.x),n.y>d&&(s.y=Math.floor(d/N.y),n.y=s.y*N.y,R.mapSize.y=s.y)),R.map===null){let O=this.type!==h1?{minFilter:Hr,magFilter:Hr}:{};R.map=new Wr(n.x,n.y,O),R.map.texture.name=I.name+".shadowMap",R.camera.updateProjectionMatrix()}e.setRenderTarget(R.map),e.clear();let k=R.getViewportCount();for(let O=0;O<k;O++){let D=R.getViewport(O);a.set(s.x*D.x,s.y*D.y,s.x*D.z,s.y*D.w),A.viewport(a),R.updateMatrices(I,O),i=R.getFrustum(),b(S,w,R.camera,I,this.type)}R.isPointLightShadow!==!0&&this.type===h1&&v(R,w),R.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(E,C,T)};function v(x,S){let w=t.update(m);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),x.mapPass===null&&(x.mapPass=new Wr(n.x,n.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,e.setRenderTarget(x.mapPass),e.clear(),e.renderBufferDirect(S,null,w,h,m,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,e.setRenderTarget(x.map),e.clear(),e.renderBufferDirect(S,null,w,f,m,null)}function y(x,S,w,E,C,T){let A=null,M=w.isPointLight===!0?x.customDistanceMaterial:x.customDepthMaterial;if(M!==void 0)A=M;else if(A=w.isPointLight===!0?l:o,e.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){let P=A.uuid,I=S.uuid,R=c[P];R===void 0&&(R={},c[P]=R);let N=R[I];N===void 0&&(N=A.clone(),R[I]=N),A=N}return A.visible=S.visible,A.wireframe=S.wireframe,T===h1?A.side=S.shadowSide!==null?S.shadowSide:S.side:A.side=S.shadowSide!==null?S.shadowSide:u[S.side],A.alphaMap=S.alphaMap,A.alphaTest=S.alphaTest,A.map=S.map,A.clipShadows=S.clipShadows,A.clippingPlanes=S.clippingPlanes,A.clipIntersection=S.clipIntersection,A.displacementMap=S.displacementMap,A.displacementScale=S.displacementScale,A.displacementBias=S.displacementBias,A.wireframeLinewidth=S.wireframeLinewidth,A.linewidth=S.linewidth,w.isPointLight===!0&&A.isMeshDistanceMaterial===!0&&(A.referencePosition.setFromMatrixPosition(w.matrixWorld),A.nearDistance=E,A.farDistance=C),A}function b(x,S,w,E,C){if(x.visible===!1)return;if(x.layers.test(S.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&C===h1)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,x.matrixWorld);let A=t.update(x),M=x.material;if(Array.isArray(M)){let P=A.groups;for(let I=0,R=P.length;I<R;I++){let N=P[I],k=M[N.materialIndex];if(k&&k.visible){let O=y(x,k,E,w.near,w.far,C);e.renderBufferDirect(w,null,A,O,x,N)}}}else if(M.visible){let P=y(x,M,E,w.near,w.far,C);e.renderBufferDirect(w,null,A,P,x,null)}}let T=x.children;for(let A=0,M=T.length;A<M;A++)b(T[A],S,w,E,C)}}function Q6e(e,t,r){let i=r.isWebGL2;function n(){let ue=!1,Ae=new Yt,ke=null,Ie=new Yt(0,0,0,0);return{setMask:function($e){ke!==$e&&!ue&&(e.colorMask($e,$e,$e,$e),ke=$e)},setLocked:function($e){ue=$e},setClear:function($e,tt,He,gt,ot){ot===!0&&($e*=gt,tt*=gt,He*=gt),Ae.set($e,tt,He,gt),Ie.equals(Ae)===!1&&(e.clearColor($e,tt,He,gt),Ie.copy(Ae))},reset:function(){ue=!1,ke=null,Ie.set(-1,0,0,0)}}}function s(){let ue=!1,Ae=null,ke=null,Ie=null;return{setTest:function($e){$e?ie(2929):Q(2929)},setMask:function($e){Ae!==$e&&!ue&&(e.depthMask($e),Ae=$e)},setFunc:function($e){if(ke!==$e){switch($e){case vje:e.depthFunc(512);break;case yje:e.depthFunc(519);break;case bje:e.depthFunc(513);break;case CL:e.depthFunc(515);break;case xje:e.depthFunc(514);break;case wje:e.depthFunc(518);break;case _je:e.depthFunc(516);break;case Sje:e.depthFunc(517);break;default:e.depthFunc(515)}ke=$e}},setLocked:function($e){ue=$e},setClear:function($e){Ie!==$e&&(e.clearDepth($e),Ie=$e)},reset:function(){ue=!1,Ae=null,ke=null,Ie=null}}}function a(){let ue=!1,Ae=null,ke=null,Ie=null,$e=null,tt=null,He=null,gt=null,ot=null;return{setTest:function(at){ue||(at?ie(2960):Q(2960))},setMask:function(at){Ae!==at&&!ue&&(e.stencilMask(at),Ae=at)},setFunc:function(at,Qe,ut){(ke!==at||Ie!==Qe||$e!==ut)&&(e.stencilFunc(at,Qe,ut),ke=at,Ie=Qe,$e=ut)},setOp:function(at,Qe,ut){(tt!==at||He!==Qe||gt!==ut)&&(e.stencilOp(at,Qe,ut),tt=at,He=Qe,gt=ut)},setLocked:function(at){ue=at},setClear:function(at){ot!==at&&(e.clearStencil(at),ot=at)},reset:function(){ue=!1,Ae=null,ke=null,Ie=null,$e=null,tt=null,He=null,gt=null,ot=null}}}let o=new n,l=new s,c=new a,d=new WeakMap,u=new WeakMap,h={},f={},p=new WeakMap,m=[],g=null,v=!1,y=null,b=null,x=null,S=null,w=null,E=null,C=null,T=!1,A=null,M=null,P=null,I=null,R=null,N=e.getParameter(35661),k=!1,O=0,D=e.getParameter(7938);D.indexOf("WebGL")!==-1?(O=parseFloat(/^WebGL (\d)/.exec(D)[1]),k=O>=1):D.indexOf("OpenGL ES")!==-1&&(O=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),k=O>=2);let B=null,z={},F=e.getParameter(3088),V=e.getParameter(2978),Y=new Yt().fromArray(F),W=new Yt().fromArray(V);function X(ue,Ae,ke){let Ie=new Uint8Array(4),$e=e.createTexture();e.bindTexture(ue,$e),e.texParameteri(ue,10241,9728),e.texParameteri(ue,10240,9728);for(let tt=0;tt<ke;tt++)e.texImage2D(Ae+tt,0,6408,1,1,0,6408,5121,Ie);return $e}let H={};H[3553]=X(3553,3553,1),H[34067]=X(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ie(2929),l.setFunc(CL),Oe(!1),Ee(jH),ie(2884),fe(Tn);function ie(ue){h[ue]!==!0&&(e.enable(ue),h[ue]=!0)}function Q(ue){h[ue]!==!1&&(e.disable(ue),h[ue]=!1)}function Z(ue,Ae){return f[ue]!==Ae?(e.bindFramebuffer(ue,Ae),f[ue]=Ae,i&&(ue===36009&&(f[36160]=Ae),ue===36160&&(f[36009]=Ae)),!0):!1}function ee(ue,Ae){let ke=m,Ie=!1;if(ue)if(ke=p.get(Ae),ke===void 0&&(ke=[],p.set(Ae,ke)),ue.isWebGLMultipleRenderTargets){let $e=ue.texture;if(ke.length!==$e.length||ke[0]!==36064){for(let tt=0,He=$e.length;tt<He;tt++)ke[tt]=36064+tt;ke.length=$e.length,Ie=!0}}else ke[0]!==36064&&(ke[0]=36064,Ie=!0);else ke[0]!==1029&&(ke[0]=1029,Ie=!0);Ie&&(r.isWebGL2?e.drawBuffers(ke):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ke))}function re(ue){return g!==ue?(e.useProgram(ue),g=ue,!0):!1}let ne={[gg]:32774,[aje]:32778,[oje]:32779};if(i)ne[HH]=32775,ne[WH]=32776;else{let ue=t.get("EXT_blend_minmax");ue!==null&&(ne[HH]=ue.MIN_EXT,ne[WH]=ue.MAX_EXT)}let se={[lje]:0,[cje]:1,[uje]:768,[vne]:770,[gje]:776,[pje]:774,[hje]:772,[dje]:769,[yne]:771,[mje]:775,[fje]:773};function fe(ue,Ae,ke,Ie,$e,tt,He,gt){if(ue===Tn){v===!0&&(Q(3042),v=!1);return}if(v===!1&&(ie(3042),v=!0),ue!==sje){if(ue!==y||gt!==T){if((b!==gg||w!==gg)&&(e.blendEquation(32774),b=gg,w=gg),gt)switch(ue){case op:e.blendFuncSeparate(1,771,1,771);break;case VH:e.blendFunc(1,1);break;case UH:e.blendFuncSeparate(0,769,0,1);break;case $H:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}else switch(ue){case op:e.blendFuncSeparate(770,771,1,771);break;case VH:e.blendFunc(770,1);break;case UH:e.blendFuncSeparate(0,769,0,1);break;case $H:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}x=null,S=null,E=null,C=null,y=ue,T=gt}return}$e=$e||Ae,tt=tt||ke,He=He||Ie,(Ae!==b||$e!==w)&&(e.blendEquationSeparate(ne[Ae],ne[$e]),b=Ae,w=$e),(ke!==x||Ie!==S||tt!==E||He!==C)&&(e.blendFuncSeparate(se[ke],se[Ie],se[tt],se[He]),x=ke,S=Ie,E=tt,C=He),y=ue,T=!1}function me(ue,Ae){ue.side===$a?Q(2884):ie(2884);let ke=ue.side===is;Ae&&(ke=!ke),Oe(ke),ue.blending===op&&ue.transparent===!1?fe(Tn):fe(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.premultipliedAlpha),l.setFunc(ue.depthFunc),l.setTest(ue.depthTest),l.setMask(ue.depthWrite),o.setMask(ue.colorWrite);let Ie=ue.stencilWrite;c.setTest(Ie),Ie&&(c.setMask(ue.stencilWriteMask),c.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),c.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),de(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits),ue.alphaToCoverage===!0?ie(32926):Q(32926)}function Oe(ue){A!==ue&&(ue?e.frontFace(2304):e.frontFace(2305),A=ue)}function Ee(ue){ue!==rje?(ie(2884),ue!==M&&(ue===jH?e.cullFace(1029):ue===ije?e.cullFace(1028):e.cullFace(1032))):Q(2884),M=ue}function Se(ue){ue!==P&&(k&&e.lineWidth(ue),P=ue)}function de(ue,Ae,ke){ue?(ie(32823),(I!==Ae||R!==ke)&&(e.polygonOffset(Ae,ke),I=Ae,R=ke)):Q(32823)}function be(ue){ue?ie(3089):Q(3089)}function ye(ue){ue===void 0&&(ue=33984+N-1),B!==ue&&(e.activeTexture(ue),B=ue)}function q(ue,Ae,ke){ke===void 0&&(B===null?ke=33984+N-1:ke=B);let Ie=z[ke];Ie===void 0&&(Ie={type:void 0,texture:void 0},z[ke]=Ie),(Ie.type!==ue||Ie.texture!==Ae)&&(B!==ke&&(e.activeTexture(ke),B=ke),e.bindTexture(ue,Ae||H[ue]),Ie.type=ue,Ie.texture=Ae)}function U(){let ue=z[B];ue!==void 0&&ue.type!==void 0&&(e.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function ce(){try{e.compressedTexImage2D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function xe(){try{e.compressedTexImage3D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function j(){try{e.texSubImage2D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Be(){try{e.texSubImage3D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function ze(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Ve(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function pe(){try{e.texStorage2D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Me(){try{e.texStorage3D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Ue(){try{e.texImage2D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Re(){try{e.texImage3D.apply(e,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function et(ue){Y.equals(ue)===!1&&(e.scissor(ue.x,ue.y,ue.z,ue.w),Y.copy(ue))}function Xe(ue){W.equals(ue)===!1&&(e.viewport(ue.x,ue.y,ue.z,ue.w),W.copy(ue))}function Ze(ue,Ae){let ke=u.get(Ae);ke===void 0&&(ke=new WeakMap,u.set(Ae,ke));let Ie=ke.get(ue);Ie===void 0&&(Ie=e.getUniformBlockIndex(Ae,ue.name),ke.set(ue,Ie))}function Mt(ue,Ae){let ke=u.get(Ae).get(ue);d.get(Ae)!==ke&&(e.uniformBlockBinding(Ae,ke,ue.__bindingPointIndex),d.set(Ae,ke))}function Gt(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},B=null,z={},f={},p=new WeakMap,m=[],g=null,v=!1,y=null,b=null,x=null,S=null,w=null,E=null,C=null,T=!1,A=null,M=null,P=null,I=null,R=null,Y.set(0,0,e.canvas.width,e.canvas.height),W.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:ie,disable:Q,bindFramebuffer:Z,drawBuffers:ee,useProgram:re,setBlending:fe,setMaterial:me,setFlipSided:Oe,setCullFace:Ee,setLineWidth:Se,setPolygonOffset:de,setScissorTest:be,activeTexture:ye,bindTexture:q,unbindTexture:U,compressedTexImage2D:ce,compressedTexImage3D:xe,texImage2D:Ue,texImage3D:Re,updateUBOMapping:Ze,uniformBlockBinding:Mt,texStorage2D:pe,texStorage3D:Me,texSubImage2D:j,texSubImage3D:Be,compressedTexSubImage2D:ze,compressedTexSubImage3D:Ve,scissor:et,viewport:Xe,reset:Gt}}function Z6e(e,t,r,i,n,s,a){let o=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,d=n.maxTextureSize,u=n.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,m,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(q,U){return v?new OffscreenCanvas(q,U):ix("canvas")}function b(q,U,ce,xe){let j=1;if((q.width>xe||q.height>xe)&&(j=xe/Math.max(q.width,q.height)),j<1||U===!0)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap){let Be=U?vA:Math.floor,ze=Be(j*q.width),Ve=Be(j*q.height);m===void 0&&(m=y(ze,Ve));let pe=ce?y(ze,Ve):m;return pe.width=ze,pe.height=Ve,pe.getContext("2d").drawImage(q,0,0,ze,Ve),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+q.width+"x"+q.height+") to ("+ze+"x"+Ve+")."),pe}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+q.width+"x"+q.height+")."),q;return q}function x(q){return RL(q.width)&&RL(q.height)}function S(q){return o?!1:q.wrapS!==Si||q.wrapT!==Si||q.minFilter!==Hr&&q.minFilter!==dr}function w(q,U){return q.generateMipmaps&&U&&q.minFilter!==Hr&&q.minFilter!==dr}function E(q){e.generateMipmap(q)}function C(q,U,ce,xe,j=!1){if(o===!1)return U;if(q!==null){if(e[q]!==void 0)return e[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let Be=U;return U===6403&&(ce===5126&&(Be=33326),ce===5131&&(Be=33325),ce===5121&&(Be=33321)),U===33319&&(ce===5126&&(Be=33328),ce===5131&&(Be=33327),ce===5121&&(Be=33323)),U===6408&&(ce===5126&&(Be=34836),ce===5131&&(Be=34842),ce===5121&&(Be=xe===nr&&j===!1?35907:32856),ce===32819&&(Be=32854),ce===32820&&(Be=32855)),(Be===33325||Be===33326||Be===33327||Be===33328||Be===34842||Be===34836)&&t.get("EXT_color_buffer_float"),Be}function T(q,U,ce){return w(q,ce)===!0||q.isFramebufferTexture&&q.minFilter!==Hr&&q.minFilter!==dr?Math.log2(Math.max(U.width,U.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?U.mipmaps.length:1}function A(q){return q===Hr||q===GH||q===$I?9728:9729}function M(q){let U=q.target;U.removeEventListener("dispose",M),I(U),U.isVideoTexture&&p.delete(U)}function P(q){let U=q.target;U.removeEventListener("dispose",P),N(U)}function I(q){let U=i.get(q);if(U.__webglInit===void 0)return;let ce=q.source,xe=g.get(ce);if(xe){let j=xe[U.__cacheKey];j.usedTimes--,j.usedTimes===0&&R(q),Object.keys(xe).length===0&&g.delete(ce)}i.remove(q)}function R(q){let U=i.get(q);e.deleteTexture(U.__webglTexture);let ce=q.source,xe=g.get(ce);delete xe[U.__cacheKey],a.memory.textures--}function N(q){let U=q.texture,ce=i.get(q),xe=i.get(U);if(xe.__webglTexture!==void 0&&(e.deleteTexture(xe.__webglTexture),a.memory.textures--),q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let j=0;j<6;j++)e.deleteFramebuffer(ce.__webglFramebuffer[j]),ce.__webglDepthbuffer&&e.deleteRenderbuffer(ce.__webglDepthbuffer[j]);else{if(e.deleteFramebuffer(ce.__webglFramebuffer),ce.__webglDepthbuffer&&e.deleteRenderbuffer(ce.__webglDepthbuffer),ce.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ce.__webglMultisampledFramebuffer),ce.__webglColorRenderbuffer)for(let j=0;j<ce.__webglColorRenderbuffer.length;j++)ce.__webglColorRenderbuffer[j]&&e.deleteRenderbuffer(ce.__webglColorRenderbuffer[j]);ce.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ce.__webglDepthRenderbuffer)}if(q.isWebGLMultipleRenderTargets)for(let j=0,Be=U.length;j<Be;j++){let ze=i.get(U[j]);ze.__webglTexture&&(e.deleteTexture(ze.__webglTexture),a.memory.textures--),i.remove(U[j])}i.remove(U),i.remove(q)}let k=0;function O(){k=0}function D(){let q=k;return q>=l&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+l),k+=1,q}function B(q){let U=[];return U.push(q.wrapS),U.push(q.wrapT),U.push(q.wrapR||0),U.push(q.magFilter),U.push(q.minFilter),U.push(q.anisotropy),U.push(q.internalFormat),U.push(q.format),U.push(q.type),U.push(q.generateMipmaps),U.push(q.premultiplyAlpha),U.push(q.flipY),U.push(q.unpackAlignment),U.push(q.encoding),U.join()}function z(q,U){let ce=i.get(q);if(q.isVideoTexture&&be(q),q.isRenderTargetTexture===!1&&q.version>0&&ce.__version!==q.version){let xe=q.image;if(xe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Q(ce,q,U);return}}r.bindTexture(3553,ce.__webglTexture,33984+U)}function F(q,U){let ce=i.get(q);if(q.version>0&&ce.__version!==q.version){Q(ce,q,U);return}r.bindTexture(35866,ce.__webglTexture,33984+U)}function V(q,U){let ce=i.get(q);if(q.version>0&&ce.__version!==q.version){Q(ce,q,U);return}r.bindTexture(32879,ce.__webglTexture,33984+U)}function Y(q,U){let ce=i.get(q);if(q.version>0&&ce.__version!==q.version){Z(ce,q,U);return}r.bindTexture(34067,ce.__webglTexture,33984+U)}let W={[Vu]:10497,[Si]:33071,[ML]:33648},X={[Hr]:9728,[GH]:9984,[$I]:9986,[dr]:9729,[Rje]:9985,[Gv]:9987};function H(q,U,ce){if(ce?(e.texParameteri(q,10242,W[U.wrapS]),e.texParameteri(q,10243,W[U.wrapT]),(q===32879||q===35866)&&e.texParameteri(q,32882,W[U.wrapR]),e.texParameteri(q,10240,X[U.magFilter]),e.texParameteri(q,10241,X[U.minFilter])):(e.texParameteri(q,10242,33071),e.texParameteri(q,10243,33071),(q===32879||q===35866)&&e.texParameteri(q,32882,33071),(U.wrapS!==Si||U.wrapT!==Si)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(q,10240,A(U.magFilter)),e.texParameteri(q,10241,A(U.minFilter)),U.minFilter!==Hr&&U.minFilter!==dr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let xe=t.get("EXT_texture_filter_anisotropic");if(U.magFilter===Hr||U.minFilter!==$I&&U.minFilter!==Gv||U.type===Cn&&t.has("OES_texture_float_linear")===!1||o===!1&&U.type===kp&&t.has("OES_texture_half_float_linear")===!1)return;(U.anisotropy>1||i.get(U).__currentAnisotropy)&&(e.texParameterf(q,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(U.anisotropy,n.getMaxAnisotropy())),i.get(U).__currentAnisotropy=U.anisotropy)}}function ie(q,U){let ce=!1;q.__webglInit===void 0&&(q.__webglInit=!0,U.addEventListener("dispose",M));let xe=U.source,j=g.get(xe);j===void 0&&(j={},g.set(xe,j));let Be=B(U);if(Be!==q.__cacheKey){j[Be]===void 0&&(j[Be]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,ce=!0),j[Be].usedTimes++;let ze=j[q.__cacheKey];ze!==void 0&&(j[q.__cacheKey].usedTimes--,ze.usedTimes===0&&R(U)),q.__cacheKey=Be,q.__webglTexture=j[Be].texture}return ce}function Q(q,U,ce){let xe=3553;(U.isDataArrayTexture||U.isCompressedArrayTexture)&&(xe=35866),U.isData3DTexture&&(xe=32879);let j=ie(q,U),Be=U.source;r.bindTexture(xe,q.__webglTexture,33984+ce);let ze=i.get(Be);if(Be.version!==ze.__version||j===!0){r.activeTexture(33984+ce),e.pixelStorei(37440,U.flipY),e.pixelStorei(37441,U.premultiplyAlpha),e.pixelStorei(3317,U.unpackAlignment),e.pixelStorei(37443,0);let Ve=S(U)&&x(U.image)===!1,pe=b(U.image,Ve,!1,d);pe=ye(U,pe);let Me=x(pe)||o,Ue=s.convert(U.format,U.encoding),Re=s.convert(U.type),et=C(U.internalFormat,Ue,Re,U.encoding,U.isVideoTexture);H(xe,U,Me);let Xe,Ze=U.mipmaps,Mt=o&&U.isVideoTexture!==!0,Gt=ze.__version===void 0||j===!0,ue=T(U,pe,Me);if(U.isDepthTexture)et=6402,o?U.type===Cn?et=36012:U.type===Uu?et=33190:U.type===lp?et=35056:et=33189:U.type===Cn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),U.format===cp&&et===6402&&U.type!==wne&&U.type!==Uu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),U.type=Uu,Re=s.convert(U.type)),U.format===zp&&et===6402&&(et=34041,U.type!==lp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),U.type=lp,Re=s.convert(U.type))),Gt&&(Mt?r.texStorage2D(3553,1,et,pe.width,pe.height):r.texImage2D(3553,0,et,pe.width,pe.height,0,Ue,Re,null));else if(U.isDataTexture)if(Ze.length>0&&Me){Mt&&Gt&&r.texStorage2D(3553,ue,et,Ze[0].width,Ze[0].height);for(let Ae=0,ke=Ze.length;Ae<ke;Ae++)Xe=Ze[Ae],Mt?r.texSubImage2D(3553,Ae,0,0,Xe.width,Xe.height,Ue,Re,Xe.data):r.texImage2D(3553,Ae,et,Xe.width,Xe.height,0,Ue,Re,Xe.data);U.generateMipmaps=!1}else Mt?(Gt&&r.texStorage2D(3553,ue,et,pe.width,pe.height),r.texSubImage2D(3553,0,0,0,pe.width,pe.height,Ue,Re,pe.data)):r.texImage2D(3553,0,et,pe.width,pe.height,0,Ue,Re,pe.data);else if(U.isCompressedTexture)if(U.isCompressedArrayTexture){Mt&&Gt&&r.texStorage3D(35866,ue,et,Ze[0].width,Ze[0].height,pe.depth);for(let Ae=0,ke=Ze.length;Ae<ke;Ae++)Xe=Ze[Ae],U.format!==ts?Ue!==null?Mt?r.compressedTexSubImage3D(35866,Ae,0,0,0,Xe.width,Xe.height,pe.depth,Ue,Xe.data,0,0):r.compressedTexImage3D(35866,Ae,et,Xe.width,Xe.height,pe.depth,0,Xe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Mt?r.texSubImage3D(35866,Ae,0,0,0,Xe.width,Xe.height,pe.depth,Ue,Re,Xe.data):r.texImage3D(35866,Ae,et,Xe.width,Xe.height,pe.depth,0,Ue,Re,Xe.data)}else{Mt&&Gt&&r.texStorage2D(3553,ue,et,Ze[0].width,Ze[0].height);for(let Ae=0,ke=Ze.length;Ae<ke;Ae++)Xe=Ze[Ae],U.format!==ts?Ue!==null?Mt?r.compressedTexSubImage2D(3553,Ae,0,0,Xe.width,Xe.height,Ue,Xe.data):r.compressedTexImage2D(3553,Ae,et,Xe.width,Xe.height,0,Xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Mt?r.texSubImage2D(3553,Ae,0,0,Xe.width,Xe.height,Ue,Re,Xe.data):r.texImage2D(3553,Ae,et,Xe.width,Xe.height,0,Ue,Re,Xe.data)}else if(U.isDataArrayTexture)Mt?(Gt&&r.texStorage3D(35866,ue,et,pe.width,pe.height,pe.depth),r.texSubImage3D(35866,0,0,0,0,pe.width,pe.height,pe.depth,Ue,Re,pe.data)):r.texImage3D(35866,0,et,pe.width,pe.height,pe.depth,0,Ue,Re,pe.data);else if(U.isData3DTexture)Mt?(Gt&&r.texStorage3D(32879,ue,et,pe.width,pe.height,pe.depth),r.texSubImage3D(32879,0,0,0,0,pe.width,pe.height,pe.depth,Ue,Re,pe.data)):r.texImage3D(32879,0,et,pe.width,pe.height,pe.depth,0,Ue,Re,pe.data);else if(U.isFramebufferTexture){if(Gt)if(Mt)r.texStorage2D(3553,ue,et,pe.width,pe.height);else{let Ae=pe.width,ke=pe.height;for(let Ie=0;Ie<ue;Ie++)r.texImage2D(3553,Ie,et,Ae,ke,0,Ue,Re,null),Ae>>=1,ke>>=1}}else if(Ze.length>0&&Me){Mt&&Gt&&r.texStorage2D(3553,ue,et,Ze[0].width,Ze[0].height);for(let Ae=0,ke=Ze.length;Ae<ke;Ae++)Xe=Ze[Ae],Mt?r.texSubImage2D(3553,Ae,0,0,Ue,Re,Xe):r.texImage2D(3553,Ae,et,Ue,Re,Xe);U.generateMipmaps=!1}else Mt?(Gt&&r.texStorage2D(3553,ue,et,pe.width,pe.height),r.texSubImage2D(3553,0,0,0,Ue,Re,pe)):r.texImage2D(3553,0,et,Ue,Re,pe);w(U,Me)&&E(xe),ze.__version=Be.version,U.onUpdate&&U.onUpdate(U)}q.__version=U.version}function Z(q,U,ce){if(U.image.length!==6)return;let xe=ie(q,U),j=U.source;r.bindTexture(34067,q.__webglTexture,33984+ce);let Be=i.get(j);if(j.version!==Be.__version||xe===!0){r.activeTexture(33984+ce),e.pixelStorei(37440,U.flipY),e.pixelStorei(37441,U.premultiplyAlpha),e.pixelStorei(3317,U.unpackAlignment),e.pixelStorei(37443,0);let ze=U.isCompressedTexture||U.image[0].isCompressedTexture,Ve=U.image[0]&&U.image[0].isDataTexture,pe=[];for(let Ae=0;Ae<6;Ae++)!ze&&!Ve?pe[Ae]=b(U.image[Ae],!1,!0,c):pe[Ae]=Ve?U.image[Ae].image:U.image[Ae],pe[Ae]=ye(U,pe[Ae]);let Me=pe[0],Ue=x(Me)||o,Re=s.convert(U.format,U.encoding),et=s.convert(U.type),Xe=C(U.internalFormat,Re,et,U.encoding),Ze=o&&U.isVideoTexture!==!0,Mt=Be.__version===void 0||xe===!0,Gt=T(U,Me,Ue);H(34067,U,Ue);let ue;if(ze){Ze&&Mt&&r.texStorage2D(34067,Gt,Xe,Me.width,Me.height);for(let Ae=0;Ae<6;Ae++){ue=pe[Ae].mipmaps;for(let ke=0;ke<ue.length;ke++){let Ie=ue[ke];U.format!==ts?Re!==null?Ze?r.compressedTexSubImage2D(34069+Ae,ke,0,0,Ie.width,Ie.height,Re,Ie.data):r.compressedTexImage2D(34069+Ae,ke,Xe,Ie.width,Ie.height,0,Ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ze?r.texSubImage2D(34069+Ae,ke,0,0,Ie.width,Ie.height,Re,et,Ie.data):r.texImage2D(34069+Ae,ke,Xe,Ie.width,Ie.height,0,Re,et,Ie.data)}}}else{ue=U.mipmaps,Ze&&Mt&&(ue.length>0&&Gt++,r.texStorage2D(34067,Gt,Xe,pe[0].width,pe[0].height));for(let Ae=0;Ae<6;Ae++)if(Ve){Ze?r.texSubImage2D(34069+Ae,0,0,0,pe[Ae].width,pe[Ae].height,Re,et,pe[Ae].data):r.texImage2D(34069+Ae,0,Xe,pe[Ae].width,pe[Ae].height,0,Re,et,pe[Ae].data);for(let ke=0;ke<ue.length;ke++){let Ie=ue[ke].image[Ae].image;Ze?r.texSubImage2D(34069+Ae,ke+1,0,0,Ie.width,Ie.height,Re,et,Ie.data):r.texImage2D(34069+Ae,ke+1,Xe,Ie.width,Ie.height,0,Re,et,Ie.data)}}else{Ze?r.texSubImage2D(34069+Ae,0,0,0,Re,et,pe[Ae]):r.texImage2D(34069+Ae,0,Xe,Re,et,pe[Ae]);for(let ke=0;ke<ue.length;ke++){let Ie=ue[ke];Ze?r.texSubImage2D(34069+Ae,ke+1,0,0,Re,et,Ie.image[Ae]):r.texImage2D(34069+Ae,ke+1,Xe,Re,et,Ie.image[Ae])}}}w(U,Ue)&&E(34067),Be.__version=j.version,U.onUpdate&&U.onUpdate(U)}q.__version=U.version}function ee(q,U,ce,xe,j){let Be=s.convert(ce.format,ce.encoding),ze=s.convert(ce.type),Ve=C(ce.internalFormat,Be,ze,ce.encoding);i.get(U).__hasExternalTextures||(j===32879||j===35866?r.texImage3D(j,0,Ve,U.width,U.height,U.depth,0,Be,ze,null):r.texImage2D(j,0,Ve,U.width,U.height,0,Be,ze,null)),r.bindFramebuffer(36160,q),de(U)?h.framebufferTexture2DMultisampleEXT(36160,xe,j,i.get(ce).__webglTexture,0,Se(U)):(j===3553||j>=34069&&j<=34074)&&e.framebufferTexture2D(36160,xe,j,i.get(ce).__webglTexture,0),r.bindFramebuffer(36160,null)}function re(q,U,ce){if(e.bindRenderbuffer(36161,q),U.depthBuffer&&!U.stencilBuffer){let xe=33189;if(ce||de(U)){let j=U.depthTexture;j&&j.isDepthTexture&&(j.type===Cn?xe=36012:j.type===Uu&&(xe=33190));let Be=Se(U);de(U)?h.renderbufferStorageMultisampleEXT(36161,Be,xe,U.width,U.height):e.renderbufferStorageMultisample(36161,Be,xe,U.width,U.height)}else e.renderbufferStorage(36161,xe,U.width,U.height);e.framebufferRenderbuffer(36160,36096,36161,q)}else if(U.depthBuffer&&U.stencilBuffer){let xe=Se(U);ce&&de(U)===!1?e.renderbufferStorageMultisample(36161,xe,35056,U.width,U.height):de(U)?h.renderbufferStorageMultisampleEXT(36161,xe,35056,U.width,U.height):e.renderbufferStorage(36161,34041,U.width,U.height),e.framebufferRenderbuffer(36160,33306,36161,q)}else{let xe=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let j=0;j<xe.length;j++){let Be=xe[j],ze=s.convert(Be.format,Be.encoding),Ve=s.convert(Be.type),pe=C(Be.internalFormat,ze,Ve,Be.encoding),Me=Se(U);ce&&de(U)===!1?e.renderbufferStorageMultisample(36161,Me,pe,U.width,U.height):de(U)?h.renderbufferStorageMultisampleEXT(36161,Me,pe,U.width,U.height):e.renderbufferStorage(36161,pe,U.width,U.height)}}e.bindRenderbuffer(36161,null)}function ne(q,U){if(U&&U.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,q),!(U.depthTexture&&U.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(U.depthTexture).__webglTexture||U.depthTexture.image.width!==U.width||U.depthTexture.image.height!==U.height)&&(U.depthTexture.image.width=U.width,U.depthTexture.image.height=U.height,U.depthTexture.needsUpdate=!0),z(U.depthTexture,0);let ce=i.get(U.depthTexture).__webglTexture,xe=Se(U);if(U.depthTexture.format===cp)de(U)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,ce,0,xe):e.framebufferTexture2D(36160,36096,3553,ce,0);else if(U.depthTexture.format===zp)de(U)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,ce,0,xe):e.framebufferTexture2D(36160,33306,3553,ce,0);else throw new Error("Unknown depthTexture format")}function se(q){let U=i.get(q),ce=q.isWebGLCubeRenderTarget===!0;if(q.depthTexture&&!U.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");ne(U.__webglFramebuffer,q)}else if(ce){U.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)r.bindFramebuffer(36160,U.__webglFramebuffer[xe]),U.__webglDepthbuffer[xe]=e.createRenderbuffer(),re(U.__webglDepthbuffer[xe],q,!1)}else r.bindFramebuffer(36160,U.__webglFramebuffer),U.__webglDepthbuffer=e.createRenderbuffer(),re(U.__webglDepthbuffer,q,!1);r.bindFramebuffer(36160,null)}function fe(q,U,ce){let xe=i.get(q);U!==void 0&&ee(xe.__webglFramebuffer,q,q.texture,36064,3553),ce!==void 0&&se(q)}function me(q){let U=q.texture,ce=i.get(q),xe=i.get(U);q.addEventListener("dispose",P),q.isWebGLMultipleRenderTargets!==!0&&(xe.__webglTexture===void 0&&(xe.__webglTexture=e.createTexture()),xe.__version=U.version,a.memory.textures++);let j=q.isWebGLCubeRenderTarget===!0,Be=q.isWebGLMultipleRenderTargets===!0,ze=x(q)||o;if(j){ce.__webglFramebuffer=[];for(let Ve=0;Ve<6;Ve++)ce.__webglFramebuffer[Ve]=e.createFramebuffer()}else{if(ce.__webglFramebuffer=e.createFramebuffer(),Be)if(n.drawBuffers){let Ve=q.texture;for(let pe=0,Me=Ve.length;pe<Me;pe++){let Ue=i.get(Ve[pe]);Ue.__webglTexture===void 0&&(Ue.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&q.samples>0&&de(q)===!1){let Ve=Be?U:[U];ce.__webglMultisampledFramebuffer=e.createFramebuffer(),ce.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,ce.__webglMultisampledFramebuffer);for(let pe=0;pe<Ve.length;pe++){let Me=Ve[pe];ce.__webglColorRenderbuffer[pe]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ce.__webglColorRenderbuffer[pe]);let Ue=s.convert(Me.format,Me.encoding),Re=s.convert(Me.type),et=C(Me.internalFormat,Ue,Re,Me.encoding,q.isXRRenderTarget===!0),Xe=Se(q);e.renderbufferStorageMultisample(36161,Xe,et,q.width,q.height),e.framebufferRenderbuffer(36160,36064+pe,36161,ce.__webglColorRenderbuffer[pe])}e.bindRenderbuffer(36161,null),q.depthBuffer&&(ce.__webglDepthRenderbuffer=e.createRenderbuffer(),re(ce.__webglDepthRenderbuffer,q,!0)),r.bindFramebuffer(36160,null)}}if(j){r.bindTexture(34067,xe.__webglTexture),H(34067,U,ze);for(let Ve=0;Ve<6;Ve++)ee(ce.__webglFramebuffer[Ve],q,U,36064,34069+Ve);w(U,ze)&&E(34067),r.unbindTexture()}else if(Be){let Ve=q.texture;for(let pe=0,Me=Ve.length;pe<Me;pe++){let Ue=Ve[pe],Re=i.get(Ue);r.bindTexture(3553,Re.__webglTexture),H(3553,Ue,ze),ee(ce.__webglFramebuffer,q,Ue,36064+pe,3553),w(Ue,ze)&&E(3553)}r.unbindTexture()}else{let Ve=3553;(q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(o?Ve=q.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(Ve,xe.__webglTexture),H(Ve,U,ze),ee(ce.__webglFramebuffer,q,U,36064,Ve),w(U,ze)&&E(Ve),r.unbindTexture()}q.depthBuffer&&se(q)}function Oe(q){let U=x(q)||o,ce=q.isWebGLMultipleRenderTargets===!0?q.texture:[q.texture];for(let xe=0,j=ce.length;xe<j;xe++){let Be=ce[xe];if(w(Be,U)){let ze=q.isWebGLCubeRenderTarget?34067:3553,Ve=i.get(Be).__webglTexture;r.bindTexture(ze,Ve),E(ze),r.unbindTexture()}}}function Ee(q){if(o&&q.samples>0&&de(q)===!1){let U=q.isWebGLMultipleRenderTargets?q.texture:[q.texture],ce=q.width,xe=q.height,j=16384,Be=[],ze=q.stencilBuffer?33306:36096,Ve=i.get(q),pe=q.isWebGLMultipleRenderTargets===!0;if(pe)for(let Me=0;Me<U.length;Me++)r.bindFramebuffer(36160,Ve.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Me,36161,null),r.bindFramebuffer(36160,Ve.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Me,3553,null,0);r.bindFramebuffer(36008,Ve.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ve.__webglFramebuffer);for(let Me=0;Me<U.length;Me++){Be.push(36064+Me),q.depthBuffer&&Be.push(ze);let Ue=Ve.__ignoreDepthValues!==void 0?Ve.__ignoreDepthValues:!1;if(Ue===!1&&(q.depthBuffer&&(j|=256),q.stencilBuffer&&(j|=1024)),pe&&e.framebufferRenderbuffer(36008,36064,36161,Ve.__webglColorRenderbuffer[Me]),Ue===!0&&(e.invalidateFramebuffer(36008,[ze]),e.invalidateFramebuffer(36009,[ze])),pe){let Re=i.get(U[Me]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,Re,0)}e.blitFramebuffer(0,0,ce,xe,0,0,ce,xe,j,9728),f&&e.invalidateFramebuffer(36008,Be)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),pe)for(let Me=0;Me<U.length;Me++){r.bindFramebuffer(36160,Ve.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Me,36161,Ve.__webglColorRenderbuffer[Me]);let Ue=i.get(U[Me]).__webglTexture;r.bindFramebuffer(36160,Ve.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Me,3553,Ue,0)}r.bindFramebuffer(36009,Ve.__webglMultisampledFramebuffer)}}function Se(q){return Math.min(u,q.samples)}function de(q){let U=i.get(q);return o&&q.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&U.__useRenderToTexture!==!1}function be(q){let U=a.render.frame;p.get(q)!==U&&(p.set(q,U),q.update())}function ye(q,U){let ce=q.encoding,xe=q.format,j=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||q.format===IL||ce!==Kl&&(ce===nr?o===!1?t.has("EXT_sRGB")===!0&&xe===ts?(q.format=IL,q.minFilter=dr,q.generateMipmaps=!1):U=Pne.sRGBToLinear(U):(xe!==ts||j!==na)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ce)),U}this.allocateTextureUnit=D,this.resetTextureUnits=O,this.setTexture2D=z,this.setTexture2DArray=F,this.setTexture3D=V,this.setTextureCube=Y,this.rebindTextures=fe,this.setupRenderTarget=me,this.updateRenderTargetMipmap=Oe,this.updateMultisampleRenderTarget=Ee,this.setupDepthRenderbuffer=se,this.setupFrameBufferTexture=ee,this.useMultisampledRTT=de}function J6e(e,t,r){let i=r.isWebGL2;function n(s,a=null){let o;if(s===na)return 5121;if(s===Nje)return 32819;if(s===kje)return 32820;if(s===Dje)return 5120;if(s===Oje)return 5122;if(s===wne)return 5123;if(s===Lje)return 5124;if(s===Uu)return 5125;if(s===Cn)return 5126;if(s===kp)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===zje)return 6406;if(s===ts)return 6408;if(s===Bje)return 6409;if(s===Fje)return 6410;if(s===cp)return 6402;if(s===zp)return 34041;if(s===IL)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===jje)return 6403;if(s===Vje)return 36244;if(s===hA)return 33319;if(s===Uje)return 33320;if(s===_ne)return 36249;if(s===HI||s===WI||s===GI||s===qI)if(a===nr)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===HI)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===WI)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===GI)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===qI)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===HI)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===WI)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===GI)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===qI)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===qH||s===XH||s===YH||s===KH)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===qH)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===XH)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===YH)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===KH)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===$je)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===QH||s===ZH)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===QH)return a===nr?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===ZH)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===JH||s===eW||s===tW||s===rW||s===iW||s===nW||s===sW||s===aW||s===oW||s===lW||s===cW||s===uW||s===dW||s===hW)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===JH)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===eW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===tW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===rW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===iW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===nW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===sW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===aW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===oW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===lW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===cW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===uW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===dW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===hW)return a===nr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===XI)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===XI)return a===nr?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===Hje||s===fW||s===pW||s===mW)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===XI)return o.COMPRESSED_RED_RGTC1_EXT;if(s===fW)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===pW)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===mW)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===lp?i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var eHe=class extends Gs{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},$f=class extends Yr{constructor(){super(),this.isGroup=!0,this.type="Group"}},tHe={type:"move"},xR=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new $f,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new $f,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new L,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new L),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new $f,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new L,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new L),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let p of e.hand.values()){let m=t.getJointPose(p,r),g=this._getHandJoint(l,p);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let c=l.joints["index-finger-tip"],d=l.joints["thumb-tip"],u=c.position.distanceTo(d.position),h=.02,f=.005;l.inputState.pinching&&u>h+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&u<=h-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(tHe)))}return a!==null&&(a.visible=i!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new $f;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},Xv=class extends Li{constructor(e,t,r,i,n,s,a,o,l,c){if(c=c!==void 0?c:cp,c!==cp&&c!==zp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===cp&&(r=Uu),r===void 0&&c===zp&&(r=lp),super(null,i,n,s,a,o,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Hr,this.minFilter=o!==void 0?o:Hr,this.flipY=!1,this.generateMipmaps=!1}},rHe=class extends Ls{constructor(e,t){super();let r=this,i=null,n=1,s=null,a="local-floor",o=1,l=null,c=null,d=null,u=null,h=null,f=null,p=t.getContextAttributes(),m=null,g=null,v=[],y=[],b=new Set,x=new Map,S=new Gs;S.layers.enable(1),S.viewport=new Yt;let w=new Gs;w.layers.enable(2),w.viewport=new Yt;let E=[S,w],C=new eHe;C.layers.enable(1),C.layers.enable(2);let T=null,A=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(F){let V=v[F];return V===void 0&&(V=new xR,v[F]=V),V.getTargetRaySpace()},this.getControllerGrip=function(F){let V=v[F];return V===void 0&&(V=new xR,v[F]=V),V.getGripSpace()},this.getHand=function(F){let V=v[F];return V===void 0&&(V=new xR,v[F]=V),V.getHandSpace()};function M(F){let V=y.indexOf(F.inputSource);if(V===-1)return;let Y=v[V];Y!==void 0&&Y.dispatchEvent({type:F.type,data:F.inputSource})}function P(){i.removeEventListener("select",M),i.removeEventListener("selectstart",M),i.removeEventListener("selectend",M),i.removeEventListener("squeeze",M),i.removeEventListener("squeezestart",M),i.removeEventListener("squeezeend",M),i.removeEventListener("end",P),i.removeEventListener("inputsourceschange",I);for(let F=0;F<v.length;F++){let V=y[F];V!==null&&(y[F]=null,v[F].disconnect(V))}T=null,A=null,e.setRenderTarget(m),h=null,u=null,d=null,i=null,g=null,z.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(F){n=F,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(F){a=F,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(F){l=F},this.getBaseLayer=function(){return u!==null?u:h},this.getBinding=function(){return d},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(F){if(i=F,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",M),i.addEventListener("selectstart",M),i.addEventListener("selectend",M),i.addEventListener("squeeze",M),i.addEventListener("squeezestart",M),i.addEventListener("squeezeend",M),i.addEventListener("end",P),i.addEventListener("inputsourceschange",I),p.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let V={antialias:i.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:n};h=new XRWebGLLayer(i,t,V),i.updateRenderState({baseLayer:h}),g=new Wr(h.framebufferWidth,h.framebufferHeight,{format:ts,type:na,encoding:e.outputEncoding,stencilBuffer:p.stencil})}else{let V=null,Y=null,W=null;p.depth&&(W=p.stencil?35056:33190,V=p.stencil?zp:cp,Y=p.stencil?lp:Uu);let X={colorFormat:32856,depthFormat:W,scaleFactor:n};d=new XRWebGLBinding(i,t),u=d.createProjectionLayer(X),i.updateRenderState({layers:[u]}),g=new Wr(u.textureWidth,u.textureHeight,{format:ts,type:na,depthTexture:new Xv(u.textureWidth,u.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,V),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});let H=e.properties.get(g);H.__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),z.setContext(i),z.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function I(F){for(let V=0;V<F.removed.length;V++){let Y=F.removed[V],W=y.indexOf(Y);W>=0&&(y[W]=null,v[W].disconnect(Y))}for(let V=0;V<F.added.length;V++){let Y=F.added[V],W=y.indexOf(Y);if(W===-1){for(let H=0;H<v.length;H++)if(H>=y.length){y.push(Y),W=H;break}else if(y[H]===null){y[H]=Y,W=H;break}if(W===-1)break}let X=v[W];X&&X.connect(Y)}}let R=new L,N=new L;function k(F,V,Y){R.setFromMatrixPosition(V.matrixWorld),N.setFromMatrixPosition(Y.matrixWorld);let W=R.distanceTo(N),X=V.projectionMatrix.elements,H=Y.projectionMatrix.elements,ie=X[14]/(X[10]-1),Q=X[14]/(X[10]+1),Z=(X[9]+1)/X[5],ee=(X[9]-1)/X[5],re=(X[8]-1)/X[0],ne=(H[8]+1)/H[0],se=ie*re,fe=ie*ne,me=W/(-re+ne),Oe=me*-re;V.matrixWorld.decompose(F.position,F.quaternion,F.scale),F.translateX(Oe),F.translateZ(me),F.matrixWorld.compose(F.position,F.quaternion,F.scale),F.matrixWorldInverse.copy(F.matrixWorld).invert();let Ee=ie+me,Se=Q+me,de=se-Oe,be=fe+(W-Oe),ye=Z*Q/Se*Ee,q=ee*Q/Se*Ee;F.projectionMatrix.makePerspective(de,be,ye,q,Ee,Se)}function O(F,V){V===null?F.matrixWorld.copy(F.matrix):F.matrixWorld.multiplyMatrices(V.matrixWorld,F.matrix),F.matrixWorldInverse.copy(F.matrixWorld).invert()}this.updateCamera=function(F){if(i===null)return;C.near=w.near=S.near=F.near,C.far=w.far=S.far=F.far,(T!==C.near||A!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),T=C.near,A=C.far);let V=F.parent,Y=C.cameras;O(C,V);for(let X=0;X<Y.length;X++)O(Y[X],V);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),F.matrix.copy(C.matrix),F.matrix.decompose(F.position,F.quaternion,F.scale);let W=F.children;for(let X=0,H=W.length;X<H;X++)W[X].updateMatrixWorld(!0);Y.length===2?k(C,S,w):C.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(!(u===null&&h===null))return o},this.setFoveation=function(F){o=F,u!==null&&(u.fixedFoveation=F),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=F)},this.getPlanes=function(){return b};let D=null;function B(F,V){if(c=V.getViewerPose(l||s),f=V,c!==null){let Y=c.views;h!==null&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let W=!1;Y.length!==C.cameras.length&&(C.cameras.length=0,W=!0);for(let X=0;X<Y.length;X++){let H=Y[X],ie=null;if(h!==null)ie=h.getViewport(H);else{let Z=d.getViewSubImage(u,H);ie=Z.viewport,X===0&&(e.setRenderTargetTextures(g,Z.colorTexture,u.ignoreDepthValues?void 0:Z.depthStencilTexture),e.setRenderTarget(g))}let Q=E[X];Q===void 0&&(Q=new Gs,Q.layers.enable(X),Q.viewport=new Yt,E[X]=Q),Q.matrix.fromArray(H.transform.matrix),Q.projectionMatrix.fromArray(H.projectionMatrix),Q.viewport.set(ie.x,ie.y,ie.width,ie.height),X===0&&C.matrix.copy(Q.matrix),W===!0&&C.cameras.push(Q)}}for(let Y=0;Y<v.length;Y++){let W=y[Y],X=v[Y];W!==null&&X!==void 0&&X.update(W,V,l||s)}if(D&&D(F,V),V.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:V.detectedPlanes});let Y=null;for(let W of b)V.detectedPlanes.has(W)||(Y===null&&(Y=[]),Y.push(W));if(Y!==null)for(let W of Y)b.delete(W),x.delete(W),r.dispatchEvent({type:"planeremoved",data:W});for(let W of V.detectedPlanes)if(!b.has(W))b.add(W),x.set(W,V.lastChangedTime),r.dispatchEvent({type:"planeadded",data:W});else{let X=x.get(W);W.lastChangedTime>X&&(x.set(W,W.lastChangedTime),r.dispatchEvent({type:"planechanged",data:W}))}}f=null}let z=new Lne;z.setAnimationLoop(B),this.setAnimationLoop=function(F){D=F},this.dispose=function(){}}};function iHe(e,t){function r(m,g){g.color.getRGB(m.fogColor.value,One(e)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function i(m,g,v,y,b){g.isMeshBasicMaterial||g.isMeshLambertMaterial?n(m,g):g.isMeshToonMaterial?(n(m,g),d(m,g)):g.isMeshPhongMaterial?(n(m,g),c(m,g)):g.isMeshStandardMaterial?(n(m,g),u(m,g),g.isMeshPhysicalMaterial&&h(m,g,b)):g.isMeshMatcapMaterial?(n(m,g),f(m,g)):g.isMeshDepthMaterial?n(m,g):g.isMeshDistanceMaterial?(n(m,g),p(m,g)):g.isMeshNormalMaterial?n(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?o(m,g,v,y):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function n(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===is&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===is&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v=t.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let x=e.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*x}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let b;g.aoMap?b=g.aoMap:g.lightMap&&(b=g.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uv2Transform.value.copy(b.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function o(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let b;g.map?b=g.map:g.alphaMap&&(b=g.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function d(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function u(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),t.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function h(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===is&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function nHe(e,t,r,i){let n={},s={},a=[],o=r.isWebGL2?e.getParameter(35375):0;function l(y,b){let x=b.program;i.uniformBlockBinding(y,x)}function c(y,b){let x=n[y.id];x===void 0&&(p(y),x=d(y),n[y.id]=x,y.addEventListener("dispose",g));let S=b.program;i.updateUBOMapping(y,S);let w=t.render.frame;s[y.id]!==w&&(h(y),s[y.id]=w)}function d(y){let b=u();y.__bindingPointIndex=b;let x=e.createBuffer(),S=y.__size,w=y.usage;return e.bindBuffer(35345,x),e.bufferData(35345,S,w),e.bindBuffer(35345,null),e.bindBufferBase(35345,b,x),x}function u(){for(let y=0;y<o;y++)if(a.indexOf(y)===-1)return a.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(y){let b=n[y.id],x=y.uniforms,S=y.__cache;e.bindBuffer(35345,b);for(let w=0,E=x.length;w<E;w++){let C=x[w];if(f(C,w,S)===!0){let T=C.__offset,A=Array.isArray(C.value)?C.value:[C.value],M=0;for(let P=0;P<A.length;P++){let I=A[P],R=m(I);typeof I=="number"?(C.__data[0]=I,e.bufferSubData(35345,T+M,C.__data)):I.isMatrix3?(C.__data[0]=I.elements[0],C.__data[1]=I.elements[1],C.__data[2]=I.elements[2],C.__data[3]=I.elements[0],C.__data[4]=I.elements[3],C.__data[5]=I.elements[4],C.__data[6]=I.elements[5],C.__data[7]=I.elements[0],C.__data[8]=I.elements[6],C.__data[9]=I.elements[7],C.__data[10]=I.elements[8],C.__data[11]=I.elements[0]):(I.toArray(C.__data,M),M+=R.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,T,C.__data)}}e.bindBuffer(35345,null)}function f(y,b,x){let S=y.value;if(x[b]===void 0){if(typeof S=="number")x[b]=S;else{let w=Array.isArray(S)?S:[S],E=[];for(let C=0;C<w.length;C++)E.push(w[C].clone());x[b]=E}return!0}else if(typeof S=="number"){if(x[b]!==S)return x[b]=S,!0}else{let w=Array.isArray(x[b])?x[b]:[x[b]],E=Array.isArray(S)?S:[S];for(let C=0;C<w.length;C++){let T=w[C];if(T.equals(E[C])===!1)return T.copy(E[C]),!0}}return!1}function p(y){let b=y.uniforms,x=0,S=16,w=0;for(let E=0,C=b.length;E<C;E++){let T=b[E],A={boundary:0,storage:0},M=Array.isArray(T.value)?T.value:[T.value];for(let P=0,I=M.length;P<I;P++){let R=M[P],N=m(R);A.boundary+=N.boundary,A.storage+=N.storage}if(T.__data=new Float32Array(A.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=x,E>0){w=x%S;let P=S-w;w!==0&&P-A.boundary<0&&(x+=S-w,T.__offset=x)}x+=A.storage}return w=x%S,w>0&&(x+=S-w),y.__size=x,y.__cache={},this}function m(y){let b={boundary:0,storage:0};return typeof y=="number"?(b.boundary=4,b.storage=4):y.isVector2?(b.boundary=8,b.storage=8):y.isVector3||y.isColor?(b.boundary=16,b.storage=12):y.isVector4?(b.boundary=16,b.storage=16):y.isMatrix3?(b.boundary=48,b.storage=48):y.isMatrix4?(b.boundary=64,b.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),b}function g(y){let b=y.target;b.removeEventListener("dispose",g);let x=a.indexOf(b.__bindingPointIndex);a.splice(x,1),e.deleteBuffer(n[b.id]),delete n[b.id],delete s[b.id]}function v(){for(let y in n)e.deleteBuffer(n[y]);a=[],n={},s={}}return{bind:l,update:c,dispose:v}}function sHe(){let e=ix("canvas");return e.style.display="block",e}function jne(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:sHe(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,d;r!==null?d=r.getContextAttributes().alpha:d=e.alpha!==void 0?e.alpha:!1;let u=null,h=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Kl,this.physicallyCorrectLights=!1,this.toneMapping=Hc,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,b=null,x=-1,S=null,w=new Yt,E=new Yt,C=null,T=t.width,A=t.height,M=1,P=null,I=null,R=new Yt(0,0,T,A),N=new Yt(0,0,T,A),k=!1,O=new E4,D=!1,B=!1,z=null,F=new Ke,V=new oe,Y=new L,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function X(){return b===null?M:1}let H=r;function ie(te,we){for(let Te=0;Te<te.length;Te++){let ve=te[Te],Le=t.getContext(ve,we);if(Le!==null)return Le}return null}try{let te={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${D0}`),t.addEventListener("webglcontextlost",et,!1),t.addEventListener("webglcontextrestored",Xe,!1),t.addEventListener("webglcontextcreationerror",Ze,!1),H===null){let we=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&we.shift(),H=ie(we,te),H===null)throw ie(we)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}H.getShaderPrecisionFormat===void 0&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(te){throw console.error("THREE.WebGLRenderer: "+te.message),te}let Q,Z,ee,re,ne,se,fe,me,Oe,Ee,Se,de,be,ye,q,U,ce,xe,j,Be,ze,Ve,pe,Me;function Ue(){Q=new y$e(H),Z=new h$e(H,Q,e),Q.init(Z),Ve=new J6e(H,Q,Z),ee=new Q6e(H,Q,Z),re=new w$e,ne=new B6e,se=new Z6e(H,Q,ee,ne,Z,Ve,re),fe=new p$e(m),me=new v$e(m),Oe=new IVe(H,Z),pe=new u$e(H,Q,Oe,Z),Ee=new b$e(H,Oe,re,pe),Se=new C$e(H,Ee,Oe,re),j=new E$e(H,Z,se),U=new f$e(ne),de=new z6e(m,fe,me,Q,Z,pe,U),be=new iHe(m,ne),ye=new j6e,q=new G6e(Q,Z),xe=new c$e(m,fe,me,ee,Se,d,a),ce=new K6e(m,Se,Z),Me=new nHe(H,re,Z,ee),Be=new d$e(H,Q,re,Z),ze=new x$e(H,Q,re,Z),re.programs=de.programs,m.capabilities=Z,m.extensions=Q,m.properties=ne,m.renderLists=ye,m.shadowMap=ce,m.state=ee,m.info=re}Ue();let Re=new rHe(m,H);this.xr=Re,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){let te=Q.get("WEBGL_lose_context");te&&te.loseContext()},this.forceContextRestore=function(){let te=Q.get("WEBGL_lose_context");te&&te.restoreContext()},this.getPixelRatio=function(){return M},this.setPixelRatio=function(te){te!==void 0&&(M=te,this.setSize(T,A,!1))},this.getSize=function(te){return te.set(T,A)},this.setSize=function(te,we,Te){if(Re.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}T=te,A=we,t.width=Math.floor(te*M),t.height=Math.floor(we*M),Te!==!1&&(t.style.width=te+"px",t.style.height=we+"px"),this.setViewport(0,0,te,we)},this.getDrawingBufferSize=function(te){return te.set(T*M,A*M).floor()},this.setDrawingBufferSize=function(te,we,Te){T=te,A=we,M=Te,t.width=Math.floor(te*Te),t.height=Math.floor(we*Te),this.setViewport(0,0,te,we)},this.getCurrentViewport=function(te){return te.copy(w)},this.getViewport=function(te){return te.copy(R)},this.setViewport=function(te,we,Te,ve){te.isVector4?R.set(te.x,te.y,te.z,te.w):R.set(te,we,Te,ve),ee.viewport(w.copy(R).multiplyScalar(M).floor())},this.getScissor=function(te){return te.copy(N)},this.setScissor=function(te,we,Te,ve){te.isVector4?N.set(te.x,te.y,te.z,te.w):N.set(te,we,Te,ve),ee.scissor(E.copy(N).multiplyScalar(M).floor())},this.getScissorTest=function(){return k},this.setScissorTest=function(te){ee.setScissorTest(k=te)},this.setOpaqueSort=function(te){P=te},this.setTransparentSort=function(te){I=te},this.getClearColor=function(te){return te.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(te=!0,we=!0,Te=!0){let ve=0;te&&(ve|=16384),we&&(ve|=256),Te&&(ve|=1024),H.clear(ve)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",et,!1),t.removeEventListener("webglcontextrestored",Xe,!1),t.removeEventListener("webglcontextcreationerror",Ze,!1),ye.dispose(),q.dispose(),ne.dispose(),fe.dispose(),me.dispose(),Se.dispose(),pe.dispose(),Me.dispose(),de.dispose(),Re.dispose(),Re.removeEventListener("sessionstart",Ie),Re.removeEventListener("sessionend",$e),z&&(z.dispose(),z=null),tt.stop()};function et(te){te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Xe(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let te=re.autoReset,we=ce.enabled,Te=ce.autoUpdate,ve=ce.needsUpdate,Le=ce.type;Ue(),re.autoReset=te,ce.enabled=we,ce.autoUpdate=Te,ce.needsUpdate=ve,ce.type=Le}function Ze(te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",te.statusMessage)}function Mt(te){let we=te.target;we.removeEventListener("dispose",Mt),Gt(we)}function Gt(te){ue(te),ne.remove(te)}function ue(te){let we=ne.get(te).programs;we!==void 0&&(we.forEach(function(Te){de.releaseProgram(Te)}),te.isShaderMaterial&&de.releaseShaderCache(te))}this.renderBufferDirect=function(te,we,Te,ve,Le,mt){we===null&&(we=W);let Pt=Le.isMesh&&Le.matrixWorld.determinant()<0,it=xt(te,we,Te,ve,Le);ee.setMaterial(ve,Pt);let qe=Te.index,pt=1;ve.wireframe===!0&&(qe=Ee.getWireframeAttribute(Te),pt=2);let St=Te.drawRange,Ot=Te.attributes.position,Ct=St.start*pt,Br=(St.start+St.count)*pt;mt!==null&&(Ct=Math.max(Ct,mt.start*pt),Br=Math.min(Br,(mt.start+mt.count)*pt)),qe!==null?(Ct=Math.max(Ct,0),Br=Math.min(Br,qe.count)):Ot!=null&&(Ct=Math.max(Ct,0),Br=Math.min(Br,Ot.count));let hi=Br-Ct;if(hi<0||hi===1/0)return;pe.setup(Le,ve,it,Te,qe);let ji,Ar=Be;if(qe!==null&&(ji=Oe.get(qe),Ar=ze,Ar.setIndex(ji)),Le.isMesh)ve.wireframe===!0?(ee.setLineWidth(ve.wireframeLinewidth*X()),Ar.setMode(1)):Ar.setMode(4);else if(Le.isLine){let kt=ve.linewidth;kt===void 0&&(kt=1),ee.setLineWidth(kt*X()),Le.isLineSegments?Ar.setMode(1):Le.isLineLoop?Ar.setMode(2):Ar.setMode(3)}else Le.isPoints?Ar.setMode(0):Le.isSprite&&Ar.setMode(4);if(Le.isInstancedMesh)Ar.renderInstances(Ct,hi,Le.count);else if(Te.isInstancedBufferGeometry){let kt=Te._maxInstanceCount!==void 0?Te._maxInstanceCount:1/0,fn=Math.min(Te.instanceCount,kt);Ar.renderInstances(Ct,hi,fn)}else Ar.render(Ct,hi)},this.compile=function(te,we){function Te(ve,Le,mt){ve.transparent===!0&&ve.side===$a&&ve.forceSinglePass===!1?(ve.side=is,ve.needsUpdate=!0,ut(ve,Le,mt),ve.side=Yl,ve.needsUpdate=!0,ut(ve,Le,mt),ve.side=$a):ut(ve,Le,mt)}h=q.get(te),h.init(),p.push(h),te.traverseVisible(function(ve){ve.isLight&&ve.layers.test(we.layers)&&(h.pushLight(ve),ve.castShadow&&h.pushShadow(ve))}),h.setupLights(m.physicallyCorrectLights),te.traverse(function(ve){let Le=ve.material;if(Le)if(Array.isArray(Le))for(let mt=0;mt<Le.length;mt++){let Pt=Le[mt];Te(Pt,te,ve)}else Te(Le,te,ve)}),p.pop(),h=null};let Ae=null;function ke(te){Ae&&Ae(te)}function Ie(){tt.stop()}function $e(){tt.start()}let tt=new Lne;tt.setAnimationLoop(ke),typeof self<"u"&&tt.setContext(self),this.setAnimationLoop=function(te){Ae=te,Re.setAnimationLoop(te),te===null?tt.stop():tt.start()},Re.addEventListener("sessionstart",Ie),Re.addEventListener("sessionend",$e),this.render=function(te,we){if(we!==void 0&&we.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),we.parent===null&&we.matrixWorldAutoUpdate===!0&&we.updateMatrixWorld(),Re.enabled===!0&&Re.isPresenting===!0&&(Re.cameraAutoUpdate===!0&&Re.updateCamera(we),we=Re.getCamera()),te.isScene===!0&&te.onBeforeRender(m,te,we,b),h=q.get(te,p.length),h.init(),p.push(h),F.multiplyMatrices(we.projectionMatrix,we.matrixWorldInverse),O.setFromProjectionMatrix(F),B=this.localClippingEnabled,D=U.init(this.clippingPlanes,B),u=ye.get(te,f.length),u.init(),f.push(u),He(te,we,0,m.sortObjects),u.finish(),m.sortObjects===!0&&u.sort(P,I),D===!0&&U.beginShadows();let Te=h.state.shadowsArray;if(ce.render(Te,te,we),D===!0&&U.endShadows(),this.info.autoReset===!0&&this.info.reset(),xe.render(u,te),h.setupLights(m.physicallyCorrectLights),we.isArrayCamera){let ve=we.cameras;for(let Le=0,mt=ve.length;Le<mt;Le++){let Pt=ve[Le];gt(u,te,Pt,Pt.viewport)}}else gt(u,te,we);b!==null&&(se.updateMultisampleRenderTarget(b),se.updateRenderTargetMipmap(b)),te.isScene===!0&&te.onAfterRender(m,te,we),pe.resetDefaultState(),x=-1,S=null,p.pop(),p.length>0?h=p[p.length-1]:h=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function He(te,we,Te,ve){if(te.visible===!1)return;if(te.layers.test(we.layers)){if(te.isGroup)Te=te.renderOrder;else if(te.isLOD)te.autoUpdate===!0&&te.update(we);else if(te.isLight)h.pushLight(te),te.castShadow&&h.pushShadow(te);else if(te.isSprite){if(!te.frustumCulled||O.intersectsSprite(te)){ve&&Y.setFromMatrixPosition(te.matrixWorld).applyMatrix4(F);let mt=Se.update(te),Pt=te.material;Pt.visible&&u.push(te,mt,Pt,Te,Y.z,null)}}else if((te.isMesh||te.isLine||te.isPoints)&&(te.isSkinnedMesh&&te.skeleton.frame!==re.render.frame&&(te.skeleton.update(),te.skeleton.frame=re.render.frame),!te.frustumCulled||O.intersectsObject(te))){ve&&Y.setFromMatrixPosition(te.matrixWorld).applyMatrix4(F);let mt=Se.update(te),Pt=te.material;if(Array.isArray(Pt)){let it=mt.groups;for(let qe=0,pt=it.length;qe<pt;qe++){let St=it[qe],Ot=Pt[St.materialIndex];Ot&&Ot.visible&&u.push(te,mt,Ot,Te,Y.z,St)}}else Pt.visible&&u.push(te,mt,Pt,Te,Y.z,null)}}let Le=te.children;for(let mt=0,Pt=Le.length;mt<Pt;mt++)He(Le[mt],we,Te,ve)}function gt(te,we,Te,ve){let Le=te.opaque,mt=te.transmissive,Pt=te.transparent;h.setupLightsView(Te),D===!0&&U.setGlobalState(m.clippingPlanes,Te),mt.length>0&&ot(Le,we,Te),ve&&ee.viewport(w.copy(ve)),Le.length>0&&at(Le,we,Te),mt.length>0&&at(mt,we,Te),Pt.length>0&&at(Pt,we,Te),ee.buffers.depth.setTest(!0),ee.buffers.depth.setMask(!0),ee.buffers.color.setMask(!0),ee.setPolygonOffset(!1)}function ot(te,we,Te){let ve=Z.isWebGL2;z===null&&(z=new Wr(1,1,{generateMipmaps:!0,type:Q.has("EXT_color_buffer_half_float")?kp:na,minFilter:Gv,samples:ve&&s===!0?4:0})),m.getDrawingBufferSize(V),ve?z.setSize(V.x,V.y):z.setSize(vA(V.x),vA(V.y));let Le=m.getRenderTarget();m.setRenderTarget(z),m.clear();let mt=m.toneMapping;m.toneMapping=Hc,at(te,we,Te),m.toneMapping=mt,se.updateMultisampleRenderTarget(z),se.updateRenderTargetMipmap(z),m.setRenderTarget(Le)}function at(te,we,Te){let ve=we.isScene===!0?we.overrideMaterial:null;for(let Le=0,mt=te.length;Le<mt;Le++){let Pt=te[Le],it=Pt.object,qe=Pt.geometry,pt=ve===null?Pt.material:ve,St=Pt.group;it.layers.test(Te.layers)&&Qe(it,we,Te,qe,pt,St)}}function Qe(te,we,Te,ve,Le,mt){te.onBeforeRender(m,we,Te,ve,Le,mt),te.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,te.matrixWorld),te.normalMatrix.getNormalMatrix(te.modelViewMatrix),Le.onBeforeRender(m,we,Te,ve,te,mt),Le.transparent===!0&&Le.side===$a&&Le.forceSinglePass===!1?(Le.side=is,Le.needsUpdate=!0,m.renderBufferDirect(Te,we,ve,Le,te,mt),Le.side=Yl,Le.needsUpdate=!0,m.renderBufferDirect(Te,we,ve,Le,te,mt),Le.side=$a):m.renderBufferDirect(Te,we,ve,Le,te,mt),te.onAfterRender(m,we,Te,ve,Le,mt)}function ut(te,we,Te){we.isScene!==!0&&(we=W);let ve=ne.get(te),Le=h.state.lights,mt=h.state.shadowsArray,Pt=Le.state.version,it=de.getParameters(te,Le.state,mt,we,Te),qe=de.getProgramCacheKey(it),pt=ve.programs;ve.environment=te.isMeshStandardMaterial?we.environment:null,ve.fog=we.fog,ve.envMap=(te.isMeshStandardMaterial?me:fe).get(te.envMap||ve.environment),pt===void 0&&(te.addEventListener("dispose",Mt),pt=new Map,ve.programs=pt);let St=pt.get(qe);if(St!==void 0){if(ve.currentProgram===St&&ve.lightsStateVersion===Pt)return yt(te,it),St}else it.uniforms=de.getUniforms(te),te.onBuild(Te,it,m),te.onBeforeCompile(it,m),St=de.acquireProgram(it,qe),pt.set(qe,St),ve.uniforms=it.uniforms;let Ot=ve.uniforms;(!te.isShaderMaterial&&!te.isRawShaderMaterial||te.clipping===!0)&&(Ot.clippingPlanes=U.uniform),yt(te,it),ve.needsLights=Jt(te),ve.lightsStateVersion=Pt,ve.needsLights&&(Ot.ambientLightColor.value=Le.state.ambient,Ot.lightProbe.value=Le.state.probe,Ot.directionalLights.value=Le.state.directional,Ot.directionalLightShadows.value=Le.state.directionalShadow,Ot.spotLights.value=Le.state.spot,Ot.spotLightShadows.value=Le.state.spotShadow,Ot.rectAreaLights.value=Le.state.rectArea,Ot.ltc_1.value=Le.state.rectAreaLTC1,Ot.ltc_2.value=Le.state.rectAreaLTC2,Ot.pointLights.value=Le.state.point,Ot.pointLightShadows.value=Le.state.pointShadow,Ot.hemisphereLights.value=Le.state.hemi,Ot.directionalShadowMap.value=Le.state.directionalShadowMap,Ot.directionalShadowMatrix.value=Le.state.directionalShadowMatrix,Ot.spotShadowMap.value=Le.state.spotShadowMap,Ot.spotLightMatrix.value=Le.state.spotLightMatrix,Ot.spotLightMap.value=Le.state.spotLightMap,Ot.pointShadowMap.value=Le.state.pointShadowMap,Ot.pointShadowMatrix.value=Le.state.pointShadowMatrix);let Ct=St.getUniforms(),Br=EE.seqWithValue(Ct.seq,Ot);return ve.currentProgram=St,ve.uniformsList=Br,St}function yt(te,we){let Te=ne.get(te);Te.outputEncoding=we.outputEncoding,Te.instancing=we.instancing,Te.skinning=we.skinning,Te.morphTargets=we.morphTargets,Te.morphNormals=we.morphNormals,Te.morphColors=we.morphColors,Te.morphTargetsCount=we.morphTargetsCount,Te.numClippingPlanes=we.numClippingPlanes,Te.numIntersection=we.numClipIntersection,Te.vertexAlphas=we.vertexAlphas,Te.vertexTangents=we.vertexTangents,Te.toneMapping=we.toneMapping}function xt(te,we,Te,ve,Le){we.isScene!==!0&&(we=W),se.resetTextureUnits();let mt=we.fog,Pt=ve.isMeshStandardMaterial?we.environment:null,it=b===null?m.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:Kl,qe=(ve.isMeshStandardMaterial?me:fe).get(ve.envMap||Pt),pt=ve.vertexColors===!0&&!!Te.attributes.color&&Te.attributes.color.itemSize===4,St=!!ve.normalMap&&!!Te.attributes.tangent,Ot=!!Te.morphAttributes.position,Ct=!!Te.morphAttributes.normal,Br=!!Te.morphAttributes.color,hi=ve.toneMapped?m.toneMapping:Hc,ji=Te.morphAttributes.position||Te.morphAttributes.normal||Te.morphAttributes.color,Ar=ji!==void 0?ji.length:0,kt=ne.get(ve),fn=h.state.lights;if(D===!0&&(B===!0||te!==S)){let J=te===S&&ve.id===x;U.setState(ve,te,J)}let qt=!1;ve.version===kt.__version?(kt.needsLights&&kt.lightsStateVersion!==fn.state.version||kt.outputEncoding!==it||Le.isInstancedMesh&&kt.instancing===!1||!Le.isInstancedMesh&&kt.instancing===!0||Le.isSkinnedMesh&&kt.skinning===!1||!Le.isSkinnedMesh&&kt.skinning===!0||kt.envMap!==qe||ve.fog===!0&&kt.fog!==mt||kt.numClippingPlanes!==void 0&&(kt.numClippingPlanes!==U.numPlanes||kt.numIntersection!==U.numIntersection)||kt.vertexAlphas!==pt||kt.vertexTangents!==St||kt.morphTargets!==Ot||kt.morphNormals!==Ct||kt.morphColors!==Br||kt.toneMapping!==hi||Z.isWebGL2===!0&&kt.morphTargetsCount!==Ar)&&(qt=!0):(qt=!0,kt.__version=ve.version);let yi=kt.currentProgram;qt===!0&&(yi=ut(ve,we,Le));let Ns=!1,pn=!1,Ci=!1,$=yi.getUniforms(),K=kt.uniforms;if(ee.useProgram(yi.program)&&(Ns=!0,pn=!0,Ci=!0),ve.id!==x&&(x=ve.id,pn=!0),Ns||S!==te){if($.setValue(H,"projectionMatrix",te.projectionMatrix),Z.logarithmicDepthBuffer&&$.setValue(H,"logDepthBufFC",2/(Math.log(te.far+1)/Math.LN2)),S!==te&&(S=te,pn=!0,Ci=!0),ve.isShaderMaterial||ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshStandardMaterial||ve.envMap){let J=$.map.cameraPosition;J!==void 0&&J.setValue(H,Y.setFromMatrixPosition(te.matrixWorld))}(ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshLambertMaterial||ve.isMeshBasicMaterial||ve.isMeshStandardMaterial||ve.isShaderMaterial)&&$.setValue(H,"isOrthographic",te.isOrthographicCamera===!0),(ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshLambertMaterial||ve.isMeshBasicMaterial||ve.isMeshStandardMaterial||ve.isShaderMaterial||ve.isShadowMaterial||Le.isSkinnedMesh)&&$.setValue(H,"viewMatrix",te.matrixWorldInverse)}if(Le.isSkinnedMesh){$.setOptional(H,Le,"bindMatrix"),$.setOptional(H,Le,"bindMatrixInverse");let J=Le.skeleton;J&&(Z.floatVertexTextures?(J.boneTexture===null&&J.computeBoneTexture(),$.setValue(H,"boneTexture",J.boneTexture,se),$.setValue(H,"boneTextureSize",J.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let le=Te.morphAttributes;if((le.position!==void 0||le.normal!==void 0||le.color!==void 0&&Z.isWebGL2===!0)&&j.update(Le,Te,ve,yi),(pn||kt.receiveShadow!==Le.receiveShadow)&&(kt.receiveShadow=Le.receiveShadow,$.setValue(H,"receiveShadow",Le.receiveShadow)),ve.isMeshGouraudMaterial&&ve.envMap!==null&&(K.envMap.value=qe,K.flipEnvMap.value=qe.isCubeTexture&&qe.isRenderTargetTexture===!1?-1:1),pn&&($.setValue(H,"toneMappingExposure",m.toneMappingExposure),kt.needsLights&&or(K,Ci),mt&&ve.fog===!0&&be.refreshFogUniforms(K,mt),be.refreshMaterialUniforms(K,ve,M,A,z),EE.upload(H,kt.uniformsList,K,se)),ve.isShaderMaterial&&ve.uniformsNeedUpdate===!0&&(EE.upload(H,kt.uniformsList,K,se),ve.uniformsNeedUpdate=!1),ve.isSpriteMaterial&&$.setValue(H,"center",Le.center),$.setValue(H,"modelViewMatrix",Le.modelViewMatrix),$.setValue(H,"normalMatrix",Le.normalMatrix),$.setValue(H,"modelMatrix",Le.matrixWorld),Le.previousModelViewMatrix&&$.setValue(H,"previousModelViewMatrix",Le.previousModelViewMatrix),te.previousProjectionMatrix&&$.setValue(H,"previousProjectionMatrix",te.previousProjectionMatrix),ve.isShaderMaterial||ve.isRawShaderMaterial){let J=ve.uniformsGroups;for(let ge=0,De=J.length;ge<De;ge++)if(Z.isWebGL2){let dt=J[ge];Me.update(dt,yi),Me.bind(dt,yi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return yi}function or(te,we){te.ambientLightColor.needsUpdate=we,te.lightProbe.needsUpdate=we,te.directionalLights.needsUpdate=we,te.directionalLightShadows.needsUpdate=we,te.pointLights.needsUpdate=we,te.pointLightShadows.needsUpdate=we,te.spotLights.needsUpdate=we,te.spotLightShadows.needsUpdate=we,te.rectAreaLights.needsUpdate=we,te.hemisphereLights.needsUpdate=we}function Jt(te){return te.isMeshLambertMaterial||te.isMeshToonMaterial||te.isMeshPhongMaterial||te.isMeshStandardMaterial||te.isShadowMaterial||te.isShaderMaterial&&te.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(te,we,Te){ne.get(te.texture).__webglTexture=we,ne.get(te.depthTexture).__webglTexture=Te;let ve=ne.get(te);ve.__hasExternalTextures=!0,ve.__hasExternalTextures&&(ve.__autoAllocateDepthBuffer=Te===void 0,ve.__autoAllocateDepthBuffer||Q.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ve.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(te,we){let Te=ne.get(te);Te.__webglFramebuffer=we,Te.__useDefaultFramebuffer=we===void 0},this.setRenderTarget=function(te,we=0,Te=0){b=te,v=we,y=Te;let ve=!0,Le=null,mt=!1,Pt=!1;if(te){let it=ne.get(te);it.__useDefaultFramebuffer!==void 0?(ee.bindFramebuffer(36160,null),ve=!1):it.__webglFramebuffer===void 0?se.setupRenderTarget(te):it.__hasExternalTextures&&se.rebindTextures(te,ne.get(te.texture).__webglTexture,ne.get(te.depthTexture).__webglTexture);let qe=te.texture;(qe.isData3DTexture||qe.isDataArrayTexture||qe.isCompressedArrayTexture)&&(Pt=!0);let pt=ne.get(te).__webglFramebuffer;te.isWebGLCubeRenderTarget?(Le=pt[we],mt=!0):Z.isWebGL2&&te.samples>0&&se.useMultisampledRTT(te)===!1?Le=ne.get(te).__webglMultisampledFramebuffer:Le=pt,w.copy(te.viewport),E.copy(te.scissor),C=te.scissorTest}else w.copy(R).multiplyScalar(M).floor(),E.copy(N).multiplyScalar(M).floor(),C=k;if(ee.bindFramebuffer(36160,Le)&&Z.drawBuffers&&ve&&ee.drawBuffers(te,Le),ee.viewport(w),ee.scissor(E),ee.setScissorTest(C),mt){let it=ne.get(te.texture);H.framebufferTexture2D(36160,36064,34069+we,it.__webglTexture,Te)}else if(Pt){let it=ne.get(te.texture),qe=we||0;H.framebufferTextureLayer(36160,36064,it.__webglTexture,Te||0,qe)}x=-1},this.readRenderTargetPixels=function(te,we,Te,ve,Le,mt,Pt){if(!(te&&te.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let it=ne.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&Pt!==void 0&&(it=it[Pt]),it){ee.bindFramebuffer(36160,it);try{let qe=te.texture,pt=qe.format,St=qe.type;if(pt!==ts&&Ve.convert(pt)!==H.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ot=St===kp&&(Q.has("EXT_color_buffer_half_float")||Z.isWebGL2&&Q.has("EXT_color_buffer_float"));if(St!==na&&Ve.convert(St)!==H.getParameter(35738)&&!(St===Cn&&(Z.isWebGL2||Q.has("OES_texture_float")||Q.has("WEBGL_color_buffer_float")))&&!Ot){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}we>=0&&we<=te.width-ve&&Te>=0&&Te<=te.height-Le&&H.readPixels(we,Te,ve,Le,Ve.convert(pt),Ve.convert(St),mt)}finally{let qe=b!==null?ne.get(b).__webglFramebuffer:null;ee.bindFramebuffer(36160,qe)}}},this.copyFramebufferToTexture=function(te,we,Te=0){let ve=Math.pow(2,-Te),Le=Math.floor(we.image.width*ve),mt=Math.floor(we.image.height*ve);se.setTexture2D(we,0),H.copyTexSubImage2D(3553,Te,0,0,te.x,te.y,Le,mt),ee.unbindTexture()},this.copyTextureToTexture=function(te,we,Te,ve=0){let Le=we.image.width,mt=we.image.height,Pt=Ve.convert(Te.format),it=Ve.convert(Te.type);se.setTexture2D(Te,0),H.pixelStorei(37440,Te.flipY),H.pixelStorei(37441,Te.premultiplyAlpha),H.pixelStorei(3317,Te.unpackAlignment),we.isDataTexture?H.texSubImage2D(3553,ve,te.x,te.y,Le,mt,Pt,it,we.image.data):we.isCompressedTexture?H.compressedTexSubImage2D(3553,ve,te.x,te.y,we.mipmaps[0].width,we.mipmaps[0].height,Pt,we.mipmaps[0].data):H.texSubImage2D(3553,ve,te.x,te.y,Pt,it,we.image),ve===0&&Te.generateMipmaps&&H.generateMipmap(3553),ee.unbindTexture()},this.copyTextureToTexture3D=function(te,we,Te,ve,Le=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let mt=te.max.x-te.min.x+1,Pt=te.max.y-te.min.y+1,it=te.max.z-te.min.z+1,qe=Ve.convert(ve.format),pt=Ve.convert(ve.type),St;if(ve.isData3DTexture)se.setTexture3D(ve,0),St=32879;else if(ve.isDataArrayTexture)se.setTexture2DArray(ve,0),St=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}H.pixelStorei(37440,ve.flipY),H.pixelStorei(37441,ve.premultiplyAlpha),H.pixelStorei(3317,ve.unpackAlignment);let Ot=H.getParameter(3314),Ct=H.getParameter(32878),Br=H.getParameter(3316),hi=H.getParameter(3315),ji=H.getParameter(32877),Ar=Te.isCompressedTexture?Te.mipmaps[0]:Te.image;H.pixelStorei(3314,Ar.width),H.pixelStorei(32878,Ar.height),H.pixelStorei(3316,te.min.x),H.pixelStorei(3315,te.min.y),H.pixelStorei(32877,te.min.z),Te.isDataTexture||Te.isData3DTexture?H.texSubImage3D(St,Le,we.x,we.y,we.z,mt,Pt,it,qe,pt,Ar.data):Te.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),H.compressedTexSubImage3D(St,Le,we.x,we.y,we.z,mt,Pt,it,qe,Ar.data)):H.texSubImage3D(St,Le,we.x,we.y,we.z,mt,Pt,it,qe,pt,Ar),H.pixelStorei(3314,Ot),H.pixelStorei(32878,Ct),H.pixelStorei(3316,Br),H.pixelStorei(3315,hi),H.pixelStorei(32877,ji),Le===0&&ve.generateMipmaps&&H.generateMipmap(St),ee.unbindTexture()},this.initTexture=function(te){te.isCubeTexture?se.setTextureCube(te,0):te.isData3DTexture?se.setTexture3D(te,0):te.isDataArrayTexture||te.isCompressedArrayTexture?se.setTexture2DArray(te,0):se.setTexture2D(te,0),ee.unbindTexture()},this.resetState=function(){v=0,y=0,b=null,ee.reset(),pe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var aHe=class extends jne{};aHe.prototype.isWebGL1Renderer=!0;var Vne=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new zt(e),this.near=t,this.far=r}clone(){return new Vne(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Xu=class extends Yr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},oHe=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=PL,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Jo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Jo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Jo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},la=new L,OL=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)la.fromBufferAttribute(this,t),la.applyMatrix4(e),this.setXYZ(t,la.x,la.y,la.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)la.fromBufferAttribute(this,t),la.applyNormalMatrix(e),this.setXYZ(t,la.x,la.y,la.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)la.fromBufferAttribute(this,t),la.transformDirection(e),this.setXYZ(t,la.x,la.y,la.z);return this}setX(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=di(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=$u(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=$u(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=$u(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=$u(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=di(t,this.array),r=di(r,this.array),i=di(i,this.array),n=di(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new Wt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new OL(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Une=class extends Yr{constructor(){super(),this.isBone=!0,this.type="Bone"}},Qo=class extends Li{constructor(e=null,t=1,r=1,i,n,s,a,o,l=Hr,c=Hr,d,u){super(null,s,a,o,l,c,i,n,d,u),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},KW=new Ke,lHe=new Ke,T4=class{constructor(e=[],t=[]){this.uuid=Jo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Ke)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Ke;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:lHe;KW.multiplyMatrices(a,t[n]),KW.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new T4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Ane(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new Qo(t,e,e,ts,Cn);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new Une),this.bones.push(s),this.boneInverses.push(new Ke().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let s=t[i];e.bones.push(s.uuid);let a=r[i];e.boneInverses.push(a.toArray())}return e}},nx=class extends Wt{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},QW=new Ke,ZW=new Ke,j_=[],cHe=new Ke,My=new An,uHe=class extends An{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new nx(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,cHe)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,i=this.count;if(My.geometry=this.geometry,My.material=this.material,My.material!==void 0)for(let n=0;n<i;n++){this.getMatrixAt(n,QW),ZW.multiplyMatrices(r,QW),My.matrixWorld=ZW,My.raycast(e,j_);for(let s=0,a=j_.length;s<a;s++){let o=j_[s];o.instanceId=n,o.object=this,t.push(o)}j_.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new nx(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},tf=class extends gw{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new zt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},JW=new L,e8=new L,t8=new Ke,wR=new O0,V_=new Za,yA=class extends Yr{constructor(e=new Dt,t=new tf){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)JW.fromBufferAttribute(t,i-1),e8.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=JW.distanceTo(e8);e.setAttribute("lineDistance",new vt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),V_.copy(r.boundingSphere),V_.applyMatrix4(i),V_.radius+=n,e.ray.intersectsSphere(V_)===!1)return;t8.copy(i).invert(),wR.copy(e.ray).applyMatrix4(t8);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new L,c=new L,d=new L,u=new L,h=this.isLineSegments?2:1,f=r.index,p=r.attributes.position;if(f!==null){let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=h){let b=f.getX(v),x=f.getX(v+1);if(l.fromBufferAttribute(p,b),c.fromBufferAttribute(p,x),wR.distanceSqToSegment(l,c,u,d)>o)continue;u.applyMatrix4(this.matrixWorld);let S=e.ray.origin.distanceTo(u);S<e.near||S>e.far||t.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=h){if(l.fromBufferAttribute(p,v),c.fromBufferAttribute(p,v+1),wR.distanceSqToSegment(l,c,u,d)>o)continue;u.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(u);b<e.near||b>e.far||t.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},r8=new L,i8=new L,vw=class extends yA{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)r8.fromBufferAttribute(t,i),i8.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+r8.distanceTo(i8);e.setAttribute("lineDistance",new vt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},dHe=class extends Li{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:dr,this.magFilter=n!==void 0?n:dr,this.generateMipmaps=!1;let c=this;function d(){c.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},hHe=class extends Li{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},nu=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,o=n-1,l;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),l=r[i]-s,l<0)a=i+1;else if(l>0)o=i-1;else{o=i;break}if(i=o,r[i]===s)return i/(n-1);let c=r[i],d=r[i+1]-c,u=(s-c)/d;return(i+u)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),a=t||(n.isVector2?new oe:new L);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new L,i=[],n=[],s=[],a=new L,o=new Ke;for(let h=0;h<=e;h++){let f=h/e;i[h]=this.getTangentAt(f,new L)}n[0]=new L,s[0]=new L;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),d=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),d<=l&&(l=d,r.set(0,1,0)),u<=l&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],a),s[0].crossVectors(i[0],n[0]);for(let h=1;h<=e;h++){if(n[h]=n[h-1].clone(),s[h]=s[h-1].clone(),a.crossVectors(i[h-1],i[h]),a.length()>Number.EPSILON){a.normalize();let f=Math.acos(wn(i[h-1].dot(i[h]),-1,1));n[h].applyMatrix4(o.makeRotationAxis(a,f))}s[h].crossVectors(i[h],n[h])}if(t===!0){let h=Math.acos(wn(n[0].dot(n[e]),-1,1));h/=e,i[0].dot(a.crossVectors(n[0],n[e]))>0&&(h=-h);for(let f=1;f<=e;f++)n[f].applyMatrix4(o.makeRotationAxis(i[f],h*f)),s[f].crossVectors(i[f],n[f])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},DM=class extends nu{constructor(e=0,t=0,r=1,i=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new oe,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(s?n=0:n=i),this.aClockwise===!0&&!s&&(n===i?n=-i:n=n-i);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),u=o-this.aX,h=l-this.aY;o=u*c-h*d+this.aX,l=u*d+h*c+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},fHe=class extends DM{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function M4(){let e=0,t=0,r=0,i=0;function n(s,a,o,l){e=s,t=o,r=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){n(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,d,u){let h=(a-s)/c-(o-s)/(c+d)+(o-a)/d,f=(o-a)/d-(l-a)/(d+u)+(l-o)/u;h*=d,f*=d,n(a,o,h,f)},calc:function(s){let a=s*s,o=a*s;return e+t*s+r*a+i*o}}}var U_=new L,_R=new M4,SR=new M4,ER=new M4,pHe=class extends nu{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new L){let r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,c;this.closed||a>0?l=i[(a-1)%n]:(U_.subVectors(i[0],i[1]).add(i[0]),l=U_);let d=i[a%n],u=i[(a+1)%n];if(this.closed||a+2<n?c=i[(a+2)%n]:(U_.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=U_),this.curveType==="centripetal"||this.curveType==="chordal"){let h=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(d),h),p=Math.pow(d.distanceToSquared(u),h),m=Math.pow(u.distanceToSquared(c),h);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),_R.initNonuniformCatmullRom(l.x,d.x,u.x,c.x,f,p,m),SR.initNonuniformCatmullRom(l.y,d.y,u.y,c.y,f,p,m),ER.initNonuniformCatmullRom(l.z,d.z,u.z,c.z,f,p,m)}else this.curveType==="catmullrom"&&(_R.initCatmullRom(l.x,d.x,u.x,c.x,this.tension),SR.initCatmullRom(l.y,d.y,u.y,c.y,this.tension),ER.initCatmullRom(l.z,d.z,u.z,c.z,this.tension));return r.set(_R.calc(o),SR.calc(o),ER.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new L().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function n8(e,t,r,i,n){let s=(i-t)*.5,a=(n-r)*.5,o=e*e,l=e*o;return(2*r-2*i+s+a)*l+(-3*r+3*i-2*s-a)*o+s*e+r}function mHe(e,t){let r=1-e;return r*r*t}function gHe(e,t){return 2*(1-e)*e*t}function vHe(e,t){return e*e*t}function Q1(e,t,r,i){return mHe(e,t)+gHe(e,r)+vHe(e,i)}function yHe(e,t){let r=1-e;return r*r*r*t}function bHe(e,t){let r=1-e;return 3*r*r*e*t}function xHe(e,t){return 3*(1-e)*e*e*t}function wHe(e,t){return e*e*e*t}function Z1(e,t,r,i,n){return yHe(e,t)+bHe(e,r)+xHe(e,i)+wHe(e,n)}var Rl=class extends nu{constructor(e=new oe,t=new oe,r=new oe,i=new oe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new oe){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Z1(e,i.x,n.x,s.x,a.x),Z1(e,i.y,n.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},CE=class extends nu{constructor(e=new L,t=new L,r=new L,i=new L){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new L){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Z1(e,i.x,n.x,s.x,a.x),Z1(e,i.y,n.y,s.y,a.y),Z1(e,i.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Fl=class extends nu{constructor(e=new oe,t=new oe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new oe){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new oe;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},$ne=class extends nu{constructor(e=new L,t=new L){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new L){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Vh=class extends nu{constructor(e=new oe,t=new oe,r=new oe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new oe){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Q1(e,i.x,n.x,s.x),Q1(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},_He=class extends nu{constructor(e=new L,t=new L,r=new L){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new L){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Q1(e,i.x,n.x,s.x),Q1(e,i.y,n.y,s.y),Q1(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},P4=class extends nu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new oe){let r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),a=n-s,o=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],d=i[s>i.length-3?i.length-1:s+2];return r.set(n8(a,o.x,l.x,c.x,d.x),n8(a,o.y,l.y,c.y,d.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new oe().fromArray(i))}return this}},SHe=Object.freeze({__proto__:null,ArcCurve:fHe,CatmullRomCurve3:pHe,CubicBezierCurve:Rl,CubicBezierCurve3:CE,EllipseCurve:DM,LineCurve:Fl,LineCurve3:$ne,QuadraticBezierCurve:Vh,QuadraticBezierCurve3:_He,SplineCurve:P4}),Hne=class extends nu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Fl(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let s=i[n]-r,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let c=o[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new SHe[i.type]().fromJSON(i))}return this}},bA=class extends Hne{constructor(e){super(),this.type="Path",this.currentPoint=new oe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new Fl(this.currentPoint.clone(),new oe(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Vh(this.currentPoint.clone(),new oe(e,t),new oe(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let a=new Rl(this.currentPoint.clone(),new oe(e,t),new oe(r,i),new oe(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new P4(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,s,a,o),this}absellipse(e,t,r,i,n,s,a,o){let l=new DM(e,t,r,i,n,s,a,o);if(this.curves.length>0){let d=l.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Wne=class extends Dt{constructor(e=[new oe(0,-.5),new oe(.5,0),new oe(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=wn(i,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],c=1/t,d=new L,u=new oe,h=new L,f=new L,p=new L,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,h.x=g*1,h.y=-m,h.z=g*0,p.copy(h),h.normalize(),o.push(h.x,h.y,h.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,h.x=g*1,h.y=-m,h.z=g*0,f.copy(h),h.x+=p.x,h.y+=p.y,h.z+=p.z,h.normalize(),o.push(h.x,h.y,h.z),p.copy(f)}for(let v=0;v<=t;v++){let y=r+v*c*i,b=Math.sin(y),x=Math.cos(y);for(let S=0;S<=e.length-1;S++){d.x=e[S].x*b,d.y=e[S].y,d.z=e[S].x*x,s.push(d.x,d.y,d.z),u.x=v/t,u.y=S/(e.length-1),a.push(u.x,u.y);let w=o[3*S+0]*b,E=o[3*S+1],C=o[3*S+0]*x;l.push(w,E,C)}}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){let b=y+v*e.length,x=b,S=b+e.length,w=b+e.length+1,E=b+1;n.push(x,S,E),n.push(w,E,S)}this.setIndex(n),this.setAttribute("position",new vt(s,3)),this.setAttribute("uv",new vt(a,2)),this.setAttribute("normal",new vt(l,3))}static fromJSON(e){return new Wne(e.points,e.segments,e.phiStart,e.phiLength)}},I4=class extends Dt{constructor(e=1,t=1,r=1,i=32,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],d=[],u=[],h=[],f=0,p=[],m=r/2,g=0;v(),s===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new vt(d,3)),this.setAttribute("normal",new vt(u,3)),this.setAttribute("uv",new vt(h,2));function v(){let b=new L,x=new L,S=0,w=(t-e)/r;for(let E=0;E<=n;E++){let C=[],T=E/n,A=T*(t-e)+e;for(let M=0;M<=i;M++){let P=M/i,I=P*o+a,R=Math.sin(I),N=Math.cos(I);x.x=A*R,x.y=-T*r+m,x.z=A*N,d.push(x.x,x.y,x.z),b.set(R,w,N).normalize(),u.push(b.x,b.y,b.z),h.push(P,1-T),C.push(f++)}p.push(C)}for(let E=0;E<i;E++)for(let C=0;C<n;C++){let T=p[C][E],A=p[C+1][E],M=p[C+1][E+1],P=p[C][E+1];c.push(T,A,P),c.push(A,M,P),S+=6}l.addGroup(g,S,0),g+=S}function y(b){let x=f,S=new oe,w=new L,E=0,C=b===!0?e:t,T=b===!0?1:-1;for(let M=1;M<=i;M++)d.push(0,m*T,0),u.push(0,T,0),h.push(.5,.5),f++;let A=f;for(let M=0;M<=i;M++){let P=M/i*o+a,I=Math.cos(P),R=Math.sin(P);w.x=C*R,w.y=m*T,w.z=C*I,d.push(w.x,w.y,w.z),u.push(0,T,0),S.x=I*.5+.5,S.y=R*.5*T+.5,h.push(S.x,S.y),f++}for(let M=0;M<i;M++){let P=x+M,I=A+M;b===!0?c.push(I,I+1,P):c.push(I+1,I,P),E+=3}l.addGroup(g,E,b===!0?1:2),g+=E}}static fromJSON(e){return new I4(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},R4=class extends I4{constructor(e=1,t=1,r=32,i=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,i,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new R4(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},D4=class extends Dt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];a(i),l(r),c(),this.setAttribute("position",new vt(n,3)),this.setAttribute("normal",new vt(n.slice(),3)),this.setAttribute("uv",new vt(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(v){let y=new L,b=new L,x=new L;for(let S=0;S<t.length;S+=3)h(t[S+0],y),h(t[S+1],b),h(t[S+2],x),o(y,b,x,v)}function o(v,y,b,x){let S=x+1,w=[];for(let E=0;E<=S;E++){w[E]=[];let C=v.clone().lerp(b,E/S),T=y.clone().lerp(b,E/S),A=S-E;for(let M=0;M<=A;M++)M===0&&E===S?w[E][M]=C:w[E][M]=C.clone().lerp(T,M/A)}for(let E=0;E<S;E++)for(let C=0;C<2*(S-E)-1;C++){let T=Math.floor(C/2);C%2===0?(u(w[E][T+1]),u(w[E+1][T]),u(w[E][T])):(u(w[E][T+1]),u(w[E+1][T+1]),u(w[E+1][T]))}}function l(v){let y=new L;for(let b=0;b<n.length;b+=3)y.x=n[b+0],y.y=n[b+1],y.z=n[b+2],y.normalize().multiplyScalar(v),n[b+0]=y.x,n[b+1]=y.y,n[b+2]=y.z}function c(){let v=new L;for(let y=0;y<n.length;y+=3){v.x=n[y+0],v.y=n[y+1],v.z=n[y+2];let b=m(v)/2/Math.PI+.5,x=g(v)/Math.PI+.5;s.push(b,1-x)}f(),d()}function d(){for(let v=0;v<s.length;v+=6){let y=s[v+0],b=s[v+2],x=s[v+4],S=Math.max(y,b,x),w=Math.min(y,b,x);S>.9&&w<.1&&(y<.2&&(s[v+0]+=1),b<.2&&(s[v+2]+=1),x<.2&&(s[v+4]+=1))}}function u(v){n.push(v.x,v.y,v.z)}function h(v,y){let b=v*3;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function f(){let v=new L,y=new L,b=new L,x=new L,S=new oe,w=new oe,E=new oe;for(let C=0,T=0;C<n.length;C+=9,T+=6){v.set(n[C+0],n[C+1],n[C+2]),y.set(n[C+3],n[C+4],n[C+5]),b.set(n[C+6],n[C+7],n[C+8]),S.set(s[T+0],s[T+1]),w.set(s[T+2],s[T+3]),E.set(s[T+4],s[T+5]),x.copy(v).add(y).add(b).divideScalar(3);let A=m(x);p(S,T+0,v,A),p(w,T+2,y,A),p(E,T+4,b,A)}}function p(v,y,b,x){x<0&&v.x===1&&(s[y]=v.x-1),b.x===0&&b.z===0&&(s[y]=x/2/Math.PI+.5)}function m(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new D4(e.vertices,e.indices,e.radius,e.details)}},Gne=class extends D4{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Gne(e.radius,e.detail)}},xA=class extends bA{constructor(e){super(e),this.uuid=Jo(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new bA().fromJSON(i))}return this}},EHe={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,s=qne(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,c,d,u,h,f;if(i&&(s=PHe(e,t,s,r)),e.length>80*r){o=c=e[0],l=d=e[1];for(let p=r;p<n;p+=r)u=e[p],h=e[p+1],u<o&&(o=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);f=Math.max(c-o,d-l),f=f!==0?32767/f:0}return sx(s,a,r,o,l,f,0),a}};function qne(e,t,r,i,n){let s,a;if(n===jHe(e,t,r,i)>0)for(s=t;s<r;s+=i)a=s8(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=s8(s,e[s],e[s+1],a);return a&&OM(a,a.next)&&(ox(a),a=a.next),a}function Bp(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(OM(r,r.next)||Di(r.prev,r,r.next)===0)){if(ox(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function sx(e,t,r,i,n,s,a){if(!e)return;!a&&s&&LHe(e,i,n,s);let o=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?AHe(e,i,n,s):CHe(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),ox(e),e=c.next,o=c.next;continue}if(e=c,e===o){a?a===1?(e=THe(Bp(e),t,r),sx(e,t,r,i,n,s,2)):a===2&&MHe(e,t,r,i,n,s):sx(Bp(e),t,r,i,n,s,1);break}}}function CHe(e){let t=e.prev,r=e,i=e.next;if(Di(t,r,i)>=0)return!1;let n=t.x,s=r.x,a=i.x,o=t.y,l=r.y,c=i.y,d=n<s?n<a?n:a:s<a?s:a,u=o<l?o<c?o:c:l<c?l:c,h=n>s?n>a?n:a:s>a?s:a,f=o>l?o>c?o:c:l>c?l:c,p=i.next;for(;p!==t;){if(p.x>=d&&p.x<=h&&p.y>=u&&p.y<=f&&$g(n,o,s,l,a,c,p.x,p.y)&&Di(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function AHe(e,t,r,i){let n=e.prev,s=e,a=e.next;if(Di(n,s,a)>=0)return!1;let o=n.x,l=s.x,c=a.x,d=n.y,u=s.y,h=a.y,f=o<l?o<c?o:c:l<c?l:c,p=d<u?d<h?d:h:u<h?u:h,m=o>l?o>c?o:c:l>c?l:c,g=d>u?d>h?d:h:u>h?u:h,v=LL(f,p,t,r,i),y=LL(m,g,t,r,i),b=e.prevZ,x=e.nextZ;for(;b&&b.z>=v&&x&&x.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==n&&b!==a&&$g(o,d,l,u,c,h,b.x,b.y)&&Di(b.prev,b,b.next)>=0||(b=b.prevZ,x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==n&&x!==a&&$g(o,d,l,u,c,h,x.x,x.y)&&Di(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;b&&b.z>=v;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==n&&b!==a&&$g(o,d,l,u,c,h,b.x,b.y)&&Di(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==n&&x!==a&&$g(o,d,l,u,c,h,x.x,x.y)&&Di(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function THe(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!OM(n,s)&&Xne(n,i,i.next,s)&&ax(n,s)&&ax(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),ox(i),ox(i.next),i=e=s),i=i.next}while(i!==e);return Bp(i)}function MHe(e,t,r,i,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&zHe(a,o)){let l=Yne(a,o);a=Bp(a,a.next),l=Bp(l,l.next),sx(a,t,r,i,n,s,0),sx(l,t,r,i,n,s,0);return}o=o.next}a=a.next}while(a!==e)}function PHe(e,t,r,i){let n=[],s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*i,l=s<a-1?t[s+1]*i:e.length,c=qne(e,o,l,i,!1),c===c.next&&(c.steiner=!0),n.push(kHe(c));for(n.sort(IHe),s=0;s<n.length;s++)r=RHe(n[s],r);return r}function IHe(e,t){return e.x-t.x}function RHe(e,t){let r=DHe(e,t);if(!r)return t;let i=Yne(r,e);return Bp(i,i.next),Bp(r,r.next)}function DHe(e,t){let r=t,i=-1/0,n,s=e.x,a=e.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let h=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=s&&h>i&&(i=h,n=r.x<r.next.x?r:r.next,h===s))return n}r=r.next}while(r!==t);if(!n)return null;let o=n,l=n.x,c=n.y,d=1/0,u;r=n;do s>=r.x&&r.x>=l&&s!==r.x&&$g(a<c?s:i,a,l,c,a<c?i:s,a,r.x,r.y)&&(u=Math.abs(a-r.y)/(s-r.x),ax(r,e)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&OHe(n,r)))&&(n=r,d=u)),r=r.next;while(r!==o);return n}function OHe(e,t){return Di(e.prev,e,t.prev)<0&&Di(t.next,e,e.next)<0}function LHe(e,t,r,i){let n=e;do n.z===0&&(n.z=LL(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,NHe(n)}function NHe(e){let t,r,i,n,s,a,o,l,c=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<c&&(o++,i=i.nextZ,!!i);t++);for(l=c;o>0||l>0&&i;)o!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(a>1);return e}function LL(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function kHe(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function $g(e,t,r,i,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function zHe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!BHe(e,t)&&(ax(e,t)&&ax(t,e)&&FHe(e,t)&&(Di(e.prev,e,t.prev)||Di(e,t.prev,t))||OM(e,t)&&Di(e.prev,e,e.next)>0&&Di(t.prev,t,t.next)>0)}function Di(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function OM(e,t){return e.x===t.x&&e.y===t.y}function Xne(e,t,r,i){let n=H_(Di(e,t,r)),s=H_(Di(e,t,i)),a=H_(Di(r,i,e)),o=H_(Di(r,i,t));return!!(n!==s&&a!==o||n===0&&$_(e,r,t)||s===0&&$_(e,i,t)||a===0&&$_(r,e,i)||o===0&&$_(r,t,i))}function $_(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function H_(e){return e>0?1:e<0?-1:0}function BHe(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Xne(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function ax(e,t){return Di(e.prev,e,e.next)<0?Di(e,t,e.next)>=0&&Di(e,e.prev,t)>=0:Di(e,t,e.prev)<0||Di(e,e.next,t)<0}function FHe(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function Yne(e,t){let r=new NL(e.i,e.x,e.y),i=new NL(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function s8(e,t,r,i){let n=new NL(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function ox(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function NL(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function jHe(e,t,r,i){let n=0;for(let s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var Kne=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return Kne.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];a8(e),o8(r,e);let s=e.length;t.forEach(a8);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,o8(r,t[o]);let a=EHe.triangulate(r,i);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function a8(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function o8(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var Qne=class extends D4{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Qne(e.radius,e.detail)}},ov=class extends Dt{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,c=[],d=new L,u=new L,h=[],f=[],p=[],m=[];for(let g=0;g<=r;g++){let v=[],y=g/r,b=0;g==0&&s==0?b=.5/t:g==r&&o==Math.PI&&(b=-.5/t);for(let x=0;x<=t;x++){let S=x/t;d.x=-e*Math.cos(i+S*n)*Math.sin(s+y*a),d.y=e*Math.cos(s+y*a),d.z=e*Math.sin(i+S*n)*Math.sin(s+y*a),f.push(d.x,d.y,d.z),u.copy(d).normalize(),p.push(u.x,u.y,u.z),m.push(S+b,1-y),v.push(l++)}c.push(v)}for(let g=0;g<r;g++)for(let v=0;v<t;v++){let y=c[g][v+1],b=c[g][v],x=c[g+1][v],S=c[g+1][v+1];(g!==0||s>0)&&h.push(y,b,S),(g!==r-1||o<Math.PI)&&h.push(b,x,S)}this.setIndex(h),this.setAttribute("position",new vt(f,3)),this.setAttribute("normal",new vt(p,3)),this.setAttribute("uv",new vt(m,2))}static fromJSON(e){return new ov(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},Zne=class extends Dt{constructor(e=1,t=.4,r=12,i=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);let s=[],a=[],o=[],l=[],c=new L,d=new L,u=new L;for(let h=0;h<=r;h++)for(let f=0;f<=i;f++){let p=f/i*n,m=h/r*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),a.push(d.x,d.y,d.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(d,c).normalize(),o.push(u.x,u.y,u.z),l.push(f/i),l.push(h/r)}for(let h=1;h<=r;h++)for(let f=1;f<=i;f++){let p=(i+1)*h+f-1,m=(i+1)*(h-1)+f-1,g=(i+1)*(h-1)+f,v=(i+1)*h+f;s.push(p,m,v),s.push(m,g,v)}this.setIndex(s),this.setAttribute("position",new vt(a,3)),this.setAttribute("normal",new vt(o,3)),this.setAttribute("uv",new vt(l,2))}static fromJSON(e){return new Zne(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},Jne=class extends Dt{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],l=[],c=[],d=new L,u=new L,h=new L,f=new L,p=new L,m=new L,g=new L;for(let y=0;y<=r;++y){let b=y/r*n*Math.PI*2;v(b,n,s,e,h),v(b+.01,n,s,e,f),m.subVectors(f,h),g.addVectors(f,h),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let x=0;x<=i;++x){let S=x/i*Math.PI*2,w=-t*Math.cos(S),E=t*Math.sin(S);d.x=h.x+(w*g.x+E*p.x),d.y=h.y+(w*g.y+E*p.y),d.z=h.z+(w*g.z+E*p.z),o.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),l.push(u.x,u.y,u.z),c.push(y/r),c.push(x/i)}}for(let y=1;y<=r;y++)for(let b=1;b<=i;b++){let x=(i+1)*(y-1)+(b-1),S=(i+1)*y+(b-1),w=(i+1)*y+b,E=(i+1)*(y-1)+b;a.push(x,S,E),a.push(S,w,E)}this.setIndex(a),this.setAttribute("position",new vt(o,3)),this.setAttribute("normal",new vt(l,3)),this.setAttribute("uv",new vt(c,2));function v(y,b,x,S,w){let E=Math.cos(y),C=Math.sin(y),T=x/b*y,A=Math.cos(T);w.x=S*(2+A)*.5*E,w.y=S*(2+A)*C*.5,w.z=S*Math.sin(T)*.5}}static fromJSON(e){return new Jne(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function Pd(e,t,r){return ese(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function W_(e,t,r){return!e||!r&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function ese(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function VHe(e){function t(n,s){return e[n]-e[s]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function l8(e,t,r){let i=e.length,n=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let o=r[s]*t;for(let l=0;l!==t;++l)n[a++]=e[o+l]}return n}function tse(e,t,r,i){let n=1,s=e[0];for(;s!==void 0&&s[i]===void 0;)s=e[n++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(t.push(s.time),r.push.apply(r,a)),s=e[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(t.push(s.time),a.toArray(r,r.length)),s=e[n++];while(s!==void 0);else do a=s[i],a!==void 0&&(t.push(s.time),r.push(a)),s=e[n++];while(s!==void 0)}var LM=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let s;r:{i:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(n=i,i=t[++r],e<i)break t}s=t.length;break r}if(!(e>=n)){let a=t[1];e<a&&(r=2,n=a);for(let o=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===o)break;if(i=n,n=t[--r-1],e>=n)break t}s=r,r=0;break r}break e}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let s=0;s!==i;++s)t[s]=r[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},UHe=class extends LM{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:jg,endingEnd:jg}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,s=e+1,a=i[n],o=i[s];if(a===void 0)switch(this.getSettings_().endingStart){case Vg:n=e,a=2*t-r;break;case mA:n=i.length-2,a=t+i[n]-i[n+1];break;default:n=e,a=r}if(o===void 0)switch(this.getSettings_().endingEnd){case Vg:s=e,o=2*r-t;break;case mA:s=1,o=r+i[1]-i[0];break;default:s=e-1,o=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-r),this._offsetPrev=n*c,this._offsetNext=s*c}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,f=(r-t)/(i-t),p=f*f,m=p*f,g=-u*m+2*u*p-u*f,v=(1+u)*m+(-1.5-2*u)*p+(-.5+u)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,b=h*m-h*p;for(let x=0;x!==a;++x)n[x]=g*s[c+x]+v*s[l+x]+y*s[o+x]+b*s[d+x];return n}},rse=class extends LM{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(r-t)/(i-t),d=1-c;for(let u=0;u!==a;++u)n[u]=s[l+u]*d+s[o+u]*c;return n}},$He=class extends LM{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},su=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=W_(t,this.TimeBufferType),this.values=W_(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:W_(e.times,Array),values:W_(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new $He(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new rse(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new UHe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case fA:t=this.InterpolantFactoryMethodDiscrete;break;case pA:t=this.InterpolantFactoryMethodLinear;break;case YI:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return fA;case this.InterpolantFactoryMethodLinear:return pA;case this.InterpolantFactoryMethodSmooth:return YI}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;s!==-1&&r[s]>t;)--s;if(++s,n!==0||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=Pd(r,n,s),this.values=Pd(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let o=r[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(i!==void 0&&ese(i))for(let a=0,o=i.length;a!==o;++a){let l=i[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=Pd(this.times),t=Pd(this.values),r=this.getValueSize(),i=this.getInterpolation()===YI,n=e.length-1,s=1;for(let a=1;a<n;++a){let o=!1,l=e[a],c=e[a+1];if(l!==c&&(a!==1||l!==e[0]))if(i)o=!0;else{let d=a*r,u=d-r,h=d+r;for(let f=0;f!==r;++f){let p=t[d+f];if(p!==t[u+f]||p!==t[h+f]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let d=a*r,u=s*r;for(let h=0;h!==r;++h)t[u+h]=t[d+h]}++s}}if(n>0){e[s]=e[n];for(let a=n*r,o=s*r,l=0;l!==r;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=Pd(e,0,s),this.values=Pd(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=Pd(this.times,0),t=Pd(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};su.prototype.TimeBufferType=Float32Array;su.prototype.ValueBufferType=Float32Array;su.prototype.DefaultInterpolation=pA;var k0=class extends su{};k0.prototype.ValueTypeName="bool";k0.prototype.ValueBufferType=Array;k0.prototype.DefaultInterpolation=fA;k0.prototype.InterpolantFactoryMethodLinear=void 0;k0.prototype.InterpolantFactoryMethodSmooth=void 0;var ise=class extends su{};ise.prototype.ValueTypeName="color";var wA=class extends su{};wA.prototype.ValueTypeName="number";var HHe=class extends LM{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-t)/(i-t),l=e*a;for(let c=l+a;l!==c;l+=4)Xt.slerpFlat(n,0,s,l-a,s,l,o);return n}},yw=class extends su{InterpolantFactoryMethodLinear(e){return new HHe(this.times,this.values,this.getValueSize(),e)}};yw.prototype.ValueTypeName="quaternion";yw.prototype.DefaultInterpolation=pA;yw.prototype.InterpolantFactoryMethodSmooth=void 0;var z0=class extends su{};z0.prototype.ValueTypeName="string";z0.prototype.ValueBufferType=Array;z0.prototype.DefaultInterpolation=fA;z0.prototype.InterpolantFactoryMethodLinear=void 0;z0.prototype.InterpolantFactoryMethodSmooth=void 0;var _A=class extends su{};_A.prototype.ValueTypeName="vector";var kL=class{constructor(e,t=-1,r,i=x4){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Jo(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(GHe(r[s]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=r.length;n!==s;++n)t.push(su.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,s=[];for(let a=0;a<n;a++){let o=[],l=[];o.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let c=VHe(o);o=l8(o,1,c),l=l8(l,1,c),!i&&o[0]===0&&(o.push(n),l.push(l[0])),s.push(new wA(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],c=l.name.match(n);if(c&&c.length>1){let d=c[1],u=i[d];u||(i[d]=u=[]),u.push(l)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,d,u,h,f){if(u.length!==0){let p=[],m=[];tse(u,p,m,h),p.length!==0&&f.push(new c(d,p,m))}},i=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let d=l[c].keys;if(!(!d||d.length===0))if(d[0].morphTargets){let u={},h;for(h=0;h<d.length;h++)if(d[h].morphTargets)for(let f=0;f<d[h].morphTargets.length;f++)u[d[h].morphTargets[f]]=-1;for(let f in u){let p=[],m=[];for(let g=0;g!==d[h].morphTargets.length;++g){let v=d[h];p.push(v.time),m.push(v.morphTarget===f?1:0)}i.push(new wA(".morphTargetInfluence["+f+"]",p,m))}o=u.length*s}else{let u=".bones["+t[c].name+"]";r(_A,u+".position",d,"pos",i),r(yw,u+".quaternion",d,"rot",i),r(_A,u+".scale",d,"scl",i)}}return i.length===0?null:new this(n,o,i,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function WHe(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wA;case"vector":case"vector2":case"vector3":case"vector4":return _A;case"color":return ise;case"quaternion":return yw;case"bool":case"boolean":return k0;case"string":return z0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function GHe(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=WHe(e.type);if(e.times===void 0){let r=[],i=[];tse(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var SA={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},nse=class{constructor(e,t,r){let i=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){a++,n===!1&&i.onStart!==void 0&&i.onStart(c,s,a),n=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,a),s===a&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return o?o(c):c},this.setURLModifier=function(c){return o=c,this},this.addHandler=function(c,d){return l.push(c,d),this},this.removeHandler=function(c){let d=l.indexOf(c);return d!==-1&&l.splice(d,2),this},this.getHandler=function(c){for(let d=0,u=l.length;d<u;d+=2){let h=l[d],f=l[d+1];if(h.global&&(h.lastIndex=0),h.test(c))return f}return null}}},qHe=new nse,bw=class{constructor(e){this.manager=e!==void 0?e:qHe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},mu={},XHe=class extends Error{constructor(e,t){super(e),this.response=t}},zL=class extends bw{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=SA.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(mu[e]!==void 0){mu[e].push({onLoad:t,onProgress:r,onError:i});return}mu[e]=[],mu[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=mu[e],d=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),h=u?parseInt(u):0,f=h!==0,p=0,m=new ReadableStream({start(g){v();function v(){d.read().then(({done:y,value:b})=>{if(y)g.close();else{p+=b.byteLength;let x=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:h});for(let S=0,w=c.length;S<w;S++){let E=c[S];E.onProgress&&E.onProgress(x)}g.enqueue(b),v()}})}}});return new Response(m)}else throw new XHe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return l.json();default:if(a===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(a),d=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(d);return l.arrayBuffer().then(h=>u.decode(h))}}}).then(l=>{SA.add(e,l);let c=mu[e];delete mu[e];for(let d=0,u=c.length;d<u;d++){let h=c[d];h.onLoad&&h.onLoad(l)}}).catch(l=>{let c=mu[e];if(c===void 0)throw this.manager.itemError(e),l;delete mu[e];for(let d=0,u=c.length;d<u;d++){let h=c[d];h.onError&&h.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},YHe=class extends bw{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=SA.get(e);if(s!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let a=ix("img");function o(){c(),SA.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(d){c(),i&&i(d),n.manager.itemError(e),n.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(e),a.src=e,a}},KHe=class extends bw{constructor(e){super(e)}load(e,t,r,i){let n=new Li,s=new YHe(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){n.image=a,n.needsUpdate=!0,t!==void 0&&t(n)},r,i),n}},xw=class extends Yr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new zt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},QHe=class extends xw{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Yr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new zt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},CR=new Ke,c8=new L,u8=new L,O4=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new oe(512,512),this.map=null,this.mapPass=null,this.matrix=new Ke,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new E4,this._frameExtents=new oe(1,1),this._viewportCount=1,this._viewports=[new Yt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;c8.setFromMatrixPosition(e.matrixWorld),t.position.copy(c8),u8.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(u8),t.updateMatrixWorld(),CR.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(CR),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(CR)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},ZHe=class extends O4{constructor(){super(new Gs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=rx*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},JHe=class extends xw{constructor(e,t,r=0,i=Math.PI/3,n=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Yr.DEFAULT_UP),this.updateMatrix(),this.target=new Yr,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new ZHe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},d8=new Ke,Py=new L,AR=new L,eWe=class extends O4{constructor(){super(new Gs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new oe(4,2),this._viewportCount=6,this._viewports=[new Yt(2,1,1,1),new Yt(0,1,1,1),new Yt(3,1,1,1),new Yt(1,1,1,1),new Yt(3,0,1,1),new Yt(1,0,1,1)],this._cubeDirections=[new L(1,0,0),new L(-1,0,0),new L(0,0,1),new L(0,0,-1),new L(0,1,0),new L(0,-1,0)],this._cubeUps=[new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,1,0),new L(0,0,1),new L(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Py.setFromMatrixPosition(e.matrixWorld),r.position.copy(Py),AR.copy(r.position),AR.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(AR),r.updateMatrixWorld(),i.makeTranslation(-Py.x,-Py.y,-Py.z),d8.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(d8)}},tWe=class extends xw{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new eWe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},rWe=class extends O4{constructor(){super(new C4(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},iWe=class extends xw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Yr.DEFAULT_UP),this.updateMatrix(),this.target=new Yr,this.shadow=new rWe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},sse=class extends Dt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},ase=class extends bw{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new zL(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){i?i(o):console.error(o),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(u,h){if(t[h]!==void 0)return t[h];let f=u.interleavedBuffers[h],p=n(u,f.buffer),m=w_(f.type,p),g=new oHe(m,f.stride);return g.uuid=f.uuid,t[h]=g,g}function n(u,h){if(r[h]!==void 0)return r[h];let f=u.arrayBuffers[h],p=new Uint32Array(f).buffer;return r[h]=p,p}let s=e.isInstancedBufferGeometry?new sse:new Dt,a=e.data.index;if(a!==void 0){let u=w_(a.type,a.array);s.setIndex(new Wt(u,1))}let o=e.data.attributes;for(let u in o){let h=o[u],f;if(h.isInterleavedBufferAttribute){let p=i(e.data,h.data);f=new OL(p,h.itemSize,h.offset,h.normalized)}else{let p=w_(h.type,h.array),m=h.isInstancedBufferAttribute?nx:Wt;f=new m(p,h.itemSize,h.normalized)}h.name!==void 0&&(f.name=h.name),h.usage!==void 0&&f.setUsage(h.usage),h.updateRange!==void 0&&(f.updateRange.offset=h.updateRange.offset,f.updateRange.count=h.updateRange.count),s.setAttribute(u,f)}let l=e.data.morphAttributes;if(l)for(let u in l){let h=l[u],f=[];for(let p=0,m=h.length;p<m;p++){let g=h[p],v;if(g.isInterleavedBufferAttribute){let y=i(e.data,g.data);v=new OL(y,g.itemSize,g.offset,g.normalized)}else{let y=w_(g.type,g.array);v=new Wt(y,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),f.push(v)}s.morphAttributes[u]=f}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let u=0,h=c.length;u!==h;++u){let f=c[u];s.addGroup(f.start,f.count,f.materialIndex)}let d=e.data.boundingSphere;if(d!==void 0){let u=new L;d.center!==void 0&&u.fromArray(d.center),s.boundingSphere=new Za(u,d.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},nWe=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=h8(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=h8();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function h8(){return(typeof performance>"u"?Date:performance).now()}var sWe=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,s;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==i;++a)r[n+a]=r[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(r,n,0,a,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let o=t*this._origIndex;this._mixBufferRegion(r,i,o,1-n,t)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(r[o]!==r[o+t]){a.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,s=i;n!==s;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let s=0;s!==n;++s)e[t+s]=e[r+s]}_slerp(e,t,r,i){Xt.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let s=this._workIndex*n;Xt.multiplyQuaternionsFlat(e,s,e,t,e,r),Xt.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,r,i,n){let s=1-i;for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]*s+e[r+a]*i}}_lerpAdditive(e,t,r,i,n){for(let s=0;s!==n;++s){let a=t+s;e[a]=e[a]+e[r+s]*i}}},L4="\\[\\]\\.:\\/",aWe=new RegExp("["+L4+"]","g"),N4="[^"+L4+"]",oWe="[^"+L4.replace("\\.","")+"]",lWe=/((?:WC+[\/:])*)/.source.replace("WC",N4),cWe=/(WCOD+)?/.source.replace("WCOD",oWe),uWe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",N4),dWe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",N4),hWe=new RegExp("^"+lWe+cWe+uWe+dWe+"$"),fWe=["material","materials","bones","map"],pWe=class{constructor(e,t,r){let i=r||oi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},oi=class{constructor(e,t,r){this.path=t,this.parsedPath=r||oi.parseTrackName(t),this.node=oi.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new oi.Composite(e,t,r):new oi(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(aWe,"")}static parseTrackName(e){let t=hWe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);fWe.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let o=r(a.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=oi.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[i];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};oi.Composite=pWe;oi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};oi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};oi.prototype.GetterByBindingType=[oi.prototype._getValue_direct,oi.prototype._getValue_array,oi.prototype._getValue_arrayElement,oi.prototype._getValue_toArray];oi.prototype.SetterByBindingTypeAndVersioning=[[oi.prototype._setValue_direct,oi.prototype._setValue_direct_setNeedsUpdate,oi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[oi.prototype._setValue_array,oi.prototype._setValue_array_setNeedsUpdate,oi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[oi.prototype._setValue_arrayElement,oi.prototype._setValue_arrayElement_setNeedsUpdate,oi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[oi.prototype._setValue_fromArray,oi.prototype._setValue_fromArray_setNeedsUpdate,oi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var mWe=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,s=n.length,a=new Array(s),o={endingStart:jg,endingEnd:jg};for(let l=0;l!==s;++l){let c=n[l].createInterpolant(null);a[l]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ene,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,s=n/i,a=i/n;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=n,o[1]=n+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let o=(e-n)*r;o<0||r===0?t=0:(this._startTime=null,t=r*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case Wje:for(let c=0,d=o.length;c!==d;++c)o[c].evaluate(s),l[c].accumulateAdditive(a);break;case x4:default:for(let c=0,d=o.length;c!==d;++c)o[c].evaluate(s),l[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,s=r===b4;if(e===0)return n===-1?i:s&&(n&1)===1?t-i:i;if(r===Sne){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){let a=Math.floor(i/t);i-=t*a,n+=Math.abs(a);let o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=Vg,i.endingEnd=Vg):(e?i.endingStart=this.zeroSlopeAtStart?Vg:jg:i.endingStart=mA,t?i.endingEnd=this.zeroSlopeAtEnd?Vg:jg:i.endingEnd=mA)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=n,o[0]=t,a[1]=n+e,o[1]=r,this}},gWe=new Float32Array(1),vWe=class extends Ls{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,s=e._propertyBindings,a=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,c=l[o];c===void 0&&(c={},l[o]=c);for(let d=0;d!==n;++d){let u=i[d],h=u.name,f=c[h];if(f!==void 0)++f.referenceCount,s[d]=f;else{if(f=s[d],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,o,h));continue}let p=t&&t._propertyBindings[d].binding.parsedPath;f=new sWe(oi.create(r,h,p),u.ValueTypeName,u.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,o,h),s[d]=f}a[d].resultBuffer=f.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,s=n[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,s=this._actionsByClip,a=s[n],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;let d=a.actionByRoot,u=(e._localRoot||this._root).uuid;delete d[u],o.length===0&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,s=i[t];s===void 0&&(s={},i[t]=s),s[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[n],Object.keys(a).length===0&&delete s[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new rse(new Float32Array(2),new Float32Array(2),1,gWe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,s=typeof e=="string"?kL.findByName(i,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(r===void 0&&(s!==null?r=s.blendMode:r=x4),o!==void 0){let d=o.actionByRoot[n];if(d!==void 0&&d.blendMode===r)return d;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new mWe(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,a,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?kL.findByName(r,e):e,s=n?n.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let s=n.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let c=l._cacheIndex,d=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,d._cacheIndex=c,t[c]=d,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let s in r){let a=r[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let s in n){let a=n[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},Ye=class{constructor(e){this.value=e}clone(){return new Ye(this.value.clone===void 0?this.value:this.value.clone())}},ose=class{constructor(e,t,r=0,i=1/0){this.ray=new O0(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new _4,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return BL(e,this,r,t),r.sort(f8),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)BL(e[i],this,r,t);return r.sort(f8),r}};function f8(e,t){return e.distance-t.distance}function BL(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)BL(n[s],t,r,!0)}}var p8=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(wn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},m8=new oe,lse=class{constructor(e=new oe(1/0,1/0),t=new oe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=m8.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return m8.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},g8=new L,G_=new L,el=class{constructor(e=new L,t=new L){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){g8.subVectors(e,this.start),G_.subVectors(this.end,this.start);let r=G_.dot(G_),i=G_.dot(g8)/r;return t&&(i=wn(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},v8=new L,yWe=class extends Yr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new Dt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,c=a/o*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new vt(i,3));let n=new tf({fog:!1,toneMapped:!1});this.cone=new vw(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),v8.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(v8),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},bWe=class extends An{constructor(e,t,r){let i=new ov(t,4,2),n=new em({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},y8=new L,q_=new L,b8=new L,xWe=class extends Yr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Dt;i.setAttribute("position",new vt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new tf({fog:!1,toneMapped:!1});this.lightPlane=new yA(i,n),this.add(this.lightPlane),i=new Dt,i.setAttribute("position",new vt([0,0,0,0,0,1],3)),this.targetLine=new yA(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),y8.setFromMatrixPosition(this.light.matrixWorld),q_.setFromMatrixPosition(this.light.target.matrixWorld),b8.subVectors(q_,y8),this.lightPlane.lookAt(q_),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(q_),this.targetLine.scale.z=b8.length()}},X_=new L,$i=new tm,EA=class extends vw{constructor(e){let t=new Dt,r=new tf({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(f,p){o(f),o(p)}function o(f){i.push(0,0,0),n.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(i.length/3-1)}t.setAttribute("position",new vt(i,3)),t.setAttribute("color",new vt(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new zt(16755200),c=new zt(16711680),d=new zt(43775),u=new zt(16777215),h=new zt(3355443);this.setColors(l,c,d,u,h)}setColors(e,t,r,i,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;$i.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),en("c",t,e,$i,0,0,-1),en("t",t,e,$i,0,0,1),en("n1",t,e,$i,-r,-i,-1),en("n2",t,e,$i,r,-i,-1),en("n3",t,e,$i,-r,i,-1),en("n4",t,e,$i,r,i,-1),en("f1",t,e,$i,-r,-i,1),en("f2",t,e,$i,r,-i,1),en("f3",t,e,$i,-r,i,1),en("f4",t,e,$i,r,i,1),en("u1",t,e,$i,r*.7,i*1.1,-1),en("u2",t,e,$i,-r*.7,i*1.1,-1),en("u3",t,e,$i,0,i*2,-1),en("cf1",t,e,$i,-r,0,1),en("cf2",t,e,$i,r,0,1),en("cf3",t,e,$i,0,-i,1),en("cf4",t,e,$i,0,i,1),en("cn1",t,e,$i,-r,0,-1),en("cn2",t,e,$i,r,0,-1),en("cn3",t,e,$i,0,-i,-1),en("cn4",t,e,$i,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function en(e,t,r,i,n,s,a){X_.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,d=o.length;c<d;c++)l.setXYZ(o[c],X_.x,X_.y,X_.z)}}var CA=class extends vw{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new Dt;n.setIndex(new Wt(r,1)),n.setAttribute("position",new vt(i,3)),super(n,new tf({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},wWe=class extends vw{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Dt;i.setAttribute("position",new vt(t,3)),i.setAttribute("color",new vt(r,3));let n=new tf({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new zt,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},Lu=_We();function _We(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),i=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let c=l-127;c<-27?(i[l]=0,i[l|256]=32768,n[l]=24,n[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,n[l]=-c-1,n[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,n[l]=13,n[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,n[l]=24,n[l|256]=24):(i[l]=31744,i[l|256]=64512,n[l]=13,n[l|256]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,d=0;for(;!(c&8388608);)c<<=1,d-=8388608;c&=-8388609,d+=947912704,s[l]=c|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:t,uint32View:r,baseTable:i,shiftTable:n,mantissaTable:s,exponentTable:a,offsetTable:o}}function SWe(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=wn(e,-65504,65504),Lu.floatView[0]=e;let t=Lu.uint32View[0],r=t>>23&511;return Lu.baseTable[r]+((t&8388607)>>Lu.shiftTable[r])}function EWe(e){let t=e>>10;return Lu.uint32View[0]=Lu.mantissaTable[Lu.offsetTable[t]+(e&1023)]+Lu.exponentTable[t],Lu.floatView[0]}var CWe=Object.freeze({__proto__:null,fromHalfFloat:EWe,toHalfFloat:SWe});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:D0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=D0);var Iy=".",k4=Symbol("target"),cse=Symbol("unsubscribe");function FL(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function AWe(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Ac=Array.isArray;function z4(e){return typeof e=="symbol"}var TWe={after:(e,t)=>Ac(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Ac(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Iy),z4(t)?e+t.toString():e+t):e,initial:e=>{if(Ac(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Iy);return t===-1?"":e.slice(0,t)},last:e=>{if(Ac(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Iy);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Ac(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(Iy);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(Iy,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},Uo=TWe;function MWe(e){return typeof e=="object"&&typeof e.next=="function"}function PWe(e,t,r,i,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],i),a.value[1]=n(a.value[1],t,a.value[0],i)),a};else if(t.name==="values"){let a=r[k4].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,i)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,i)),a};return e}function x8(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&z4(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var IWe=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Uo.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function jL(e){return toString.call(e)==="[object Object]"}function Y_(){return!0}function Hm(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var use=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),RWe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),dse={push:Y_,pop:Y_,shift:Y_,unshift:Y_,copyWithin:Hm,reverse:Hm,sort:Hm,splice:Hm,flat:Hm,fill:Hm},DWe=new Set([...use,...RWe,...Object.keys(dse)]);function K_(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var hse=["keys","values","entries"],fse=new Set(["has","toString"]),pse={add:K_,clear:K_,delete:K_,forEach:K_},OWe=new Set([...fse,...Object.keys(pse),...hse]);function Q_(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var LWe=new Set([...fse,"get"]),mse={set:Q_,clear:Q_,delete:Q_,forEach:Q_},NWe=new Set([...LWe,...Object.keys(mse),...hse]),Uh=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return use.has(e)}_shallowClone(e){let t=e;if(jL(e))t={...e};else if(Ac(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(Ac(i)?this._onIsChanged=dse[t]:i instanceof Set?this._onIsChanged=pse[t]:i instanceof Map&&(this._onIsChanged=mse[t]),i):r}update(e,t,r){let i=Uo.after(e,this._path);if(t!=="length"){let n=this.clone;Uo.walk(i,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],Uo.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},w8=class extends Uh{static isHandledMethod(e){return DWe.has(e)}},kWe=class extends Uh{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},_8=class extends Uh{static isHandledMethod(e){return OWe.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},S8=class extends Uh{static isHandledMethod(e){return NWe.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},zWe=class extends Uh{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},BWe=class extends Uh{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},vg=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return jL(e)||Ac(e)||FL(e)}static isHandledMethod(e,t){return jL(e)?Uh.isHandledMethod(t):Ac(e)?w8.isHandledMethod(t):e instanceof Set?_8.isHandledMethod(t):e instanceof Map?S8.isHandledMethod(t):FL(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=Uh;Ac(e)?i=w8:e instanceof Date?i=kWe:e instanceof Set?i=_8:e instanceof Map?i=S8:e instanceof WeakSet?i=zWe:e instanceof WeakMap&&(i=BWe),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=vg.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},FWe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},B4=(e,t,r={})=>{r={...FWe,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=r,l=new IWe(n),c=typeof r.onValidate=="function",d=new vg(c),u=(y,b,x,S,w)=>!c||d.isCloning||r.onValidate(Uo.concat(l.getPath(y),b),x,S,w)===!0,h=(y,b,x,S)=>{!x8(l,r,b)&&!(a&&l.isDetached(y,e))&&f(l.getPath(y),b,x,S)},f=(y,b,x,S,w)=>{d.isCloning?d.update(y,b,S):t(Uo.concat(y,b),x,S,w)},p=y=>y&&(y[i]||y),m=(y,b,x,S)=>AWe(y)||x==="constructor"||s&&!vg.isHandledMethod(b,x)||x8(l,r,x)||l.isGetInvariant(b,x)||a&&l.isDetached(b,e)?y:(S===void 0&&(S=l.getPath(b)),l.getProxy(y,Uo.concat(S,x),g,i)),g={get(y,b,x){if(z4(b)){if(b===i||b===k4)return y;if(b===cse&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let S=FL(y)?Reflect.get(y,b):Reflect.get(y,b,x);return m(S,y,b)},set(y,b,x,S){x=p(x);let w=y[i]||y,E=w[b];if(n(E,x)&&b in y)return!0;let C=u(y,b,x,E);return C&&l.setProperty(w,b,x,S,E)?(h(y,b,y[b],E),!0):!C},defineProperty(y,b,x){if(!l.isSameDescriptor(x,y,b)){let S=y[b];u(y,b,x.value,S)&&l.defineProperty(y,b,x,S)&&h(y,b,x.value,S)}return!0},deleteProperty(y,b){if(!Reflect.has(y,b))return!0;let x=Reflect.get(y,b),S=u(y,b,void 0,x);return S&&l.deleteProperty(y,b,x)?(h(y,b,void 0,x),!0):!S},apply(y,b,x){let S=b[i]||b;if(l.isUnsubscribed)return Reflect.apply(y,S,x);if((o===!1||o!==!0&&!o.includes(y.name))&&vg.isHandledType(S)){let w=Uo.initial(l.getPath(y)),E=vg.isHandledMethod(S,y.name);d.start(S,w,x);let C=Reflect.apply(y,d.preferredThisArg(y,b,S),E?x.map(M=>p(M)):x),T=d.isChanged(S,n),A=d.stop();if(vg.isHandledType(C)&&E&&(b instanceof Map&&y.name==="get"&&(w=Uo.concat(w,x[0])),C=l.getProxy(C,w,g)),T){let M={name:y.name,args:x,result:C},P=d.isCloning?Uo.initial(w):w,I=d.isCloning?Uo.last(w):"";u(Uo.get(e,P),I,S,A,M)?f(P,I,S,A,M):d.undo(S)}return(b instanceof Map||b instanceof Set)&&MWe(C)?PWe(C,y,b,w,m):C}return Reflect.apply(y,b,x)}},v=l.getProxy(e,r.pathAsArray?[]:"",g);return t=t.bind(v),c&&(r.onValidate=r.onValidate.bind(v)),v};B4.target=e=>e&&e[k4]||e;B4.unsubscribe=e=>e[cse]||e;var E8=B4,jWe=typeof global=="object"&&global&&global.Object===Object&&global,gse=jWe,VWe=typeof self=="object"&&self&&self.Object===Object&&self,UWe=gse||VWe||Function("return this")(),ec=UWe,$We=ec.Symbol,sl=$We,vse=Object.prototype,HWe=vse.hasOwnProperty,WWe=vse.toString,Ry=sl?sl.toStringTag:void 0;function GWe(e){var t=HWe.call(e,Ry),r=e[Ry];try{e[Ry]=void 0;var i=!0}catch{}var n=WWe.call(e);return i&&(t?e[Ry]=r:delete e[Ry]),n}var qWe=GWe,XWe=Object.prototype,YWe=XWe.toString;function KWe(e){return YWe.call(e)}var QWe=KWe,ZWe="[object Null]",JWe="[object Undefined]",C8=sl?sl.toStringTag:void 0;function e8e(e){return e==null?e===void 0?JWe:ZWe:C8&&C8 in Object(e)?qWe(e):QWe(e)}var im=e8e;function t8e(e){return e!=null&&typeof e=="object"}var ud=t8e,r8e="[object Symbol]";function i8e(e){return typeof e=="symbol"||ud(e)&&im(e)==r8e}var NM=i8e;function n8e(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var yse=n8e,s8e=Array.isArray,Zc=s8e,a8e=1/0,A8=sl?sl.prototype:void 0,T8=A8?A8.toString:void 0;function bse(e){if(typeof e=="string")return e;if(Zc(e))return yse(e,bse)+"";if(NM(e))return T8?T8.call(e):"";var t=e+"";return t=="0"&&1/e==-a8e?"-0":t}var o8e=bse,l8e=/\s/;function c8e(e){for(var t=e.length;t--&&l8e.test(e.charAt(t)););return t}var u8e=c8e,d8e=/^\s+/;function h8e(e){return e&&e.slice(0,u8e(e)+1).replace(d8e,"")}var f8e=h8e;function p8e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Zl=p8e,M8=0/0,m8e=/^[-+]0x[0-9a-f]+$/i,g8e=/^0b[01]+$/i,v8e=/^0o[0-7]+$/i,y8e=parseInt;function b8e(e){if(typeof e=="number")return e;if(NM(e))return M8;if(Zl(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Zl(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=f8e(e);var r=g8e.test(e);return r||v8e.test(e)?y8e(e.slice(2),r?2:8):m8e.test(e)?M8:+e}var P8=b8e;function x8e(e){return e}var w8e=x8e,_8e="[object AsyncFunction]",S8e="[object Function]",E8e="[object GeneratorFunction]",C8e="[object Proxy]";function A8e(e){if(!Zl(e))return!1;var t=im(e);return t==S8e||t==E8e||t==_8e||t==C8e}var xse=A8e,T8e=ec["__core-js_shared__"],TR=T8e,I8=function(){var e=/[^.]+$/.exec(TR&&TR.keys&&TR.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function M8e(e){return!!I8&&I8 in e}var P8e=M8e,I8e=Function.prototype,R8e=I8e.toString;function D8e(e){if(e!=null){try{return R8e.call(e)}catch{}try{return e+""}catch{}}return""}var nm=D8e,O8e=/[\\^$.*+?()[\]{}|]/g,L8e=/^\[object .+?Constructor\]$/,N8e=Function.prototype,k8e=Object.prototype,z8e=N8e.toString,B8e=k8e.hasOwnProperty,F8e=RegExp("^"+z8e.call(B8e).replace(O8e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function j8e(e){if(!Zl(e)||P8e(e))return!1;var t=xse(e)?F8e:L8e;return t.test(nm(e))}var V8e=j8e;function U8e(e,t){return e==null?void 0:e[t]}var $8e=U8e;function H8e(e,t){var r=$8e(e,t);return V8e(r)?r:void 0}var sm=H8e,W8e=sm(ec,"WeakMap"),VL=W8e,R8=Object.create,G8e=function(){function e(){}return function(t){if(!Zl(t))return{};if(R8)return R8(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),q8e=G8e;function X8e(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Y8e=X8e;function K8e(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var Q8e=K8e,Z8e=800,J8e=16,eGe=Date.now;function tGe(e){var t=0,r=0;return function(){var i=eGe(),n=J8e-(i-r);if(r=i,n>0){if(++t>=Z8e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var rGe=tGe;function iGe(e){return function(){return e}}var nGe=iGe,sGe=function(){try{var e=sm(Object,"defineProperty");return e({},"",{}),e}catch{}}(),AA=sGe,aGe=AA?function(e,t){return AA(e,"toString",{configurable:!0,enumerable:!1,value:nGe(t),writable:!0})}:w8e,oGe=aGe,lGe=rGe(oGe),cGe=lGe;function uGe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var dGe=uGe,hGe=9007199254740991,fGe=/^(?:0|[1-9]\d*)$/;function pGe(e,t){var r=typeof e;return t=t??hGe,!!t&&(r=="number"||r!="symbol"&&fGe.test(e))&&e>-1&&e%1==0&&e<t}var F4=pGe;function mGe(e,t,r){t=="__proto__"&&AA?AA(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var wse=mGe;function gGe(e,t){return e===t||e!==e&&t!==t}var j4=gGe,vGe=Object.prototype,yGe=vGe.hasOwnProperty;function bGe(e,t,r){var i=e[t];(!(yGe.call(e,t)&&j4(i,r))||r===void 0&&!(t in e))&&wse(e,t,r)}var V4=bGe;function xGe(e,t,r,i){var n=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),n?wse(r,o,l):V4(r,o,l)}return r}var ww=xGe,D8=Math.max;function wGe(e,t,r){return t=D8(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=D8(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=r(a),Y8e(e,this,o)}}var _Ge=wGe,SGe=9007199254740991;function EGe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=SGe}var U4=EGe;function CGe(e){return e!=null&&U4(e.length)&&!xse(e)}var _se=CGe,AGe=Object.prototype;function TGe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||AGe;return e===r}var $4=TGe;function MGe(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var PGe=MGe,IGe="[object Arguments]";function RGe(e){return ud(e)&&im(e)==IGe}var O8=RGe,Sse=Object.prototype,DGe=Sse.hasOwnProperty,OGe=Sse.propertyIsEnumerable,LGe=O8(function(){return arguments}())?O8:function(e){return ud(e)&&DGe.call(e,"callee")&&!OGe.call(e,"callee")},H4=LGe;function NGe(){return!1}var kGe=NGe,Ese=typeof exports=="object"&&exports&&!exports.nodeType&&exports,L8=Ese&&typeof module=="object"&&module&&!module.nodeType&&module,zGe=L8&&L8.exports===Ese,N8=zGe?ec.Buffer:void 0,BGe=N8?N8.isBuffer:void 0,FGe=BGe||kGe,TA=FGe,jGe="[object Arguments]",VGe="[object Array]",UGe="[object Boolean]",$Ge="[object Date]",HGe="[object Error]",WGe="[object Function]",GGe="[object Map]",qGe="[object Number]",XGe="[object Object]",YGe="[object RegExp]",KGe="[object Set]",QGe="[object String]",ZGe="[object WeakMap]",JGe="[object ArrayBuffer]",e9e="[object DataView]",t9e="[object Float32Array]",r9e="[object Float64Array]",i9e="[object Int8Array]",n9e="[object Int16Array]",s9e="[object Int32Array]",a9e="[object Uint8Array]",o9e="[object Uint8ClampedArray]",l9e="[object Uint16Array]",c9e="[object Uint32Array]",xi={};xi[t9e]=xi[r9e]=xi[i9e]=xi[n9e]=xi[s9e]=xi[a9e]=xi[o9e]=xi[l9e]=xi[c9e]=!0;xi[jGe]=xi[VGe]=xi[JGe]=xi[UGe]=xi[e9e]=xi[$Ge]=xi[HGe]=xi[WGe]=xi[GGe]=xi[qGe]=xi[XGe]=xi[YGe]=xi[KGe]=xi[QGe]=xi[ZGe]=!1;function u9e(e){return ud(e)&&U4(e.length)&&!!xi[im(e)]}var d9e=u9e;function h9e(e){return function(t){return e(t)}}var W4=h9e,Cse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,J1=Cse&&typeof module=="object"&&module&&!module.nodeType&&module,f9e=J1&&J1.exports===Cse,MR=f9e&&gse.process,p9e=function(){try{var e=J1&&J1.require&&J1.require("util").types;return e||MR&&MR.binding&&MR.binding("util")}catch{}}(),Yv=p9e,k8=Yv&&Yv.isTypedArray,m9e=k8?W4(k8):d9e,Ase=m9e,g9e=Object.prototype,v9e=g9e.hasOwnProperty;function y9e(e,t){var r=Zc(e),i=!r&&H4(e),n=!r&&!i&&TA(e),s=!r&&!i&&!n&&Ase(e),a=r||i||n||s,o=a?PGe(e.length,String):[],l=o.length;for(var c in e)(t||v9e.call(e,c))&&!(a&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||F4(c,l)))&&o.push(c);return o}var Tse=y9e;function b9e(e,t){return function(r){return e(t(r))}}var Mse=b9e,x9e=Mse(Object.keys,Object),w9e=x9e,_9e=Object.prototype,S9e=_9e.hasOwnProperty;function E9e(e){if(!$4(e))return w9e(e);var t=[];for(var r in Object(e))S9e.call(e,r)&&r!="constructor"&&t.push(r);return t}var C9e=E9e;function A9e(e){return _se(e)?Tse(e):C9e(e)}var G4=A9e;function T9e(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var M9e=T9e,P9e=Object.prototype,I9e=P9e.hasOwnProperty;function R9e(e){if(!Zl(e))return M9e(e);var t=$4(e),r=[];for(var i in e)i=="constructor"&&(t||!I9e.call(e,i))||r.push(i);return r}var D9e=R9e;function O9e(e){return _se(e)?Tse(e,!0):D9e(e)}var Hf=O9e,L9e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,N9e=/^\w*$/;function k9e(e,t){if(Zc(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||NM(e)?!0:N9e.test(e)||!L9e.test(e)||t!=null&&e in Object(t)}var z9e=k9e,B9e=sm(Object,"create"),lx=B9e;function F9e(){this.__data__=lx?lx(null):{},this.size=0}var j9e=F9e;function V9e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var U9e=V9e,$9e="__lodash_hash_undefined__",H9e=Object.prototype,W9e=H9e.hasOwnProperty;function G9e(e){var t=this.__data__;if(lx){var r=t[e];return r===$9e?void 0:r}return W9e.call(t,e)?t[e]:void 0}var q9e=G9e,X9e=Object.prototype,Y9e=X9e.hasOwnProperty;function K9e(e){var t=this.__data__;return lx?t[e]!==void 0:Y9e.call(t,e)}var Q9e=K9e,Z9e="__lodash_hash_undefined__";function J9e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=lx&&t===void 0?Z9e:t,this}var e7e=J9e;function B0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}B0.prototype.clear=j9e;B0.prototype.delete=U9e;B0.prototype.get=q9e;B0.prototype.has=Q9e;B0.prototype.set=e7e;var z8=B0;function t7e(){this.__data__=[],this.size=0}var r7e=t7e;function i7e(e,t){for(var r=e.length;r--;)if(j4(e[r][0],t))return r;return-1}var kM=i7e,n7e=Array.prototype,s7e=n7e.splice;function a7e(e){var t=this.__data__,r=kM(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():s7e.call(t,r,1),--this.size,!0}var o7e=a7e;function l7e(e){var t=this.__data__,r=kM(t,e);return r<0?void 0:t[r][1]}var c7e=l7e;function u7e(e){return kM(this.__data__,e)>-1}var d7e=u7e;function h7e(e,t){var r=this.__data__,i=kM(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var f7e=h7e;function F0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}F0.prototype.clear=r7e;F0.prototype.delete=o7e;F0.prototype.get=c7e;F0.prototype.has=d7e;F0.prototype.set=f7e;var zM=F0,p7e=sm(ec,"Map"),cx=p7e;function m7e(){this.size=0,this.__data__={hash:new z8,map:new(cx||zM),string:new z8}}var g7e=m7e;function v7e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var y7e=v7e;function b7e(e,t){var r=e.__data__;return y7e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var BM=b7e;function x7e(e){var t=BM(this,e).delete(e);return this.size-=t?1:0,t}var w7e=x7e;function _7e(e){return BM(this,e).get(e)}var S7e=_7e;function E7e(e){return BM(this,e).has(e)}var C7e=E7e;function A7e(e,t){var r=BM(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var T7e=A7e;function j0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}j0.prototype.clear=g7e;j0.prototype.delete=w7e;j0.prototype.get=S7e;j0.prototype.has=C7e;j0.prototype.set=T7e;var FM=j0,M7e="Expected a function";function q4(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(M7e);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a)||s,a};return r.cache=new(q4.Cache||FM),r}q4.Cache=FM;var P7e=q4,I7e=500;function R7e(e){var t=P7e(e,function(i){return r.size===I7e&&r.clear(),i}),r=t.cache;return t}var D7e=R7e,O7e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,L7e=/\\(\\)?/g,N7e=D7e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(O7e,function(r,i,n,s){t.push(n?s.replace(L7e,"$1"):i||r)}),t}),k7e=N7e;function z7e(e){return e==null?"":o8e(e)}var B7e=z7e;function F7e(e,t){return Zc(e)?e:z9e(e,t)?[e]:k7e(B7e(e))}var V0=F7e,j7e=1/0;function V7e(e){if(typeof e=="string"||NM(e))return e;var t=e+"";return t=="0"&&1/e==-j7e?"-0":t}var jM=V7e;function U7e(e,t){t=V0(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[jM(t[r++])];return r&&r==i?e:void 0}var Pse=U7e;function $7e(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var X4=$7e,B8=sl?sl.isConcatSpreadable:void 0;function H7e(e){return Zc(e)||H4(e)||!!(B8&&e&&e[B8])}var W7e=H7e;function Ise(e,t,r,i,n){var s=-1,a=e.length;for(r||(r=W7e),n||(n=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?Ise(o,t-1,r,i,n):X4(n,o):i||(n[n.length]=o)}return n}var G7e=Ise;function q7e(e){var t=e==null?0:e.length;return t?G7e(e,1):[]}var X7e=q7e;function Y7e(e){return cGe(_Ge(e,void 0,X7e),e+"")}var Rse=Y7e,K7e=Mse(Object.getPrototypeOf,Object),Y4=K7e,Q7e="[object Object]",Z7e=Function.prototype,J7e=Object.prototype,Dse=Z7e.toString,eqe=J7e.hasOwnProperty,tqe=Dse.call(Object);function rqe(e){if(!ud(e)||im(e)!=Q7e)return!1;var t=Y4(e);if(t===null)return!0;var r=eqe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Dse.call(r)==tqe}var iqe=rqe;function nqe(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}var sqe=nqe;function aqe(){this.__data__=new zM,this.size=0}var oqe=aqe;function lqe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var cqe=lqe;function uqe(e){return this.__data__.get(e)}var dqe=uqe;function hqe(e){return this.__data__.has(e)}var fqe=hqe,pqe=200;function mqe(e,t){var r=this.__data__;if(r instanceof zM){var i=r.__data__;if(!cx||i.length<pqe-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new FM(i)}return r.set(e,t),this.size=r.size,this}var gqe=mqe;function U0(e){var t=this.__data__=new zM(e);this.size=t.size}U0.prototype.clear=oqe;U0.prototype.delete=cqe;U0.prototype.get=dqe;U0.prototype.has=fqe;U0.prototype.set=gqe;var AE=U0;function vqe(e,t){return e&&ww(t,G4(t),e)}var yqe=vqe;function bqe(e,t){return e&&ww(t,Hf(t),e)}var xqe=bqe,Ose=typeof exports=="object"&&exports&&!exports.nodeType&&exports,F8=Ose&&typeof module=="object"&&module&&!module.nodeType&&module,wqe=F8&&F8.exports===Ose,j8=wqe?ec.Buffer:void 0,V8=j8?j8.allocUnsafe:void 0;function _qe(e,t){if(t)return e.slice();var r=e.length,i=V8?V8(r):new e.constructor(r);return e.copy(i),i}var Sqe=_qe;function Eqe(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}var Cqe=Eqe;function Aqe(){return[]}var Lse=Aqe,Tqe=Object.prototype,Mqe=Tqe.propertyIsEnumerable,U8=Object.getOwnPropertySymbols,Pqe=U8?function(e){return e==null?[]:(e=Object(e),Cqe(U8(e),function(t){return Mqe.call(e,t)}))}:Lse,K4=Pqe;function Iqe(e,t){return ww(e,K4(e),t)}var Rqe=Iqe,Dqe=Object.getOwnPropertySymbols,Oqe=Dqe?function(e){for(var t=[];e;)X4(t,K4(e)),e=Y4(e);return t}:Lse,Nse=Oqe;function Lqe(e,t){return ww(e,Nse(e),t)}var Nqe=Lqe;function kqe(e,t,r){var i=t(e);return Zc(e)?i:X4(i,r(e))}var kse=kqe;function zqe(e){return kse(e,G4,K4)}var UL=zqe;function Bqe(e){return kse(e,Hf,Nse)}var zse=Bqe,Fqe=sm(ec,"DataView"),$L=Fqe,jqe=sm(ec,"Promise"),HL=jqe,Vqe=sm(ec,"Set"),WL=Vqe,$8="[object Map]",Uqe="[object Object]",H8="[object Promise]",W8="[object Set]",G8="[object WeakMap]",q8="[object DataView]",$qe=nm($L),Hqe=nm(cx),Wqe=nm(HL),Gqe=nm(WL),qqe=nm(VL),Sf=im;($L&&Sf(new $L(new ArrayBuffer(1)))!=q8||cx&&Sf(new cx)!=$8||HL&&Sf(HL.resolve())!=H8||WL&&Sf(new WL)!=W8||VL&&Sf(new VL)!=G8)&&(Sf=function(e){var t=im(e),r=t==Uqe?e.constructor:void 0,i=r?nm(r):"";if(i)switch(i){case $qe:return q8;case Hqe:return $8;case Wqe:return H8;case Gqe:return W8;case qqe:return G8}return t});var ux=Sf,Xqe=Object.prototype,Yqe=Xqe.hasOwnProperty;function Kqe(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Yqe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Qqe=Kqe,Zqe=ec.Uint8Array,MA=Zqe;function Jqe(e){var t=new e.constructor(e.byteLength);return new MA(t).set(new MA(e)),t}var Q4=Jqe;function eXe(e,t){var r=t?Q4(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var tXe=eXe,rXe=/\w*$/;function iXe(e){var t=new e.constructor(e.source,rXe.exec(e));return t.lastIndex=e.lastIndex,t}var nXe=iXe,X8=sl?sl.prototype:void 0,Y8=X8?X8.valueOf:void 0;function sXe(e){return Y8?Object(Y8.call(e)):{}}var aXe=sXe;function oXe(e,t){var r=t?Q4(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var lXe=oXe,cXe="[object Boolean]",uXe="[object Date]",dXe="[object Map]",hXe="[object Number]",fXe="[object RegExp]",pXe="[object Set]",mXe="[object String]",gXe="[object Symbol]",vXe="[object ArrayBuffer]",yXe="[object DataView]",bXe="[object Float32Array]",xXe="[object Float64Array]",wXe="[object Int8Array]",_Xe="[object Int16Array]",SXe="[object Int32Array]",EXe="[object Uint8Array]",CXe="[object Uint8ClampedArray]",AXe="[object Uint16Array]",TXe="[object Uint32Array]";function MXe(e,t,r){var i=e.constructor;switch(t){case vXe:return Q4(e);case cXe:case uXe:return new i(+e);case yXe:return tXe(e,r);case bXe:case xXe:case wXe:case _Xe:case SXe:case EXe:case CXe:case AXe:case TXe:return lXe(e,r);case dXe:return new i;case hXe:case mXe:return new i(e);case fXe:return nXe(e);case pXe:return new i;case gXe:return aXe(e)}}var PXe=MXe;function IXe(e){return typeof e.constructor=="function"&&!$4(e)?q8e(Y4(e)):{}}var RXe=IXe,DXe="[object Map]";function OXe(e){return ud(e)&&ux(e)==DXe}var LXe=OXe,K8=Yv&&Yv.isMap,NXe=K8?W4(K8):LXe,kXe=NXe,zXe="[object Set]";function BXe(e){return ud(e)&&ux(e)==zXe}var FXe=BXe,Q8=Yv&&Yv.isSet,jXe=Q8?W4(Q8):FXe,VXe=jXe,UXe=1,$Xe=2,HXe=4,Bse="[object Arguments]",WXe="[object Array]",GXe="[object Boolean]",qXe="[object Date]",XXe="[object Error]",Fse="[object Function]",YXe="[object GeneratorFunction]",KXe="[object Map]",QXe="[object Number]",jse="[object Object]",ZXe="[object RegExp]",JXe="[object Set]",eYe="[object String]",tYe="[object Symbol]",rYe="[object WeakMap]",iYe="[object ArrayBuffer]",nYe="[object DataView]",sYe="[object Float32Array]",aYe="[object Float64Array]",oYe="[object Int8Array]",lYe="[object Int16Array]",cYe="[object Int32Array]",uYe="[object Uint8Array]",dYe="[object Uint8ClampedArray]",hYe="[object Uint16Array]",fYe="[object Uint32Array]",fi={};fi[Bse]=fi[WXe]=fi[iYe]=fi[nYe]=fi[GXe]=fi[qXe]=fi[sYe]=fi[aYe]=fi[oYe]=fi[lYe]=fi[cYe]=fi[KXe]=fi[QXe]=fi[jse]=fi[ZXe]=fi[JXe]=fi[eYe]=fi[tYe]=fi[uYe]=fi[dYe]=fi[hYe]=fi[fYe]=!0;fi[XXe]=fi[Fse]=fi[rYe]=!1;function TE(e,t,r,i,n,s){var a,o=t&UXe,l=t&$Xe,c=t&HXe;if(r&&(a=n?r(e,i,n,s):r(e)),a!==void 0)return a;if(!Zl(e))return e;var d=Zc(e);if(d){if(a=Qqe(e),!o)return Q8e(e,a)}else{var u=ux(e),h=u==Fse||u==YXe;if(TA(e))return Sqe(e,o);if(u==jse||u==Bse||h&&!n){if(a=l||h?{}:RXe(e),!o)return l?Nqe(e,xqe(a,e)):Rqe(e,yqe(a,e))}else{if(!fi[u])return n?e:{};a=PXe(e,u,o)}}s||(s=new AE);var f=s.get(e);if(f)return f;s.set(e,a),VXe(e)?e.forEach(function(g){a.add(TE(g,t,r,g,e,s))}):kXe(e)&&e.forEach(function(g,v){a.set(v,TE(g,t,r,v,e,s))});var p=c?l?zse:UL:l?Hf:G4,m=d?void 0:p(e);return dGe(m||e,function(g,v){m&&(v=g,g=e[v]),V4(a,v,TE(g,t,r,v,e,s))}),a}var Vse=TE,pYe=1,mYe=4;function gYe(e){return Vse(e,pYe|mYe)}var VM=gYe,vYe="__lodash_hash_undefined__";function yYe(e){return this.__data__.set(e,vYe),this}var bYe=yYe;function xYe(e){return this.__data__.has(e)}var wYe=xYe;function PA(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new FM;++t<r;)this.add(e[t])}PA.prototype.add=PA.prototype.push=bYe;PA.prototype.has=wYe;var _Ye=PA;function SYe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var EYe=SYe;function CYe(e,t){return e.has(t)}var AYe=CYe,TYe=1,MYe=2;function PYe(e,t,r,i,n,s){var a=r&TYe,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),d=s.get(t);if(c&&d)return c==t&&d==e;var u=-1,h=!0,f=r&MYe?new _Ye:void 0;for(s.set(e,t),s.set(t,e);++u<o;){var p=e[u],m=t[u];if(i)var g=a?i(m,p,u,t,e,s):i(p,m,u,e,t,s);if(g!==void 0){if(g)continue;h=!1;break}if(f){if(!EYe(t,function(v,y){if(!AYe(f,y)&&(p===v||n(p,v,r,i,s)))return f.push(y)})){h=!1;break}}else if(!(p===m||n(p,m,r,i,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var Use=PYe;function IYe(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var RYe=IYe;function DYe(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var OYe=DYe,LYe=1,NYe=2,kYe="[object Boolean]",zYe="[object Date]",BYe="[object Error]",FYe="[object Map]",jYe="[object Number]",VYe="[object RegExp]",UYe="[object Set]",$Ye="[object String]",HYe="[object Symbol]",WYe="[object ArrayBuffer]",GYe="[object DataView]",Z8=sl?sl.prototype:void 0,PR=Z8?Z8.valueOf:void 0;function qYe(e,t,r,i,n,s,a){switch(r){case GYe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case WYe:return!(e.byteLength!=t.byteLength||!s(new MA(e),new MA(t)));case kYe:case zYe:case jYe:return j4(+e,+t);case BYe:return e.name==t.name&&e.message==t.message;case VYe:case $Ye:return e==t+"";case FYe:var o=RYe;case UYe:var l=i&LYe;if(o||(o=OYe),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=NYe,a.set(e,t);var d=Use(o(e),o(t),i,n,s,a);return a.delete(e),d;case HYe:if(PR)return PR.call(e)==PR.call(t)}return!1}var XYe=qYe,YYe=1,KYe=Object.prototype,QYe=KYe.hasOwnProperty;function ZYe(e,t,r,i,n,s){var a=r&YYe,o=UL(e),l=o.length,c=UL(t),d=c.length;if(l!=d&&!a)return!1;for(var u=l;u--;){var h=o[u];if(!(a?h in t:QYe.call(t,h)))return!1}var f=s.get(e),p=s.get(t);if(f&&p)return f==t&&p==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=a;++u<l;){h=o[u];var v=e[h],y=t[h];if(i)var b=a?i(y,v,h,t,e,s):i(v,y,h,e,t,s);if(!(b===void 0?v===y||n(v,y,r,i,s):b)){m=!1;break}g||(g=h=="constructor")}if(m&&!g){var x=e.constructor,S=t.constructor;x!=S&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof S=="function"&&S instanceof S)&&(m=!1)}return s.delete(e),s.delete(t),m}var JYe=ZYe,eKe=1,J8="[object Arguments]",eG="[object Array]",Z_="[object Object]",tKe=Object.prototype,tG=tKe.hasOwnProperty;function rKe(e,t,r,i,n,s){var a=Zc(e),o=Zc(t),l=a?eG:ux(e),c=o?eG:ux(t);l=l==J8?Z_:l,c=c==J8?Z_:c;var d=l==Z_,u=c==Z_,h=l==c;if(h&&TA(e)){if(!TA(t))return!1;a=!0,d=!1}if(h&&!d)return s||(s=new AE),a||Ase(e)?Use(e,t,r,i,n,s):XYe(e,t,l,r,i,n,s);if(!(r&eKe)){var f=d&&tG.call(e,"__wrapped__"),p=u&&tG.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,g=p?t.value():t;return s||(s=new AE),n(m,g,r,i,s)}}return h?(s||(s=new AE),JYe(e,t,r,i,n,s)):!1}var iKe=rKe;function $se(e,t,r,i,n){return e===t?!0:e==null||t==null||!ud(e)&&!ud(t)?e!==e&&t!==t:iKe(e,t,r,i,$se,n)}var nKe=$se;function sKe(e,t){return e!=null&&t in Object(e)}var aKe=sKe;function oKe(e,t,r){t=V0(t,e);for(var i=-1,n=t.length,s=!1;++i<n;){var a=jM(t[i]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++i!=n?s:(n=e==null?0:e.length,!!n&&U4(n)&&F4(a,n)&&(Zc(e)||H4(e)))}var lKe=oKe;function cKe(e,t){return e!=null&&lKe(e,t,aKe)}var uKe=cKe,dKe=function(){return ec.Date.now()},IR=dKe,hKe="Expected a function",fKe=Math.max,pKe=Math.min;function mKe(e,t,r){var i,n,s,a,o,l,c=0,d=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(hKe);t=P8(t)||0,Zl(r)&&(d=!!r.leading,u="maxWait"in r,s=u?fKe(P8(r.maxWait)||0,t):s,h="trailing"in r?!!r.trailing:h);function f(w){var E=i,C=n;return i=n=void 0,c=w,a=e.apply(C,E),a}function p(w){return c=w,o=setTimeout(v,t),d?f(w):a}function m(w){var E=w-l,C=w-c,T=t-E;return u?pKe(T,s-C):T}function g(w){var E=w-l,C=w-c;return l===void 0||E>=t||E<0||u&&C>=s}function v(){var w=IR();if(g(w))return y(w);o=setTimeout(v,m(w))}function y(w){return o=void 0,h&&i?f(w):(i=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function x(){return o===void 0?a:y(IR())}function S(){var w=IR(),E=g(w);if(i=arguments,n=this,l=w,E){if(o===void 0)return p(l);if(u)return clearTimeout(o),o=setTimeout(v,t),f(l)}return o===void 0&&(o=setTimeout(v,t)),a}return S.cancel=b,S.flush=x,S}var Z4=mKe;function gKe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var vKe=gKe;function yKe(e,t){return t.length<2?e:Pse(e,sqe(t,0,-1))}var bKe=yKe;function xKe(e,t){return nKe(e,t)}var Hse=xKe;function wKe(e,t){return t=V0(t,e),e=bKe(e,t),e==null||delete e[jM(vKe(t))]}var _Ke=wKe;function SKe(e){return iqe(e)?void 0:e}var EKe=SKe,CKe=1,AKe=2,TKe=4,MKe=Rse(function(e,t){var r={};if(e==null)return r;var i=!1;t=yse(t,function(s){return s=V0(s,e),i||(i=s.length>1),s}),ww(e,zse(e),r),i&&(r=Vse(r,CKe|AKe|TKe,EKe));for(var n=t.length;n--;)_Ke(r,t[n]);return r}),GL=MKe;function PKe(e,t,r,i){if(!Zl(e))return e;t=V0(t,e);for(var n=-1,s=t.length,a=s-1,o=e;o!=null&&++n<s;){var l=jM(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=a){var d=o[l];c=i?i(d,l,o):void 0,c===void 0&&(c=Zl(d)?d:F4(t[n+1])?[]:{})}V4(o,l,c),o=o[l]}return e}var IKe=PKe;function RKe(e,t,r){for(var i=-1,n=t.length,s={};++i<n;){var a=t[i],o=Pse(e,a);r(o,a)&&IKe(s,V0(a,e),o)}return s}var DKe=RKe;function OKe(e,t){return DKe(e,t,function(r,i){return uKe(e,i)})}var LKe=OKe,NKe=Rse(function(e,t){return e==null?{}:LKe(e,t)}),Yu=NKe,kKe="Expected a function";function zKe(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(kKe);return Zl(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),Z4(e,t,{leading:i,maxWait:t,trailing:n})}var BKe=zKe;function Wse(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function Jc(e,t){return Object.setPrototypeOf(e,t),e}var FKe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),jKe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),VKe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||UM&&"ontouchend"in document,UKe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,$Ke=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,HKe=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},WKe=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},GKe=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},qKe=FKe();qKe&&GKe();var UM=jKe(),J4=VKe(),XKe=UKe(),mo=$Ke(),rG=HKe(),iG=Number(WKe());function Gse(e){return Array.isArray(e)?e:[e]}function qse(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function J_(e){return UM?e.metaKey:e.ctrlKey}function YKe(e){return e.wheelDeltaY===0||e.deltaY===0?UM&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var Ut=[],IA={},p1={},ME={};function Xse(e){Ut.includes(e)||Ut.push(e)}function lv(e){delete IA[e.pointerId];for(let t=0;t<Ut.length;t++)if(Ut[t].pointerId===e.pointerId){Ut.splice(t,1);break}}function KKe(){Ut.splice(0,Ut.length)}function RA(e){if(e.pointerType!=="touch")return;let t=IA[e.pointerId];t===void 0&&(t={x:0,y:0},IA[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function RR(e){let t=e.pointerId===Ut[0].pointerId?Ut[1]:Ut[0];return IA[t.pointerId]}function Yse(e){p1[e.key]=!0,ME[e.key]=ME[e.key]===void 0?1:ME[e.key]+1}function Kse(e){if(UM&&p1.Meta)for(let t in p1)p1[t]=!1;else p1[e.key]=!1;ME={}}function QKe(e){e.addEventListener("pointerdown",Xse,!0),e.addEventListener("pointerdown",RA,!0),e.addEventListener("pointermove",RA,!0),e.addEventListener("pointerup",lv,!0),e.addEventListener("pointercancel",lv,!0),e.addEventListener("pointerleave",lv,!0),window.addEventListener("keydown",Yse,!0),window.addEventListener("keyup",Kse,!0)}function ZKe(e){e.removeEventListener("pointerdown",Xse,!0),e.removeEventListener("pointerdown",RA,!0),e.removeEventListener("pointermove",RA,!0),e.removeEventListener("pointerup",lv,!0),e.removeEventListener("pointercancel",lv,!0),e.removeEventListener("pointerleave",lv,!0),window.removeEventListener("keydown",Yse,!0),window.removeEventListener("keyup",Kse,!0)}var Qse,JKe=new Promise(e=>{Qse=e}),eS;function eQe(){if(eS)return eS;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@1.0.28/build",r=R0(()=>import("./navmesh-0b92f809.js"),[],import.meta.url),[i,n]=await Promise.all([r,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});Qse(a)}return eS=e(),eS}var Zse,tQe=new Promise(e=>{Zse=e}),tS;function rQe(){if(tS)return tS;async function e(){let t=await R0(()=>import("./physics-dee4de67.js"),[],import.meta.url);await t.init(),Zse(t)}return tS=e(),tS}var Zt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,Zt.prototype),i}}add(e,t){var r;return((r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:s}=e,a={...t,[n]:s};return Object.setPrototypeOf(a,Zt.prototype),{data:a,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,Zt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function ej(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&ej(i)}return Object.freeze(e)}function iQe(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var Jse=class extends Error{};function DR(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function oh(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let i=[],n=1/(r+1);for(let s=0;s<r;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;i.push(a)}return i}function tj(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function nQe(){return typeof process<"u"}function eae(e,t){for(let r of e)t(r.id,r.data)!==!0&&eae(r.children,t)}function tae(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)tae(r,t)}var _s=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,_s.prototype)}deepFreeze(){let t=0;for(;t<this.length;)ej(this[t]),t++}fillCaches0(t,r){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,r);for(let i of t.children)this.fillCaches0(i,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,r){if(!this.has(t))return!0;for(;t;){let i=this.parent(t);if(i===r)return!0;t=i}return!1}rootAcestor(t){for(;t;){let r=this.parent(t);if(r)t=r;else return t}return t}isDescendantOf(t,r){for(;t;){let i=this.parent(t);if(i===r)return!0;t=i}return!1}data(t){var r;return(r=this.get(t))==null?void 0:r.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var r;return t===null?this:(r=this.get(t))==null?void 0:r.children}traverseFrom(t,r){if(t===null)this.traverse(r);else{let i=this.get(t);i&&tae(i,r)}}traverse(t){eae(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,r){if(this.get(t)===void 0)throw new Error("not expected");{let i=this.parent(t),n=this.childrenArray(i),s=n.findIndex(o=>o.id===t);if(s<0)throw new Error("not expected");let a=n[s];return n=[...n],n[s]={...a,data:r},this.modifyArrayBy(i,n)}}modifyArrayBy(t,r){let i=t,n=r;for(;i!==null;){let a=n,o=i;if(i=this.parent(i),i===void 0)throw new Error;n=this.childrenArray(i);let l=n.findIndex(c=>c.id===o);if(l<0)throw new Error;n=[...n],n[l]={...n[l],children:a}}Object.setPrototypeOf(n,_s.prototype);let s=n;return s.fillCaches(),s}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:r}){if(this.get(t)!==void 0)return!0;for(let i of r)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(t){let{parent:r,fi:i,id:n,data:s,children:a}=t;if(r!==null&&this.get(r)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=r,l=this.childrenArray(o),c={fi:i,id:n,data:s,children:a};return l=[...l,c],l.sort((d,u)=>d.fi-u.fi),t.localIndex=l.indexOf(c),{data:this.modifyArrayBy(o,l),actual:t,reverse:{type:8,id:n}}}}deleteOp(t){let{id:r}=t;if(this.get(r)===null)return null;{let i=this.parent(r);if(i===void 0)return null;let n=this.childrenArray(i),s=n.findIndex(o=>o.id===r);t.localIndex=s,n=[...n];let a=n.splice(s,1)[0];return{data:this.modifyArrayBy(i,n),actual:t,reverse:{type:7,...a,parent:i}}}}moveOp(t){let{parent:r,fi:i,id:n}=t;if(r!==null&&this.get(r)===void 0)return this.deleteOp({type:8,id:n});if(r!==null){let h=r;for(;h!==null;){if(h===void 0)throw new Error;if(h===n)throw new Jse("cyclic tree");h=this.parent(h)}}let s=this.parent(n);if(s===void 0)return null;let a=s,o=this.childrenArray(s),l=o.findIndex(h=>h.id===n);o=[...o];let c=o.splice(l,1)[0],d=this.modifyArrayBy(s,o);s=r,o=d.childrenArray(s);let u=c.fi;return c={...c,fi:i},o=[...o,c],o.sort((h,f)=>h.fi-f.fi),t.localIndex=o.indexOf(c),d=d.modifyArrayBy(s,o),{data:d,actual:t,reverse:{type:9,parent:a,fi:u,id:n}}}previous(t,r){if(r===null){let n=this.childrenArray(t);return n.length===0?null:n[n.length-1].id}let i=null;for(let n of this.childrenArray(t)){if(n.id===r)return i;i=n.id}return null}traverseSortNext(t){let r=this.parent(t);if(r!==void 0){let i=this.childrenArray(r),n=i.findIndex(s=>s.id===t)+1;if(n<i.length)return i[n].id;if(r)return this.traverseSortNext(r)}}sortNext(t){let r=this.childrenArray(t);return r.length>0?r[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let r=this.childrenArray(t);return r.length>0?this.traverseSortPrevious(r[r.length-1].id):t}sortPrevious(t){let r=this.parent(t);if(r!==void 0){let i=this.childrenArray(r),n=i.findIndex(s=>s.id===t)-1;return n>=0?this.traverseSortPrevious(i[n].id):r}}getAllSorted(t){let r=[];for(let i of t){let n=this.getWithSortKey(i.id);n!==void 0&&r.push({...i,...n})}r.sort((i,n)=>iQe(i.sortKey,n.sortKey));for(let i of r)delete i.sortKey;return r}getWithSortKey(t){var r=t;let i=[],n=this.get(r),s=n;if(n!==void 0){for(;r;)i.splice(0,0,n.fi),r=this.parent(r),r!==null&&(n=this.get(r));return{...s,sortKey:i}}}insertBeforeHelper(t,r,i){return this.insertAfterHelper(t,this.previous(t,r),i)}insertAfterHelper(t,r,i){let n=this.childrenArray(t);if(r===null){if(n.length===0)return oh(0,i,i);{let s=n[0].fi;return oh(s-i,s,i)}}else{let s=this.get(r);if(s===void 0||this.parent(r)!==t)throw new Error("illegal args");let a=n.find(o=>o.fi>s.fi);if(a===void 0){let o=n[n.length-1].fi;return oh(o,o+i,i)}else return oh(s.fi,a.fi,i)}}},DA;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,s={},a=[...r],o=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=a[c],a[c]=n[l],o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}else{let n=i.props,s={},a={...r},o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let c=n[l];c===void 0?delete a[l]:a[l]=c,o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}}e.runOp=t})(DA||(DA={}));var Nt=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Nt.prototype)}deepFreeze(){let e=0;for(;e<this.length;)ej(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(s=>s.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,Nt.prototype);let t=e;return nQe()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,s={fi:t,id:r,data:i};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(s=>s.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(o=>o.id===r);if(n===-1)return null;let s=i[n].fi,a={...i[n],fi:t};return i[n]=a,i.sort((o,l)=>o.fi-l.fi),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return oh(0,t,t);{let i=r[0].fi;return oh(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(s=>s.fi>i.fi);if(n===void 0){let s=r[r.length-1].fi;return oh(s,s+t,t)}else return oh(i.fi,n.fi,t)}}};function Kv(e){return e&&typeof e=="object"&&e instanceof Mn}var Mn=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!Kv(r))return null;i+=1}r=r?DR(r):new Mn;for(let[o,l]of Object.entries(e.props)){let c=r[o];n[o]=c,l===void 0?delete r[o]:r[o]=l}for(;i>0;){if(Object.keys(r).length===0){let o=t[i-1];o&&(r=DR(o),delete r[e.path[i-1]])}else{let o=t[i-1];if(o){let l=DR(o);l[e.path[i-1]]=r,r=l}else{let l=new Mn;l[e.path[i-1]]=r,r=l}}i-=1}let s=Object.setPrototypeOf(r,Mn.prototype),a={...e,props:n};return{data:s,actual:e,reverse:a}}},Ph;(e=>{function t(n,s){return dx(n,s)??n}e.apply=t;function r(n,s){return ij(n,s)}e.merge=r;function i(n,s){let a=0,o=s.path,l=n;for(;a<o.length&&l!==void 0;){if(l=ws.zoomOnce(l,o[a]),l===void 0)return s;if(!Kv(l))return;a+=1}if(l===void 0)return s;if(Kv(l))if(s.type===0){let c={...s.props};for(let d of Object.keys(l))delete c[d];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=rj([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=i})(Ph||(Ph={}));function rj(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=dx(n.data,t[s]);if(r=r||a!==void 0,a===void 0&&(a=n.data),n.children){let o=rj(n.children,t);return o!==void 0?r=!0:o=n.children,{...n,id:s,data:a,children:o}}else return{...n,id:s,data:a}});if(r)return i}function sQe(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=dx(n.data,t[s]);return r=r||a!==void 0,a===void 0&&(a=n.data),{...n,id:s,data:a}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function dx(e,t){if(!Kv(t))return t;if(e instanceof _s){let r=rj(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof Nt)return sQe(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,s)=>{let a=dx(n,t[s]);return r=r||a!==void 0,a===void 0&&(a=n),a});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof Mn)return ij(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,s]of Object.entries(e)){let a=dx(s,t[n]);i=i||a!==void 0,a===void 0&&(a=s),r[n]=a}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function ij(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!Kv(t))return t;if(!Kv(e))return Ph.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new Mn;for(let n of r){let s=ij(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=s}return i}function aQe(e,t){let r={cur:[],result:[],len:0};return e=hx(e,t,r)??e,[e,r.result]}function OA(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function LA(e){e&&(e.len-=1)}function oQe(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function rae(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=hx(s.data,t,OA(r,a));LA(r),i=i||l!==void 0,l===void 0&&(l=s.data);let c=rae(s.children,t,r);return c!==void 0?i=!0:c=s.children,{...s,id:a,data:l,children:c}});if(i)return n}function lQe(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=hx(s.data,t,OA(r,a));return LA(r),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function hx(e,t,r){if(e instanceof _s){let i=rae(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof Nt)return lQe(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((s,a)=>{let o=hx(s,t,OA(r,a));return LA(r),i=i||o!==void 0,o===void 0&&(o=s),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!tj(e)){let i={},n=!1;for(let[s,a]of Object.entries(e))if(s!=="name"){let o=t[s];if(typeof o=="string"){if(r!==null)throw new Error("not supported");n=!0,s=o}let l=hx(a,t,OA(r,s));LA(r),n=n||l!==void 0,l===void 0&&(l=a),i[s]=l}else i[s]=a;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&oQe(r),i}else return}}var NA;(e=>{function t(r,i){let n=ws.zoom(i,r.path);if(typeof n=="object"){let s={};for(let a of Object.keys(r.props))s[a]=n[a];return{...r,props:s}}else return{...r,props:{}}}e.replaceProps=t})(NA||(NA={}));var rs;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){var d;return((d=i(l,c))==null?void 0:d.data)??l}e.applySimple=r;function i(l,c){var h,f;let d=c.path;for(var u=[];;){let p;if(l instanceof Mn&&c.type===0&&(p=l.runOp({...c,path:d.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===d.length&&(l instanceof _s||l instanceof Nt||l instanceof Zt?p=l.runOp(c):p=DA.runOp(l,c)),p!==void 0)if(p!==null){let v=p.data;for(let y=u.length-1;y>=0;y--){let b=d[y],x=u[y];if(x instanceof _s){if(typeof b=="number")throw new Error("illegal arg");v=x.modifyById(b,v)}else if(x instanceof Nt){if(typeof b=="number")throw new Error("illegal arg");v=x.modifyById(b,v)}else if(x instanceof Zt){if(typeof b=="number")throw new Error("illegal arg");v=x.modifyById(b,v)}else if(x instanceof Mn){let S={...x,[b]:v};v=Object.setPrototypeOf(S,Mn.prototype)}else if(typeof x=="object")if(Array.isArray(x)){if(typeof b=="string"&&(b=parseInt(b),isNaN(b)))throw new Error("Invalid path");let S=v;v=[...x],v[b]=S}else v={...x,[b]:v};else return null}return{data:v,actual:{...p.actual,path:d},reverse:{...p.reverse,path:d}}}else return null;let m=d[u.length],g;if(l instanceof _s){if(typeof m=="number")throw new Error("");g=(h=l.get(m))==null?void 0:h.data}else if(l instanceof Nt){if(typeof m=="number")throw new Error("");g=(f=l.get(m))==null?void 0:f.data}else l!==null&&(g=l[m]);if(g!==void 0)u.push(l),l=g;else return null}}e.apply=i;function n(l,c){for(let d=0;d<l.length&&d<c.length;d++)if(l[d]!==c[d])return!0;return!1}e.pathDisjoint=n;function s(l,c){if(l.length!==c.length)return!1;for(let d=0;d<l.length;d++)if(l[d]!==c[d])return!1;return!0}e.pathEq=s;function a(l,c){return n(l.path,c.path)}e.commutative=a;function o(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(d=>c.props[d]!==void 0):!1}e.subsumed=o})(rs||(rs={}));var qL;(e=>{function t(){return[]}e.empty=t;function r(c,d){let u=[];for(let h of c){let[f,...p]=h.path;f===d&&u.push({...h,path:p})}return u}e.removePrefix=r;function i(c,d){return c.map(u=>({...u,path:[d,...u.path]}))}e.addPrefix=i;function n(c,d){return[...c,...d]}e.concat=n;function s(c,d){return[...c.filter(u=>!d.some(h=>rs.subsumed(u,h))),...d]}e.compress=s;function a(c,d){return c.every(u=>d.every(h=>rs.commutative(u,h)))}e.commutative=a;function o(c,d){for(let u of d){let h=l(c,u);h!==null&&(c=h.data)}return c}e.applyAll=o;function l(c,d){var u=c;let h=[],f=[];for(let p of d)try{if(p.type===3||p.type===5&&p.path[p.path.length-1]==="variables"){let m,g,v;if(p.type===3?(m=ws.zoom(u,[...p.path,p.id]),v=rs.apply(u,{...p,type:2})):(m=ws.zoom(u,[...p.path,p.id,"value"]),v=rs.apply(u,p)),v!==null){u=v.data;let[y,b]=aQe(u,{[p.id]:m});u=y;for(let x=0;x<b.length;x++){let S=b[x],w=S.pop();if(typeof w=="number"){let E=[w];for(let T=x+1;T<b.length;T++){let A=b[T],M=A[A.length-1];if(typeof M=="number"&&ws.equal(S,A.slice(0,A.length-1)))E.push(M),b.splice(T,1);else break}let C=ws.zoom(u,S);g=C.map((T,A)=>E.includes(A)?p.id:T),m=C,w=S.pop()}else{if(w==="alphaOverride"||w==="alpha"){m/=100;let E=m,C=ws.zoom(u,S.slice(0,S.length-2)),T=C.layers.map(A=>A.id===S[S.length-1]?{...A,data:{...A.data,[w]:E}}:A);Object.setPrototypeOf(T,Object.getPrototypeOf(C.layers)),C.layers=T}g=p.id}h.push({type:0,path:S,props:{[w]:m}}),f.push({type:0,path:S,props:{[w]:g}})}f.push(v.reverse),h.push(v.actual)}}else{let m=rs.apply(u,p);m!==null&&(h.push(m.actual),u=m.data,f.push(m.reverse))}}catch(m){if(m instanceof Jse)return null;throw m}return{data:u,actual:h,reverse:f.reverse()}}e.apply=l})(qL||(qL={}));var iae=Symbol(),cQe=Symbol(),$M=Symbol(),_w=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof sae);){let s=i._path,a=i._current;if(s!==""&&n.splice(0,0,s),i=i._parent,i===null)return;i.update(s,a)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[$M];r&&r(),delete this._children[e]}}}},uQe=class extends _w{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,DA.runOp(this._current,e),e.path)}},dQe=class extends _w{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,Zt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},nae={get(e,t){if(t===$M)return()=>{e._parent=null};if(t===iae)return e._current;if(t===cQe)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let s=r[t],a=HM(e,t,s);return a!==s?(i===void 0&&(i={},e._children=i),i[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},hQe={...nae,set(e,t,r){let i={type:0,props:{[t]:ln(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},fQe={...nae,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},nj=class extends _w{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[$M]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=HM(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},sj=class extends _w{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[$M]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=HM(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function OR(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&ws.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var sae=class extends _w{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){OR(this.ts,t,e),OR(this.actual,r,e),OR(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function HM(e,t,r){return r instanceof _s?new nj(e,t,r):r instanceof Nt?new sj(e,t,r):r instanceof Zt?new Proxy(new dQe(e,t,r),fQe):r!==null&&typeof r=="object"?tj(r)?r:new Proxy(new uQe(e,t,r),hQe):r}function aae(e){let t=new sae(e);return[HM(t,"",e),t]}function fx(e,t){let[r,i]=aae(e);return t(r),i.result()}function ln(e){return e instanceof nj||e instanceof sj?e._current:e!==null&&typeof e=="object"?e[iae]:e}var ws;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function r(s,a,o){let l=n(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...a};return Object.keys(l).forEach(d=>{delete c[d]}),c}else return a}e.removeOverridden=r;function i(s,a){if((s instanceof _s||s instanceof nj)&&typeof a=="string"||(s instanceof Nt||s instanceof sj)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=i;function n(s,a,o=0){for(;o<a.length&&s!==void 0;)s=i(s,a[o]),o+=1;return s}e.zoom=n})(ws||(ws={}));function pQe(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function ci(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var oae=class{},nG=class extends oae{constructor(e){super(),this.id=e}},sG=class extends oae{constructor(e){super(),this.data=e}},XL;try{XL=new TextDecoder}catch{}var _t,Ih,Ce=0,ja={},Fr,lh,$o=0,Tc=0,lo,Ku,Ea=[],qr,aG={useRecords:!1,mapsAsObjects:!0},lae=class{},cae=new lae;cae.name="MessagePack 0xC1";var Qv=!1,kA=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(_t)return mae(()=>(KL(),this?this.unpack(e,t):kA.prototype.unpack.call(aG,e,t)));Ih=t>-1?t:e.length,Ce=0,Tc=0,lh=null,lo=null,_t=e;try{qr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw _t=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof kA){if(ja=this,this.structures)return Fr=this.structures,rS();(!Fr||Fr.length>0)&&(Fr=[])}else ja=aG,(!Fr||Fr.length>0)&&(Fr=[]);return rS()}unpackMultiple(e,t){let r,i=0;try{Qv=!0;let n=e.length,s=this?this.unpack(e,n):GM.unpack(e,n);if(t){for(t(s);Ce<n;)if(i=Ce,t(rS())===!1)return}else{for(r=[s];Ce<n;)i=Ce,r.push(rS());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{Qv=!1,KL()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function rS(){try{if(!ja.trusted&&!Qv){let t=Fr.sharedLength||0;t<Fr.length&&(Fr.length=t)}let e=Yi();if(Ce==Ih)Fr.restoreStructures&&oG(),Fr=null,_t=null,Ku&&(Ku=null);else if(Ce>Ih){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Qv)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Fr.restoreStructures&&oG(),KL(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function oG(){for(let e in Fr.restoreStructures)Fr[e]=Fr.restoreStructures[e];Fr.restoreStructures=null}function Yi(){let e=_t[Ce++];if(e<160)if(e<128){if(e<64)return e;{let t=Fr[e&63]||ja.getStructures&&uae()[e&63];return t?(t.read||(t.read=aj(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,ja.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[hae()]=Yi();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(Yi(),Yi());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=Yi();return t}else if(e<192){let t=e-160;if(Tc>=Ce)return lh.slice(Ce-$o,(Ce+=t)-$o);if(Tc==0&&Ih<140){let r=t<16?oj(t):dae(t);if(r!=null)return r}return YL(t)}else{let t;switch(e){case 192:return null;case 193:return lo?(t=Yi(),t>0?lo[1].slice(lo.position1,lo.position1+=t):lo[0].slice(lo.position0,lo.position0-=t)):cae;case 194:return!1;case 195:return!0;case 196:return LR(_t[Ce++]);case 197:return t=qr.getUint16(Ce),Ce+=2,LR(t);case 198:return t=qr.getUint32(Ce),Ce+=4,LR(t);case 199:return uf(_t[Ce++]);case 200:return t=qr.getUint16(Ce),Ce+=2,uf(t);case 201:return t=qr.getUint32(Ce),Ce+=4,uf(t);case 202:if(t=qr.getFloat32(Ce),ja.useFloat32>2){let r=lj[(_t[Ce]&127)<<1|_t[Ce+1]>>7];return Ce+=4,(r*t+(t>0?.5:-.5)>>0)/r}return Ce+=4,t;case 203:return t=qr.getFloat64(Ce),Ce+=8,t;case 204:return _t[Ce++];case 205:return t=qr.getUint16(Ce),Ce+=2,t;case 206:return t=qr.getUint32(Ce),Ce+=4,t;case 207:return ja.int64AsNumber?(t=qr.getUint32(Ce)*4294967296,t+=qr.getUint32(Ce+4)):t=qr.getBigUint64(Ce),Ce+=8,t;case 208:return qr.getInt8(Ce++);case 209:return t=qr.getInt16(Ce),Ce+=2,t;case 210:return t=qr.getInt32(Ce),Ce+=4,t;case 211:return ja.int64AsNumber?(t=qr.getInt32(Ce)*4294967296,t+=qr.getUint32(Ce+4)):t=qr.getBigInt64(Ce),Ce+=8,t;case 212:if(t=_t[Ce++],t==114)return hG(_t[Ce++]&63);{let r=Ea[t];if(r)return r.read?(Ce++,r.read(Yi())):r.noBuffer?(Ce++,r()):r(_t.subarray(Ce,++Ce));throw new Error("Unknown extension "+t)}case 213:return t=_t[Ce],t==114?(Ce++,hG(_t[Ce++]&63,_t[Ce++])):uf(2);case 214:return uf(4);case 215:return uf(8);case 216:return uf(16);case 217:return t=_t[Ce++],Tc>=Ce?lh.slice(Ce-$o,(Ce+=t)-$o):gQe(t);case 218:return t=qr.getUint16(Ce),Ce+=2,Tc>=Ce?lh.slice(Ce-$o,(Ce+=t)-$o):vQe(t);case 219:return t=qr.getUint32(Ce),Ce+=4,Tc>=Ce?lh.slice(Ce-$o,(Ce+=t)-$o):yQe(t);case 220:return t=qr.getUint16(Ce),Ce+=2,cG(t);case 221:return t=qr.getUint32(Ce),Ce+=4,cG(t);case 222:return t=qr.getUint16(Ce),Ce+=2,uG(t);case 223:return t=qr.getUint32(Ce),Ce+=4,uG(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var mQe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function aj(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>mQe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Yi);return e.highByte===0&&(e.read=lG(t,e.read)),n()}let i={};for(let n=0,s=e.length;n<s;n++){let a=e[n];i[a]=Yi()}return i}return r.count=0,e.highByte===0?lG(t,r):r}var lG=(e,t)=>function(){let r=_t[Ce++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=Fr[i]||uae()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=aj(n,e)),n.read()};function uae(){let e=mae(()=>(_t=null,ja.getStructures()));return Fr=ja._mergeStructures(e,Fr)}var YL=WM,gQe=WM,vQe=WM,yQe=WM;function WM(e){let t;if(e<16&&(t=oj(e)))return t;if(e>64&&XL)return XL.decode(_t.subarray(Ce,Ce+=e));let r=Ce+e,i=[];for(t="";Ce<r;){let n=_t[Ce++];if(!(n&128))i.push(n);else if((n&224)===192){let s=_t[Ce++]&63;i.push((n&31)<<6|s)}else if((n&240)===224){let s=_t[Ce++]&63,a=_t[Ce++]&63;i.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=_t[Ce++]&63,a=_t[Ce++]&63,o=_t[Ce++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=Yn.apply(String,i),i.length=0)}return i.length>0&&(t+=Yn.apply(String,i)),t}function cG(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=Yi();return t}function uG(e){if(ja.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[hae()]=Yi();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(Yi(),Yi());return t}}var Yn=String.fromCharCode;function dae(e){let t=Ce,r=new Array(e);for(let i=0;i<e;i++){let n=_t[Ce++];if((n&128)>0){Ce=t;return}r[i]=n}return Yn.apply(String,r)}function oj(e){if(e<4)if(e<2){if(e===0)return"";{let t=_t[Ce++];if((t&128)>1){Ce-=1;return}return Yn(t)}}else{let t=_t[Ce++],r=_t[Ce++];if((t&128)>0||(r&128)>0){Ce-=2;return}if(e<3)return Yn(t,r);let i=_t[Ce++];if((i&128)>0){Ce-=3;return}return Yn(t,r,i)}else{let t=_t[Ce++],r=_t[Ce++],i=_t[Ce++],n=_t[Ce++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){Ce-=4;return}if(e<6){if(e===4)return Yn(t,r,i,n);{let s=_t[Ce++];if((s&128)>0){Ce-=5;return}return Yn(t,r,i,n,s)}}else if(e<8){let s=_t[Ce++],a=_t[Ce++];if((s&128)>0||(a&128)>0){Ce-=6;return}if(e<7)return Yn(t,r,i,n,s,a);let o=_t[Ce++];if((o&128)>0){Ce-=7;return}return Yn(t,r,i,n,s,a,o)}else{let s=_t[Ce++],a=_t[Ce++],o=_t[Ce++],l=_t[Ce++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){Ce-=8;return}if(e<10){if(e===8)return Yn(t,r,i,n,s,a,o,l);{let c=_t[Ce++];if((c&128)>0){Ce-=9;return}return Yn(t,r,i,n,s,a,o,l,c)}}else if(e<12){let c=_t[Ce++],d=_t[Ce++];if((c&128)>0||(d&128)>0){Ce-=10;return}if(e<11)return Yn(t,r,i,n,s,a,o,l,c,d);let u=_t[Ce++];if((u&128)>0){Ce-=11;return}return Yn(t,r,i,n,s,a,o,l,c,d,u)}else{let c=_t[Ce++],d=_t[Ce++],u=_t[Ce++],h=_t[Ce++];if((c&128)>0||(d&128)>0||(u&128)>0||(h&128)>0){Ce-=12;return}if(e<14){if(e===12)return Yn(t,r,i,n,s,a,o,l,c,d,u,h);{let f=_t[Ce++];if((f&128)>0){Ce-=13;return}return Yn(t,r,i,n,s,a,o,l,c,d,u,h,f)}}else{let f=_t[Ce++],p=_t[Ce++];if((f&128)>0||(p&128)>0){Ce-=14;return}if(e<15)return Yn(t,r,i,n,s,a,o,l,c,d,u,h,f,p);let m=_t[Ce++];if((m&128)>0){Ce-=15;return}return Yn(t,r,i,n,s,a,o,l,c,d,u,h,f,p,m)}}}}}function LR(e){return ja.copyBuffers?Uint8Array.prototype.slice.call(_t,Ce,Ce+=e):_t.subarray(Ce,Ce+=e)}function uf(e){let t=_t[Ce++];if(Ea[t])return Ea[t](_t.subarray(Ce,Ce+=e));throw new Error("Unknown extension type "+t)}var dG=new Array(4096);function hae(){let e=_t[Ce++];if(e>=160&&e<192){if(e=e-160,Tc>=Ce)return lh.slice(Ce-$o,(Ce+=e)-$o);if(!(Tc==0&&Ih<180))return YL(e)}else return Ce--,Yi();let t=(e<<5^(e>1?qr.getUint16(Ce):e>0?_t[Ce]:0))&4095,r=dG[t],i=Ce,n=Ce+e-3,s,a=0;if(r&&r.bytes==e){for(;i<n;){if(s=qr.getUint32(i),s!=r[a++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(s=_t[i++],s!=r[a++]){i=1879048192;break}if(i===n)return Ce=i,r.string;n-=3,i=Ce}for(r=[],dG[t]=r,r.bytes=e;i<n;)s=qr.getUint32(i),r.push(s),i+=4;for(n+=3;i<n;)s=_t[i++],r.push(s);let o=e<16?oj(e):dae(e);return o!=null?r.string=o:r.string=YL(e)}var hG=(e,t)=>{var r=Yi();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=Fr[e];return n&&n.isShared&&((Fr.restoreStructures||(Fr.restoreStructures=[]))[e]=n),Fr[e]=r,r.read=aj(r,i),r.read()},fae=typeof self=="object"?self:global;Ea[0]=()=>{};Ea[0].noBuffer=!0;Ea[101]=()=>{let e=Yi();return(fae[e[0]]||Error)(e[1])};Ea[105]=e=>{let t=qr.getUint32(Ce-4);Ku||(Ku=new Map);let r=_t[Ce],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};Ku.set(t,n);let s=Yi();return n.used?Object.assign(i,s):(n.target=s,s)};Ea[112]=e=>{let t=qr.getUint32(Ce-4),r=Ku.get(t);return r.used=!0,r.target};Ea[115]=()=>new Set(Yi());var pae=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Ea[116]=e=>{let t=e[0],r=pae[t];if(!r)throw new Error("Could not find typed array for code "+t);return new fae[r](Uint8Array.prototype.slice.call(e,1).buffer)};Ea[120]=()=>{let e=Yi();return new RegExp(e[0],e[1])};Ea[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=Ce;Ce+=t-4,lo=[Yi(),Yi()],lo.position0=0,lo.position1=0;let i=Ce;Ce=r;try{return Yi()}finally{Ce=i}};Ea[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function mae(e){let t=Ih,r=Ce,i=$o,n=Tc,s=lh,a=Ku,o=lo,l=new Uint8Array(_t.slice(0,Ih)),c=Fr,d=Fr.slice(0,Fr.length),u=ja,h=Qv,f=e();return Ih=t,Ce=r,$o=i,Tc=n,lh=s,Ku=a,lo=o,_t=l,Qv=h,Fr=c,Fr.splice(0,Fr.length,...d),ja=u,qr=new DataView(_t.buffer,_t.byteOffset,_t.byteLength),f}function KL(){_t=null,Ku=null,Fr=null}function bQe(e){e.unpack?Ea[e.type]=e.unpack:Ea[e.type]=e}var lj=new Array(147);for(let e=0;e<256;e++)lj[e]=+("1e"+Math.floor(45.15-e*.30103));var GM=new kA({useRecords:!1});GM.unpack;GM.unpackMultiple;GM.unpack;var xQe=new Float32Array(1);new Uint8Array(xQe.buffer,0,4);var PE;try{PE=new TextEncoder}catch{}var zA,cj,qM=typeof Buffer<"u",NR=qM?Buffer.allocUnsafeSlow:Uint8Array,gae=qM?Buffer:Uint8Array,fG=qM?4294967296:2144337920,We,tn,Ne=0,nc,sc=null,wQe=/[\u0080-\uFFFF]/,Dy=Symbol("record-id"),vae=class extends kA{constructor(e){super(e),this.offset=0;let t,r,i,n,s,a=0,o=gae.prototype.utf8Write?function(w,E,C){return We.utf8Write(w,E,C)}:PE&&PE.encodeInto?function(w,E){return PE.encodeInto(w,We.subarray(E)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,d=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=d?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let h=e.maxOwnStructures;h==null&&(h=d?32:64),c&&!e.saveStructures&&(this.structures=[]);let f=u>32||h+u>64,p=u+64,m=u+h+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(w,E){if(We||(We=new NR(8192),tn=new DataView(We.buffer,0,8192),Ne=0),nc=We.length-10,nc-Ne<2048?(We=new NR(We.length),tn=new DataView(We.buffer,0,We.length),nc=We.length-10,Ne=0):Ne=Ne+7&2147483640,t=Ne,s=l.structuredClone?new Map:null,l.bundleStrings?(sc=["",""],We[Ne++]=214,We[Ne++]=98,sc.position=Ne-t,Ne+=4):sc=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let C=r.sharedLength||0;if(C>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let T=0;T<C;T++){let A=r[T];if(!A)continue;let M,P=r.transitions;for(let I=0,R=A.length;I<R;I++){let N=A[I];M=P[N],M||(M=P[N]=Object.create(null)),P=M}P[Dy]=T+64}a=C}c||(r.nextId=C+64)}i&&(i=!1),n=r||[];try{if(b(w),sc){tn.setUint32(sc.position+t,Ne-sc.position-t);let C=sc;sc=null,b(C[0]),b(C[1])}if(l.offset=Ne,s&&s.idsToInsert){Ne+=s.idsToInsert.length*6,Ne>nc&&S(Ne),l.offset=Ne;let C=SQe(We.subarray(t,Ne),s.idsToInsert);return s=null,C}return E&EQe?(We.start=t,We.end=Ne,We):We.subarray(t,Ne)}finally{if(r){if(y<10&&y++,v>1e4)r.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let C=0,T=g.length;C<T;C++)g[C][Dy]=0;g=[]}if(i&&l.saveStructures){let C=r.sharedLength||u;r.length>C&&(r=r.slice(0,C));let T=We.subarray(t,Ne);return l.saveStructures(r,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(w)):(a=C,T)}}E&CQe&&(Ne=t)}};let b=w=>{Ne>nc&&(We=S(Ne));var E=typeof w,C;if(E==="string"){let T=w.length;if(sc&&T>=8&&T<4096){let P=wQe.test(w);sc[P?0:1]+=w,We[Ne++]=193,b(P?-T:T);return}let A;T<32?A=1:T<256?A=2:T<65536?A=3:A=5;let M=T*3;if(Ne+M>nc&&(We=S(Ne+M)),T<64||!o){let P,I,R,N=Ne+A;for(P=0;P<T;P++)I=w.charCodeAt(P),I<128?We[N++]=I:I<2048?(We[N++]=I>>6|192,We[N++]=I&63|128):(I&64512)===55296&&((R=w.charCodeAt(P+1))&64512)===56320?(I=65536+((I&1023)<<10)+(R&1023),P++,We[N++]=I>>18|240,We[N++]=I>>12&63|128,We[N++]=I>>6&63|128,We[N++]=I&63|128):(We[N++]=I>>12|224,We[N++]=I>>6&63|128,We[N++]=I&63|128);C=N-Ne-A}else C=o(w,Ne+A,M);C<32?We[Ne++]=160|C:C<256?(A<2&&We.copyWithin(Ne+2,Ne+1,Ne+1+C),We[Ne++]=217,We[Ne++]=C):C<65536?(A<3&&We.copyWithin(Ne+3,Ne+2,Ne+2+C),We[Ne++]=218,We[Ne++]=C>>8,We[Ne++]=C&255):(A<5&&We.copyWithin(Ne+5,Ne+3,Ne+3+C),We[Ne++]=219,tn.setUint32(Ne,C),Ne+=4),Ne+=C}else if(E==="number")if(w>>>0===w)w<64?We[Ne++]=w:w<256?(We[Ne++]=204,We[Ne++]=w):w<65536?(We[Ne++]=205,We[Ne++]=w>>8,We[Ne++]=w&255):(We[Ne++]=206,tn.setUint32(Ne,w),Ne+=4);else if(w>>0===w)w>=-32?We[Ne++]=256+w:w>=-128?(We[Ne++]=208,We[Ne++]=w+256):w>=-32768?(We[Ne++]=209,tn.setInt16(Ne,w),Ne+=2):(We[Ne++]=210,tn.setInt32(Ne,w),Ne+=4);else{let T;if((T=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){We[Ne++]=202,tn.setFloat32(Ne,w);let A;if(T<4||(A=w*lj[(We[Ne]&127)<<1|We[Ne+1]>>7])>>0===A){Ne+=4;return}else Ne--}We[Ne++]=203,tn.setFloat64(Ne,w),Ne+=8}else if(E==="object")if(!w)We[Ne++]=192;else{if(s){let A=s.get(w);if(A){if(!A.id){let M=s.idsToInsert||(s.idsToInsert=[]);A.id=M.push(A)}We[Ne++]=214,We[Ne++]=112,tn.setUint32(Ne,A.id),Ne+=4;return}else s.set(w,{offset:Ne-t})}let T=w.constructor;if(T===Object)x(w,!0);else if(T===Array){C=w.length,C<16?We[Ne++]=144|C:C<65536?(We[Ne++]=220,We[Ne++]=C>>8,We[Ne++]=C&255):(We[Ne++]=221,tn.setUint32(Ne,C),Ne+=4);for(let A=0;A<C;A++)b(w[A])}else if(T===Map){C=w.size,C<16?We[Ne++]=128|C:C<65536?(We[Ne++]=222,We[Ne++]=C>>8,We[Ne++]=C&255):(We[Ne++]=223,tn.setUint32(Ne,C),Ne+=4);for(let[A,M]of w)b(A),b(M)}else{for(let A=0,M=zA.length;A<M;A++){let P=cj[A];if(w instanceof P){let I=zA[A];if(I.write){I.type&&(We[Ne++]=212,We[Ne++]=I.type,We[Ne++]=0),b(I.write.call(this,w));return}let R=We,N=tn,k=Ne;We=null;let O;try{O=I.pack.call(this,w,D=>(We=R,R=null,Ne+=D,Ne>nc&&S(Ne),{target:We,targetView:tn,position:Ne-D}),b)}finally{R&&(We=R,tn=N,Ne=k,nc=We.length-10)}O&&(O.length+Ne>nc&&S(O.length+Ne),Ne=_Qe(O,We,Ne,I.type));return}}x(w,!w.hasOwnProperty)}}else if(E==="boolean")We[Ne++]=w?195:194;else if(E==="bigint"){if(w<BigInt(1)<<BigInt(63)&&w>=-(BigInt(1)<<BigInt(63)))We[Ne++]=211,tn.setBigInt64(Ne,w);else if(w<BigInt(1)<<BigInt(64)&&w>0)We[Ne++]=207,tn.setBigUint64(Ne,w);else if(this.largeBigIntToFloat)We[Ne++]=203,tn.setFloat64(Ne,Number(w));else throw new RangeError(w+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ne+=8}else if(E==="undefined")this.encodeUndefinedAsNil?We[Ne++]=192:(We[Ne++]=212,We[Ne++]=0,We[Ne++]=0);else if(E==="function")b(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+E)},x=this.useRecords===!1?this.variableMapSize?w=>{let E=Object.keys(w),C=E.length;C<16?We[Ne++]=128|C:C<65536?(We[Ne++]=222,We[Ne++]=C>>8,We[Ne++]=C&255):(We[Ne++]=223,tn.setUint32(Ne,C),Ne+=4);let T;for(let A=0;A<C;A++)b(T=E[A]),b(w[T])}:(w,E)=>{We[Ne++]=222;let C=Ne-t;Ne+=2;let T=0;for(let A in w)(E||w.hasOwnProperty(A))&&(b(A),b(w[A]),T++);We[C+++t]=T>>8,We[C+t]=T&255}:w=>{let E=Object.keys(w),C,T=n.transitions||(n.transitions=Object.create(null)),A=0;for(let P=0,I=E.length;P<I;P++){let R=E[P];C=T[R],C||(C=T[R]=Object.create(null),A++),T=C}let M=T[Dy];if(M)M>=96&&f?(We[Ne++]=((M-=96)&31)+96,We[Ne++]=M>>5):We[Ne++]=M;else{M=n.nextId,M||(M=64),M<p&&this.shouldShareStructure&&!this.shouldShareStructure(E)?(M=n.nextOwnId,M<m||(M=p),n.nextOwnId=M+1):(M>=m&&(M=p),n.nextId=M+1);let P=E.highByte=M>=96&&f?M-96>>5:-1;T[Dy]=M,n[M-64]=E,M<p?(E.isShared=!0,n.sharedLength=M-63,i=!0,P>=0?(We[Ne++]=(M&31)+96,We[Ne++]=P):We[Ne++]=M):(P>=0?(We[Ne++]=213,We[Ne++]=114,We[Ne++]=(M&31)+96,We[Ne++]=P):(We[Ne++]=212,We[Ne++]=114,We[Ne++]=M),A&&(v+=y*A),g.length>=h&&(g.shift()[Dy]=0),g.push(T),b(E))}for(let P=0,I=E.length;P<I;P++)b(w[E[P]])},S=w=>{let E;if(w>16777216){if(w-t>fG)throw new Error("Packed buffer would be larger than maximum buffer size");E=Math.min(fG,Math.round(Math.max((w-t)*(w>67108864?1.25:2),4194304)/4096)*4096)}else E=(Math.max(w-t<<2,We.length-1)>>12)+1<<12;let C=new NR(E);return tn=new DataView(C.buffer,0,E),We.copy?We.copy(C,0,t,w):C.set(We.slice(t,w)),Ne-=t,t=0,nc=C.length-10,We=C}}useBuffer(e){We=e,tn=new DataView(We.buffer,We.byteOffset,We.byteLength),Ne=0}};cj=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,lae];zA=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,i)}else if(i>0&&i<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?pG(e,16,t):mG(qM?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==gae&&this.structuredClone?pG(e,pae.indexOf(r.name),t):mG(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function pG(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=r(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=r(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=r(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function mG(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:s}=t(r+5);i[n++]=198,s.setUint32(n,r),n+=4}i.set(e,n)}function _Qe(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function SQe(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((s,a)=>s.offset>a.offset?1:-1);r=t.pop();){let s=r.offset,a=r.id;e.copyWithin(s+i,s,n),i-=6;let o=s+i;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function $0(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");cj.unshift(e.Class),zA.unshift(e)}bQe(e)}var yae=new vae({useRecords:!1});yae.pack;yae.pack;var EQe=512,CQe=1024,gG=new vae({structuredClone:!0});$0({Class:Zt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Zt.prototype),e}});$0({Class:Nt.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Nt.prototype),e}});$0({Class:_s.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,_s.prototype),e}});$0({Class:nG.prototype.constructor,type:4,write(e){return e.id},read(e){return new nG(e)}});$0({Class:sG.prototype.constructor,type:5,write(e){return e.data},read(e){return new sG(e)}});$0({Class:Mn.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Mn.prototype),e}});function AQe(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function QL(e){if(tj(e))return e;if(Array.isArray(e))return e.map(QL);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=QL(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var ZL;(e=>{function t(n){return gG.pack(n)}e.serialize=t;function r(n){return gG.unpack(n)}e.deserialize=r;function i(n){return AQe(t(QL(n))).toString()}e.checksum=i})(ZL||(ZL={}));var vG;(e=>{function t(i){return i.type==="Conditional"?i.condition.type==="Distance"?"Distance":"StateChange":i.type}e.toEventUIType=t;function r(i){return i==="Distance"||i==="StateChange"?"Conditional":i}e.fromEventUIType=r})(vG||(vG={}));var La={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"]},yG;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,runMode:"Once",actions:new Nt}:{type:i,disabled:!1,key:void 0,runMode:"Once",actions:new Nt}}e.defaultData=r})(yG||(yG={}));var BA;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(BA||(BA={}));var JL;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:BA.propertyDefaultData(n),rOperand:{...BA.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,s){return{type:"State",object:n??null,state:s??null}}e.stateDefaultData=i})(JL||(JL={}));var bG;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new Nt,outActions:new Nt,condition:JL.distanceDefaultData(i)}}e.defaultData=r})(bG||(bG={}));var xG;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new Nt,drop:new Nt}})(xG||(xG={}));var eN;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new Nt})(eN||(eN={}));var tN;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(tN||(tN={}));var wG;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new Nt}}e.defaultData=r})(wG||(wG={}));var _G;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new Nt}}e.defaultData=r})(_G||(_G={}));var SG;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new Nt}}e.defaultData=r})(SG||(SG={}));var EG;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,runMode:"Once",target:"character",actions:new Nt}}e.defaultData=r})(EG||(EG={}));var CG;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,runMode:"Once",target:"all",triggeringObjects:[],actions:new Nt,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(CG||(CG={}));var rN;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function r(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=r;function i(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=i;function n(){let a={size:"mobile",operator:"<",actions:new Nt},o={size:"tablet",operator:"<",actions:new Nt},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new Nt},c=new Nt;return c.push({id:Et.generateUUID(),fi:0,data:a},{id:Et.generateUUID(),fi:1,data:o},{id:Et.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new Nt}}e.defaultBreakpointData=s})(rN||(rN={}));var iN;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(i){return i.type==="VariableChange"}e.is=t;function r(){return{disabled:!1,type:"VariableChange",actions:new Nt,variableId:"",objectId:null,property:"Position X"}}e.defaultData=r})(iN||(iN={}));var H0="personal camera",eb="a218fcc3-276b-49b9-b485-49037fd14f5f",TQe=2960946,So=5526619,ch;(e=>{function t(h,f){return h[0]===f[0]&&h[1]===f[1]}e.isEqual=t;function r(h,f,p){return[h[0]+(f[0]-h[0])*p,h[1]+(f[1]-h[1])*p]}e.lerp=r;function i(h,f){return[h[0]+f[0],h[1]+f[1]]}e.add=i;function n(h,f){return[h[0]-f[0],h[1]-f[1]]}e.sub=n;function s(h,f){return Math.pow(f[0]-h[0],2)+Math.pow(f[1]-h[1],2)}e.distanceSquared=s;function a(h,f){return Math.sqrt(s(h,f))}e.distance=a;function o(h,f){return h[0]*f[0]+h[1]*f[1]}e.dot=o;function l(h,f){return[h[0]*f,h[1]*f]}e.scalarMultiply=l;function c(h,f,p){let m=e.sub(f,h),g=e.sub(p,h),v=e.dot(m,g)/e.dot(m,m),y=e.scalarMultiply(m,v);return e.add(h,y)}e.projectionOnto=c;function d(h,f,p){return a(h,c(h,f,p))}e.projectionOntoDistance=d;function u(h,f){return[(h[0]+f[0])*.5,(h[1]+f[1])*.5]}e.center=u})(ch||(ch={}));var dp;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function a(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=a;function o(l,c,d){return[l[0]+(c[0]-l[0])*d,l[1]+(c[1]-l[1])*d,l[2]+(c[2]-l[2])*d]}e.lerp=o})(dp||(dp={}));var FA;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s,i[2]+(n[2]-i[2])*s,i[3]+(n[3]-i[3])*s]}e.lerp=r})(FA||(FA={}));var Zv;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let c=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/c,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/c,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/c}return a}e.applyMatrix4=i})(Zv||(Zv={}));var $s;(e=>{function t(c){return typeof c=="object"&&typeof c.r=="number"&&typeof c.g=="number"&&typeof c.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(c){return{r:Math.round(c.r*255),g:Math.round(c.g*255),b:Math.round(c.b*255),a:1}}e.toRgb255a1=r;function i(c){return{r:c.r,g:c.g,b:c.b}}e.clone=i;function n(c){return c=Math.floor(c),{r:(c>>16&255)/255,g:(c>>8&255)/255,b:(c&255)/255}}e.fromHex=n;function s(c){return Math.round(c.r*255)*65536+Math.round(c.g*255)*256+Math.round(c.b*255)}e.toHex=s;function a(c,d){return c.r===d.r&&c.g===d.g&&c.b===d.b}e.equals=a;function o(c,d){return c.r.toFixed(2)===d.r.toFixed(2)&&c.g.toFixed(2)===d.g.toFixed(2)&&c.b.toFixed(2)===d.b.toFixed(2)}e.equalsFixed=o;function l(c,d,u){return{r:c.r+(d.r-c.r)*u,g:c.g+(d.g-c.g)*u,b:c.b+(d.b-c.b)*u}}e.lerp=l})($s||($s={}));var ei;(e=>{e.white={...$s.white,a:1},e.transparent={...$s.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function r(l,c){return{...$s.fromHex(l),a:c}}e.fromHexAndA=r;function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=i;function n(l,c){return $s.equals(l,c)&&l.a===c.a}e.equals=n;function s(l,c){return $s.equalsFixed(l,c)&&l.a.toFixed(2)===c.a.toFixed(2)}e.equalsFixed=s;function a(l,c,d){return{r:l.r+(c.r-l.r)*d,g:l.g+(c.g-l.g)*d,b:l.b+(c.b-l.b)*d,a:l.a+(c.a-l.a)*d}}e.lerp=a;function o({r:l,g:c,b:d,a:u}=e.white){return`rgba(${l*255}, ${c*255}, ${d*255}, ${u})`}e.toStyle=o})(ei||(ei={}));var nN;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(nN||(nN={}));var AG;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(AG||(AG={}));var TG;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(TG||(TG={}));var $d;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))($d||($d={}));function MG(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var Fp;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(Fp||(Fp={}));var Jv;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){return r.type==="PerspectiveCamera"?r.perspective.zoom:r.orthographic.zoom}e.getZoom=t})(Jv||(Jv={}));var uh;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let s={...i};if(bae.forEach(a=>{Object.assign(s,{[a]:n[a]??i[a]})}),s.radial={...i.radial},n.radial){let a=i.radial,o=n.radial;xae.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...i.linear},n.linear){let a=i.linear,o=n.linear;wae.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...i.grid},n.grid){let a=i.grid,o=n.grid;_ae.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...i.toObject},n.toObject){let a=i.toObject,o=n.toObject;Sae.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...i.randomnessObject},n.randomnessObject){let a=i.randomnessObject,o=n.randomnessObject;Eae.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=r})(uh||(uh={}));var sN;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let s=[];i.count!==void 0&&s.push({type:0,path:n,props:{count:i.count}});for(let a of t){let o=i[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...n,a],props:o})}return s}e.toOps=r})(sN||(sN={}));var bae=["count"],xae=["radius","start","end","position","scale","rotation"],wae=["position","scale","rotation"],_ae=["count","size"],Sae=["count","position","scale","rotation"],Eae=["strength","scale","rotation","position","movement","seed","freqScale"],aN;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(aN||(aN={}));var oN;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:ei.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:ei.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:ei.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(oN||(oN={}));var jA;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeLoopDelayStart:"end",emitTimeDuration:1,...e.defaultCollisionData}))(jA||(jA={}));var e0;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(e0||(e0={}));var lN;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(lN||(lN={}));var cN;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(cN||(cN={}));var uN;(e=>e.defaultData={...cN.defaultData,...lN.defaultData})(uN||(uN={}));var PG;(e=>{function t(r,i){var s,a;let n=[];if("material"in r){let o=typeof r.material=="string"?i.materials[r.material]??((s=i.lib.materials[r.material])==null?void 0:s.asset):r.material;o&&n.push(o)}else if("materials"in r)for(let o of r.materials){let l=typeof o=="string"?i.materials[o]??((a=i.lib.materials[o])==null?void 0:a.asset):o;l&&n.push(l)}return n}e.getMaterialData=t})(PG||(PG={}));var VA;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(VA||(VA={}));var IG;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="particle"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(IG||(IG={}));function MQe(e){return e.type!=="displace"}var RG;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})(RG||(RG={}));var Cae=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],PQe=["wrapping","image","video","name","minFilter"],Qn;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let c=s.texture;c&&Object.assign(c,o)}}e.patch=t;function r(s,a){return s==="light"&&a?i(a):n(s)}e.defaultData=r;function i(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],minFilter:1008},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:VA.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],minFilter:1008},crop:!1};case"color":return{...a,type:"color",color:$s.fromHex(So)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...$s.fromHex(6710886),a:1},colorB:{...$s.fromHex(6710886),a:1},colorC:{...$s.fromHex(16777215),a:1},colorD:{...$s.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:ei.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:ei.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:ei.fromHexAndA(0,1),contourColor:ei.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],minFilter:1008}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...$s.fromHex(0),a:1},colorB:{...$s.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Qn||(Qn={}));var Zs;(e=>{function t(d){return!d.layers.some(u=>u.data.type==="texture"&&u.data.projection!==0||u.data.type==="depth"&&!u.data.isWorldSpace||u.data.type==="noise"||u.data.type==="displace")}e.isMergable=t;function r(d){let u="";return d.layers.forEach(h=>{Object.entries(h.data).forEach(([f,p])=>{u+=`${f}${p}`,Array.isArray(p)?p.forEach(m=>u+=`${m}`):typeof p=="object"?Object.values(p).forEach(m=>{typeof m=="number"?u+=`${m.toFixed(4)}`:u+=`${m}`}):u+=`${p}`})}),u}e.getHash=r;function i(){return{layers:new Nt}}e.defaultEmptyData=i;function n(d="layer1",u="layer2"){return a("phong",d,u)}e.defaultData=n;function s(d,u){return{...d,name:u}}e.withName=s;function a(d,u="layer1",h="layer2"){let f=new Nt;return f.push({fi:0,data:Qn.defaultData("light",d),id:u}),f.push({fi:1,data:Qn.defaultData("color"),id:h}),{layers:f}}e.defaultTwoLayerData=a;function o(d){let u=Qn.defaultData("texture");d&&Object.assign(u.texture,{image:d});let h=new Nt;return h.push({fi:0,data:u,id:"layer1"}),h.push({fi:1,data:{...Qn.defaultData("transmission"),alpha:1},id:"layer2"}),h.push({fi:2,data:{...Qn.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:h}}e.defaultUIObjectMaterial=o;function l(d,u="phong",h="layer1",f="layer2"){let p=Qn.defaultData("texture");Object.assign(p.texture,{image:d});let m=new Nt;return m.push({fi:0,data:p,id:h}),m.push({fi:1,data:Qn.defaultData("light",u),id:f}),{layers:m}}e.defaultTwoLayerTextureData=l;function c(d,u="phong",h="layer1",f="layer2"){let p=Qn.defaultData("video");Object.assign(p.texture,{video:d});let m=new Nt;return m.push({fi:0,data:p,id:h}),m.push({fi:1,data:Qn.defaultData("light",u),id:f}),{layers:m}}e.defaultTwoLayerVideoTextureData=c})(Zs||(Zs={}));var UA;(e=>{function t(){return{points:new Nt,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(UA||(UA={}));var $A;(e=>{function t(){return{points:new Nt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})($A||($A={}));var Aae={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},dN;(e=>{function t(r,i){let n={...r};return Mae.forEach(s=>{Object.assign(n,{[s]:i[s]??r[s]})}),n}e.merge=t})(dN||(dN={}));var Tae={shape:Aae,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},Mae=["depth","offset","angle","twist","startScale","endScale"],HA;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="UIGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}e.isParametricMesh=r})(HA||(HA={}));var hN;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,dN.merge(n.extrusion,i.extrusion))),n}e.merge=t})(hN||(hN={}));var cv;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="UIGeometry")return{type:r,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:$A.defaultData(),extrusion:Tae};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:UA.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(cv||(cv={}));var DG=["width","height","depth"],fN;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:$s.white,near:.1,far:2e3})(fN||(fN={}));var WA;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focalLength:2,focusDistance:2,bokehScale:2},noise:{...t,blendFunction:16}}})(WA||(WA={}));var pN;(e=>e.defaultData={softShadowQuality:"low"})(pN||(pN={}));var mN;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(mN||(mN={}));var gN;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(gN||(gN={}));var t0;(e=>e.defaultData={usePhysics:!1,gravity:-10})(t0||(t0={}));var vN;(e=>e.defaultData={playCamera:H0,gameControlObject:null})(vN||(vN={}));var yN;(e=>e.defaultData={backgroundColor:ei.fromHexAndA(TQe,1),postprocessing:WA.defaultData,fog:fN.defaultData,globalPhysics:t0.defaultData,ambient:mN.defaultData,ao:gN.defaultData,shadow:pN.defaultData,publish:vN.defaultData})(yN||(yN={}));var bN;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(bN||(bN={}));var OG;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(OG||(OG={}));var r0;(e=>{e.identity={...nN.identity,hiddenMatrix:Zv.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,s){return Wse({position:dp.isEqual(n.position,s.position)?void 0:s.position,rotation:dp.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:dp.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:Zv.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=i})(r0||(r0={}));var Ms;(e=>e.defaultData={states:new Nt,events:new Nt,visible:!0,raycastLock:!1,physics:e0.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...r0.identity,cloner:null})(Ms||(Ms={}));var xN;(e=>e.defaultData={type:"Empty",...Ms.defaultData})(xN||(xN={}));var LG;(e=>e.defaultData={type:"ParticleCollider",...bN.defaultData,...Ms.defaultData})(LG||(LG={}));var NG;(e=>e.defaultData={type:"Component",...Ms.defaultData})(NG||(NG={}));var kG;(e=>e.defaultData={type:"Particle",...Ms.defaultData,...jA.defaultData})(kG||(kG={}));var uv;(e=>e.defaultData={type:"Mesh",...Ms.defaultData,...uN.defaultData})(uv||(uv={}));var px;(e=>e.defaultData={...Ms.defaultData,...r0.identity,position:[0,0,Jv.DefaultTargetOffset],...Jv.defaultData})(px||(px={}));var wN;(e=>{function t(r){return{...Ms.defaultData,...oN.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(wN||(wN={}));var GA;(e=>{function t(i,n,s=0){for(;s<n.length;){let a=i?i[n[s]]:void 0;if(n.length===s+1)return a;if(a)i=a.descendants,s+=1;else return}}e.resolveWithDes=t;function r(i,n,s=0){let a=t(i,n,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=r})(GA||(GA={}));var dh;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Ms.defaultData,...n,component:i,overrides:new Mn,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=r0.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})(dh||(dh={}));var i0;(e=>{e.defaultData={type:"Page",...Ms.defaultData,physics:{...e0.defaultData,fusedBody:!1},...yN.defaultData,camera:px.defaultData};function t(r){return r.uiScene!==void 0}e.isUIPage=t})(i0||(i0={}));var _N;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Zv.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:e0.defaultData,states:new Nt,events:new Nt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Jv.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Ms.defaultData,...uv.defaultData,geometry:cv.defaultData("RectangleGeometry"),material:Zs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Ms.defaultData,...uv.defaultData,geometry:cv.defaultData("BooleanGeometry"),material:Zs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Ms.defaultData,...uv.defaultData,geometry:cv.defaultData("TextGeometry"),material:Zs.defaultTwoLayerData("phong","layer1","layer2")}))(_N||(_N={}));var Wf;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new Mn}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new Mn})))):Fp.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function r(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=fx(o.material,l=>{if(typeof l!="string")for(let[c,d]of Object.entries(a.material.layers)){let u=l.layers.data(c);u&&Qn.patch(u,d)}}).data),o.materials&&a.materials&&(o.materials=fx(o.materials,l=>{var c,d;for(let u=0;u<o.materials.length;u++){let h=a.materials[u];if(typeof h!="string")for(let[f,p]of Object.entries(h.layers)){let m=(d=(c=l[u])==null?void 0:c.layers)==null?void 0:d.data(f);m&&Qn.patch(m,p)}}}).data),o}function i(s,a){let o,l=[],c={orthographic:0,perspective:0,geometry:0};function d(u,h){for(let[f,p]of Object.entries(h.layers)){let{texture:m,...g}=p;if(m!==void 0&&Object.keys(m).length>0){let v={path:[...u,"layers",f,"texture"],props:m,type:0};l.push(v)}if(Object.keys(g).length>0){let v={path:[...u,"layers",f],props:g,type:0};l.push(v)}}}for(let[u,h]of Object.entries(a))if(u!=="name")if(u==="cloner")l.push(...sN.toOps(h,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:h.slide,offset:h.offset},type:0});else if(u==="material")d(["material"],h);else if(u==="materials")for(let[f,p]of Object.entries(h))d(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&h.extrusion!==void 0){let f={path:[u,"extrusion"],props:h.extrusion,type:0};l.push(f),h={...h},delete h.extrusion}if(Object.keys(h).length>0){let f={path:[u],props:h,type:0};l.push(f)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[u]=h;return l}e.toOps=i;function n(s,a){var l,c,d,u,h,f;if(a===void 0)return s;let o={...s};if(Object.assign(o,r0.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=a.pathSnapping)==null?void 0:l.slide)??((c=o.pathSnapping)==null?void 0:c.slide)??0,offset:((d=a.pathSnapping)==null?void 0:d.offset)??((u=o.pathSnapping)==null?void 0:u.offset)??0})}),Fp.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let p=a;((h=p.orthographic)==null?void 0:h.zoom)!==void 0&&(o.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(o.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(o.targetOffset=p.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:hN.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=r(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:uh.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:uh.merge(o.cloner,a.cloner)});else if(aN.is(s.type)){let p=a;p.intensity!==void 0&&(o.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?o.color=p.color:o.color=$s.clone(p.color))}return o}e.patch=n})(Wf||(Wf={}));var qA;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(qA||(qA={}));var hh;(e=>e.defaultData={orbitControls:qA.defaultData,playPage:eb,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(hh||(hh={}));var SN;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(SN||(SN={}));var EN;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(EN||(EN={}));var Gf;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...SN.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:EN.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(Gf||(Gf={}));var mx;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,s){i.scene.objects.traverseFrom(n,(a,o)=>{var l;if(o.type==="Instance"){let c=(l=QA.getComponentData(i,o.component))==null?void 0:l.data;c&&s(a,o,c.events)}else s(a,o,o.events)})}e.traverseModuleInstances=r})(mx||(mx={}));var qf;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function t(n={withLight:!0,withSquare:!0}){let s=[],a=_N.defaultMeshObject;n.withLight===!0&&s.push({fi:-1,data:wN.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),n.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:a,children:[]});let o=new _s;return o.push({fi:1,id:eb,data:{...i0.defaultData,name:"Scene 1"},children:s}),o}e.defaultData={objects:t(),publish:hh.defaultData,styles:Gf.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new _s,publish:hh.defaultData,styles:Gf.defaultData()}},e.emptyDataWithPage=function(n){return{objects:t(n),publish:hh.defaultData,styles:Gf.defaultData()}},e.emptyData=function(){return{objects:new _s,publish:{...hh.defaultData},styles:Gf.defaultData()}};function r(n){return{...e.defaultData,objects:Jc(n,_s.prototype)}}e.withObjs=r;function i(n,s){return r([{id:n,data:s,children:[],fi:0}])}e.withObj=i})(qf||(qf={}));var tb;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(tb||(tb={}));var XA;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(XA||(XA={}));var go;(e=>{function t(a){return a.textValue!==void 0}e.isTextValue=t;function r(a){return typeof a=="number"}e.isNumber=r;function i(a){return typeof a=="boolean"}e.isBoolean=i;function n(a){return t(a)?"string":i(a)?"boolean":"number"}e.typeOfVariable=n;function s(a){return e.isTextValue(a)?Array.isArray(a.textValue)?a.textValue.map(o=>o.toString().padStart(a.padding??2,"0")).join(a.deliminator??":")+(a.suffix!==void 0?" "+a.suffix:""):a.textValue.toString():e.isBoolean(a)?a?"True":"False":e.isNumber(a)?parseFloat(a.toFixed(3)).toString():a.toString()}e.getDisplayedValue=s})(go||(go={}));var CN;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(CN||(CN={}));var zG;(e=>e.all=[...CN.all,"components"])(zG||(zG={}));var BG;(e=>{function t(){return{images:new Zt,videos:new Zt,colors:new Zt,audios:new Zt,particles:new Zt,fonts:new Zt,materials:new Zt,components:new Zt,variables:new Zt}}e.defaultData=t})(BG||(BG={}));var jp;(e=>{function t(){return{images:new Zt,videos:new Zt,colors:new Zt,audios:new Zt,particles:new Zt,fonts:new Zt,materials:new Zt,components:new Zt,variables:new Zt}}e.defaultData=t})(jp||(jp={}));var Ho;(e=>{function t(){let a={};return a["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Jc(a,Zt.prototype)}e.defaultColors=t;function r(a){let o={};return a!=null&&a.withAITexture&&(o["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...XA.emptyImage,name:"AI generated image"}),Jc(o,Zt.prototype)}e.defaultImages=r;function i(){return{catelogs:new Zt,materials:new Zt,images:new Zt,videos:new Zt,colors:new Zt,audios:new Zt,particles:new Zt,fonts:new Zt,variables:new Nt,lib:jp.defaultData()}}e.emptyData=i;function n(a){switch(a){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let o=[0,0,0];return{name:"Time",value:{textValue:o,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:o,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",a)}}e.defaultVariables=n;function s(a,o){if(o.format==="HH:mm:ss"){let l=Math.floor(a/3600),c=Math.floor((a-l*3600)/60),d=Math.round(a-l*3600-c*60);return{textValue:[l,c,d]}}else if(o.format==="mm:ss"){let l=Math.floor(a/60),c=Math.round(a-l*60);return{textValue:[l,c]}}else return o.format==="number"?a=Math.round(a):a=Math.round(a*1e3)/1e3,a}e.getFormattedTimerTime=s})(Ho||(Ho={}));var YA;(e=>e.list=["idle","move","jump","run"])(YA||(YA={}));var KA;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Nt,move:new Nt,jump:new Nt,run:new Nt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:ei.fromHexAndA(3728051,1)}}))(KA||(KA={}));function FG(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let o=2;o<10;o++)n.push(n[1]),s.push(1);let a={...Yu(ln(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...ln(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function Kd(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function Qd(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,s)=>{n===void 0&&(i.materials[s]=Zs.defaultData(),n=i.materials[s]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=Zs.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=Zs.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==Mn.prototype&&t(n.material)})})}function IQe(e){Object.assign(e.scene.publish,{orbitControls:{...qA.defaultData,...ln(e.scene.publish.orbitControls)}})}function RQe(e){Object.assign(e.scene.publish.settings,{video:{...hh.defaultData.settings.video,...ln(e.scene.publish.settings.video)}})}function DQe(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,s]of Object.entries(i))if((Cae.includes(n)||typeof s=="boolean")&&delete i[n],n==="texture")for(let[a,o]of Object.entries(s))(PQe.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let s=n;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function OQe(e){e.scene.publish.withBackground=!0}function LQe(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function NQe(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function kQe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function zQe(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=ln(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=ln(r).booleanExclude!==!0)}})}function BQe(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function FQe(e){function t(i){Object.setPrototypeOf(i,Mn.prototype),i.texture&&Object.setPrototypeOf(i.texture,Mn.prototype)}function r(i){Object.setPrototypeOf(i,Mn.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(s=>{let a=s;if(a.material){let o=ln(a.material).layers;r(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],c=ln(l).layers;r(c),l.layers=c}})})}function jG(e){e.layers===void 0&&Object.assign(e,Zs.defaultTwoLayerData("lambert"))}function kR(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...ln(t),colors:r,steps:i};Object.assign(t,n)}})}function jQe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function VG(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&kR(i)}):"material"in r&&typeof r.material!="string"&&kR(r.material)}),Object.values(e.shared.materials).forEach(t=>kR(t))}function VQe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function UQe(e){e.shared.audios=Jc({},Zt.prototype)}function $Qe(e){e.shared.videos=Jc({},Zt.prototype)}function HQe(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function WQe(e){Object.entries(ln(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(ln(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function GQe(e){e.scene.publish.settings.web.preload=!1}function UG(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function $G(e){e.layers&&e.layers.forEach(t=>{MQe(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function qQe(e){e.shared.fonts=Jc({},Zt.prototype)}function XQe(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function YQe(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let s=Zs.defaultTwoLayerData("phong"),a=typeof n.color=="string"?e.shared.colors[n.color]:n.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=n.alpha;let o=XQe(n.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:n.name,...Ms.defaultData,...uv.defaultData,flatShading:!1,wireframe:!1,geometry:{...cv.defaultData("TextGeometry"),width:n.width,height:n.height,font:o,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:ln(n.states),events:ln(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=ln(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function KQe(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new Nt,move:new Nt,jump:new Nt}});else{let s=new Nt;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:Et.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((a,o,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},d={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(d,Yu(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(d,{control1:{...a.control1},control2:{...a.control2}});let u={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},h={state:a.state,...u,...d},f={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Nt({fi:0,id:Et.generateUUID(),data:c},{fi:1,id:Et.generateUUID(),data:h})};s.push({fi:l,id:o,data:f})}),delete n.targets)}})})}function QQe(e){e.scene.objects.traverse((t,r)=>{function i(n,s){var l;let a=new Nt,o=[];if(r.events.forEach((c,d,u)=>{if(c.type==="Audio"&&c.trigger===s){let h;o.push(d),c.interaction==="play"?h={...Yu(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(h={...Yu(c,"interaction","delay","object","playAudio"),type:"Audio"}),h&&a.push({fi:u,id:d,data:h})}}),o.forEach(c=>r.events.delete(c)),a.length){let c=(l=r.events.find(d=>d.type===n))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,a):r.events.insertBefore(null,[{id:Et.generateUUID(),data:{type:n,actions:a}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function HG(e){var r;let t=(r=e.layers.find(i=>i.type==="light"))==null?void 0:r.data;if((t==null?void 0:t.category)==="basic"){let i=Qn.defaultData("light","phong"),n=t;Object.assign(n,i),n.visible=!1}}function WG(e){Kd(e,HG),Qd(e,HG)}function ZQe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function JQe(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function eZe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=Zs.defaultTwoLayerData("phong"))})}function tZe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function rZe(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function iZe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function nZe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function sZe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function aZe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function oZe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=KA.defaultDataThirdPerson.navmesh)})})}function lZe(e){e.scene.styles||(e.scene.styles=Gf.defaultData())}function GG(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function cZe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Qd(e,GG),Kd(e,GG)}function uZe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new Nt})})})}function dZe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function qG(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function hZe(e,t){if(t<1&&(Qd(e,FG),Kd(e,FG),e.schema=1),t<2&&(IQe(e),e.schema=2),t<3&&(DQe(e),e.schema=3),t<4&&(OQe(e),e.schema=4),t<5&&(LQe(e),e.schema=5),t<6&&(NQe(e),e.schema=6),t<7&&(kQe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(VG(e),e.schema=9),t<10&&(jQe(e),e.schema=10),t<11&&(VQe(e),e.schema=11),t<12&&(VG(e),e.schema=12),t<13&&(UQe(e),e.schema=13),t<14&&(HQe(e),e.schema=14),t<15&&(WQe(e),e.schema=15),t<16&&(GQe(e),e.schema=16),t<17&&(Qd(e,UG),Kd(e,UG),e.schema=17),t<18&&(Qd(e,jG),Kd(e,jG),e.schema=18),t<19&&(RQe(e),e.schema=19),t<20&&(qQe(e),YQe(e),e.schema=20),t<21&&(KQe(e),QQe(e),e.schema=21),t<22&&(WG(e),e.schema=22),t<23&&(ZQe(e),e.schema=23),t<24&&(JQe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&($Qe(e),t<25&&(e.schema=25)),t<26&&(zQe(e),e.schema=26),t<27&&(BQe(e),e.schema=27),t<28&&(WG(e),e.schema=28),t<29&&(FQe(e),e.schema=29),t<30&&(eZe(e),e.schema=30),t<31&&(tZe(e),e.schema=31),t<33&&(rZe(e),e.schema=33),t<34&&(iZe(e),e.schema=34),t<35&&(nZe(e),e.schema=35),t<36&&(sZe(e),e.schema=36),t<37&&(aZe(e),e.schema=37),t<38&&(Qd(e,$G),Kd(e,$G),e.schema=38),t<39&&(oZe(e),e.schema=39),t<40&&(lZe(e),e.schema=40),t<41&&(cZe(e),e.schema=41),t<42&&(uZe(e),e.schema=42),t<43&&(dZe(e),e.schema=43),t<99){Qd(e,qG),Kd(e,qG),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=H0);let r=ln(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=eb,i.insertBefore(null,null,[{id:eb,data:{...i0.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:Yu(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:Yu(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...t0.defaultData,...Yu(e.scene.environment,"usePhysics","gravity")},camera:ln(e.scene.ownerCamera)??i0.defaultData.camera,name:"Scene"},children:[]}]);for(let a of r)a.id!==qf.TRASH_CAN_ID&&i.move(eb,a.fi,a.id);let n=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,e0.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function XG(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function fZe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}function pZe(e){var t;Array.isArray(ln(e.events))&&((t=e.events)==null||t.forEach(r=>{"disabled"in r||(r.disabled=!1),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress")&&(r.mode=r.mode||"Object")}))}var yg=180/Math.PI;function YG(e){e.rotation=e.rotation.slice(0,3).map(t=>t*yg)}function Pae(e){var r,i;YG(e),e.type==="Page"&&YG(e.camera),(r=e.states)==null||r.forEach(n=>{n.rotation===void 0||n.rotation===null||(n.rotation=n.rotation.slice(0,3).map(s=>s*yg))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*yg),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*yg),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=yg,t.extrusion.twist*=yg),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(ln(e.events))&&((i=e.events)==null||i.forEach(n=>{(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"||n.type==="Collision"||n.type==="Trigger")&&(n.runMode=n.toggle?"Toggle":"Repeat")}))}function mZe(e){e.shared.variables=Jc({},Zt.prototype)}function gZe(e){let t=ln(e.shared.variables);e.shared.variables=Jc(Object.entries(t??{}).map(([r,i],n)=>({fi:n,id:r,data:i})),Nt.prototype)}var Pu=111;function Iae(e,t){t(e.data);for(let r of e.children)Iae(r,t)}function vZe(e){let t=e.schema??104;t!==Pu&&t<105&&(Iae(e.asset,Pae),e.schema=105)}function yZe(e){e.shared.particles=Jc({},Zt.prototype),e.shared.lib&&(e.shared.lib.particles=jp.defaultData().particles)}function bZe(e){e.scene.objects.traverse((t,r)=>{r.type==="Particle"&&typeof r.renderMaterial.size=="number"&&Object.assign(r.renderMaterial,{size:[r.renderMaterial.size,r.renderMaterial.size]})})}function Rae(e){let t=e.schema??0;if(t!==Pu){console.warn("updating from ",t,"to ",Pu),hZe(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=hh.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Qd(e,XG),Kd(e,XG),e.schema=101),t<102&&(fZe(e),e.schema=102),t<104&&(e.shared.catelogs=new Zt,e.shared.lib=jp.defaultData(),e.schema=104),t<105&&(mZe(e),e.scene.objects.traverse((r,i)=>{Pae(i)}),e.schema=105);for(let r of Object.values(e.shared.lib.components))vZe(r);t<106&&(gZe(e),e.schema=106),t<107&&(e.shared.lib.variables=jp.defaultData().variables,e.schema=107),t<109&&(yZe(e),e.schema=109),t<110&&(bZe(e),e.schema=110),t<111&&(e.scene.objects.traverse((r,i)=>{pZe(i)}),e.schema=111)}}var QA;(e=>{e.defaultData={schema:Pu,scene:qf.defaultData,frames:new Zt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",tb.defaultData),shared:{...Ho.emptyData(),colors:Ho.defaultColors()}},e.emptyDataForImports=function(n){let s=qf.emptyDataWithPage(n);return{schema:Pu,scene:s,frames:new Zt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",tb.defaultData),shared:{...Ho.emptyData(),colors:Ho.defaultColors(),images:Ho.defaultImages(n)}}},e.emptyData=function(){return{schema:Pu,scene:qf.emptyDataWithPage(),frames:new Zt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",tb.defaultData),shared:Ho.emptyData()}},e.clipboard2dData=function(){return{schema:Pu,scene:qf.emptyData(),frames:new Zt,shared:Ho.emptyData()}},e.collabHelper={...qL,updateSchema(n){return(n.schema??0)<Pu?fx(n,Rae):(n.schema??0)-Pu}};function t(n){let s=e.collabHelper.updateSchema(n);return typeof s=="number"?s===0?n:null:s.data}e.updateSchemaDirectly=t;function r(n){return{...n,shared:{...n.shared,lib:jp.defaultData()}}}e.withoutLib=r;function i(n,s){let a=n.scene.objects.get(s);if(a&&a.data.type==="Component")return a;{let o=n.shared.lib.components[s];if(o)return o.asset}}e.getComponentData=i})(QA||(QA={}));var KG;(e=>{function t(r){return!0}e.is=t})(KG||(KG={}));var ZA;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0};function t(i,n){return{position:(n==null?void 0:n.position)??i.position,rotation:(n==null?void 0:n.rotation)??i.rotation,scale:(n==null?void 0:n.scale)??i.scale}}e.merge=t;function r(i,n){return Wse({position:ch.isEqual(i.position,n.position)?void 0:n.position,rotation:i.rotation===n.rotation?void 0:n.rotation,scale:ch.isEqual(i.scale,n.scale)?void 0:n.scale})}e.diff=r})(ZA||(ZA={}));var AN;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})(AN||(AN={}));var JA;(e=>e.defaultData={opacity:1,fill:{color:ei.white,enabled:!0},stroke:{color:ei.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:ei.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:ei.from0to1([0,0,0,1]),enabled:!1,spread:0}})(JA||(JA={}));var Xf;(e=>{function t(a,o){return{name:o}}e.newEmpty=t;function r(a,o){if(o===void 0)return a;let l={...a},c=["width","height","cornerRadius"];for(let d of c)d in l&&d in o&&o[d]!==void 0&&Object.assign(l,{[d]:o[d]});return l}function i(a,o){if(o===void 0)return a;let l={...a};return"fill"in l&&"fill"in o&&o.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...o.fill}}),"stroke"in l&&"stroke"in o&&o.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...o.stroke}}),"layerBlur"in l&&"layerBlur"in o&&o.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...o.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in o&&o.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...o.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in o&&o.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...o.dropShadow}}),"innerShadow"in l&&"innerShadow"in o&&o.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...o.innerShadow}}),l}function n(a,o){if(o===void 0)return a;let l={...a};return Object.assign(l,ZA.merge(l,o)),l=r(l,o),l=i(l,o),l}e.patch=n;function s(a,o){let l,c=[];for(let[d,u]of Object.entries(o))d!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},c.push(l)),l.props[d]=u);return c}e.toOps=s})(Xf||(Xf={}));var gx;(e=>e.defaultData={...ZA.defaultData,...AN.defaultData,states:new Nt,events:new Nt,visible:!0,raycastLock:!1})(gx||(gx={}));var n0;(e=>e.defaultData={...gx.defaultData,...JA.defaultData})(n0||(n0={}));var eT;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(eT||(eT={}));var TN;(e=>e.defaultData={...n0.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(TN||(TN={}));var vx;(e=>e.defaultData={...n0.defaultData,...eT.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(vx||(vx={}));var MN;(e=>e.defaultData={...n0.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(MN||(MN={}));var PN;(e=>e.defaultData={...n0.defaultData,type:"path2d",path:"",name:"Path"})(PN||(PN={}));var QG;(e=>{function t(r){return r.type==="ellipse2d"||r.type==="rectangle2d"||r.type==="text2d"||r.type==="vector2d"||r.type==="path2d"}e.is=t})(QG||(QG={}));var tT;(e=>e.defaultData={...gx.defaultData,name:"Group",type:"group2d"})(tT||(tT={}));var IN;(e=>e.defaultData={...gx.defaultData,...eT.defaultData,...JA.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:ei.fromHexAndA(So,1),enabled:!0},stroke:{color:ei.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}})(IN||(IN={}));var hp;(e=>{function t(s){switch(s){case"rectangle2d":return{...vx.defaultData};case"ellipse2d":return{...TN.defaultData};case"text2d":return{...MN.defaultData};case"vector2d":return{...vx.defaultData};case"path2d":return{...PN.defaultData};case"frame2d":return{...IN.defaultData};case"group2d":return{...tT.defaultData}}}e.defaultData=t;function r(s){return"width"in s&&"height"in s?[typeof s.width=="number"?s.width*.5:0,typeof s.height=="number"?s.height*.5:0]:[0,0]}e.getPivot=r;function i(s){return s.type==="rectangle2d"||s.type==="ellipse2d"||s.type==="text2d"||s.type==="frame2d"}e.isResizeable=i;function n(s){return s.type==="rectangle2d"||s.type==="frame2d"}e.hasCorners=n})(hp||(hp={}));var RN;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new _s},e.emptyData=function(){return{type:"scene2d",objects:new _s}}))(RN||(RN={}));function Yf(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new Dt,c=0;for(let d=0;d<e.length;++d){let u=e[d],h=0;if(r!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(u.attributes[f]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(o!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;a[f]===void 0&&(a[f]=[]),a[f].push(u.morphAttributes[f])}if(t){let f;if(r)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,d),c+=f}}if(r){let d=0,u=[];for(let h=0;h<e.length;++h){let f=e[h].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+d);d+=e[h].attributes.position.count}l.setIndex(u)}for(let d in s){let u=ZG(s[d]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" attribute."),null;l.setAttribute(d,u)}for(let d in a){let u=a[d][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[d]=[];for(let h=0;h<u;++h){let f=[];for(let m=0;m<a[d].length;++m)f.push(a[d][m][h]);let p=ZG(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" morphAttribute."),null;l.morphAttributes[d].push(p)}}return l}function ZG(e){let t,r,i,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new Wt(s,r,i)}var xZe=Math.pow(2,-24),iS=class{constructor(){}};function Mc(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function JG(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function e9(e,t){t.set(e)}function t9(e,t,r){let i,n;for(let s=0;s<3;s++){let a=s+3;i=e[s],n=t[s],r[s]=i<n?i:n,i=e[a],n=t[a],r[a]=i>n?i:n}}function nS(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],s=t[e+2*i+1],a=n-s,o=n+s;a<r[i]&&(r[i]=a),o>r[i+3]&&(r[i+3]=o)}}function Oy(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function wZe(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new Wt(n,1));for(let s=0;s<r;s++)n[s]=s}}function _Ze(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,s)=>n-s);for(let n=0;n<i.length-1;n++){let s=i[n],a=i[n+1];t.push({offset:s/3,count:(a-s)/3})}return t}function zR(e,t,r,i,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,d=-1/0,u=1/0,h=1/0,f=1/0,p=-1/0,m=-1/0,g=-1/0,v=n!==null;for(let y=t*6,b=(t+r)*6;y<b;y+=6){let x=e[y+0],S=e[y+1],w=x-S,E=x+S;w<s&&(s=w),E>l&&(l=E),v&&x<u&&(u=x),v&&x>p&&(p=x);let C=e[y+2],T=e[y+3],A=C-T,M=C+T;A<a&&(a=A),M>c&&(c=M),v&&C<h&&(h=C),v&&C>m&&(m=C);let P=e[y+4],I=e[y+5],R=P-I,N=P+I;R<o&&(o=R),N>d&&(d=N),v&&P<f&&(f=P),v&&P>g&&(g=P)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=d,v&&(n[0]=u,n[1]=h,n[2]=f,n[3]=p,n[4]=m,n[5]=g)}function SZe(e,t,r,i){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let d=t*6,u=(t+r)*6;d<u;d+=6){let h=e[d+0];h<n&&(n=h),h>o&&(o=h);let f=e[d+2];f<s&&(s=f),f>l&&(l=f);let p=e[d+4];p<a&&(a=p),p>c&&(c=p)}i[0]=n,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}function EZe(e,t,r,i,n){let s=r,a=r+i-1,o=n.pos,l=n.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let c=0;c<3;c++){let d=e[s*3+c];e[s*3+c]=e[a*3+c],e[a*3+c]=d;let u=t[s*6+c*2+0];t[s*6+c*2+0]=t[a*6+c*2+0],t[a*6+c*2+0]=u;let h=t[s*6+c*2+1];t[s*6+c*2+1]=t[a*6+c*2+1],t[a*6+c*2+1]=h}s++,a--}else return s}}var _u=32,CZe=(e,t)=>e.candidate-t.candidate,Id=new Array(_u).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),sS=new Float32Array(6);function AZe(e,t,r,i,n,s){let a=-1,o=0;if(s===0)a=JG(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=JG(e),a!==-1&&(o=TZe(r,i,n,a));else if(s===2){let l=Oy(e),c=1.25*n,d=i*6,u=(i+n)*6;for(let h=0;h<3;h++){let f=t[h],p=(t[h+3]-f)/_u;if(n<_u/4){let m=[...Id];m.length=n;let g=0;for(let y=d;y<u;y+=6,g++){let b=m[g];b.candidate=r[y+2*h],b.count=0;let{bounds:x,leftCacheBounds:S,rightCacheBounds:w}=b;for(let E=0;E<3;E++)w[E]=1/0,w[E+3]=-1/0,S[E]=1/0,S[E+3]=-1/0,x[E]=1/0,x[E+3]=-1/0;nS(y,r,x)}m.sort(CZe);let v=n;for(let y=0;y<v;y++){let b=m[y];for(;y+1<v&&m[y+1].candidate===b.candidate;)m.splice(y+1,1),v--}for(let y=d;y<u;y+=6){let b=r[y+2*h];for(let x=0;x<v;x++){let S=m[x];b>=S.candidate?nS(y,r,S.rightCacheBounds):(nS(y,r,S.leftCacheBounds),S.count++)}}for(let y=0;y<v;y++){let b=m[y],x=b.count,S=n-b.count,w=b.leftCacheBounds,E=b.rightCacheBounds,C=0;x!==0&&(C=Oy(w)/l);let T=0;S!==0&&(T=Oy(E)/l);let A=1+1.25*(C*x+T*S);A<c&&(a=h,c=A,o=b.candidate)}}else{for(let v=0;v<_u;v++){let y=Id[v];y.count=0,y.candidate=f+p+v*p;let b=y.bounds;for(let x=0;x<3;x++)b[x]=1/0,b[x+3]=-1/0}for(let v=d;v<u;v+=6){let y=~~((r[v+2*h]-f)/p);y>=_u&&(y=_u-1);let b=Id[y];b.count++,nS(v,r,b.bounds)}let m=Id[_u-1];e9(m.bounds,m.rightCacheBounds);for(let v=_u-2;v>=0;v--){let y=Id[v],b=Id[v+1];t9(y.bounds,b.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let v=0;v<_u-1;v++){let y=Id[v],b=y.count,x=y.bounds,S=Id[v+1].rightCacheBounds;b!==0&&(g===0?e9(x,sS):t9(x,sS,sS)),g+=b;let w=0,E=0;g!==0&&(w=Oy(sS)/l);let C=n-g;C!==0&&(E=Oy(S)/l);let T=1+1.25*(w*g+E*C);T<c&&(a=h,c=T,o=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function TZe(e,t,r,i){let n=0;for(let s=t,a=t+r;s<a;s++)n+=e[s*6+i*2];return n/r}function MZe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,s=new Float32Array(n*6),a=r.normalized,o=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let d=["getX","getY","getZ"];for(let u=0;u<n;u++){let h=u*3,f=u*6,p,m,g;a?(p=i[h+0],m=i[h+1],g=i[h+2]):(p=i[h+0]*c+l,m=i[h+1]*c+l,g=i[h+2]*c+l);for(let v=0;v<3;v++){let y,b,x;a?(y=r[d[v]](p),b=r[d[v]](m),x=r[d[v]](g)):(y=o[p+v],b=o[m+v],x=o[g+v]);let S=y;b<S&&(S=b),x<S&&(S=x);let w=y;b>w&&(w=b),x>w&&(w=x);let E=(w-S)/2,C=v*2;s[f+C+0]=S+E,s[f+C+1]=E+(Math.abs(S)+E)*xZe,S<t[v]&&(t[v]=S),w>t[v+3]&&(t[v+3]=w)}}return s}function PZe(e,t){function r(v){h&&h(v/f)}function i(v,y,b,x=null,S=0){if(!p&&S>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),b<=d||S>=l)return r(y+b),v.offset=y,v.count=b,v;let w=AZe(v.boundingData,x,a,y,b,u);if(w.axis===-1)return r(y+b),v.offset=y,v.count=b,v;let E=EZe(o,a,y,b,w);if(E===y||E===y+b)r(y+b),v.offset=y,v.count=b;else{v.splitAxis=w.axis;let C=new iS,T=y,A=E-y;v.left=C,C.boundingData=new Float32Array(6),zR(a,T,A,C.boundingData,s),i(C,T,A,s,S+1);let M=new iS,P=E,I=b-A;v.right=M,M.boundingData=new Float32Array(6),zR(a,P,I,M.boundingData,s),i(M,P,I,s,S+1)}return v}wZe(e,t);let n=new Float32Array(6),s=new Float32Array(6),a=MZe(e,n),o=e.index.array,l=t.maxDepth,c=t.verbose,d=t.maxLeafTris,u=t.strategy,h=t.onProgress,f=e.index.count/3,p=!1,m=[],g=_Ze(e);if(g.length===1){let v=g[0],y=new iS;y.boundingData=n,SZe(a,v.offset,v.count,s),i(y,v.offset,v.count,s),m.push(y)}else for(let v of g){let y=new iS;y.boundingData=new Float32Array(6),zR(a,v.offset,v.count,y.boundingData,s),i(y,v.offset,v.count,s),m.push(y)}return m}function IZe(e,t){let r=PZe(e,t),i,n,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let d=0;d<r.length;d++){let u=r[d],h=l(u),f=new o(32*h);i=new Float32Array(f),n=new Uint32Array(f),s=new Uint16Array(f),c(0,u),a.push(f)}return a;function l(d){return d.count?1:1+l(d.left)+l(d.right)}function c(d,u){let h=d/4,f=d/2,p=!!u.count,m=u.boundingData;for(let g=0;g<6;g++)i[h+g]=m[g];if(p){let g=u.offset,v=u.count;return n[h+6]=g,s[f+14]=v,s[f+15]=65535,d+32}else{let g=u.left,v=u.right,y=u.splitAxis,b;if(b=c(d+32,g),b/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[h+6]=b/4,b=c(b,v),n[h+7]=y,b}}}var dd=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,i=-1/0;for(let n=0,s=e.length;n<s;n++){let a=e[n][t];r=a<r?a:r,i=a>i?a:i}this.min=r,this.max=i}setFromPoints(e,t){let r=1/0,i=-1/0;for(let n=0,s=t.length;n<s;n++){let a=t[n],o=e.dot(a);r=o<r?o:r,i=o>i?o:i}this.min=r,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};dd.prototype.setFromBox=function(){let e=new L;return function(t,r){let i=r.min,n=r.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*o+n.x*(1-o),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let d=t.dot(e);s=Math.min(d,s),a=Math.max(d,a)}this.min=s,this.max=a}}();var RZe=function(){let e=new L,t=new L,r=new L;return function(i,n,s){let a=i.start,o=e,l=n.start,c=t;r.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let d=r.dot(c),u=c.dot(o),h=c.dot(c),f=r.dot(o),p=o.dot(o)*h-u*u,m,g;p!==0?m=(d*u-f*h)/p:m=0,g=(d+m*u)/h,s.x=m,s.y=g}}(),uj=function(){let e=new oe,t=new L,r=new L;return function(i,n,s,a){RZe(i,n,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){i.at(o,s),n.at(l,a);return}else if(o>=0&&o<=1){l<0?n.at(0,a):n.at(1,a),i.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?i.at(0,s):i.at(1,s),n.closestPointToPoint(s,!0,a);return}else{let c;o<0?c=i.start:c=i.end;let d;l<0?d=n.start:d=n.end;let u=t,h=r;if(i.closestPointToPoint(d,!0,t),n.closestPointToPoint(c,!0,r),u.distanceToSquared(d)<=h.distanceToSquared(c)){s.copy(u),a.copy(d);return}else{s.copy(c),a.copy(h);return}}}}(),DZe=function(){let e=new L,t=new L,r=new co,i=new el;return function(n,s){let{radius:a,center:o}=n,{a:l,b:c,c:d}=s;if(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=d,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=c,i.end=d,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let u=s.getPlane(r);if(Math.abs(u.distanceToPoint(o))<=a){let h=u.projectPoint(o,t);if(s.containsPoint(h))return!0}return!1}}(),OZe=1e-15;function Wm(e){return Math.abs(e)<OZe}var hd=class extends xs{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new L),this.satBounds=new Array(4).fill().map(()=>new dd),this.points=[this.a,this.b,this.c],this.sphere=new Za,this.plane=new co,this.needsUpdate=!0}intersectsSphere(e){return DZe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,s=this.satBounds,a=n[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=n[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,i);let d=n[2],u=s[2];d.subVectors(t,r),u.setFromPoints(d,i);let h=n[3],f=s[3];h.subVectors(r,e),f.setFromPoints(h,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};hd.prototype.closestPointToSegment=function(){let e=new L,t=new L,r=new el;return function(i,n=null,s=null){let{start:a,end:o}=i,l=this.points,c,d=1/0;for(let u=0;u<3;u++){let h=(u+1)%3;r.start.copy(l[u]),r.end.copy(l[h]),uj(r,i,e,t),c=e.distanceToSquared(t),c<d&&(d=c,n&&n.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<d&&(d=c,n&&n.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<d&&(d=c,n&&n.copy(e),s&&s.copy(o)),Math.sqrt(d)}}();hd.prototype.intersectsTriangle=function(){let e=new hd,t=new Array(3),r=new Array(3),i=new dd,n=new dd,s=new L,a=new L,o=new L,l=new L,c=new el,d=new el,u=new el;return function(h,f=null,p=!1){this.needsUpdate&&this.update(),h.isExtendedTriangle?h.needsUpdate&&h.update():(e.copy(h),e.update(),h=e);let m=this.plane,g=h.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let v=this.satBounds,y=this.satAxes;r[0]=h.a,r[1]=h.b,r[2]=h.c;for(let S=0;S<4;S++){let w=v[S],E=y[S];if(i.setFromPoints(E,r),w.isSeparated(i))return!1}let b=h.satBounds,x=h.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let S=0;S<4;S++){let w=b[S],E=x[S];if(i.setFromPoints(E,t),w.isSeparated(i))return!1}for(let S=0;S<4;S++){let w=y[S];for(let E=0;E<4;E++){let C=x[E];if(s.crossVectors(w,C),i.setFromPoints(s,t),n.setFromPoints(s,r),i.isSeparated(n))return!1}}return f&&(p||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let v=this.points,y=!1,b=0;for(let I=0;I<3;I++){let R=v[I],N=v[(I+1)%3];c.start.copy(R),c.end.copy(N),c.delta(a);let k=y?d.start:d.end,O=Wm(g.distanceToPoint(R));if(Wm(g.normal.dot(a))&&O){d.copy(c),b=2;break}if((g.intersectLine(c,k)||O)&&!Wm(k.distanceTo(N))){if(b++,y)break;y=!0}}if(b===1&&h.containsPoint(d.end))return f&&(f.start.copy(d.end),f.end.copy(d.end)),!0;if(b!==2)return!1;let x=h.points,S=!1,w=0;for(let I=0;I<3;I++){let R=x[I],N=x[(I+1)%3];c.start.copy(R),c.end.copy(N),c.delta(o);let k=S?u.start:u.end,O=Wm(m.distanceToPoint(R));if(Wm(m.normal.dot(o))&&O){u.copy(c),w=2;break}if((m.intersectLine(c,k)||O)&&!Wm(k.distanceTo(N))){if(w++,S)break;S=!0}}if(w===1&&this.containsPoint(u.end))return f&&(f.start.copy(u.end),f.end.copy(u.end)),!0;if(w!==2)return!1;if(d.delta(a),u.delta(o),a.dot(o)<0){let I=u.start;u.start=u.end,u.end=I}let E=d.start.dot(a),C=d.end.dot(a),T=u.start.dot(a),A=u.end.dot(a),M=C<T,P=E<A;return E!==A&&T!==C&&M===P?!1:(f&&(l.subVectors(d.start,u.start),l.dot(a)>0?f.start.copy(d.start):f.start.copy(u.start),l.subVectors(d.end,u.end),l.dot(a)<0?f.end.copy(d.end):f.end.copy(u.end)),!0)}}}();hd.prototype.distanceToPoint=function(){let e=new L;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();hd.prototype.distanceToTriangle=function(){let e=new L,t=new L,r=["a","b","c"],i=new el,n=new el;return function(s,a=null,o=null){let l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let d=0;d<3;d++){let u,h=r[d],f=s[h];this.closestPointToPoint(f,e),u=f.distanceToSquared(e),u<c&&(c=u,a&&a.copy(e),o&&o.copy(f));let p=this[h];s.closestPointToPoint(p,e),u=p.distanceToSquared(e),u<c&&(c=u,a&&a.copy(p),o&&o.copy(e))}for(let d=0;d<3;d++){let u=r[d],h=r[(d+1)%3];i.set(this[u],this[h]);for(let f=0;f<3;f++){let p=r[f],m=r[(f+1)%3];n.set(s[p],s[m]),uj(i,n,e,t);let g=e.distanceToSquared(t);g<c&&(c=g,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var eu=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new L,this.max=new L,this.matrix=new Ke,this.invMatrix=new Ke,this.points=new Array(8).fill().map(()=>new L),this.satAxes=new Array(3).fill().map(()=>new L),this.satBounds=new Array(3).fill().map(()=>new dd),this.alignedSatBounds=new Array(3).fill().map(()=>new dd),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};eu.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let d=0;d<=1;d++){let u=1*l|2*c|4*d,h=i[u];h.x=l?r.x:t.x,h.y=c?r.y:t.y,h.z=d?r.z:t.z,h.applyMatrix4(e)}let n=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let c=s[l],d=n[l],u=1<<l,h=i[u];c.subVectors(a,h),d.setFromPoints(c,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();eu.prototype.intersectsBox=function(){let e=new dd;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,a[0].isSeparated(e)||(e.min=r.y,e.max=i.y,a[1].isSeparated(e))||(e.min=r.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],c=n[o];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();eu.prototype.intersectsTriangle=function(){let e=new hd,t=new Array(3),r=new dd,i=new dd,n=new L;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let u=0;u<3;u++){let h=a[u],f=o[u];if(r.setFromPoints(f,t),h.isSeparated(r))return!1}let l=s.satBounds,c=s.satAxes,d=this.points;for(let u=0;u<3;u++){let h=l[u],f=c[u];if(r.setFromPoints(f,d),h.isSeparated(r))return!1}for(let u=0;u<3;u++){let h=o[u];for(let f=0;f<4;f++){let p=c[f];if(n.crossVectors(h,p),r.setFromPoints(n,t),i.setFromPoints(n,d),r.isSeparated(i))return!1}}return!0}}();eu.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();eu.prototype.distanceToPoint=function(){let e=new L;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();eu.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new el),r=new Array(12).fill().map(()=>new el),i=new L,n=new L;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(n),this.closestPointToPoint(n,i),s.closestPointToPoint(i,n),o&&o.copy(i),l&&l.copy(n)),0;let c=a*a,d=s.min,u=s.max,h=this.points,f=1/0;for(let m=0;m<8;m++){let g=h[m];n.copy(g).clamp(d,u);let v=g.distanceToSquared(n);if(v<f&&(f=v,o&&o.copy(g),l&&l.copy(n),v<c))return Math.sqrt(v)}let p=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){let y=(m+1)%3,b=(m+2)%3,x=g<<y|v<<b,S=1<<m|g<<y|v<<b,w=h[x],E=h[S];t[p].set(w,E);let C=e[m],T=e[y],A=e[b],M=r[p],P=M.start,I=M.end;P[C]=d[C],P[T]=g?d[T]:u[T],P[A]=v?d[A]:u[T],I[C]=u[C],I[T]=g?d[T]:u[T],I[A]=v?d[A]:u[T],p++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){n.x=m?u.x:d.x,n.y=g?u.y:d.y,n.z=v?u.z:d.z,this.closestPointToPoint(n,i);let y=n.distanceToSquared(i);if(y<f&&(f=y,o&&o.copy(i),l&&l.copy(n),y<c))return Math.sqrt(y)}for(let m=0;m<12;m++){let g=t[m];for(let v=0;v<12;v++){let y=r[v];uj(g,y,i,n);let b=i.distanceToSquared(n);if(b<f&&(f=b,o&&o.copy(i),l&&l.copy(n),b<c))return Math.sqrt(b)}}return Math.sqrt(f)}}();var Gm=new L,qm=new L,Xm=new L,aS=new oe,oS=new oe,lS=new oe,r9=new L,i9=new L,n9=new L,cS=new L;function LZe(e,t,r,i,n,s){let a;return s===is?a=e.intersectTriangle(i,r,t,!0,n):a=e.intersectTriangle(t,r,i,s!==$a,n),a===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function NZe(e,t,r,i,n,s,a,o,l){Gm.fromBufferAttribute(t,s),qm.fromBufferAttribute(t,a),Xm.fromBufferAttribute(t,o);let c=LZe(e,Gm,qm,Xm,cS,l);if(c){i&&(aS.fromBufferAttribute(i,s),oS.fromBufferAttribute(i,a),lS.fromBufferAttribute(i,o),c.uv=xs.getInterpolation(cS,Gm,qm,Xm,aS,oS,lS,new oe)),n&&(aS.fromBufferAttribute(n,s),oS.fromBufferAttribute(n,a),lS.fromBufferAttribute(n,o),c.uv1=xs.getInterpolation(cS,Gm,qm,Xm,aS,oS,lS,new oe)),r&&(r9.fromBufferAttribute(r,s),i9.fromBufferAttribute(r,a),n9.fromBufferAttribute(r,o),c.normal=xs.getInterpolation(cS,Gm,qm,Xm,r9,i9,n9,new L),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let d={a:s,b:a,c:o,normal:new L,materialIndex:0};xs.getNormal(Gm,qm,Xm,d.normal),c.face=d,c.faceIndex=s}return c}function Dae(e,t,r,i,n){let s=i*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:d,uv:u,uv1:h}=e.attributes,f=NZe(r,c,d,u,h,a,o,l,t);return f?(f.faceIndex=i,n&&n.push(f),f):null}function kZe(e,t,r,i,n,s){for(let a=i,o=i+n;a<o;a++)Dae(e,t,r,a,s)}function zZe(e,t,r,i,n){let s=1/0,a=null;for(let o=i,l=i+n;o<l;o++){let c=Dae(e,t,r,o);c&&c.distance<s&&(a=c,s=c.distance)}return a}function Sc(e,t,r,i){let n=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;r&&(o=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(o),n.y=i.getY(o),n.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function s9(e,t,r,i,n,s,a){let o=r.index,l=r.attributes.position;for(let c=e,d=t+e;c<d;c++)if(Sc(a,c*3,o,l),a.needsUpdate=!0,i(a,c,n,s))return!0;return!1}var Oae=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Zd(e,t){return t[e+15]===65535}function dv(e,t){return t[e+6]}function yx(e,t){return t[e+14]}function bx(e){return e+8}function xx(e,t){return t[e+6]}function BZe(e,t){return t[e+7]}var Hg=new un,rT=new L,FZe=["x","y","z"];function DN(e,t,r,i,n){let s=e*2,a=W0,o=Rh,l=Dh;if(Zd(s,o)){let c=dv(e,l),d=yx(s,o);kZe(t,r,i,c,d,n)}else{let c=bx(e);iT(c,a,i,rT)&&DN(c,t,r,i,n);let d=xx(e,l);iT(d,a,i,rT)&&DN(d,t,r,i,n)}}function ON(e,t,r,i){let n=e*2,s=W0,a=Rh,o=Dh;if(Zd(n,a)){let l=dv(e,o),c=yx(n,a);return zZe(t,r,i,l,c)}else{let l=BZe(e,o),c=FZe[l],d=i.direction[c]>=0,u,h;d?(u=bx(e),h=xx(e,o)):(u=xx(e,o),h=bx(e));let f=iT(u,s,i,rT)?ON(u,t,r,i):null;if(f){let m=f.point[c];if(d?m<=s[h+l]:m>=s[h+l+3])return f}let p=iT(h,s,i,rT)?ON(h,t,r,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var jZe=function(){let e,t,r=[],i=new Oae(()=>new un);return function(...s){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let a=n(...s);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let o=r.length;return o>0&&(t=r[o-1],e=r[o-2]),a};function n(s,a,o,l,c=null,d=0,u=0){function h(y){let b=y*2,x=Rh,S=Dh;for(;!Zd(b,x);)y=bx(y),b=y*2;return dv(y,S)}function f(y){let b=y*2,x=Rh,S=Dh;for(;!Zd(b,x);)y=xx(y,S),b=y*2;return dv(y,S)+yx(b,x)}let p=s*2,m=W0,g=Rh,v=Dh;if(Zd(p,g)){let y=dv(s,v),b=yx(p,g);return Mc(s,m,e),l(y,b,!1,u,d+s,e)}else{let y=bx(s),b=xx(s,v),x=y,S=b,w,E,C,T;if(c&&(C=e,T=t,Mc(x,m,C),Mc(S,m,T),w=c(C),E=c(T),E<w)){x=b,S=y;let k=w;w=E,E=k,C=T}C||(C=e,Mc(x,m,C));let A=Zd(x*2,g),M=o(C,A,w,u+1,d+x),P;if(M===2){let k=h(x),O=f(x)-k;P=l(k,O,!0,u+1,d+x,C)}else P=M&&n(x,a,o,l,c,d,u+1);if(P)return!0;T=t,Mc(S,m,T);let I=Zd(S*2,g),R=o(T,I,E,u+1,d+S),N;if(R===2){let k=h(S),O=f(S)-k;N=l(k,O,!0,u+1,d+S,T)}else N=R&&n(S,a,o,l,c,d,u+1);return!!N}}}(),VZe=function(){let e=new hd,t=new hd,r=new Ke,i=new eu,n=new eu;return function s(a,o,l,c,d=null){let u=a*2,h=W0,f=Rh,p=Dh;if(d===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),d=i),Zd(u,f)){let m=o,g=m.index,v=m.attributes.position,y=l.index,b=l.attributes.position,x=dv(a,p),S=yx(u,f);if(r.copy(c).invert(),l.boundsTree)return Mc(a,h,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:w=>n.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(c),w.b.applyMatrix4(c),w.c.applyMatrix4(c),w.needsUpdate=!0;for(let E=x*3,C=(S+x)*3;E<C;E+=3)if(Sc(t,E,g,v),t.needsUpdate=!0,w.intersectsTriangle(t))return!0;return!1}});for(let w=x*3,E=S+x*3;w<E;w+=3){Sc(e,w,g,v),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let C=0,T=y.count;C<T;C+=3)if(Sc(t,C,y,b),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let m=a+8,g=p[a+6];return Mc(m,h,Hg),!!(d.intersectsBox(Hg)&&s(m,o,l,c,d)||(Mc(g,h,Hg),d.intersectsBox(Hg)&&s(g,o,l,c,d)))}}}();function iT(e,t,r,i){return Mc(e,t,Hg),r.intersectBox(Hg,i)}var LN=[],IE,W0,Rh,Dh;function m1(e){IE&&LN.push(IE),IE=e,W0=new Float32Array(e),Rh=new Uint16Array(e),Dh=new Uint32Array(e)}function uS(){IE=null,W0=null,Rh=null,Dh=null,LN.length&&m1(LN.pop())}var BR=Symbol("skip tree generation"),FR=new un,jR=new un,Ym=new Ke,df=new eu,Ly=new eu,Ny=new L,dS=new L,UZe=new L,$Ze=new L,HZe=new L,a9=new un,ac=new Oae(()=>new hd),rb=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),rb.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),s;return t.cloneBuffers?s={roots:i.map(a=>a.slice()),index:n.array.slice()}:s={roots:i,index:n.array},s}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),rb.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,s=new rb(t,{...r,[BR]:!0});if(s._roots=n,r.setIndex){let a=t.getIndex();if(a===null){let o=new Wt(e.index,1,!1);t.setIndex(o)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[BR]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[BR]||(this._roots=IZe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new un))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,s,a,o,l=0,c=this._roots;for(let u=0,h=c.length;u<h;u++)n=c[u],s=new Uint32Array(n),a=new Uint16Array(n),o=new Float32Array(n),d(0,l),l+=n.byteLength;function d(u,h,f=!1){let p=u*2;if(a[p+15]===65535){let m=s[u+6],g=a[p+14],v=1/0,y=1/0,b=1/0,x=-1/0,S=-1/0,w=-1/0;for(let E=3*m,C=3*(m+g);E<C;E++){let T=r[E],A=i.getX(T),M=i.getY(T),P=i.getZ(T);A<v&&(v=A),A>x&&(x=A),M<y&&(y=M),M>S&&(S=M),P<b&&(b=P),P>w&&(w=P)}return o[u+0]!==v||o[u+1]!==y||o[u+2]!==b||o[u+3]!==x||o[u+4]!==S||o[u+5]!==w?(o[u+0]=v,o[u+1]=y,o[u+2]=b,o[u+3]=x,o[u+4]=S,o[u+5]=w,!0):!1}else{let m=u+8,g=s[u+6],v=m+h,y=g+h,b=f,x=!1,S=!1;e?b||(x=e.has(v),S=e.has(y),b=!x&&!S):(x=!0,S=!0);let w=b||x,E=b||S,C=!1;w&&(C=d(m,h,b));let T=!1;E&&(T=d(g,h,b));let A=C||T;if(A)for(let M=0;M<3;M++){let P=m+M,I=g+M,R=o[P],N=o[P+3],k=o[I],O=o[I+3];o[u+M]=R<k?R:k,o[u+M+3]=N>O?N:O}return A}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);s(0);function s(a,o=0){let l=a*2,c=n[l+15]===65535;if(c){let d=i[a+6],u=n[l+14];e(o,c,new Float32Array(r,a*4,6),d,u)}else{let d=a+8,u=i[a+6],h=i[a+7];e(o,c,new Float32Array(r,a*4,6),h)||(s(d,o+1),s(u,o+1))}}}raycast(e,t=Yl){let r=this._roots,i=this.geometry,n=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let c=0,d=r.length;c<d;c++){let u=a?t[o[c].materialIndex].side:l,h=n.length;if(m1(r[c]),DN(0,i,u,e,n),uS(),a){let f=o[c].materialIndex;for(let p=h,m=n.length;p<m;p++)n[p].face.materialIndex=f}}return n}raycastFirst(e,t=Yl){let r=this._roots,i=this.geometry,n=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=n?t.side:t;for(let c=0,d=r.length;c<d;c++){let u=s?t[o[c].materialIndex].side:l;m1(r[c]);let h=ON(0,i,u,e);uS(),h!=null&&(a==null||h.distance<a.distance)&&(a=h,s&&(h.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(m1(n),i=VZe(0,r,e,t),uS(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let u=t;t=(h,f,p,m)=>{let g=f*3;return u(h,g,g+1,g+2,p,m)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=ac.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let u=o;o=(h,f,p,m,g)=>u(h,f,p,m,g)?!0:s9(h,f,i,l,p,m,n)}else o||(l?o=(u,h,f,p)=>s9(u,h,i,l,f,p,n):o=(u,h,f)=>f);let c=!1,d=0;for(let u of this._roots){if(m1(u),c=jZe(0,i,a,o,s,d),uS(),c)break;d+=u.byteLength}return ac.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;Ym.copy(t).invert();let c=ac.getPrimitive(),d=ac.getPrimitive();if(n){let h=function(f,p,m,g,v,y,b,x){for(let S=m,w=m+g;S<w;S++){Sc(d,S*3,o,l),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let E=f,C=f+p;E<C;E++)if(Sc(c,E*3,s,a),c.needsUpdate=!0,n(c,d,E,S,v,y,b,x))return!0}return!1};if(i){let f=i;i=function(p,m,g,v,y,b,x,S){return f(p,m,g,v,y,b,x,S)?!0:h(p,m,g,v,y,b,x,S)}}else i=h}e.getBoundingBox(jR),jR.applyMatrix4(t);let u=this.shapecast({intersectsBounds:h=>jR.intersectsBox(h),intersectsRange:(h,f,p,m,g,v)=>(FR.copy(v),FR.applyMatrix4(Ym),e.shapecast({intersectsBounds:y=>FR.intersectsBox(y),intersectsRange:(y,b,x,S,w)=>i(h,f,y,b,m,g,S,w)}))});return ac.releasePrimitive(c),ac.releasePrimitive(d),u}intersectsBox(e,t){return df.set(e.min,e.max,t),df.needsUpdate=!0,this.shapecast({intersectsBounds:r=>df.intersectsBox(r),intersectsTriangle:r=>df.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,s=1/0){e.boundingBox||e.computeBoundingBox(),df.set(e.boundingBox.min,e.boundingBox.max,t),df.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,d=e.index,u=ac.getPrimitive(),h=ac.getPrimitive(),f=dS,p=UZe,m=null,g=null;i&&(m=$Ze,g=HZe);let v=1/0,y=null,b=null;return Ym.copy(t).invert(),Ly.matrix.copy(Ym),this.shapecast({boundsTraverseOrder:x=>df.distanceToBox(x),intersectsBounds:(x,S,w)=>w<v&&w<s?(S&&(Ly.min.copy(x.min),Ly.max.copy(x.max),Ly.needsUpdate=!0),!0):!1,intersectsRange:(x,S)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:w=>Ly.distanceToBox(w),intersectsBounds:(w,E,C)=>C<v&&C<s,intersectsRange:(w,E)=>{for(let C=w*3,T=(w+E)*3;C<T;C+=3){Sc(h,C,d,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let A=x*3,M=(x+S)*3;A<M;A+=3){Sc(u,A,l,o),u.needsUpdate=!0;let P=u.distanceToTriangle(h,f,m);if(P<v&&(p.copy(f),g&&g.copy(m),v=P,y=A/3,b=C/3),P<n)return!0}}}});{let w=d?d.count:c.count;for(let E=0,C=w;E<C;E+=3){Sc(h,E,d,c),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let T=x*3,A=(x+S)*3;T<A;T+=3){Sc(u,T,l,o),u.needsUpdate=!0;let M=u.distanceToTriangle(h,f,m);if(M<v&&(p.copy(f),g&&g.copy(m),v=M,y=T/3,b=E/3),M<n)return!0}}}}}),ac.releasePrimitive(u),ac.releasePrimitive(h),v===1/0?null:(r.point?r.point.copy(p):r.point=p.clone(),r.distance=v,r.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(Ym),p.applyMatrix4(Ym),i.distance=p.sub(i.point).length(),i.faceIndex=b),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:c=>(Ny.copy(e).clamp(c.min,c.max),Ny.distanceToSquared(e)),intersectsBounds:(c,d,u)=>u<a&&u<s,intersectsTriangle:(c,d)=>{c.closestPointToPoint(e,Ny);let u=e.distanceToSquared(Ny);return u<a&&(dS.copy(Ny),a=u,o=d),u<n}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(dS):t.point=dS.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Mc(0,new Float32Array(t),a9),e.union(a9)}),e}},ky=Pn(U4e()),WZe=.5*(Math.sqrt(3)-1),zy=(3-Math.sqrt(3))/6,GZe=1/3,oc=1/6,ib=e=>Math.floor(e)|0,o9=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),VR=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function UR(e=Math.random){let t=Lae(e),r=new Float64Array(t).map(n=>o9[n%12*2]),i=new Float64Array(t).map(n=>o9[n%12*2+1]);return function(n,s){let a=0,o=0,l=0,c=(n+s)*WZe,d=ib(n+c),u=ib(s+c),h=(d+u)*zy,f=d-h,p=u-h,m=n-f,g=s-p,v,y;m>g?(v=1,y=0):(v=0,y=1);let b=m-v+zy,x=g-y+zy,S=m-1+2*zy,w=g-1+2*zy,E=d&255,C=u&255,T=.5-m*m-g*g;if(T>=0){let P=E+t[C],I=r[P],R=i[P];T*=T,a=T*T*(I*m+R*g)}let A=.5-b*b-x*x;if(A>=0){let P=E+v+t[C+y],I=r[P],R=i[P];A*=A,o=A*A*(I*b+R*x)}let M=.5-S*S-w*w;if(M>=0){let P=E+1+t[C+1],I=r[P],R=i[P];M*=M,l=M*M*(I*S+R*w)}return 70*(a+o+l)}}function qZe(e=Math.random){let t=Lae(e),r=new Float64Array(t).map(s=>VR[s%12*3]),i=new Float64Array(t).map(s=>VR[s%12*3+1]),n=new Float64Array(t).map(s=>VR[s%12*3+2]);return function(s,a,o){let l,c,d,u,h=(s+a+o)*GZe,f=ib(s+h),p=ib(a+h),m=ib(o+h),g=(f+p+m)*oc,v=f-g,y=p-g,b=m-g,x=s-v,S=a-y,w=o-b,E,C,T,A,M,P;x>=S?S>=w?(E=1,C=0,T=0,A=1,M=1,P=0):x>=w?(E=1,C=0,T=0,A=1,M=0,P=1):(E=0,C=0,T=1,A=1,M=0,P=1):S<w?(E=0,C=0,T=1,A=0,M=1,P=1):x<w?(E=0,C=1,T=0,A=0,M=1,P=1):(E=0,C=1,T=0,A=1,M=1,P=0);let I=x-E+oc,R=S-C+oc,N=w-T+oc,k=x-A+2*oc,O=S-M+2*oc,D=w-P+2*oc,B=x-1+3*oc,z=S-1+3*oc,F=w-1+3*oc,V=f&255,Y=p&255,W=m&255,X=.6-x*x-S*S-w*w;if(X<0)l=0;else{let Z=V+t[Y+t[W]];X*=X,l=X*X*(r[Z]*x+i[Z]*S+n[Z]*w)}let H=.6-I*I-R*R-N*N;if(H<0)c=0;else{let Z=V+E+t[Y+C+t[W+T]];H*=H,c=H*H*(r[Z]*I+i[Z]*R+n[Z]*N)}let ie=.6-k*k-O*O-D*D;if(ie<0)d=0;else{let Z=V+A+t[Y+M+t[W+P]];ie*=ie,d=ie*ie*(r[Z]*k+i[Z]*O+n[Z]*D)}let Q=.6-B*B-z*z-F*F;if(Q<0)u=0;else{let Z=V+1+t[Y+1+t[W+1]];Q*=Q,u=Q*Q*(r[Z]*B+i[Z]*z+n[Z]*F)}return 32*(l+c+d+u)}}function Lae(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var fl=new xs,XZe=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;fl.a.fromBufferAttribute(e,i),fl.b.fromBufferAttribute(e,i+1),fl.c.fromBufferAttribute(e,i+2),n*=fl.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),fl.a.fromBufferAttribute(this.positionAttribute,e*3),fl.b.fromBufferAttribute(this.positionAttribute,e*3+1),fl.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(fl.a,i).addScaledVector(fl.b,n).addScaledVector(fl.c,1-(i+n)),fl.getNormal(r),this}},YZe=Pn(mne()),KZe=new Ke,QZe=new Ke,ZZe=new Ke,wx;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})(wx||(wx={}));var dj=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new Ke,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Ke,this.matrixWorldRigid=new Ke,this.shearScale=new Ke,this.shearScaleInv=new Ke}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Yr&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)wx.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)wx.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:s}=(0,YZe.SVD)(r),a=KZe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=QZe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=ZZe.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new Ke().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof Ke?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},JZe=class extends dj(Yr){},eJe=e=>e.type==="Mesh",Xs=class extends JZe{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];(r==null?void 0:r.object)!==t&&(r&&this.remove(r),r=new Xs(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return eJe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Pf=new L,If=new L,hv=new Ke,Nae=[new L(-1,1,1),new L(-1,-1,1),new L(1,-1,1),new L(1,1,1),new L(-1,1,-1),new L(-1,-1,-1),new L(1,-1,-1),new L(1,1,-1)],tJe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],rJe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],l9=(e,t,r)=>{e.updateEntityBoxSize(Pf,If),hv.copy(t).multiply(e.matrixWorld),If.x===0&&If.y===0&&If.z===0?r.push(new L(Pf.x,Pf.y,Pf.z).applyMatrix4(hv)):Nae.forEach(i=>{r.push(i.clone().multiply(If).add(Pf).applyMatrix4(hv))})},c9=class extends un{constructor(){super(...arguments),this.matrix=new Ke,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new Ke().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new L);return}l9(n,t,i)}}):l9(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(hv.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(If).multiplyScalar(.5),this.getCenter(Pf),hv.copy(this.matrix).setPosition(Pf),this.vertices=Nae.map(e=>e.clone().multiply(If).applyMatrix4(hv))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=tJe.map(([e,t])=>new el(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new L))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=rJe.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},fh={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},iJe=class extends Hne{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(e*l/n),d=o.getPoints(c);for(let u=0;u<d.length;u++){let h=d[u];r&&r.equals(h)||(t.push(h),r=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},NN=.001;function kN(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=NN}function $R(e,t){let r=new L(...e.position),i=new L(...e.controlNext.position),n=new L(...t.controlPrevious.position),s=new L(...t.position);return kN(r,i,s)&&kN(r,n,s)}function kae(e){let t=e.points.map(d=>new L(...d.data.position)),r=[e.points[0]],i=new L(...r[0].data.position);for(let d=0;d<e.points.length-1;d++)kN(i,t[d],t[d+1])||(r.push(e.points[d]),i=t[d]);r.push(e.points[e.points.length-1]);let n=e.isClosed,s=r.length-(n?0:1),a=r.length,o=[];for(let d=0;d<a;d++){let u=r[d].data,h=new L(...u.position),f=new L(...u.controlPrevious.position),p=new L(...u.controlNext.position),m={position:h,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!e.isClosed&&(d===0||d===a-1)){o[d]={...m,removedLength:0};continue}let g=n&&d==0?a-1:d-1,v=n&&d==a-1?0:d+1,y=r[g].data,b=r[v].data,x=new L(...y.position),S=new L(...b.position),w=x.clone().sub(h).normalize(),E=S.clone().sub(h).normalize();Object.assign(m,{prevDir:w,nextDir:E});let C=$R(y,u),T=$R(u,b);if(!C||!T)o[d]={...m,removedLength:0};else{let A=w.clone().add(E).normalize(),M=A.clone().cross(w).length()/w.dot(A);o[d]={...m,tan:M,removedLength:u.roundness/M}}}for(let d=0;d<s;d++){let u=d,h=n&&d===a-1?0:d+1,f=o[u],p=o[h];if(f.removedLength!==0||p.removedLength!==0){let m=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,m/2),p.removedLength=Math.min(p.removedLength,m/2)}}let l=[];for(let d=0;d<s;d++){let u=d,h=n&&d===a-1?0:d+1,f=o[u],p=o[h],m=null;if(!$R(r[u].data,r[h].data))f.position.distanceTo(p.position)>NN&&(m=new CE(f.position,f.controlNext,p.controlPrevious,p.position));else{let g=f.position.clone(),v=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&g.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&v.add(p.prevDir.clone().setLength(p.removedLength))),g.distanceTo(v)>NN&&(m=new CE(g,g.clone().lerp(v,.3),v.clone().lerp(g,.3),v))}l[2*d+1]=m}for(let d=0;d<a;d++){let u=o[d];if(u.removedLength===0){l[2*d]=null;continue}let h=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(h),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(h),m=u.tan*u.removedLength,g=u.prevDir.clone().add(u.nextDir).normalize(),v=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,b=g.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(y,2))).add(v),x=g.clone().multiplyScalar(-m).add(b),S=h.distanceTo(x)/h.distanceTo(v),w=u.prevDir.clone().multiplyScalar(S*h.distanceTo(f)).add(h),E=w.clone().lerp(x,2),C=f.clone().lerp(w,4/3),T=p.clone().lerp(E,4/3);l[2*d]=new CE(f,C,T,p)}let c=new iJe;return l.forEach(d=>{d&&c.add(d)}),c}var _r;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(_r||(_r={}));var Iu=e=>_r.is(e),nJe={type:"completeState",isfromEntity:!0},sJe=["x","y","z"],HR=new L,aJe=new L().set(0,1,0),hj=e=>class extends dj(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new c9,this._recursiveBBox=new c9,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(_r.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(_r.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(_r.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)Wf.toOps(this.data,n.data).forEach(s=>{let a=NA.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=Wf.patch(this.data,n),Wf.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched,r),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{Iu(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(_r.is(r[i]))return r[i];if(_r.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&_r.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)Iu(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{_r.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Iu(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Iu(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)Iu(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>Iu(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x*Et.RAD2DEG,this.rotation.y*Et.RAD2DEG,this.rotation.z*Et.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return GL(r,t)}getTransformValues(t,r,i){return r[t].map((n,s)=>(i==null?void 0:i.shared.getVariable(n,[this.uuid,t,sJe[s]]))??n)}updateTransformState(t,r){let i=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,r)),i=!0),t.rotation&&(HR.fromArray(this.getTransformValues("rotation",t,r)).multiplyScalar(Et.DEG2RAD),this.rotation.setFromVector3(HR),i=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,r)),i=!0),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??Zv.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(r=>{r.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)_r.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{_r.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return GL(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let s=this.data;this.data=r;let a=t,o=ci(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(d=>d===void 0)){let d=this.data;if(d!==void 0){let u=ws.zoom(d,t.path.slice(2));if(u)for(let h in t.props)t.props[h]===void 0&&h in u&&(c[h]=u[h])}}a={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:d,...u}=l;l=u}if(t.props.material!==void 0&&"material"in l){let{material:d,...u}=l;l=u}let c=ws.removeOverridden(t.path,t.props,l);a={...t,props:c}}}if(this.updateByPatchedOpBase(a,Wf.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),ci(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let d of Object.keys(t.props)){l[l.length-1]=d;let u=i.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=t.props[d],u.updateState(Ph.apply(u.component.data,u.overrideData),i))}}else{let d=i.scene.findInstance([this.uuid,...l]);if(d){let u=ws.zoom(d.component.data,c);if(t={...t,path:c},t.type===0){let h=t.props;if(u)for(let[f,p]of Object.entries(t.props))p===void 0&&(h===t.props&&(h={...t.props}),h[f]=u[f]);t={...t,props:h}}d.overrideData=GA.resolve(r.overrides,l),d.updateByOp(t,rs.applySimple(d.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let d of dh.rootOverrideProps)d in t.props&&(c===void 0&&(c={}),c[d]=t.props[d]);c&&(l={...t,props:c})}else for(let c of dh.rootOverrideProps)if(ci(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let d=Ph.filterOp(c.overrideData,l);d&&c.updateByOp(d,rs.applySimple(c.data,d),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let d=Ph.filterOp(c.overrideData,t);if(d){let u;s===c.data&&t===d?u=r:u=rs.applySimple(c.data,d),c.updateByOp(d,u,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!Fp.is(t.props.type)&&fh.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){fh.changeEntityProptotype(this,r,i);for(let n of this.children)_r.is(n)&&n.updateVisible(i.scene)}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0&&this.updateState(t.props,i),ci(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),ci(t.path,["cloner"])!==null){let n=rs.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var p,m,g,v,y;let r=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,i=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,n=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset??0,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(r===null)return;let a=t.find(r);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=kae(o.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let d=l.getPointAt(c);if(d===null)return;let u=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new Ke;a.updateMatrixWorld();let h=new Ke().multiplyMatrices(u.clone().invert(),a.matrixWorld);d.applyMatrix4(h);let f={position:d.toArray(),rotation:o.rotation};if(s==="tangential"){let b=new Ke().extractRotation(a.matrixWorld),x=l.getTangentAt(c).applyMatrix4(b).add(d),S=new Ke().lookAt(d,x,aJe),w=HR.setFromEuler(new kn().setFromRotationMatrix(S)).multiplyScalar(Et.RAD2DEG);f={...f,rotation:w.toArray()}}this.updateTransformState(f),this.traverseEntity(b=>{b._cameraType&&b.dispatchEvent(nJe)})}updateVisible(t){var i;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((i=this.dataPatched.cloner)==null?void 0:i.hideBase)!==!0),!t)return;let r=!1;this.traverseEntity(n=>{if(n.data.type==="Splat")return r=!0,!0}),r&&t.reloadSplats()}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(r==null?void 0:r.scene),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible(r.scene)),this.updateTransformState(t,r)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof fh.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new fh.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},zae=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);r.thetaLength=Et.clamp(r.thetaLength,0,360);let i=r.width/2,n=r.radiusTop??i,s=r.radiusBottom??i;return n===s?(n=i,s=i):n>s?(n=i,s=s*i/n):(n=n*i/s,s=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:n,radiusBottom:s})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:c,radiusBottom:d,cornerRadius:u,cornerSegments:h,hollow:f}=e.parameters,p;return l===0?(p=new Dt,p.setAttribute("position",new vt([],3))):u||f?p=new Bae(c,d,i,n,s,a,o,l*Math.PI/180,u,u,h,f):p=new I4(c,d,i,n,s,a,o,l*Math.PI/180),p.scale(1,1,r/t),Object.assign(p,{userData:{...e,type:"CylinderGeometry"}})}};function Rd(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function u9(e){return new oe(e.y,-e.x)}var Bae=class extends Dt{constructor(e,t,r,i,n,s,a,o,l,c,d,u,h=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,c=0);let f=[],p=[],m=[],g=[],v=0,y=r/2,b=new L,x=new L;h&&e==0&&(e=l),h&&t==0&&(t=c);let S=new oe(e,y),w=new oe(t,-y),E=null,C=null,T=null,A=null,M=S.clone().sub(w),P=0,I=0,R=0;u>0&&(P=Math.min(e,t)*(1-u),I=e-P,R=t-P);let N=S.clone();N.x-=P;let k=Math.PI-M.angle(),O=M.angle(),D=Math.tan(O/2),B=Math.tan(k/2),z=D+B,F=u?z:B,V=u?z:D;if(l=Math.min(l,(e-I)/F,M.length()/z),c=Math.min(c,(t-R)/V,M.length()/z),l>0){let Q=l/D;E=S.clone().sub(new oe(Q,l)),u&&(T=E.clone(),T.x-=P-z*l),S.sub(M.clone().setLength(Q))}if(c>0){let Q=c/B;C=w.clone().sub(new oe(Q,-c)),w.add(M.clone().setLength(Q)),u&&(A=C.clone(),A.x-=P-z*c,N.sub(M.clone().setLength(Q)))}M=S.clone().sub(w);let Y=M.length()<.5,W=[];for(let Q=0;Q<=i;Q++){let Z=[],ee=Q/i,re=ee*o+a,ne=new oe(Math.sin(re),Math.cos(re));A&&C?(X(Z,ee,ne,k,c,A,-1,!0),X(Z,ee,ne,O,c,C,-1,!1)):C?(H(Z,ne,C.x,0,-1),X(Z,ee,ne,O,c,C,-1,!1)):s||H(Z,ne,t,R,-1);let se=u9(M).normalize();if(Rd(se,ne,b),!Y)for(let fe=0;fe<=n;fe++){let me=fe/n,Oe=M.clone().multiplyScalar(me).add(w);Rd(Oe,ne,x),p.push(x.x,x.y,x.z),m.push(b.x,b.y,b.z),g.push(ee,.5+x.y/r),Z.push(v++)}if(T&&E?(X(Z,ee,ne,k,l,E,1,!1),X(Z,ee,ne,O,l,T,1,!0)):E?(X(Z,ee,ne,k,l,E,1,!1),H(Z,ne,E.x,0,1)):s||H(Z,ne,e,I,1),u&&!Y){let fe=u9(M).multiplyScalar(-1).normalize();Rd(fe,ne,b);for(let me=0;me<=n;me++){let Oe=me/n,Ee=M.clone().multiplyScalar(-Oe).add(N);Rd(Ee,ne,x),p.push(x.x,x.y,x.z),m.push(b.x,b.y,b.z),g.push(ee,.5+x.y/r),Z.push(v++)}}u&&!s&&Z.push(Z[0]),W.push(Z)}for(let Q=0;Q<W.length-1;Q++)for(let Z=0;Z<W[0].length-1;Z++){if(s&&u&&Z==n)continue;let ee=W[Q][Z],re=W[Q+1][Z],ne=W[Q+1][Z+1],se=W[Q][Z+1],fe=p[ne*3+0],me=p[ne*3+2];f.push(ee,re,se),(fe!=0||me!=0)&&f.push(re,ne,se)}o<Math.PI*2&&(ie(-1,W[0],a),ie(1,W[W.length-1],a+o)),this.setIndex(f),this.setAttribute("position",new vt(p,3)),this.setAttribute("normal",new vt(m,3)),this.setAttribute("uv",new vt(g,2));function X(Q,Z,ee,re,ne,se,fe,me){for(let Oe=0;Oe<d+1;Oe++){let Ee=Oe/d,Se=fe<0?Ee:1-Ee;me&&(Se-=1),Se*=re;let de=new oe(Math.sin(Se),Math.cos(Se)*fe),be=de.clone().multiplyScalar(ne).add(se);Rd(be,ee,x),p.push(x.x,x.y,x.z),Rd(de,ee,b),m.push(b.x,b.y,b.z),g.push(Z,.5+x.y/r),Q.push(v++)}}function H(Q,Z,ee,re,ne){let se=new L,fe=new oe,me=[ee,re];ne<0&&me.reverse();for(let Oe of me)fe.set(Oe,y*ne),Rd(fe,Z,se),p.push(se.x,se.y,se.z),m.push(0,ne,0),g.push(.5,.5),Q.push(v++)}function ie(Q,Z,ee){let re=new oe(Math.sin(ee),Math.cos(ee)),ne=new oe(-Math.cos(ee),Math.sin(ee)),se=new L,fe=Q<0?(Ee,Se,de)=>f.push(Ee,Se,de):(Ee,Se,de)=>f.push(Ee,de,Se),me=new oe((e+t+I+R)/4,0);Rd(me,re,se),p.push(se.x,se.y,se.z),m.push(ne.x,0,ne.y),g.push(.5,.5);let Oe=v++;for(let Ee of Z){let Se=p.slice(Ee*3,Ee*3+3);p.push(...Se),m.push(ne.x,0,ne.y);let de=g.slice(Ee*2,Ee*2+2);g.push(...de),v++}for(let Ee=Oe+1;Ee<v-1;Ee++)fe(Oe,Ee,Ee+1);fe(Oe,v-1,Oe+1)}}},oJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return r.thetaLength=Et.clamp(r.thetaLength,0,360),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:d,cornerSegments:u}=e.parameters,h;return l===0?(h=new Dt,h.setAttribute("position",new vt([],3))):c>0||d>0||l<360?h=new Bae(0,t/2,i,n,s,a,o,l*Math.PI/180,c,d,u,0,!0):h=new R4(t/2,i,n,s,a),h.scale(1,1,r/t),Object.assign(h,{userData:{...e,type:"ConeGeometry"}})}},lJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,c;return o==0?c=new Ql(t,r,i,n,s,a):c=new cJe(t,r,i,n,s,a,o,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},WR=Math.PI/2,cJe=class extends Dt{constructor(e=1,t=1,r=1,i=1,n=1,s=1,a=0,o=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let c=[],d=[],u=[],h=[],f=0,p=0;m("z","y","x",-1,-1,r,t,e,s,n,0),m("z","y","x",1,-1,r,t,-e,s,n,1),m("x","z","y",1,1,e,r,t,i,s,2),m("x","z","y",1,-1,e,r,-t,i,s,3),m("x","y","z",1,-1,e,t,r,i,n,4),m("x","y","z",-1,-1,e,t,-r,i,n,5),a>0&&(g("z","y","x",-1,-1,1,r,t,e,s,0),g("z","y","x",1,-1,-1,r,t,e,s,1),g("z","y","x",-1,1,-1,r,t,e,s,1),g("z","y","x",1,1,1,r,t,e,s,0),g("x","y","z",-1,-1,-1,e,t,r,i,0),g("x","y","z",1,-1,1,e,t,r,i,1),g("x","y","z",-1,1,1,e,t,r,i,0),g("x","y","z",1,1,-1,e,t,r,i,1),g("y","x","z",-1,-1,1,t,e,r,n,0),g("y","x","z",1,-1,-1,t,e,r,n,1),g("y","x","z",1,1,1,t,e,r,n,1),g("y","x","z",-1,1,-1,t,e,r,n,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new vt(d,3)),this.setAttribute("normal",new vt(u,3)),this.setAttribute("uv",new vt(h,2));function m(y,b,x,S,w,E,C,T,A,M,P){let I=(E-2*a)/A,R=(C-2*a)/M,N=E/2-a,k=C/2-a,O=T/2,D=A+1,B=M+1,z=0,F=0,V=new L;for(let Y=0;Y<B;Y++){let W=Y*R-k;for(let X=0;X<D;X++){let H=X*I-N;V[y]=H*S,V[b]=W*w,V[x]=O,d.push(V.x,V.y,V.z),V[y]=0,V[b]=0,V[x]=T>0?1:-1,u.push(V.x,V.y,V.z),h.push(X/A),h.push(1-Y/M),z+=1}}for(let Y=0;Y<M;Y++)for(let W=0;W<A;W++){let X=f+W+D*Y,H=f+W+D*(Y+1),ie=f+(W+1)+D*(Y+1),Q=f+(W+1)+D*Y;c.push(X,H,Q),c.push(H,ie,Q),F+=6}l.addGroup(p,F,P),p+=F,f+=z}function g(y,b,x,S,w,E,C,T,A,M,P){let I=(C-2*a)/M,R=C/2-a,N=T/2-a,k=A/2,O=M+1,D=0,B=0,z=new L,F=new L;for(let V=0;V<o+1;V++){let Y=V/o*WR,W=Math.sin(Y)*a,X=(1-Math.cos(Y))*a,H=Math.sin(Y),ie=Math.cos(Y);z[b]=(N+W)*w,z[x]=(k-X)*E,F[y]=0,F[b]=H*Math.sign(z[b]),F[x]=ie*Math.sign(z[x]);for(let Q=0;Q<O;Q++){let Z=Q*I-R;z[y]=Z*S,d.push(z.x,z.y,z.z),u.push(F.x,F.y,F.z),h.push(Q/M),h.push(0),D+=1}}for(let V=0;V<o;V++)for(let Y=0;Y<M;Y++){let W=f+Y+O*V,X=f+Y+O*(V+1),H=f+(Y+1)+O*(V+1),ie=f+(Y+1)+O*V;c.push(W,X,ie),c.push(X,H,ie),B+=6}l.addGroup(p,B,P),p+=B,f+=D}function v(y,b,x){let S=new L,w=new L(e/2,t/2,r/2);w.subScalar(a);let E=[],C=y*b*x>0?(A,M,P)=>c.push(A,M,P):(A,M,P)=>c.push(A,P,M);for(let A=0;A<=o;A++){let M=[],P=WR*(1-A/o),I=Math.cos(P),R=Math.sin(P),N=0;for(let k=0;k<=A;k++){let O=Math.cos(N),D=Math.sin(N);S.x=I*O,S.y=R,S.z=I*D;let B=w.clone().addScaledVector(S,a);d.push(y*B.x,b*B.y,x*B.z),u.push(y*S.x,b*S.y,x*S.z),h.push(0,0),M.push(f++),N+=WR/A}E.push(M)}let T=E.length-1;for(let A=0;A<T;A++){let M=E[A],P=E[A+1],I=M.length-1;C(M[0],P[1],P[0]);for(let R=1;R<=I;R++)C(M[R-1],M[R],P[R]),C(M[R],P[R+1],P[R])}}}},fj=class extends Dt{constructor(e=[],t=[],r="",i=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];c(),d(),this.setAttribute("position",new vt(a,3)),this.setAttribute("normal",new vt(l,3)),this.setAttribute("uv",new vt(o,2));return;function c(){var O;n=Math.min(1-1e-5,n),n==0&&(s=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],h=new L,f=h.clone(),p=new xs,m=n*i,g=i-m,v=s+1,y=new L,b=(D,B)=>y.subVectors(D,B).normalize(),x=(D,B)=>Array(D).fill(void 0).map(B),S=x(e.length/3,(D,B)=>new L().fromArray(e,B*3).setLength(i)),w=[],E=1e6;for(let D=0;D<S.length;D++){let B=S[D],z=[],F,V,Y,W=1e10,X=-1;for(;(X=t.indexOf(D,X+1))!=-1;){let Z=X-X%3;F=t[Z+(X+1)%3],V=t[Z+(X+2)%3],Y=B.distanceToSquared(S[F]),W=Math.min(W,Y),z.push([F,V,Y])}W+=1e-6;let H=[],ie=0,Q=z.length;for(let Z=0;Z<Q;Z++){[F,V,Y]=z[ie];let ee=((O=w[F])==null?void 0:O.includes(D))==!0;Y<=W&&H.push(F+ +ee*E),ie=z.findIndex(re=>re[0]==V)}w.push(H)}let C=[];{let D=0,B=0,z,F,V=u==3;for(let Y=0;Y<=s;Y++){z=Y*(Y+1)/2,F=(Y+1)*(Y+2)/2;for(let W=0;W<s-Y;W++)[D,B]=[z+W+Y+2,F+W+Y+3],C.push(z,F,...V?[B,z]:[D,F],B,D),[z,F]=[D,B];C.push(z,F,z+s+2)}}let T=h.clone(),A=h.clone(),M=h.clone(),P=h.clone(),I=h.clone(),R=[],N=x(S.length,()=>x(u,()=>h.clone()));for(let D=0;D<S.length;D++){h.copy(S[D]).normalize(),T.copy(h).multiplyScalar(g);let B=w[D];for(let H=0;H<B.length;H++){let ie=B[H],Q=B[(H+1)%u];p.setFromPointsAndIndices(S,D,ie%E,Q%E),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(T,N[D][H])}let z=[],F=[],V=[],Y=new L;s==0&&[...N[D]].reduce((H,ie)=>H.add(ie),Y).multiplyScalar(1/u);for(let H=0;H<u;H++){let ie=[],Q=(H-1+u)%u,Z=N[D][Q],ee=N[D][H];h.copy(Z).sub(T),f.copy(ee).sub(T);let re=T.angleTo(h),ne=h.angleTo(f),se=Math.cos(re)*m;s==0?A.copy(Y):A.copy(T).setLength(g+se),F.push(se);let fe=[A,Z,ee];for(let me=0;me<2;me++){let Oe=fe[me],Ee=fe[me+1];P.subVectors(Oe,T),I.subVectors(Ee,T),M.crossVectors(P,I).normalize();for(let Se=0;Se<v;Se++){let de=[re,ne][me]*Se/v;h.copy(P).applyAxisAngle(M,de).add(T),z.push(h.clone()),me&&(b(h,T),ie.push([Se==0?Oe:h.clone(),y.clone()]))}me&&(b(Ee,T),ie.push([Ee,y.clone()]))}V.push(ie)}R.push(V);let W=2*v,X=2;for(let H=0;H<u;H++){let ie=W*H,Q=W*((H+1)%u),Z=[z[ie]];for(let re=1;re<v;re++){P=z[ie+re],I=z[Q+re],Z.push(P);for(let ne=1,se=re-X+1;ne<=se;ne++)h.lerpVectors(P,I,ne/(se+1)),h.sub(T).setLength(F[H]).add(T),Z.push(h.clone());Z.push(I)}for(let re=0;re<v;re++)Z.push(z[re+v+ie]);Z.push(z[Q+v]);let ee=C.map(re=>Z[re]);a.push(...ee.map(re=>[re.x,re.y,re.z]).flat()),l.push(...ee.map(re=>(b(re,T),[y.x,y.y,y.z])).flat())}}let k=[];for(let D=0;D<w.length;D++)for(let B=0;B<u;B++){let z=w[D][B];if(z<E){let F=w[z].findIndex(W=>W%E==D),V=R[D][B],Y=R[z][F];for(let W=0;W<v;W++){let X=V[W],H=Y[v-W],ie=V[W+1],Q=Y[v-(W+1)];[X,H,ie,ie,H,Q].forEach(Z=>{a.push(Z[0].x,Z[0].y,Z[0].z),l.push(Z[1].x,Z[1].y,Z[1].z)})}k.push(V[0][0],Y[v][0],V[v][0],Y[0][0])}}for(;k.length;){let D,B,z,F;[D,B]=k.splice(0,2);let V=[D];for(;D!=B;)V.push(B),z=k.indexOf(B),F=z%2,B=k.splice(z-F,2)[1-F];y.subVectors(V[0],V[1]).cross(h.subVectors(V[0],V[2])).normalize();let Y=y.dot(V[0])<0;Y&&y.negate();for(let W=1;W<=V.length-2;W++)[V[W+ +Y],V[W+1-+Y],V[0]].forEach(X=>{a.push(X.x,X.y,X.z),l.push(y.x,y.y,y.z)})}}function d(){let u=new L;for(let w=0;w<a.length;w+=3){u.x=a[w+0],u.y=a[w+1],u.z=a[w+2];let E=x(u)/2/Math.PI+.5,C=S(u)/Math.PI+.5;o.push(E,1-C)}let h=new L,f=new L,p=new L,m=new L,g=new oe,v=new oe,y=new oe,b=(w,E,C,T)=>{T<0&&w.x===1&&(o[E]=w.x-1),C.x===0&&C.z===0&&(o[E]=T/2/Math.PI+.5)};for(let w=0,E=0;w<a.length;w+=9,E+=6){h.set(a[w+0],a[w+1],a[w+2]),f.set(a[w+3],a[w+4],a[w+5]),p.set(a[w+6],a[w+7],a[w+8]),g.set(o[E+0],o[E+1]),v.set(o[E+2],o[E+3]),y.set(o[E+4],o[E+5]),m.copy(h).add(f).add(p).divideScalar(3);let C=x(m);b(g,E+0,h,C),b(v,E+2,f,C),b(y,E+4,p,C)}for(let w=0;w<o.length;w+=6){let E=o[w+0],C=o[w+2],T=o[w+4],A=Math.max(E,C,T),M=Math.min(E,C,T);A>.9&&M<.1&&(E<.2&&(o[w+0]+=1),C<.2&&(o[w+2]+=1),T<.2&&(o[w+4]+=1))}function x(w){return Math.atan2(w.z,-w.x)}function S(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}}static fromJSON(e){return new fj(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},uJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new Fae(t*.5,s,a):new Gne(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},Fae=class extends fj{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,r),this.type=o}static fromJSON(e){return new Fae(e.radius,e.corner,e.cornerSides)}},By=1e-12,pj=class{constructor(e){this.position=new oe,this.startPosition=new oe,this.uuid=Et.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new pj(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},zN=class extends pj{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new zN(this.parent).copy(this)}},fv=class extends pj{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new zN(this),new zN(this))}static create(e,t){let r=new fv(e,new oe(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new fv(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new oe,t=new oe){let[r,i]=this.computeTangents();return r&&i&&(d9(r,e),d9(i,t)),[e,t]}computeTangent(e=new oe){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new oe){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function d9(e,t=new oe){let r=e.length();return t.set(-e.y/r,e.x/r)}var mj=e=>e,G0=new oe,XM=new oe,dJe=new oe,hJe=new oe,fJe=new oe,pJe=new oe,jae=new L,Vae=new L;function mJe(e){let t=new oe;t.addVectors(e.v0,G0.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new oe;return r.addVectors(e.v2,XM.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new Rl(e.v0,t,r,e.v2)}function g1(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function gJe(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function vJe(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function Uae(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function yJe(e,t,r){return f9(e,t)&&f9(t,r)&&BN(e.position,t.position,r.position)}function BN(e,t,r){return G0.copy(t).sub(e).cross(XM.copy(r).sub(e))===0}function bJe(e,t,r,i,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+c),n.set(o-l,a-c),[i,n]}function xJe(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function wJe(e,t,r,i,n,s){let a=t.x-e.x,o=t.y-e.y,l=r.x-e.x,c=r.y-e.y,d=Math.sqrt((a+l)*(a+l)+(o+c)*(o+c)),u;return Uae(t,e,r)>Math.PI&&(d*=-1),g1(c,o)?u=(o+c)*(i/d-.5)*8/3/(a-l):u=(a+l)*(i/d-.5)*8/3/(c-o),n.set(t.x-u*o,t.y+u*a),s.set(r.x+u*c,r.y-u*l),[n,s]}function h9(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function f9(e,t){return BN(e.position,e.controls[1].position,t.position)&&BN(e.position,t.controls[0].position,t.position)}function _Je(e,t,r,i,n=.5){let s=G0.subVectors(t,e).multiplyScalar(n).add(e),a=XM.subVectors(r,t).multiplyScalar(n).add(t),o=dJe.subVectors(i,r).multiplyScalar(n).add(r),l=s,c=hJe.subVectors(a,s).multiplyScalar(n).add(s),d=fJe.subVectors(o,a).multiplyScalar(n).add(a),u=o,h=pJe.subVectors(d,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,h.x,h.y,d.x,d.y,u.x,u.y,i.x,i.y]}function SJe(e,t,r=12,i=!0){let n=Vae.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=mj(t[o]),c=G0,d=fp(l,r);for(let u=0;u<=d;u++)if(l instanceof Rl||l instanceof Vh||l instanceof Fl){if(l.getPoint(u/d,c),n.set(c.x,c.y,0),s!==void 0&&vJe(s,n))continue;s===void 0&&(s=jae),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function EJe(e,t,r,i=12,n=!0){let s=Vae.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,d=mj(t[l]),u=G0,h=fp(d,i);o.push(h);for(let f=0;f<=h;f++)if(d instanceof Rl||d instanceof Vh||d instanceof Fl){if(d.getPoint(f/h,u),s.set(u.x,u.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=jae:(e.setXYZ(a,c.x,c.y,c.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),c.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function p9(e,t=12,r=!1){let i=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(r&&a.roundedCurveCorner!==void 0){let l=fp(a.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=fp(a.curveAfter,t)),i.push(o)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=fp(e[0].roundedCurveCorner,t)*.5),i}function fp(e,t=12){return e&&e instanceof DM?t*2:e&&(e instanceof Fl||e instanceof $ne)?1:e&&e instanceof P4?t*e.points.length:t}function CJe(e,t,r=12,i=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=mj(t[a]),l=fp(o,r),c=G0;for(let d=0;d<=l;d++)if(o instanceof Rl||o instanceof Vh||o instanceof Fl){if(o.getPoint(d/l,c),n!==void 0&&gJe(n,c,By))continue;n===void 0&&(n=XM),n.copy(c),e.push(c.x,c.y),s++}}return g1(e[0],e[e.length-2],By)&&g1(e[1],e[e.length-1],By)&&(e.pop(),e.pop()),i&&s>1&&!(g1(e[s-1],e[1],By)&&g1(e[s-2],e[0],By))&&(e.push(e[0],e[1]),s++),e}var GR=new oe,AJe=new oe,TJe=new oe,MJe=new oe,PJe=new oe,IJe=new oe,Ki=class extends xA{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new co(new L(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Et.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new Ki;return i.isClosed=e.isClosed,i.points=e.points.map(n=>fv.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>Ki.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,s=this.shapeHoles.length;n<s;n++){let a=this.shapeHoles[n],o=a.points.length,l=a.getPointIndexById(e);if(l<0)i+=o;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=e-t;if(s<=n.points.length-1)return n.points[s];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=n.points.indexOf(e);if(s>=0)return t+s;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=GR.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let s=this.points[i];s.position.multiply(r),s.controls[0].position.multiply(r),s.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e,t=0,r=Et.generateUUID()){let i;e instanceof oe?i=e:i=new oe(e,t);let n=new fv(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return SJe(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=p9(this.points,e,!1),this.roundedCurveDivisions=p9(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return EJe(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),CJe(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=fp(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-n;s<0&&(s+=i.reduce((a,o)=>a+o,0));for(let a=0,o=i.length;a<o;a++){let l=i[a];if(s<r+l)return[a,(s-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(h9(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(GR.set(r.x,r.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){h9(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(t===0)this.moveTo(i.position.x,i.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(i,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],r=this.points[this.points.length-1];this._applyCurveForPoint(t,r)}if(this.points.length>2){let t=0;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r],s=this.points[r-1]??this.points[this.points.length-1],a=this.points[r+1]??this.points[0],o=n.roundness,l=s&&a&&yJe(s,n,a);if(!n.controlsMoved()&&o>0&&!l){let c=n.curveBefore,d=n.curveAfter;if(c===void 0||d===void 0)continue;let u=n.roundedCurveBefore,h=n.roundedCurveAfter,f=c.getLength(),p=d.getLength(),m=Math.min(o,f*.499),g=Math.min(o,p*.499),v=Math.min(m,g),y=1-v/f,b=v/p,x=c.getPointAt(y,GR),S=d.getPointAt(b,AJe);this._subSplitCurve(c,u,y,x,void 0),this._subSplitCurve(d,h,b,void 0,S);let w;if(this.useCubicForRoundedCorners){let E=Uae(x,n.position,S)/2,C=Math.tan(E)*x.distanceTo(n.position),[T,A]=bJe(x,S,C,TJe,MJe),M=xJe(T,A,n.position),[P,I]=wJe(M,x,S,C,PJe,IJe);w=new Rl(x.clone(),P.clone(),I.clone(),S.clone())}else w=new Vh(x.clone(),n.position.clone(),S.clone());n.roundedCurveCorner=w,this.roundedCurves.splice(r+t,0,w),t++}}}}_subSplitCurve(e,t,r,i,n){if(e instanceof Fl)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let s=e,a=t,o=s.getUtoTmapping(r,0),l=_Je(s.v0,s.v1,s.v2,s.v3,o);return i!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),n!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new Ki(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,s=e.points[n+0],a=e.points[n+1],o=e.points[n+2],l=e.points[n+3],c=e.points[n+4],d=e.points[n+5],u=e.points[n+6],h=new fv(Et.generateUUID(),new oe(s,a));h.controls[0].position.set(o,l),h.controls[1].position.set(c,d),h.roundness=u,this.points.push(h)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new Ki;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e,t=!1){this.isText=t;let r=(n,s)=>{s instanceof Rl&&s.v3.equals(n.position)&&n.controls[0].position.copy(s.v2)},i=n=>{let s=[],a,o;for(a=0,o=n.length;a<o;a++)n[a]instanceof Vh&&(n[a]=mJe(n[a]));for(a=0,o=n.length;a<o;a++){let d=n[a],u=a>0?n[a-1]:null,h;d instanceof Rl?(h=this.createPoint(d.v0),h.controls[1].position.copy(d.v1)):d instanceof Fl&&(h=this.createPoint(d.v1)),h!==void 0&&(u!==null&&r(h,u),s.push(h))}let l=n[n.length-1],c=!1;return l instanceof Rl?l.v3.equals(s[0].position)&&(s[0].controls[0].position.copy(l.v2),c=!0):l instanceof Fl&&l.v2.equals(s[0].position)&&(c=!0),this.isClosed=c,s};return this.points=i(e.curves),e instanceof xA&&(this.shapeHoles=e.holes.map(n=>{let s=new Ki;return s.fromShape(n),s})),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(t.position!==void 0&&r.position.fromArray(t.position),t.roundness!==void 0&&(r.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[0];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[1];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}},FN=Math.PI*2;function qR({x:e,y:t},r,i,n,s){return{x:e*r+n,y:t*i+s}}function RJe(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function m9(e,t,r,i){let n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function DJe(e,t,r,i,n,s,a,o,l,c){let d=Math.pow(n,2),u=Math.pow(s,2),h=Math.pow(a,2),f=Math.pow(o,2),p=d*u-d*f-u*h;p<0&&(p=0),p/=d*f+u*h,p=Math.sqrt(p)*(l===c?-1:1);let m=p*n/s*o,g=p*-s/n*a,v=m+(e+r)/2,y=g+(t+i)/2,b=(a-m)/n,x=(o-g)/s,S=(-a-m)/n,w=(-o-g)/s,E=m9(1,0,b,x),C=m9(b,x,S,w);return!c&&C>0&&(C-=FN),c&&C<0&&(C+=FN),{centerx:v,centery:y,ang1:E,ang2:C}}function OJe({px:e,py:t,cx:r,cy:i,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let c=(e-r)/2,d=(t-i)/2;if(c===0&&d===0)return[];n=Math.abs(n),s=Math.abs(s);let u=Math.pow(c,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(s,2);u>1&&(n*=Math.sqrt(u),s*=Math.sqrt(u));let h=DJe(e,t,r,i,n,s,c,d,a,o),{ang1:f,ang2:p}=h,{centerx:m,centery:g}=h,v=Math.abs(p)/(FN/4);Math.abs(1-v)<1e-7&&(v=1);let y=Math.max(Math.ceil(v),1);p/=y;for(let b=0;b<y;b++)l.push(RJe(f,p)),f+=p;return l.map(b=>{let{x,y:S}=qR(b[0],n,s,m,g),{x:w,y:E}=qR(b[1],n,s,m,g),{x:C,y:T}=qR(b[2],n,s,m,g);return{x1:x,y1:S,x2:w,y2:E,x:C,y:T}})}var Jr;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Jr||(Jr={}));var En;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(En||(En={}));function $t(e,t){if(!e)throw t||"Assertion Failed!"}var Lt=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){$t(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){$t(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){$t(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){$t(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(a=e.edgeEval(t,i,r),o=e.edgeEval(i,r,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):(a=e.edgeSign(t,i,r),o=-e.edgeSign(t,n,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(a=e.transEval(t,i,r),o=e.transEval(i,r,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):(a=e.transSign(t,i,r),o=-e.transSign(t,n,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):s.t=(i.t+r.t)/2},e}(),Fy=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),hS=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),bg=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),g9=function(){function e(){var t=new bg,r=new Fy,i=new hS(0),n=new hS(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new hS(0),i=new hS(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;$t(n,"Vertex can't be null!");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r;var a=r;do a.Org=n,a=a.Onext;while(a!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;$t(n,"Face can't be null");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var a=r;do a.Lface=n,a=a.Lnext;while(a!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new bg,r=new bg,i=new Fy,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var s=new bg;this.makeVertex_(s,r,t.Org),t.Org.anEdge=t}if(!i){var a=new Fy;this.makeFace_(a,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new Fy;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new bg;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),s=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,r),n.Org=t.Dst,s.Org=r.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!i){var a=new Fy;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,s,a,o;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=r);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,s,a,o,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,a=i.Org;n=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(r),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&Lt.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&Lt.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===a);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,s,a,o,l,c;for(s=t,s=t;(n=s.next)!==t;s=n){$t(n.prev===s),l=n.anEdge;do $t(l.Sym!==l),$t(l.Sym.Sym===l),$t(l.Lnext.Onext.Sym===l),$t(l.Onext.Sym.Lnext===l),$t(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for($t(n.prev===s&&n.anEdge===null),o=r,o=r;(a=o.next)!==r;o=a){$t(a.prev===o),l=a.anEdge;do $t(l.Sym!==l),$t(l.Sym.Sym===l),$t(l.Lnext.Onext.Sym===l),$t(l.Onext.Sym.Lnext===l),$t(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for($t(a.prev===o&&a.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)$t(l.Sym.next===c.Sym),$t(l.Sym!==l),$t(l.Sym.Sym===l),$t(l.Org!==null),$t(l.Dst!==null),$t(l.Lnext.Onext.Sym===l),$t(l.Onext.Sym.Lnext===l);$t(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),v9=function(){function e(){this.handle=null}return e}(),y9=function(){function e(){this.key=null,this.node=0}return e}(),LJe=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new v9,this.handles[i]=new y9;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t<<1,a<this.size&&this.leq(i[r[a+1].handle].key,i[r[a].handle].key)&&++a,$t(a<=this.max),s=r[a].handle,a>this.size||this.leq(i[n].key,i[s].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t>>1,s=r[a].handle,a===0||this.leq(i[s].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new v9;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new y9}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;$t(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),XR=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),b9=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),NJe=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new b9,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new b9;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),kJe=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,s=r.eUp,a=i.eUp;if(s.Dst===n)return a.Dst===n?Lt.vertLeq(s.Org,a.Org)?Lt.edgeSign(a.Dst,s.Org,a.Org)<=0:Lt.edgeSign(s.Dst,a.Org,s.Org)>=0:Lt.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return Lt.edgeSign(s.Dst,n,s.Org)>=0;var o=Lt.edgeEval(s.Dst,n,s.Org),l=Lt.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&$t(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){$t(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new XR;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case Jr.ODD:return(r&1)!==0;case Jr.NONZERO:return r!==0;case Jr.POSITIVE:return r>0;case Jr.NEGATIVE:return r<0;case Jr.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,a=r,o=r.eUp;a!==i;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,i,n,s,a){var o,l,c,d,u=!0;c=i;do $t(Lt.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(s===null&&(s=e.regionBelow(r).eUp.Rprev),l=r,d=s;o=e.regionBelow(l),c=o.eUp.Sym,c.Org===d.Org;)c.Onext!==d&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(d.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!u&&e.checkForRightSplice(t,l)&&(e.addWinding(c,d),e.deleteRegion(t,l),t.mesh.delete(d)),u=!1,l=o,d=c;l.dirty=!0,$t(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=Lt.vertL1dist(r,t),s=Lt.vertL1dist(i,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*r.coords[0]+o*i.coords[0],t.coords[1]+=a*r.coords[1]+o*i.coords[1],t.coords[2]+=a*r.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,r,i,n,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if(Lt.vertLeq(n.Org,s.Org)){if(Lt.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;Lt.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if(Lt.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a;if($t(!Lt.vertEq(n.Dst,s.Dst)),Lt.vertLeq(n.Dst,s.Dst)){if(Lt.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=r.inside}else{if(Lt.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;r.dirty=i.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a=n.Org,o=s.Org,l=n.Dst,c=s.Dst,d,u,h=new bg,f,p;if($t(!Lt.vertEq(c,l)),$t(Lt.edgeSign(l,t.event,a)<=0),$t(Lt.edgeSign(c,t.event,o)>=0),$t(a!==t.event&&o!==t.event),$t(!r.fixUpperEdge&&!i.fixUpperEdge),a===o||(d=Math.min(a.t,l.t),u=Math.max(o.t,c.t),d>u))return!1;if(Lt.vertLeq(a,o)){if(Lt.edgeSign(c,a,o)>0)return!1}else if(Lt.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),Lt.intersect(l,a,c,o,h),$t(Math.min(a.t,l.t)<=h.t),$t(h.t<=Math.max(o.t,c.t)),$t(Math.min(c.s,l.s)<=h.s),$t(h.s<=Math.max(o.s,a.s)),Lt.vertLeq(h,t.event)&&(h.s=t.event.s,h.t=t.event.t),f=Lt.vertLeq(a,o)?a:o,Lt.vertLeq(f,h)&&(h.s=f.s,h.t=f.t),Lt.vertEq(h,a)||Lt.vertEq(h,o)?(e.checkForRightSplice(t,r),!1):!Lt.vertEq(l,t.event)&&Lt.edgeSign(l,t.event,h)>=0||!Lt.vertEq(c,t.event)&&Lt.edgeSign(c,t.event,h)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),i=r,r=e.topRightRegion(r),p=e.regionBelow(r).eUp.Rprev,i.eUp=s.Oprev,s=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,s.Onext,n.Rprev,p,!0),!0):(Lt.edgeSign(l,t.event,h)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),Lt.edgeSign(c,t.event,h)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=h.s,n.Org.t=h.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,s;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,s=i.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionBelow(r),s=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,c=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,r),Lt.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),c=!0),Lt.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),c=!0),c){e.addRightEdges(t,r,i.Onext,s,s,!0);return}Lt.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,s,a,o,l;if(n=r.eUp,Lt.vertEq(n.Org,i)){$t(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!Lt.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}$t(!1),r=e.topRightRegion(r),l=e.regionBelow(r),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&($t(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),Lt.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,r,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,r){var i,n,s,a,o,l,c=new XR;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(a=i.eUp,o=n.eUp,Lt.edgeSign(a.Dst,r,a.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(s=Lt.vertLeq(o.Dst,a.Dst)?i:n,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else{var d=t.mesh.connect(o.Dnext,r.anEdge);l=d.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);$t(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,r,i,n){var s=new XR,a=t.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=r,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new NJe(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||($t(r.fixUpperEdge),$t(++i===1)),$t(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,Lt.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,s=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)s++;for(s+=8,r=t.pq=new LJe(s,Lt.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,s=i.anEdge,$t(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!Lt.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),zJe=function(){function e(){this.mesh=new g9,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Jr.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,s,a,o,l=[0,0,0],c=[0,0,0],d=[0,0,0],u=[0,0,0],h=[0,0,0],f=[null,null,null],p=[null,null,null],m=this.mesh.vHead;r=m.next;for(var g=0;g<3;++g)s=r.coords[g],c[g]=s,p[g]=r,l[g]=s,f[g]=r;for(r=m.next;r!==m;r=r.next)for(var v=0;v<3;++v)s=r.coords[v],s<c[v]&&(c[v]=s,p[v]=r),s>l[v]&&(l[v]=s,f[v]=r);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,i=p[y],n=f[y],d[0]=i.coords[0]-n.coords[0],d[1]=i.coords[1]-n.coords[1],d[2]=i.coords[2]-n.coords[2],r=m.next;r!==m;r=r.next)u[0]=r.coords[0]-n.coords[0],u[1]=r.coords[1]-n.coords[1],u[2]=r.coords[2]-n.coords[2],h[0]=d[1]*u[2]-d[2]*u[1],h[1]=d[2]*u[0]-d[0]*u[2],h[2]=d[0]*u[1]-d[1]*u[0],a=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],a>o&&(o=a,t[0]=h[0],t[1]=h[1],t[2]=h[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(d)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,s=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),s=!0),i=this.sUnit,n=this.tUnit;var a=this.longAxis_(r);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=r[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,i),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;Lt.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;Lt.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var s=void 0;i.Lnext!==n;)if(Lt.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(Lt.edgeGoesLeft(n.Lnext)||Lt.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(Lt.edgeGoesRight(i.Lprev)||Lt.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=t.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?r:-r:i?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var s,a=0,o=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var d=t.fHead.next;d!==t.fHead;d=d.next)if(d.n=-1,!!d.inside){s=d.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=o,o++),l++,s=s.Lnext}while(s!==d.anEdge);if(l>i)throw"Face vertex greater that support polygon";d.n=a,++a}this.elementCount=a,r===En.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var u=c.n*n;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],n>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var h=0,d=t.fHead.next;d!==t.fHead;d=d.next)if(d.inside){s=d.anEdge,l=0;do{var c=s.Org;this.elements[h++]=c.n,l++,s=s.Lnext}while(s!==d.anEdge);for(var f=l;f<i;++f)this.elements[h++]=-1;if(r===En.CONNECTED_POLYGONS){s=d.anEdge;do this.elements[h++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==d.anEdge);for(var p=l;p<i;++p)this.elements[h++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,d=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext;while(i!==n);this.elements[d++]=s,this.elements[d++]=a,s+=a}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new g9),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,s,a){if(t===void 0&&(t=Jr.ODD),r===void 0&&(r=En.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),kJe.computeInterior(this,a);var o=this.mesh;return r===En.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),r===En.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,r,i,n),!0},e}();function ph(e){var t=e.windingRule,r=t===void 0?Jr.ODD:t,i=e.elementType,n=i===void 0?En.POLYGONS:i,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,c=e.normal,d=c===void 0?[0,0,1]:c,u=e.contours,h=u===void 0?[]:u,f=e.strict,p=f===void 0?!0:f,m=e.debug,g=m===void 0?!1:m;if(!h&&p)throw new Error("Contours can't be empty");if(h){var v=new zJe;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<h.length;y++)v.addContour(l||2,h[y]);return v.tesselate(r,n,a,l,d,p),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}Jr.ODD;Jr.NONZERO;Jr.POSITIVE;Jr.NEGATIVE;Jr.ABS_GEQ_TWO;En.POLYGONS;En.CONNECTED_POLYGONS;En.BOUNDARY_CONTOURS;var jN=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*jN.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let r=e*jN.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*n,3*e);s+=3*e;let o=new Float32Array(i,s*n,3*e);s+=3*e;let l=new Float32Array(i,s*n,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},$ae=jN;$ae.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var BJe=Pn(H4e()),gj={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Hae={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Wae={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},YR=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),vj=class extends Dt{constructor(e,t,r=0,i=12,n=3,s=Jr.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let o=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(T=>{let A=T.extractShapePointsToFlatArray([],i),M=[];for(let P=A.length-1;P>=1;P-=2){let I=A[P-1],R=A[P-0];M.push(I,R)}return M}),c=[],d=[];for(let T=0;T<o.length;T+=2)d.push([o[T],o[T+1]]);c.push(d);for(let T=0;T<l.length;T++){let A=l[T],M=[];for(let P=0;P<A.length;P+=2)M.push([A[P],A[P+1]]);c.push(M)}let u;e.isText?u=new lse().setFromPoints(e.points.map(T=>T.position)).getSize(new oe).length()*.1:c[0].length===0?u=r:u=(0,BJe.default)(c).distance,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,u,t/2),this._bevelSegments=Math.floor(n));let h;try{h=ph({windingRule:s,elementType:En.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{h=gj}let f;try{f=ph({windingRule:Jr.ODD,elementType:En.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{f=Hae}if(!h)throw new Error("error generating geometry");let p=h.elementCount;if(f){h.elementCount+=f.elementCount;for(let T=0;T<f.elements.length;T++){let A=f.elements[T],M=T%2===0?h.vertexCount:0;h.elements.push(A+M)}for(let T=0;T<f.vertexIndices.length;T++){let A=f.vertexIndices[T],M=h.vertexCount;h.vertexIndices.push(A+M)}for(let T=0;T<f.vertices.length;T++){let A=f.vertices[T];h.vertices.push(A)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let T=0,A=h.vertexCount;T<A;T++){let M=T*2,P=h.vertices[M+0],I=h.vertices[M+1];P<m&&(m=P),P>g&&(g=P),I<v&&(v=I),I>y&&(y=I)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new $ae(this._computeBufferEstimatedSize(h));let b=[],x=[];for(let T=h.elementCount-1;T>=0;T--){let A=T>=p,M=T*2,P=h.elements[M+0],I=h.elements[M+1],R=P+I,N={start:P,count:I,normals:[],continuous:[],concave:[]},k=P,O=R-1,D=P+1,B=this._shape.roundedCurves.length;do{let W=k-P,X=h.vertices[O*2+0],H=h.vertices[O*2+1],ie=h.vertices[k*2+0],Q=h.vertices[k*2+1],Z=h.vertices[D*2+0],ee=h.vertices[D*2+1],re=ie-X,ne=Q-H,se=Math.sqrt(re*re+ne*ne);re/=se,ne/=se;let fe=ie-Z,me=Q-ee,Oe=Math.sqrt(fe*fe+me*me);fe/=Oe,me/=Oe,N.normals[W*2+0]=-me,N.normals[W*2+1]=fe,N.concave[W]=re*me-ne*fe>0;let Ee=h.vertexIndices[k];if(Array.isArray(Ee))N.continuous[W]=!1;else{let[Se,de]=this._shape.getCurveIndexFromVertexId(Ee-1,!0);if(de>0&&de<1)N.continuous[W]=!0;else{let be=de===1?Se+1:Se-1;be=(be+B)%B;let ye=de===1?0:1,q=this._shape.roundedCurves[Se].getTangent(de),U=this._shape.roundedCurves[be].getTangent(ye);N.continuous[W]=q.dot(U)>.95}}A&&(N.normals[W*2+0]*=-1,N.normals[W*2+1]*=-1),[O,k,D]=[k,D,D+1],D>=R&&(D-=I)}while(D!==P+1);let z=[];z.push({bevelI:0,angle:0,size:0,boundary:{vertices:h.vertices.slice(P*2,R*2),vertexCount:I,vertexIndices:new Array(I).fill(!0).map((W,X)=>[X,X]),elements:[0,I],elementCount:1,mesh:null},reverseMap:[],insetPoints:h.vertices.slice(P*2,R*2)});let F=0;for(let W=1;W<=this._bevelSegments;W++){let X=W/this._bevelSegments*Math.PI/2,H=(1-Math.cos(X))*this._bevel,ie=[],Q=[],Z=0;for(let re=0;re<I;re++){let ne=re*2,se=(re-1+I)%I*2,fe=h.vertices[N.start*2+ne+0],me=h.vertices[N.start*2+ne+1],Oe=-N.normals[se+0]*H,Ee=-N.normals[se+1]*H,Se=-N.normals[ne+0]*H,de=-N.normals[ne+1]*H;if(N.concave[re]||!N.concave[re]&&A){let be=Math.atan2(Ee,Oe),ye=Math.atan2(de,Se);ye>be&&(ye-=Math.PI*2);let q=ye-be;if(N.continuous[re]||A){let U=be+q/2,ce=Math.cos(U)*H,xe=Math.sin(U)*H;ie[2*Z+0]=fe+ce*(A?-1:1),ie[2*Z+1]=me+xe*(A?-1:1),Q[Z]=re,Z++}else{let U=Math.max(1,Math.floor(i/4*Math.abs(q)/Math.PI));for(let ce=0;ce<=U;ce++){let xe=be+q*(ce/U),j=Math.cos(xe)*H,Be=Math.sin(xe)*H;ie[2*Z+0]=fe+j,ie[2*Z+1]=me+Be,Q[Z]=re,Z++}}}else ie[2*Z+0]=fe+Oe,ie[2*Z+1]=me+Ee,Q[Z]=re,Z++,ie[2*Z+0]=fe,ie[2*Z+1]=me,Q[Z]=re,Z++,ie[2*Z+0]=fe+Se,ie[2*Z+1]=me+de,Q[Z]=re,Z++}let ee=ph({windingRule:Jr.POSITIVE,elementType:En.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ie],edgeCreateCallback:re=>{let ne=re.Org.idx,se=Q[ne],fe=Q[(ne+1)%Q.length];re.idx=[se,fe],re.Sym.idx=[fe,se]},vertexIdCallback:re=>{let ne=re.Lprev.idx;return[ne?ne[1]:0,re.idx?re.idx[0]:0]}});if(!ee)throw console.log("Error"),new Error(`error generating bevel geometry for ${W}'th loop`);if(!ee.vertexCount){let re=(W-1)/this._bevelSegments*Math.PI/2;F=(1-Math.sin(re))*this._bevel;break}for(let re=0;re<ee.vertexIndices.length;re++){let[ne,se]=ee.vertexIndices[re];if(ne===se)continue;let fe=se;se<ne&&(fe+=I);for(let me=ne;me<fe;me++){let Oe=me%I,Ee=(me+1)%I;if(!N.continuous[Oe]||!N.continuous[Ee]){ee.vertexIndices[re]=[ne,Oe],ee.vertexIndices.splice(re+1,0,[Ee,se]),ee.vertices.splice((re+1)*2,0,ee.vertices[re*2],ee.vertices[re*2+1]);break}}}z.push({bevelI:W,angle:X,size:H,boundary:ee,reverseMap:Q,insetPoints:ie})}let V=(W,X,H)=>{let ie=0,Q=W.boundary.vertexIndices.length;for(;ie<Q&&H(W.boundary.vertexIndices[X]);)X=(X+1)%Q,ie++;return ie},Y=b.length;for(let W=1;W<z.length;W++){let X=z[W-1],H=z[W],ie=X.boundary.vertexIndices.length,Q=H.boundary.vertexIndices.length;if(!ie||!Q)break;let Z=N.concave.length,ee=0,re=YR(ee,I);for(;!X.boundary.vertexIndices.filter(re).length||!H.boundary.vertexIndices.filter(re).length;)ee++,re=YR(ee,I);let ne=X.boundary.vertexIndices.findIndex(re),se=H.boundary.vertexIndices.findIndex(re);do ne=(ne+1)%ie;while(re(X.boundary.vertexIndices[ne]));do se=(se+1)%Q;while(re(H.boundary.vertexIndices[se]));ee=(ee+1)%I;let fe=ee,me=0,Oe=this._buildBevelVert(N,X,(ne-1+ie)%ie,void 0,me),Ee=this._buildBevelVert(N,H,(se-1+Q)%Q,void 0,me),Se=Oe,de=Ee,be,ye,q=!1;do{me=(ee||Z)/Z,re=YR(ee,I);let U=V(X,ne,re),ce=V(H,se,re),xe=q;if(q=!1,U&&!ce){for(let j=0;j<U;j++)be=this._buildBevelVert(N,X,(ne+j)%ie,j/(U-1),me),b.push(Se.topN,be.topP,de.topN),a===!1&&b.push(be.bottomP,Se.bottomN,de.bottomN),Se=be;q=!0}else if(!U&&ce)for(let j=0;j<ce;j++)ye=this._buildBevelVert(N,H,(se+j)%Q,j/(ce-1),me),b.push(de.topN,Se.topP,ye.topP),a===!1&&b.push(Se.bottomP,de.bottomN,ye.bottomP),de=ye;else if(U&&ce)if(be=this._buildBevelVert(N,X,ne,0,me),ye=this._buildBevelVert(N,H,se,0,me),xe?(b.push(Se.topN,ye.topP,de.topN),b.push(Se.topN,be.topP,ye.topP),a===!1&&(b.push(ye.bottomP,Se.bottomN,de.bottomN),b.push(ye.bottomP,be.bottomP,Se.bottomN))):(b.push(de.topN,Se.topN,be.topP),b.push(de.topN,be.topP,ye.topP),a===!1&&(b.push(be.bottomP,Se.bottomN,de.bottomN),b.push(be.bottomP,de.bottomN,ye.bottomP))),Se=be,de=ye,U===ce)for(let j=1;j<U;j++)be=this._buildBevelVert(N,X,(ne+j)%ie,j/(U-1),me),ye=this._buildBevelVert(N,H,(se+j)%Q,j/(ce-1),me),b.push(Se.topN,be.topP,de.topN),b.push(de.topN,be.topP,ye.topP),a===!1&&(b.push(be.bottomP,Se.bottomN,de.bottomN),b.push(be.bottomP,de.bottomN,ye.bottomP)),Se=be,de=ye;else if(U>ce){let j=U/ce,Be=0;for(let ze=1;ze<U;ze++)be=this._buildBevelVert(N,X,(ne+ze)%ie,ze/(U-1),me),b.push(Se.topN,be.topP,de.topN),a===!1&&b.push(be.bottomP,Se.bottomN,de.bottomN),Se=be,ze>(Be+1)*j&&(Be++,ye=this._buildBevelVert(N,H,(se+Be)%Q,Be/(ce-1),me),b.push(de.topN,be.topP,ye.topP),a===!1&&b.push(be.bottomP,de.bottomN,ye.bottomP),de=ye)}else{let j=ce/U,Be=0;for(let ze=1;ze<ce;ze++)ye=this._buildBevelVert(N,H,(se+ze)%Q,ze/(ce-1),me),b.push(de.topN,be.topP,ye.topP),a===!1&&b.push(be.bottomP,de.bottomN,ye.bottomP),de=ye,ze>(Be+1)*j&&(Be++,be=this._buildBevelVert(N,X,(ne+Be)%ie,Be/(U-1),me),b.push(Se.topN,be.topP,de.topN),a===!1&&b.push(be.bottomP,Se.bottomN,de.bottomN),Se=be)}ne=(ne+U)%ie,se=(se+ce)%Q,ee=(ee+1)%Z}while(ee!==fe)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(z,N,b),A){let W=[];for(let X=b.length-1;X>=Y+2;X-=3){let H=b[X-2],ie=b[X-1],Q=b[X-0];W.push(Q,ie,H)}b.splice(Y,b.length-Y,...W)}if(A){let W=[];for(let X=z[z.length-1].boundary.vertices.length-1;X>=1;X-=2){let H=z[z.length-1].boundary.vertices[X-1],ie=z[z.length-1].boundary.vertices[X-0];W.push(H,ie)}x.push(W)}if(!A){let W=z[z.length-1],X;try{X=ph({windingRule:z.length>1?Jr.POSITIVE:Jr.ODD,elementType:En.POLYGONS,vertexSize:2,strict:!0,contours:[W.insetPoints,...x]})}catch{X=Wae}if(!X)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<u&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let H=0;H<X.elementCount*3;H+=3){let ie=this._buildSurfaceVert(X,X.elements[H+0],F),Q=this._buildSurfaceVert(X,X.elements[H+1],F),Z=this._buildSurfaceVert(X,X.elements[H+2],F);b.push(ie.top,Q.top,Z.top),a===!1&&b.push(Z.bottom,Q.bottom,ie.bottom)}}this.vertexCache={}}this._buffer.shrink();let S=new Wt(Uint32Array.from(b),1),w=new Wt(this._buffer.positions,3),E=new Wt(this._buffer.normals,3),C=new Wt(this._buffer.uvs,2);w.needsUpdate=!0,E.needsUpdate=!0,C.needsUpdate=!0,S.needsUpdate=!0,this.setAttribute("position",w),this.setAttribute("normal",E),this.setAttribute("uv",C),this.setIndex(S)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(n-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,d=l*2,u={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[d+0]=a,this._buffer.uvs[d+1]=o,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[d+2]=a,this._buffer.uvs[d+3]=o),this.vertexCache[i]=u,u}_buildBevelVert(e,t,r,i=1,n){let s=`${t.bevelI}:${r}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[r],l,c,d,u;a!==o?(c=a,l=o,u=!1,d=e.continuous[c]&&e.continuous[l]):(l=a,c=(l-1+e.count)%e.count,u=e.concave[l]&&t.bevelI>0,d=e.continuous[l]||u);let h=Math.cos(t.angle),f=Math.sin(t.angle),p=r*2,m=l*2,g=c*2,v=t.boundary.vertices[p+0],y=t.boundary.vertices[p+1],b=(1-f)*this._bevel,x=(v-this._minX)/this._width,S=(y-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(x=n),S=1);let w=e.normals[m+0],E=e.normals[m+1],C=e.normals[g+0],T=e.normals[g+1];if(u){let R=C-w,N=T-E;w=w+R*(1-i),E=E+N*(1-i);let k=Math.sqrt(w*w+E*E);w/=k,E/=k}let A=this.forPathBevel?this._buffer.get(d?1:2):this._buffer.get(d?2:4),M=A*3,P=A*2,I={i:r,fi:l,topP:A+0,topN:A+0,bottomP:A+1,bottomN:A+1,pathBevelUCoord:n};return this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[M+0]=w*h,this._buffer.normals[M+1]=E*h,this._buffer.normals[M+2]=f,this._buffer.uvs[P+0]=x,this._buffer.uvs[P+1]=S,this.forPathBevel===!1&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=b,this._buffer.normals[M+3]=w*h,this._buffer.normals[M+4]=E*h,this._buffer.normals[M+5]=-f,this._buffer.uvs[P+2]=S,this._buffer.uvs[P+3]=x),d||(this.forPathBevel?(A+=1,M+=3,P+=2):(A+=2,M+=6,P+=4),I.topP=A+0,I.bottomP=A+1,this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[M+0]=C*h,this._buffer.normals[M+1]=T*h,this._buffer.normals[M+2]=f,this._buffer.uvs[P+0]=x,this._buffer.uvs[P+1]=S,this.forPathBevel===!1&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=b,this._buffer.normals[M+3]=C*h,this._buffer.normals[M+4]=T*h,this._buffer.normals[M+5]=-f,this._buffer.uvs[P+2]=S,this._buffer.uvs[P+3]=x)),this.vertexCache[s]=I,I}clone(){let e=new vj(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=VM(this.userData),e}},Gae=class extends Dt{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=Jr.ODD,this.elementType=En.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Jr.ODD,elementType:En.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(h=>h.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,c;for(let h=0,f=i.length/2;h<f;h++){let p=h*2,m=i[p+0],g=i[p+1];if(l!==void 0&&m!==l&&(a=!1),c!==void 0&&g!==c&&(o=!1),l=m,c=g,!a&&!o)break}if(!a&&!o)try{s=ph({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=gj}let d=(s==null?void 0:s.vertexCount)??1,u=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new Wt(new Float32Array(d*3),3),this._normalAttribute=new Wt(new Float32Array(d*3),3),this._uvAttribute=new Wt(new Float32Array(d*2),2),this._indexAttribute=new Wt(new Uint32Array(u*3),1),s){let h=1/0,f=-1/0,p=1/0,m=-1/0;for(let y=0,b=d;y<b;y++){let x=y*2,S=s.vertices[x+0],w=s.vertices[x+1];S<h&&(h=S),S>f&&(f=S),w<p&&(p=w),w>m&&(m=w)}let g=f-h,v=m-p;for(let y=0,b=d;y<b;y++){let x=y*2,S=s.vertices[x+0],w=s.vertices[x+1],E=(S-h)/g,C=(w-p)/v;this._positionAttribute.setXYZ(y,S,w,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,E,C)}for(let y=0,b=u;y<b;y++){let x=y*3,S=s.elements[x+0],w=s.elements[x+1],E=s.elements[x+2];this._indexAttribute.setX(x+0,S),this._indexAttribute.setX(x+1,w),this._indexAttribute.setX(x+2,E)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new Gae(this._shape,this._curveSegments);return e.userData=VM(this.userData),e}},qae=class extends vj{constructor(e,t,r=0,i=12,n=3,s=Jr.ODD){super(e,t,r,i,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new qae(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=VM(this.userData),e}},am=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,d;let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Jr.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=e.shape??(t==null?void 0:t.shape),o=(a==null?void 0:a.roundness)??r.roundness;a!==void 0&&(a instanceof Ki?(a.width!==i||a.height!==n)&&a.applySize(i,n):a=new Ki(i,n).fromJSON(a),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((d=e.parameters)==null?void 0:d.roundness)>0&&a.update());let l=a??new Ki(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new Gae(e.shape,n,{windingRule:a}):o=new qae(e.shape,t,r,n,i,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},Xae=Math.PI*2,yj=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return r.angle=Et.clamp(r.angle,0,360),{shape:e.shape&&e.shape instanceof Ki?e.shape:new Ki,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c=e.shape,d=t*.5,u=r*.5,h=FJe(c,d,u,n*Math.PI/180,i,s);c.isClosed=!0,c.update();let f;return n===0?(f=new Dt,f.setAttribute("position",new vt([],3))):f=am.create({shape:c,parameters:{subdivisions:h,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}}),Object.assign(f,{userData:{...e,type:"EllipseGeometry"}})}};function FJe(e,t,r,i,n,s){if(i>=Xae)return n>30||n%4===0?(VJe(e,t,r,s),Math.round(n/4)):x9(e,i,n,t,r,s);i=Math.max(i,.001);let a={x:0,y:r},o=i+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*r},c=OJe({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?jJe(e,a.x,a.y,c,n,t,r,s):x9(e,i,n,t,r,s)}function jJe(e,t,r,i,n,s,a,o){let l=Math.round(n/i.length);e.addPoint(pv(t,r));for(let c=0,d=i.length;c<d;c++){let u=i[c],h=e.points[c],f=pv(u.x,u.y);h.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),e.addPoint(f)}return o>0?Yae(e,s,a,o):e.addPoint(pv(0,0)),l}function x9(e,t,r,i,n,s){let a=-t/r;for(let o=0;o<=r;o++){let l=a*o,c=Math.sin(l)*i,d=Math.cos(l)*n;e.addPoint(pv(c,d))}return t<Xae?s>0?Yae(e,i,n,s):e.addPoint(pv(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&Kae(e,i,n,s)),1}function VJe(e,t,r,i=0,n=0,s=0){let a=.5522847498,o=t*a,l=r*a;e.addPoint(fS(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(fS(n,s+r,n-o,s+r,n+o,s+r)),e.addPoint(fS(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(fS(n,s-r,n+o,s-r,n-o,s-r)),i>0&&Kae(e,t,r,i)}function pv(e,t){return new fv(Et.generateUUID(),new oe(e,t))}function fS(e,t,r,i,n,s){let a=pv(e,t);return a.controls[0].position.set(r,i),a.controls[1].position.set(n,s),a}function Yae(e,t,r,i){Qae(e,t,r,i).forEach(n=>e.addPoint(n))}function Kae(e,t,r,i){let n=Qae(e,t,r,i),s=new Ki;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function Qae(e,t,r,i){let n=i*t/100,s=n*(Math.abs(r)/Math.abs(t)),a=new oe(n/t,s/r),o=e.points.map(l=>{let c=l.clone();return c.uuid=Et.generateUUID(),c}).reverse();return o.forEach(l=>{l.position.multiply(a);let c=l.controls[0].position.clone().multiply(a),d=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(d),l.controls[1].position.copy(c)}),o}var UJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),s=Math.abs(r.depth??i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:s,radius:a,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:d,cornerSegments:u}=e.parameters,h=new Zae(!1,t,r,i,n,s,a,o,l,c,d,u);return Object.assign(h,{userData:{...e,type:"HelixGeometry"}})}},KR=new av([0,0,0],1),Zae=class extends Dt{constructor(e=!0,t=1,r=1,i=1,n=1,s=1,a=1,o=1,l=1,c=1,d=1,u=1){if(super(),s===0)return;let h=e&&s===1;h&&(u=0),d>100&&(d=100),d===0&&(u=0);let f=()=>new L,p=new L,m=f(),g=f(),v=f(),y,b,x,S,w,E,C,T,A=f(),M=f(),P=f(),I=f(),R=f(),N=f(),k=f(),O=f(),D=r-2*o+.001,B=D/s,z=Math.ceil(a*s),F=z+1,V=D/z,Y=-D/2,W=c+1,X=2*Math.PI/c,H=Math.PI/2/u,ie=.01,Q=Math.min((1-d/100)*o,o-ie),Z=o-Q,ee=0,re=2,ne=u*re+re,se=W*ne/re,fe=se+W*F,me=Math.max(0,W*(F+ne)),[Oe,Ee,Se]=[3,3,2].map(pe=>Array(me*pe).fill(0)),de=[],be=n-o;function ye(pe,Me){let Ue=Math.PI/2;E=Me*V,T=2*Math.PI*(E%B)/B+Ue,E+=Y,C=Math.sin(T)*be,w=Math.cos(T)*be,e?pe.set(w,C,E):pe.set(w,E,C)}ye(p,-1e-10),ye(m,0),A.copy(p),ye(p,1);let q=p.distanceTo(m),U=h?0:Z+Q,ce=q*z+2*U,xe=Q,j=ce-U;for(let pe=0;pe<=z;pe++){ye(g,pe),O.subVectors(g,A).normalize(),A.copy(g),N.copy(g).setComponent(+e+1,0).normalize(),k.crossVectors(O,N).normalize();let Me=pe===0,Ue=pe===z,Re=Me?3*Math.PI/2:H,et=Me?xe:j,Xe=Me?W:fe,Ze=Me?0:me-W,Mt=O.clone().multiplyScalar(Me?-Z:Z).add(g),Gt=O.clone().multiplyScalar(Me?-1:1).normalize();for(let ue=0;ue<W;ue++){let Ae=ue*X;if(M.addVectors(p.copy(N).multiplyScalar(o*Math.cos(Ae)),m.copy(k).multiplyScalar(o*Math.sin(Ae))),P.copy(M).normalize(),Me||Ue){h||(ee=Ze+ue,[0,1,2].forEach(ke=>{Oe[ee*3+ke]=Mt.getComponent(ke),Ee[ee*3+ke]=Gt.getComponent(ke)}),Se[ee*2]=+Ue,Se[ee*2+1]=ue/c),m.copy(P).multiplyScalar(Q),v.addVectors(g,m);for(let ke=0;ke<u;ke++){let Ie=ke*H+Re;I.addVectors(p.copy(O).multiplyScalar(Z*Math.sin(Ie)),m.copy(P).multiplyScalar(Z*Math.cos(Ie))),R.copy(I).normalize(),m.addVectors(v,I),I.normalize(),ee=Xe+ke*W+ue,[0,1,2].forEach(tt=>{Oe[ee*3+tt]=m.getComponent(tt),Ee[ee*3+tt]=R.getComponent(tt)});let $e=+Me+Math.sin(Ie);Se[ee*2]=(et+Z*$e)/ce,Se[ee*2+1]=ue/c}}m.addVectors(g,M),ee=se+pe*W+ue,[0,1,2].forEach(ke=>{Oe[ee*3+ke]=m.getComponent(ke),Ee[ee*3+ke]=P.getComponent(ke)}),Se[ee*2]=(U+pe*q)/ce,Se[ee*2+1]=ue/c}}let Be=F+2*u+re,[ze,Ve]=[+h,Be-1];for(let pe=ze;pe<=Ve-1;pe++){let Me=h&&pe===Ve-1;for(let Ue=0;Ue<W-1;Ue++)y=pe*W+Ue,b=y+1,x=(Me?Ue:y)+W,S=(Me?Ue+1:b)+W,pe===0?de.push(b,S,x):pe===Be-2?de.push(y,b,x):de.push(y,b,x,b,S,x)}this.setIndex(de),this.setAttribute("position",new vt(Oe,3)),this.setAttribute("normal",new vt(Ee,3)),this.setAttribute("uv",new vt(Se,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,s,a,o,l=6*(t-1)*e.radialSegments,c=t,d=c===t;for(let u=0;u<e.radialSegments;u++)n=c*r+u,s=n+1,a=(d?u:n)+r,o=(d?u+1:s)+r,i[l++]=n,i[l++]=s,i[l++]=a,i[l++]=s,i[l++]=o,i[l++]=a;return i.length=l,KR.array=i,KR.count=i.length,KR}},$Je=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new Jae(t*.5,s,a):new Qne(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},Jae=class extends fj{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,r),this.type=a}static fromJSON(e){return new Jae(e.radius,e.corner,e.cornerSides)}},HJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i;(((i=e.parameters)==null?void 0:i.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new xA;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new Wne(n.extractPoints(i).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},lc=new Ke,QR=new Yr,pS=new L,nT=class extends Ls{constructor(){super(),this.uuid=Et.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new on().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return lc.makeRotationX(e),this.applyMatrix4(lc),this}rotateY(e){return lc.makeRotationY(e),this.applyMatrix4(lc),this}rotateZ(e){return lc.makeRotationZ(e),this.applyMatrix4(lc),this}translate(e,t,r){return lc.makeTranslation(e,t,r),this.applyMatrix4(lc),this}scale(e,t,r){return lc.makeScale(e,t,r),this.applyMatrix4(lc),this}lookAt(e){return QR.lookAt(e),QR.updateMatrix(),this.applyMatrix4(QR.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<n.count;u++)t.vertices.push(new L().fromBufferAttribute(n,u)),a!==void 0&&t.colors.push(new zt().fromBufferAttribute(a,u));function c(u,h,f,p){let m=a===void 0?[]:[t.colors[u].clone(),t.colors[h].clone(),t.colors[f].clone()],g=s===void 0?[]:[new L().fromBufferAttribute(s,u),new L().fromBufferAttribute(s,h),new L().fromBufferAttribute(s,f)],v=new VN(u,h,f,g,m,p);t.faces.push(v),o!==void 0&&t.faceVertexUvs[0].push([new oe().fromBufferAttribute(o,u),new oe().fromBufferAttribute(o,h),new oe().fromBufferAttribute(o,f)]),l!==void 0&&t.faceVertexUvs[1].push([new oe().fromBufferAttribute(l,u),new oe().fromBufferAttribute(l,h),new oe().fromBufferAttribute(l,f)])}let d=e.groups;if(d.length>0)for(let u=0;u<d.length;u++){let h=d[u],f=h.start,p=h.count;for(let m=f,g=f+p;m<g;m+=3)r!==void 0?c(r.getX(m),r.getX(m+1),r.getX(m+2),h.materialIndex):c(m,m+1,m+2,h.materialIndex)}else if(r!==void 0)for(let u=0;u<r.count;u+=3)c(r.getX(u),r.getX(u+1),r.getX(u+2));else for(let u=0;u<n.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pS).negate(),this.translate(pS.x,pS.y,pS.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new Ke;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new L,t=new L;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new L;if(e){let r=new L,i=new L;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c];r.subVectors(c,l),i.subVectors(o,l),r.cross(i),t[a.a].add(r),t[a.b].add(r),t[a.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,s=i.vertexNormals.length;n<s;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new nT;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new L,c={a:new L,b:new L,c:new L};n.push(l),s.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=i.faceNormals[n],l=i.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new un),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Za),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,d=e.colors;t!==void 0&&(i=new on().getNormalMatrix(t));for(let u=0,h=a.length;u<h;u++){let f=a[u].clone();t!==void 0&&f.applyMatrix4(t),s.push(f)}for(let u=0,h=d.length;u<h;u++)c.push(d[u].clone());for(let u=0,h=l.length;u<h;u++){let f=l[u],p,m,g=f.vertexNormals,v=f.vertexColors,y=new VN(f.a+n,f.b+n,f.c+n);y.normal.copy(f.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let b=0,x=g.length;b<x;b++)p=g[b].clone(),i!==void 0&&p.applyMatrix3(i).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let b=0,x=v.length;b<x;b++)m=v[b],y.vertexColors.push(m.clone());y.materialIndex=f.materialIndex+r,o.push(y)}for(let u=0,h=e.faceVertexUvs.length;u<h;u++){let f=e.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,m=f.length;p<m;p++){let g=f[p],v=[];for(let y=0,b=g.length;y<b;y++)v.push(g[y].clone());this.faceVertexUvs[u].push(v)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let c=this.vertices[o],d=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[d]===void 0?(t[d]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[d]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let c=this.faces[o];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let d=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(d[u]===d[(u+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let c=0,d=this.faceVertexUvs.length;c<d;c++)this.faceVertexUvs[c].splice(l,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new L(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function r(o,l){return o.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;i&&i.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(i[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(e[p]=f[p]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];t.push(p.x,p.y,p.z)}let r=[],i=[],n={},s=[],a={},o=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],m=!0,g=!1,v=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,b=p.vertexNormals.length>0,x=p.color.r!==1||p.color.g!==1||p.color.b!==1,S=p.vertexColors.length>0,w=0;if(w=c(w,0,0),w=c(w,1,m),w=c(w,2,g),w=c(w,3,v),w=c(w,4,y),w=c(w,5,b),w=c(w,6,x),w=c(w,7,S),r.push(w),r.push(p.a,p.b,p.c),r.push(p.materialIndex),v){let E=this.faceVertexUvs[0][f];r.push(h(E[0]),h(E[1]),h(E[2]))}if(y&&r.push(d(p.normal)),b){let E=p.vertexNormals;r.push(d(E[0]),d(E[1]),d(E[2]))}if(x&&r.push(u(p.color)),S){let E=p.vertexColors;r.push(u(E[0]),u(E[1]),u(E[2]))}}function c(f,p,m){return m?f|1<<p:f&~(1<<p)}function d(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return n[p]!==void 0||(n[p]=i.length/3,i.push(f.x,f.y,f.z)),n[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return a[p]!==void 0||(a[p]=s.length,s.push(f.getHex())),a[p]}function h(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=o.length/2,o.push(f.x,f.y)),l[p]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return new nT().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let u=0,h=t.length;u<h;u++)this.vertices.push(t[u].clone());let r=e.colors;for(let u=0,h=r.length;u<h;u++)this.colors.push(r[u].clone());let i=e.faces;for(let u=0,h=i.length;u<h;u++)this.faces.push(i[u].clone());for(let u=0,h=e.faceVertexUvs.length;u<h;u++){let f=e.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,m=f.length;p<m;p++){let g=f[p],v=[];for(let y=0,b=g.length;y<b;y++){let x=g[y];v.push(x.clone())}this.faceVertexUvs[u].push(v)}}let n=e.morphTargets;for(let u=0,h=n.length;u<h;u++){let f={};if(f.name=n[u].name,n[u].vertices!==void 0){f.vertices=[];for(let p=0,m=n[u].vertices.length;p<m;p++)f.vertices.push(n[u].vertices[p].clone())}if(n[u].normals!==void 0){f.normals=[];for(let p=0,m=n[u].normals.length;p<m;p++)f.normals.push(n[u].normals[p].clone())}this.morphTargets.push(f)}let s=e.morphNormals;for(let u=0,h=s.length;u<h;u++){let f={};if(s[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,m=s[u].vertexNormals.length;p<m;p++){let g=s[u].vertexNormals[p],v={};v.a=g.a.clone(),v.b=g.b.clone(),v.c=g.c.clone(),f.vertexNormals.push(v)}}if(s[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,m=s[u].faceNormals.length;p<m;p++)f.faceNormals.push(s[u].faceNormals[p].clone())}this.morphNormals.push(f)}let a=e.skinWeights;for(let u=0,h=a.length;u<h;u++)this.skinWeights.push(a[u].clone());let o=e.skinIndices;for(let u=0,h=o.length;u<h;u++)this.skinIndices.push(o[u].clone());let l=e.lineDistances;for(let u=0,h=l.length;u<h;u++)this.lineDistances.push(l[u]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new WJe().fromGeometry(this),t=new Dt,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",mS.call(new Wt(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",mS.call(new Wt(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",w9.call(new Wt(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",_9.call(new Wt(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",_9.call(new Wt(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],s=e.morphTargets[i];for(let a=0,o=s.length;a<o;a++){let l=s[a],c=new vt(l.data.length*3,3);c.name=l.name,n.push(mS.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new vt(e.skinIndices.length*4,4);t.setAttribute("skinIndex",S9.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new vt(e.skinWeights.length*4,4);t.setAttribute("skinWeight",S9.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Dt,r=e.geometry;if(e.isPoints||e.isLine){let i=new vt(r.vertices.length*3,3),n=new vt(r.colors.length*3,3);if(t.setAttribute("position",mS.call(i,r.vertices)),t.setAttribute("color",w9.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let s=new vt(r.lineDistances.length,1);t.setAttribute("lineDistance",GJe.call(s,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};nT.prototype.isGeometry=!0;var WJe=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,s=e.faces;for(i=0;i<s.length;i++){let a=s[i];a.materialIndex!==n&&(n=a.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let g=0;g<o;g++)l[g]={name:a[g].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,d=c.length,u;if(d>0){u=[];for(let g=0;g<d;g++)u[g]={name:c[g].name,data:[]};this.morphTargets.normal=u}let h=e.skinIndices,f=e.skinWeights,p=h.length===r.length,m=f.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<t.length;g++){let v=t[g];this.vertices.push(r[v.a],r[v.b],r[v.c]);let y=v.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let x=v.normal;this.normals.push(x,x,x)}let b=v.vertexColors;if(b.length===3)this.colors.push(b[0],b[1],b[2]);else{let x=v.color;this.colors.push(x,x,x)}if(n===!0){let x=i[0][g];x!==void 0?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new oe,new oe,new oe))}if(s===!0){let x=i[1][g];x!==void 0?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new oe,new oe,new oe))}for(let x=0;x<o;x++){let S=a[x].vertices;l[x].data.push(S[v.a],S[v.b],S[v.c])}for(let x=0;x<d;x++){let S=c[x].vertexNormals[g];u[x].data.push(S.a,S.b,S.c)}p&&this.skinIndices.push(h[v.a],h[v.b],h[v.c]),m&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},VN=class{constructor(e,t,r,i,n,s=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new L,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new zt,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function GJe(e){return this.array.set(e),this}function w9(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new zt),t[r++]=s.r,t[r++]=s.g,t[r++]=s.b}return this}function _9(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new oe),t[r++]=s.x,t[r++]=s.y}return this}function mS(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new L),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z}return this}function S9(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new Yt),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=s.w}return this}var qJe=["a","b","c"];function XJe(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function ZR(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),s=i+"_"+n;return r.get(s)}function JR(e,t,r,i,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,c;if(i.has(l))c=i.get(l);else{let d=r[a],u=r[o];c={a:d,b:u,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),s[e].edges.push(c),s[t].edges.push(c)}function YJe(e,t,r,i){let n,s,a;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],JR(a.a,a.b,e,i,a,r),JR(a.b,a.c,e,i,a,r),JR(a.c,a.a,e,i,a,r)}function gS(e,t,r,i,n){e.push(new VN(t,r,i,void 0,void 0,n))}function Km(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function vS(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var KJe=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof Dt?e=new nT().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new L,r,i,n,s,a,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],d=c!==void 0&&c.length>0,u=[],h=new Map;YJe(o,l,u,h);let f=[],p,m,g,v,y,b,x;for(let ie of Array.from(h.keys())){for(m=h.get(ie),g=new L,y=3/8,b=1/8,x=m.faces.length,x!=2&&(y=.5,b=0,x!=1),g.addVectors(m.a,m.b).multiplyScalar(y),t.set(0,0,0),s=0;s<x;s++){for(v=m.faces[s],a=0;a<3&&(p=o[XJe(v,qJe[a])],!(p!==m.a&&p!==m.b));a++);p&&t.add(p)}t.multiplyScalar(b),g.add(t),m.newEdge=f.length,f.push(g)}let S,w,E,C,T,A,M,P=[];for(i=0,n=o.length;i<n;i++){for(A=o[i],T=u[i].edges,r=T.length,r==3?S=3/16:r>3&&(S=3/(8*r)),w=1-r*Number(S),E=S,r<=2&&(r==2?(w=3/4,E=1/8):r==1||r==0),M=A.clone().multiplyScalar(w),t.set(0,0,0),s=0;s<r;s++)C=T[s],p=C.a!==A?C.a:C.b,t.add(p);t.multiplyScalar(Number(E)),M.add(t),P.push(M)}let I=P.concat(f),R=P.length,N,k,O,D=[],B=[],z,F,V,Y,W=new oe,X=new oe,H=new oe;for(i=0,n=l.length;i<n;i++)v=l[i],N=Number(ZR(v.a,v.b,h).newEdge)+R,k=Number(ZR(v.b,v.c,h).newEdge)+R,O=Number(ZR(v.c,v.a,h).newEdge)+R,gS(D,N,k,O,v.materialIndex),gS(D,v.a,N,O,v.materialIndex),gS(D,v.b,k,N,v.materialIndex),gS(D,v.c,O,k,v.materialIndex),d&&(z=c[i],F=z[0],V=z[1],Y=z[2],W.set(Km(F.x,V.x),Km(F.y,V.y)),X.set(Km(V.x,Y.x),Km(V.y,Y.y)),H.set(Km(F.x,Y.x),Km(F.y,Y.y)),vS(B,W,X,H),vS(B,F,W,H),vS(B,V,X,W),vS(B,Y,H,X));e.vertices=I,e.faces=D,d&&(e.faceVertexUvs[0]=B)}},Dn=new L,QJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??(t==null?void 0:t.geometry)??new Dt().copy(new Ql(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(Dn),i={width:Dn.x,height:Dn.y,depth:Dn.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,s=e.geometry??new Dt().copy(new Ql(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Dn)):Dn.set(a.width,a.height,a.depth),(t!==Dn.x||r!==Dn.y||i!==Dn.z)&&s.scale(Dn.x===0?1:t/Dn.x,Dn.y===0?1:r/Dn.y,Dn.z===0?1:i/Dn.z);let o=s.originalGeometry;try{n>0?(o===void 0||(a==null?void 0:a.subdivisions)!==n)&&(o===void 0&&(o=s),s=new KJe(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new ase(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(Dn);let s=100/Dn.x;Object.assign(n.parameters,{width:100,height:Dn.y*s,depth:Dn.z*s}),t(this.build(n))})}},eoe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Ki?e.shape:new Ki,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=t*.5,d=r*.5,u=0,h=0,f=2*Math.PI/i;for(let m=0;m<i;m++){let g=f*m,v=u+Math.sin(g)*c,y=h+Math.cos(g)*d;l.addPoint(l.createPoint(v,y))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=n;l.roundness=n,l.update();let p=am.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(p,{userData:{...e,type:"PolygonGeometry"}})}},ZJe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new eet(t*.5,r,n,s,a,o,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function jy(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function eD(e,t,r,i,n,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===n){let c=a.add(o).normalize();s.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(c)),s.addScaledVector(o,i/Math.sin(c))}}function JJe(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var eet=class extends Dt{constructor(e=.5,t=1,r=4,i=1,n=!1,s=0,a=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),a=Math.floor(a);let o=[],l=[],c=[],d=[],u=0,h=t/2,f=Math.PI/r,p=e*Math.cos(Math.PI/r),m=2*Math.PI/r,g=(r-2)*Math.PI/r,v=Math.PI-g,y=new L(0,-h,0),b=new L(0,h,0),x=new oe(e,-h),S=new oe(p,-h),w=new oe(0,b.y).sub(S),E=new oe(0,b.y).sub(x),C=new oe(w.y,-w.x).normalize(),T=new oe(E.y,-E.x).normalize(),A=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-w.angle())/2)-1e-8;s=Math.min(s,A);let M;{let O=new L(C.x,C.y,0),D=new L(Math.cos(m)*O.x,O.y,Math.sin(m)*O.x);M=O.angleTo(D)}let P=s/Math.tan((Math.PI-w.angle())/2),I=s/Math.tan((Math.PI-M)/2),R=new L;if(!n){l.push(y.x,y.y,y.z),c.push(0,-1,0),d.push(0,0);let O=u++,D=[],B=x.clone(),z=P/Math.cos(Math.PI/r);B.x-=z;for(let F=0;F<r;F++){let V=F/r*Math.PI*2+f,Y=new oe(Math.sin(V),Math.cos(V));jy(B,Y,R),l.push(R.x,R.y,R.z),c.push(0,-1,0),d.push(0,0),D.push(u++)}for(let F=0;F<D.length;F++)o.push(D[F],O,D[(F+1)%D.length])}{let O=new L,D=new L,B=new L,z=new L,F=new L,V=new L;for(let Y=0;Y<r;Y++){let W=Y/r*Math.PI*2+f,X=(Y+.5)/r*Math.PI*2+f,H=(Y+1)/r*Math.PI*2+f,ie=new oe(Math.sin(W),Math.cos(W)),Q=new oe(Math.sin(X),Math.cos(X)),Z=new oe(Math.sin(H),Math.cos(H));jy(x,ie,D),jy(x,Z,B),jy(C,Q,O),eD(b,D,B,I,I,z),l.push(z.x,z.y,z.z),eD(D,b,B,I,P,F),l.push(F.x,F.y,F.z),eD(B,D,b,P,I,V),l.push(V.x,V.y,V.z),c.push(O.x,O.y,O.z),c.push(O.x,O.y,O.z),c.push(O.x,O.y,O.z),d.push(0,0),d.push(0,0),d.push(0,0);let ee=u++,re=u++,ne=u++;if(o.push(ee,re,ne),s>0){{let me=D.clone().add(B).multiplyScalar(.5),Oe=b.clone().sub(me).normalize(),Ee=y.clone().sub(me).normalize().add(Oe).normalize().multiplyScalar(-1),Se=V.clone().sub(F);N(me,Se,Ee,w.angle())}let se,fe;{let me=new L;jy(T,Z,me);let Oe=V.clone().add(z).multiplyScalar(.5);Oe=JJe(Oe,B,b);let Ee=V.clone().sub(z);[se,fe]=N(Oe,Ee,me,M,z.y)}{let me=se,Oe=me.clone().setY(0).normalize(),Ee=new L(0,-1,0),Se=Oe.clone().cross(Ee);k(me,Oe,Ee,Se)}{let me=w.angle(),Oe=Math.PI-me,Ee=b.clone();Ee.y-=s/Math.sin(me-Math.PI/2);let Se=new L,de=[];for(let ye=0;ye<a;ye++){let q=[],U=Math.PI/2-Oe*ye/a,ce=Math.cos(U),xe=Math.sin(U),j=X;for(let Be=0;Be<=ye;Be++){let ze=Math.cos(j),Ve=Math.sin(j);O.x=ce*Ve,O.y=xe,O.z=ce*ze,Se.copy(Ee).addScaledVector(O,s),l.push(Se.x,Se.y,Se.z),c.push(O.x,O.y,O.z),d.push(0,0),q.push(u++),j+=Math.PI*2/ye/r}de.push(q)}fe.reverse(),de.push(fe);let be=de.length-1;for(let ye=0;ye<be;ye++){let q=de[ye],U=de[ye+1],ce=q.length-1;o.push(U[1],q[0],U[0]);for(let xe=1;xe<=ce;xe++)o.push(q[xe],q[xe-1],U[xe]),o.push(U[xe+1],q[xe],U[xe])}}}}}this.setIndex(o),this.setAttribute("position",new vt(l,3)),this.setAttribute("normal",new vt(c,3)),this.setAttribute("uv",new vt(d,2));function N(O,D,B,z,F){let V=-z/2,Y=(Math.PI-z)/2,W=D.clone().normalize().cross(B);O.addScaledVector(B,-s/Math.sin(Y));let X=new L,H=new L,ie=1,Q=u,Z=[];for(let ee=0;ee<=a;ee++){let re=V+ee/a*z;H.set(0,0,0),H.addScaledVector(W,Math.sin(re)),H.addScaledVector(B,Math.cos(re));for(let ne=0;ne<=ie;ne++){let se=ne/ie-.5;if(X.copy(O),X.addScaledVector(D,se),X.addScaledVector(H,s),F!=null){let fe=Math.max(0,X.y-F);X.addScaledVector(D,-fe/D.y)}l.push(X.x,X.y,X.z),c.push(H.x,H.y,H.z),d.push(0,0),ne===0&&Z.push(u),u++}}for(let ee=0;ee<a;ee++)for(let re=0;re<ie;re++){let ne=Q+re+(ie+1)*ee,se=ne+(ie+1),fe=se+1,me=ne+1;o.push(ne,se,me),o.push(se,fe,me)}return[O.clone().addScaledVector(D,.5),Z]}function k(O,D,B,z){let F=Math.PI/2,V=E.angle()-F,Y=[],W=new L,X=new L;for(let ie=0;ie<=a;ie++){let Q=[],Z=ie/a;for(let ee=0;ee<=ie;ee++){let re=((ie?ee/ie:0)-.5)*v,ne=Math.cos(re),se=Math.sin(re),fe=Math.atan(Math.tan(V)*ne),me=(F+fe)*Z,Oe=Math.cos(me),Ee=Math.sin(me);W.set(0,0,0),W.addScaledVector(D,Ee*ne),W.addScaledVector(B,Oe),W.addScaledVector(z,Ee*se),X.copy(O).addScaledVector(W,s),l.push(X.x,X.y,X.z),c.push(W.x,W.y,W.z),d.push(0,0),Q.push(u++)}Y.push(Q)}let H=Y.length-1;for(let ie=0;ie<H;ie++){let Q=Y[ie],Z=Y[ie+1],ee=Q.length-1;o.push(Q[0],Z[1],Z[0]);for(let re=1;re<=ee;re++)o.push(Q[re-1],Q[re],Z[re]),o.push(Q[re],Z[re+1],Z[re])}}}},bj=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Ki?e.shape:new Ki,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},d={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function h(x,S,w){return S>r&&w>i?Math.min(x*r/S,x*i/w):S>r?x*r/S:w>i?x*i/w:x}let f=[];f[0]=n[0]===0?0:h(n[0],n[0]+n[3],n[0]+n[1]),f[1]=n[1]===0?0:h(n[1],n[1]+n[2],n[1]+n[0]),f[2]=n[2]===0?0:h(n[2],n[2]+n[1],n[2]+n[3]),f[3]=n[3]===0?0:h(n[3],n[3]+n[0],n[3]+n[2]);let p=d.x,m=u.x,g=u.y,v=d.y;t.addPoint(t.createPoint(p,g)),t.addPoint(t.createPoint(m,g)),t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(p,v)),t.isClosed=!0;let y=!0;for(let x=0,S=t.points.length;x<S;x++)t.points[x].roundness=f[x],x>0&&f[x]!==f[x-1]&&(y=!1);y&&(t.roundness=f[0]),t.useCubicForRoundedCorners=s!==1,t.update();let b=am.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(b,{userData:{...e,type:"RectangleGeometry"}})}},tet=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return r.thetaLength=Et.clamp(r.thetaLength,0,180),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:c}=e.parameters,d;return c===0?(d=new Dt,d.setAttribute("position",new vt([],3))):d=new ov(.5*t,n,s,a,o,l,c*Et.DEG2RAD),d.scale(1,r/t,i/t),Object.assign(d,{userData:{...e,type:"SphereGeometry"}})}},ret=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,s=new rm(t,r,i,n);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},iet=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new net(t,r,i,n,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},net=class extends Dt{constructor(e=1,t=1,r=1,i=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let d=[],u=Math.PI/2,h=(ie=0,Q=0,Z=0)=>new L(ie,Q,Z),f=h(),p=h(),[m,g,v]=[t/2,e/2,r/2],y=-g,b=+g,[x,S,w]=[h(y,-m,+v),h(y,-m,-v),h(y,+m,-v)],E=(ie,Q=!1)=>Math.sin(ie-Math.PI/(1+ +Q)),C=(ie,Q=!1)=>Math.cos(ie-Math.PI/(1+ +Q));w.y=Math.sin(i)*t-m;let T=Math.cos(i)*t-v,A=x.z-c;i<=u?(w.z=Math.min(T,A),w.z==A&&(w.y-=(T-A)/Math.tan(u-i))):S.z=Math.min(S.z-T-v,x.z-c),f.subVectors(x,S),p.subVectors(w,S);let M=Math.min(f.length(),p.length())*n/100,P=M*Math.tan(i/2),I=M/Math.cos(i/2),R=f.clone().normalize().add(p.normalize()).setLength(I).add(S);f.set(0,E(i,!0),C(i,!0)),d.push([w,f.clone()]);let N=(Math.PI-i)/s;for(let ie=0;ie<=s;ie++){let Q=u+i+ie*N;f.set(0,Math.sin(Q)*P,Math.cos(Q)*P),f.add(R),p.set(0,E(Q),C(Q)),d.push([f.clone(),p.clone()])}d.push([x,h(0,1,0)]);let k=Math.sin(N/2)*P*2,O=d.length-1,D=d[0][0].distanceTo(d[1][0]),B=d[O-1][0].distanceTo(d[O][0]),z=D+k*s+B;d[0].push(1);for(let ie=0;ie<=s;ie++)d[ie+1].push(1-(D+ie*k)/z);d[O].push(0);let[F,V,Y]=d[0],W,X,H;for(let ie=1;ie<d.length;ie++)[W,X,H]=d[ie],a.push(y,F.y,F.z,y,W.y,W.z,b,F.y,F.z,b,F.y,F.z,y,W.y,W.z,b,W.y,W.z),o.push(0,V.y,V.z,0,X.y,X.z,0,V.y,V.z,0,V.y,V.z,0,X.y,X.z,0,X.y,X.z),l.push(0,Y,0,H,1,Y,1,Y,0,H,1,H),[F,V,Y]=[W,X,H];this.setAttribute("position",new vt(a,3)),this.setAttribute("normal",new vt(o,3)),this.setAttribute("uv",new vt(l,2))}},toe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Ki?e.shape:new Ki,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,d=e.shape,u=t*.5,h=r*.5,f=0,p=0,m=a*Math.PI/360/n,g=Math.PI/2*3*-1,v=u*i/100,y=h*i/100;if(n===3&&i===50){m=2*Math.PI/n;for(let x=0;x<n;x++){let S=m*x,w=f+Math.sin(S)*u,E=p+Math.cos(S)*h;d.addPoint(d.createPoint(w,E))}}else for(let x=0;x<n;x++){let S=f+Math.cos(g)*u,w=p+Math.sin(g)*h;d.addPoint(d.createPoint(S,w)),g+=m,S=f+Math.cos(g)*v,w=p+Math.sin(g)*y,d.addPoint(d.createPoint(S,w)),g+=m}d.isClosed=!0;for(let x=0,S=d.points.length;x<S;x++)d.points[x].roundness=s;d.roundness=s,d.update();let b=am.create({shape:d,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(b,{userData:{...e,type:"StarGeometry"}})}},set=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new rm(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},aet=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:s})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=oet(t,r,i,t*.5,a,s,0,0,n,o,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function oet(e,t,r,i,n,s,a,o,l,c,d){[t,r]=[r,t],a=t/2;let u=Et.clamp(n/360,0,1);if(u===0){let h=new Dt;return h.setAttribute("position",new vt([],3)),h}return u===1&&(c=0),new Zae(!0,e,t,r,i,u,s,a,o,l,c,d)}var cet=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==r&&(o-=r);let l=new Jne(o,r,i,n,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},uet=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Ki?e.shape:new Ki,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=t*.5,d=r*.5;o?(l.addPoint(l.createPoint(-c,d)),l.addPoint(l.createPoint(c,-d)),l.addPoint(l.createPoint(-c,-d))):(l.addPoint(l.createPoint(0,d)),l.addPoint(l.createPoint(c,-d)),l.addPoint(l.createPoint(-c,-d))),l.isClosed=!0;for(let h=0,f=l.points.length;h<f;h++)l.points[h].roundness=i;l.roundness=i,l.update();let u=am.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(u,{userData:{...e,type:"TriangleGeometry"}})}};function det(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}var het=class{add(e,t,r){if(typeof arguments[0]!="string")for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(i){this[i]=this[i]||[],t&&this[i][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}},fet=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},je=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+je.version}static addUnaryOp(t){return je.max_unop_len=Math.max(t.length,je.max_unop_len),je.unary_ops[t]=1,je}static addBinaryOp(t,r,i){return je.max_binop_len=Math.max(t.length,je.max_binop_len),je.binary_ops[t]=r,i?je.right_associative.add(t):je.right_associative.delete(t),je}static addIdentifierChar(t){return je.additional_identifier_chars.add(t),je}static addLiteral(t,r){return je.literals[t]=r,je}static removeUnaryOp(t){return delete je.unary_ops[t],t.length===je.max_unop_len&&(je.max_unop_len=je.getMaxKeyLen(je.unary_ops)),je}static removeAllUnaryOps(){return je.unary_ops={},je.max_unop_len=0,je}static removeIdentifierChar(t){return je.additional_identifier_chars.delete(t),je}static removeBinaryOp(t){return delete je.binary_ops[t],t.length===je.max_binop_len&&(je.max_binop_len=je.getMaxKeyLen(je.binary_ops)),je.right_associative.delete(t),je}static removeAllBinaryOps(){return je.binary_ops={},je.max_binop_len=0,je}static removeLiteral(t){return delete je.literals[t],je}static removeAllLiterals(){return je.literals={},je}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(t){this.expr=t,this.index=0}static parse(t){return new je(t).parse()}static getMaxKeyLen(t){return Math.max(0,...Object.keys(t).map(r=>r.length))}static isDecimalDigit(t){return t>=48&&t<=57}static binaryPrecedence(t){return je.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!je.binary_ops[String.fromCharCode(t)]||je.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return je.isIdentifierStart(t)||je.isDecimalDigit(t)}throwError(t){let r=new Error(t+" at character "+this.index);throw r.index=this.index,r.description=t,r}runHook(t,r){if(je.hooks[t]){let i={context:this,node:r};return je.hooks.run(t,i),i.node}return r}searchHook(t){if(je.hooks[t]){let r={context:this};return je.hooks[t].find(function(i){return i.call(r.context,r),r.node}),r.node}}gobbleSpaces(){let t=this.code;for(;t===je.SPACE_CODE||t===je.TAB_CODE||t===je.LF_CODE||t===je.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let t=this.gobbleExpressions(),r=t.length===1?t[0]:{type:je.COMPOUND,body:t};return this.runHook("after-all",r)}gobbleExpressions(t){let r=[],i,n;for(;this.index<this.expr.length;)if(i=this.code,i===je.SEMCOL_CODE||i===je.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())r.push(n);else if(this.index<this.expr.length){if(i===t)break;this.throwError('Unexpected "'+this.char+'"')}return r}gobbleExpression(){let t=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",t)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,je.max_binop_len),r=t.length;for(;r>0;){if(je.binary_ops.hasOwnProperty(t)&&(!je.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!je.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=r,t;t=t.substr(0,--r)}return!1}gobbleBinaryExpression(){let t,r,i,n,s,a,o,l,c;if(a=this.gobbleToken(),!a||(r=this.gobbleBinaryOp(),!r))return a;for(s={value:r,prec:je.binaryPrecedence(r),right_a:je.right_associative.has(r)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+r),n=[a,s,o];r=this.gobbleBinaryOp();){if(i=je.binaryPrecedence(r),i===0){this.index-=r.length;break}s={value:r,prec:i,right_a:je.right_associative.has(r)},c=r;let d=u=>s.right_a&&u.right_a?i>u.prec:i<=u.prec;for(;n.length>2&&d(n[n.length-2]);)o=n.pop(),r=n.pop().value,a=n.pop(),t={type:je.BINARY_EXP,operator:r,left:a,right:o},n.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+c),n.push(s,t)}for(l=n.length-1,t=n[l];l>1;)t={type:je.BINARY_EXP,operator:n[l-1].value,left:n[l-2],right:t},l-=2;return t}gobbleToken(){let t,r,i,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(t=this.code,je.isDecimalDigit(t)||t===je.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===je.SQUOTE_CODE||t===je.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(t===je.OBRACK_CODE)n=this.gobbleArray();else{for(r=this.expr.substr(this.index,je.max_unop_len),i=r.length;i>0;){if(je.unary_ops.hasOwnProperty(r)&&(!je.isIdentifierStart(this.code)||this.index+r.length<this.expr.length&&!je.isIdentifierPart(this.expr.charCodeAt(this.index+r.length)))){this.index+=i;let s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:je.UNARY_EXP,operator:r,argument:s,prefix:!0})}r=r.substr(0,--i)}je.isIdentifierStart(t)?(n=this.gobbleIdentifier(),je.literals.hasOwnProperty(n.name)?n={type:je.LITERAL,value:je.literals[n.name],raw:n.name}:n.name===je.this_str&&(n={type:je.THIS_EXP})):t===je.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let r=this.code;for(;r===je.PERIOD_CODE||r===je.OBRACK_CODE||r===je.OPAREN_CODE||r===je.QUMARK_CODE;){let i;if(r===je.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==je.PERIOD_CODE)break;i=!0,this.index+=2,this.gobbleSpaces(),r=this.code}this.index++,r===je.OBRACK_CODE?(t={type:je.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},this.gobbleSpaces(),r=this.code,r!==je.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):r===je.OPAREN_CODE?t={type:je.CALL_EXP,arguments:this.gobbleArguments(je.CPAREN_CODE),callee:t}:(r===je.PERIOD_CODE||i)&&(i&&this.index--,this.gobbleSpaces(),t={type:je.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),i&&(t.optional=!0),this.gobbleSpaces(),r=this.code}return t}gobbleNumericLiteral(){let t="",r,i;for(;je.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(this.code===je.PERIOD_CODE)for(t+=this.expr.charAt(this.index++);je.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(r=this.char,r==="e"||r==="E"){for(t+=this.expr.charAt(this.index++),r=this.char,(r==="+"||r==="-")&&(t+=this.expr.charAt(this.index++));je.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);je.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+t+this.char+")")}return i=this.code,je.isIdentifierStart(i)?this.throwError("Variable names cannot start with a number ("+t+this.char+")"):(i===je.PERIOD_CODE||t.length===1&&t.charCodeAt(0)===je.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:je.LITERAL,value:parseFloat(t),raw:t}}gobbleStringLiteral(){let t="",r=this.index,i=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===i){n=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=s}else t+=s}return n||this.throwError('Unclosed quote after "'+t+'"'),{type:je.LITERAL,value:t,raw:this.expr.substring(r,this.index)}}gobbleIdentifier(){let t=this.code,r=this.index;for(je.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,je.isIdentifierPart(t));)this.index++;return{type:je.IDENTIFIER,name:this.expr.slice(r,this.index)}}gobbleArguments(t){let r=[],i=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===t){i=!0,this.index++,t===je.CPAREN_CODE&&n&&n>=r.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}else if(s===je.COMMA_CODE){if(this.index++,n++,n!==r.length){if(t===je.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===je.CBRACK_CODE)for(let a=r.length;a<n;a++)r.push(null)}}else if(r.length!==n&&n!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===je.COMPOUND)&&this.throwError("Expected comma"),r.push(a)}}return i||this.throwError("Expected "+String.fromCharCode(t)),r}gobbleGroup(){this.index++;let t=this.gobbleExpressions(je.CPAREN_CODE);if(this.code===je.CPAREN_CODE)return this.index++,t.length===1?t[0]:t.length?{type:je.SEQUENCE_EXP,expressions:t}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:je.ARRAY_EXP,elements:this.gobbleArguments(je.CBRACK_CODE)}}},pet=new het;Object.assign(je,{hooks:pet,plugins:new fet(je),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});je.max_unop_len=je.getMaxKeyLen(je.unary_ops);je.max_binop_len=je.getMaxKeyLen(je.binary_ops);var s0=e=>new je(e).parse(),met=Object.getOwnPropertyNames(je);met.forEach(e=>{s0[e]===void 0&&e!=="prototype"&&(s0[e]=je[e])});s0.Jsep=je;var get="ConditionalExpression",vet={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let r=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:get,test:r,consequent:i,alternate:n},r.operator&&e.binary_ops[r.operator]<=.9){let s=r;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;t.node.test=s.right,s.right=t.node,t.node=r}}else this.throwError("Expected :")}})}};s0.plugins.register(vet);var yet=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],bet=["0","1","2","3","4","5","6","7","8","9","."],xet=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function wet(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}s0.addBinaryOp("^",11,!0);function roe(e,t,r="number"){let i="";for(let a=0;a<e.length;a++){let o=e[a];if("id"in o){let l=e[a-1];if(a>0&&"id"in l){console.error("Two variables in a row",e);return}let c=t.getVariable(o.id),d=go.getDisplayedValue(c);r==="number"&&go.isTextValue(c)&&Array.isArray(c.textValue)&&c.textValue.length===1?d=parseFloat(d).toString():r==="boolean"&&go.isBoolean(c)?d=c?"true":"false":r==="boolean"&&go.isTextValue(c)&&!Array.isArray(c.textValue)&&(d='"'+d+'"'),i+=d;continue}else if(r==="string"){o.name!=='"'&&o.name!=="+"&&(i+=o.name),o.name==="+"&&i[i.length-1]==="\\"&&(i=i.slice(0,-1)+o.name);continue}if(o.name==="and"){i+="&&";continue}if(o.name==="or"){i+="||";continue}if(o.name==="True"){i+="true";continue}if(o.name==="False"){i+="false";continue}if(r==="boolean"&&!wet(o.name)&&!bet.includes(o.name)&&!yet.includes(o.name)&&!xet.includes(o.name.replace(/\($/g,""))){i+='"'+o.name+'"';continue}i+=o.name}if(r==="string")return i;if(e.length===0){if(r==="number")return 0;if(r==="boolean")return!1}let n;try{n=s0(i)}catch(a){console.error(i,a);return}let s;try{s=Or(n)}catch(a){console.error(i,n,a)}return s}function Or(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(Or(e.left)===Or(e.right));case"!=":return+(Or(e.left)!==Or(e.right));case">":return+(Or(e.left)>Or(e.right));case">=":return+(Or(e.left)>=Or(e.right));case"<":return+(Or(e.left)<Or(e.right));case"<=":return+(Or(e.left)<=Or(e.right));case"+":return Or(e.left)+Or(e.right);case"-":return Or(e.left)-Or(e.right);case"*":return Or(e.left)*Or(e.right);case"/":return Or(e.left)/Or(e.right);case"%":return Or(e.left)%Or(e.right);case"&&":return Or(e.left)&&Or(e.right);case"||":return Or(e.left)||Or(e.right);case"^":return Math.pow(Or(e.left),Or(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-Or(e.argument);case"!":return+!Or(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,r=1;if(e.arguments.length>=1)try{t=Or(e.arguments[0])}catch(i){console.warn(i)}if(e.arguments.length>=2)try{r=Or(e.arguments[1])}catch(i){console.warn(i)}return t=Math.min(r,t),r=Math.max(r,t),t+Math.random()*(r-t)}return Math[e.callee.name].apply(null,e.arguments.map(Or))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var _et=new Ke,Eet=new Ke;function Cet(e,t,r){let i=[new L,new L,new L],n=[new L,new L,new L];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((s,a)=>{let o=n[a],l=Et.lerp(s.length(),o.length(),r);s.lerp(o,r).setLength(l)}),new Ke().makeBasis(i[0],i[1],i[2])}var Aet=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=(t==null?void 0:t.shapeData)??yj.create({parameters:Aae}).userData.shape;return{path:e.path??$A.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:s,extrusion:{...Tae,...r.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new Tet(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new Dt,{userData:{...e,type:"PathGeometry"}})}},Tet=class extends Dt{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!det(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),i=Math.max(0,Math.min(i,1));let n=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*n),a=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),o=Math.min(Math.max(2,a-s+1),n+2),l=[],c=[];for(let O=0;O<o;O++){let D=this.inputs.path.isClosed?(O+s)%e.length:Math.min(O+s,e.length-1);l.push(e[D].clone()),c.push(t[D].clone())}let d=(O,D,B)=>{l[O]=l[O].clone().lerp(l[D],B),c[O]=Cet(c[O],c[D],B)},u=0,h=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(h||i===0)&&(u=h,d(0,1,u));let f=0,p=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&p&&(f=p,d(l.length-1,l.length-2,1-f)),r===0){let O=l.length-1;l[O].copy(l[0]),c[O].copy(c[0])}this._applyPathModifiers(c,u,f);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:b,infos:x,vertices:S}=this._computeShapePoints(y),w=0,E;v==="round"&&(E=new vj(this.inputs.shapeData,2*m,m,y,g,void 0,!0),w=E.getAttribute("position").count);let C=0,T=0;x.sort((O,D)=>O.start-D.start),x.forEach(O=>{O.verticesStart=C,O.verticesCount=O.continuous.reduce((D,B,z)=>D+(z===0||!B?2:1),0),T+=O.verticesCount,C=T});let A=T*o,M,P=0;if(this._isOpenEnded()&&v==="flat"){try{M=ph({windingRule:Jr.ODD,elementType:En.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:b})}catch{M=Wae}P=M.vertexCount}let I=A+2*P+w*2,R=A+2*P,N={positions:new Float32Array(I*3),normals:new Float32Array(I*3),uvs:new Float32Array(I*2)},k=[];if(x.forEach(O=>{this._extrudeRegion(O,S,c,l,N,k,this._isGeometryClosed()&&!this._isOpenEnded())}),M&&(this._closeEnd(M,A,k,N,c[0],l[0],!1),this._closeEnd(M,A+P,k,N,c[c.length-1],l[l.length-1],!0)),E){N.positions.set(E.getAttribute("position").array,R*3),N.normals.set(E.getAttribute("normal").array,R*3),N.uvs.set(E.getAttribute("uv").array,R*2);let O=k.length;k.push(...E.getIndex().array.map(z=>z+R)),R+=w,N.positions.set(E.getAttribute("position").array,R*3),N.normals.set(E.getAttribute("normal").array,R*3),N.uvs.set(E.getAttribute("uv").array,R*2);let D=k.length;k.push(...E.getIndex().array.map(z=>z+R)),this.setAttribute("position",new Wt(N.positions,3)),this.setAttribute("normal",new Wt(N.normals,3)),this.setAttribute("uv",new Wt(N.uvs,2)),this.setIndex(k);let B=_et;B.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(B,R,I),B.copy(c[0]).setPosition(l[0]).multiply(Eet.makeScale(1,1,-1)),this.applyMatrix4OnRange(B,R-w,R),this.reverseIndicesOnRange(O,D)}else this.setAttribute("position",new Wt(N.positions,3)),this.setAttribute("normal",new Wt(N.normals,3)),this.setAttribute("uv",new Wt(N.uvs,2)),this.setIndex(k)}_extractPathPoints(){let e=kae(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new L,s=new L,a=new L,o=new L,l=new L(0,1,0);for(let p=0;p<r;p++){let m=e[p],g;p===0?g=i?e[e.length-2]:m.clone().multiplyScalar(2).sub(e[1]):g=e[p-1];let v;p===r-1?v=i?e[1]:m.clone().multiplyScalar(2).sub(e[p-1]):v=e[p+1];let y=m.clone().sub(g).normalize(),b=v.clone().sub(m).normalize(),x=y.clone().add(b).normalize();a.copy(x),p===0&&(x.equals(l)||x.clone().negate().equals(l))&&l.set(0,0,1);let S=l.clone().cross(x).normalize(),w=x.clone().cross(S).normalize();l.copy(w),o.copy(S),p===0&&(n.copy(w),s.copy(x));let E=new Ke().makeBasis(S,w,x);t.push(E)}let c=i?s:a,d=i?n:new L(0,1,0),u=c.clone().cross(o).normalize(),h=Math.acos(d.dot(u));if(isNaN(h))return t;let f=d.clone().cross(u);c.dot(f)>0&&(h*=-1);for(let p=1;p<t.length;p++){let m=new Ke().makeRotationZ(h*p/t.length);t[p].multiply(m)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new Ke,c=new Ke;return e.forEach((d,u)=>{let h=u===0?0:u===i-1?1:(u-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(Et.lerp(n,n+s,h)*Et.DEG2RAD);let f=Et.lerp(a,o,h);c.makeScale(f,f,f),d.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=Jr.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let d=c.extractShapePointsToFlatArray([],e),u=[];for(let h=d.length-1;h>=1;h-=2){let f=d[h-1],p=d[h-0];u.push(f,p)}return u}),s;try{s=ph({windingRule:t,elementType:En.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=gj}let a;try{a=ph({windingRule:Jr.ODD,elementType:En.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{a=Hae}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let c=0;c<a.elements.length;c++){let d=a.elements[c],u=c%2===0?s.vertexCount:0;s.elements.push(d+u)}for(let c=0;c<a.vertexIndices.length;c++){let d=a.vertexIndices[c],u=s.vertexCount;s.vertexIndices.push(d+u)}for(let c=0;c<a.vertices.length;c++){let d=a.vertices[c];s.vertices.push(d)}}for(let c=0,d=s.vertexCount;c<d;c++){let u=c*2;s.vertices[u+0],s.vertices[u+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let d=c>=o,u=c*2,h=s.elements[u+0],f=s.elements[u+1],p=h+f,m={start:h,count:f,normals:[],isHole:d,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let g=h,v=p-1,y=h+1,b=r.roundedCurves.length;do{let x=g-h;s.vertices[v*2+0],s.vertices[v*2+1];let S=s.vertices[g*2+0],w=s.vertices[g*2+1],E=s.vertices[y*2+0],C=s.vertices[y*2+1],T=S-E,A=w-C,M=Math.sqrt(T*T+A*A);T/=M,A/=M,m.normals[x*2+0]=-A,m.normals[x*2+1]=T;let P=s.vertexIndices[g];if(Array.isArray(P))m.continuous[x]=!1;else{let[I,R]=r.getCurveIndexFromVertexId(P-1,!0);if(R>0&&R<1)m.continuous[x]=!0;else{let N=R===1?I+1:I-1;N=(N+b)%b;let k=R===1?0:1,O=r.roundedCurves[I].getTangent(R),D=r.roundedCurves[N].getTangent(k);m.continuous[x]=O.dot(D)>.95}}d&&(m.normals[x*2+0]*=-1,m.normals[x*2+1]*=-1),[v,g,y]=[g,y,y+1],y>=p&&(y-=f)}while(y!==h+1)}return{regions:[i,...n],infos:l,vertices:s.vertices}}_insertVertex(e,t,r,i,n){let s=t*2,a=t*3;e.positions[a+0]=r.x,e.positions[a+1]=r.y,e.positions[a+2]=r.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=n.x,e.uvs[s+1]=n.y}_extrudeRegion(e,t,r,i,n,s,a){let o=new L,l=new L,c=new L,d=new L,u=new oe;r.forEach((f,p)=>{let m=i[p],g=e.verticesStart*r.length+e.verticesCount*p;for(let v=0;v<e.count;v++){let y=(e.start+v)*2;if(o.set(t[y+0],t[y+1],0),c.copy(o).applyMatrix4(f).add(m),e.continuous[v])d.set(e.normals[v*2+0],e.normals[v*2+1],0);else{let b=v===0?(e.start+e.count-1)*2:y-2;l.set(t[b+0],t[b+1],0),d.copy(o).sub(l),d.set(-d.y,d.x,0),e.isHole||d.negate()}if(d.applyMatrix4(f).normalize(),u.set(v===0?1:v/e.count,p/(r.length-1)),this._insertVertex(n,g,c,d,u),g++,!e.continuous[v]||v===0){if(v===0)d.set(e.normals[v*2+0],e.normals[v*2+1],0),u.set(0,p/(r.length-1));else{let b=v===e.count-1?e.start*2:y+2;l.set(t[b+0],t[b+1],0),d.copy(l).sub(o),d.set(-d.y,d.x,0),e.isHole||d.negate()}d.applyMatrix4(f).normalize(),this._insertVertex(n,g,c,d,u),g++}}});let h=r.length-1;for(let f=0;f<h;f++){let p=e.verticesStart*r.length+e.verticesCount*f,m=e.verticesStart*r.length+e.verticesCount*(f+1),g=0;for(let v=0;v<e.count;v++){(!e.continuous[v]||v===0)&&g++;let y=v===e.count-1?0:g+1,b=p+g,x=p+y,S=m+y,w=m+g;e.isHole?s.push(b,S,x,b,w,S):s.push(b,x,S,b,S,w),g++}}}_closeEnd(e,t,r,i,n,s,a){let o=e.vertexCount,l=new L(0,0,a?-1:1).applyMatrix4(n),c=new L,d=new oe;for(let h=0;h<o;h++){let f=2*h;c.set(e.vertices[f+0],e.vertices[f+1],0).applyMatrix4(n).add(s),this._insertVertex(i,t+h,c,l,d)}let u=e.elements;for(let h=0;h<e.elementCount;h++){let f=3*h,p=u[f+0]+t,m=u[f+(a?1:2)]+t,g=u[f+(a?2:1)]+t;r.push(p,m,g)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new on().getNormalMatrix(e).elements,s,a,o,l,c=this.attributes.position,d=this.attributes.normal;if(!c||!d)return;let u=c.array,h=d.array,f=c.itemSize;for(let p=t*f,m=r*f;p<m;p+=f){if(p===t)debugger;s=u[p+0],a=u[p+1],o=u[p+2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]),u[p+0]=(i[0]*s+i[4]*a+i[8]*o+i[12])*l,u[p+1]=(i[1]*s+i[5]*a+i[9]*o+i[13])*l,u[p+2]=(i[2]*s+i[6]*a+i[10]*o+i[14])*l,s=h[p+0],a=h[p+1],o=h[p+2],h[p+0]=n[0]*s+n[3]*a+n[6]*o,h[p+1]=n[1]*s+n[4]*a+n[7]*o,h[p+2]=n[2]*s+n[5]*a+n[8]*o}c.needsUpdate=!0,d.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),s=r.getX(i+1),a=r.getX(i+2);r.setXYZ(i,a,s,n)}r.needsUpdate=!0}}};function ioe(){let e=new Dt;return e.setAttribute("position",new Wt(new Float32Array([]),3)),e.setIndex(new Wt(new Uint16Array([]),1)),e}var Met=ioe().attributes,Pet=12,Iet=1,noe=class extends Dt{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Met),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r!=null&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:r,height:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=go.getDisplayedValue(o),d=l===2?c.toUpperCase():l===3?c.toLowerCase():c,u=Ret(e,t,d),{shapes:h,charWidths:f,charCoords:p}=t.generateShapes(u,e),m=(typeof r=="number"?r:1)*.5,g=(typeof i=="number"?i:1)*.5,v=h.map(x=>new Ki().fromShape(x,!0));this.vectorShapes=v;let y=v.map(x=>am.create({shape:x,parameters:{depth:n,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:n<=0?Jr.NONZERO:Jr.ODD,subdivisions:this.isLowResolution&&n>0?Iet:Pet}})),b=y.length?Yf(y):ioe();b.translate(-m,g,0),this.dispose(),this.wrappedText=u,this.charCoords=p,this.charWidths=f,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach(([x,S])=>{this.setAttribute(x,S)}),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let e=Jc(new Dt,noe.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:e})}get text(){return this.userData.parameters.text??""}};function Ret(e,t,r){let i=[""],n="";for(let s of r)n+=s,s===" "||s===`
`?(i[i.length-1]+=n,n="",s===`
`&&i.push("")):t.getTextWidth(i[i.length-1]+n,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+n,e)>e.width&&(n.length===1?(i[i.length-1]+=n,n=""):(i[i.length-1]+=n.slice(0,-1),n=n[n.length-1],i.push(""))));return i[i.length-1]+=n,i}var soe,aoe=new Promise(e=>{soe=e}),E9=!1,yS;function Det(){if(E9)return;if(yS)return yS;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@1.0.28/build",r=R0(()=>import("./process-0cd968c5.js"),[],import.meta.url),[i,n]=await Promise.all([r,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});soe(a),E9=!0}return yS=e(),yS}var Oet=["font"];function _x(e,t,r,i){var c;let n,s,a;e.type==="PathGeometry"?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s={...e},a=[[]]);for(let d of a){let u=s;for(let h of d)u=u[h];for(n in u){let h=u[n];MG(h)&&!Oet.includes(n)&&(u[n]=t.getVariable(h,[i.uuid,"geometry",...d,n]),MG(u[n])&&(u[n]=1))}}let o={parameters:s,type:s.type};if(s.type==="PathGeometry")o.path=s.path;else if(s.type==="VectorGeometry"){let d=Ki.createFromState(s.shape,s.width,s.height);o.shape=d}else if(s.type==="NonParametricGeometry")s.data.groups&&((c=s.data.groups)==null||c.forEach(d=>d.materialIndex=Math.max(d.materialIndex??0,0))),o.geometry=new ase().parse(s);else if(s.type==="SubdivGeometry"){let d=new pa(s,r);return d.data=e,d}else{if(s.type==="TextGeometry")return new noe(s,t);if(s.type==="UIGeometry")return bj.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}let l;try{l=P9(o)}catch(d){console.error(d)}if(!l){let d=Ki.createFromState(UA.defaultData(),100,100);o.shape=d,l=P9(o)}return l}var Let=new Ke;function UN(e,t,r,i){let n=e.position.array,s=e.normal.array,a=Let.makeScale(t,r,i).invert().elements,o,l,c;for(var d=0,u=n.length;d<u;d+=3)n[d]*=t,n[d+1]*=r,n[d+2]*=i,o=s[d],l=s[d+1],c=s[d+2],s[d]=a[0]*o+a[4]*l+a[8]*c,s[d+1]=a[1]*o+a[5]*l+a[9]*c,s[d+2]=a[2]*o+a[6]*l+a[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var bS=new un,Qm=new L,Ft;aoe.then(e=>{Ft=e});var C9=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),A9=new Uint32Array([0,1,2,3]),T9=new Uint8Array([4]),pa=class extends Dt{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=dp.div(t,r);this.subdividedGeometry&&UN(this.subdividedGeometry.attributes,...i),this.originalGeometry&&UN(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(Qm.fromArray(i));let s=Qm.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=pa.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Ql(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(pa.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Za,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;bS.setFromBufferAttribute(t),bS.getCenter(r),e.boundingSphere.radius=r.distanceTo(bS.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),bS.getSize(Qm);let i={width:Qm.x,height:Qm.y,depth:Qm.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,s,a,o=(e==null?void 0:e.phongAngle)??35;r===!1&&(o=-1),t&&(Ft.free_bvh(t),Ft.free_subdivision_surface(t));try{n=pa.allocate(e,i)}catch(l){console.error(l,e),n=pa.allocate({positionWASM:C9,indexWASM:A9,verticesPerFaceWASM:T9},i)}if(Ft.set_destination_refinement_level(n,0),s=pa.buildLevel(n,!0,o),e.subdivisions>0)try{Ft.set_destination_refinement_level(n,e.subdivisions),a=pa.buildLevel(n,!1,o)}catch{try{Ft.set_destination_refinement_level(n,e.subdivisions-1),a=pa.buildLevel(n,!1,o)}catch{a=null}}else a=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:_x(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let s,a,o,l;({positions:s,triIndices:l}=YM(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let d=e.radialSegments*e.heightSegments*3*2,u=d+e.radialSegments*3;c=[d,u]}return{indices:a,verticesPerFace:o}=ooe(s,l,i,c),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){var b;let r,i,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=C9,i=A9,n=T9);let o=r.length,l=i.length,c=n.length,d=r.length+s.length+a.length,u=i.length+n.length,h=d*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=d*Float32Array.BYTES_PER_ELEMENT,p=Ft._malloc(h),m=new Float32Array(Ft.HEAPF32.buffer,p,d),g=new Uint32Array(Ft.HEAPU32.buffer,p+f,u);m.set(r,0),m.set(s,r.length),m.set(a,r.length+s.length),g.set(i,0),g.set(n,i.length);let v;(b=e==null?void 0:e.scaleBaked)!=null&&b.some(x=>x!==1)&&(v=new Ke().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let y=v?Ft.alloc_subdivision_surface2(p,o,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c,v.elements):Ft.alloc_subdivision_surface(p,o,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ft._free(p),y}static buildLevel(e,t,r,i,n){let s=n?Ft.get_mesh_data2(e,t?Ft.Level.CONTROL:Ft.Level.REFINED,r,n.elements):Ft.get_mesh_data(e,t?Ft.Level.CONTROL:Ft.Level.REFINED,r),a=8,o=Ft.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,4+4),c=0,d=Ft.HEAPU32[o[c]>>2],u=Ft.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let h=Ft.HEAPU32[o[c]>>2],f=Ft.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let p=Ft.HEAPU32[o[c]>>2],m=Ft.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let g=Ft.HEAPU32[o[c]>>2],v=Ft.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,i===void 0){let y=new Dt;if(y.setIndex(new av(v,1)),y.setAttribute("position",new vt(u,3)),y.setAttribute("normal",new vt(f,3)),t){y.setAttribute("faceMap",new av(m,1));let b=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new Wt(b,4))}return Ft.free_mesh_data(s),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(u),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,Ft.free_mesh_data(s)}static freeSubdivPointer(e){Ft.free_bvh(e),Ft.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=Ft.get_wireframe_data_for_base_level(e),n=4,s=Ft.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(2,2+2),o=0,l=Ft.HEAPU32[s[o]>>2],c=Ft.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let d=Ft.HEAPU32[s[o]>>2],u=Ft.HEAPU32.subarray(d>>2,(d>>2)+a[o]);if(t===void 0){let h=new Dt;h.setAttribute("position",new vt(c,3));let f=new Float32Array(c.length);for(let p=0,m=c.length;p<m;)f[p++]=r.r,f[p++]=r.g,f[p++]=r.b;return h.setAttribute("color",new Wt(f,3)),h.setIndex(new av(u,1)),Ft.free_wireframe_data_for_base_level(i),h}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,Ft.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||Ft.set_destination_refinement_level(e,t);let n=r?Ft.get_topological_data2(e,i?Ft.Level.CONTROL:Ft.Level.REFINED,r.elements):Ft.get_topological_data(e,i?Ft.Level.CONTROL:Ft.Level.REFINED),s=6,a=Ft.HEAPU32.subarray(n>>2,(n>>2)+s),o=a.subarray(3,3+3),l=0,c=Ft.HEAPU32[a[l]>>2],d=new Float32Array(Ft.HEAPF32.subarray(c>>2,(c>>2)+o[l]));l++;let u=Ft.HEAPU32[a[l]>>2],h=new Uint32Array(Ft.HEAPU32.subarray(u>>2,(u>>2)+o[l]));l++;let f=Ft.HEAPU32[a[l]>>2],p=new Uint8Array(Ft.HEAPU32.subarray(f>>2,(f>>2)+o[l]));return Ft.free_topological_data(n),{positions:d,indices:h,verticesPerFace:p}}},M9=["getX","getY","getZ"];function YM(e,t){let r={},i=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let c=0;c<i;c++){let d=t?t.getX(c):c,u="";for(let h=0;h<3;h++)u+=`${~~(e[M9[h]](d)*o)},`;if(u in r)s.push(r[u]);else{for(let h=0;h<3;h++)a.push(e[M9[h]](d));r[u]=n,s.push(n),n++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:a,triIndices:l}}var xS=new L,tD=new L,rD=new L,iD=new L;function ooe(e,t,r,i){let n=[],s=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let h=l.length/2/c;l=l.filter((f,p)=>Math.floor(p/2)%h===0)}let d=0;for(let h=0;h<l.length;h+=2)d+=(l[h]-l[(h===0?l.length:h)-2])*(l[h+1]+l[(h===0?l.length:h)-1]);e.length=0;let u=0;if(d<0)for(let h=0;h<l.length;h+=2)e.push(l[h],l[h+1],0),n.push(u++);else for(let h=l.length-2;h>=0;h-=2)e.push(l[h],l[h+1],0),n.push(u++);return s.push(u),{indices:n,verticesPerFace:s}}let a=new Float32Array([r.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){xS.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),tD.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),rD.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),iD.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),tD.sub(xS).normalize(),rD.sub(xS).normalize(),iD.sub(xS).normalize();let l=tD.cross(rD).dot(iD);Math.abs(l)>.005||i&&i.some((c,d)=>d%2===1?!1:o>=i[d]&&o<i[d+1])?(n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(n.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],d=0;for(let u=0,h=0;u<e.length;u+=3,h++)e[u+2]===0&&(l.push(h),d++),e[u+2]===a&&c.push(h);if(r.userData.parameters.extrudeBevelSize===0){let u=c[0];c[0]=c[1],c[1]=u}l.reverse(),n.push(...l,...c),s.push(d,d)}return{indices:n,verticesPerFace:s}}var Au={};j4e(Au,{calcBoolean:()=>Fet,calcBooleanTopological:()=>Bet,freeMeshSet:()=>$et,getMeshSet:()=>jet,hasOpenEdges:()=>Vet,transformMeshSet:()=>Uet});var loe,Net=new Promise(e=>{loe=e}),wS;function ket(){if(wS)return wS;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@1.0.28/build",r=R0(()=>import("./boolean-613a7c9c.js"),[],import.meta.url),[i,n]=await Promise.all([r,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});loe(a)}return wS=e(),wS}var yr,mv;Net.then(e=>yr=e);function zet(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:s,triIndices:a}=YM(e.getAttribute("position"),n),o;if(t&&r){let{indices:l,verticesPerFace:c}=ooe(s,a,e);o=c.length,i=[];for(let d=0,u=0;d<o;d++){i.push(c[d]);for(let h=0;h<c[d];h++)i.push(l[u++])}}else{let l=a.length;i=Array(l+l/3),o=0;for(let c=0,d=0;d<i.length;)i[d++]=3,o++,i[d++]=a[c++],i[d++]=a[c++],i[d++]=a[c++]}return{positions:s,faceIndices:i,nFaces:o}}function coe(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,s=yr._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(yr.HEAPU32.buffer,s,t):new Float32Array(yr.HEAPF32.buffer,s,t)).set(e,0),s}function uoe(e){switch(e){case 0:return yr.OP.UNION;case 1:return yr.OP.INTERSECTION;case 2:return yr.OP.A_MINUS_B;case 3:return yr.OP.B_MINUS_A;case 4:return yr.OP.SYMMETRIC_DIFFERENCE;case 5:return yr.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function Bet(e,t){mv===void 0&&(mv=yr.init_csg());let r=coe(e),i=yr.csg_calc_topological(mv,r,e.length,uoe(t));yr._free(r);let n=6,s=yr.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,3+3),o=0,l=yr.HEAPU32[s[o]>>2],c=new Float32Array(yr.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let d=yr.HEAPU32[s[o]>>2],u=new Uint32Array(yr.HEAPU32.subarray(d>>2,(d>>2)+a[o]));o++;let h=yr.HEAPU32[s[o]>>2],f=new Uint8Array(yr.HEAPU32.subarray(h>>2,(h>>2)+a[o]));return yr.free_mesh_data(i),{positions:c,indices:u,verticesPerFace:f}}function Fet(e,t,r,i){mv===void 0&&(mv=yr.init_csg());let n=coe(e),s=yr.csg_calc(mv,n,e.length,i,uoe(t));yr._free(n);let a=5,o=yr.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,2+3),c=0,d=yr.HEAPU32[o[c]>>2],u=yr.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let h=yr.HEAPU32[o[c]>>2],f=yr.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let p=l[c];r.setAttribute("position",new vt(u,3)),r.setAttribute("normal",new vt(f,3));let m=yr.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new Za),r.boundingSphere.radius=-1,r.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},yr.free_mesh_data(s),p}function jet(e,t,r){if(yr===void 0)return-1;let i,n,s;if(t&&e.userData.positions!==void 0){let g=e.userData;s=g.verticesPerFace.length,i=g.positions,n=Array(g.verticesPerFace.reduce((v,y)=>v+y,0)+s);for(let v=0,y=0,b=0;v<g.verticesPerFace.length;v++){n[b++]=g.verticesPerFace[v];for(let x=0;x<g.verticesPerFace[v];x++)n[b++]=g.indices[y++]}}else({positions:i,faceIndices:n,nFaces:s}=zet(e,t,r));let a=i.length,o=n.length,l=i.length,c=n.length,d=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,h=yr._malloc(d),f=new Float32Array(yr.HEAPF32.buffer,h,l),p=new Uint32Array(yr.HEAPU32.buffer,h+u,c);f.set(i,0),p.set(n,0);let m=yr.get_csg_mesh(h,a,h+u,o,s);return yr._free(h),m}function Vet(e){return yr.has_open_edges(e)}function Uet(e,t){yr.transform_csg_mesh(e,t.elements)}function $et(e){yr.free_csg_mesh(e)}var Het={ConeGeometry:oJe,CubeGeometry:lJe,CylinderGeometry:zae,DodecahedronGeometry:uJe,EllipseGeometry:yj,HelixGeometry:UJe,IcosahedronGeometry:$Je,LatheGeometry:HJe,NonParametricGeometry:QJe,PolygonGeometry:eoe,PyramidGeometry:ZJe,RectangleGeometry:bj,SphereGeometry:tet,PlaneGeometry:ret,BackdropGeometry:iet,StarGeometry:toe,TextFrameGeometry:set,TorusGeometry:aet,TorusKnotGeometry:cet,TriangleGeometry:uet,PathGeometry:Aet,VectorGeometry:am},P9=e=>Het[e.type].create(e);function Zm(e){return e!==null&&"booleanOp"in e}var doe=class extends hj(An){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Ke}updateVisible(e){super.updateVisible(e),this.visible=!Zm(this.parent)&&this.visible,Zm(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Au.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Zm(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof doe&&(e.freeBooleanPointer(),Zm(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let r=super.updateTransformState(e,t);return r&&Zm(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(e=!1){super.onVariableUpdate(e),Zm(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},_S=new un;function xj(e,t=0,r=e.count,i,n){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,d=-1/0;for(let u=t;u<r;u++){let h=e.getX(u),f=e.getY(u),p=e.getZ(u);h<s&&(s=h),f<a&&(a=f),p<o&&(o=p),h>l&&(l=h),f>c&&(c=f),p>d&&(d=p)}_S.min.set(s,a,o),_S.max.set(l,c,d),_S.getCenter(i),_S.getSize(n).multiplyScalar(.5)}var Wet=new Dt,Get=new em,Ca=class extends doe{constructor(e,t){super(Wet,Get),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?xj(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},I9=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},rf=class{constructor(e){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=Et.generateUUID(),this.type=e,this.name=""}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,s){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}getHash(){let e="{",t,r;for(t in this)r=this[t],r instanceof rf&&(e+='"'+t+'":'+r.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)t=this.hashProperties[i],r=this[t],e+='"'+t+'":"'+String(r)+'",';return e+='"id":"'+this.uuid+'"}',e}},qet=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Va=new qet,si=class extends rf{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=Et.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let s=e.getNodeData(r),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return s.name=s.name||super.build(e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let o=this.getTemp(e,r);if(o)return e.format(o,a,t);{o=super.generate(e,t,r,s.output,i);let l=this.generate(e,a,r);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},Ja=class extends si{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}},ps=class extends Ja{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof oe?e:new oe(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},Vo=class extends Ja{constructor(e=0,t,r){super("v3"),this.nodeType="Vector3",this.value=e instanceof L?e:new L(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},Ps=class extends zt{constructor(t,r,i,n){super(t,r,i),this.isColorA=!0,this.a=n}setRGBA(t,r,i,n){super.setRGB(t,r,i),this.a=n}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(t){return super.equals(t)&&this.a===t.a}setStyle(t,r="srgb"){let i;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(i=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let n,s=i[1],a=i[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=s==="rgba"?parseFloat(n[4]):1,super.setStyle(t,r);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.a=s==="hsla"?parseFloat(n[4]):1,super.setStyle(t,r);break}}return super.setStyle(t,r)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Tu=class extends Ja{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof Ps?e:new Ps(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},Xet=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,R9=/[a-z_0-9]+/gi,ht=class extends si{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=R9.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let d=l[c],u=d[0],h=this.isMethod?!this.getInputByName(u):!0,f=u;if(this.keywords[u]||this.useKeywords&&h&&Va.containsKeyword(u)){let p=this.keywords[u];if(!p){let m=Va.getKeywordData(u);m.cache&&(p=e.keywords[u]),p=p||Va.getKeyword(u,e),m.cache&&(e.keywords[u]=p)}f=p.build(e)}u!==f&&o[d.index+a-1]!=="."&&(o=o.substring(0,d.index+a)+f+o.substring(d.index+u.length+a),a+=f.length-u.length),this.getIncludeByName(f)===void 0&&Va.contains(f)&&e.include(Va.get(f))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t??[],this.extensions=r??{},this.keywords=i??{},this.isMethod){let n=Xet.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(R9);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let c=s[a++];this.inputs.push({name:c,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Yet=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,hoe=class extends si{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||hoe.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let s,a,o="",l=Yet.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},Qr=hoe;Qr.PI="PI",Qr.PI2="PI2",Qr.RECIPROCAL_PI="RECIPROCAL_PI",Qr.RECIPROCAL_PI2="RECIPROCAL_PI2",Qr.LOG2="LOG2",Qr.EPSILON="EPSILON";var Ket=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Qet=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),foe=class extends si{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Ket.exec(e);if(t){let r=t[2],i;for(;i=Qet.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},wj=class extends si{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};Va.addKeyword("uv",function(){return new wj});Va.addKeyword("uv2",function(){return new wj(1)});var xg=class extends si{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??xg.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Kl:return["Linear"];case nr:return["sRGB"];default:return[]}}generate(e,t){var a;let r=this.input.build(e,"v4"),i=this.getType(e),n=xg.Nodes[this.method],s=e.include(n);if(s===xg.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((a=n.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+r+", "+o+" )",i,t)}else return e.format(s+"( "+r+" )",i,t)}fromEncoding(e){let t=xg.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=xg.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},Dc=xg;Dc.Nodes={LinearToLinear:new ht(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new ht(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new ht(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Dc.LINEAR_TO_LINEAR="LinearToLinear",Dc.SRGB_TO_LINEAR="sRGBToLinear",Dc.LINEAR_TO_SRGB="LinearTosRGB";var pi=class extends ht{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},Nu=class extends Ja{constructor(e=new Li,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new wj,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+r+", "+i+", "+n+" )":a=s+"( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new Dc(new pi("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},wt=class extends Ja{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},D9=class extends si{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],d=this.inputs[l]||this.inputs[c.name];o.push(d.build(e,e.getTypeByFormat(c.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},poe=class extends si{constructor(e,t,r=poe.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},ka=poe;ka.ADD="+",ka.SUB="-",ka.MUL="*",ka.DIV="/";var Kr=class extends si{constructor(e,t=Kr.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Kr.MIX:case Kr.CLAMP:case Kr.REFRACT:case Kr.SMOOTHSTEP:case Kr.FACEFORWARD:return 3;case Kr.MIN:case Kr.MAX:case Kr.MOD:case Kr.STEP:case Kr.REFLECT:case Kr.DISTANCE:case Kr.DOT:case Kr.CROSS:case Kr.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Kr.LENGTH:case Kr.DISTANCE:case Kr.DOT:return"f";case Kr.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Kr.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Kr.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Kr.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Kr.STEP:r=this.a.build(e,s===1?"f":l),i=this.b.build(e,l);break;case Kr.MIN:case Kr.MAX:case Kr.MOD:r=this.a.build(e,l),i=this.b.build(e,a===1?"f":l);break;case Kr.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Kr.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let d=[];d.push(r),i&&d.push(i),n&&d.push(n);let u=this.getNumInputs(e);if(d.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${d.length}.`);return e.format(this.method+"( "+d.join(", ")+" )",c,t)}},er=Kr;er.RAD="radians",er.DEG="degrees",er.EXP="exp",er.EXP2="exp2",er.LOG="log",er.LOG2="log2",er.SQRT="sqrt",er.INV_SQRT="inversesqrt",er.FLOOR="floor",er.CEIL="ceil",er.NORMALIZE="normalize",er.FRACT="fract",er.SATURATE="saturate",er.SIN="sin",er.COS="cos",er.TAN="tan",er.ASIN="asin",er.ACOS="acos",er.ARCTAN="atan",er.ABS="abs",er.SIGN="sign",er.LENGTH="length",er.NEGATE="negate",er.INVERT="invert",er.MIN="min",er.MAX="max",er.MOD="mod",er.STEP="step",er.REFLECT="reflect",er.DISTANCE="distance",er.DOT="dot",er.CROSS="cross",er.POW="pow",er.MIX="mix",er.CLAMP="clamp",er.REFRACT="refract",er.SMOOTHSTEP="smoothstep",er.FACEFORWARD="faceforward";var v1=class extends si{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new D9(v1.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new Dc(new pi("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Dc(new pi("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Dc(new pi("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Dc(new pi("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new pi(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new pi(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new pi(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new pi(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new pi("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new D9(v1.Nodes.roughnessToMip,[i]),s=new er(n,v1.Nodes.m0,v1.Nodes.cubeUV_maxMipLevel,er.CLAMP),a=new er(s,er.FLOOR),o=new er(s,er.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),c=this.bilinearCubeUV(e,this.value,r,new ka(a,new wt(1).setReadonly(!0),ka.ADD)),d=new er(l,c,o,er.MIX);return e.format(d.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},$N=v1;$N.Nodes=function(){let e=new foe(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Qr("float cubeUV_maxMipLevel 8.0",!0),r=new Qr("float cubeUV_minMipLevel 4.0",!0),i=new Qr("float cubeUV_maxTileSize 256.0",!0),n=new Qr("float cubeUV_minTileSize 16.0",!0),s=new ht(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new ht(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new ht(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,r,i,n]);o.useKeywords=!1;let l=new Qr("float r0 1.0",!0),c=new Qr("float v0 0.339",!0),d=new Qr("float m0 -2.0",!0),u=new Qr("float r1 0.8",!0),h=new Qr("float v1 0.276",!0),f=new Qr("float m1 -1.0",!0),p=new Qr("float r4 0.4",!0),m=new Qr("float v4 0.046",!0),g=new Qr("float m4 2.0",!0),v=new Qr("float r5 0.305",!0),y=new Qr("float v5 0.016",!0),b=new Qr("float m5 3.0",!0),x=new Qr("float r6 0.21",!0),S=new Qr("float v6 0.0038",!0),w=new Qr("float m6 4.0",!0),E=[l,c,d,u,h,f,p,m,g,v,y,b,x,S,w],C=new ht(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,E);return{bilinearCubeUV:o,roughnessToMip:C,m0:d,cubeUV_maxMipLevel:t}}();var wg=class extends si{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??wg.VIEW}getShared(){return this.scope===wg.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let s;switch(this.scope){case wg.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case wg.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case wg.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},Ha=wg;Ha.LOCAL="local",Ha.WORLD="world",Ha.VIEW="view",Ha.NORMAL="normal";Va.addKeyword("viewNormal",function(){return new Ha(Ha.VIEW)});Va.addKeyword("localNormal",function(){return new Ha(Ha.NORMAL)});Va.addKeyword("worldNormal",function(){return new Ha(Ha.WORLD)});var Su=class extends si{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Su.LOCAL}getType(){switch(this.scope){case Su.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Su.LOCAL:case Su.WORLD:return!1}return!0}generate(e,t,r,i,n){let s;switch(this.scope){case Su.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case Su.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case Su.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Su.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},Dl=Su;Dl.LOCAL="local",Dl.WORLD="world",Dl.VIEW="view",Dl.PROJECTION="projection";Va.addKeyword("position",function(){return new Dl});Va.addKeyword("worldPosition",function(){return new Dl(Dl.WORLD)});Va.addKeyword("viewPosition",function(){return new Dl(Dl.VIEW)});var gc=class extends si{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??gc.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case gc.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case gc.VECTOR:{let n=new Ha(Ha.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new Dl(Dl.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${o} ), ${a} )`;l&&(c=`normalize( mix( ${c}, ${a}, ${l} * ${l} ) )`);let d=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${d};`),i="reflectVec"):i=d;break}case gc.CUBE:{let n=new gc(gc.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case gc.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new gc(gc.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},gv=gc;gv.CUBE="cube",gv.SPHERE="sphere",gv.VECTOR="vector";var Zet=class extends si{constructor(e=new Nu,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new $N(this.value,t??new gv(gv.VECTOR),r),this.irradianceNode=new $N(this.value,new Ha(Ha.WORLD),new wt(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},Jet=class extends Ja{constructor(e=new S4,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new gv,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+r+", "+i+", "+n+" )":s="texCube( "+r+", "+i+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new Dc(new pi("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},ett=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,ttt=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,rtt=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,itt=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,ntt=`
layout(location = 1) out vec4 gVelocity;
`,stt=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,O9=["x","y","z","w"],att=["float","vec2","vec3","vec4"],ott={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},ltt={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},moe=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let s=0;s<i.length;s++)i[s].src&&(n+=i[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(ett),this.addFragmentParsCode(ttt),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(rtt),this.addFragmentFinalCode(itt)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",s=""){let a=this.getVars(i),o=a[e];if(!o){let l=a.length;o={name:r||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let s=e[i],a=s.type,o=s.name,l=s.size,c=this.getFormatByType(a);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+o+`[${l}];
`:r+=t+" "+c+" "+o+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof rf?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new I9({type:t,size:r.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new I9({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var s;let i;if(e=typeof e=="string"?Va.get(e):e,this.context.include===!1)return e.name;e instanceof ht?i=this.includes.functions:e instanceof Qr?i=this.includes.consts:e instanceof foe&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let a=n[e.name];if(a||(a=n[e.name]={node:e,deps:[]},n.push(a),a.src=e.build(this,"source")),e instanceof ht&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return r&&(a.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return att[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case Lp:case Np:return new Jet(r);case mw:return new Zet(new Nu(r));default:return new Nu(r)}else{if(r.isVector2)return new ps(r);if(r.isVector3)return new Vo(r);if(r.isVector4)return new Tu(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return ott[e]||e}getFormatByType(e){return ltt[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return O9[e]}getIndexByElement(e){return O9.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Kl,t===Kl&&this.context.gamma&&(t=nr),t}},Qi=class extends Ja{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof Ps?e:new Ps(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},li=class extends Ja{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}},ga=class extends Ja{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},Ef=class extends Ja{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},_j=class extends Ja{},ctt=class extends _j{constructor(e){super("v3"),this.image=e,this._value=new L}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},HN=class extends _j{constructor(e,t,r=1008){super("t"),this.image=e,this.wrap=t,this.minFilter=r}get value(){return this.image.getTexture(this.wrap,this.minFilter)}},goe=class extends Ja{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new on}generateReadonly(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},tu=class extends Ja{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new Ke}generateReadonly(e,t,r,i,n,s){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function L9(e,t,r){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0)}var utt=class extends goe{constructor(e,t){super(new on),this.repeat=e,this.offset=t,L9(this.value,e,t)}updateMatrix(){L9(this.value,this.repeat,this.offset)}},Cf=class extends Ja{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Yt?new Array(e).fill(t):new Array(e).fill(new Yt(0))}},N9=class extends si{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},voe=class extends si{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(voe.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},WN=voe;WN.Nodes=function(){return{customColor:new ht(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var yoe=class extends si{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(yoe.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},boe=yoe;boe.Nodes=function(){return{customNormal:new ht(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var y1=class extends si{constructor(e,t,r,i,n,s,a,o,l,c,d,u){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=u,this.alpha=c,this.mode=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(y1.Nodes.cylindrical);break;case 2:i=e.include(y1.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new ht(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(o);break;case 4:i=e.include(y1.Nodes.triplanar);break;default:i=e.include(y1.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let s=`${r}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(a),n.push(o),n.push(l),n.push(c)}else{let s=`${r}_writeUvs`;e.addFragmentVariable(s,"vec2"),n.push(s)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},Sj=y1;Sj.Nodes=function(){let e=new ht(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new ht(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new ht(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new ht(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var b1=class extends si{constructor(e,t,r,i,n,s,a,o,l,c,d,u){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=u,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new ht(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[b1.Nodes.vectorLinearWorldSpaceDepth,b1.Nodes.vectorLinearObjectSpaceDepth,b1.Nodes.vectorSphericalObjectSpaceDepth,b1.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},xoe=b1;xoe.Nodes=function(){let e=new ht(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new ht(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new ht(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new ht(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var dtt=class extends si{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new ht(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},woe=class extends si{constructor(e,t,r,i,n,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(woe.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},_oe=woe;_oe.Nodes=function(){return{gradient:new ht(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var Soe=class extends si{constructor(e,t,r,i){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(Soe.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Eoe=Soe;Eoe.Nodes=function(){return{matcap:new ht(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var Ej=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(Ej||{}),Ba=function(){let e=new ht(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new ht(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Qr("float F3 0.3333333"),t.keywords.G3=new Qr("float G3 0.1666667");let r=new ht(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new ht("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new ht("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new ht(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),a=new ht("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new ht("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[a]),l=new ht(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),c=new ht(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Qr("int NUM_OCTAVES 5");let d=new ht("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new ht(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,d]),h=new ht(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new ht(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),p=new ht(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new ht(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),g=new ht(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new ht(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new ht(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[h,f,p,m,g,v]);return{simplex:t,simplexFractal:r,simplexAshima:s,fbm:c,perlin:u,voronoi:y}}(),Coe=class extends si{constructor(e,t,r,i,n,s,a,o,l,c,d,u,h,f,p,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=f,this.highCut=p,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=h,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values(Ej)[this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new ht(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Ba.simplex,Ba.simplexFractal,Ba.simplexAshima,Ba.fbm,Ba.perlin,Ba.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};Coe.numOctaves=5;var Aoe=class extends si{constructor(e,t,r,i,n,s,a,o,l,c,d,u,h,f,p,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=d,this.resolution=u,this.normalMap=h,this.depthMap=f,this.pixelRatio=p,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${a};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(Aoe.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},Toe=Aoe;Toe.Nodes=function(){let e=new ht(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new ht(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Eu=class extends si{constructor(e,t,r,i,n,s,a,o,l,c,d,u,h,f,p,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=d,this.zigzag=u,this.rotation=h,this.vertical=f,this.horizontal=p,this.sides=m,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new ht(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new ht(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let d=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${d};
				float d1 = ${u};
				float d2 = ${h};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let d=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u="";this.axis.value===0?u=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?u=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,u=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let h="";switch(this.projection.value){case 0:h="custom_uv = vUv.st;";break;case 1:break;case 2:h=`
							vec3 p = position;
							${u}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${h}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${d};
				`}let o=new ht(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,Eu.DrawFunctions.circle,Eu.DrawFunctions.ring,Eu.DrawFunctions.polygon,Eu.DrawFunctions.cross,Eu.DrawFunctions.diamond,Eu.DrawFunctions.checkerboard,Eu.DrawFunctions.line,Eu.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},Moe=Eu;Moe.DrawFunctions=function(){let e=new ht(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new ht(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new ht(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new ht(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new ht(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new ht(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new ht(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new ht(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new ht(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new ht(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:s,diamond:a,checkerboard:o,line:l,wave:c}}();var Poe=class extends si{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(Poe.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Ioe=Poe;Ioe.Nodes=function(){let e=new ht(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Ba.simplex]);return{rainbow:new ht(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var Roe=class extends si{constructor(e,t,r,i,n,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(Roe.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Doe=Roe;Doe.Nodes=function(){let e=new ht(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new ht(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new ht(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new ht(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new ht(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new ht(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Ba.simplex,e,r,n])}}();var htt=function(){return{textureBicubic:new ht(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function ftt(e,t){return e>=t?new oe(t/e,1):new oe(1,e/t)}var Ooe=class extends si{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,jt.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(Ooe.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Loe=Ooe;Loe.Nodes=function(){let e=new ht(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new ht(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new ht(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new ht(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[htt.textureBicubic,r,e]),n=new ht(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new ht(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var GN=(e=>(e.NOISE="noise",e.MAP="map",e))(GN||{}),Noe=class extends si{constructor(e,t,r,i,n,s,a,o,l,c,d){super("v3"),this.displacementTypeIndex=new li(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(GN)[this.displacementTypeIndex.value]==="map"&&(this.mat=new goe(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=d,this.voronoiStyle=i,this.smoothness=n,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(GN)[this.displacementTypeIndex.value]){case"map":{r=e.include(Noe.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(Ej)[this.noiseFunctionIndex.value],s=new ht(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new ht(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[Ba.simplex,Ba.simplexFractal,Ba.simplexAshima,Ba.fbm,Ba.perlin,Ba.voronoi]),l=new ht(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},koe=Noe;koe.Nodes=function(){let e=new ht(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new ht(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new ht(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var jt={normalRenderTarget:new Nu,normalRenderTargetDepth:new Nu,transmissionRenderTarget:new Nu,aspectRatio:new ps,transmissionSize:new ps(2048,2048),transmissionRenderTargetDepth:new Nu,aoRenderTarget:new Nu,aoEnabled:new ga,pixelRatioNode:new wt(1),resolution:new ps,penumbraSize:new Ef(5,.5),frameIndex:new li(0),transmissionLod:new li(2)};for(let e of Object.values(jt))e.isRenderGlobal=!0;var zoe={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.0.28/build/ui.wasm"},Cj=class extends rf{constructor(){super("basic"),this.nodeType="Basic",this.color=new Qi(So),this.shadingAlpha=new wt(1),this.shadingBlend=new li(0),this.previousModelViewMatrix=new tu,this.previouseProjectionMatrix=new tu}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(L0.merge([ct.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new Qi(So)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",r.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${r.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),i?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${o} );`):a.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&a.push(`gl_FragColor.a *= ${n.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},ptt=class extends rf{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Qi(So),this.emissive=new Qi(0),this.emissiveIntensity=new wt(1),this.previousModelViewMatrix=new tu,this.previouseProjectionMatrix=new tu,this.shadingAlpha=new wt(1),this.shadingBlend=new li(0),this.occlusion=new ga(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(L0.merge([ct.fog,ct.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled}),this.color===void 0&&(this.color=new Qi(So)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];u.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&u.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),u.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${h}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push(`gl_FragColor.a *= ${d.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},a0=function(){let e=new ht(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new ht(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),mtt=class extends rf{constructor(){super("phong"),this.nodeType="Phong",this.color=new Qi(So),this.specular=new Qi(1118481),this.shininess=new wt(30),this.previousModelViewMatrix=new tu,this.previouseProjectionMatrix=new tu,this.shadingAlpha=new wt(1),this.shadingBlend=new li(0),this.occlusion=new ga(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(L0.merge([ct.fog,ct.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled}),this.color===void 0&&(this.color=new Qi(So)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(a0.dHdxy),e.include(a0.perturbNormalArb);let f=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${g}
					`)}u.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${h}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&u.push(`gl_FragColor.a *= ${d.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},gtt=class extends rf{constructor(){super("standard"),this.nodeType="Standard",this.color=new Qi(So),this.roughness=new wt(.3),this.metalness=new wt(0),this.reflectivity=new wt(.5),this.previousModelViewMatrix=new tu,this.previouseProjectionMatrix=new tu,this.shadingAlpha=new wt(1),this.shadingBlend=new li(0),this.occlusion=new ga(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(L0.merge([ct.fog,ct.lights])),ct.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new Qi(So)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,d=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=d!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(a0.dHdxy),e.include(a0.perturbNormalArb);let m=this.bumpMap.texture.flow(e,"t"),g=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};
					${y}
					`)}if(f.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(e,"t"),g=this.roughnessMap.flow(e,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else f.push(s.code,"	float roughnessFactor = "+s.result+";");d&&f.push(d.code,"#ifdef ALPHATEST","	if ( "+d.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?f.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let p="1.0";this.mask&&(this.mask.analyze(e),p=`luminance(${this.mask.flow(e,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${p} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${p}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&f.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),d?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${d.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&f.push(`gl_FragColor.a *= ${u.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=f.join(`
`)}return t}},vtt=class extends rf{constructor(){super("toon"),this.nodeType="Toon",this.color=new Qi(So),this.specular=new Qi(1118481),this.shininess=new wt(30),this.previousModelViewMatrix=new tu,this.previouseProjectionMatrix=new tu,this.shadingAlpha=new wt(1),this.shadingBlend=new li(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({resolution:jt.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(L0.merge([ct.fog,ct.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:jt.penumbraSize}),e.mergeUniform({frameIndex:jt.frameIndex}),e.mergeUniform({aoMap:jt.aoRenderTarget}),e.mergeUniform({aoEnabled:jt.aoEnabled}),this.color===void 0&&(this.color=new Qi(So)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(a0.dHdxy),e.include(a0.perturbNormalArb);let h=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),p=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${h.result}, uv0, ${p});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${h.result}, uv1, ${p});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${h.result}, uv2, ${p});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${h.result}, bumpMapCachedUv, ${p});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${m}
					`)}d.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&d.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${u}, ${a.result} );
				}
				`),o&&d.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&d.push(`gl_FragColor.a *= ${c.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},ytt=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},btt=class extends ytt{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},nD;function xtt(e){return typeof e=="string"?e:(nD||(nD=new btt),nD.load(e))}var wtt=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},_tt=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},Boe=class extends wtt{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isCanvas=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isCanvas=e.nodeName==="CANVAS",this.updateSrc(this.isCanvas?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let i of Object.values(this._cache))for(let n of Object.values(i))n&&(n.image=this.img,n.needsUpdate=!0);this.shared.requestRender()};if(this.isCanvas)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=s=>{var a;i=(a=s.target)==null?void 0:a.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=xtt(e),this.img.onload=t}getTexture(e,t=1008){let r=this._cache[e][t];if(r)return r;{let i;return this.isCanvas&&(i=new hHe(this.img,void 0,e,e,void 0,t)),this.isVideo?i=new dHe(this.img,void 0,e,e):i=new Li(this.img,void 0,e,e,void 0,t),this.loaded&&(i.needsUpdate=!0),this._cache[e][t]=i,i}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let r of Object.values(t))r&&(r.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[r,i]of Object.entries(t))i==null||i.dispose(),this._cache[e][r]=void 0}dispose(){super.dispose(),this.disposeTextures()}},Jd=class extends Boe{};function Stt(e,t){var r=Ttt(t);return r.formatToParts?Ctt(r,e):Att(r,e)}var Ett={year:0,month:1,day:2,hour:3,minute:4,second:5};function Ctt(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var s=Ett[r[n].type];s>=0&&(i[s]=parseInt(r[n].value,10))}return i}catch(a){if(a instanceof RangeError)return[NaN];throw a}}function Att(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var sD={};function Ttt(e){if(!sD[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";sD[e]=r?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return sD[e]}function Foe(e,t,r,i,n,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,r),o.setUTCHours(i,n,s,a),o}var k9=36e5,Mtt=6e4,aD={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function joe(e,t,r){var i,n;if(!e||(i=aD.timezoneZ.exec(e),i))return 0;var s;if(i=aD.timezoneHH.exec(e),i)return s=parseInt(i[1],10),z9(s)?-(s*k9):NaN;if(i=aD.timezoneHHMM.exec(e),i){s=parseInt(i[1],10);var a=parseInt(i[2],10);return z9(s,a)?(n=Math.abs(s)*k9+a*Mtt,s>0?-n:n):NaN}if(Rtt(e)){t=new Date(t||Date.now());var o=r?t:Ptt(t),l=qN(o,e),c=r?l:Itt(t,l,e);return-c}return NaN}function Ptt(e){return Foe(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function qN(e,t){var r=Stt(e,t),i=Foe(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),s=n%1e3;return n-=s>=0?s:1e3+s,i-n}function Itt(e,t,r){var i=e.getTime(),n=i-t,s=qN(new Date(n),r);if(t===s)return t;n-=s-t;var a=qN(new Date(n),r);return s===a?s:Math.max(s,a)}function z9(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var B9={};function Rtt(e){if(B9[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),B9[e]=!0,!0}catch{return!1}}var Dtt=Pn(W4e(),1),F9=Pn(G4e(),1),Ott=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,Ltt=Ott,oD=36e5,j9=6e4,Ntt=2,va={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Ltt};function ktt(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r=t||{},i=r.additionalDigits==null?Ntt:(0,Dtt.default)(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=ztt(e),s=Btt(n.date,i),a=s.year,o=s.restDateString,l=Ftt(o,a);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),d=0,u;if(n.time&&(d=jtt(n.time),isNaN(d)))return new Date(NaN);if(n.timeZone||r.timeZone){if(u=joe(n.timeZone||r.timeZone,new Date(c+d)),isNaN(u))return new Date(NaN)}else u=(0,F9.default)(new Date(c+d)),u=(0,F9.default)(new Date(c+d+u));return new Date(c+d+u)}else return new Date(NaN)}function ztt(e){var t={},r=va.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=va.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=va.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function Btt(e,t){var r=va.YYY[t],i=va.YYYYY[t],n;if(n=va.YYYY.exec(e)||i.exec(e),n){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=va.YY.exec(e)||r.exec(e),n){var a=n[1];return{year:parseInt(a,10)*100,restDateString:e.slice(a.length)}}return{year:null}}function Ftt(e,t){if(t===null)return null;var r,i,n,s;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=va.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,U9(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=va.DDD.exec(e),r){i=new Date(0);var a=parseInt(r[1],10);return $tt(t,a)?(i.setUTCFullYear(t,0,a),i):new Date(NaN)}if(r=va.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var o=parseInt(r[2],10);return U9(t,n,o)?(i.setUTCFullYear(t,n,o),i):new Date(NaN)}if(r=va.Www.exec(e),r)return s=parseInt(r[1],10)-1,$9(t,s)?V9(t,s):new Date(NaN);if(r=va.WwwD.exec(e),r){s=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return $9(t,s,l)?V9(t,s,l):new Date(NaN)}return null}function jtt(e){var t,r,i;if(t=va.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),lD(r)?r%24*oD:NaN;if(t=va.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),lD(r,i)?r%24*oD+i*j9:NaN;if(t=va.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return lD(r,i,n)?r%24*oD+i*j9+n*1e3:NaN}return null}function V9(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,s=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+s),i}var Vtt=[31,28,31,30,31,30,31,31,30,31,30,31],Utt=[31,29,31,30,31,30,31,31,30,31,30,31];function Voe(e){return e%400===0||e%4===0&&e%100!==0}function U9(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=Voe(e);if(i&&r>Utt[t]||!i&&r>Vtt[t])return!1}return!0}function $tt(e,t){if(t<1)return!1;var r=Voe(e);return!(r&&t>366||!r&&t>365)}function $9(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function lD(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}function Htt(e,t,r){var i=ktt(e,r),n=joe(t,i,!0),s=new Date(i.getTime()-n),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}function ba(e,t){return t.color(e)}function H9(e=new Date,t){let r=t.format,i=e.getSeconds(),n=e;t&&t.timeZone!==null&&(n=Htt(new Date,t.timeZone));let s=n.getHours(),a=n.getMinutes(),o;t.format12h24h==="12ampm"&&(o=s>=12?"PM":"AM");let l=s;t.format12h24h!=="24"&&(l=s%12,l===0&&(l=12));let c,d;switch(r){case"HH:mm:ss":c=[l,a,i];break;case"HH:mm":c=[l,a];break;case"HH":c=[l],o=void 0;break;case"mm":c=[a],o=void 0;break;case"ss":c=[i],o=void 0;break;case"year":d=n.getFullYear();break;case"month":d=n.getMonth()+1;break;case"dayOfYear":d=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":d=n.getDate();break;case"secondOfDay":d=s*60*60+a*60+i;break;default:console.error("Unknown time format",r),d=0;break}return c!==void 0?{textValue:c,suffix:o}:d}function Wtt(e,t){switch(e.type){case"fresnel":return Xtt(e,t);case"gradient":return Ytt(e,t);case"depth":return Ktt(e,t);case"normal":return Qtt(e,t);case"noise":return Ztt(e,t);case"rainbow":return Jtt(e,t);case"toon":return ert(e,t);case"outline":return trt(e,t);case"transmission":return rrt(e,t);case"color":return qtt(e,t);case"pattern":return irt(e,t)}}function Gtt(e){return{type:e.type}}function tc(e,t){let{alpha:r,mode:i,isMask:n}=e,s=typeof r=="string"?(Number(t.getVariable(r))??100)/100:r;return{...Gtt(e),alpha:s,mode:i,isMask:n}}function qtt(e,t){return{...tc(e,t),color:ba(e.color,t)}}function Xtt(e,t){let{bias:r,scale:i,intensity:n,factor:s,color:a}=e;return{...tc(e,t),color:ba(a,t),bias:r,scale:i,intensity:n,factor:s}}function Ytt(e,t){let{gradientType:r,smooth:i,colors:n,steps:s,angle:a,offset:o,morph:l}=e;return{...tc(e,t),gradientType:r,smooth:i,colors:n.map(c=>new Yt(c[0],c[1],c[2],c[3])),num:n.length,steps:s,offset:new oe(...o),morph:new oe(...l),angle:a}}function Ktt(e,t){let{gradientType:r,near:i,far:n,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:c,steps:d,smooth:u}=e;return{...tc(e,t),gradientType:r,near:i,far:n,isVector:s,isWorldSpace:a,origin:new L(...o),direction:l?new L(...l):new L(1,0,0),colors:c.map(h=>h!==void 0?new Yt(h[0],h[1],h[2],h[3]):new Yt(0,0,0,0)),steps:d.slice(0,c.length),smooth:u}}function Qtt(e,t){let{cnormal:r}=e;return{...tc(e,t),cnormal:new L(r[0],r[1],r[2])}}function Ztt(e,t){return{...tc(e,t),scale:e.scale,move:e.move,fA:new oe(...e.fA),fB:new oe(...e.fB),size:new L(...e.size),distortion:new oe(...e.distortion),colorA:ba(e.colorA,t),colorB:ba(e.colorB,t),colorC:ba(e.colorC,t),colorD:ba(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function Jtt(e,t){return{...tc(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new L(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new L(...e.offset)}}function ert(e,t){return{...tc(e,t),positioning:e.positioning,colors:e.colors.map(r=>new Yt(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new L(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:ba(e.shadowColor,t),offset:new L(...e.offset)}}function trt(e,t){return{...tc(e,t),outlineColor:ba(e.outlineColor,t),contourColor:ba(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new L(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function rrt(e,t){return{...tc(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function irt(e,t){return{...tc(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new oe(...e.offset),colorA:ba(e.colorA,t),colorB:ba(e.colorB,t),frequency:new oe(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new oe(...e.vertical),horizontal:new oe(...e.horizontal),sides:e.sides}}var sT=class extends Ps{},Uoe={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},$oe={depth:["colors"]};function nrt(e,t,r){var s,a;if(t==="isMask")return!0;let i=Uoe[e.type],n=$oe[e.type];if(n!==void 0){let o=e.color;if(n.includes(t)){let l=(a=(s=o[t])==null?void 0:s.value)==null?void 0:a.length;if(l!==void 0&&l!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function Hoe(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=i;l.image instanceof Jd||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=i;l.image instanceof Jd||l.image.deref(),l.image=o}if("wrapping"in s){let a=i;a.wrap=s.wrapping}if("minFilter"in s){let a=i;a.minFilter=s.minFilter}if("repeat"in s||"offset"in s){let a="mat",o=r.uniforms[`f${r.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),o.updateMatrix()}return n}function srt(e,t,r,i){let n=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||a===void 0)continue;if(Goe(s,r,i,t)){s==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let o=r.uniforms[`f${r.id}_${s}`];if(o&&!(o instanceof _j))switch(n=n||nrt(r,s,a),o.constructor){case Qi:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof sT?o.value=new Ps(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case Tu:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof sT?o.value=new Ps(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case ps:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case Vo:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case Nu:{Hoe(a,t,r);break}case Cf:{o.value=a.map(l=>new Yt(...l));break}default:{o.value=a;break}}}return n}var Vp=(e,t,r)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,r)??100)/100))??1,pp=class{constructor(e,t,r,i,n){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let s in i)this.uniforms[`f${this.id}_${s}`]=i[s];for(let s in r)Goe(s,this,r,n)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return bc.createLigherLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.canvas(r.texture.image)??i.image(r.texture.image):i.video(r.texture.video),s=new HN(n,r.texture.wrapping,r.texture.minFilter??1008),a=new ctt(n),o=new utt(r.texture.repeat,r.texture.offset),l=new wt(r.crop?1:0),c=new li(r.projection??0),d=new li(["x","y","z"].indexOf(r.axis)??0),u=new li(r.side??0),h=new ps(r.size?new oe(r.size[0],r.size[1]):new oe(100,100)),f=new wt(r.blending??0),p=new wt(Vp(r.alpha,i)),m=new li(r.mode??0),g=new ga(r.isMask??!1),v=new Sj(s,a,l,c,d,u,h,f,o,p,m,g),y=new pi(v.calpha,"f");return new qi(e,t,r,{texture:s,textureSize:a,crop:l,projection:c,axis:d,side:u,size:h,blending:f,mat:o,alpha:p,mode:m,isMask:g},v,m,y,g,i)}else if(r.type==="matcap"){let n=i.image(r.texture.image),s=new HN(n,r.texture.wrapping,r.texture.minFilter??1008),a=new wt(Vp(r.alpha,i)),o=new li(r.mode??0),l=new ga(r.isMask??!1),c=new Eoe(s,a,o,l),d=new pi(c.calpha,"f");return new qi(e,t,r,{texture:s,alpha:a,mode:o,isMask:l},c,o,d,l,i)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new Vo(new L(...r.offset)),s=new wt(r.scale??10),a=new wt(r.intensity??8),o=new wt(r.movement??1),l=new li(r.noiseType??0),c=new li(r.voronoiStyle??0),d=new wt(r.smoothness??.5),u=new wt(r.seed??0),h=new wt(r.highCut??1),f=new wt(r.lowCut??0),p=new li(r.quality??1),m=new koe(a,o,n,c,d,u,h,f,p,s,l);return new Woe(e,t,r,{offset:n,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:d,seed:u,highCut:h,lowCut:f,quality:p},m,i)}else throw new Error;else return lrt(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):srt(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?Hoe(i.props,r.shared,this):!0;return!1}dispose(){if(art(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof Jd||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},qi=class extends pp{constructor(t,r,i,n,s,a,o,l,c){super(t,r,i,n,c),this.params=n,this.color=s,this.mode=a,this.alpha=o,this.isMask=l}},Woe=class extends pp{constructor(e,t,r,i,n,s){super(e,t,r,i,s),this.position=n}},bc=class extends pp{constructor(e,t,r,i,n,s){super(e,t,r,n,s),this.node=i}static createLigherLayer(e,t,r,i){let n,s=new wt(Vp(r.alpha,i)),a=new li(r.mode),o=new wt(r.bumpMapIntensity),l=new wt(Vp(r.alphaOverride,i)),c;if(!r.visible)n=new Cj,c={};else if(r.category==="lambert"){n=new ptt;let d=new Qi(i.color(r.emissive)??0),u=new ga(r.occlusion??!0);c={emissive:d,occlusion:u},n.emissive=d,n.occlusion=u}else if(r.category==="toon"){n=new vtt;let d=new wt(r.shininess??30),u=new Qi(i.color(r.specular)??1118481);c={shininess:d,specular:u},n.shininess=d,n.specular=u}else if(r.category==="physical"){n=new gtt;let d=new wt(r.roughness??.3),u=new wt(r.metalness??0),h=new wt(r.reflectivity??.5),f=new ga(r.occlusion??!0);c={roughness:d,metalness:u,reflectivity:h,occlusion:f},n.roughness=d,n.metalness=u,n.reflectivity=h,n.occlusion=f}else{n=new mtt;let d=new wt(r.shininess??30),u=new Qi(r.specular!==void 0?i.color(r.specular)??1118481:1118481),h=new ga(r.occlusion??!0);c={shininess:d,specular:u,occlusion:h},n.shininess=d,n.specular=u,n.occlusion=h}return n.alpha=new wt(1),n.shadingAlpha=s,n.shadingBlend=a,n.bumpMapIntensity=o,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new bc(e,t,r,n,c,i)}get category(){return this.node.category}};function art(e){let t=e instanceof pp?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function ko(e){return{alpha:new wt(e.alpha??1),mode:new li(e.mode??0),isMask:new ga(e.isMask??!1)}}function ort(e,t,r,i,n){switch(e.type){case"color":{let s=new Qi(i.color??So),a=ko(i),o=new WN(s,a.alpha),l=new pi(o.calpha,"f");return new qi(t,r,e,{color:s,...a},o,a.mode,l,a.isMask,n)}case"fresnel":{let s=new Qi(i.color??16777215),a=new wt(i.bias??.1),o=new wt(i.scale??1),l=new wt(i.intensity??2),c=new wt(i.factor??1),d=ko(i),u=new dtt(s,a,o,l,c,d.alpha,d.mode,d.isMask),h=new pi(u.calpha,"f");return new qi(t,r,e,{color:s,bias:a,scale:o,intensity:l,factor:c,...d},u,d.mode,h,d.isMask,n)}case"rainbow":{let s=new wt(i.filmThickness??30),a=new wt(i.movement??0),o=new Vo(i.wavelengths??new L(0,0,0)),l=new wt(i.noiseStrength??0),c=new wt(i.noiseScale??1),d=new Vo(i.offset??new L(0,0,0)),u=ko(i),h=new Ioe(s,a,o,l,c,d,u.alpha,u.isMask),f=new pi(h.calpha,"f");return new qi(t,r,e,{filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:c,offset:d,...u},h,u.mode,f,u.isMask,n)}case"transmission":{let s=new wt(i.thickness??10),a=new wt(i.ior??1.5),o=new wt(i.roughness??.5),l=jt.transmissionSize,c=jt.transmissionRenderTarget,d=jt.transmissionRenderTargetDepth,u=window.innerWidth,h=window.innerHeight,f=u>=h?new ps(h/u,1):new ps(1,u/h),p=ko(i),m=new Loe(s,a,o,l,c,d,f,p.alpha),g=new pi(m.calpha,"f");return new qi(t,r,e,{thickness:s,ior:a,roughness:o,aspectRatio:f,...p},m,p.mode,g,p.isMask,n)}case"toon":{let s=new li(i.positioning??0),a;i.colors?a=new Cf(i.colors.length,i.colors):(a=new Cf(10,new Yt(0,0,0,1)),a.value[1]=new Yt(1,1,1,1));let o;i.steps?o=new Ef(i.steps.length,i.steps):(o=new Ef(10,1),o.value[0]=0);let l=new Vo(i.source??new L(0,0,0)),c=new ga(i.isWorldSpace??!0),d=new wt(i.noiseStrength??0),u=new wt(i.noiseScale??1),h=new Tu(i.shadowColor),f=new Vo(i.offset??new L(0,0,0)),p=ko(i),m=new Doe(s,a,o,l,c,d,u,h,f,p.alpha),g=new pi(m.calpha,"f");return new qi(t,r,e,{positioning:s,colors:a,steps:o,source:l,isWorldSpace:c,noiseStrength:d,noiseScale:u,shadowColor:h,offset:f,...p},m,p.mode,g,p.isMask,n)}case"outline":{let s=new Qi(i.outlineColor??16777215),a=new Qi(i.contourColor??16777215),o=new wt(i.outlineWidth??.1),l=new wt(i.contourWidth??.1),c=new wt(i.outlineThreshold??.1),d=new wt(i.contourThreshold??.1),u=new wt(i.outlineSmoothing??.1),h=new wt(i.contourFrequency??.1),f=new Vo(i.contourDirection??new L(0,1,0)),p=new ga(i.positionalLines??!1),m=new ga(i.compensation??!0),g=jt.normalRenderTarget,v=jt.normalRenderTargetDepth,y=jt.pixelRatioNode,b=jt.resolution,x=ko(i),S=new Toe(s,a,o,l,c,d,u,h,f,p,m,b,g,v,y,x.alpha),w=new pi(S.calpha,"f");return new qi(t,r,e,{outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:c,contourThreshold:d,outlineSmoothing:u,contourFrequency:h,contourDirection:f,positionalLines:p,compensation:m,...x},S,x.mode,w,x.isMask,n)}case"depth":{let s=new li(i.gradientType??0),a=new ga(i.smooth??!1),o=new wt(i.near??50),l=new wt(i.far??200),c=new wt(i.isVector??1),d=new wt(i.isWorldSpace??0),u=new Vo(i.origin??new L),h=new Vo(i.direction??new L),f;i.colors?f=new Cf(i.colors.length,i.colors):(f=new Cf(2,new Yt(0,0,0,1)),f.value[1]=new Yt(1,1,1,1));let p;i.steps?p=new Ef(i.steps.length,i.steps):(p=new Ef(2,1),p.value[0]=0);let m=ko(i),g=new xoe(s,a,o,l,c,d,u,h,f,p,m.alpha,m.isMask),v=new pi(g.calpha,"f");return new qi(t,r,e,{gradientType:s,smooth:a,near:o,far:l,isVector:c,isWorldSpace:d,origin:u,direction:h,colors:f,steps:p,...m},g,m.mode,v,m.isMask,n)}case"noise":{let s=new wt(i.scale??1),a=new Vo(i.size??new L(100,100,100)),o=new wt(i.move??1),l=new ps(i.fA??new oe(1.7,9.2)),c=new ps(i.fB??new oe(8.3,2.8)),d=new ps(i.distortion??new oe(1,1)),u=new Tu(i.colorA),h=new Tu(i.colorB),f=new Tu(i.colorC),p=new Tu(i.colorD),m=new li(i.noiseType??0),g=new li(i.voronoiStyle??0),v=new wt(i.highCut??1),y=new wt(i.lowCut??0),b=new wt(i.smoothness??.5),x=new wt(i.seed??.5),S=new li(i.quality??1),w=ko(i),E=new Coe(s,a,o,l,c,d,u,h,f,p,w.alpha,m,w.isMask,g,v,y,b,x,S),C=new pi(E.calpha,"f");return new qi(t,r,e,{scale:s,size:a,move:o,fA:l,fB:c,distortion:d,colorA:u,colorB:h,colorC:f,colorD:p,noiseType:m,...w,voronoiStyle:g,highCut:v,lowCut:y,smoothness:b,seed:x,quality:S},E,w.mode,C,w.isMask,n)}case"normal":{let s=new Vo(i.cnormal??new L(1,1,1)),a=ko(i),o=new boe(s,a.alpha),l=new pi(o.calpha,"f");return new qi(t,r,e,{cnormal:s,...a},o,a.mode,l,a.isMask,n)}case"gradient":{let s=new li(i.gradientType??0),a=new ga(i.smooth??!1),o;i.colors?o=new Cf(i.colors.length,i.colors):(o=new Cf(10,new Yt(0,0,0,1)),o.value[1]=new Yt(1,1,1,1));let l;i.steps?l=new Ef(i.steps.length,i.steps):(l=new Ef(10,1),l.value[0]=0);let c=new ps(i.offset??new oe(0,0)),d=new ps(i.morph??new oe(0,0)),u=new wt(i.angle??0),h=ko(i),f=new _oe(s,a,o,l,c,d,u,h.alpha,h.isMask),p=new pi(f.calpha,"f");return new qi(t,r,e,{gradientType:s,smooth:a,colors:o,steps:l,offset:c,morph:d,angle:u,...h},f,h.mode,p,h.isMask,n)}case"pattern":{let s=new li(i.style??0),a=new li(i.projection??0),o=new li(["x","y","z"].indexOf(i.axis)??0),l=new wt(i.blending??0),c=new ps(i.offset??new oe(0,0)),d=new Tu(i.colorA),u=new Tu(i.colorB),h=new ps(i.frequency??new oe(10,10)),f=new wt(i.size??.5),p=new wt(i.variation??0),m=new wt(i.smoothness??.5),g=new wt(i.zigzag??0),v=new wt(i.rotation??0),y=new ps(i.vertical??new oe(0,1)),b=new ps(i.horizontal??new oe(0,1)),x=new li(i.sides??6),S=ko(i),w=new Moe(s,a,o,l,c,d,u,h,f,p,m,g,v,y,b,x,S.alpha,S.isMask),E=new pi(w.calpha,"f");return new qi(t,r,e,{style:s,projection:a,axis:o,blending:l,offset:c,colorA:d,colorB:u,frequency:h,size:f,variation:p,smoothness:m,zigzag:g,rotation:v,vertical:y,horizontal:b,sides:x,...S},w,S.mode,E,S.isMask,n)}default:{let s=new Qi(1,0,0,1),a=ko(i),o=new WN(s,a.alpha),l=new pi(o.calpha,"f");return new qi(t,r,e,{color:s,...a},o,a.mode,l,a.isMask,n)}}}function lrt(e,t,r,i){let n=Wtt(r,i);return ort(r,e,t,n,i)}function Goe(e,t,r,i){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=r.intensity*(r.visible?1:0),n):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=Vp(r.alpha,i)*(r.visible?1:0),r.type==="outline"&&e==="visible"){let s=t.uniforms[`f${t.id}_compensation`];s&&(s.value=r.compensation&&r.visible)}return n}}function Wg(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i){let n=i.data,s=Number(t.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?s/100:n.alphaOverride)<1)return!0}for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(typeof s=="string"&&(s=Math.max(0,Math.min(1,Number(t.getVariable(s)??100)/100))),s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let a of n.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&n.data.type==="noise"){let a=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,d=Math.min(a,Math.min(o,Math.min(l,c)));d<1&&(s=d)}r+=(1-r)*s}}return r<1}var $h=class extends Gr{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},crt=class extends $h{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r){return this.root.getFlavor(e,t,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Aj=class extends $h{constructor(e,t,r=!0){super(),this.data=e,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(e,t)}get nodeMaterial(){return this}getFlavor(e,t,r){let i=r?6:(e?3:0)+t;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let n=this.flavors[i];return n===void 0&&(n=new crt(e,t,r,this),this.flavors[i]=n,n.flatShading=e,n.side=t,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t,r=!1){(this.data!==e||r)&&this.reset0(e,t)}reset0(e,t){this.data=e;let r=e.layers??Zs.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>pp.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=Wg(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,r){if(e[0]==="alphaOverride")this.transparent=Wg(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let i=e[1],n=e[2];if(i&&n){let s=this.layers.find(a=>a.uuid===i);s!=null&&s.hasValue(n)&&(n==="alpha"?(this.transparent=Wg(this.data,r.shared),s.setValue(n,Math.max(0,Math.min(Number(t)/100,1)))):s.setValue(n,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(r=>r.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(r=>{"alpha"in r.data&&typeof r.data.alpha=="string"&&e.shared.getVariable(r.data.alpha,["material",this.uuid,"layer",r.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(t=>t instanceof bc),this.lightLayer===void 0&&(this.lightLayer=new bc(0,"",{...Qn.defaultData("light","phong"),visible:!1},new Cj,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let e=this.layers.find(n=>n instanceof bc);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof qi&&s.color instanceof Sj&&(s.uuid===r&&(e.node.bumpMap=s.color),s.uuid===i&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,r){if(t!==void 0?this.data=t:t=this.data,this.transparent=Wg(t,r.shared),e.path[0]==="layers"){this.data=t;let i=r.shared,n=e.path[1];if(n===void 0){if(this.layers.reverse(),e.type===4){let s=pp.create(this.layerIdGen++,e.id,e.data,r.shared);this.layers.splice(e.localIndex,0,s),r.scene.markNeedsUpdateRendererDirty()}else if(e.type===5)this.layers.splice(e.localIndex,1)[0].dispose(),r.scene.markNeedsUpdateRendererDirty();else if(e.type===6){let s=this.layers.findIndex(o=>o.uuid===e.id),a=this.layers[s];this.layers.splice(s,1),this.layers.splice(e.localIndex,0,a),r.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate(r.shared)}else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===n);if(s){let a=t.layers.data(n),o;if(e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?o={...e.props,alpha:Vp(e.props.alpha,i,["material",this.uuid,"layer",n,"alpha"])}:o={...e.props,alphaOverride:Vp(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...e,...o?{props:o}:{},path:e.path.slice(2)},a,r)){let l=pp.create(this.layerIdGen++,n,a,i);this.layers.splice(this.layers.findIndex(c=>c.uuid===n),1,l),this.onUpdate(r.shared)}}}}else this.reset(t,r)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof qi?t.color.mask=void 0:t instanceof bc&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof qi&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof bc?i.node.mask=new ka(t.color,t.alpha,ka.MUL):i instanceof qi&&(i.isMask.value||(i.color.mask=new ka(t.color,t.alpha,ka.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof qi),t=this.layers.findIndex(r=>r instanceof bc);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof qi){if(n.isMask.value)continue;r=new N9(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new pi("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof bc);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof qi){if(i.isMask.value)continue;e=new N9(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof Woe);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new ka(t,e[r].position,ka.ADD),t=new ka(t,new wt(.5).setReadonly(!0),ka.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,s)=>Math.min(Math.max(i,n),s);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}computeCacheKey(){let e="[";for(let{data:t}of this.data.layers)if(t.type==="light")e+=`"${t.visible?t.category.toUpperCase():"Basic"}"`;else{let r=(Uoe[t.type]??[]).map(o=>t[o]),i=($oe[t.type]??[]).map(o=>{var l;return((l=t[o])==null?void 0:l.length)??0}),n=[...r,...i],s="isMask"in t&&t.isMask,a=`"${t.type}-${t.visible}-${s}"`;n.length?e+=`[${a}, "${n.join('","')}"],`:e+=a}return e=e.slice(0,-1)+"]",e}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new moe;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof qi){let t=e.params.texture;if(t instanceof HN&&!t.image.loaded)return!1}return!0}getHash(){let e="{";return e+='"fragment":'+this.fragment.getHash(),e+="}",e}};Object.defineProperties($h.prototype,{properties:{get:function(){return this.fragment.properties}}});var XN=class extends Aj{constructor(e,t,r){super(e,t,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},urt=Pn(q4e()),W9=new Map;function drt(e){if(typeof e=="string")return e;let t=W9.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},W9.set(e,t)),t.url}var x1=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:drt(e),format:"wav"},this.sound=new urt.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},hrt=class{constructor(){this.type="ShapePath",this.color=new zt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new bA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return(r=this.currentPath)==null||r.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){var a;return(a=this.currentPath)==null||a.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(f,p,m,g){let v=f.x,y=p.x,b=m.x,x=g.x,S=f.y,w=p.y,E=m.y,C=g.y,T=(x-b)*(S-E)-(C-E)*(v-b),A=(y-v)*(S-E)-(w-S)*(v-b),M=(C-E)*(y-v)-(x-b)*(w-S),P=T/M,I=A/M;if(M===0&&T!==0||P<=0||P>=1||I<0||I>1)return null;if(T===0&&M===0){for(let R=0;R<2;R++)if(i(R===0?m:g,f,p),t.loc===e.ORIGIN){let N=R===0?m:g;return{x:N.x,y:N.y,t:t.t}}else if(t.loc===e.BETWEEN){let N=+(v+t.t*(y-v)).toPrecision(10),k=+(S+t.t*(w-S)).toPrecision(10);return{x:N,y:k,t:t.t}}return null}else{for(let k=0;k<2;k++)if(i(k===0?m:g,f,p),t.loc===e.ORIGIN){let O=k===0?m:g;return{x:O.x,y:O.y,t:t.t}}let R=+(v+P*(y-v)).toPrecision(10),N=+(S+P*(w-S)).toPrecision(10);return{x:R,y:N,t:P}}}function i(f,p,m){let g=m.x-p.x,v=m.y-p.y,y=f.x-p.x,b=f.y-p.y,x=g*b-y*v;if(f.x===p.x&&f.y===p.y){t.loc=e.ORIGIN,t.t=0;return}if(f.x===m.x&&f.y===m.y){t.loc=e.DESTINATION,t.t=1;return}if(x<-Number.EPSILON){t.loc=e.LEFT;return}if(x>Number.EPSILON){t.loc=e.RIGHT;return}if(g*y<0||v*b<0){t.loc=e.BEHIND;return}if(Math.sqrt(g*g+v*v)<Math.sqrt(y*y+b*b)){t.loc=e.BEYOND;return}let S;g!==0?S=y/g:S=b/v,t.loc=e.BETWEEN,t.t=S}function n(f,p){let m=[],g=[];for(let v=1;v<f.length;v++){let y=f[v-1],b=f[v];for(let x=1;x<p.length;x++){let S=p[x-1],w=p[x],E=r(y,b,S,w);E!==null&&m.find(C=>C.t<=E.t+Number.EPSILON&&C.t>=E.t-Number.EPSILON)===void 0&&(m.push(E),g.push(new oe(E.x,E.y)))}}return g}function s(f,p,m){let g=new oe;p.getCenter(g);let v=[];return m.forEach(y=>{y.boundingBox.containsPoint(g)&&n(f,y.points).forEach(b=>{v.push({identifier:y.identifier,isCW:y.isCW,point:b})})}),v.sort((y,b)=>y.point.x-b.point.x),v}function a(f,p,m,g,v){(v==null||v==="")&&(v="nonzero");let y=new oe;f.boundingBox.getCenter(y);let b=[new oe(m,y.y),new oe(g,y.y)],x=s(b,f.boundingBox,p);x.sort((A,M)=>A.point.x-M.point.x);let S=[],w=[];x.forEach(A=>{A.identifier===f.identifier?S.push(A):w.push(A)});let E=S[0].point.x,C=[],T=0;for(;T<w.length&&w[T].point.x<E;)C.length>0&&C[C.length-1]===w[T].identifier?C.pop():C.push(w[T].identifier),T++;if(C.push(f.identifier),v==="evenodd"){let A=C.length%2===0,M=C[C.length-2];return{identifier:f.identifier,isHole:A,for:M}}else if(v==="nonzero"){let A=!0,M=null,P=null;for(let I=0;I<C.length;I++){let R=C[I];p[R]&&(A?(P=p[R].isCW,A=!1,M=R):P!==p[R].isCW&&(P=p[R].isCW,A=!0))}return{identifier:f.identifier,isHole:A,for:M}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let o=0,l=999999999,c=-999999999,d=[];this.subPaths.forEach(f=>{let p=f.getPoints(),m=-999999999,g=999999999,v=-999999999,y=999999999;for(let b=0;b<p.length;b++){let x=p[b];x.y>m&&(m=x.y),x.y<g&&(g=x.y),x.x>v&&(v=x.x),x.x<y&&(y=x.x)}c<=v&&(c=v+1),l>=y&&(l=y-1),p.length&&d.push({curves:f.curves,points:p,isCW:Kne.isClockWise(p),identifier:o++,boundingBox:new lse(new oe(y,g),new oe(v,m))})});let u=d.map(f=>{var p;return a(f,d,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),h=[];return d.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let m=new xA;m.curves=f.curves,u.filter(g=>(g==null?void 0:g.isHole)&&g.for===f.identifier).forEach(g=>{if(g){let v=d[g.identifier],y=new bA;y.curves=v.curves,m.holes.push(y)}}),h.push(m)}}),h}},qoe=!1,Xoe,G9=new Promise(e=>{Xoe=e}),q9=!1,SS;function frt(){if(qoe=!0,q9)return;if(SS)return SS;async function e(){let t=await R0(()=>import("./opentype-fc28cde9.js"),[],import.meta.url);Xoe(t),q9=!0}return SS=e(),SS}var prt=class{async load(e,t,r=()=>{}){let{load:i}=await G9;i(e,(n,s)=>{n||!s?r(n??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:r}=await G9;try{let i=t(e),n=new r,s=a=>i.charToGlyphIndex(a.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function mrt(e){return await(await fetch(e)).arrayBuffer()}var grt=new prt;async function X9(e){let t,r,i=!1;if(e.url?(t=await mrt(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(qoe){let n=await grt.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}else return{font:void 0,url:r,intercepted:i,arr:t,bidi:null}}function vrt(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var yrt=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=X9(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=X9(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,s=[],a=0,o=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,d=String.fromCharCode(r[l].unicode),u=n[a];if(vrt(c,u)||o)s.push({char:d,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),a++;else{let h=u.char,f="",p=[u.state.glyphIndex],m=[],g=!1;for(;!g;)a++,f=t.charAt(a),h+=f,p.push(e.charToGlyphIndex(f)),m=e.stringToGlyphs(h),m.length===1&&m[0].index===c&&(g=!0),a>t.length&&(g=!0);s.push({char:d,index:c,replacements:p,replacementChars:Array.from(h)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let r=this.font,i=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,s=e.map(v=>this.getTextWidth(v,t)),a=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,c=this.computeSpaceWidthForLine(e,0,t),d=this.getLineInitialOffsetX(s[0],a,t.horizontalAlign,e[0],o),u=this.getLineInitialOffsetY(n,e.length,t.height,i,t.verticalAlign),h=[],f=e.map(v=>[]),p=e.map(v=>[]),m;for(let v=0;v<e.length;v++){let y=e[v],b={features:{liga:!0}},x=[];try{x=r.stringToGlyphs(y,b)}catch(w){console.warn(w)}d=this.getLineInitialOffsetX(s[v],a,t.horizontalAlign,y,o);let S=[];try{S=this.reverseLigaturesTable(r,y,x)}catch(w){console.warn(w)}c=this.computeSpaceWidthForLine(e,v,t);for(let w=0;w<x.length;w++){let E=x[w],C=E.index===0?`
`:E.unicode?String.fromCharCode(E.unicode):void 0,T=S[w],A=0,M=0;w===0&&t.horizontalAlign===2&&E.leftSideBearing!==void 0&&(M=-E.leftSideBearing*i),m&&(A=r.getKerningValue(E,m)*i),d+=M+A;let P=0;if(C===`
`)P=l;else if(C===" ")P=c;else{let I=this.createPath(E,i,d,u,t);I&&(P=I.offsetX-(A+M),h.push(I.path))}if(T.replacements.length===1)p[v].push([d,u]),f[v].push(P);else{let I=T.replacements.map(O=>(r.glyphs.get(O).advanceWidth??0)*i),R=I.reduce((O,D)=>O+=D,0),N=I.map(O=>O/R),k=d;for(let O=0;O<N.length;O++){let D=P*N[O];p[v].push([k,u]),f[v].push(D),k+=D}}d+=P,m=E}u-=n}let g=[];for(let v=0,y=h.length;v<y;v++)g.push(...h[v].toShapes());return{shapes:g,charWidths:f,lineWidths:s,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let s=t*e,a=Math.abs(this.ascender-this.descender)*i,o=e-a,l=-this.ascender*i-o/2;return n===3?-(r-s-l):n===2?-(r*.5-s*.5-l):l}createPath(e,t,r,i,n){var l;let s=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new hrt,o=(e.advanceWidth??1)*t;if(e)for(let c of s.commands){let d=(l=a.currentPath)==null?void 0:l.currentPoint;if(!(d&&c.type!=="Z"&&d.x===c.x&&-d.y===c.y))switch(c.type){case"M":a.moveTo(c.x,-c.y);break;case"L":a.lineTo(c.x,-c.y);break;case"Q":a.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":a.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return a.subPaths.forEach(c=>{let d=brt(c.curves);d!==void 0&&c.currentPoint.distanceTo(d)>0&&c.lineTo(d.x,d.y)}),{offsetX:o+n.fontSize*n.letterSpacing,path:a}}getCharWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,r){let i=this.getCharWidth(" ",r),n=e[t];if(n){let s=this.countSpaces(n.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&s){let a=r.width,o=this.getTextWidth(n,r);return(a-(o-s*i))/s}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};function brt(e){if(e.length){let t=e[0];if(t instanceof Fl)return t.v1;if(t instanceof Rl||t instanceof Vh)return t.v0}}var xrt=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,r){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t,r),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},Y9=class extends xrt{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,r){let i=_x(e,t,this.flatShading,r);return i.computeBoundingSphere(),i}},wrt={markNeedsUpdateRendererDirty:()=>{}},_rt=class extends _tt{constructor(e){super(),this.shared=e}create(e){return new Boe(e,this.shared)}},Tj=class{constructor(e,t={}){if(this.data=e,this.geometryCache=new Y9(!0),this.geometryCache2=new Y9(!1),this.imageHolderCache=new _rt(this),this.thisContext={scene:wrt,shared:this},this.deletedMaterial=new XN(Zs.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new Jd(XA.emptyImage,this),this.deletedVideo=new Jd(VA.defaultVideo,this),this.materials={},this.images={},this.canvases={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[r,i]of Object.entries(t.images))this.addImage(r,i);if(t.videos)for(let[r,i]of Object.entries(t.videos))this.addVideo(r,i);if(t.audios)for(let[r,i]of Object.entries(t.audios))this.addAudio(r,i);if(t.particles)for(let[r,i]of Object.entries(t.particles))this.addParticle(r,i);this.reset(e)}setRequestRender(e){this._requestRender=e}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1){this.resetLib(e.lib);for(let{id:r,data:i}of e.variables)this.addVariableHolder(r,i),t&&this.updateVariableHolder(r,i);for(let[r,i]of Object.entries(e.images))this.addImage(r,i);for(let[r,i]of Object.entries(e.videos))this.addVideo(r,i);for(let[r,i]of Object.entries(e.colors))this.addColor(r,i);for(let[r,i]of Object.entries(e.materials))this.addMaterial(r,i);for(let[r,i]of Object.entries(e.audios))this.addAudio(r,i);for(let[r,i]of Object.entries(e.particles))this.addParticle(r,i);for(let[r,i]of Object.entries(e.fonts))this.addFont(r,i)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new XN(t,this.thisContext,e);this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new Aj(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new Jd(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addCanvas(e,t){return this.canvases[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.canvases[e].updateSrc(t),!0):(this.canvases[e]=new Jd(t,this),!1)}canvas(e){return this.canvases[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new Jd(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new sT(t.r,t.g,t.b,t.a):this.colors[e]=new sT(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new Ps(0,0,0,0))}else return"a"in e?new Ps(e.r,e.g,e.b,e.a):new Ps(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof x1)return t;{let r=new x1({src:t.data});return this.audios[e]=r,r}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof x1&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new yrt(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof x1&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){return this.variables[e]===void 0?(this.variables[e]={value:t.value,locations:[]},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0):(this.variables[e].value=t.value,!1)}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t;let r=t;for(;typeof r=="string";)r=this.variables[r].value;let i=this.entityOpContext.scene;for(let n=this.variables[e].locations.length-1;n>=0;n--){let s=this.variables[e].locations[n];if(s[0]==="material"){let a=s[1],o=r,l={scene:i,shared:this},c=s.slice(2);i.traverseMaterial(u=>{let h=u.root??u;h.uuid===a&&h.onVariableUpdate(c,o,l)});let d=this.materials[a];d&&d.onVariableUpdate(c,o,l)}else{let a=i.find(s[0]);if(a===void 0){this.variables[e].locations.splice(n,1);continue}if(s[1]!=="geometry"&&s[1]!=="particles"){for(let o=1;o<s.length-1;o++)a=a[s[o]];s[1]==="rotation"?a[s[s.length-1]]=r*Et.DEG2RAD:a[s[s.length-1]]=r}if(a=i.find(s[0]),a.type==="ParticleEmitter"&&a.updateVariableState(r,s),_r.is(a)){if(s[1]==="position"||s[1]==="rotation"||s[1]==="scale")a.onVariableUpdate();else if(s[1]==="geometry"){let o=a;a.component&&(o=a.component);let l=o.dataPatched;o.chooseGeoemtryCache(this).forceDelete(l.geometry),o.createGeometryDelayed(this.entityOpContext),o.onVariableUpdate(!0),o.instances.forEach(c=>{let d=c.dataPatched;c.chooseGeoemtryCache(this).forceDelete(d.geometry),c.createGeometryDelayed(this.entityOpContext),c.onVariableUpdate(!0)})}}}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){var r,i,n;if(Array.isArray(e)){if(e[0]==="mouse")return((r=this.mouseProperty)==null?void 0:r[e[1]])??0;if(e[0]==="raycast")return((i=this.raycastProperty)==null?void 0:i[e[1]])??0;let s=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return s.geometry.userData.parameters[e[1]];for(let a=1;a<e.length;a++)s=s[e[a]];return e[1]==="rotation"&&(s*=Et.RAD2DEG),s}for(let s in this.variables){if(t===void 0)break;let a=this.variables[s],o=(n=a.locations)==null?void 0:n.findIndex(l=>ws.equal(l,t));o!==void 0&&o!==-1&&a.locations.splice(o,1)}if(typeof e=="string"){let s=e,a=e;do{if(a=s,this.variables[s]===void 0)break;s=this.variables[s].value}while(typeof s=="string");return t&&this.variables[a]!==void 0&&this.variables[a].locations.push(t),s}else return e}getVariables(){return this.variables}getDynamicVariablePlayState(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.particles))this.addParticle(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset);for(let[t,r]of Object.entries(e.variables))this.addVariableHolder(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){this.data=t,e.path[0]==="images"?e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(rs.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r}):e.path[0]==="fonts"?e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===2&&e.type===0&&"value"in e.props?this.updateVariable(e.path[1],e.props.value):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id):e.path[0]==="lib"&&this.updateLibByOp(rs.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}};new Tj(Ho.emptyData());var q0=class extends Ca{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),pQe(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let s=r.shared.material(n);this.material[Number(i)]=s}else if(ci(e.path,["material"])&&this.material instanceof $h)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(rs.drop(e,1),t.material,r);else if(ci(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(rs.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var i,n;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;if(((i=e.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe),t.scene.markNeedsUpdateRendererDirty()),(((n=e.geometry)==null?void 0:n.type)==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(s=>t.shared.material(s).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&Gse(this.material).forEach(e=>{e instanceof $h&&(e instanceof XN||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},K9=new L,Q9=new Yt,Z9=new Yt,Srt=new L,J9=new Ke,Ys=class extends q0{constructor(e,t,r){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=new Ke().fromArray(t.bindMatrix),this.bindMatrixInverse=new Ke)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof Dt&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof Tj){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return HA.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return HA.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),ci(e.path,["geometry"])&&this.updateByPatchedOpGeometry(rs.drop(e,1),t.geometry,r)}removeInteractionGeometry(e){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var i;this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if(r==="NonParametricGeometry"||r==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=_x(c,t,this.data.flatShading,this)}let s,a,o;n.scaleBaked?[s,a,o]=n.scaleBaked:{width:s,height:a,depth:o}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&UN(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let n={...this.data.geometry,...e};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=_x(n,t,this.data.flatShading,this)}}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;e.type===0&&e.path.length===0&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof pa&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||((n=r.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,r.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new Yt,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){t.fromBufferAttribute(r,i);let s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(r===void 0)return;let i=this.geometry;Q9.fromBufferAttribute(i.attributes.skinIndex,e),Z9.fromBufferAttribute(i.attributes.skinWeight,e),K9.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let s=Z9.getComponent(n);if(s!==0){let a=Q9.getComponent(n);J9.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(Srt.copy(K9).applyMatrix4(J9),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};function Ert(e){var a,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=new L(n[l],n[l+1],n[l+2]);t.has(c)?(a=t.get(c))==null||a.normals.push(d):t.set(c,{normals:[d],result:new L})}t.forEach((l,c)=>{for(let d of l.normals)l.result.add(d);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=(o=t.get(c))==null?void 0:o.result;d&&(s[l]=d.x,s[l+1]=d.y,s[l+2]=d.z)}e.geometry.setAttribute("extrudeNormal",new vt(s,3))}function Crt(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new L;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new vt(r,3))}function Mj(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof $h)||e.material.getLayersOfType("outline").length===0)return;e instanceof Ys&&e.is2DAndNoDepth?Crt(e):Ert(e)}function Pj(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[Et.seededRandom(i),Et.seededRandom(i+1e4),Et.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)r[s]=n[s%3];e.geometry.setAttribute("randomColor",new Wt(r,3))}var cc=new un,Vy=new L;function Art(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var Sx=class extends Ys{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new Ke,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,a,o;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=pa.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&((a=this.originalGeometry)==null||a.dispose(),this.originalGeometry=r),i!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,Mj(this),Pj(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=Array.isArray(r)?r.map(i=>i.getFlavor(!1,i.side,i.wireframe)):r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){pa.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&pa.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=pa.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=pa.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,Ca.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Za,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;cc.setFromBufferAttribute(t),cc.getCenter(r),e.boundingSphere.radius=r.distanceTo(cc.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),cc.getSize(Vy),this.hasNonUniformScale&&Vy.divide(this.scale);let i={width:Vy.x,height:Vy.y,depth:Vy.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;cc.min.set(e[0],e[2],e[4]),cc.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(cc.min.applyMatrix4(this.shearScaleInv),cc.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new Za);let r=t.boundingSphere.center;cc.getCenter(r),t.boundingSphere.radius=r.distanceTo(cc.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(pa.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},e7=-1,Trt=1,Mrt={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},Prt={polygon_center:0,edge:1,vertex:2},ES=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,ir=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-e7)*(r-i)/(Trt-e7)+i};function Irt(e){let t=[],r={};for(var i=0,n=e.length;i<n;i++){var s=JSON.stringify(e[i].pos.map(a=>Math.round(a*1e4)/1e4));r[s]||(t.push(e[i]),r[s]=!0)}return t}var Rrt=new L,CS=new L,Drt=new L,Ort=new L;function vv(e,t){let r=Drt.fromArray(e),i=Ort.fromArray(t);CS.copy(i).sub(r);let n=CS.length();return CS.normalize().multiplyScalar(n*.5),Rrt.copy(r).add(CS).toArray()}var Xo=new xs,AS=new L,aT=new L,Rf=new L;function Lrt(e){let t=[];for(let r=0;r<=e.index.count;r++)if(AS.fromArray(e.index.array,r*3),Xo.setFromAttributeAndIndices(e.attributes.position,AS.x,AS.y,AS.z),Xo.getNormal(aT),Xo.getMidpoint(Rf),!(isNaN(Rf.x)||isNaN(Rf.y)||isNaN(Rf.z))){let{a:i,b:n,c:s}=Xo,a=i.toArray(),o=n.toArray(),l=s.toArray(),c=i.distanceTo(n),d=n.distanceTo(s),u=s.distanceTo(i),h=vv(a,o),f=vv(o,l),p=vv(l,a),m=[c,d,u],g=Math.max(...m),v=m.filter(x=>Math.round(x)===Math.round(g)).length>1,y=[],b=Xo.getMidpoint(Rf).toArray();g===c&&!v&&(y=[f,p,p],b=h),g===d&&!v&&(y=[h,p,p],b=f),g===u&&!v&&(y=[h,f,f],b=p),v&&(y=[h,f,p]),t.push({vertices:[a,o,l],faceCenters:y,midpoint:b,norm:Xo.getNormal(aT).toArray()})}return t}function Nrt(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){Xo.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),Xo.getNormal(aT),Xo.getMidpoint(Rf);let n=Xo.a.toArray(),s=Xo.b.toArray(),a=Xo.c.toArray();t.push({vertices:[n,s,a],faceCenters:[vv(n,s),vv(s,a),vv(a,n)],midpoint:Rf.toArray(),norm:aT.toArray()})}return t}var krt=4,zrt=.5,cD=e=>.5*(1-Math.cos(e*Math.PI)),Brt=class{constructor(){this.perlin=new Array(4095+1)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),s=Math.floor(r),a=e-i,o=t-n,l=r-s,c,d,u=0,h=.5,f,p,m;for(let g=0;g<krt;g++){let v=i+(n<<4)+(s<<8);c=cD(a),d=cD(o),f=this.perlin[v&4095],f+=c*(this.perlin[v+1&4095]-f),p=this.perlin[v+16&4095],p+=c*(this.perlin[v+16+1&4095]-p),f+=d*(p-f),v+=256,p=this.perlin[v&4095],p+=c*(this.perlin[v+1&4095]-p),m=this.perlin[v+16&4095],m+=c*(this.perlin[v+16+1&4095]-m),p+=d*(m-p),f+=cD(l)*(p-f),u+=f*h,h*=zrt,i<<=1,a*=2,n<<=1,o*=2,s<<=1,l*=2,a>=1&&(i++,a--),o>=1&&(n++,o--),l>=1&&(s++,l--)}return u}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4095+1);for(let r=0;r<4095+1;r++)this.perlin[r]=t.rand()}},Frt=Brt,t7=new L,r7=new Ke,i7=new O0;function n7(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(t=!0)}),t}var Yoe=class extends Ys{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(r7.copy(r).invert(),i7.copy(e.ray).applyMatrix4(r7),i7.intersectBox(this.singleBBox,t7))){let i=t7.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},ca=1e-4,uc,Koe,Qoe,Zoe,s7=new L,a7=new L;aoe.then(e=>{uc=e,Koe=[uc.get_face_center,uc.get_edge_midpoint,uc.get_vertex_position],Qoe=[uc.get_face_normal,uc.get_edge_normal,uc.get_vertex_normal],Zoe=[uc.face_count,uc.edge_count,uc.vertex_count]});var jrt=new Ke,Vrt=new Ke,Dd=new L,hf=new L,Uy=new L,uD=new L,Urt=new L,$rt=new L,gu=new Frt,Ol=class extends dj(Yr){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof Xs&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof Xs&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,n=this.children.length;i<n;++i)this.remove(this.children[0]);let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let s=new Xs(this.object);s.expand(),this.add(s)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new Xs(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,r=t.start*Et.DEG2RAD,i=t.end*Et.DEG2RAD,n=r-i,s=new kn(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new L(0,0,1);break;case"y":a=new L(0,1,0);break;default:case"x":a=new L(1,0,0);break}let o=e.randomnessObject??uh.defaultData([1,1,1]).randomnessObject,l=o.noiseType==="perlin";gu.noiseSeed(o.seed);let c=UR((0,ky.default)(o.seed)),d=ES(o.strength,this.parameters.randomness);for(let[u,h]of this.children.entries()){let f=u*(o.freqScale/10)+o.movement,p=l?gu.noise(f):c(f,f),m=u+1;h.scale.x=t.scale[0]+d(m,ir(p,o.scale[0]))||ca,h.scale.y=t.scale[1]+d(m,ir(p,o.scale[1]))||ca,h.scale.z=t.scale[2]+d(m,ir(p,o.scale[2]))||ca,h.position.setScalar(0);let g=n/e.count*u-r;switch(t.axis){case"x":h.rotation.set(0,g,0);break;case"y":h.rotation.set(0,0,g);break;case"z":h.rotation.set(g,0,0);break}h.translateOnAxis(a,t.radius),h.position.x+=t.position[0]+d(m,ir(p,o.position[0])),h.position.y+=t.position[1]+d(m,ir(p,o.position[1])),h.position.z+=t.position[2]+d(m,ir(p,o.position[2]));let v=d(m,ir(p,o.rotation[0])),y=d(m,ir(p,o.rotation[1])),b=d(m,ir(p,o.rotation[2]));t.alignment===!0?(h.rotation.x+=s.x+v,h.rotation.y+=s.y+y,h.rotation.z+=s.z+b):h.rotation.set(s.x+v,s.y+y,s.z+b)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new kn(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??uh.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";gu.noiseSeed(i.seed);let s=UR((0,ky.default)(i.seed)),a=ES(i.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let c=o*(i.freqScale/10)+i.movement,d=n?gu.noise(c):s(c,c),u=o+1,h=a(u,ir(d,i.rotation[0])),f=a(u,ir(d,i.rotation[1])),p=a(u,ir(d,i.rotation[2]));l.scale.x=1+(t.scale[0]-1)*o+a(u,ir(d,i.scale[0]))||ca,l.scale.y=1+(t.scale[1]-1)*o+a(u,ir(d,i.scale[1]))||ca,l.scale.z=1+(t.scale[2]-1)*o+a(u,ir(d,i.scale[2]))||ca,l.rotation.x=r.x*o+h,l.rotation.y=r.y*o+f,l.rotation.z=r.z*o+p,l.position.x=t.position[0]*o+a(u,ir(d,i.position[0])),l.position.y=t.position[1]*o+a(u,ir(d,i.position[1])),l.position.z=t.position[2]*o+a(u,ir(d,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??uh.defaultData([1,1,1]).randomnessObject,n=ES(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";gu.noiseSeed(i.seed);let a=qZe((0,ky.default)(i.seed));if(r.useCenter===!0){let o={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},l=new L(r.size[0]*(r.count[0]-o.x)*.5,r.size[1]*(r.count[1]-o.y)*.5,r.size[2]*(r.count[2]-o.z)*.5);for(let c=0;c<r.count[0];c++)for(let d=0;d<r.count[1];d++)for(let u=0;u<r.count[2];u++){let h=[(c+1)*(i.freqScale/10)+i.movement,(d+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement],f=s?gu.noise(...h):a(...h),p=this.children[t++];p.scale.x=1+n(t,ir(f,i.scale[0]))||ca,p.scale.y=1+n(t,ir(f,i.scale[1]))||ca,p.scale.z=1+n(t,ir(f,i.scale[2]))||ca;let m=n(t,ir(f,i.rotation[0])),g=n(t,ir(f,i.rotation[1])),v=n(t,ir(f,i.rotation[2]));p.rotation.set(m,g,v),p.position.x=r.size[0]*c-l.x+n(t,ir(f,i.position[0])),p.position.y=r.size[1]*d-l.y+n(t,ir(f,i.position[1])),p.position.z=r.size[2]*u-l.z+n(t,ir(f,i.position[2]))}}else for(let o=0;o<r.count[0];o++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let d=[(o+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],u=s?gu.noise(...d):a(...d),h=this.children[t++];h.scale.x=1+n(t,ir(u,i.scale[0]))||ca,h.scale.y=1+n(t,ir(u,i.scale[1]))||ca,h.scale.z=1+n(t,ir(u,i.scale[2]))||ca;let f=n(t,ir(u,i.rotation[0])),p=n(t,ir(u,i.rotation[1])),m=n(t,ir(u,i.rotation[2]));h.rotation.set(f,p,m),h.position.x=r.size[0]*o+n(t,ir(u,i.position[0])),h.position.y=-r.size[1]*l+n(t,ir(u,i.position[1])),h.position.z=-r.size[2]*c+n(t,ir(u,i.position[2]))}}_updateToObject(e){var m;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new kn(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??uh.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";gu.noiseSeed(i.seed);let s=UR((0,ky.default)(i.seed)),a=ES(i.strength,this.parameters.randomness);if(!t.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof Yoe)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let o=this.getSubdivData(),l=[],c=g=>{let v=g.length,y=g.map(S=>S[0]).reduce((S,w)=>S+w,0),b=g.map(S=>S[1]).reduce((S,w)=>S+w,0),x=g.map(S=>S[2]).reduce((S,w)=>S+w,0);return[y/v,b/v,x/v]},d=g=>Math.round(g*1e6)/1e6;o.forEach(g=>{let v=o.filter(y=>d(g.pos[0])===d(y.pos[0])&&d(g.pos[1])===d(y.pos[1])&&d(g.pos[2])===d(y.pos[2]));v.length>1?l.push({pos:g.pos,norm:c(v.map(y=>y.norm))}):l.push(g)});let u=Irt(l);if(u.length>0){let g=Math.round(u.length*t.count/100);this._updateCount(g)}else{let g=this.objectForSample.geometry.getAttribute("position");if(!g||isNaN(g.count)||g.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let h=new XZe(this.objectForSample).build(),f=Mrt[t.axis],p=this.children;h.setRandomGenerator((0,ky.default)(this.object.uuid+t.seed));for(let[g,v]of p.entries()){let y=g*(i.freqScale/10)+i.movement,b=n?gu.noise(y):s(y,y),x=g+1,S=a(x,ir(b,i.rotation[0])),w=a(x,ir(b,i.rotation[1])),E=a(x,ir(b,i.rotation[2]));t.spreadType==="random"?h.sample(Uy,uD):(u.length&&(Uy.fromArray(u[g].pos),uD.fromArray(u[g].norm)),this.objectForSample instanceof Sx&&Uy.applyMatrix4(jrt.copy(this.objectForSample.matrixWorld).invert())),Uy.applyMatrix4(this.object.hiddenMatrix.clone().invert()),v.position.copy(Uy),Dd.fromArray(f);let C=t.align==="normal"?uD:this.object.getWorldDirection($rt),T=hf.fromArray(t.position);hf.x+=hf.x+a(x,ir(b,i.position[0])),hf.y+=hf.y+a(x,ir(b,i.position[1])),hf.z+=hf.z+a(x,ir(b,i.position[2]));let A=Math.acos(C.dot(Dd)),M=Urt.crossVectors(Dd,C).normalize(),P=Vrt.makeRotationAxis(M,A),I=C.clone().cross(this.object.up).normalize(),R=I.clone().cross(C).normalize(),N=new Ke().makeBasis(I,C,R),k=new L(Dd.y,Dd.z,Dd.x).normalize(),O=k.clone().cross(Dd).normalize(),D=new Ke().makeBasis(k,Dd,O).invert(),B=new Ke().multiplyMatrices(N,D);v.rotation.setFromRotationMatrix(B),T.applyMatrix4(P),v.position.add(T),v.rotation.x=v.rotation.x+r.x+S,v.rotation.y=v.rotation.y+r.y+w,v.rotation.z=v.rotation.z+r.z+E,v.scale.setScalar(1),v.scale.x=v.scale.x+t.scale[0]+a(x,ir(b,i.scale[0]))||ca,v.scale.y=v.scale.y+t.scale[1]+a(x,ir(b,i.scale[1]))||ca,v.scale.z=v.scale.z+t.scale[2]+a(x,ir(b,i.scale[2]))||ca,v.scale.multiply(this.object.scale),v.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof Sx){let t=this.objectForSample,r=Prt[e],i=Zoe[r],n=Koe[r],s=Qoe[r],a=[],o=i(t.subdivPointerNew);for(let l=0;l<=o-1;l++){let c=n(t.subdivPointerNew,l),d=s(t.subdivPointerNew,l);s7.fromArray(c).applyMatrix4(t.matrixWorld),a7.fromArray(d),a.push({pos:s7.toArray(),norm:a7.toArray()})}return a}else return(this.objectForSample.geometry.index?Lrt(this.objectForSample.geometry):Nrt(this.objectForSample.geometry)).map((t,r)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var r;if(this.parameters=VM(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(r=this.object.parent)==null||r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=t.find(this.parameters.toObject.object);i instanceof Ca?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new Ke,this.hiddenMatrix=new Ke,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},Sw=e=>{var t;return t=class extends e{},t.geometryHelper=new Ql(30,30,30),t},TS=new O0,dD=new Za,o7=new Ke,Ew=(e,t,r,i,n=!1)=>{let s=t,a=e.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),dD.copy(s.boundingSphere),dD.applyMatrix4(a),r.ray.intersectsSphere(dD)===!1||(o7.copy(a).invert(),TS.copy(r.ray).applyMatrix4(o7),s.boundingBox!==null&&TS.intersectsBox(s.boundingBox)===!1))return;let o,l,c,d,u=s.index,h=s.attributes.position,f=s.drawRange,p,m;if(n===!1){let v=Math.max(0,f.start),y=Math.min(u.count,f.start+f.count);for(p=v,m=y;p<m;p+=3)if(l=u.getX(p),c=u.getX(p+1),d=u.getX(p+2),o=g(e,r,TS,h,l,c,d),o){o.faceIndex=Math.floor(p/3),i.push(o);return}}else{let v=s.attributes.position,y=new L,b=new L,x=new L,S=new L,w=2,E=1/((e.scale.x+e.scale.y+e.scale.z)/3),C=E*E,T=Math.max(0,f.start),A=Math.min(v.count,f.start+f.count);for(let M=T,P=A-1;M<P;M+=w){if(y.fromBufferAttribute(v,M),b.fromBufferAttribute(v,M+1),TS.distanceSqToSegment(y,b,S,x)>C)continue;S.applyMatrix4(e.matrixWorld);let I=r.ray.origin.distanceTo(S);I<r.near||I>r.far||i.push({distance:I,point:x.clone().applyMatrix4(e.matrixWorld),object:e})}}function g(v,y,b,x,S,w,E){let C=new L,T=new L,A=new L,M=new L,P=new L;if(C.fromBufferAttribute(x,S),T.fromBufferAttribute(x,w),A.fromBufferAttribute(x,E),b.intersectTriangle(C,T,A,!1,M)===null)return null;P.copy(M),P.applyMatrix4(v.matrixWorld);let I=y.ray.origin.distanceTo(P);return I<y.near||I>y.far?null:{faceIndex:1,distance:I,point:P.clone(),object:v}}},MS=new L,zo=new tm,Hrt=class extends vw{constructor(e){let t=new Dt,r=new tf({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new zt(15711266),o=new zt(15711266),l=new zt(2857471);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,h,f){d(u,f),d(h,f)}function d(u,h){i.push(0,0,0),n.push(h.r,h.g,h.b),s[u]===void 0&&(s[u]=[]),s[u].push(i.length/3-1)}t.setAttribute("position",new vt(i,3)),t.setAttribute("color",new vt(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;zo.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;pl("n1",t,e,zo,-r,-i,n),pl("n2",t,e,zo,r,-i,n),pl("n3",t,e,zo,-r,i,n),pl("n4",t,e,zo,r,i,n);let s=n;pl("f1",t,e,zo,-r,-i,s),pl("f2",t,e,zo,r,-i,s),pl("f3",t,e,zo,-r,i,s),pl("f4",t,e,zo,r,i,s);let a=s,o=.5;pl("u1",t,e,zo,r*.7*o,i*1.1,a),pl("u2",t,e,zo,-r*.7*o,i*1.1,a),pl("u3",t,e,zo,0,i*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function pl(e,t,r,i,n,s,a){MS.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,d=o.length;c<d;c++)l.setXYZ(o[c],MS.x,MS.y,MS.z)}}var Wrt=class extends Sw(Hrt){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){Ew(this.object,this.geometry,e,t,!0)}},YN;(e=>e.is=t=>"objectHelper"in t)(YN||(YN={}));var X0=(e,t)=>class extends hj(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof CA&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof Ql?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof CA&&(i.visible=!1)}}},PS=790,Jm=new L,hD=new L,fD=new Xt,pD=new L,$y=new L,mD=new L,Js=class extends X0(tm,Wrt){constructor(t="",r={...px.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Jv.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,r),this.previousProjectionMatrix=new Ke,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,n=this.height;this.orthoCamera=new C4(i*-.5,i*.5,n*.5,n*-.5,-5e4,1e4),this.perspCamera=new Gs(45,i/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,r){t==="PerspectiveCamera"?this.perspCamera.near=r:this.orthoCamera.near=r}setZoom(t,r){r>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=r:this.orthoCamera.zoom=r)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,r,i){typeof t=="number"&&(t=new L(t,r,i)),super.lookAt(t),this.getWorldPosition(Jm),this.targetOffset=Jm.distanceTo(t)}getTarget(t=new L){return this.getWorldDirection(hD),this.getWorldPosition(Jm),hD.multiplyScalar(this.targetOffset),t.copy(Jm).add(hD),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(Jm),Jm.distanceTo(t)}updateUp(){this.getWorldQuaternion(fD),pD.set(0,0,1).applyQuaternion(fD),$y.copy(Yr.DEFAULT_UP),this.isUpVectorFlipped&&$y.negate(),$y.applyQuaternion(fD),mD.copy(Yr.DEFAULT_UP).projectOnPlane(pD),this.angleOffsetFromUp=mD.angleTo($y),this.angleOffsetFromUp*=mD.cross($y).dot(pD)>=0?1:-1}updateTransformState(t,r){let i=super.updateTransformState(t,r);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),i}getViewFrontToObject(t){let r=t.getWorldPosition(new L),i=t.getWorldDirection(new L).multiplyScalar(this.targetOffset);return{position:r.clone().add(i),target:r}}getViewToTarget(t){let r=this.getWorldDirection(new L).multiplyScalar(this.targetOffset);return{position:t.clone().sub(r),target:t}}getViewToObject(t){let r=new L;return t.getWorldPosition(r),this.getViewToTarget(r)}setViewplaneSize(t,r,i=!1){if(this.aspect=t/r,i){let n=t>r?this.aspect:1,s=t>r?1:this.aspect;this.left=-PS*.5*n,this.right=PS*.5*n,this.top=PS*.5*(1/s),this.bottom=-PS*.5*(1/s)}else this.left=-t*.5,this.right=t*.5,this.top=r*.5,this.bottom=-r*.5;this.updateProjectionMatrix()}copyViewPlaneSize(t){this.aspect=t.aspect,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,r,i,n,s,a){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,r,i,n,s,a):this.orthoCamera.setViewOffset(t,r,i,n,s,a)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,r){super.updateWorldMatrix(t,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,r){return super.copy(t,r),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let r={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return GL(r,t)}updateCameraSubtype(t,r){let i=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";r.zoom!==void 0&&this.setZoom(i,r.zoom),r.near!==void 0&&this.setNear(i,r.near),r.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=r.fov)}updateState(t,r){this.updateCameraState(t,r)}updateCameraState(t,r){this.updateState_Entity(t,r),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,r,i){super.updateByPatchedOp(t,r,i),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},eg=new Ke,Grt=new Ke,IS=new Ke,l7=new L,c7=new L;function u7(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var Up=class extends q0{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Dt,this.onAfterRender=(i,n,s,a,o,l)=>{super.onAfterRender(i,n,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var i;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let s=this.children[n];s instanceof Up&&s.dataPatched.visible===!0&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let s=this.children[n];if(s instanceof Ca&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0&&s.booleanMeshSetAddress!==0){eg.multiplyMatrices(s.hiddenMatrix,s.matrix);try{if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Au.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;Au.transformMeshSet(s.booleanMeshSetAddress,eg),s.booleanMatrixInvOld.copy(eg).invert(),s.booleanWasTransformed=!1}else s instanceof Up&&s.needsTransformForDownstream===!0?(Au.transformMeshSet(s.booleanMeshSetAddress,eg),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Au.transformMeshSet(s.booleanMeshSetAddress,Grt.multiplyMatrices(eg,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(eg).invert(),s.booleanWasTransformed=!1)}catch(a){console.error(a),s.booleanMeshSetAddress=0,s.geometry.userData.booleanOperationDidFail=!0;continue}Au.hasOpenEdges(s.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.booleanOperationDidFail=!1):s.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new vt([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Au.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new Dt,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=Au.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Mj(this),Pj(this)}dispose(){super.dispose(),this.geometry.dispose()}get recursiveBBox(){var t;let e=super.recursiveBBox;return((t=this.geometry.boundingSphere)==null?void 0:t.radius)===-1&&(e.getCenter(this.geometry.boundingSphere.center),IS.copy(this.matrixWorld).invert(),this.geometry.boundingSphere.center.applyMatrix4(IS),l7.copy(e.max).applyMatrix4(IS),c7.copy(e.min).applyMatrix4(IS),this.geometry.boundingSphere.radius=l7.distanceTo(c7)/2),e}},KN;(e=>{function t(r){return _r.is(r)&&r instanceof xw}e.is=t})(KN||(KN={}));var Ij=(e,t)=>class extends X0(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},Pl=e=>e instanceof Ca,Hu=e=>e!==null&&e instanceof Up,qrt=e=>e instanceof Js,Xrt=e=>KN.is(e),QN=e=>YN.is(e),Cw=class extends Sw(wWe){constructor(e,t=15){super(t),this.object=e,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){Ew(this.object,Cw.geometryHelper,e,t)}update(){}},yv=class extends X0($f,Cw){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},ZN=class extends X0($f,Cw){constructor(e,t,r){super(),this.super_Entity(e,t),this.context=r,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},Joe={RED:0,GREEN:1,BLUE:2,ALPHA:3},Aw="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Yrt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,RS=class extends Gr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new Ye(null),kernel16:new Ye(null),inputBuffer:new Ye(null),cocBuffer:new Ye(null),texelSize:new Ye(new oe),scale:new Ye(1)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:Yrt,vertexShader:Aw}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let l=o*e,c=Math.sqrt(o)/Math.sqrt(80),d=c*Math.cos(l),u=c*Math.sin(l);o%5===0?(r[n++]=d,r[n++]=u):(t[i++]=d,t[i++]=u)}let s=[],a=[];for(let o=0;o<128;)s.push(new Yt(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new Yt(r[o++],r[o++],r[o++],r[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function d7(e,t,r){return e*(t-r)-t}function JN(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var Krt=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,Qrt=class extends Gr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ye(null),focusDistance:new Ye(0),focusRange:new Ye(0),cameraNear:new Ye(.3),cameraFar:new Ye(1e3)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:Krt,vertexShader:Aw}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=yd){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-d7(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=JN(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-d7(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=JN(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Gs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},Zrt=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,Jrt="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",h7=class extends Gr{constructor(e=new oe){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ye(null),texelSize:new Ye(new oe),halfTexelSize:new Ye(new oe),kernel:new Ye(0),scale:new Ye(1)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:Zrt,vertexShader:Jrt}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},eit=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,tit=class extends Gr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ye(null),opacity:new Ye(1)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:eit,vertexShader:Aw}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},rit=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,iit=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,KM={DEPTH:0,LUMA:1,COLOR:2},nit={DISABLED:0,DEPTH:1,CUSTOM:2},sit=class extends Gr{constructor(e=new oe,t=KM.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:D0.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new Ye(null),depthBuffer:new Ye(null),predicationBuffer:new Ye(null),texelSize:new Ye(e)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:rit,vertexShader:iit}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=yd){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},ait=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,oit="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",ml={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},ek=class extends Gr{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:D0.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ye(null),depthBuffer:new Ye(null),resolution:new Ye(new oe),texelSize:new Ye(new oe),cameraNear:new Ye(.3),cameraFar:new Ye(1e3),aspect:new Ye(1),time:new Ye(0)},blending:Tn,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=yd){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=ait.replace(ml.FRAGMENT_HEAD,e.get(ml.FRAGMENT_HEAD)).replace(ml.FRAGMENT_MAIN_UV,e.get(ml.FRAGMENT_MAIN_UV)).replace(ml.FRAGMENT_MAIN_IMAGE,e.get(ml.FRAGMENT_MAIN_IMAGE)),this.vertexShader=oit.replace(ml.VERTEX_HEAD,e.get(ml.VERTEX_HEAD)).replace(ml.VERTEX_MAIN_SUPPORT,e.get(ml.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Gs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return ml}},lit=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,cit=class extends Gr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:D0.replace(/\D+/g,"")},uniforms:{inputBuffer:new Ye(null),threshold:new Ye(0),smoothing:new Ye(1),range:new Ye(null)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:lit,vertexShader:Aw}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},uit=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,ele={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},dit=class extends Gr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Ye(e),inputBuffer:new Ye(null),strength:new Ye(1)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:uit,vertexShader:Aw}),this.toneMapped=!1,this.setColorChannel(Joe.RED),this.setMaskFunction(ele.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==na&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},hit=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,fit="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",pit=class extends Gr{constructor(e=new oe,t=new oe){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new Ye(null),searchTexture:new Ye(null),areaTexture:new Ye(null),resolution:new Ye(t),texelSize:new Ye(e)},blending:Tn,depthWrite:!1,depthTest:!1,fragmentShader:hit,vertexShader:fit}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},mit=new tm,Od=null;function git(){if(Od===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Od=new Dt,Od.setAttribute!==void 0?(Od.setAttribute("position",new Wt(e,3)),Od.setAttribute("uv",new Wt(t,2))):(Od.addAttribute("position",new Wt(e,3)),Od.addAttribute("uv",new Wt(t,2)))}return Od}var Ra=class{constructor(e="Pass",t=new Xu,r=mit){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new An(git(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Xu),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=yd){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof Xu||t===this.renderer)continue;this[e].dispose()}}}},tk=class extends Ra{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new tit,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Wr(1,1,{minFilter:dr,magFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==na?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===nr&&(this.renderTarget.texture.encoding=nr))}},vit=class extends Ra{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},gD=new zt,Rj=class extends Ra{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,c=a>=0;l?(gD.copy(e.getClearColor(gD)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(gD,o):c&&e.setClearAlpha(o)}},Ld=-1,Wa=class extends Ls{constructor(e,t=Ld,r=Ld,i=1){super(),this.resizable=e,this.base=new oe(1,1),this.preferred=new oe(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==Ld?i=t.width:t.height!==Ld?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==Ld?i=t.height:t.width!==Ld?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Ld),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Ld}},vD=!1,f7=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case $a:r=this.materialsFlatShadedDoubleSide;break;case is:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case $a:r=this.materialsDoubleSide;break;case is:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=Yl;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=is,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=$a,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=is,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=$a,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,vD){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return vD}static set workaroundEnabled(e){vD=e}},yit=class extends Ra{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Rj,this.overrideMaterialManager=r===null?null:new f7(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new f7(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,d=e.shadowMap.autoUpdate,u=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=d}},p7=class extends Ra{constructor(e,t,{resolutionScale:r=1,width:i=Wa.AUTO_SIZE,height:n=Wa.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new yit(e,t,new Fne({depthPacking:Cne}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new zt(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Wr(1,1,{minFilter:Hr,magFilter:Hr,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Wa(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},Pr={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},bit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",xit="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",wit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",_it="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Sit="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Eit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",Cit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",Ait="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",Tit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",Mit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",Pit="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Iit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",Rit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",Dit="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Oit="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Lit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",Nit="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",kit="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",zit=new Map([[Pr.SKIP,null],[Pr.ADD,bit],[Pr.ALPHA,xit],[Pr.AVERAGE,wit],[Pr.COLOR_BURN,_it],[Pr.COLOR_DODGE,Sit],[Pr.DARKEN,Eit],[Pr.DIFFERENCE,Cit],[Pr.EXCLUSION,Ait],[Pr.LIGHTEN,Tit],[Pr.MULTIPLY,Mit],[Pr.DIVIDE,Pit],[Pr.NEGATION,Iit],[Pr.NORMAL,Rit],[Pr.OVERLAY,Dit],[Pr.REFLECT,Oit],[Pr.SCREEN,Lit],[Pr.SOFT_LIGHT,Nit],[Pr.SUBTRACT,kit]]),Bit=class extends Ls{constructor(e,t=1){super(),this.f=e,this.opacity=new Ye(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return zit.get(this.blendFunction)}},Wc={NONE:0,DEPTH:1,CONVOLUTION:2},au=class extends Ls{constructor(e,t,{attributes:r=Wc.NONE,blendFunction:i=Pr.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new Bit(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=yd){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof Xu||t===this.renderer)continue;this[e].dispose()}}}};function m7(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let a of r.entries())a[1]!==null&&r.set(a[0],a[1].replace(s,n))}}function Fit(e,t,r,i,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),c=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),d=[],u=[],h=!1,f=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&a&Wc.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=ek.Section;if(c){let v=`	${e}MainUv(UV);
`;r.set(m.FRAGMENT_MAIN_UV,r.get(m.FRAGMENT_MAIN_UV)+v),h=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,r.set(m.VERTEX_MAIN_SUPPORT,r.get(m.VERTEX_MAIN_SUPPORT)+v),d=d.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),u=u.concat(d).concat([...o.get("vertex").matchAll(p)].map(y=>y[1]))}u=u.concat([...o.get("fragment").matchAll(p)].map(v=>v[1])),u=u.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,y)=>s.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),t.defines.forEach((v,y)=>n.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),m7(e,u,n),m7(e,u,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;a&Wc.DEPTH&&v.test(o.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let b=e+"BlendOpacity";s.set(b,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${b});

	`,r.set(m.FRAGMENT_MAIN_IMAGE,r.get(m.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${b};

`,r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+y)}r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&r.set(m.VERTEX_HEAD,r.get(m.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:d,transformedUv:h,readDepth:f}}var oT=class extends Ra{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new ek(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=ek.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,s=new Set,a=0,o=0,l=0,c=!1,d=!1;for(let h of this.effects)if(h.blendMode.blendFunction===Pr.SKIP)l|=h.getAttributes()&Wc.DEPTH;else if(l&h.getAttributes()&Wc.CONVOLUTION)console.error("Convolution effects cannot be merged",h);else{l|=h.getAttributes();let f="e"+a++,p=Fit(f,h,t,r,i,n,l);if(o+=p.varyings.length,c=c||p.transformedUv,d=d||p.readDepth,h.extensions!==null)for(let m of h.extensions)s.add(m)}let u=/\bblend\b/g;for(let h of r.values()){let f=h.getShaderCode().replace(u,`blend${h.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+f+`
`)}if(l&Wc.DEPTH){if(d){let h=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,h+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let h=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,h+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach((h,f,p)=>p.set(f,h.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=yd){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==na&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},jit=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Dj=class extends Ra{constructor({resolutionScale:e=.5,width:t=Wa.AUTO_SIZE,height:r=Wa.AUTO_SIZE,kernelSize:i=QM.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Wr(1,1,{minFilter:dr,magFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new Wa(this,t,r,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new h7,this.ditheredBlurMaterial=new h7,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=jit[this.kernelSize],d=this.blurMaterial,u=t,h,f;for(this.fullscreenMaterial=d,h=0,f=c.length-1;h<f;++h){let p=h&1?l:o;d.kernel=c[h],d.inputBuffer=u.texture,e.setRenderTarget(p),e.render(s,a),u=p}this.dithering&&(d=this.ditheredBlurMaterial,this.fullscreenMaterial=d),d.kernel=c[h],d.inputBuffer=u.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==na?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===nr&&(this.renderTargetA.texture.encoding=nr,this.renderTargetB.texture.encoding=nr))}static get AUTO_SIZE(){return Wa.AUTO_SIZE}},Vit=class extends Ra{constructor({width:e=Wa.AUTO_SIZE,height:t=Wa.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new cit(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new Wr(1,1,{minFilter:dr,magFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Wa(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==na&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Uit=class extends Ra{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Rj(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,d=this.inverted?0:1,u=1-d;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,d,4294967295),a.stencil.setClear(u),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Ml=class extends Ra{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==na&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},yD=1/1e3,$it=1e3,Hit=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*yD}getFixedDelta(){return this.fixedDelta*yD}setFixedDelta(e){return this.fixedDelta=e*$it,this}getElapsed(){return this.elapsed*yD}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},QM={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Wit=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,Git=class extends au{constructor({blendFunction:e=Pr.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:s=Wa.AUTO_SIZE,height:a=Wa.AUTO_SIZE,kernelSize:o=QM.LARGE}={}){super("BloomEffect",Wit,{blendFunction:e,uniforms:new Map([["map",new Ye(null)],["intensity",new Ye(n)]])}),this.renderTarget=new Wr(1,1,{minFilter:dr,magFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new Vit({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new Dj({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===nr&&(this.renderTarget.texture.encoding=nr))}},qit="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",Xit=class extends au{constructor({blendFunction:e=Pr.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",qit,{blendFunction:e,uniforms:new Map([["brightness",new Ye(t)],["contrast",new Ye(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},Yit="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",Kit=class extends au{constructor(e=Pr.NORMAL){super("ColorAverageEffect",Yit,{blendFunction:e})}},Qit="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",Zit="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",Jit=class extends au{constructor({blendFunction:e=Pr.NORMAL,offset:t=new oe(.001,5e-4)}={}){super("ChromaticAberrationEffect",Qit,{vertexShader:Zit,blendFunction:e,attributes:Wc.CONVOLUTION,uniforms:new Map([["offset",new Ye(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},ent=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,tnt=class extends au{constructor(e,{blendFunction:t=Pr.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=Wa.AUTO_SIZE,height:c=Wa.AUTO_SIZE}={}){super("DepthOfFieldEffect",ent,{blendFunction:t,attributes:Wc.DEPTH,uniforms:new Map([["nearColorBuffer",new Ye(null)],["farColorBuffer",new Ye(null)],["nearCoCBuffer",new Ye(null)],["scale",new Ye(1)]])}),this.camera=e,this.renderTarget=new Wr(1,1,{minFilter:dr,magFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Ml(new Qrt(e));let d=this.cocMaterial;d.focusDistance=n,d.focusRange=a,r!==void 0&&(d.worldFocusDistance=r),i!==void 0&&(d.worldFocusRange=i),this.blurPass=new Dj({kernelSize:QM.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new Ml(new dit(this.renderTargetCoC.texture));let h=this.maskPass.fullscreenMaterial;h.maskFunction=ele.MULTIPLY,h.colorChannel=Joe.GREEN,this.bokehNearBasePass=new Ml(new RS(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Ml(new RS(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Ml(new RS(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Ml(new RS(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return JN(-r,t.near,t.far)}setDepthTexture(e,t=yd){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,na),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===nr&&(this.renderTarget.texture.encoding=nr,this.renderTargetNear.texture.encoding=nr,this.renderTargetFar.texture.encoding=nr,this.renderTargetMasked.texture.encoding=nr))}};new L;new Ke;var rnt="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",int=class extends au{constructor({blendFunction:e=Pr.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",rnt,{blendFunction:e,uniforms:new Map([["hue",new Ye(new L)],["saturation",new Ye(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new zt;var nnt=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,snt=class extends au{constructor({blendFunction:e=Pr.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",nnt,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},ant="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",ont=class extends au{constructor(e=30){super("PixelationEffect",ant,{uniforms:new Map([["active",new Ye(!1)],["d",new Ye(new oe)]])}),this.resolution=new oe,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new L;new L;var g7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",v7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",lnt="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",cnt="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Df={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},tle=class extends au{constructor({preset:e=Df.MEDIUM,edgeDetectionMode:t=KM.COLOR,predicationMode:r=nit.DISABLED}={}){super("SMAAEffect",lnt,{vertexShader:cnt,blendFunction:Pr.NORMAL,attributes:Wc.CONVOLUTION|Wc.DEPTH,uniforms:new Map([["weightMap",new Ye(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Wr(1,1,{minFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new Rj(!0,!1,!1),this.clearPass.overrideClearColor=new zt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Ml(new sit),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new Ml(new pit);let s=new nse;s.onLoad=()=>{let a=new Li(i);a.name="SMAA.Search",a.magFilter=Hr,a.minFilter=Hr,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new Li(n);o.name="SMAA.Area",o.magFilter=dr,o.minFilter=dr,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),i.src=g7,n.src=v7),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case Df.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Df.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Df.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case Df.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=yd){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return g7}static get areaImageDataURL(){return v7}},unt=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,DS={DEFAULT:0,ESKIL:1},dnt=class extends au{constructor({blendFunction:e=Pr.NORMAL,technique:t=DS.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",unt,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ye(i)],["darkness",new Ye(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===DS.ESKIL}set eskil(e){this.technique=e?DS.ESKIL:DS.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},bd=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Pr.NORMAL}},hnt=class extends bd{constructor(){super(Git),this.blendFunction=Pr.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},fnt=class extends bd{constructor(){super(Xit)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},pnt=class extends bd{constructor(){super(Jit),this.effect.offset=new oe(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},mnt=class extends bd{constructor(){super(Kit)}},gnt=class extends bd{constructor(){super(int),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},vnt=class extends bd{constructor(){super(snt),this.blendFunction=Pr.OVERLAY}},ynt=class extends bd{constructor(){super(dnt)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},bnt=class extends bd{constructor(e){super(tnt,e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}},xnt=class extends bd{constructor(){super(ont)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},wnt=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,_nt=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,Snt=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,Ent=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,rk=class extends Gr{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new Ye(null)},blending:Tn,depthWrite:!1,depthTest:!1,vertexShader:Snt,fragmentShader:Ent})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},Cnt=class extends Ra{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new rk,this.resolutionVector=new oe,this.resolveMaterial=new Gr({name:"TAAResolveMaterial",uniforms:{inputBuffer:new Ye(null),historyBuffer:new Ye(null),velocityBuffer:new Ye(null),depthBuffer:new Ye(null),resolution:new Ye(new oe)},blending:Tn,depthWrite:!1,depthTest:!1,vertexShader:wnt,fragmentShader:_nt}),this.historyRenderTarget=new Wr(1024,1024,{minFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Wr(1024,1024,{minFilter:dr,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},Ant=class extends Ra{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new p7(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new rk,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new rk,this.depthPass=new p7(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},y7=new Xu,Tnt=new Gr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),ik=class extends Ra{constructor(e,t,r){super("OpaquePass",t??y7,r),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}set splatViewer(e){this._splatViewer=e}get splatViewer(){return this._splatViewer}setCamera(e){this.camera=e}setScene(e){this.scene=e??y7}getScene(){return this.scene}render(e,t){var i;this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(n=>{n.layers.isEnabled(3)&&n instanceof Ca&&(this.originalMaterials.set(n.id,n.material),n.material=Tnt)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;if(e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),((i=this._splatViewer)==null?void 0:i.splatRenderingInitialized)===!0){let n=e.autoClear;e.autoClear=!1,e.render(this.scene,this.camera),this._splatViewer.update(),e.render(this._splatViewer.splatMesh,this.camera),e.autoClear=n}else e.render(this.scene,this.camera);this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((n,s)=>{let a=this.scene.getObjectById(s);a&&(a.material=n)})}},Mnt=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new tk,this.depthTexture=null,this.timer=new Hit,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let r=e.getSize(new oe),i=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===na&&e.outputEncoding===nr&&(this.inputBuffer.texture[0].encoding=nr,this.outputBuffer.texture[0].encoding=nr,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(r.width,r.height,!1);for(let s of this.passes)s.initialize(e,i,n)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new Xv(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=zp,e.type=lp):e.type=Uu,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,s){let a=this.renderer,o=a===null?new oe:a.getDrawingBufferSize(new oe),l={minFilter:dr,magFilter:dr,wrapS:Si,wrapT:Si,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new Wr(o.width,o.height,l),c.samples=i):(n?(c=new hVe(o.width,o.height,2,l),c.texture[1].type=kp):c=new Wr(o.width,o.height,l),c.depthTexture=new Xv(2048,2048),c.depthTexture.type=Cn),r===na&&a!==null&&a.outputEncoding===nr&&(Array.isArray(c.texture)?c.texture.forEach(d=>d.encoding=nr):c.texture.encoding=nr),Array.isArray(c.texture)?c.texture.forEach((d,u)=>{d.name=`EffectComposer.Buffer ${n} ${u}`,d.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){var o;let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new oe),s=((o=i.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,s,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,s)=>n||s.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,c,d,u;e===void 0&&(e=this.timer.update().getDelta());for(let h of this.passes)h.enabled&&(h.MRTCompatible?h.render(t,i,n,e,o):h.render(t,s,a,e,o),h.needsSwap&&(o&&(r.renderToScreen=h.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,o),c.setFunc(l.EQUAL,1,4294967295)),d=i,u=s,i=n,s=a,n=d,a=u),h instanceof Uit?o=!0:h instanceof vit&&(o=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=i.getSize(new oe);e=s.width,t=s.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new oe);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Pnt=new Gr({name:"CombineMaterial",uniforms:{inputBufferA:new Ye(null),inputBufferB:new Ye(null)},blending:Tn,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),Int=class extends Ra{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=Pnt,this.helperPass=new ik(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new ik(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new tle({preset:Df.LOW,edgeDetectionMode:KM.COLOR});this.effectPass=new oT(this.camera,t),this.rt=new Wr(10,10,{minFilter:dr,magFilter:dr,wrapS:Si,wrapT:Si,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},Rnt=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Dnt=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Ont=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,Lnt=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,Nnt=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,knt=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,Hy=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],znt=new Gr({vertexShader:Rnt,fragmentShader:Dnt}),OS=new Gr({vertexShader:Nnt,fragmentShader:knt,uniforms:{texture_ao_lrez:new Ye(null),texture_depth_lrez:new Ye(null),texture_depth_hrez:new Ye(null),near:new Ye(null),far:new Ye(null)}}),Bnt=class extends Ra{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new Wr(r,i,{type:Cn,depthTexture:new Xv(r,i),minFilter:dr,magFilter:dr}),this.depthBufferHighRes=new Wr(r,i,{depthTexture:new Xv(r,i)}),this.aoBuffer=new Wr(r,i,{minFilter:dr,magFilter:dr}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(Hy.length*2);for(let a=0;a<Hy.length;a++){let o=a*2;n[o+0]=Hy[a][0],n[o+1]=Hy[a][1]}this.blueNoiseInDiskTexture=new Qo(n,Hy.length,1,hA,Cn),this.blueNoiseInDiskTexture.wrapS=Vu,this.blueNoiseInDiskTexture.wrapT=Vu,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Gr({vertexShader:Ont,fragmentShader:Lnt,uniforms:{near:new Ye(null),far:new Ye(null),fov:new Ye(null),proj_info:new Ye(new Yt),is_ortho:new Ye(!1),resolution:new Ye(new oe),radius_of_influence:new Ye(8),radius_in_screen_space:new Ye(1),exponent:new Ye(1),ao_color:new Ye(new L),bias:new Ye(.5),texture_depth:new Ye(null),texture_normals:new Ye(null),texture_blue_noise:new Ye(null),texture_blue_noise_in_disk:new Ye(this.blueNoiseInDiskTexture),frame_index:new Ye(0),fog_enabled:new Ye(!1),fog_near:new Ye(1),fog_far:new Ye(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Wr(r,i,{minFilter:dr,magFilter:dr,wrapS:Si,wrapT:Si,depthBuffer:!1,type:Cn});let s=new tle({preset:Df.ULTRA,edgeDetectionMode:KM.COLOR});this.effectPass=new oT(this.camera,s)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}render(e,t,r){this.splineScene.overrideMaterial=znt;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),d=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),u=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*d;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),d=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=d,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=OS,OS.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,OS.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,OS.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Fnt=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,jnt=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,Vnt=class extends Ml{constructor(){super(new Gr({vertexShader:Fnt,fragmentShader:jnt,uniforms:{tInput:new Ye(null),tMap:new Ye(null),uResolution:new Ye(new oe),uSize:new Ye(new oe),uCoords:new Ye(new oe),uScale:new Ye(1),uSceneColor:new Ye(new zt(16711680)),uDPR:new Ye(1),uCurrent:new Ye(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},Unt=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$nt=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,Hnt=[],Wnt=class extends Ml{constructor(){super(new Gr({vertexShader:Unt,fragmentShader:$nt,uniforms:{toScene:new Ye(null),fromScene:new Ye(null),uResolution:new Ye(new oe),uDPR:new Ye(1),mixRatio:new Ye(0),threshold:new Ye(.1),useTexture:new Ye(0),tMixTexture:{value:Hnt[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},Gnt=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qnt=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
	gl_FragColor.a = 1.0;
}
`,Xnt=class extends Ml{constructor(){super(new Gr({vertexShader:Gnt,fragmentShader:qnt,uniforms:{inputBuffer:new Ye(null),blurredInputBuffer:new Ye(null),overlay:new Ye(null),uResolution:new Ye(new oe),uDPR:new Ye(1),blurIntensity:new Ye(0)}})),this._blurEnabled=!1,this.blurTarget=new Wr(1,1,{minFilter:dr,magFilter:dr,wrapS:Si,wrapT:Si}),this.blurPass=new Dj({width:window.innerWidth,height:window.innerHeight,kernelSize:QM.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,r=1){this.uniforms.uResolution.value.set(e,t).divideScalar(r),this.uniforms.uDPR.value=r,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let r=t.data.backgroundBlur,i=r.radius;this._blurEnabled=r.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=i/3}}render(e,t,r,i,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,n)),super.render(e,t,r,i,n)}};function b7(e,t){return t&&t.enabled&&e.push(t.effect),e}var Ynt=e=>Object.values(Pr).includes(e)?e:Pr.NORMAL,Knt=class extends Ls{constructor(e){super(),this.postprocessingState=WA.defaultData,this._scene=new Xu,this._camera=new Js,this.effects=new Map,this.blueNoiseTexture=new Qo,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new nWe,this.renderer=e,this.debug=!1,this.effects.set("bloom",new hnt),this.effects.set("chromaticAberration",new pnt),this.effects.set("vignette",new ynt),this.effects.set("noise",new vnt),this.effects.set("colorAverage",new mnt),this.effects.set("hueSaturation",new gnt),this.effects.set("brightnessContrast",new fnt),this.effects.set("depthOfField",new bnt),this.effects.set("pixelation",new xnt),this.effectComposer=new Mnt(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new ik(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new Ant(this.scene,this.camera,this.renderer),this.aoPass=new Bnt(this.scene,this.camera),this.taaPass=new Cnt,this.taaPass.renderToScreen=!1,this.helperPass=new Int(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new Vnt,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new Xnt,this.uiOverlayPass.enabled=!1,this.sceneTransitionPass=new Wnt,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),this.aoPass.setCamera(e),this.helperPass.setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new Qo(e,128,128),this.blueNoiseTexture.wrapS=Vu,this.blueNoiseTexture.wrapT=Vu,this.blueNoiseTexture.minFilter=Hr,this.blueNoiseTexture.magFilter=Hr,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let r=[this.effects.get("pixelation")].reduce(b7,[]);r.length>0&&(this.uvEffectPass=new oT(this.camera,...r),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let i=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(b7,[]);i.length>0&&(this.effectPass=new oT(this.camera,...i),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new oe;this.renderer.getDrawingBufferSize(e),this._rt=new Wr(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Vu,wrapT:Vu}),this._rt.samples=0,this._savePass=new tk(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new tk(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let s=n[1],a=this.effects.get(n[0]);if(a){a.enabled!==s.enabled&&(i=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=Ynt(l):a[o]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof Yt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof Yt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},Qnt=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,Znt=cr.lights_fragment_begin,Jnt=cr.shadowmask_pars_fragment,x7=null,est=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},tst=(e="medium")=>{if(x7===e)return!1;x7=e;let t=est(e);cr.shadowmap_pars_fragment=Qnt(t);let r=Znt.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),cr.lights_fragment_begin=r;let i=Jnt.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),cr.shadowmask_pars_fragment=i,!0},rst=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,ist=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,bD=new Gr({vertexShader:rst,fragmentShader:ist,uniforms:{depthContrast:{value:1}}}),w7=new Li,nst=class extends jne{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new oe,this.pipeline=new Knt(this),this.dummyCamera=new Js,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;n&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=y4,this.dummyCamera.matrixAutoUpdate=!1;let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,s,a=!0)=>{var o,l;(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,r(n,s,a),(o=this.normalRenderTarget)==null||o.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Wr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:dr,magFilter:dr,wrapS:Si,wrapT:Si,depthBuffer:!1}))}_resizeTransmission(e,t){var r,i;(r=this.transmissionRenderTarget)==null||r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(i=this.aoRenderTarget)==null||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return jt.transmissionLod.value===1}set hdTransmission(e){jt.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Wr(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:Gv,magFilter:dr,wrapS:Si,wrapT:Si,depthBuffer:!1}),this.transmissionDepthTarget=new Wr(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Hr,magFilter:Hr,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Wr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Hr,magFilter:Hr,type:Cn,depthTexture:new Xv(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof Js?bD.uniforms.depthContrast.value=(r.far-r.near)/1e4:bD.uniforms.depthContrast.value=1,t.overrideMaterial=bD,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?fk:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,n=t.width,s=this.viewportWidth/this.viewportHeight;n<i?n=i*s:i=n/s,this.dummyCamera.setViewplaneSize(n,i);for(let a=0;a<r;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:r=void 0,sceneHelpersOnTop:i=void 0,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){var h;let a=e instanceof Fj?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((f,p)=>{jt.penumbraSize.value[p]=f}),jt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?jt.resolution.value.set(this.resolution.x,this.resolution.y):jt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(jt.normalRenderTarget.value=s,jt.normalRenderTargetDepth.value=w7):l.needsNormal()&&(this.createNormalRenderTarget(),jt.normalRenderTarget.value=this.normalRenderTarget.texture,jt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,d=c.occlusion;d&&(this.createAORenderTarget(),jt.aoRenderTarget.value=this.aoRenderTarget.texture),jt.aoEnabled.value=d,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,c.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((h=a.uiCanvas)!=null&&h.enabled)&&a.uiCanvas.texture&&a.uiCanvas.texture.image.width>0?((a.uiCanvas.width!==this.viewportWidth||a.uiCanvas.height!==this.viewportHeight)&&a.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight}),a.uiCanvas.render(),this.pipeline.uiOverlayPass.uiCanvas=a.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(this.domElement.width,this.domElement.height,window.devicePixelRatio),this.pipeline.updateRenderToScreen()):(this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen());let u=!1;if(n!==void 0)jt.transmissionRenderTarget.value=n,jt.transmissionRenderTargetDepth.value=w7,this.pipeline.setTransmissionPassEnabled(!1);else{let f=l.needsTransmission();f&&(this.transmissionRenderTarget===void 0&&(u=!0),this.createTransmissionRenderTarget(),jt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,jt.aspectRatio.value=ftt(this.viewportWidth,this.viewportHeight),jt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(f)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=a,this.pipeline.camera=t,u&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),a.overrideMaterial=l.wireframeState?fk:null,this.pipeline.render(),jt.frameIndex.value=(jt.frameIndex.value+1)%16,t instanceof Js&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,i,n,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(r=this.transmissionDepthTarget)==null||r.dispose(),(i=this.normalRenderTarget)==null||i.dispose(),(s=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose()}},rle=class extends Sw(xWe){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){Ew(this.object,rle.geometryHelper,e,t)}},ile=class extends Sw(bWe){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){Ew(this.object,ile.geometryHelper,e,t)}},nk=class extends Sw(yWe){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){Ew(this.object,nk.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=nk._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},nle=nk;nle._vector=new L;function sst(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var sle=class extends Ij(iWe,rle){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new EA(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof EA&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&sst(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},_7=new L,S7=new L,E7=new Xt,ale=class extends Ij(JHe,nle){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=Et.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new EA(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof EA&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),S7.setFromMatrixPosition(this.matrixWorld),E7.setFromRotationMatrix(this.matrixWorld),_7.copy(this.up).applyQuaternion(E7).negate().multiplyScalar(this.distance),this.target.position.copy(S7).add(_7),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Zr;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function r(w,E=e.identity()){for(let C=0,T=w.length;C<T;C++)E[C]=w[C];return E}e.copy=r;function i(w,E,C,T,A,M){return e.setAbcdef(e.identity(),w,E,C,T,A,M)}e.create=i;function n(w,E,C,T,A,M,P){return w[0]=E,w[1]=T,w[2]=M,w[3]=C,w[4]=A,w[5]=P,w}e.setAbcdef=n;function s(w,E){let[C,T,A,M,P,I]=o(w),[R,N,k,O,D,B]=o(E),z=R*C+N*A,F=R*T+N*M,V=k*C+O*A,Y=k*T+O*M,W=D*C+B*A+P,X=D*T+B*M+I;return e.create(z,F,V,Y,W,X)}e.append=s;function a(w,E){let[C,T,A,M,P,I]=o(w),[R,N,k,O,D,B]=o(E),z=C,F=T,V=A,Y=M;(R!==1||N!==0||k!==0||O!==1)&&(z=C*R+T*k,F=C*N+T*O,V=A*R+M*k,Y=A*N+M*O);let W=P*R+I*k+D,X=P*N+I*O+B;return e.create(z,F,V,Y,W,X)}e.prepend=a;function o(w){return[w[0],w[3],w[1],w[4],w[2],w[5]]}e.getAbcdef=o;function l(w){let[E,C,T,A,M,P]=e.getAbcdef(w),I=E*A-C*T,R=A/I,N=-C/I,k=-T/I,O=E/I,D=(T*P-A*M)/I,B=-(E*P-C*M)/I;return e.create(R,N,k,O,D,B)}e.invert=l;function c([w,E],C){let[T,A,M,P,I,R]=e.getAbcdef(C);return[T*w+M*E+I,A*w+P*E+R]}e.apply=c;function d(w,E){let[C,T,A,M,P,I]=e.getAbcdef(E),R=1/(C*M+A*-T),[N,k]=w;return[M*R*N+-A*R*k+(I*A-P*M)*R,C*R*k+-T*R*N+(-I*C+P*T)*R]}e.applyInverse=d;function u(w,E,C=E){let[T,A,M,P,I,R]=e.getAbcdef(w);return e.setAbcdef(w,T*E,A*C,M*E,P*C,I*E,R*C),w}e.scale=u;function h(w,E){let C=Math.cos(E),T=Math.sin(E),[A,M,P,I,R,N]=e.getAbcdef(w);return e.setAbcdef(w,A*C-M*T,A*T+M*C,P*C-I*T,P*T+I*C,R*C-N*T,R*T+N*C),w}e.rotate=h;function f(w,E,C){let[T,A]=C,M=e.translate(w,-T,-A);return M=e.rotate(M,E),M=e.translate(M,T,A),M}e.rotateAround=f;function p(w,E,C){let[T,A,M,P,I,R]=e.getAbcdef(w);return e.setAbcdef(w,T,A,M,P,I+E,R+C),w}e.translate=p;function m(w,E,C){let[T,A,M,P]=e.getAbcdef(w);return e.setAbcdef(w,T,A,M,P,E,C),w}e.setTranslate=m;function g(w,E,C){let[T,A,M,P]=e.getAbcdef(w);return e.setAbcdef(w,T,A,M,P,E,C),w}e.setPosition=g;function v(w){let[E,C,T,A]=e.getAbcdef(w),M=Math.sqrt(E*E+C*C),P=Math.sqrt(T*T+A*A);return[M,P]}e.getScale=v;function y(w){let[,,,,E,C]=e.getAbcdef(w);return[E,C]}e.getPosition=y;function b(w,E){return e.decompose(w,E).rotation}e.getRotation=b;function x(w,E){let[C,T,A,M,P,I]=e.getAbcdef(w),R=-Math.atan2(-A,M),N=Math.atan2(T,C),k=Math.abs(R+N),O=0,D=[0,0];k<1e-5||Math.abs(Math.PI*2-k)<1e-5?(O=N,D[0]=D[1]=0):(O=0,D[0]=R,D[1]=N);let B=[Math.sqrt(C*C+T*T),Math.sqrt(A*A+M*M)];return{position:[P+(E[0]*C+E[1]*A)-E[0],I+(E[0]*T+E[1]*M)-E[1]],scale:B,rotation:O,skew:D,pivot:E}}e.decompose=x;function S(w,E,C,T,A=[0,0]){let[M,P]=w,[I,R]=E,[N,k]=T,[O,D]=A,B=Math.cos(C+D)*I,z=Math.sin(C+D)*I,F=-Math.sin(C-O)*R,V=Math.cos(C-O)*R,Y=M-(N*B+k*F)+N,W=P-(N*z+k*V)+k;return e.create(B,z,F,V,Y,W)}e.compose=S})(Zr||(Zr={}));var ast=Math.PI/180;function ost(e,t,r,i,n,s){let a=e-r,o=t-i;return a*a/(n*n)+o*o/(s*s)<=1}function lst(e){return e*ast}function cst(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map(function(n){n(r)}),(i=e.get("*"))&&i.slice().map(function(n){n(t,r)})}}}var Un=class{constructor(e,t,r){this.uuid=e,this.data=t,this.localMatrix=Zr.identity(),this.worldMatrix=Zr.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new sk,this._recursiveBBox=new sk,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.emitter=cst(),this.dpr=r.dpr??1,this.dataPatched=t}project(e,t){let r=this.worldMatrix;return t&&(r=Zr.append(t.worldMatrix,r)),Zr.applyInverse(e,r)}intersects(e,t,r,i=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],r),i)}intersectsInLocalSpace(e,t,r=!1){let{min:i,max:n}=r?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=n[0]&&t>=i[1]&&t<=n[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=Zr.compose(this.position,this.scale,lst(this.rotation),hp.getPivot(this.dataPatched))}updateWorldMatrix(e,t,r){let i=this.parent;t&&i!==null&&i!==void 0&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=Zr.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=Zr.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return hp.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,r){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,n=ci(e.path,["states","*"]);if(n!==null){if(e.type===0){let[s]=n;if((this==null?void 0:this.stateSelection)===s){let a={...e.props};if(delete a.name,Object.values(e.props).some(o=>o===void 0)){let o=this.data;if(o!==void 0){let l=ws.zoom(o,e.path.slice(2));if(l)for(let c in e.props)e.props[c]===void 0&&c in l&&(a[c]=l[c])}}i={...e,props:a,path:e.path.slice(2)}}}}else if(e.type===0){let s=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(s!==void 0){if(e.props.name!==void 0&&s.name){let{name:o,...l}=s;s=l}let a=ws.removeOverridden(e.path,e.props,s);i={...e,props:a}}}this.updateByPatchedOpBase(i,Xf.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r)}changeSelectedState(e,t,r=!1){if(!(this.data.states.length===0&&!r)){for(let i of this.data.states)Xf.toOps(this.data,i.data).forEach(n=>{let s=NA.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(s,this.data,t)});if(e!==null){let i=this.data.states.data(e);i&&(this.dataPatched=Xf.patch(this.data,i),Xf.toOps(this.data,i).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,t)}))}r&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,r){this.dataPatched=t,this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){e.path.length===0&&e.type===0&&this.updateState(e.props,r),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Un(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let r=t.indexOf(this)+1;return t[r]?t[r]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Un&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},Oc=class extends Un{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.context=r,this.children=[]}add(e){e.parent&&e.parent instanceof Oc&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let r of this.children)r instanceof Oc?r.traverse(e):t=e(r)}intersectsChildren(e,t,r,i=!1,n=[],s=!1){for(let a of this.children){let o=a instanceof fd;if(a instanceof Oc&&!o&&s&&a.intersectsChildren(e,t,r,i,n,!1),a.intersects(e,t,r,o)&&(n.push(a),i))break}return n}updateWorldMatrix(e,t,r){if(super.updateWorldMatrix(e,t,r),r&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(r=>{r.uuid===e&&(t=r)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new Oc(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},fd=class extends Oc{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.updateState(t,r)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new fd(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}};function ust(e,t){let[[r,i],[n,s]]=e,[[a,o],[l,c]]=t,d=(r-n)*(o-c)-(i-s)*(a-l);if(d===0)return!1;let u=((r-a)*(o-c)-(i-o)*(a-l))/d,h=-((r-n)*(i-o)-(i-s)*(r-a))/d;return u>=0&&u<=1&&h>=0&&h<=1}var ole=[[-1,1],[-1,-1],[1,-1],[1,1]],C7=(e,t,r)=>{let i=e.getCenter(),n=e.getHalfSize(),s=Zr.append(t,e.worldMatrix);n[0]===0&&n[1]===0?r.push(Zr.apply(i,s)):ole.forEach(a=>{let o=[a[0]*n[0]+i[0],a[1]*n[1]+i[1]];r.push(Zr.apply(o,s))})},sk=class{constructor(){this.matrix=Zr.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),Zr.copy(e.worldMatrix,this.matrix);let r=Zr.invert(e.worldMatrix);this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];r===!0&&e instanceof Oc?e.traverse(n=>{n.visible&&C7(n,t,i)}):C7(e,t,i),this.setFromPoints(i)}getCenter(){let[e,t]=this.min,[r,i]=this.getHalfSize();return Zr.apply([e+r,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),r=this.getCenter(),[i,n,s,a]=Zr.getAbcdef(this.matrix),o=Zr.create(i,n,s,a,r[0],r[1]);this.vertices=ole.map(([l,c])=>Zr.apply([l*e,c*t],o))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let r=this.matrix;return t&&(r=Zr.append(t.worldMatrix,r)),Zr.applyInverse(e,r)}intersects(e,t,r){return this.intersectsInLocalSpace(...this.project([e,t],r))}intersectsInLocalSpace(e,t){let{min:r,max:i}=this;return e>=r[0]&&e<=i[0]&&t>=r[1]&&t<=i[1]}containsPoint(e){let[t,r]=e,[i,n]=this.min,[s,a]=this.max;return t>=i&&t<=s&&r>=n&&r<=a}intersectsBBox2D(e){for(let t=0,r=this.edges.length;t<r;t++){let i=this.edges[t];for(let n=0,s=e.edges.length;n<s;n++){let a=e.edges[n];if(ust(i,a))return!0}}for(let t=0,r=e.vertices.length;t<r;t++){let i=e.vertices[t];if(this.containsPoint(i))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],Zr.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new sk;return e.copy(this),e}},lle,dst=new Promise(e=>{lle=e}),A7=!1,LS;function hst(){if(A7)return;if(LS)return LS;async function e(){let t=await R0(()=>import("./ui-dad2f740.js"),[],import.meta.url);lle(t.default??t),A7=!0}return LS=e(),LS}function T7(e){let t=!1;return e.scene.objects.traverse((r,i)=>{(i.type==="Mesh"&&i.geometry.type==="UIGeometry"||i.type==="Page"&&i.uiFrame!==void 0)&&(t=!0)}),t}var Qt,xD;async function fst(e){let t=await dst;Qt||(xD||(xD=t({locateFile:()=>e})),Qt=await xD)}var M7=Zr.identity(),P7=class{constructor(e,t=1){this.canvas=e,this.dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=ei.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=ei.transparent,this._fonts=new Map;try{let r=e.getBoundingClientRect();e.width=r.width*t,e.height=r.height*t}catch{console.log(e.width,t)}this._currentM3Transform=M7,this._currentTransform=new Float32Array(M7)}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await fst(this.wasmURL),this._surface=Qt.MakeWebGLCanvasSurface(this.canvas),this.ctx=(e=this._surface)==null?void 0:e.getCanvas(),this._paint=new Qt.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(Qt.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(Qt.PaintStyle.Stroke),(t=this.ctx)==null||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let r=await(await fetch(e)).arrayBuffer();this.registerFont(r,t)}registerFont(e,t){if(this._fonts.has(t))return;let r=Qt.FontMgr.FromData(e);if(r)this._fonts.set(t,r);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(NS(e),Qt.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(NS(e),Qt.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;(e=this.ctx)==null||e.clear(Qt.TRANSPARENT)}save(){var e;(e=this.ctx)==null||e.save()}restore(){var e;(e=this.ctx)==null||e.restore()}beginPath(){var e;(e=this._currentPath)==null||e.delete(),this._currentPath=new Qt.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,r,i,n=0,s=0,a=0,o=0){var c,d;let l=Qt.XYWHRect(e,t,r,i);if(n===0&&s===0&&o===0&&a===0)(c=this.ctx)==null||c.clipRect(l,Qt.ClipOp.Intersect,!0);else{let u=Qt.RRectXY(l,n,n);u[4]=u[5]=n,u[6]=u[7]=s,u[8]=u[9]=a,u[10]=u[11]=o,(d=this.ctx)==null||d.clipRRect(u,Qt.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=Zr.invert(this.currentTransform);this.ctx.concat(e);let t=Zr.translate(Zr.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,r=!0){var i,n,s,a;if(this.ctx&&this._currentPath){let o,l=!1;if(r&&this._hasDropShadow()){let c=e.copy();c.setColor(NS(this._dropShadowColor));let d;this._dropShadowBlur>0&&(d=Qt.MaskFilter.MakeBlur(Qt.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((i=this.camera)==null?void 0:i.scale)??1),!1),c.setMaskFilter(d)),this.ctx.save(),this.ctx.clipPath(this._currentPath,Qt.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(c),this.ctx.restore(),c.delete(),d==null||d.delete()}if(this._backgroundBlur>0&&r){this.ctx.save(),this.ctx.clipPath(this._currentPath,Qt.ClipOp.Intersect,!0);let c=Qt.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,Qt.TileMode.Clamp,null),d=e.copy();d.setImageFilter(c),d.setAlphaf(1);let u=this._currentPath.computeTightBounds();this.ctx.saveLayer(d,u,null,Qt.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),d.delete(),c.delete(),l=!0}if(this._layerBlur>0){let c=e.copy();o=Qt.MaskFilter.MakeBlur(Qt.BlurStyle.Normal,this._layerBlur*this.dpr*(((n=this.camera)==null?void 0:n.scale)??1),!1),c.setMaskFilter(o),t(c),c.delete(),o.delete(),l=!0}if(l||t(e),r&&this._hasInnerShadow()){let c=new Qt.Paint;c.setAntiAlias(!0),c.setStyle(Qt.PaintStyle.Fill),c.setColor(NS(this._innerShadowColor));let d;this._innerShadowBlur>0&&(d=Qt.MaskFilter.MakeBlur(Qt.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((s=this.camera)==null?void 0:s.scale)??1),!1),c.setMaskFilter(d));let u=this._currentPath.computeTightBounds(),[h,f,p,m]=u,g=p-h,v=m-f;this.ctx.save(),this.ctx.clipPath(this._currentPath,Qt.ClipOp.Intersect,!0),this.ctx.saveLayer(c,u,null,Qt.SaveLayerInitWithPrevious),(a=this.ctx)==null||a.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(Qt.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+g+Math.abs(this._innerShadowOffsetX*2),2e3+v+Math.abs(this._innerShadowOffsetY*2)),c),c.setBlendMode(Qt.BlendMode.Clear),this.ctx.drawPath(this._currentPath,c),this.ctx.restore(),this.ctx.restore(),c.delete(),d==null||d.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let r=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,n=>{let s=!1;!t&&this._strokeMode!=="center"&&(r.save(),r.clipPath(i,this._strokeMode==="outside"?Qt.ClipOp.Difference:Qt.ClipOp.Intersect,!0),s=!0),r.drawPath(i,n),s&&r.restore()},t)}}_hasDropShadow(){var e;return((e=this._dropShadowColor)==null?void 0:e.a)>0}_hasInnerShadow(){var e;return((e=this._innerShadowColor)==null?void 0:e.a)>0}path(e){var t;(t=this._currentPath)==null||t.addPath(Qt.Path.MakeFromSVGString(e))}ellipse(e,t,r,i,n,s,a,o){var c;if(!I7([e,t,r,i])||!this._currentPath)return;if(r<0||i<0)throw Error("radii cannot be negative");let l=Qt.XYWHRect(e-r,t-i,r*2,i*2);(c=this._currentPath)==null||c.addOval(l)}rect(e,t,r,i,n=0,s=0,a=0,o=0){var c,d;let l=Qt.XYWHRect(e,t,r,i);if(I7(l))if(n===0&&s===0&&o===0&&a===0)(c=this._currentPath)==null||c.addRect(l);else{let u=Qt.RRectXY(l,n,n);u[4]=u[5]=n,u[6]=u[7]=s,u[8]=u[9]=a,u[10]=u[11]=o,(d=this._currentPath)==null||d.addRRect(u)}}getHorizontalAlign(e){switch(e){case 2:return Qt.TextAlign.Right;case 3:return Qt.TextAlign.Center;case 4:return Qt.TextAlign.Justify;case 1:default:return Qt.TextAlign.Left}}drawTextInner(e,t,r,[i,n,s,a],o,l,c=!0){let d=0,{ctx:u}=this;if(!u)return d;let h=l.copy(),f=l.copy();return f.setAlphaf(0),this._applyEffectsToPaint(h,p=>{t.pushPaintStyle(r,p,f),t.addText(e);let m=t.build();m.layout(s);let g=n;o===2?g+=(a-m.getHeight())/2:o===3&&(g+=a-m.getHeight()),u.drawParagraph(m,i,g),d=m.getHeight(),t.reset(),m.delete()},c),h.delete(),f.delete(),d}drawText(e,t){let r=0,i=this._fonts.get(t.font),{ctx:n,_paintFill:s,_paintStroke:a}=this;if(i&&n){let o=new Qt.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new Qt.ParagraphStyle({textStyle:o,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),c=Qt.XYWHRect(t.x,t.y,t.width,t.height),d=Qt.ParagraphBuilder.Make(l,i);s&&(r=this.drawTextInner(e,d,o,c,t.verticalAlign,s,!0)),a&&(r=this.drawTextInner(e,d,o,c,t.verticalAlign,a,!1)),d.delete()}return{height:r}}render(){var e;(e=this._surface)==null||e.flush()}moveTo(e,t){var r;(r=this._currentPath)==null||r.moveTo(e,t)}lineTo(e,t){var r;(r=this._currentPath)==null||r.lineTo(e,t)}bezierCurveTo(e,t,r,i,n,s){var a;(a=this._currentPath)==null||a.cubicTo(e,t,r,i,n,s)}quadraticCurveTo(e,t,r,i){var n;(n=this._currentPath)==null||n.quadTo(e,t,r,i)}setTransform(e,t=!1){var n,s,a,o,l;if(!this.ctx)return;let r=this.ctx.getTotalMatrix(),i=Zr.invert(r);if(i&&this.ctx.concat(i),(n=this.ctx)==null||n.scale(this.dpr,this.dpr),((s=this.camera)==null?void 0:s.enabled)&&((a=this.ctx)==null||a.concat(this.camera.worldMatrix),t)){let c=Zr.getScale(this.camera.worldMatrix);(o=this.ctx)==null||o.scale(1/c[0],1/c[1])}(l=this.ctx)==null||l.concat(e),this.currentTransform=e}transform(e){var t;(t=this.ctx)==null||t.concat(e)}setSize(e,t){var r;e===this._width&&t===this._height||(this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=Qt.MakeWebGLCanvasSurface(this.canvas),this.ctx=(r=this._surface)==null?void 0:r.getCanvas()))}};function I7(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function NS({r:e,g:t,b:r,a:i}){return Qt.Color4f(e,t,r,i)}var R7=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ei.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},D7=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},pst=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ei.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},mst=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=ei.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},es=class extends Un{constructor(t,r,i){super(t,r,i),this.uuid=t,this.data=r,this.autoClose=!0,this.fill=new pst(t+"-fill",r.fill,i),this.stroke=new mst(t+"-stroke",r.stroke,i),this.dropShadow=new R7(t+"-dropShadow",r.dropShadow,i),this.innerShadow=new R7(t+"-innerShadow",r.innerShadow,i),this.backgroundBlur=new D7(t+"-backgroundBlur",r.backgroundBlur,i),this.layerBlur=new D7(t+"-layerBlur",r.layerBlur,i)}applyFillStroke(t){t.fillColor=this.fill.enabled?this.fill.color:ei.transparent,t.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:ei.transparent,t.strokeMode=this.stroke.mode,t.lineWidth=this.stroke.thickness}applyFilters(t){this.layerBlur.enabled?t.layerBlur=this.layerBlur.radius*5:t.layerBlur=0,this.backgroundBlur.enabled?t.backgroundBlur=this.backgroundBlur.radius*5:t.backgroundBlur=0,this.dropShadow.enabled?(t.dropShadowBlur=this.dropShadow.blurRadius*5,t.dropShadowColor=this.dropShadow.color,t.dropShadowOffsetX=this.dropShadow.offset[0],t.dropShadowOffsetY=this.dropShadow.offset[1]):t.dropShadowColor=ei.transparent,this.innerShadow.enabled?(t.innerShadowSpread=this.innerShadow.spread,t.innerShadowBlur=this.innerShadow.blurRadius*5,t.innerShadowColor=this.innerShadow.color,t.innerShadowOffsetX=this.innerShadow.offset[0],t.innerShadowOffsetY=this.innerShadow.offset[1]):t.innerShadowColor=ei.transparent}innerDraw(t){}draw(t){!this.visible||(t.save(),this.applyTransforms(t),this.applyFilters(t),this.applyFillStroke(t),t.beginPath(),this.innerDraw(t),this.autoClose&&t.closePath(),this.fill.enabled&&t.fill(),this.stroke.enabled&&t.stroke(),t.restore())}updateByPatchedOp(t,r,i){super.updateByPatchedOp(t,r,i),t.type===0&&(ci(t.path,["fill"])?this.fill.update(t.props):ci(t.path,["stroke"])?this.stroke.update(t.props):ci(t.path,["dropShadow"])?this.dropShadow.update(t.props):ci(t.path,["innerShadow"])?this.innerShadow.update(t.props):ci(t.path,["layerBlur"])?this.layerBlur.update(t.props):ci(t.path,["backgroundBlur"])?this.backgroundBlur.update(t.props):this.resetBBoxNeedsUpdate())}updateState(t,r){super.updateState(t,r),t.fill!==void 0&&this.fill.update(t.fill),t.stroke!==void 0&&this.stroke.update(t.stroke),t.dropShadow!==void 0&&this.dropShadow.update(t.dropShadow),t.innerShadow!==void 0&&this.innerShadow.update(t.innerShadow),t.layerBlur!==void 0&&this.layerBlur.update(t.layerBlur),t.backgroundBlur!==void 0&&this.backgroundBlur.update(t.backgroundBlur)}clone(t){let r=new es(this.uuid,this.data,t);return r.parent=void 0,r}},Oj=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,r)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return ost(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new Oj(this.uuid,this.data,e);return t.parent=void 0,t}},Tw=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,r)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new Tw(this.uuid,this.data,e);return t.parent=void 0,t}},Lj=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,r)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:ei.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:ei.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var s;(s=this._fontHolder)!=null&&s.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,r=this.data.text.textValue.toString(),i=t===2?r.toUpperCase():t===3?r.toLowerCase():r,{height:n}=e.drawText(i,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new Lj(this.uuid,this.data,e);return t.parent=void 0,t}},cle=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,r)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(i=>lT.extremas(i)),t=[1/0,1/0],r=[-1/0,-1/0];for(let i=0,n=e.length;i<n;i++){let s=e[i];s[0][0]<t[0]&&(t[0]=s[0][0]),s[0][1]<t[1]&&(t[1]=s[0][1]),s[1][0]>r[0]&&(r[0]=s[1][0]),s[1][1]>r[1]&&(r[1]=s[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[r[0],r[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let r=1,i=this.data.points.length;r<i;r++){let n=this.data.points[r].data,s=this.data.points[r-1].data,a={start:s.position,cp1:s.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(a)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let r={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(r)}}getCenter(){let[e,t]=this.extremasBBox.min,[r,i]=this.getHalfSize();return[e+r,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let i=0,n=this.data.points.length;i<n;i++){let s=this.data.points[i].data;if(i===0){let[a,o]=s.position;e.moveTo(a,o)}else{let a=this.data.points[i-1].data,[o,l]=a.controlNext.position,[c,d]=s.controlPrevious.position,[u,h]=s.position,f={start:a.position,cp1:a.controlNext.position,cp2:s.controlPrevious.position,end:s.position};lT.derive(f),e.bezierCurveTo(o,l,c,d,u,h)}}let t=this.data.points[0].data,r=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,n]=r.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(i,n,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new cle(this.uuid,this.data,e);return t.parent=void 0,t}},lT;(e=>{function t(a){let o=a.start,l=a.cp1,c=a.cp2,d=a.end,u=[3*(l[0]-o[0]),3*(l[1]-o[1])],h=[3*(c[0]-l[0]),3*(c[1]-l[1])],f=[3*(d[0]-c[0]),3*(d[1]-c[1])],p={start:u,cp:h,end:f};return a.derivative=p,p.derivative=ak.derive(p),p}e.derive=t;function r(a,o,l,c=!1){let d=a-2*o+l;if(d!==0){let u=-Math.sqrt(Math.abs(o*o-a*l)),h=-a+o,f=-(u+h)/d,p=-(-u+h)/d;return[f,p]}else if(o!==l&&d===0)return[(2*o-l)/(2*(o-l))];return[]}function i(a){let o=a.derivative??e.derive(a),l=o.start,c=o.cp,d=o.end;return[r(l[0],c[0],d[0]),r(l[1],c[1],d[1])]}e.droot=i;function n(a){let[o,l]=e.droot(a),c=[a.start[0],a.end[0]],d=[a.start[1],a.end[1]];for(let u of o)c.push(e.compute(a,Math.min(1,Math.max(0,u)))[0]);for(let u of l)d.push(e.compute(a,Math.min(1,Math.max(0,u)))[1]);return c.sort((u,h)=>u-h),d.sort((u,h)=>u-h),[[c[0],d[0]],[c[c.length-1],d[d.length-1]]]}e.extremas=n;function s(a,o){if(o===0)return[...a.start];if(o===1)return[...a.end];let l=1-o,c=l*l,d=o*o,u=c*l,h=c*o*3,f=l*d*3,p=o*d;return[u*a.start[0]+h*a.cp1[0]+f*a.cp2[0]+p*a.end[0],u*a.start[1]+h*a.cp1[1]+f*a.cp2[1]+p*a.end[1]]}e.compute=s})(lT||(lT={}));var ak;(e=>{function t(n){let s=n.start,a=n.cp,o=n.end,l=[2*(a[0]-s[0]),2*(a[1]-s[1])],c=[2*(o[0]-a[0]),2*(o[1]-a[1])],d={start:l,end:c};return d.derivative=ok.derive(d),n.derivative=d,d}e.derive=t;function r(n){let s=n.derivative??e.derive(n),a=s.start,o=s.end;return[a[0]!==o[0]?a[0]/(a[0]-o[0]):0,a[1]!==o[1]?a[1]/(a[1]-o[1]):0]}e.droot=r;function i(n,s){if(s===0)return[...n.start];if(s===1)return[...n.end];let a=1-s,o=a*a,l=s*s,c=o,d=a*s*2,u=l;return[c*n.start[0]+d*n.cp[0]+u*n.end[0],c*n.start[1]+d*n.cp[1]+u*n.end[1]]}e.compute=i})(ak||(ak={}));var ok;(e=>{function t(i){let n=i.start,s=i.end,a=[s[0]-n[0],s[1]-n[1]];return i.derivative=a,i.derivative}e.derive=t;function r(i,n){if(n===0)return[...i.start];if(n===1)return[...i.end];let s=i.start,a=i.end;return[s[0]+(a[0]-s[0])*n,s[1]+(a[1]-s[1])*n]}e.compute=r})(ok||(ok={}));var Gc=class extends Oc{constructor(e,t,r){super(e,t,r),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new Tw(e+"-background",vx.defaultData,r),this.background.parent=this,this.updateState(t,r)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),(e=this.background)==null||e.updateLocalMatrix()}updateWorldMatrix(e,t,r){var i;super.updateWorldMatrix(e,t,r),(i=this.background)==null||i.updateWorldMatrix(e,t,r)}draw(e){if(!this.visible)return;e.save();let t=this.width,r=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=r,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,r,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(ci(e.path,["fill"])?this.fill.update(e.props):ci(e.path,["stroke"])?this.stroke.update(e.props):ci(e.path,["dropShadow"])?this.dropShadow.update(e.props):ci(e.path,["innerShadow"])?this.innerShadow.update(e.props):ci(e.path,["layerBlur"])?this.layerBlur.update(e.props):ci(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new Gc(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},gst=Pn(gne(),1),ZM=class extends es{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,r),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new ZM(this.uuid,this.data,e);return t.parent=void 0,t}};function vst(e,t=1,r=1){if(t<=0||r<=0)return e;let i=(0,gst.parseSVG)(e).map(n=>{let s={...n};return"x"in s&&(s.x=s.x*t),"y"in s&&(s.y=s.y*r),"x1"in s&&(s.x1=s.x1*t),"x2"in s&&(s.x2=s.x2*t),"y1"in s&&(s.y1=s.y1*r),"y2"in s&&(s.y2=s.y2*r),"rx"in s&&(s.rx=s.rx*t),"ry"in s&&(s.ry=s.ry*r),s});return yst(i)}function yst(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],r;return e.map(i=>{let n=[];t.forEach(a=>{if(a in i){let o=i[a]*1;n.length&&o>=0&&n.push(","),n.push(o)}});let s=(r===i.code?n[0]<0?"":",":i.code)+n.join("");return r=i.code,s}).join("")}function bst(e,t,r){switch(t.type){case"ellipse2d":return new Oj(e,t,r);case"rectangle2d":return new Tw(e,t,r);case"text2d":return new Lj(e,t,r);case"vector2d":return new cle(e,t,r);case"path2d":return new ZM(e,t,r);case"frame2d":return new Gc(e,t,r);case"group2d":default:return new fd(e,t,r)}}var ule=class{constructor(e,t,r){this.uuid=e,this.data=t,this.group=new fd(ule.GROUP_ID,{...tT.defaultData},r),this.createChildrenObjects(t.objects,this.group,r)}createObject(e,t,r,i,n,s){let a=bst(e,t,s);a&&(i.add(a),i.children.splice(n,0,i.children.pop()),a.updateWorldMatrix(),r.length>0&&(a instanceof fd||a instanceof Gc)&&this.createChildrenObjects(r,a,s))}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,r,i){let n=this.find(e);if(n)try{n.updateByOp(t,r,{shared:i})}catch(s){console.error(s)}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let r=e.parent===null?this.group:this.find(e.parent);r!==void 0&&r instanceof Oc&&(this.createObject(e.id,e.data,e.children,r,e.localIndex,t),r.requestRender())}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r!==void 0&&r.parent!==void 0&&r.parent instanceof Oc){let i=r.parent;r.resetBBoxNeedsUpdate(),i==null||i.remove(r),i==null||i.requestRender()}}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r!==void 0){let i=r.parent,n=e.parent===null?this:this.find(e.parent);if(n instanceof Oc||n===this){n.add(r);let s=e.localIndex;n.children.splice(s,0,n.children.pop()),r.updateWorldMatrix(!0,!1,!0),i==null||i.requestRender(),r.requestRender()}r.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,r,i=!1,n=[]){return this.group.intersectsChildren(e,t,r,i,n,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this.group;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>qse(r.sortKey,i.sortKey)),t.map(r=>r.entity)}},Nj=ule;Nj.GROUP_ID="scene2d";function dle({constraints:e,newParentWidth:t,newParentHeight:r,initialParentWidth:i,initialParentHeight:n,objectInitialWidth:s,objectInitialHeight:a,objectInitialPosition:o}){let{horizontalConstraint:l,verticalConstraint:c}=e,d=t-i,u=r-n,h=s,f=a,p=o[0],m=o[1];if(l!==0){if(l===1)p+=d;else if(l===3)p+=d/2;else if(l===2)h=Math.max(1,h+d);else if(l===4){let g=t/i;h*=g,p*=g}}if(c!==0){if(c===1)m+=u;else if(c===3)m+=u/2;else if(c===2)f=Math.max(1,f+u);else if(c===4){let g=r/n;f*=g,m*=g}}return{width:h,height:f,position:[p,m]}}Pn(gne(),1);var xst=Zr.identity(),hle=class{constructor(e,t,r,i){this.uuid=e,this.width=t,this.height=r,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this.onFrameOverrideObjectEvent=n=>{var s,a;if(((s=n.target)==null?void 0:s.uuid)!==void 0){let o=(a=this.frameRoot)==null?void 0:a.find(n.target.uuid);o&&o.dispatchEvent({...n,target:o})}},this.scene2d=new Nj(Et.generateUUID(),RN.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=document.createElement("canvas"),this.renderer=new P7(this.canvas),i.shared.addCanvas(this.uuid,this.canvas),this.textureHolder=i.shared.canvas(this.uuid),this.promise=this.init()}async init(){this.renderer instanceof P7&&(this.renderer.wasmURL=zoe.skiaWasmUrl),await this.renderer.init()}render(){var e,t;this.isFrameDirty&&(this.renderer.clear(),(e=this.frameOverride)==null||e.draw(this.renderer),this.renderer.render(),(t=this.textureHolder)==null||t.setNeedsUpdate(!0),this.isFrameDirty=!1)}updateEntity2DByOp(e,t,r,i){this.scene2d.updateEntityByOp(e,t,r,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=(e==null?void 0:e.width)??this.width,r=(e==null?void 0:e.height)??this.height;this.frameOverride.width=t,this.frameOverride.height=r,this.frameOverride.localMatrix=xst,this.isScreenSpace&&(this.frameOverride.fill.color=ei.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:r},fle({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e){var i,n;let t=(e==null?void 0:e.width)??this.width,r=(e==null?void 0:e.height)??this.height;this.width=t,this.height=r,this.renderer.dpr=this.isScreenSpace?window.devicePixelRatio:Math.floor(2048/Math.max(t,r)),this.renderer.setSize(t,r),(i=this.textureHolder)==null||i.dispose(),this.applyOverrides(e),(n=this.frameOverride)==null||n.requestRender()}applyFrame(e){var r,i,n;let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof Gc)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(r=this.textureHolder)==null||r.dispose(),(i=this.frame)==null||i.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(s=>{s.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(s=>{s.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(n=this.frame)==null||n.requestRender(),t}get frame(){return this.frameOverride}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return(e=this.textureHolder)==null?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,r;(e=this.frameOverride)==null||e.removeEventListener("render",this.onRenderRequestedDownstream),(t=this.frameOverride)==null||t.traverse(i=>{i.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(r=this.frameOverride)==null||r.traverse(i=>{i.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function fle({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s}){if(e instanceof Gc&&t instanceof Gc||e instanceof fd&&t instanceof fd)for(let a=0,o=e.children.length;a<o;a++){let l=e.children[a],c=t.children[a];l&&c&&l.uuid===c.uuid&&_st({objectOverride:l,objectRoot:c,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s})}}function wst(e){if(lk(e))return[e.width,e.height];if(e instanceof ZM){let[t,r]=e.getHalfSize();return[t*2,r*2]}else if(e instanceof fd){let[t,r]=e.recursiveBBox.getHalfSize();return[t*2,r*2]}return[0,0]}function _st({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s}){let[a,o]=wst(t),{width:l,height:c,position:d}=dle({constraints:e.data,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:t.position});if(e.position=d,e.data={...e.data,position:d},e.states)for(let u in e.states)Sst({stateId:u,objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s});if(lk(e)||e instanceof fd)lk(e)&&(e.width=l,e.height=c,e.data={...e.data,width:l,height:c}),fle({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:c,initialParentWidth:a,initialParentHeight:o});else if(e instanceof ZM){let u=t,h=a!==0?l/a:1,f=o!==0?c/o:1;e.path=vst(u.path,h,f),e.data={...e.data,path:e.path}}}function Sst({stateId:e,objectOverride:t,objectRoot:r,newParentWidth:i,newParentHeight:n,initialParentWidth:s,initialParentHeight:a}){var c,d;let o=(c=t.states)==null?void 0:c[e],l=(d=r.states)==null?void 0:d[e];if(o&&l){let{width:u,height:h,position:f}=dle({constraints:t.data,newParentWidth:i,newParentHeight:n,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:hp.isResizeable(l)?l.width:0,objectInitialHeight:hp.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:f}),hp.isResizeable(o)&&Object.assign(t.states[e],{width:u,height:h})}}function lk(e){return e instanceof Tw||e instanceof Gc||e instanceof Oj||e instanceof Lj}var Jn=class extends hj(Xu){constructor(t,r,i){super(),this.data=r,this.bgColor=new Ps(1,1,1,1),this.fog=null,this.backupFog=new Vne(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new zt,this.penumbraSizeArrayCache=null,this.super_Entity(t,r),this.personalCamera=new Js(H0,{...px.defaultData,...r.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new QHe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),r.uiScene?this.uiScene=new Nj((Array.isArray(t)?t[0]:t)+"-ui",r.uiScene,{dpr:window.devicePixelRatio,shared:i.shared}):r.uiFrame&&this.createUICanvas(r.uiFrame,i)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var t;return(t=this.uiCanvas)==null?void 0:t.frame}createUICanvas(t,r){this.uiCanvas=new hle(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,r),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var i,n;(i=this.uiCanvas)==null||i.applyFrame(t),(n=this.uiCanvas)==null||n.applySize()})}updateVisible(){}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(t,r){t.color!==void 0&&(this.ambientLight.color=ba(t.color,r)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.enabled!==void 0&&(t.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(t){this.isActive=!0,t.fog=this.fog,this.traverseEntity(r=>{r instanceof Up&&r.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(t=>{if(t instanceof q0)if(Array.isArray(t.material))for(let r of t.material)r.needsUpdate=!0;else t.material.needsUpdate=!0,t.material.dispose()})}updateShadow(t){t.softShadowQuality!==void 0&&this.isActive&&tst(t.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(t,r){if(t.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let i=this.scene;i.fog=this.fog}this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=ba(t.color,r),this.backupFog.near=t.near,this.backupFog.far=t.far}updateAo(t,r){t.aoColor!==void 0&&(this.aoColor=ba(t.aoColor,r))}updateByOp(t,r,i,n){let s=this.data.uiFrame;super.updateByOp(t,r,i,n);let a=r;ci(t.path,["fog"])?this.updateFog(a.fog,i.shared):ci(t.path,["ao"])?this.updateAo(a.ao,i.shared):ci(t.path,["ambient"])?this.updateAmbientLight(a.ambient,i.shared):ci(t.path,["shadow"])?this.updateShadow(a.shadow):t.type===0&&t.path.length===0&&(t.props.uiFrame!==void 0||s!==a.uiFrame)&&this.updateUIFrame(t.props.uiFrame,i)}updateUIFrame(t,r){t?(this.uiCanvas||this.createUICanvas(t,r),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(t)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(t,r){this.updateState_Entity(t,r),t.backgroundColor!==void 0&&this.setBackgroundColor(ba(t.backgroundColor,r.shared)),t.fog!==void 0&&this.updateFog(t.fog,r.shared),t.ambient!==void 0&&this.updateAmbientLight(t.ambient,r.shared),t.ao!==void 0&&this.updateAo(t.ao,r.shared),t.shadow!==void 0&&this.updateShadow(t.shadow)}createFrame(t,r){}raycast(t,r){super.raycast(t,r)}switchActiveCamera(t){t&&t.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1)}get playCamera(){var t;return((t=this.scene)==null?void 0:t.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let t=0,r=0;this.traverseEntity(i=>{if(!i.visible)return!0;i instanceof sle&&i.visible&&t<3&&(this.penumbraSizeArrayCache[t]=i.data.penumbraSize,t+=1),i instanceof ale&&i.visible&&t<5-3&&(this.penumbraSizeArrayCache[3+r]=i.data.penumbraSize,r+=1)})}raycastWithClones(t){let r=[],i=n=>{for(let s of n.children){let a=s.cloner;_r.is(s)&&(s.visible||a!=null&&a.object.data.visible)&&((Pl(s)||QN(s)&&this.scene.enableHelpers&&s.objectHelper.visible)&&(t.intersectObject(s,!1,r),uk(s,t,r,!0)),i(s))}};return i(this),r}updateEntity2DByOp(t,r,i,n){var s;(s=this.uiCanvas)==null||s.updateEntity2DByOp(t,r,i,n)}},Est=class extends Ij(tWe,ile){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let n=new L(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new L(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),a=new un(n,s),o=new CA(a,new zt(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof CA){let r=this.shadow.camera,i=new L(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new L(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Cst=class extends Ys{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?xj(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},kj=class extends Ys{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var i;let e={...this.data.geometry.extrusion.shape};for(let n in e)typeof e[n]=="string"&&(e[n]=this._context.shared.getVariable(e[n],[this.uuid,"geometry","extrusion","shape",n]));let t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let s=this._context.scene.find(n);s!=null&&s.data&&(s.attachedPaths.add(this),t=(i=s.geometry.userData)==null?void 0:i.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=bj;break;case"Ellipse":n=yj;break;case"Polygon":n=eoe;break;case"Star":n=toe;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?xj(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},bv=class extends X0($f,Cw){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=QA.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let s of dh.rootOverrideProps)e[s]===void 0?(i===void 0&&(i={...e}),i[s]=r.data[s]):(n===void 0&&(n={}),n[s]=e[s],i===void 0&&(i={...e}),i[s]=Ph.apply(r.data[s],e[s]));return this.overrideData=n,i}else return{...Ms.defaultData,...e,...Yu(Ms.defaultData,dh.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let s of dh.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&dh.rootOverrideProps.includes(e.path[0])){let s=e.path[0];n===void 0&&(n={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(_r.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),zj(s),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};ple(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let s of this.children)if(_r.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{if(o instanceof Ys&&o.isSkinnedMesh){let l=o.dataPatched;if(l.bones&&l.boneInverses){let c=l.bones.map(h=>e.scene.find(n[h])),d=l.boneInverses.map(h=>new Ke().fromArray(h)),u=new T4(c,d);o.bind(u,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function zj(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)_r.is(r)&&zj(r)}}function O7(e,t,r,i){return e.component===t&&Hse(e.identity,i)?e.overrideData===r?2:1:0}function ple(e,t,r,i,n,s,a,o,l){if(a>50)return!1;if(i.component!==n){if(i.component){let d=i.component.instances.indexOf(i);d>=0&&i.component.instances.splice(d,1)}n.instances.push(i),i.component=n}n instanceof bv&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let d of n.children)if(_r.is(d)){let u=[...t,...typeof d.identity=="string"?[d.identity]:d.identity],h=GA.resolve(r,u,1);h!=null&&!(h instanceof Mn)&&(Object.setPrototypeOf(h,Mn.prototype),console.error("wrong prototype"));let f=null,p;if(!o){let m=i.children[c];if(f=_r.is(m)?m:null,f!==null){let g=O7(f,d,h,u);p=g>=1?f.stateSelection:void 0,g!==2&&(f=null)}if(f===null&&(f=e.scene.findInstance(u)??null,f!==null)){let g=O7(f,d,h,u);if(p=g>=1?f.stateSelection:void 0,g!==2)f=null;else{let v=f.parent.children.indexOf(f);f.parent.children.splice(v,1),i.children.splice(c,0,f),f.parent===i?v<=c&&console.error("not possible"):(f.parent=i,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),e.pendingDeletes.delete(f))}}}if(f===null){let m=h?Ph.apply(d.data,h):d.data;Fp.is(m.type)&&(m={...m,type:"Empty"}),f=fh.createEntity(u,m,e),f.overrideData=h,i.add(f),i.children.splice(i.children.length-1,1),i.children.splice(c,0,f),f.updateState(f.data,e),p&&f.changeSelectedState(p,e),e.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let m=f.identity[f.identity.length-1];l[m]=f.uuid}c+=1,ple(e,t,r,f,d,s,a+1,o,l)}if(!o){let d=c;for(;;){let u=i.children[c];if(_r.is(u))e.pendingDeletes.add(u);else break;c+=1}i.children.splice(d,c-d)}return!0}var Ast=class extends X0(Une,Cw){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},qs=class extends Ys{constructor(t,r,i){super(t,r,i),this.onBeforeRender=()=>{this.uiCanvas.render()},this.uiCanvas=new hle(t+"-canvas",r.geometry.width,r.geometry.height,i),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,i.shared)})}updateByPatchedOpGeometry(t,r,i){super.updateByPatchedOpGeometry(t,r,i),t.type===0&&(t.props.frame!==void 0&&this.applyFrame(t.props.frame,i.shared),(t.props.width!==void 0||t.props.height!==void 0)&&this.applySize(t.props,i.shared))}applySize(t,r){let i=(t==null?void 0:t.width)??this.dataPatched.geometry.width,n=(t==null?void 0:t.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:i,height:n}),this.applyGeometryParametersFromFrame(r)}applyFrame(t,r){this.uiCanvas.applyFrame(t),this.applyGeometryParametersFromFrame(r),this.applyMaterialParametersFromFrame({shared:r})}applyGeometryParametersFromFrame(t){var i;let r=this.frame;r&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:r.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:r.cornerRadius,cornerType:0})}),(i=this.localGeometry)==null||i.dispose(),this.localGeometry=_x(this.dataPatched.geometry,t,this.data.flatShading,this))}applyMaterialParametersFromFrame(t){let r=this.frame;if(r){let i=r.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:i.radius,alpha:i.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:i.radius,alpha:i.enabled?1:0}),this.material.reset(this.dataPatched.material,t,!0)}}updateEntity2DByOp(t,r,i,n){this.uiCanvas.updateEntity2DByOp(t,r,i,n),t===this.frameId&&r.type===0&&(r.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(n):ci(r.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:n}))}get frame(){return this.uiCanvas.frame}get frameId(){var t;return(t=this.frame)==null?void 0:t.uuid}removeInteractionGeometry(t){super.removeInteractionGeometry(t),this.applySize({},t)}updateGeometryInteractions(t,r){super.updateGeometryInteractions(t,r),this.applySize({width:t.width,height:t.height},r)}},Tst=class{constructor(e,t,r){this.variables=[],this.currentTextureIndex=0;let i=Cn,n=new Xu,s=new tm;s.position.z=1;let a={passThruTexture:{value:null}},o=d(h(),a),l=new An(new rm(2,2),o);n.add(l),this.setDataType=function(f){return i=f,this},this.addVariable=function(f,p,m){let g=this.createShaderMaterial(p),v={name:f,initialValueTexture:m,material:g,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Hr,magFilter:Hr};return this.variables.push(v),v},this.setVariableDependencies=function(f,p){f.dependencies=p},this.init=function(){if(r.capabilities.isWebGL2===!1&&r.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(r.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let f=0;f<this.variables.length;f++){let p=this.variables[f];p.renderTargets[0]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),p.renderTargets[1]=this.createRenderTarget(e,t,p.wrapS,p.wrapT,p.minFilter,p.magFilter),this.renderTexture(p.initialValueTexture,p.renderTargets[0]),this.renderTexture(p.initialValueTexture,p.renderTargets[1]);let m=p.material,g=m.uniforms;if(p.dependencies!==null)for(let v=0;v<p.dependencies.length;v++){let y=p.dependencies[v];if(y.name!==p.name){let b=!1;for(let x=0;x<this.variables.length;x++)if(y.name===this.variables[x].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+p.name+", dependency="+y.name}g[y.name]={value:null},m.fragmentShader=`
uniform sampler2D `+y.name+`;
`+m.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let f=this.currentTextureIndex,p=this.currentTextureIndex===0?1:0;for(let m=0,g=this.variables.length;m<g;m++){let v=this.variables[m];if(v.dependencies!==null){let y=v.material.uniforms;for(let b=0,x=v.dependencies.length;b<x;b++){let S=v.dependencies[b];y[S.name].value=S.renderTargets[f].texture}}this.doRenderTarget(v.material,v.renderTargets[p])}this.currentTextureIndex=p},this.getCurrentRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(f){return f.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let f=this.variables;for(let p=0;p<f.length;p++){let m=f[p];m.initialValueTexture&&m.initialValueTexture.dispose();let g=m.renderTargets;for(let v=0;v<g.length;v++)g[v].dispose()}};function c(f){f.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=c;function d(f,p){p=p||{};let m=new Gr({uniforms:p,vertexShader:u(),fragmentShader:f});return c(m),m}this.createShaderMaterial=d,this.createRenderTarget=function(f,p,m,g,v,y){return f=f||e,p=p||t,m=m||Si,g=g||Si,v=v||Hr,y=y||Hr,new Wr(f,p,{wrapS:m,wrapT:g,minFilter:v,magFilter:y,format:ts,type:i,depthBuffer:!1})},this.createTexture=function(){let f=new Float32Array(e*t*4),p=new Qo(f,e,t,ts,Cn);return p.needsUpdate=!0,p},this.renderTexture=function(f,p){a.passThruTexture.value=f,this.doRenderTarget(o,p),a.passThruTexture.value=null},this.doRenderTarget=function(f,p){let m=r.getRenderTarget(),g=r.xr.enabled,v=r.shadowMap.autoUpdate,y=r.outputEncoding,b=r.toneMapping;r.xr.enabled=!1,r.shadowMap.autoUpdate=!1,r.outputEncoding=Kl,r.toneMapping=Hc,l.material=f,r.setRenderTarget(p),r.render(n,s),l.material=o,r.xr.enabled=g,r.shadowMap.autoUpdate=v,r.outputEncoding=y,r.toneMapping=b,r.setRenderTarget(m)};function u(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function h(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},ds=new xs,kS=new L,Mst=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let s=1;t&&(s=t.getX(n)+t.getX(n+1)+t.getX(n+2)),ds.a.fromBufferAttribute(e,n),ds.b.fromBufferAttribute(e,n+1),ds.c.fromBufferAttribute(e,n+2),s*=ds.getArea(),r[n/3]=s}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<r.length;n++)i+=r[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t,r)}binarySearch(e){let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r,i){let n=this.randomFunction(),s=this.randomFunction();return n+s>1&&(n=1-n,s=1-s),ds.a.fromBufferAttribute(this.positionAttribute,e*3),ds.b.fromBufferAttribute(this.positionAttribute,e*3+1),ds.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(ds.a,n).addScaledVector(ds.b,s).addScaledVector(ds.c,1-(n+s)),r!==void 0&&ds.getNormal(r),i!==void 0&&this.colorAttribute!==void 0&&(ds.a.fromBufferAttribute(this.colorAttribute,e*3),ds.b.fromBufferAttribute(this.colorAttribute,e*3+1),ds.c.fromBufferAttribute(this.colorAttribute,e*3+2),kS.set(0,0,0).addScaledVector(ds.a,n).addScaledVector(ds.b,s).addScaledVector(ds.c,1-(n+s)),i.r=kS.x,i.g=kS.y,i.b=kS.z),this}};function Pst(e){let t=new Float32Array(e*e*2);for(let r=0;r<e;r++)for(let i=0;i<e;i++){let n=r*e+i;t[n*2+0]=r/(e-1),t[n*2+1]=i/(e-1)}return t}function Ist(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function Rst(e,t){let r=new An(e.geometry,e.material),i=[],n=[],s=new L,a=new L;r.geometry.index!==null&&(r.geometry=r.geometry.toNonIndexed());let o=new Mst(r).build();for(let d=0;d<t;d++)o.sample(s,a),i.push(s.x,s.y,s.z),n.push(a.x,a.y,a.z);let l=new Float32Array(i),c=new Float32Array(n);return{positions:l,normals:c}}function L7(e,t){let r=e,i=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)i[4*s]=r[3*s],i[4*s+1]=r[3*s+1],i[4*s+2]=r[3*s+2],i[4*s+3]=0;let n=new Qo(i,t,t,ts,Cn);return n.needsUpdate=!0,n}function Dst({size:e}){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=i,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Qo(t,e,e,ts,Cn);return r.needsUpdate=!0,r}function Ost(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Qo(t,e,e,ts,Cn);return r.needsUpdate=!0,r}var Lst=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,Nst=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,kst=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,zst=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,Bst=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,Fst=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+Nst+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          float offset = 0.0;
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), offset);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          float offset = 0.0;
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${kst}
      // ATTRACTION
      ${zst}  
      // VORTEX
      ${Bst}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,mle=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,jst=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,Vst=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,Ust=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${jst}
  ${mle}
`,$st=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,Hst=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+mle+`  
  ${Vst}

`,Wst=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,Gst=class extends Gr{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],this.lightLayer=new bc(0,"",{...Qn.defaultData("light","phong"),visible:!1},new Cj,{},t.shared),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new moe;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(ntt),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(stt),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(Ust),e.addFragmentParsCode(Hst),e.addVertexFinalCode($st({easeSize:this.easeSize})),e.addFragmentFinalCode(Wst({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},wD=class{constructor(e,t,r,i){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=r,this.textureSize=Ist(t);let n=1;this.targetMesh=(i==null?void 0:i.type)==="Mesh"&&i?i:this.getMesh(r,n);let{positions:s,dataTexture:a,dataTextureNormals:o}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(r,n));this.positionsTexture=a,this.positionsAttribute=s,this.directionsTexture=o}createPositions(e,t){let{positions:r,normals:i}=Rst(t,e*e),n=L7(r,e),s=L7(i,e);return{dataTexture:n,positions:r,dataTextureNormals:s}}getMesh(e,t){let r=null;switch(e){case"SphereEmitterShape":{r=new ov(t*.5,32,32);break}case"TorusEmitterShape":{r=new Zne(t*.5,.3,15,40);break}case"ConeEmitterShape":{r=new R4(t,t,15);break}case"BoxEmitterShape":{r=new Ql(t,t,t);break}case"PlaneEmitterShape":{r=new rm(t,t),r.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{r=new ov(t,32,32);break}default:{r=new ov(t,32,32);break}}return new An(r,new em({color:16711680}))}applyToShader(e,t){this.size=new L().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function w1(e){let t={...e},r=jA.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i={...r.shape,...t.shape},n={...r.renderMaterial,...t.renderMaterial};return{...r,...t,shape:i,renderMaterial:n}}var qst=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,_D=10,Xst=class extends Yr{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new KHe,this.currentWorldPosition=new L,this.systemQuaternion=new Xt,this.worldGravity=new L(0,0,0),this.directionAxis=new L(0,0,0),this.colliderV3=new L(0,0,0),this.colliderQuaternion=new Xt(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let r=t.data;this.material=new Gst(r.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:r.renderMaterial.color},uColor2:{value:r.renderMaterial.color2},uPosition:{value:new L(0,0,0)},uEmissionData:{value:new L(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new L(0,0,0)},uWorldQuaternion:{value:new Yt(0,0,0,1)},uRandScaleFactor:{value:r.randomScale??0},uRandRotationFactor:{value:r.randomRotation??0},uRotation:{value:r.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:r.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,r.renderMaterial.texture),this.init(r)}setTexture(e,t){let r=t.data;if(typeof t=="string"){let i=this.shared.image(t),n=new Li(i.img);n.needsUpdate=!0,e.uTexture.value=n;return}if(typeof r!="string"){let i=new Image;i.onload=()=>{let a=new Li(i);a.needsUpdate=!0,e.uTexture.value=a};let n=new Blob([r],{type:"image/*"}),s=URL.createObjectURL(n);i.src=s}}updateGeometryAttributes(e,t){var i;let r=Pst(t);!((i=this.emitterShape)!=null&&i.positionsAttribute)||e.geometry.setAttribute("ref",new nx(r,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var a;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let r=1e3/t,i=this.targetFPS/r,n=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let s=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=s,this.material.uniforms.uPosition.value=(a=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:a.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0];if(!e)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let t=e.data.size;this.colliderV3.fromArray(t),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let r=(i,n)=>{let s=[...this.system.data.shape.size];s[i]=n,this.updateParticleState({shape:{...this.system.data.shape,size:s}})};t[2]==="shape_size_0"&&r(0,e),t[2]==="shape_size_1"&&r(1,e),t[2]==="shape_size_2"&&r(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/_D),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){var t,r,i;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(w1(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/_D),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),((t=e.renderMaterial)==null?void 0:t.size)!==void 0){let n=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(n)}if(((r=e.renderMaterial)==null?void 0:r.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let n=e.shape.size??this.system.data.shape.size,s=[Number(this.shared.getVariable(n[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(n[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(n[2],[this.uuid,"particles","shape_size_2"]))],a={...w1(this.system.data).shape,size:s};(i=this.emitterShape)==null||i.applyToShader(this.positionSimRT.material.uniforms,a)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let n=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(n),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*Et.DEG2RAD,Number(e[1])*Et.DEG2RAD,Number(e[2])*Et.DEG2RAD],r=new kn(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(r).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:r,colliderEntityId:i,shape:n,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:c}=e;return t!==void 0||r!==void 0||i||i===null||a!==void 0||n!==void 0||o!==void 0||s!==void 0||l!==void 0||c!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let r=new Tst(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),n=r.addVariable("uCurrentPosition",i+Lst,this.emitterShape.positionsTexture),s=r.addVariable("uCurrentVelocity",i+Fst,this.emitterShape.directionsTexture),a=r.addVariable("uCurrentEmissionRate",qst,Ost(this.emitterShape.textureSize));r.setVariableDependencies(n,[n,s,a]),r.setVariableDependencies(s,[n,s,a]),r.setVariableDependencies(a,[n,s,a]);let o=Dst({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new L(0,0,0)},uWorldQuaternion:{value:new Yt(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new L(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let d=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),u={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Yt(0,0,0,1)},uColliderPos:{value:new L(0,0,0)},uColliderSize:{value:new L(0,0,0)},uForceIntensity:{value:d?d.forceIntensity:0},uForceDamping:{value:d?d.forceDambing:0},uColliderQuaternion:{value:new Yt(0,0,0,1)},uColliderQuaternionInvert:{value:new Yt(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/_D}};s.material.uniforms=u;let h={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=h;let f=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],p={...w1(this.system.data).shape,size:f};this.emitterShape.applyToShader(n.material.uniforms,p),r.init(),this.gpuCompute=r,this.positionSimRT=n,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),r=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),i=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,r,i]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let r=this.system.getColliderData(e.colliderEntityId);switch(r==null?void 0:r.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let i=r==null?void 0:r.colliderType;i==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),i==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(r==null?void 0:r.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[r,i]of Object.entries(this.simFeaturesDefinition))i&&(t+=`#define ${r}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let r=new L(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let i=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===e.fromMeshId&&(i=n)}),i?new wD(r,t,e.type,i):new wD(r,t,"SphereEmitterShape")}else return new wD(r,t,e.type)}createPrimaryEmitter(e){let t,r=e*e;return t=new uHe(new rm(1,1,1),this.material,r),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:r=0}){return Math.ceil(e*(t+r))}dispose(){var e,t,r;!this.gpuCompute||((t=(e=this.rootObject)==null?void 0:e.parent)==null||t.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(r=this.emitterShape)==null||r.dispose())}GoEmitSomeParticles(e,t){let r=e-this.lastEmitTime,i=1/t;if(r>=i){let n=Math.max(1,Math.floor(r/i));return this.lastEmitTime=e,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(w1(this.system.data))}startEmitting(){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=this.globalTime}stopEmitting(){this.isEmitting=!1}},ck=class extends Ca{constructor(e,t,r){super(e,t),this.type="ParticleSystem",this.geometry=new Dt,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=i=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(i))},this.context=r,this.data={...t,...w1(t)},this.geometry.setAttribute("position",new vt([],3)),this.material=new em({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new Xst(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeLoopDelayStart==="start"?0:this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let r=this.actualTime/1e3;this.emitter.update(r,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(r=>r.identity===e);return t?t.data:null}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),ci(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...rs.drop(e,1).props}}),ci(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...rs.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){var t;if(this.currentLoopTime=0,e){setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(t=this.emitter)==null||t.startEmitting()}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,(e=this.emitter)==null||e.stopEmitting()}reset(){var e;this.started=!1,this.stopped=!1,(e=this.emitter)==null||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function Yst(e,t,r){let i;return t.geometry.type==="TextGeometry"?new Yoe(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new Sx(e,t,r):t.geometry.type==="PathGeometry"?i=new kj(e,t,r):t.geometry.type==="VectorGeometry"?i=new Cst(e,t,r):t.geometry.type==="BooleanGeometry"?i=new Up(e,t,r):t.geometry.type==="UIGeometry"?i=new qs(e,t,r):i=new Ys(e,t,r),i)}function Bj(e,t,r){return console.assert(t.type!==void 0),t.type==="Mesh"?Yst(e,t,r):t.type==="Empty"?new yv(e,t):t.type==="Particle"?new ck(e,t,r):t.type==="ParticleCollider"?new ZN(e,t,r):t.type==="Splat"?new yv(e,t):t.type==="Bone"?new Ast(e,t):t.type==="Page"?new Jn(e,t,r):t.type==="PointLight"?new Est(e,t,r):t.type==="SpotLight"?new ale(e,t,r):t.type==="DirectionalLight"?new sle(e,t,r):t.type==="Component"||t.type==="Instance"?new bv(e,t,r):Fp.is(t.type)?new Js(e,t):(console.error(t),new yv(e,t))}fh.createEntity=Bj;function Kst(e,t,r){let i=Bj(e.identity,t,r),n=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,d=e.uuid,u=e.stateSelection;e.dispose();for(let h of Object.keys(e))delete e[h];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let h of Object.keys(i))e[h]=i[h];e.children=[...e.children,...n],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=d,e.overrideData=c,e.updateState(e.data,r),u&&e.changeSelectedState(u,r),e.resetBBoxNeedsUpdate()}fh.changeEntityProptotype=Kst;fh.Cloner=Ol;function Qst(e,t,r,i){e.updateByOp(t,r,i,!1)}function N7(e,t){let r=!1,i=t.getLayersOfType("transmission"),n=t.getLayersOfType("outline");return n.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,Pj(e),Mj(e)),i.length===0&&n.length===0&&e.layers.set(0),e instanceof q0&&e.needsAO&&e.layers.enable(5),r}function k7(e,t){if(!t.layers)return!1;let r=!1,i=t.getLayersOfType("transmission").filter(s=>s.data.visible),n=t.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(e.layers.set(3),n.length>0&&e.layers.enable(8),r=!0),i.length===0&&n.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),r}function Zst(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof q0)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)N7(r,r.material[i])&&(t=!0);else N7(r,r.material)&&(t=!0)}),t}function Jst(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof q0)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)k7(r,r.material[i])&&(t=!0);else k7(r,r.material)&&(t=!0)}),t}var eat=new ose,tat=new Ke,rat=new O0;function uk(e,t,r,i=!1){let n=e.cloner;if(n)for(let s of n.children){let a=tat.copy(s.matrixWorld).invert(),o=rat.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let c=eat;c.set(o.origin,o.direction),c.near=t.near,c.far=t.far;let d=c.intersectObject(e,!1);d.length>0&&r.push({...d[0],object:i?s:e})}}var iat=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],s=r;for(;this._constraints.has(s);)s=this._constraints.get(s),t.has(s)||n.push(s);for(let a=n.length-2;a>=0;a--)if(!t.has(n[a])){let o=e.find(n[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${n[a]}`),t.add(n[a])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},dc=Pn(fw()),vu=Pn(pw()),nn=Pn(fw()),mr=Pn(pw()),cT=class{constructor(e,t,r){this._dataNormalized=e,this._minD=t,this._maxD=r}static createFromUnnormalized(e){let t=mr.sup(e),r=mr.inf(e),i=(0,nn.default)(new Float32Array(e.size),e.shape),n=t-r;return n<1e-4?mr.assigns(i,0):(mr.subs(i,e,r),mr.divs(i,i,n)),new cT(i,r,t)}get data(){return this._dataNormalized}get minD(){return this._minD}get maxD(){return this._maxD}denormalize(){let e=(0,nn.default)(new Float32Array(this._dataNormalized.size),this._dataNormalized.shape);return mr.muls(e,this._dataNormalized,this._maxD-this._minD),mr.adds(e,e,this._minD),e}},Ii=class{constructor(e,t){this._quantized=e,this._method=t}get quantized(){return this._quantized}static maxIntBits(e){return 2**e-1}static fromNormalized(e,t){let r=e.data,i;if(t==="norm8x"){let n=Ii.maxIntBits(8),s=(0,nn.default)(new Float32Array(r.size),r.shape);mr.muls(s,r,n),mr.roundeq(s),i=(0,nn.default)(new Uint8Array(s.data),r.shape)}else if(t==="norm565"){let n=(0,nn.default)(new Float32Array(r.size),r.shape);mr.assign(n,r),mr.mulseq(n.pick(null,0),Ii.maxIntBits(5)),mr.mulseq(n.pick(null,1),Ii.maxIntBits(6)),mr.mulseq(n.pick(null,2),Ii.maxIntBits(5)),mr.roundeq(n);let s=(0,nn.default)(new Uint16Array(n.data),r.shape),a=(0,nn.default)(new Uint16Array(r.shape[0]),[r.shape[0]]),o=(0,nn.default)(new Uint16Array(r.shape[0]),[r.shape[0]]);mr.lshifts(a,s.pick(null,0),11),mr.lshifts(o,s.pick(null,1),5),mr.boreq(a,o),mr.boreq(a,s.pick(null,2)),i=a}else{let n=(0,nn.default)(new Float32Array(r.size),r.shape);mr.assign(n,r),mr.mulseq(n.pick(null,0),Ii.maxIntBits(11)),mr.mulseq(n.pick(null,1),Ii.maxIntBits(10)),mr.mulseq(n.pick(null,2),Ii.maxIntBits(11)),mr.roundeq(n);let s=(0,nn.default)(new Uint32Array(n.data),r.shape),a=(0,nn.default)(new Uint32Array(r.shape[0]),[r.shape[0]]),o=(0,nn.default)(new Uint32Array(r.shape[0]),[r.shape[0]]);mr.lshifts(a,s.pick(null,0),21),mr.lshifts(o,s.pick(null,1),11),mr.boreq(a,o),mr.boreq(a,s.pick(null,2)),i=a}return new Ii(i,t)}dequantize(e,t){let r=this._method,i,n=this._quantized;if(r==="norm8x"){let s=Ii.maxIntBits(8);i=(0,nn.default)(new Float32Array(n.size),n.shape),mr.muls(i,n,1/s)}else if(r==="norm565"){let s=(0,nn.default)(new Uint8Array(n.shape[0]),[n.shape[0]]),a=(0,nn.default)(new Uint8Array(n.shape[0]),[n.shape[0]]),o=(0,nn.default)(new Uint8Array(n.shape[0]),[n.shape[0]]);mr.rrshifts(s,n,11),mr.rrshifts(a,n,5),mr.bandseq(a,Ii.maxIntBits(6)),mr.bands(o,n,Ii.maxIntBits(5)),i=(0,nn.default)(new Float32Array(n.shape[0]*3),[n.shape[0],3]),mr.muls(i.pick(null,0),s,1/Ii.maxIntBits(5)),mr.muls(i.pick(null,1),a,1/Ii.maxIntBits(6)),mr.muls(i.pick(null,2),o,1/Ii.maxIntBits(5))}else{let s=(0,nn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]),a=(0,nn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]),o=(0,nn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]);mr.rrshifts(s,n,21),mr.rrshifts(a,n,11),mr.bandseq(a,Ii.maxIntBits(10)),mr.bands(o,n,Ii.maxIntBits(11)),i=(0,nn.default)(new Float32Array(n.shape[0]*3),[n.shape[0],3]),mr.muls(i.pick(null,0),s,1/Ii.maxIntBits(11)),mr.muls(i.pick(null,1),a,1/Ii.maxIntBits(10)),mr.muls(i.pick(null,2),o,1/Ii.maxIntBits(11))}return new cT(i,e,t)}},Gi=class{constructor(t,r,i,n,s,a=!1){this._quantized=t,this._minMaxMatrix=r,this._chunkSize=i,this._quantizationMethod=n,this._variableChunkSize=s,this._isDynamicChunks=a}get length(){return this._quantized.shape[0]}get nchunks(){return this._minMaxMatrix.shape[0]}get quantized(){return this._quantized}get method(){return this._quantizationMethod}get minmaxMatrix(){return this._minMaxMatrix}_createPrunedMinMax(t){let r=t.length,i=this.minmaxMatrix.shape[0]-r,n=(0,dc.default)(new Float32Array(i*2),[i,2]),s=0,a=i,o=0,l=this.minmaxMatrix.shape[0];for(let c=0;c<t.length;c++)l=t[c],a=l-o+s,a>s&&vu.assign(n.hi(a,2).lo(s,0),this.minmaxMatrix.hi(l,2).lo(o,0)),s=a,o=l+1;return s<i&&vu.assign(n.lo(s,0),this.minmaxMatrix.lo(o,0)),n}_createPrunedQuantized(t){let r=t.length,i=this.quantized.shape[0]-r,n=this._quantizationMethod,s,a;if(n==="norm8x"){a=this._quantized.shape[1];let u=a?i*a:i;s=(0,dc.default)(new Uint8Array(u),a?[i,a]:[i,1])}else n==="norm565"?s=(0,dc.default)(new Uint16Array(i),[i]):s=(0,dc.default)(new Uint32Array(i),[i]);let o=0,l=i,c=0,d=s.shape[0];for(let u=0;u<t.length;u++)d=t[u],l=d-c+o,l>o&&(a?vu.assign(s.hi(l,a).lo(o,0),this._quantized.hi(d,a).lo(c,0)):vu.assign(s.hi(l).lo(o),this._quantized.hi(d).lo(c))),o=l,c=d+1;return o<i&&(a?vu.assign(s.lo(o,0),this._quantized.lo(c,0)):vu.assign(s.lo(o),this._quantized.lo(c))),s}pruneFeature(t,r,i){let n=this._createPrunedQuantized(t),s=this._createPrunedMinMax(r);return new Gi(n,s,this._chunkSize,this._quantizationMethod,i,!0)}static getRequiredNChunks(t,r){return Math.floor(t/r)}static fromArray(t,r,i){let n=t.shape[0],s=Math.floor(n/i),a=(0,dc.default)(new Float32Array(s*2),[s,2],[2,1]),o;r==="norm8x"?o=(0,dc.default)(new Uint8Array(t.size),t.shape):r==="norm565"?o=(0,dc.default)(new Uint16Array(t.shape[0]),[t.shape[0]]):o=(0,dc.default)(new Uint32Array(t.shape[0]),[t.shape[0]]);for(let l=0;l<s;l++){let c=l*i,d=l+1<s?(l+1)*i:n,u;t.shape.length>1?u=cT.createFromUnnormalized(t.hi(d,t.shape[1]).lo(c,0)):u=cT.createFromUnnormalized(t.hi(d).lo(c)),a.set(l,0,u.minD),a.set(l,1,u.maxD),o.shape.length>1?vu.assign(o.hi(d,o.shape[1]).lo(c,0),Ii.fromNormalized(u,r).quantized):vu.assign(o.hi(d).lo(c),Ii.fromNormalized(u,r).quantized)}return new Gi(o,a,i,r)}denormDequant(){let t=this._minMaxMatrix.shape[0],r=this._quantized,i=r.shape[0],n=this._quantizationMethod,s=this._chunkSize,a;if(this._isDynamicChunks){if(!this._variableChunkSize)throw new Error("variable chunk must exists if chunkSize isDynamic");a=this._variableChunkSize}let o;n==="norm8x"?o=(0,dc.default)(new Float32Array(r.size),r.shape):o=(0,dc.default)(new Float32Array(i*3),[i,3]);let l=0,c=s;for(let d=0;d<t;d++){let[u,h]=[this._minMaxMatrix.get(d,0),this._minMaxMatrix.get(d,1)];this._isDynamicChunks&&(c=a[d]);let f=d+1<t?l+c:i,p;r.shape.length>1?p=new Ii(r.hi(f,r.shape[1]).lo(l,0),n):p=new Ii(r.hi(f).lo(l),n),vu.assign(o.hi(f,o.shape[1]).lo(l,0),p.dequantize(u,h).denormalize()),l=f}return o}static async fetchArrayBuffer(t){return await(await fetch(t,{mode:"cors"})).arrayBuffer()}},Nd=Pn(fw()),Tr=Pn(pw()),nat="http://127.0.0.1:8000",xv=Pn(fw()),yn=Pn(pw()),z7=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function B7(e){return e<1e5?e<100?e<10?0:1:e<1e4?e<1e3?2:3:4:e<1e7?e<1e6?5:6:e<1e9?e<1e8?7:8:9}function F7(e,t){if(e===t)return 0;if(~~e===e&&~~t===t){if(e===0||t===0)return e<t?-1:1;if(e<0||t<0){if(t>=0)return-1;if(e>=0)return 1;e=-e,t=-t}let n=B7(e),s=B7(t),a=0;return n<s?(e*=z7[s-n-1],t/=10,a=-1):n>s&&(t*=z7[n-s-1],e/=10,a=1),e===t?a:e<t?-1:1}let r=String(e),i=String(t);return r===i?0:r<i?-1:1}function sat(e){let t=0;for(;e>=32;)t|=e&1,e>>=1;return e+t}function j7(e,t,r,i){let n=t+1;if(n===r)return 1;if(i(e[n++],e[t])<0){for(;n<r&&i(e[n],e[n-1])<0;)n++;aat(e,t,n)}else for(;n<r&&i(e[n],e[n-1])>=0;)n++;return n-t}function aat(e,t,r){for(r--;t<r;){let i=e[t];e[t++]=e[r],e[r--]=i}}function V7(e,t,r,i,n){for(i===t&&i++;i<r;i++){let s=e[i],a=t,o=i;for(;a<o;){let c=a+o>>>1;n(s,e[c])<0?o=c:a=c+1}let l=i-a;switch(l){case 3:e[a+3]=e[a+2];case 2:e[a+2]=e[a+1];case 1:e[a+1]=e[a];break;default:for(;l>0;)e[a+l]=e[a+l-1],l--}e[a]=s}}function SD(e,t,r,i,n,s){let a=0,o=0,l=1;if(s(e,t[r+n])>0){for(o=i-n;l<o&&s(e,t[r+n+l])>0;)a=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o),a+=n,l+=n}else{for(o=n+1;l<o&&s(e,t[r+n-l])<=0;)a=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o);let c=a;a=n-l,l=n-c}for(a++;a<l;){let c=a+(l-a>>>1);s(e,t[r+c])>0?a=c+1:l=c}return l}function ED(e,t,r,i,n,s){let a=0,o=0,l=1;if(s(e,t[r+n])<0){for(o=n+1;l<o&&s(e,t[r+n-l])<0;)a=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o);let c=a;a=n-l,l=n-c}else{for(o=i-n;l<o&&s(e,t[r+n+l])>=0;)a=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o),a+=n,l+=n}for(a++;a<l;){let c=a+(l-a>>>1);s(e,t[r+c])<0?l=c:a=c+1}return l}var oat=class{constructor(e,t){fa(this,"array",null),fa(this,"compare",null),fa(this,"minGallop",7),fa(this,"length",0),fa(this,"tmpStorageLength",256),fa(this,"stackLength",0),fa(this,"runStart",null),fa(this,"runLength",null),fa(this,"stackSize",0),this.array=e,this.compare=t,this.length=e.length,this.length<2*256&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}pushRun(e,t){this.runStart[this.stackSize]=e,this.runLength[this.stackSize]=t,this.stackSize+=1}mergeRuns(){for(;this.stackSize>1;){let e=this.stackSize-2;if(e>=1&&this.runLength[e-1]<=this.runLength[e]+this.runLength[e+1]||e>=2&&this.runLength[e-2]<=this.runLength[e]+this.runLength[e-1])this.runLength[e-1]<this.runLength[e+1]&&e--;else if(this.runLength[e]>this.runLength[e+1])break;this.mergeAt(e)}}forceMergeRuns(){for(;this.stackSize>1;){let e=this.stackSize-2;e>0&&this.runLength[e-1]<this.runLength[e+1]&&e--,this.mergeAt(e)}}mergeAt(e){let t=this.compare,r=this.array,i=this.runStart[e],n=this.runLength[e],s=this.runStart[e+1],a=this.runLength[e+1];this.runLength[e]=n+a,e===this.stackSize-3&&(this.runStart[e+1]=this.runStart[e+2],this.runLength[e+1]=this.runLength[e+2]),this.stackSize--;let o=ED(r[s],r,i,n,0,t);i+=o,n-=o,n!==0&&(a=SD(r[i+n-1],r,s,a,a-1,t),a!==0&&(n<=a?this.mergeLow(i,n,s,a):this.mergeHigh(i,n,s,a)))}mergeLow(e,t,r,i){let n=this.compare,s=this.array,a=this.tmp,o=0;for(o=0;o<t;o++)a[o]=s[e+o];let l=0,c=r,d=e;if(s[d++]=s[c++],--i===0){for(o=0;o<t;o++)s[d+o]=a[l+o];return}if(t===1){for(o=0;o<i;o++)s[d+o]=s[c+o];s[d+i]=a[l];return}let u=this.minGallop;for(;;){let h=0,f=0,p=!1;do if(n(s[c],a[l])<0){if(s[d++]=s[c++],f++,h=0,--i===0){p=!0;break}}else if(s[d++]=a[l++],h++,f=0,--t===1){p=!0;break}while((h|f)<u);if(p)break;do{if(h=ED(s[c],a,l,t,0,n),h!==0){for(o=0;o<h;o++)s[d+o]=a[l+o];if(d+=h,l+=h,t-=h,t<=1){p=!0;break}}if(s[d++]=s[c++],--i===0){p=!0;break}if(f=SD(a[l],s,c,i,0,n),f!==0){for(o=0;o<f;o++)s[d+o]=s[c+o];if(d+=f,c+=f,i-=f,i===0){p=!0;break}}if(s[d++]=a[l++],--t===1){p=!0;break}u--}while(h>=7||f>=7);if(p)break;u<0&&(u=0),u+=2}if(this.minGallop=u,u<1&&(this.minGallop=1),t===1){for(o=0;o<i;o++)s[d+o]=s[c+o];s[d+i]=a[l]}else{if(t===0)throw new Error("mergeLow preconditions were not respected");for(o=0;o<t;o++)s[d+o]=a[l+o]}}mergeHigh(e,t,r,i){let n=this.compare,s=this.array,a=this.tmp,o=0;for(o=0;o<i;o++)a[o]=s[r+o];let l=e+t-1,c=i-1,d=r+i-1,u=0,h=0;if(s[d--]=s[l--],--t===0){for(u=d-(i-1),o=0;o<i;o++)s[u+o]=a[o];return}if(i===1){for(d-=t,l-=t,h=d+1,u=l+1,o=t-1;o>=0;o--)s[h+o]=s[u+o];s[d]=a[c];return}let f=this.minGallop;for(;;){let p=0,m=0,g=!1;do if(n(a[c],s[l])<0){if(s[d--]=s[l--],p++,m=0,--t===0){g=!0;break}}else if(s[d--]=a[c--],m++,p=0,--i===1){g=!0;break}while((p|m)<f);if(g)break;do{if(p=t-ED(a[c],s,e,t,t-1,n),p!==0){for(d-=p,l-=p,t-=p,h=d+1,u=l+1,o=p-1;o>=0;o--)s[h+o]=s[u+o];if(t===0){g=!0;break}}if(s[d--]=a[c--],--i===1){g=!0;break}if(m=i-SD(s[l],a,0,i,i-1,n),m!==0){for(d-=m,c-=m,i-=m,h=d+1,u=c+1,o=0;o<m;o++)s[h+o]=a[u+o];if(i<=1){g=!0;break}}if(s[d--]=s[l--],--t===0){g=!0;break}f--}while(p>=7||m>=7);if(g)break;f<0&&(f=0),f+=2}if(this.minGallop=f,f<1&&(this.minGallop=1),i===1){for(d-=t,l-=t,h=d+1,u=l+1,o=t-1;o>=0;o--)s[h+o]=s[u+o];s[d]=a[c]}else{if(i===0)throw new Error("mergeHigh preconditions were not respected");for(u=d-(i-1),o=0;o<i;o++)s[u+o]=a[o]}}};function lat(e,t,r,i){if(!Array.isArray(e))throw new TypeError("Can only sort arrays");t?typeof t!="function"&&(i=r,r=t,t=F7):t=F7,r||(r=0),i||(i=e.length);let n=i-r;if(n<2)return;let s=0;if(n<32){s=j7(e,r,i,t),V7(e,r,i,r+s,t);return}let a=new oat(e,t),o=sat(n);do{if(s=j7(e,r,i,t),s<o){let l=n;l>o&&(l=o),V7(e,r,r+l,r+s,t),s=l}a.pushRun(r,s),a.mergeRuns(),n-=s,r+=s}while(n!==0);a.forceMergeRuns()}function CD(e){let t=(0,xv.default)(new Int32Array(e.shape[0]),[e.shape[0]]),r=(0,xv.default)(new Int32Array(e.shape[0]),[e.shape[0]]);return yn.bands(t,e,1023),yn.lshifts(r,t,16),yn.bxoreq(t,r),yn.bandseq(t,4278190335),yn.lshifts(r,t,8),yn.bxoreq(t,r),yn.bandseq(t,50393103),yn.lshifts(r,t,4),yn.bxoreq(t,r),yn.bandseq(t,51130563),yn.lshifts(r,t,2),yn.bxoreq(t,r),yn.bandseq(t,153391689),t}function cat(e){let t=CD(e.pick(null,0)),r=CD(e.pick(null,1));yn.lshiftseq(r,1);let i=CD(e.pick(null,2));return yn.lshiftseq(i,2),yn.boreq(t,r),yn.boreq(t,i),t}function tg(e,t){if(e.shape[0]!==t.shape[0])throw new Error("wrong length");let r=(0,xv.default)(new Float32Array(e.size),e.shape,e.stride,e.offset);for(let i=0;i<t.shape[0];i++){let n=t.get(i);if(e.shape.length>1)for(let s=0;s<e.shape[1];s++)r.set(i,s,e.get(n,s));else r.set(i,e.get(n))}return r}function uat(e){let t=yn.sup(e),r=yn.inf(e),i=1e3/Math.min(1e3,t-r),n=(0,xv.default)(new Float32Array(e.data),e.shape);yn.mulseq(n,i);let s=(0,xv.default)(new Int32Array(n.data),e.shape),a=cat(s),o=Array.from(a.data).map((c,d)=>[c,d]);lat(o,(c,d)=>c[0]-d[0]);let l=o.map(([c,d])=>d);return(0,xv.default)(Uint32Array.from(l))}var Af=class{constructor(e,t,r,i,n,s,a,o,l,c){this.propertyDescs=e,this.format=t,this.nsplats=r,this.xyz=i,this.colors=n,this.harmonics=s,this.opacity=a,this.scaling=o,this.rotation=l,this.maxSHDegree=c}getPlyBinary(){let e=Af._generateHeaderString(this.propertyDescs,this.format,this.nsplats),t=new TextEncoder().encode(e),r=Object.keys(this.propertyDescs).length,i=(0,Nd.default)(new Float32Array(this.nsplats*r),[this.nsplats,r]);if(Tr.assign(i.pick(null,this.propertyDescs.x.index),this.xyz.pick(null,0)),Tr.assign(i.pick(null,this.propertyDescs.y.index),this.xyz.pick(null,1)),Tr.assign(i.pick(null,this.propertyDescs.z.index),this.xyz.pick(null,2)),Tr.assign(i.pick(null,this.propertyDescs.f_dc_0.index),this.colors.pick(null,0)),Tr.assign(i.pick(null,this.propertyDescs.f_dc_1.index),this.colors.pick(null,1)),Tr.assign(i.pick(null,this.propertyDescs.f_dc_2.index),this.colors.pick(null,2)),Tr.assign(i.pick(null,this.propertyDescs.opacity.index),this.opacity.pick(null,0)),Tr.assign(i.pick(null,this.propertyDescs.scale_0.index),this.scaling.pick(null,0)),Tr.assign(i.pick(null,this.propertyDescs.scale_1.index),this.scaling.pick(null,1)),Tr.assign(i.pick(null,this.propertyDescs.scale_2.index),this.scaling.pick(null,2)),Tr.assign(i.pick(null,this.propertyDescs.rot_0.index),this.rotation.pick(null,0)),Tr.assign(i.pick(null,this.propertyDescs.rot_1.index),this.rotation.pick(null,1)),Tr.assign(i.pick(null,this.propertyDescs.rot_2.index),this.rotation.pick(null,2)),Tr.assign(i.pick(null,this.propertyDescs.rot_3.index),this.rotation.pick(null,3)),this.harmonics&&this.harmonics.length>0)for(let a=0;a<this.harmonics.length;a++){let o=a*3;Tr.assign(i.pick(null,this.propertyDescs[`f_rest_${o}`].index),this.harmonics[a].pick(null,0)),Tr.assign(i.pick(null,this.propertyDescs[`f_rest_${o+1}`].index),this.harmonics[a].pick(null,1)),Tr.assign(i.pick(null,this.propertyDescs[`f_rest_${o+2}`].index),this.harmonics[a].pick(null,2))}let n=new Uint8Array(i.data.buffer),s=new Uint8Array(n.length+t.length);return s.set(t),s.set(n,t.length),s.buffer}save(e,t){let r=this.getPlyBinary(),i=new Blob([r],{type:"application/octet-stream"}),n=new File([i],e),s=new FormData;s.append("file",n),s.append("filename",e),s.append("basedir",t),fetch(`${nat}/push_file`,{method:"POST",body:s})}static async loadFile(e){return await(await fetch(e)).arrayBuffer()}mortonPositionSplatsSort(){let e=uat(this.xyz),t=tg(this.xyz,e),r=tg(this.colors,e),i=tg(this.opacity,e),n=tg(this.scaling,e),s=tg(this.rotation,e),a=[];for(let o=0;o<this.harmonics.length;o++)a.push(tg(this.harmonics[o],e));return new Af(this.propertyDescs,this.format,this.nsplats,t,r,a,i,n,s,this.maxSHDegree)}static _generateHeaderString(e,t,r){let i=`ply
format ${t.format} ${t.version}
element vertex ${r}`,n=Object.keys(e).length,s=Array(n);for(let a in e){let o=e[a];s[o.index]={name:a,dtype:o.dtype}}for(let a=0;a<s.length;a++)i=`${i}
property ${s[a].dtype} ${s[a].name}`;return`${i}
end_header
`}static fromArrayBuffer(e,t=3){let{splatCount:r,vertexData:i,propertiesDesc:n,format:s}=Af.decodeHeader(e),a=i.buffer.slice(i.byteOffset),o=Object.keys(n).length,l=(0,Nd.default)(new Float32Array(a),[r,o]),c=0,d={},u={double:8,int:4,uint:4,float:4,short:2,ushort:2,uchar:1};for(let b in n)if(n.hasOwnProperty(b)){let x=n[b].dtype;d[b]=c,c+=u[x]}let h=(0,Nd.default)(new Float32Array(r*3),[r,3]);Tr.assign(h.pick(null,0),l.pick(null,d.x/4)),Tr.assign(h.pick(null,1),l.pick(null,d.y/4)),Tr.assign(h.pick(null,2),l.pick(null,d.z/4));let f=(0,Nd.default)(new Float32Array(r*3),[r,3]);Tr.assign(f.pick(null,0),l.pick(null,d.scale_0/4)),Tr.assign(f.pick(null,1),l.pick(null,d.scale_1/4)),Tr.assign(f.pick(null,2),l.pick(null,d.scale_2/4));let p=(0,Nd.default)(new Float32Array(r*3),[r,3]);Tr.assign(p.pick(null,0),l.pick(null,d.f_dc_0/4)),Tr.assign(p.pick(null,1),l.pick(null,d.f_dc_1/4)),Tr.assign(p.pick(null,2),l.pick(null,d.f_dc_2/4));let m=(0,Nd.default)(new Float32Array(r*4),[r,4]);Tr.assign(m.pick(null,0),l.pick(null,d.rot_1/4)),Tr.assign(m.pick(null,1),l.pick(null,d.rot_2/4)),Tr.assign(m.pick(null,2),l.pick(null,d.rot_3/4)),Tr.assign(m.pick(null,3),l.pick(null,d.rot_0/4));for(let b=0;b<r;b++){let x=m.pick(b,null),S=Math.sqrt(x.get(0)**2+x.get(1)**2+x.get(2)**2+x.get(3)**2);Tr.divseq(x,S)}let g=(0,Nd.default)(new Float32Array(r*1),[r,1]);Tr.assign(g.pick(null,0),l.pick(null,d.opacity/4));let v=(Math.min(Math.max(t,0),3)+1)**2-1,y=[];for(let b=0;b<v;b++){let x=(0,Nd.default)(new Float32Array(r*3),[r,3]),S=b*3;Tr.assign(x.pick(null,0),l.pick(null,d[`f_rest_${S}`]/4)),Tr.assign(x.pick(null,1),l.pick(null,d[`f_rest_${S+1}`]/4)),Tr.assign(x.pick(null,2),l.pick(null,d[`f_rest_${S+2}`]/4)),y.push(x)}return new Af(n,s,r,h,p,y,g,f,m,t)}static async fromPLYFile(e,t=3){let r=await Af.loadFile(e);return Af.fromArrayBuffer(r,t)}static decodeHeader(e){let t=new TextDecoder,r=0,i="",n=100;for(;;){if(r+n>=e.byteLength)throw new Error("End of file reached while searching for end of header");let h=new Uint8Array(e,r,n);i+=t.decode(h),r+=n;let f=r-n*2,p=new Uint8Array(e,Math.max(0,f),f>0?n*2:n);if(t.decode(p).includes("end_header"))break}let s=i.split(`
`),a=0,o={},l=0,c;for(let h=0;h<s.length;h++){let f=s[h].trim();if(f.startsWith("element vertex")){let p=f.match(/\d+/);p&&(a=parseInt(p[0]))}else if(f.startsWith("property")){let p=f.match(/(\w+)\s+(\w+)\s+(\w+)/);if(p){let m=p[2],g=p[3];o[g]={dtype:m,index:l},l++}}else if(f.startsWith("format")){let p=f.match(/(\w+)\s+(\w+)\s+(\d+\.?\d*)/);p&&(c={format:p[2],version:p[3]})}else if(f==="end_header")break}let d=i.indexOf("end_header")+10+1,u=new DataView(e,d);return{splatCount:a,vertexData:u,headerOffset:r,propertiesDesc:o,format:c}}},dk=class{constructor(e,t,r,i,n,s,a,o){this.config=e,this.xyz=t,this.scaling=r,this.color=i,this.opacity=n,this.harmonics=a,this.quaternion=s,this.variableChunkSize=o}get isDynamicChunks(){return this.variableChunkSize&&this.variableChunkSize.length>0}get nchunks(){return this.xyz.nchunks}get nsplats(){return this.xyz.length}get chunkSize(){return this.config.chunkSize}static compressFromGaussianData(e,t){let r=Gi.fromArray(e.xyz,t.xyz,t.chunkSize),i=Gi.fromArray(e.scaling,t.scaling,t.chunkSize),n=Gi.fromArray(e.colors,t.color,t.chunkSize),s=Gi.fromArray(e.opacity,t.opacity,t.chunkSize),a=Gi.fromArray(e.rotation,t.quaternion,t.chunkSize),o=e.harmonics,l=[];if(t.harmonics)for(let c=0;c<o.length;c++){let d=Gi.fromArray(o[c],t.harmonics,t.chunkSize);l.push(d)}return new dk(t,r,i,n,s,a,l)}_countIndexesInChunks(e){let t=[],r=this.nchunks,i=this.chunkSize,n=this.nsplats,s=Gi.getRequiredNChunks(n,i);if(r===s)for(let a=0;a<e.length;a++){let o=e[a],l=Math.floor(o/this.chunkSize);l in t?t[l].push(o):t[l]=[o]}else{let a=this.variableChunkSize,o={},l=0;for(let c=0;c<r;c++)o[c]=l,l+=a[c];for(let c=0;c<e.length;c++){let d=e[c],u=Math.min(Math.floor(d/i),r-1);for(;d>=o[u]+a[u];)u++;u in t?t[u].push(d):t[u]=[d]}}return t}pruneSplats(e){let t=this._countIndexesInChunks(e),r,i=[];return t.length>0&&(r=this.variableChunkSize?[...this.variableChunkSize]:Array(this.nchunks).fill(this.chunkSize),t.forEach((n,s)=>{r[s]-=n.length,r[s]<=0&&i.push(s)}),r=r.filter(n=>n>0)),new dk(this.config,this.xyz.pruneFeature(e,i,r),this.scaling.pruneFeature(e,i,r),this.color.pruneFeature(e,i,r),this.opacity.pruneFeature(e,i,r),this.quaternion.pruneFeature(e,i,r),this.harmonics?this.harmonics.map(n=>n.pruneFeature(e,i,this.variableChunkSize)):void 0,r)}static async loadConfig(e){return await(await fetch(e,{method:"GET",mode:"cors",headers:{Accept:"application/json"}})).json()}toGaussians(){var n;let e={format:"binary_little_endian",version:"1.0"},t={},r=0;if(t.x={dtype:"float",index:r},r++,t.y={dtype:"float",index:r},r++,t.z={dtype:"float",index:r},r++,t.f_dc_0={dtype:"float",index:r},r++,t.f_dc_1={dtype:"float",index:r},r++,t.f_dc_2={dtype:"float",index:r},r++,this.harmonics&&this.harmonics.length>0)for(let s=0;s<this.harmonics.length;s++)t[`f_rest_${s}`]={dtype:"float",index:r},r++,t[`f_rest_${s+1}`]={dtype:"float",index:r},r++,t[`f_rest_${s+2}`]={dtype:"float",index:r},r++;t.opacity={dtype:"float",index:r},r++,t.scale_0={dtype:"float",index:r},r++,t.scale_1={dtype:"float",index:r},r++,t.scale_2={dtype:"float",index:r},r++,t.rot_0={dtype:"float",index:r},r++,t.rot_1={dtype:"float",index:r},r++,t.rot_2={dtype:"float",index:r},r++,t.rot_3={dtype:"float",index:r},r++;let i=(n=this.harmonics)==null?void 0:n.map(s=>s.denormDequant());return new Af(t,e,this.xyz.length,this.xyz.denormDequant(),this.color.denormDequant(),i||[],this.opacity.denormDequant(),this.scaling.denormDequant(),this.quaternion.denormDequant(),3)}},rg=Pn(fw()),Bo=Pn(pw()),U7={xyz:3,color:3,opacity:1,scaling:3,quaternion:4,harmonics:3},hk=class{constructor(e){this._buffer=e}get buffer(){return this._buffer}get decoded(){return this._decoded||(this._decoded=this.decodeBuffer()),this._decoded}get colorsA(){let e=.28209479177387814,t=this.decoded.color.denormDequant(),r=this.decoded.opacity.denormDequant(),i=(0,rg.default)(new Float32Array(t.shape[0]*4),[t.shape[0],4]);return Bo.mulseq(t,e),Bo.addseq(t,.5),Bo.mulseq(t,255),Bo.maxseq(t,0),Bo.minseq(t,255),Bo.negeq(r),Bo.expeq(r),Bo.addseq(r,1),Bo.recipeq(r),Bo.mulseq(r,255),Bo.assign(i.hi(t.shape[0],3).lo(0,0),t),Bo.assign(i.hi(t.shape[0],4).lo(0,3),r),(0,rg.default)(new Uint8Array(i.data),[t.shape[0],4]).data}get nsplats(){return this.decoded.nsplats}getSplatCount(){return this.decoded.nsplats}get precomputedCovarianceBufferData(){return this._precomputedCovarianceBufferData}decodeBuffer(){let{splatCount:e,chunkCount:t,chunkSize:r,typeChunks:i,vertexData:n,propertiesDesc:s}=this.decodeHeader(),a={xyz:s.xyz.compressionMethod,color:s.color.compressionMethod,opacity:s.opacity.compressionMethod,scaling:s.scaling.compressionMethod,quaternion:s.quaternion.compressionMethod,chunkSize:r};s.harmonics_0&&(a.harmonics=s.harmonics_0.compressionMethod);let o=n.byteOffset,l=Array(Object.keys(s).length);for(let g in s)l[s[g].index]={name:g,method:s[g].compressionMethod};let c=t*2*4,d=o,u=i==="dynamic"?t*2:0,h,f=!1;if(u>0){let g=new Uint16Array(n.buffer.slice(d,d+u));d+=u,h=Array.from(g),f=!0}let p={};for(let g of l){let v=0,y=!0;if(g.method==="norm8x")v=e*1*U7[g.name];else if(g.method==="norm11")v=e*4;else if(g.method==="norm565")v=e*2;else throw y=!1,new Error(`Not Implemented format: ${g.method}`);let b;if(y){let w=n.buffer.slice(d,d+c);b=(0,rg.default)(new Float32Array(w),[t,2]),d+=c}else throw new Error("loading chunk byt hasnot minmax!");let x=n.buffer.slice(d,d+v);d+=v;let S;if(g.method==="norm8x")S=(0,rg.default)(new Uint8Array(x),[e,U7[g.name]]);else if(g.method==="norm11")S=(0,rg.default)(new Uint32Array(x));else if(g.method==="norm565")S=(0,rg.default)(new Uint16Array(x));else throw new Error(`Not Implemented format: ${g.method}`);p[g.name]=new Gi(S,b,r,g.method,h,f)}let m=[];for(let g=0;g<15;g++){let v=p[`harmonics_${g}`];v&&(m.push(v),delete p[`harmonics_${g}`])}return m.length>0&&(p.harmonics=m),new dk(a,p.xyz,p.scaling,p.color,p.opacity,p.quaternion,p.harmonics,h)}buildPreComputedBuffers(){let e=this.decoded,t=e.nsplats,r=new ArrayBuffer(24*t),i=new Float32Array(r),n=e.scaling.denormDequant(),s=e.quaternion.denormDequant(),a=new Xt,o=new on,l=new on,c=new on,d=new Ke;for(let u=0;u<t;u++){d.makeScale(Math.exp(n.get(u,0)),Math.exp(n.get(u,1)),Math.exp(n.get(u,2))),l.setFromMatrix4(d),a.set(s.get(u,0),s.get(u,1),s.get(u,2),s.get(u,3)),d.makeRotationFromQuaternion(a),o.setFromMatrix4(d),c.copy(o).multiply(l);let h=c.elements;i[6*u]=h[0]*h[0]+h[3]*h[3]+h[6]*h[6],i[6*u+1]=h[0]*h[1]+h[3]*h[4]+h[6]*h[7],i[6*u+2]=h[0]*h[2]+h[3]*h[5]+h[6]*h[8],i[6*u+3]=h[1]*h[1]+h[4]*h[4]+h[7]*h[7],i[6*u+4]=h[1]*h[2]+h[4]*h[5]+h[7]*h[8],i[6*u+5]=h[2]*h[2]+h[5]*h[5]+h[8]*h[8]}this._precomputedCovarianceBufferData=r}decodeHeader(){let e=this._buffer,t=new TextDecoder,r=0,i="",n=100;for(;;){if(r+n>=e.byteLength)throw new Error("End of file reached while searching for end of header");let p=new Uint8Array(e,r,n);i+=t.decode(p),r+=n;let m=r-n*2,g=new Uint8Array(e,Math.max(0,m),m>=0?n*2:n);if(t.decode(g).includes("end_header"))break}let s=i.split(`
`),a=0,o=0,l=0,c=0,d="",u={};for(let p=0;p<s.length;p++){let m=s[p].trim();if(m.startsWith("element vertex")){let g=m.match(/\d+/);g&&(a=parseInt(g[0]))}else if(m.startsWith("property")){let g=m.match(/(\w+)\s+(\w+)\s+(\w+)/);if(g){let v=g[2],y=g[3];u[v]={compressionMethod:y,index:c},c++}}else if(m.startsWith("element chunks")){let g=m.match(/\d+/);g&&(o=parseInt(g[0]))}else if(m.startsWith("element chunkSize")){let g=m.match(/\d+/);g&&(l=parseInt(g[0]))}else if(m.startsWith("element typeChunks")){let g=m.match(/(\w+)\s+(\w+)\s+(\w+)/);g&&(d=g[3])}else if(m==="end_header")break}let h=i.indexOf("end_header")+10+1,f=new DataView(e,h);return{splatCount:a,chunkCount:o,chunkSize:l,typeChunks:d,vertexData:f,propertiesDesc:u}}pruneSplats(e){let t=this.decodeBuffer().pruneSplats(e);return hk.fromCompressedGaussianSplats(t)}static fromCompressedGaussianSplats(e){let t=e.xyz.length,r=e.xyz.nchunks,i=`gspline
element vertex ${t}
element chunks ${r}
element chunkSize ${e.chunkSize}
element typeChunks ${e.isDynamicChunks?"dynamic":"static"}
property xyz ${e.xyz.method}
property color ${e.color.method}
property opacity ${e.opacity.method}
property scaling ${e.scaling.method}
property quaternion ${e.quaternion.method}`;if(e.harmonics&&e.harmonics.length>0)for(let E=0;E<e.harmonics.length;E++)i=`${i}
property harmonics_${E} ${e.harmonics[E].method}`;i=`${i}
end_header
`;let n=new TextEncoder().encode(i),s=r*2*4,a=e.xyz.quantized.data.buffer.byteLength,o=e.xyz instanceof Gi?s:0,l=e.color.quantized.data.buffer.byteLength,c=e.color instanceof Gi?s:0,d=e.opacity.quantized.data.buffer.byteLength,u=e.opacity instanceof Gi?s:0,h=e.scaling.quantized.data.buffer.byteLength,f=e.scaling instanceof Gi?s:0,p=e.quaternion.quantized.data.buffer.byteLength,m=e.quaternion instanceof Gi?s:0,g=e.variableChunkSize?Uint16Array.from(e.variableChunkSize):void 0,v=g?g.byteLength:0,y=n.byteLength+v+a+o+l+c+d+u+h+f+p+m,b=0,x=0;if(e.harmonics&&e.harmonics.length>0)for(let E=0;E<e.harmonics.length;E++)b+=e.harmonics[E].quantized.data.buffer.byteLength,x+=e.harmonics[E]instanceof Gi?s:0;b=0,x=0,y+=b+x;let S=new Uint8Array(y),w=0;if(S.set(n,w),w+=n.byteLength,v>0&&(S.set(new Uint8Array(g.buffer),w),w+=v),e.xyz instanceof Gi&&(S.set(new Uint8Array(e.xyz.minmaxMatrix.data.buffer),w),w+=s),S.set(new Uint8Array(e.xyz.quantized.data.buffer),w),w+=a,e.color instanceof Gi&&(S.set(new Uint8Array(e.color.minmaxMatrix.data.buffer),w),w+=s),S.set(new Uint8Array(e.color.quantized.data.buffer),w),w+=l,e.opacity instanceof Gi&&(S.set(new Uint8Array(e.opacity.minmaxMatrix.data.buffer),w),w+=s),S.set(new Uint8Array(e.opacity.quantized.data.buffer),w),w+=d,e.scaling instanceof Gi&&(S.set(new Uint8Array(e.scaling.minmaxMatrix.data.buffer),w),w+=s),S.set(new Uint8Array(e.scaling.quantized.data.buffer),w),w+=h,e.quaternion instanceof Gi&&(S.set(new Uint8Array(e.quaternion.minmaxMatrix.data.buffer),w),w+=s),S.set(new Uint8Array(e.quaternion.quantized.data.buffer),w),w+=p,b>0&&e.harmonics&&e.harmonics.length>0)for(let E=0;E<e.harmonics.length;E++){let C=e.harmonics[E];C instanceof Gi&&(S.set(new Uint8Array(C.minmaxMatrix.data.buffer),w),w+=s),S.set(new Uint8Array(C.quantized.data.buffer),w),w+=C.quantized.data.byteLength}return new hk(S.buffer)}},dat="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",mh=class{};fa(mh,"DepthMapRange",65536),fa(mh,"MemoryPageSize",65536),fa(mh,"BytesPerFloat",4),fa(mh,"BytesPerInt",4);function hat(e){let t,r,i,n,s,a,o,l,c,d,u,h,f,p,m,g;function v(M){let P=new Float64Array(d,a,16);for(let R=0;R<16;R++)P[R]=M[R];let I;if(i>1){t.exports.sortIndexes(n,s,c,a,o,l,h.DepthMapRange,i);let R=new Uint32Array(i);I=R.buffer,R.set(new Uint32Array(d,l,i))}else if(i===1){let R=new Uint32Array(i);R[0]=new Uint32Array(d,n,r)[0],I=R.buffer}else I=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:I},[I])}function y(M,P,I){let R=new Float32Array(d,s,r*3);i=0;let N=new Uint32Array(d,n,r);for(let k=0;k<I.length-1;k++){let O=P[k],D=M[k].elements,B=O.filter(F=>F.enabled&&F.mode==="Include").map(F=>F.type==="Box"?w(F):T(F)),z=O.filter(F=>F.enabled&&F.mode==="Exclude").map(F=>F.type==="Box"?w(F):T(F));for(let F=I[k];F<I[k+1];F++){let V=f[F*3],Y=f[F*3+1],W=f[F*3+2];if((B.length===0||x(V,Y,W,B))&&(z.length===0||!x(V,Y,W,z))){let X=1/(D[3]*V+D[7]*Y+D[11]*W+D[15]);R[i*3]=(D[0]*V+D[4]*Y+D[8]*W+D[12])*X,R[i*3+1]=(D[1]*V+D[5]*Y+D[9]*W+D[13])*X,R[i*3+2]=(D[2]*V+D[6]*Y+D[10]*W+D[14])*X,N[i]=F,i++}}}}function b(M,P){let I=[],R=P.filter(O=>O.enabled&&O.mode==="Include").map(O=>O.type==="Box"?w(O):T(O)),N=P.filter(O=>O.enabled&&O.mode==="Exclude").map(O=>O.type==="Box"?w(O):T(O)),k=M.length;for(let O=0;O<k;O+=3){let D=M[O],B=M[O+1],z=M[O+2];(R.length===0||x(D,B,z,R))&&(N.length===0||!x(D,B,z,N))||I.push(O/3)}return console.log(I),I}function x(M,P,I,R,N){return R[N==="Intersect"?"every":"some"](k=>{let O=S(M,P,I,k.invRotationMatrix,k.cropCenter);return Array.isArray(k)?C(O.x,O.y,O.z,k):A(O.x,O.y,O.z,k)})}function S(M,P,I,R,N){let k=M-N[0],O=P-N[1],D=I-N[2],B=1/(R[3]*k+R[7]*O+R[11]*D+R[15]);return{x:(R[0]*k+R[4]*O+R[8]*D+R[12])*B+N[0],y:(R[1]*k+R[5]*O+R[9]*D+R[13])*B+N[1],z:(R[2]*k+R[6]*O+R[10]*D+R[14])*B+N[2]}}function w(M){let P=M.cropSize[0]/2,I=M.cropSize[1]/2,R=M.cropSize[2]/2,N=[M.cropCenter[0]-P,M.cropCenter[1]-I,M.cropCenter[2]-R,M.cropCenter[0]+P,M.cropCenter[1]+I,M.cropCenter[2]+R],k=E(M.cropRotation);return Object.assign(N,{invRotationMatrix:k,cropCenter:M.cropCenter})}function E(M){let P=[],I=M[0]*Math.PI/180,R=M[1]*Math.PI/180,N=M[2]*Math.PI/180,k=Math.cos(I),O=Math.sin(I),D=Math.cos(R),B=Math.sin(R),z=Math.cos(N),F=Math.sin(N),V=k*z,Y=k*F,W=O*z,X=O*F;return P[0]=D*z,P[1]=-D*F,P[2]=B,P[4]=Y+W*B,P[5]=V-X*B,P[6]=-O*D,P[8]=X-V*B,P[9]=W+Y*B,P[10]=k*D,P[12]=0,P[13]=0,P[14]=0,P[3]=0,P[7]=0,P[11]=0,P[15]=1,P}function C(M,P,I,R){return M>=R[0]&&M<=R[3]&&P>=R[1]&&P<=R[4]&&I>=R[2]&&I<=R[5]}function T(M){let P=2/M.cropSize[0],I=2/M.cropSize[1],R=2/M.cropSize[2],N=E(M.cropRotation);return{invRadiusX:P,invRadiusY:I,invRadiusZ:R,cropCenter:M.cropCenter,invRotationMatrix:N}}function A(M,P,I,R){let N=(M-R.cropCenter[0])*R.invRadiusX,k=(P-R.cropCenter[1])*R.invRadiusY,O=(I-R.cropCenter[2])*R.invRadiusZ;return N*N+k*k+O*O<=1}e.onmessage=M=>{if(M.data.getCroppedIndexes){let P=new Uint32Array(b(new Float32Array(M.data.positions),M.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:P},[P])}else if(M.data.positions)u=M.data.positions,f=new Float32Array(u),m=M.data.meshMatrixWorlds,g=M.data.cropsArray,p=M.data.meshIndexIntervals,y(m,g,p),e.postMessage({sortSetupComplete:!0});else if(M.data.sort||M.data.newMatrixWorlds||M.data.newCropsArray)(M.data.newMatrixWorlds||M.data.newCropsArray)&&(g=M.data.newCropsArray||g,m=M.data.newMatrixWorlds||m,y(m,g,p)),v(M.data.sort.view,M.data.sort.cameraPosition);else if(M.data.init){h=M.data.init.Constants,r=M.data.init.splatCount;let P=h.BytesPerInt,I=h.BytesPerFloat*3,R=new Uint8Array(M.data.init.sorterWasmBytes),N=P+I,k=r*N,O=r*h.BytesPerInt*2+h.DepthMapRange*h.BytesPerInt*2,D=h.MemoryPageSize*32,B=k+O+D,z=Math.floor(B/h.MemoryPageSize)+1,F={module:{},env:{memory:new WebAssembly.Memory({initial:z*2,maximum:z*3,shared:!0})}};WebAssembly.compile(R).then(V=>WebAssembly.instantiate(V,F)).then(V=>{t=V,n=0,s=r*P,a=s+r*I,c=a+16*h.BytesPerFloat*2,o=c+r*h.BytesPerInt,l=o+h.DepthMapRange*h.BytesPerInt,d=F.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function fat(e){let t=new Worker(URL.createObjectURL(new Blob(["(",hat.toString(),")(self)"],{type:"application/javascript"}))),r=atob(dat),i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:mh.BytesPerFloat,BytesPerInt:mh.BytesPerInt,DepthMapRange:mh.DepthMapRange,MemoryPageSize:mh.MemoryPageSize}}}),t}var AD=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(r){return e[0]=r,t[0]}}(),pat=function(e,t,r,i){return e+(t<<8)+(r<<16)+(i<<24)},zS=new oe,RE=class extends An{constructor(e,t,r,i,n=!1,s=1,a,o){super(r,i),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=r,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,r=!1,i=1,n,s){let a=RE.buildGeomtery(t),o=RE.buildMaterial(n);return new RE(e,t,a,o,r,i,n,s)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,r=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,i={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new oe},viewport:{type:"v2",value:new oe},basisViewport:{type:"v2",value:new oe},debugColor:{type:"v3",value:new zt},covariancesTextureSize:{type:"v2",value:new oe(1024,1024)},centersColorsTextureSize:{type:"v2",value:new oe(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Gr({uniforms:i,vertexShader:t,fragmentShader:r,transparent:!0,alphaTest:1,blending:op,depthTest:!0,depthWrite:!1,side:$a})}static buildGeomtery(e){let t=new Dt;t.setIndex([0,1,2,0,2,3]);let r=new Float32Array(4*3),i=new Wt(r,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let n=new sse().copy(t),s=new Uint32Array(e),a=new nx(s,1,!1);return a.setUsage(Yje),n.setAttribute("splatIndex",a),n.instanceCount=e,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(i=>i.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,r=0;for(let i of this.splatBuffers){let n=i.nsplats;this.colors.subarray(e,e+n*4).set(i.colorsA),e+=n*4,this.centers.subarray(t,t+n*3).set(i.decoded.xyz.denormDequant().data),t+=n*3,this.covariances.subarray(r,r+n*6).set(new Float32Array(i.precomputedCovarianceBufferData)),r+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new oe(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let r=new oe(4096,1024);for(;r.x*r.y*4<e*4;)r.y*=2;let i,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let d=0;d<this.covariances.length;d++)n[d]=CWe.toHalfFloat(this.covariances[d]);i=new Qo(n,t.x,t.y,hA,kp)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),i=new Qo(n,t.x,t.y,hA,Cn);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(r.x*r.y*4);for(let d=0;d<e;d++){let u=d*4,h=d*3,f=d*4;s[f]=pat(this.colors[u],this.colors[u+1],this.colors[u+2],this.colors[u+3]),s[f+1]=AD(this.centers[h]),s[f+2]=AD(this.centers[h+1]),s[f+3]=AD(this.centers[h+2])}let a=new Qo(s,r.x,r.y,_ne,Uu);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(r);let o=256*4,l=new Float32Array(256*16);for(let d=0;d<this.meshMatrixWorlds.length;d++)l.set(this.meshMatrixWorlds[d].elements,d*16);let c=new Qo(l,o,1,ts,Cn);c.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=c,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:i,size:t},centerColors:{data:s,texture:a,size:r},meshMatrixWorlds:{data:l,texture:c}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,r,i){this.splatCount>0&&(zS.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(zS),this.material.uniforms.basisViewport.value.set(2/zS.x,2/zS.y),this.material.uniforms.focal.value.set(t,r),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose())}},mat=class{constructor(e={}){fa(this,"updateSplatMeshUniforms",function(){let t=new oe;return function(){this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(this.renderer.getSize(t),this.cameraFocalLengthX=this.camera.projectionMatrix.elements[0]*this.devicePixelRatio*t.x*.45,this.cameraFocalLengthY=this.camera.projectionMatrix.elements[5]*this.devicePixelRatio*t.y*.45,this.splatMesh.updateUniforms(t,this.cameraFocalLengthX,this.cameraFocalLengthY,this.camera.isPerspectiveCamera?-1:this.camera.zoom*this.devicePixelRatio))}}()),fa(this,"updateView",function(){let t=new Ke,r=[],i=new L(0,0,-1),n=new L(0,0,-1),s=new L,a=new L;return function(o=!1){let l=this.updateMatrixWorldsInWorkerIfNeeded(),c=this.cropsChanged();if(!o){n.set(0,0,-1).applyQuaternion(this.camera.quaternion);let u=!1,h=!1;if(n.dot(i)<=.95&&(u=!0),a.copy(this.camera.position).sub(s).length()>=1&&(h=!0),!u&&!h&&!l&&!c)return}s.copy(this.camera.position),i.copy(n),t.copy(this.camera.matrixWorld).invert(),t.premultiply(this.camera.perspCamera.projectionMatrix),r[0]=this.camera.position.x,r[1]=this.camera.position.y,r[2]=this.camera.position.z;let d={sort:{view:t.elements,cameraPosition:r,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...l?{newMatrixWorlds:this.meshMatrixWorlds}:{},...c?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=d:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(d))}}()),this.scene=e.scene,this.currentPage=null,this.renderer=e.renderer,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.splatRenderingInitialized=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null}get camera(){return this.scene.activeCamera}reloadSplats(){this.splatRenderingInitialized=!1;let e=this.loadSplat();this.renderer.pipeline.opaquePass.splatViewer=e?this:null}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new L().fromArray(e.position)),e.orientation&&(e.orientation=new Xt().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseEntity(s=>{if(s.data.type==="Splat"){let a=s.visible;s.traverseAncestors(o=>{a&&(a=o.visible)}),a&&t.push(s)}}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(s=>s.matrixWorld),this.meshMatrixWorldsOld=t.map(s=>s.matrixWorld.clone()),this.cropsArray=t.map(s=>s.data.crops.map(a=>a.data));let r=t.map(s=>new hk(new Uint8Array(s.data.buffer).buffer)),i=0,n=[0];for(let s of r)i+=s.getSplatCount(),n.push(i);return this.setupSplatMesh(r,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,r)=>t.equals(this.meshMatrixWorldsOld[r]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,r)=>{var i;t.data.crops.forEach((n,s)=>{this.cropsArray[r][s]===void 0?(e=!0,this.cropsArray[r][s]=n.data):Object.entries(n.data).forEach(([a,o])=>{var l;Array.isArray(o)&&o.some((c,d)=>c!==this.cropsArray[r][s][a][d])?(e=!0,this.cropsArray[r][s][a]=o):o!==((l=this.cropsArray[r][s])==null?void 0:l[a])&&(e=!0,this.cropsArray[r][s][a]=o)})}),t.data.crops.length!==((i=this.cropsArray[r])==null?void 0:i.length)&&(this.cropsArray[r].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,r=new L,i=new Xt,n=!1,s=1,a,o){this.splatMesh=RE.buildMesh(e,t,n,s,a,o),this.splatMesh.position.copy(r),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=10,this.updateSplatMeshUniforms(),this.splatRenderCount=t}setupSortWorker(e){this.sortWorker=fat(e),this.sortWorker.onmessage=t=>{var r;t.data.sortDone?(this.sortRunning=!1,(r=this.splatMesh)==null||r.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.updateView(!0,!0),this.splatRenderingInitialized=!0)}}update(){this.splatRenderingInitialized!==!1&&(this.updateSplatMeshUniforms(),this.updateView())}getSplatMesh(){return this.splatMesh}},fk=new em;fk.wireframe=!0;var $7=new L,Fj=class extends Xu{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new iat,this.invisibleObjects=new yv("jflkdsafjasdifjaslk",{...xN.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new Jn("fdasfa",{...i0.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=Jst(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=Zst(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof Jn&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>qse(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===H0)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof Jn&&t.uiScene){let r=t.uiScene.find(e);if(r)return r}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof Jn&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(r=>{t===void 0&&r instanceof qs&&(t=r.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof Jn&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var r;if(e.path.length===0&&e.type===7){let i=e.parent===null?this:this.find(e.parent);if(i===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),Pl(n)&&Hu(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),Hu(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Pl(i)&&(i.freeBooleanPointer(),n instanceof Up&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof kj&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid),i.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),(r=i.cloner)==null||r.resetOnMove(),this.markToExpandCloner(i);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(this),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;s.children.splice(a,0,s.children.pop()),Pl(i)&&(i.invalidateUpstreamBooleanData(),Hu(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof Up&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let r of this.children)r instanceof Jn&&(r.visible=r.uuid===e,r.visible&&(this.activePage=r,this.activePage.onActive(this)));this.activePage!==((t=this.splatViewer)==null?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{Qst(n,t,r,{scene:this,shared:i}),n instanceof Ys&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}updateEntity2DByOp(e,t,r,i,n,s=[]){e.updateEntityByOp(t,r,i,n),this.traverseEntity(a=>{(a instanceof qs||a instanceof Jn)&&(s.includes(a.frameId??"")||a.frameId===t)&&a.updateEntity2DByOp(t,r,i,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{i instanceof Js&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){_r.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{_r.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,s,a){if(e){let o=i.find(e);o&&o!==i&&n.forInstancesRec(l=>{l.data=fx(l.data,c=>{let d=c.events.data(a.id),u=l.goUp(s);if(u){let h=[...Gse(u.identity),e].join("-"),f=this.entityIdentityToEntity[h];if(f){let p=f.uuid,m=ws.zoom(d,t);m[r]=p}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Animation"&&this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof bv&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(s=>{s.data=fx(s.data,a=>{s.isInstanceRoot||(a.events.delete(i.id),n=!0)}).data}),n===!1)for(let s of YA.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof bv&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(s=>{r.addClip(s)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),zj(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof bv&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)_r.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let s of n.children){let a=s.cloner;if(_r.is(s)&&!s.raycastLock&&(s.visible||a!=null&&a.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(Pl(s)||QN(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,r),uk(s,e,r)),i(s)}};return i(this.activePage),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;_r.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((Pl(n)||QN(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),uk(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)_r.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)_r.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)_r.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof Ys&&r.data.type==="Mesh"&&r.data.geometry.type==="TextGeometry"&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n);let s=r.invalidateDownstreamBooleanData();Hu(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)wx.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)_r.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,s){var l;let a={scene:this,shared:s},o=Bj(e,t,a);return o&&(this.entityByUuid[e]=o,i.add(o),i.children.splice(n,0,i.children.pop()),r.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,o,s)),o.updateState(t,a),o instanceof Ys&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(this),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(c=>{let d=c.dataPatched;if(c instanceof Ys&&d.bones&&d.boneInverses){let u=d.bones.map(p=>this.find(p)),h=d.boneInverses.map(p=>new Ke().fromArray(p)),f=new T4(u,h);c.bind(f,c.bindMatrix)}else c.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:s,recursive:a}=e[i],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let r=new un;return r.setFromPoints(t),r.getCenter($7),$7}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof Ca)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof $h&&e(t.material[r]);else t.material instanceof $h&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof Js&&i.setViewplaneSize(e,t,r)})}initializeSplatViewer(e){this.splatViewer=new mat({scene:this,renderer:e}),this.reloadSplats()}reloadSplats(){var e;(e=this.splatViewer)==null||e.reloadSplats()}},DE=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},gat=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return yat(Math.atan2(i,r))},vat=(e,t,r)=>{let i={x:0,y:0};return r=pk(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},pk=e=>e*(Math.PI/180),yat=e=>e*(180/Math.PI),bat=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,TD=new Map,H7=e=>{TD.has(e)&&clearTimeout(TD.get(e)),TD.set(e,setTimeout(e,100))},uT=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},W7=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},gle=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),G7=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},mk=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},jj=(e,t,r)=>{let i=vle(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+r+", ";i[n]=s.slice(0,-2)}return i},xat=(e,t)=>{let r=vle(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},vle=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},MD=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},wat=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},gk=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},_at=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(yle="ontouchstart"in window,ble=!!window.PointerEvent,xle=!!window.MSPointerEvent);var yle,ble,xle,Wy={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Gg,Ex={};ble?Gg=Wy.pointer:xle?Gg=Wy.MSPointer:yle?(Gg=Wy.touch,Ex=Wy.mouse):Gg=Wy.mouse;function om(){}om.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};om.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};om.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(a){a.call(r,{type:n,target:r},t)})};om.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=wat(t.options,e))};om.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},uT(e,Gg[t],r._domHandlers_[t]),Ex[t]&&uT(e,Ex[t],r._domHandlers_[t]),r};om.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},W7(e,Gg[t],r._domHandlers_[t]),Ex[t]&&W7(e,Ex[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var Vj=om;function Gn(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Gn.id,Gn.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Gn.prototype=new Vj;Gn.constructor=Gn;Gn.id=0;Gn.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Gn.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=xat("borderRadius","50%"),r=jj("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},MD(i.el,r),this.options.shape==="circle"&&MD(i.back,t),MD(i.front,t),this.applyStyles(i),this};Gn.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};Gn.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Gn.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Gn.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Gn.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};Gn.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};Gn.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=jj("transition",["top","left"],i);var s={front:{}};s.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(s),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};Gn.prototype.restCallback=function(){var e=this,t={};t.front=jj("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};Gn.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Gn.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,s,a;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var c={};this.direction={x:s,y:a,angle:n},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+a,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var Sat=Gn;function dn(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=dn.id,dn.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}dn.prototype=new Vj;dn.constructor=dn;dn.id=0;dn.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};dn.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};dn.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};dn.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},s=r.options,a={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new Sat(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(mk(c.ui.el,n),mk(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};dn.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};dn.prototype.bindNipple=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};dn.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==n&&(t.trigger("pressure",s),i.trigger("pressure "+t.identifier+":pressure",s),n=s)}).bind(i),100)};dn.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=gle(e),t.updateBox();var n=function(s){t.actives.length<r.maxNumberOfNipples?t.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(i.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(s))};return gk(e,n),t.manager.bindDocument(),!1};dn.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(n,a);o.identifier!==n&&t.manager.removeIdentifier(o.identifier),o.identifier=n;var l=function(d){d.trigger("start",d),t.trigger("start "+d.id+":start",d),d.show(),s>0&&t.pressureFn(e,d,d.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(o))>=0&&t.idles.splice(i,1),t.actives.push(o),t.ids.push(o.identifier),r.mode!=="semi")l(o);else{var c=DE(a,o.position);if(c<=r.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};dn.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};dn.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.scroll;if(!bat(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=i;var o=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=DE(l,n.position),d=gat(l,n.position),u=pk(d),h=c/o,f={distance:c,position:l},p,m;if(n.options.shape==="circle"?(p=Math.min(c,o),m=vat(n.position,p,d)):(m=_at(l,n.position,o),p=DE(m,n.position)),r.follow){if(c>o){let b=l.x-m.x,x=l.y-m.y;n.position.x+=b,n.position.y+=x,n.el.style.top=n.position.y-(t.box.top+s.y)+"px",n.el.style.left=n.position.x-(t.box.left+s.x)+"px",c=DE(l,n.position)}}else l=m,c=p;var g=l.x-n.position.x,v=l.y-n.position.y;n.frontPosition={x:g,y:v},r.dataOnly||mk(n.ui.front,n.frontPosition);var y={identifier:n.identifier,position:l,force:h,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:u,degree:d},vector:{x:g/o,y:-v/o},raw:f,instance:n,lockX:r.lockX,lockY:r.lockY};y=n.computeDirection(y),y.angle={radian:pk(180-d),degree:180-d},n.trigger("move",y),t.trigger("move "+n.id+":move",y)};dn.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[s.id]=s.identifier))};dn.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};dn.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var Eat=dn;function os(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=G7(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(s){s.forEach(function(a){n=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;uT(window,"resize",function(){H7(r)});var i=function(){t.scroll=G7()};return uT(window,"scroll",function(){H7(i)}),t.collections}os.prototype=new Vj;os.constructor=os;os.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};os.prototype.create=function(e){return this.createCollection(e)};os.prototype.createCollection=function(e){var t=this,r=new Eat(t,e);return t.bindCollection(r),t.collections.push(r),r};os.prototype.bindCollection=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};os.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};os.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};os.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};os.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};os.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};os.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};os.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};os.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=gle(t);var s=function(o,l,c){c.ids.indexOf(l)>=0&&(c[n](o),o._found_=!0)},a=function(o){i=r.getIdentifier(o),gk(r.collections,s.bind(null,o,i)),o._found_||r.removeIdentifier(i)};return gk(t,a),!1};os.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};os.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var Cat=os,q7=new Cat,Aat={create:function(e){return q7.create(e)},factory:q7},wle=new Map,nb=new Map,Kf=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:s,delay:a,loop:o}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new x1({src:l,volume:s,delay:a,loop:o}),nb.has(r.uuid)?nb.get(r.uuid).push(this):nb.set(r.uuid,[this]),wle.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},vk=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=wle.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=nb.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...nb.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},_le=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new Kf(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new vk(t);else throw new Error("Missing property")}dispatchBasic(){if(Ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof Kf?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(Ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof Kf?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(Ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof Kf&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},Sle=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop():this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze():this.unFreeze()}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},this.delay);return}this.particleSystem.start()}stop(){this.particleSystem.stop(),this.clearDelay()}freeze(){this.particleSystem.froze(),this.clearDelay()}unFreeze(){this.particleSystem.unFroze(),this.clearDelay()}reset(){this.particleSystem.reset(),this.clearDelay()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(Ni(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze();break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop();break;case"reset":this.reset();break}}dispatchConditional(){if(Ni(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.particleSystem.start();break;case"stop":this.particleSystem.stop();break;case"reset":this.particleSystem.reset();break}}dispatchGameControl(e){if(Ni(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.particleSystem.start():this.particleSystem.stop()}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},Tat="text/plain",Mat="us-ascii",X7=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),Pat=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:s}=r.groups,a=i.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),c=[...a.map(d=>{let[u,h=""]=d.split("=").map(f=>f.trim());return u==="charset"&&(h=h.toLowerCase(),h===Mat)?"":`${u}${h?`=${h}`:""}`}).filter(Boolean)];return o&&c.push("base64"),(c.length>0||l&&l!==Tat)&&c.unshift(l),`data:${c.join(";")},${o?n.trim():n}${s?`#${s}`:""}`};function Iat(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return Pat(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let c=s.exec(i.pathname);if(!c)break;let d=c[0],u=c.index,h=i.pathname.slice(a,u);o+=h.replace(/\/{2,}/g,"/"),o+=d,a=u+d.length}let l=i.pathname.slice(a,i.pathname.length);o+=l.replace(/\/{2,}/g,"/"),i.pathname=o}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),a=s[s.length-1];X7(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])X7(s,t.removeQueryParameters)&&i.searchParams.delete(s);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var Rat=class{constructor({url:e,context:t},r,i,n){if(this.controlsManager=r,this.shared=i,this.condition=n,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:Iat(e,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=t??"tab"}dispatch(){var e;if(Ni(this.shared,this.condition)===!1)return!1;J4?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.controlsManager.orbitControls)==null||e.onPointerUp(Ut[0]),KKe())}},Ele=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=s=>{var c,d;this.timeoutIdQueue.shift();let a=this.page.scene.find(s);if(a===void 0)return;let o=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=o?(c=a.dataPatched.physics)==null?void 0:c.fusedBody:!0;if(a.cloner){for(let u of a.cloner.children)l?(u.playModeVisible=!1,u.rigidBody&&((d=a.dataPatched.physics)==null?void 0:d.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(u.rigidBody.collider(0).handle),o.removeRigidBody(u.rigidBody),u.rigidBody=void 0),u.bvhGeometry&&(u.bvhGeometry=void 0)):this.clone===void 0||this.clone===u?(u.playModeVisible=!1,u.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(u.rigidBody.collider(0).handle),o.removeRigidBody(u.rigidBody),u.rigidBody=void 0)):u.playModeVisible===void 0&&(u.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(a.visible=!1,a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0))}else a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0),a.visible=!1;o===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(u=>u.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(u=>u.rigidBody!==void 0),a.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(Ni(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(Ni(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},Cle=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.shared=r,this.eventManager=i,this.condition=n,this.shared=r}dispatch(){if(Ni(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),Zj(this.page,this.shared,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Ale={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},Uj={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},Dat=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],dT={CSS:{},springs:{}};function Ll(e,t,r){return Math.min(Math.max(e,t),r)}function sb(e,t){return e.indexOf(t)>-1}function PD(e,t){return e.apply(null,t)}var Ht={arr:function(e){return Array.isArray(e)},obj:function(e){return sb(Object.prototype.toString.call(e),"Object")},pth:function(e){return Ht.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||Ht.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return Ht.hex(e)||Ht.rgb(e)||Ht.hsl(e)},key:function(e){return!Ale.hasOwnProperty(e)&&!Uj.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function Tle(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function Mle(e,t){var r=Tle(e),i=Ll(Ht.und(r[0])?1:r[0],.1,100),n=Ll(Ht.und(r[1])?100:r[1],.1,100),s=Ll(Ht.und(r[2])?10:r[2],.1,100),a=Ll(Ht.und(r[3])?0:r[3],.1,100),o=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),c=l<1?o*Math.sqrt(1-l*l):0,d=1,u=l<1?(l*o+-a)/c:-a+o;function h(p){var m=t?t*p/1e3:p;return l<1?m=Math.exp(-m*l*o)*(d*Math.cos(c*m)+u*Math.sin(c*m)):m=(d+u*m)*Math.exp(-m*o),p===0||p===1?p:1-m}function f(){var p=dT.springs[e];if(p)return p;for(var m=1/6,g=0,v=0;;)if(g+=m,h(g)===1){if(v++,v>=16)break}else v=0;var y=g*m*1e3;return dT.springs[e]=y,y}return t?h:f}function Oat(e){return e===void 0&&(e=10),function(t){return Math.ceil(Ll(t,1e-6,1)*e)*(1/e)}}var Lat=function(){var e=11,t=1/(e-1);function r(d,u){return 1-3*u+3*d}function i(d,u){return 3*u-6*d}function n(d){return 3*d}function s(d,u,h){return((r(u,h)*d+i(u,h))*d+n(u))*d}function a(d,u,h){return 3*r(u,h)*d*d+2*i(u,h)*d+n(u)}function o(d,u,h,f,p){var m,g,v=0;do g=u+(h-u)/2,m=s(g,f,p)-d,m>0?h=g:u=g;while(Math.abs(m)>1e-7&&++v<10);return g}function l(d,u,h,f){for(var p=0;p<4;++p){var m=a(u,h,f);if(m===0)return u;var g=s(u,h,f)-d;u-=g/m}return u}function c(d,u,h,f){if(!(0<=d&&d<=1&&0<=h&&h<=1))return;var p=new Float32Array(e);if(d!==u||h!==f)for(var m=0;m<e;++m)p[m]=s(m*t,d,h);function g(v){for(var y=0,b=1,x=e-1;b!==x&&p[b]<=v;++b)y+=t;--b;var S=(v-p[b])/(p[b+1]-p[b]),w=y+S*t,E=a(w,d,h);return E>=.001?l(v,w,d,h):E===0?w:o(v,y,y+t,d,h)}return function(v){return d===u&&h===f||v===0||v===1?v:s(g(v),u,f)}}return c}(),Ple=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,s=4;i<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var s=Ll(i,1,10),a=Ll(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+i]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function $j(e,t){if(Ht.fnc(e))return e;var r=e.split("(")[0],i=Ple[r],n=Tle(e);switch(r){case"spring":return Mle(e,t);case"cubicBezier":return PD(Lat,n);case"steps":return PD(Oat,n);default:return PD(i,n)}}function Ile(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function JM(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&n.push(a)}return n}function eP(e){return e.reduce(function(t,r){return t.concat(Ht.arr(r)?eP(r):r)},[])}function Y7(e){return Ht.arr(e)?e:(Ht.str(e)&&(e=Ile(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function Hj(e,t){return e.some(function(r){return r===t})}function Wj(e){var t={};for(var r in e)t[r]=e[r];return t}function yk(e,t){var r=Wj(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function tP(e,t){var r=Wj(e);for(var i in t)r[i]=Ht.und(e[i])?t[i]:e[i];return r}function Nat(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function kat(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(o,l,c,d){return l+l+c+c+d+d}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),s=parseInt(i[2],16),a=parseInt(i[3],16);return"rgba("+n+","+s+","+a+",1)"}function zat(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(h,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?h+(f-h)*6*p:p<1/2?f:p<2/3?h+(f-h)*(2/3-p)*6:h}var o,l,c;if(i==0)o=l=c=n;else{var d=n<.5?n*(1+i):n+i-n*i,u=2*n-d;o=a(u,d,r+1/3),l=a(u,d,r),c=a(u,d,r-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+s+")"}function Bat(e){if(Ht.rgb(e))return Nat(e);if(Ht.hex(e))return kat(e);if(Ht.hsl(e))return zat(e)}function Qu(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function Fat(e){if(sb(e,"translate")||e==="perspective")return"px";if(sb(e,"rotate")||sb(e,"skew"))return"deg"}function bk(e,t){return Ht.fnc(e)?e(t.target,t.id,t.total):e}function Lc(e,t){return e.getAttribute(t)}function Gj(e,t,r){var i=Qu(t);if(Hj([r,"deg","rad","turn"],i))return t;var n=dT.CSS[t+r];if(!Ht.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+r;var l=s/a.offsetWidth;o.removeChild(a);var c=l*parseFloat(t);return dT.CSS[t+r]=c,c}function Rle(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?Gj(e,n,r):n}}function qj(e,t){if(Ht.dom(e)&&!Ht.inp(e)&&(Lc(e,t)||Ht.svg(e)&&e[t]))return"attribute";if(Ht.dom(e)&&Hj(Dat,t))return"transform";if(Ht.dom(e)&&t!=="transform"&&Rle(e,t))return"css";if(e[t]!=null)return"object"}function Dle(e){if(Ht.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function jat(e,t,r,i){var n=sb(t,"scale")?1:0+Fat(t),s=Dle(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?Gj(e,s,i):s}function Xj(e,t,r,i){switch(qj(e,t)){case"transform":return jat(e,t,i,r);case"css":return Rle(e,t,r);case"attribute":return Lc(e,t);default:return e[t]||0}}function Yj(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=Qu(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function Ole(e,t){if(Ht.col(e))return Bat(e);if(/\s/g.test(e))return e;var r=Qu(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function Kj(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Vat(e){return Math.PI*2*Lc(e,"r")}function Uat(e){return Lc(e,"width")*2+Lc(e,"height")*2}function $at(e){return Kj({x:Lc(e,"x1"),y:Lc(e,"y1")},{x:Lc(e,"x2"),y:Lc(e,"y2")})}function Lle(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(r+=Kj(i,s)),i=s}return r}function Hat(e){var t=e.points;return Lle(e)+Kj(t.getItem(t.numberOfItems-1),t.getItem(0))}function Nle(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return Vat(e);case"rect":return Uat(e);case"line":return $at(e);case"polyline":return Lle(e);case"polygon":return Hat(e)}}function Wat(e){var t=Nle(e);return e.setAttribute("stroke-dasharray",t),t}function Gat(e){for(var t=e.parentNode;Ht.svg(t)&&Ht.svg(t.parentNode);)t=t.parentNode;return t}function kle(e,t){var r=t||{},i=r.el||Gat(e),n=i.getBoundingClientRect(),s=Lc(i,"viewBox"),a=n.width,o=n.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function qat(e,t){var r=Ht.str(e)?Ile(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:kle(r),totalLength:Nle(r)*(i/100)}}}function Xat(e,t){function r(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var i=kle(e.el,e.svg),n=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function K7(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=Ole(Ht.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:Ht.str(e)||t?i.split(r):[]}}function zle(e){var t=e?eP(Ht.arr(e)?e.map(Y7):Y7(e)):[];return JM(t,function(r,i,n){return n.indexOf(r)===i})}function Ble(e){var t=zle(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:Dle(r)}}})}function Yat(e,t){var r=Wj(t);if(/^spring/.test(r.easing)&&(r.duration=Mle(r.easing)),Ht.arr(e)){var i=e.length,n=i===2&&!Ht.obj(e[0]);n?e={value:e}:Ht.fnc(t.duration)||(r.duration=t.duration/i)}var s=Ht.arr(e)?e:[e];return s.map(function(a,o){var l=Ht.obj(a)&&!Ht.pth(a)?a:{value:a};return Ht.und(l.delay)&&(l.delay=o?0:t.delay),Ht.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return tP(a,r)})}function Kat(e){for(var t=JM(eP(e.map(function(s){return Object.keys(s)})),function(s){return Ht.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),r={},i=function(s){var a=t[s];r[a]=e.map(function(o){var l={};for(var c in o)Ht.key(c)?c==a&&(l.value=o[c]):l[c]=o[c];return l})},n=0;n<t.length;n++)i(n);return r}function Qat(e,t){var r=[],i=t.keyframes;i&&(t=tP(Kat(i),t));for(var n in t)Ht.key(n)&&r.push({name:n,tweens:Yat(t[n],e)});return r}function Zat(e,t){var r={};for(var i in e){var n=bk(e[i],t);Ht.arr(n)&&(n=n.map(function(s){return bk(s,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function Jat(e,t){var r;return e.tweens.map(function(i){var n=Zat(i,t),s=n.value,a=Ht.arr(s)?s[1]:s,o=Qu(a),l=Xj(t.target,e.name,o,t),c=r?r.to.original:l,d=Ht.arr(s)?s[0]:c,u=Qu(d)||Qu(l),h=o||u;return Ht.und(a)&&(a=c),n.from=K7(d,h),n.to=K7(Yj(a,d),h),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=$j(n.easing,n.duration),n.isPath=Ht.pth(s),n.isColor=Ht.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var Fle={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function jle(e,t){var r=Ble(e);r.forEach(function(i){for(var n in t){var s=bk(t[n],i),a=i.target,o=Qu(s),l=Xj(a,n,o,i),c=o||Qu(l),d=Yj(Ole(s,c),l),u=qj(a,n);Fle[u](a,n,d,i.transforms,!0)}})}function eot(e,t){var r=qj(e.target,t.name);if(r){var i=Jat(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function tot(e,t){return JM(eP(e.map(function(r){return t.map(function(i){return eot(r,i)})})),function(r){return!Ht.und(r)})}function Vle(e,t){var r=e.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return i(s)+a+o+s.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,n}var Q7=0;function rot(e){var t=yk(Ale,e),r=yk(Uj,e),i=Qat(r,e),n=Ble(e.targets),s=tot(n,i),a=Vle(s,r),o=Q7;return Q7++,tP(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var tl=[],Z7=[],OE,iot=function(){function e(){OE=requestAnimationFrame(t)}function t(r){var i=tl.length;if(i){for(var n=0;n<i;){var s=tl[n];s.paused?(tl.splice(n,1),i-=1):(s.tick(r),n++)}e()}else OE=cancelAnimationFrame(OE)}return e}();function not(e){document.hidden?(tl.forEach(function(t){return t.pause(e.timeStamp)}),Z7=tl.slice(0),cn.running=tl=[]):Z7.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",not);function cn(e){e===void 0&&(e={});var t=0,r=0,i=0,n,s,a=0,o=null;function l(w){var E=window.Promise&&new Promise(function(C){return o=C});return w.finished=E,E}var c=rot(e);l(c);function d(){var w=c.direction;w!=="alternate"&&(c.direction=w!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(E){(E.loop===1||E.loop%2===0)&&(E.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,s.forEach(function(w){return w.reversed=!1})}function h(w){return c.reversed?c.duration-w:w}function f(){t=0,r=h(c.currentTime)*(1/cn.speed)}function p(w,E,C=!1){E&&(c.reversed?E.seek(E.duration*E.loop-(w-E.timelineOffset-E.pingPongDelayCorrection),C):E.seek(w-E.timelineOffset-E.startOnceDelay-E.pingPongDelayCorrection,C))}function m(w,E=!1){if(c.reversed)for(var C=a;C--;)p(w,s[C],E);else for(var T=0;T<a;T++)p(w,s[T],E)}function g(w){var ie,Q,Z,ee,re,ne,se,fe,me,Oe;var E=0,C=c.animations,T=C.length;for(c.direction!=="alternate"&&((ie=c.parent)==null?void 0:ie.direction)==="alternate"?((Q=c.parent)==null?void 0:Q.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((Z=c.parent)!=null&&Z.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w):x(!1,(ee=c.parent)==null?void 0:ee.rewind,c.rewind,(re=c.parent)==null?void 0:re.reversePlayback,c.reversePlayback)&&((ne=c.parent)!=null&&ne.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w);E<T;){var A=C[E],M=A.animatable,P=A.tweens,I=P.length-1,R=P[I];I&&(R=JM(P,function(Se){return w<Se.end})[0]||R);let Ee;(se=c.parent)!=null&&se.reversed&&c.direction==="alternate"?Ee=Ll(w-R.start-R.endDelay,0,R.duration)/R.duration:Ee=Ll(w-R.start-R.delay,0,R.duration)/R.duration;for(var N=isNaN(Ee)?1:R.easing(Ee),k=R.to.strings,O=R.round,D=[],B=R.to.numbers.length,z=void 0,F=0;F<B;F++){var V=void 0;let Se,de;c.direction!=="alternate"?((fe=c.parent)==null?void 0:fe.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Se=R.to.numbers[F],de=R.from.numbers[F]||0):(de=R.to.numbers[F],Se=R.from.numbers[F]||0):x(!0,(me=c.parent)==null?void 0:me.rewind,c.rewind,(Oe=c.parent)==null?void 0:Oe.reversePlayback,c.reversePlayback)?(Se=R.to.numbers[F],de=R.from.numbers[F]||0):(de=R.to.numbers[F],Se=R.from.numbers[F]||0),R.isPath?V=Xat(R.value,N*de):V=Se+N*(de-Se),O&&(R.isColor&&F>2||(V=Math.round(V*O)/O)),D.push(V)}var Y=k.length;if(!Y)z=D[0];else{z=k[0];for(var W=0;W<Y;W++){k[W];var X=k[W+1],H=D[W];isNaN(H)||(X?z+=H+X:z+=H+" ")}}Fle[A.type](M.target,A.property,z,M.transforms),A.currentValue=z,E++}}function v(w){c[w]&&!c.passThrough&&c[w](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let b={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function x(w,E,C,T,A){return b[w<<4|E<<3|C<<2|T<<1|A]}function S(w,E=!1){var P;var C=c.duration;let T=c.delay,A=C-c.endDelay;(P=c.parent)!=null&&P.reversed&&c.direction==="alternate"&&(T=c.endDelay,A=C-c.delay);var M=h(w);if(c.progress=Ll(M/C*100,0,100),E||(c.reversePlayback=M<c.currentTime),a&&m(M,E),!c.began&&c.currentTime>=0&&(c.began=!0,v("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,v("loopBegin")),(c.reversed||M>=0)&&M<=T&&c.currentTime!==0&&(g(0),v("change")),(M>=A&&c.currentTime!==C+c.pingPongDelayCorrection||!C)&&(g(C),v("change")),M>T&&M<A?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,v("changeBegin")),g(M),v("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,v("change"),a&&v("timelineChangeComplete")):c.began&&M>A&&v("changeComplete"),c.currentTime=Ll(M,0,C+c.pingPongDelayCorrection),c.began&&v("update"),w>=C)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,v("loopComplete"),v("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)));else{a?t+=c.duration/cn.speed:t+=c.duration;for(let I of s)I.setStartTime(0),I.remaining=I.loop;v("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?d():a&&u()}}return c.reset=function(){var w=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=w==="reverse",c.remaining=c.loop,s=c.children,a=s.length;for(var E=a;E--;)c.children[E].reset();g(c.reversed?c.duration:0)},c.setStartTime=function(w){t=w},c.set=function(w,E){return jle(w,E),c},c.tick=function(w){i=w,t||(t=i),S((i+(r-t))*cn.speed)},c.seek=function(w,E=!1){S(w-t,E)},c.pause=function(w){c.paused=!0,a&&(n=w??performance.now())},c.play=function(w){!c.paused||(c.completed&&c.reset(),c.paused=!1,tl.push(c),a&&n!==void 0&&(t+=(w??performance.now())-n),OE||iot())},c.reverse=function(){d(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function J7(e,t){for(var r=t.length;r--;)Hj(e,t[r].animatable.target)&&t.splice(r,1)}function sot(e){for(var t=zle(e),r=tl.length;r--;){var i=tl[r],n=i.animations,s=i.children;J7(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;J7(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&i.pause()}}function aot(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?$j(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",c=a==="last",d=Ht.arr(e),u=parseFloat(d?e[0]:e),h=d?parseFloat(e[1]):0,f=Qu(d?e[1]:e)||0,p=t.start||0+(d?u:0),m=[],g=0;return function(v,y,b){if(o&&(a=0),l&&(a=(b-1)/2),c&&(a=b-1),!m.length){for(var x=0;x<b;x++){if(!n)m.push(Math.abs(a-x));else{var S=l?(n[0]-1)/2:a%n[0],w=l?(n[1]-1)/2:Math.floor(a/n[0]),E=x%n[0],C=Math.floor(x/n[0]),T=S-E,A=w-C,M=Math.sqrt(T*T+A*A);s==="x"&&(M=-T),s==="y"&&(M=-A),m.push(M)}g=Math.max.apply(Math,m)}i&&(m=m.map(function(I){return i(I/g)*g})),r==="reverse"&&(m=m.map(function(I){return s?I<0?I*-1:-I:Math.abs(g-I)}))}var P=d?(h-u)/g:u;return p+P*(Math.round(m[y]*100)/100)+f}}function oot(e){e===void 0&&(e={});var t=cn(e);return t.duration=0,t.add=function(r,i){var n=tl.indexOf(t),s=t.children;n>-1&&tl.splice(n,1);function a(h){h.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=tP(r,yk(Uj,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=Ht.und(i)?c:Yj(i,c),a(t);var d=cn(l);a(d),s.push(d),d.parent=t;var u=Vle(s,e);return t.delay=u.delay,t.endDelay=u.endDelay,t.duration=u.duration,d.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}cn.version="3.2.0";cn.speed=1;cn.running=tl;cn.remove=sot;cn.get=Xj;cn.set=jle;cn.convertPx=Gj;cn.path=qat;cn.setDashoffset=Wat;cn.stagger=aot;cn.timeline=oot;cn.easing=$j;cn.penner=Ple;cn.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var Ule=cn,eq=new L,tq=new L,rq=new Xt;function lot(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let d=1-i;return r.w=d*e.w+i*t.w,r.x=d*e.x+i*t.x,r.y=d*e.y+i*t.y,r.z=d*e.z+i*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function ms(e,t,r,i,n,s){let a=r[e]?r[e]:void 0,o=i[e];if(o==null)return;let l=a!=null?typeof a=="string"?Number(n.getVariable(a)??0):a:t[e],c=typeof o=="string"?Number(n.getVariable(o)??0):o;if(l!==c)return{update:d=>{let u=Et.lerp(l,c,d);s?t[e]=Math.trunc(u):t[e]=u},start:()=>{t[e]=l},end:()=>{t[e]=c}}}function Qj(e,t,r,i,n,s){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let l=t[e],c=[...a??l].map(u=>typeof u=="string"?Number(n.getVariable(u)??0):u),d=[...o].map(u=>typeof u=="string"?Number(n.getVariable(u)??0):u);if(!(c.length!==d.length||Hse(c,d)))return{update:u=>{c.forEach((h,f)=>{let p=Et.lerp(h,d[f],u);t[e][f]=s?Math.trunc(p):p})},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],d)}}}function hT(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function iq(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?hT(new L,s,n):o.clone(),c=hT(new L,a,n);if(!l.equals(c))return{update:d=>{o.lerpVectors(l,c,d)},start:()=>{o.copy(l)},end:()=>{o.copy(c)}}}function nq(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function xk(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=!(o instanceof oe),c=o instanceof oe?o:new oe().fromArray(o),d=s?nq(new oe,s,n):c.clone(),u=nq(new oe,a,n);if(!d.equals(u))return{update:h=>{c.lerpVectors(d,u,h),l&&(t[e]=c.toArray())},start:()=>{c.copy(d),l&&(t[e]=c.toArray())},end:()=>{c.copy(u),l&&(t[e]=c.toArray())}}}function cot(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new Ke().fromArray(n):a.clone(),l=new L,c=new Xt,d=new L;o.decompose(l,c,d);let u=new Ke().fromArray(s),h=new L,f=new Xt,p=new L;if(u.decompose(h,f,p),!o.equals(u))return{update:m=>{rq.slerpQuaternions(c,f,m),eq.lerpVectors(l,h,m),tq.lerpVectors(d,p,m),a.compose(eq,rq,tq)},start:()=>{a.compose(l,c,d)},end:()=>{a.compose(h,f,p)}}}function uot(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?n.getColor(s).clone():new zt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new zt().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let d=o.clone();return t[e]=d,{update:u=>{d.lerpColors(l,c,u)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function BS(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=new Ps(o.r,o.g,o.b,o.a),c=s?typeof s=="string"?n.getColor(s).clone():new Ps(s.r,s.g,s.b,s.a):l.clone(),d=typeof a=="string"?n.getColor(a).clone():new Ps(a.r,a.g,a.b,a.a);if(!c.equals(d))return{update:u=>{l.lerpColors(c,d,u);let h=Et.lerp(c.a,d.a,u);l.a=h,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(d)}}}function nf(e,t,r,i,n){if(typeof t[e]=="number")return ms(e,t,r??{},i,n);if(Array.isArray(t[e]))return Qj(e,t,r??{},i,n)}function dot(e,t,r,i){var o,l,c,d;let n=[],s=e.cameraType==="OrthographicCamera"?(o=t.orthographic)==null?void 0:o.zoom:(l=t.perspective)==null?void 0:l.zoom,a=e.cameraType==="OrthographicCamera"?(c=r.orthographic)==null?void 0:c.zoom:(d=r.perspective)==null?void 0:d.zoom;if(a!==void 0){let u=s??e.zoom,h=a;u!==h&&n.push({update:f=>{e.zoom=Et.lerp(u,h,f),e.updateProjectionMatrix()},start:()=>{e.zoom=u,e.updateProjectionMatrix()},end:()=>{e.zoom=h,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let u=ms("targetOffset",e,t,r,i);u&&n.push(u)}return n}function hot(e,t,r,i){if(r.scaleBaked===void 0)return;let n=(t.scaleBaked??e.data.geometry.scaleBaked).map(o=>typeof o=="string"?Number(i.getVariable(o)??0):o),s=r.scaleBaked.map(o=>typeof o=="string"?Number(i.getVariable(o)??0):o);if(dp.isEqual(n,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[Et.lerp(n[0],s[0],o),Et.lerp(n[1],s[1],o),Et.lerp(n[2],s[2],o)]},i),e.invalidateDownstreamBooleanData()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData()}}),a}function fot(e,t,r,i){if(!r.extrusion)return;let n=e.extrusion,s=t.extrusion??{},a=r.extrusion,o=[];return Mae.forEach(l=>{let c=nf(l,n,s,a,i);c&&o.push(c)}),o}function pot(e,t,r,i){let n=[];if(!("geometry"in r))return n;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=r.geometry;if(e instanceof Sx){let l=hot(e,a,o,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,Yu(s,DG)),DG.forEach(c=>{let d=nf(c,l,a,o,i);d&&n.push(d)}),e instanceof kj){Object.assign(l,{extrusion:{...s.extrusion}});let c=fot(l,a,o,i);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded()}})}return n}function mot(e,t,r,i){let n=[];if(r.intensity!==void 0){let s=ms("intensity",e,t,r,i);s&&n.push(s)}if(r.color!==void 0){let s=uot("color",e,t,r,i);s&&n.push(s)}return n}function got(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let s="materials"in t&&t.materials?t.materials:[],a=r.materials;e.material.forEach((o,l)=>{if(!a[l])return;let c=s[l]??{},d=a[l];typeof c=="string"||typeof d=="string"||n.push(...sq(o,c,d,i))})}else{if(!("material"in r&&r.material))return n;let s="material"in t&&t.material?t.material:{},a=r.material;if(typeof s=="string"||typeof a=="string")return n;n.push(...sq(e.material,s,a,i))}return n}function sq(e,t,r,i){var a;let n=[],s=Wg(r,i)||!!t.layers&&Wg(t,i);n.push(Cot(e,s));for(let o of e.layers){let l=(a=t.layers)==null?void 0:a.data(o.uuid),c=r.layers.data(o.uuid);if(!c||o.type!=="light"&&(!(o.visible??!0)||!(c.visible??!0)))continue;let d=o.getNames().filter(u=>!Cae.some(h=>u.includes(h)));for(let u of d)try{let h=o.getValue(u),f;if(u==="colors")f=Sot(o,l,c,u);else if(Array.isArray(h))u==="steps"&&(f=_ot(o,l,c,u));else if(typeof h=="number")f=vot(o,l,c,u,i);else{if(typeof h=="boolean")continue;h instanceof oe?f=yot(o,l,c,u):h instanceof L?f=bot(o,l,c,u,i):h instanceof Ps?f=wot(o,l,c,u,i):h instanceof zt?f=xot(o,l,c,u,i):"isTexture"in h&&(f=Eot(o,l,c,u))}f&&(Array.isArray(f)?n.push(...f):n.push(f))}catch(h){console.error(`lerpMaterial: unexpected material layer for ${u}`,h)}}return n}function vot(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:e.getValue(i),a=r[i],o=typeof s=="string"?Number(n.getVariable(s)??0):s,l=typeof a=="string"?Number(n.getVariable(a)??0):a;if(o!==l)return{update:c=>{e.setValue(i,Et.lerp(o,l,c))},start:()=>{e.setValue(i,o)},end:()=>{e.setValue(i,l)}}}function yot(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new oe().fromArray(t[i]):n.clone(),a=new oe().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function bot(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=e.getValue(i),a=t?t[i]:void 0,o=r[i],l=a?hT(new L,a,n):s.clone(),c=hT(new L,o,n);if(!l.equals(c))return{update:d=>{s.lerpVectors(l,c,d)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function xot(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new zt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new zt().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let d=o.clone();return{update:u=>{e.getValue(i)!==d&&e.setValue(i,d),d.lerpColors(l,c,u)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function wot(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new zt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new Ps(a.r,a.g,a.b,a.a);if(l.equals(c))return;let d=o.clone();return{update:u=>{e.getValue(i)!==d&&e.setValue(i,d),d.lerpColors(l,c,u)},start:()=>{d.copy(l)},end:()=>{d.copy(c)}}}function _ot(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s,o=r[i];for(let l=0;l<s.length;++l){let c=a[l],d=o[l];c!==d&&n.push({update:u=>{s[l]=Et.lerp(c,d,u)},start:()=>{s[l]=c},end:()=>{s[l]=d}})}return n.length?n:void 0}function Sot(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s.map(l=>l.toArray()),o=r[i];for(let l=0;l<s.length;++l){let c=[...a[l]],d=[...o[l]];FA.isEqual(c,d)||n.push({update:u=>{s[l].fromArray(FA.lerp(c,d,u))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(d)}})}return n.length?n:void 0}function Eot(e,t,r,i="texture"){if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("mat");if(!n)return;let s=t?t[i]:n,a=r[i],o=[...s.repeat],l=[...s.offset],c=[...a.repeat],d=[...a.offset];if(!ch.isEqual(o,c)||!ch.isEqual(l,d))return{update:u=>{n.repeat=ch.lerp(o,c,u),n.offset=ch.lerp(l,d,u),n.updateMatrix()},start:()=>{n.repeat=[...o],n.offset=[...l],n.updateMatrix()},end:()=>{n.repeat=[...c],n.offset=[...d],n.updateMatrix()}}}function Cot(e,t){return{update:()=>{e.transparent=t}}}var ID=new L,aq=new kn;function Aot(e,t,r,i,n){var f,p,m,g,v,y;let s=[],a,o,l,c,d,u,h;if(e instanceof Un?(a=xk("position",e,t,r,n),a&&s.push(a),l=ms("rotation",e,t,r,n),l&&s.push(l)):(h={slide:((f=t.pathSnapping)==null?void 0:f.slide)??((p=e.updatedPathSnapping)==null?void 0:p.slide)??((m=e.dataPatched.pathSnapping)==null?void 0:m.slide)??0,offset:((g=t.pathSnapping)==null?void 0:g.offset)??((v=e.updatedPathSnapping)==null?void 0:v.offset)??((y=e.dataPatched.pathSnapping)==null?void 0:y.offset)??0},d=ms("slide",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),d&&s.push(d),u=ms("offset",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),u&&s.push(u),!d&&!u&&(a=iq("position",e,t,r,n),a&&s.push(a),o=iq("scale",e,t,r,n),o&&s.push(o),l=Tot(e,t,r,i,n),l&&s.push(l),c=cot("hiddenMatrix",e,t,r),c&&s.push(c))),a||o||l||c||d||u){let b=e instanceof Un?()=>{e.updateWorldMatrix(!0)}:()=>{var x;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(x=e.parent)!=null&&x.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),Pl(e)&&Hu(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,h))};s.push({update:b,start:b,end:b})}return s}function Tot(e,t,r,i,n){var d;let s=t!=null&&t.rotation?t.rotation.map(u=>(typeof u=="string"?Number(n.getVariable(u)??0):u)*Et.DEG2RAD):void 0,a=(d=r.rotation)==null?void 0:d.map(u=>(typeof u=="string"?Number(n.getVariable(u)??0):u)*Et.DEG2RAD);if(!a)return;let o=s?new L().fromArray(s):new L().setFromEuler(e.rotation),l=new L().fromArray(a);if(o.equals(l))return;let c=ID.subVectors(l,o);if(i&&c.toArray().every(u=>Math.abs(u)<2*Math.PI)){let u=new Xt().setFromEuler(aq.setFromVector3(o)),h=new Xt().setFromEuler(aq.setFromVector3(l));return{update:f=>{lot(u,h,e.quaternion,f)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:u=>{ID.lerpVectors(o,l,u),e.rotation.setFromVector3(ID)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}function Mot(e,t,r,i){let n=[];if(!("cloner"in r)||!e.cloner)return n;let s=e.cloner,a="cloner"in t?t.cloner:{},o=r.cloner;bae.forEach(f=>{let p;f==="count"?p=ms("count",s.parameters,a,o,i,!0):p=nf(f,s.parameters,a??{},o,i),p&&n.push(p)});let l=Pot(s,a,o,i);l!=null&&l.length&&n.push(...l);let c=Iot(s,a,o,i);c!=null&&c.length&&n.push(...c);let d=Rot(s,a,o,i);d!=null&&d.length&&n.push(...d);let u=Dot(s,a,o,i);u!=null&&u.length&&n.push(...u);let h=Oot(s,a,o,i);return h!=null&&h.length&&n.push(...h),n.length&&n.push({update:()=>{s.update()}}),n}function Pot(e,t,r,i){if(e.parameters.type!=="radial")return;let n=t.radial,s=r.radial;if(!s)return;let a=e.parameters.radial,o=[];return xae.forEach(l=>{let c=nf(l,a,n??{},s,i);c&&o.push(c)}),o}function Iot(e,t,r,i){if(e.parameters.type!=="linear")return;let n=t.linear,s=r.linear;if(!s)return;let a=[],o=e.parameters.linear;return wae.forEach(l=>{let c=nf(l,o,n??{},s,i);c&&a.push(c)}),a}function Rot(e,t,r,i){if(e.parameters.type!=="grid")return;let n=t.grid,s=r.grid;if(!s)return;let a=[],o=e.parameters.grid;return _ae.forEach(l=>{let c;l==="count"?c=Qj(l,o,n??{},s,i,!0):c=nf(l,o,n??{},s,i),c&&a.push(c)}),a}function Dot(e,t,r,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,s=r.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return Sae.forEach(l=>{let c;l==="count"?c=ms(l,o,n??{},s,i,!0):c=nf(l,o,n??{},s,i),c&&a.push(c)}),a}function Oot(e,t,r,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,s=r.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return Eae.forEach(l=>{let c=nf(l,o,n??{},s,i);c&&a.push(c)}),a}function Lot(e,t){return{update:()=>{e instanceof es&&(e.fill.enabled=t)}}}function Not(e,t){return{update:()=>{e instanceof es&&(e.stroke.enabled=t)}}}function kot(e,t){return{update:()=>{e instanceof es&&(e.dropShadow.enabled=t)}}}function zot(e,t){return{update:()=>{e instanceof es&&(e.innerShadow.enabled=t)}}}function Bot(e,t){return{update:()=>{e instanceof es&&(e.backgroundBlur.enabled=t)}}}function Fot(e,t){return{update:()=>{e instanceof es&&(e.layerBlur.enabled=t)}}}function jot(e,t,r,i,n){let s=[],a,o,l,c,d,u,h,f,p,m,g,v,y,b,x;if("width"in e&&(a=ms("width",e,t,r,n),a&&s.push(a)),"height"in e&&(o=ms("height",e,t,r,n),o&&s.push(o)),e instanceof es||e instanceof Gc){let S={...t.fill},w={...r.fill};S.enabled!==void 0&&S.enabled!==w.enabled&&(s.push(Lot(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),l=BS("color",e.fill,S,w,n),l&&s.push(l)}if(e instanceof es){let S={...t.stroke},w={...r.stroke};(S.enabled||w.enabled)&&(s.push(Not(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),c=BS("color",e.stroke,S,w,n),c&&s.push(c),d=ms("thickness",e.stroke,S,w,n),d&&s.push(d)}if(e instanceof es){let S={...t.dropShadow},w={...r.dropShadow};(S.enabled||w.enabled)&&(s.push(kot(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),u=BS("color",e.dropShadow,S,w,n),u&&s.push(u),h=ms("blurRadius",e.dropShadow,S,w,n),h&&s.push(h),p=ms("spread",e.dropShadow,S,w,n),p&&s.push(p),f=xk("offset",e.dropShadow,S,w,n),f&&s.push(f)}if(e instanceof es){let S={...t.innerShadow},w={...r.innerShadow};(S.enabled||w.enabled)&&(s.push(zot(e,!0)),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}}),w.enabled||Object.assign(w,{enabled:!0,color:{...w.color,a:0}})),m=BS("color",e.innerShadow,S,w,n),m&&s.push(m),g=ms("blurRadius",e.innerShadow,S,w,n),g&&s.push(g),y=ms("spread",e.innerShadow,S,w,n),y&&s.push(y),v=xk("offset",e.innerShadow,S,w,n),v&&s.push(v)}if(e instanceof es||e instanceof Gc){let S={...t.backgroundBlur},w={...r.backgroundBlur};(S.enabled||w.enabled)&&(s.push(Bot(e,!0)),S.enabled||Object.assign(S,{enabled:!0,radius:0}),w.enabled||Object.assign(w,{enabled:!0,radius:0})),b=ms("radius",e.backgroundBlur,S,w,n),b&&s.push(b)}if(e instanceof es){let S={...t.layerBlur},w={...r.layerBlur};(S.enabled||w.enabled)&&(s.push(Fot(e,!0)),S.enabled||Object.assign(S,{enabled:!0,radius:0}),w.enabled||Object.assign(w,{enabled:!0,radius:0})),x=ms("radius",e.layerBlur,S,w,n),x&&s.push(x)}if(e instanceof Gc||e instanceof Tw){let S=Qj("cornerRadius",e,t,r,n);S&&s.push(S)}return s}function oq(e,t,r,i,n){let s=[];return e.data.visible&&s.push(...Aot(e,t,r,n,i)),e instanceof Un?s.push(...jot(e,t,r,n,i)):(e.data.visible&&s.push(...Mot(e,t,r,i)),Pl(e)?(e instanceof Ys&&e.data.visible&&s.push(...pot(e,t,r,i)),e.data.visible&&s.push(...got(e,t,r,i))):Xrt(e)?e.data.visible&&s.push(...mot(e,t,r,i)):qrt(e)&&s.push(...dot(e,t,r,i))),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,a)})},end:a=>{s.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,a)})}}:void 0}var lq=new L;function Zj(e,t,r=!1){var s;let i=[],n=a=>{let o=a.data;delete a.states,a.currentState=null,a.reversibleToState=null,a.currentTransitionEvent=null;for(let l of o.states){let c={...l.data};a.states||(a.states={}),a.states[l.id]=Xf.patch(o,c)}uq(e.scene,a,null,t,o.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),cq(e)};e.scene.traverse2D(n),e.traverseChildren(a=>{var d,u,h,f,p,m;if(r&&((d=a.rigidBody)==null||d.setTranslation(a.position0,!0),(u=a.rigidBody)==null||u.setRotation(a.rotation0,!0),(h=a.rigidBody)==null||h.setLinvel(lq,!0),(f=a.rigidBody)==null||f.setAngvel(lq,!0)),!_r.is(a))return;let o=a.uuid,l=a.data;if(delete a.states,a.uuid===H0)return;let c=!1;i.some(g=>{var v;return(v=e.scene.find(o))==null?void 0:v.isDescendantOf(g)})?c=!0:((p=l.physics)==null?void 0:p.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&i.push(o),a.data=l,a.currentState=null,a.reversibleToState=null,a.currentTransitionEvent=null;for(let g of l.states){let v={...g.data};e.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||c)&&(g.data.position!==void 0&&delete v.position,g.data.rotation!==void 0&&delete v.rotation,g.data.hiddenMatrix!==void 0&&delete v.hiddenMatrix),a.states||(a.states={}),a.states[g.id]=Wf.patch(l,v)}uq(e.scene,a,null,t,l.events.find(g=>g.data.type==="Follow"||g.data.type==="LookAt")!==void 0),cq(e),a instanceof qs&&a.frame&&(a.frame.traverse(g=>n(g)),(m=a.uiCanvas)==null||m.applySize())}),e.frame&&(e.frame.traverse(a=>n(a)),(s=e.uiCanvas)==null||s.applySize())}function cq(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=e.scene.find(n.data.object);s&&(s.visible=!1)}}})}function uq(e,t,r,i,n=!1){if(t instanceof Ys&&t.removeInteractionGeometry(i),t instanceof Un?t.changeSelectedState(r,{shared:i},n):t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof Ys&&t.updateGeometryGroupsIfNeeded(),t instanceof Js&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof Un)){if(t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible(e)}}function $le(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:s}=e;t=`spring( ${r}, ${i}, ${n}, ${s} )`}else{let r;switch(e.easing){case 0:r=$d.linear;break;case 1:r=$d.ease;break;case 2:r=$d.easeIn;break;case 3:r=$d.easeOut;break;case 4:r=$d.easeInOut;break;default:r=$d.linear}let[i,n,s,a]=r;t=`cubicBezier( ${i}, ${n}, ${s}, ${a} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function wk(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var Vot={type:"beginState"},Uot={type:"completeState",isfromEntity:!1},dq=class{constructor(e,t,r,i,n,s){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object instanceof Un||this.object.traverseEntity(o=>{o!==this.object&&o instanceof Js&&o.dispatchEvent(Vot)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object instanceof Un||this.object.traverseEntity(o=>{o!==this.object&&o instanceof Js&&o.dispatchEvent(Uot)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=oq(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=LE(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=LE(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(r===void 0)throw new Error("Missing property");{let a=LE(this.object,r);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...wk(i),...$le(i),change:this.onChange},this.callback=oq(this.object,t===void 0?{}:this.from.data,r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Hle=class extends Ls{constructor(e,t,r,i){var s;if(super(),this.data=e,this.page=t,this.shared=r,this.condition=i,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var a;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((a=this.timeline)==null||a.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!e.object)throw new Error("Missing property");let n=this.page.scene.find(e.object)??((s=this.page.uiCanvas)==null?void 0:s.find(e.object))??this.page.scene.find2DInUIObjects(e.object);if(!n)throw new Error("Missing property");if(!n.states)throw new Error("Missing property");if(this.object=n,e.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=e.tweens[0].data.delayDirection==="start-once"?e.tweens[0].data.delay:0,this.init()}get playing(){return this.timeline&&this.timeline.paused===!1}init(){this.initialCurrentState=LE(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:r=!1}={}){var i,n,s,a;try{let o=wk(this.data.tweens[0].data);r&&typeof o.loop=="number"&&o.loop--,(i=this.timeline)==null||i.pause(),this.timeline=Ule.timeline({autoplay:!1,...o,...o.loop===!0||o.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let d=c;d<this.data.tweens.length-1;d++){let u=this.data.tweens[d],h=this.data.tweens[d+1],f;d===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(f=void 0,this.object instanceof Js&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new dq(this.object,f,h.data.state===void 0?this.currentState:h.data.state,h.data,this.shared,this.data.allowSlerp??!1);l!==-1&&d===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[d]=p,this.timeline.add(p.params,this.timeline.duration+(d===c?o.delay:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let d=c;d>0;d--){let u=this.data.tweens[d],h=this.data.tweens[d-1],f;d===c&&(this.object.wasMovedByUser===!0||((s=this.object.previousAction)==null?void 0:s.playing)===!0)?(f=void 0,this.object instanceof Js&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new dq(this.object,f,h.data.state===void 0?this.currentState:h.data.state,u.data,this.shared,this.data.allowSlerp??!1);l!==-1&&d===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[d-1]=p,this.timeline.add(p.params,this.timeline.duration+(d===c?o.endDelay:0))}this.timeline.duration+=o.delay}}catch(o){o instanceof Error&&console.error(o.message)}((a=this.object.previousAction)==null?void 0:a.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(Ni(this.shared,this.condition)===!1||this.playing)return!1;clearTimeout(this.timeoutId);let e=wk(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay+e)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Un?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(Ni(this.shared,this.condition)===!1)return!1;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var r;(r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function LE(e,t){var n;let r,i;if(typeof t=="string"?(r=t,i=(n=e.states)==null?void 0:n[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var $ot={type:"beginState"},hq={type:"completeState",isfromEntity:!1},fq={type:"requestRender"},Wle=class extends Ls{constructor(e,t,r,i){super(),this.data=e,this.page=t,this.shared=r,this.condition=i,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new L,this.posEnd=new L,this.qStart=new Xt,this.qEnd=new Xt,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=Ule({targets:r,t:1,...$le(this.data),update:()=>{r.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent($ot));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(fq),r.t===1&&i.dispatchEvent(hq)}})}switchCamera(e){let t=this.page.activeCamera,r=this.page.scene.find(e);if(!r||!r.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(r),t.dispatchEvent({type:"cameraChange",camera:r})}play(){if(Ni(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,r;if(Ni(this.shared,this.condition)===!1)return!1;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward;try{this.playing?((t=this.animation)==null||t.pause(),this.buildAnimation(!0),(r=this.animation)==null||r.play()):this.timeoutId=window.setTimeout(()=>{var i,n;delete this.timeoutId,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(hq),this.page.activeCamera.dispatchEvent(fq))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},Gle=class extends Ls{constructor(e,t,r,i,n){var c,d,u;super(),this.page=t,this.animationControls=r,this.shared=i,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let s=e.object,a=t.scene.find(e.object);a&&Array.isArray(a.identity)&&(s=a.identity[0]),this.data={...e,object:s};let o=this.animationControls.clipIdToAction[e.clipId+"/"+s];this.duration=((c=o==null?void 0:o.getClip())==null?void 0:c.duration)??1;let l=((u=(d=o==null?void 0:o.getClip())==null?void 0:d.tracks[0])==null?void 0:u.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/l*this.duration,this.rightFrameTime=this.data.crop[1]/l*this.duration,this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){if(Ni(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let s=i.split("/")[1];this.threeAnimAction!==n&&s===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((r=this.threeAnimAction)==null||r.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=Et.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(Ni(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,s])=>{let a=n.split("/")[1];this.threeAnimAction!==s&&a===i&&s.isRunning()&&(t?s.fadeOut(.2):s.stop())}),t&&((r=this.threeAnimAction)==null||r.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},qle=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.condition=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(Ni(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),Zj(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},Xle=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=Ni(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=roe(this.data.expression,this.shared,go.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},Yle=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.timeoutId=null}dispatchInner(){if(Ni(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Ni(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let r=roe(t.expression,e,"boolean");return t.negate?!r:!!r}function Aa(e,t,r,i,n,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[]},o=l=>({id:c,data:d})=>{try{d.type==="Audio"&&!(s instanceof Un)?La[e.type].includes("Audio")&&a.Audio.push(new _le(c,d,s,i,l)):d.type==="Video"&&!(s instanceof Un)?La[e.type].includes("Video")&&a.Video.push(new Qle(c,d,s,i,l)):d.type==="Particles"?La[e.type].includes("Particles")&&a.Particles.push(new Sle(d,r,i,l)):d.type==="Link"?La[e.type].includes("Link")&&a.Link.push(new Rat(d,n.controlsManager,i,l)):d.type==="Create"?La[e.type].includes("Create")&&a.Create.push(new Zle(d,r,n.controlsManager,i,l)):d.type==="Destroy"?La[e.type].includes("Destroy")&&a.Destroy.push(new Ele(d,r,n.controlsManager,i,l)):d.type==="Reset"?La[e.type].includes("Reset")&&a.Reset.push(new Cle(d,r,i,n,l)):d.type==="Transition"?La[e.type].includes("Transition")&&a.Transition.push(new Hle(d,r,i,l)):d.type==="SwitchCamera"?La[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new Wle(d,r,i,l)):d.type==="SceneTransition"?La[e.type].includes("SceneTransition")&&a.SceneTransition.push(new qle(d,r,n,i,l)):d.type==="Animation"?La[e.type].includes("Animation")&&a.Animation.push(new Gle(d,r,n.animationControls,i,l)):d.type==="SetVariable"?La[e.type].includes("SetVariable")&&a.SetVariable.push(new Xle(d,r,i,l)):d.type==="DynamicVariablePlay"?La[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new Yle(d,r,i,l)):d.type==="Conditional"&&La[e.type].includes("Conditional")&&(d.ifActions.forEach(o({expression:d.condition,negate:!1})),d.elseActions.forEach(o({expression:d.condition,negate:!0})))}catch{}};return t.forEach(o()),a}function ns(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof _le||r instanceof Qle||r instanceof Sle||r instanceof Gle||r instanceof Hle||r instanceof Zle||r instanceof Ele||r instanceof Wle||r instanceof qle||r instanceof Cle||r instanceof Xle||r instanceof Yle)&&r.dispose()})})}function Hot(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var Kle=new Map,ab=new Map,wv=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:s,delay:a}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let o=Hot(r,i);o&&(this.videoElement=o,this.videoElement.loop=n===1/0,J4&&(this.videoElement.autoplay=!0),s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),ab.has(r.uuid)?ab.get(r.uuid).push(this):ab.set(r.uuid,[this]),Kle.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},_k=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=Kle.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=ab.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...ab.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Qle=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new wv(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new _k(t);else throw new Error("Missing property")}dispatchBasic(){if(Ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof wv?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(Ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof wv?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},pq=(()=>{let e,t,r,i;function n(o){!e&&!mq()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),o&&(t=o,i=o.requestRender)}function s(o){let l=r?o-r:0,c=t.sharedGameControlGlobals.createdObjects,d=t.sharedGameControlGlobals.nCreatedPerAction,u=c.length,h=0;for(;h<u;){let f=c[h];f.userData.createdTime===void 0&&(f.userData.createdTime=o),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&o-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&d[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),i()),h++):(d[f.userData.actionId]>f.userData.quantity&&d[f.userData.actionId]--,c.splice(h,1),f.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&f.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(f.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody)):(f.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.bvhGeometry!==void 0)),u--,i())}e=h>0?requestAnimationFrame(s):void 0,r=h>0?o:void 0}function a(){mq()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),n})();function mq(){return!!document&&document.hidden}var gq=new Xt,Wot=new L,Got=new L,Zle=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=Et.generateUUID(),this.dispatch=()=>{if(Ni(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(Ni(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=BKe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let a=new Xs(this.object);if(a.playModeVisible=!0,a.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,c=this.page.scene.find(l);c&&(c.updateMatrixWorldSVD(),a.hiddenMatrix.copy(c.matrixWorldRigid))}a.position.fromArray(this.data.position),a.rotation.fromArray(this.data.rotation),a.updateMatrix(),this.page.add(a);let o=this.controlsManager.sharedGameControlGlobals;o.createdObjects.push(a),o.nCreatedPerAction[this.uniqueId]===void 0?o.nCreatedPerAction[this.uniqueId]=1:o.nCreatedPerAction[this.uniqueId]++,a.updateWorldMatrix(!0,!0),a.traverseObject(this.traverseObjectCB),pq(),this.controlsManager.requestRender()},this.traverseObjectCB=a=>{var d,u,h,f;a.hasNonUniformScale&&a.updateMatrixWorldSVD();let o;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(a instanceof Ol)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;o=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof Xs)o=a.object;else if(o=a,(d=o.dataPatched.cloner)==null?void 0:d.hideBase)return!0}else{if(a instanceof Ol)return;a instanceof Xs?o=a.object:o=a}this.data.destroy==="Time"?a.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(a.userData.quantity=this.data.destroyAfterQuantity,a.userData.actionId=this.uniqueId);let l=new L().fromArray(this.data.velocity),c=o.dataPatched;if(!(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(a,o,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((u=a.rigidBody)==null||u.collider(0).setActiveEvents(1),a.userData.hasCollisionDestroy=!0),a.matrixWorld.decompose(Wot,gq,Got),l.applyQuaternion(gq),this.data.velocity.some(p=>p!==0)&&this.data.dynamic&&((h=a.rigidBody)==null||h.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in a.object&&this.controlsManager.addBoundsTree(a),this.data.velocity.some(p=>p!==0)&&this.data.dynamic&&(a.userData.velocity=l)),((f=o.dataPatched.physics)==null?void 0:f.fusedBody)===!0))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");pq(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},Jle=200,RD=.02,DD=.3,qot=65;new L;var vq=new L,yq=new L,Xot=new L,ua=new L,Na=new L,kd=new L,OD=new Ke,bq=new Ke,Yot=new Ke;new Ke;var gl=new Xt,yu=new Xt,hc=new kn(0,0,0,"YXZ"),Kot=new L(1,0,0),vl=new L(0,1,0),Qot=new L(0,0,1),xq=new L(1,1,1);new Za;var Zot=1,Jot=.025,elt=16e-6,wq=12,tlt=20,Xn=new el,Fo=new un,rlt={type:"requestRender"},ilt={type:"updateMatrix"},_q=Math.PI/6,Sk=class extends Ls{constructor(e,t,r,i,n,s,a,o,l){var p;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new Ke,this.target0=new L,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=Jle,this.euler0=new kn(0,0,0,"YXZ"),this.position0Cam=new L,this.quat0Cam=new Xt,this.scale0Cam=new L,this.hiddenMatrix0Cam=new Ke,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new el(new L(0,-40,0),new L(0,40,0)),matrix:new Ke,position:new L,rotation:new Xt},this.euler=new kn(0,0,0,"YXZ"),this.eulerDelta=new L,this.lastPosition=new L,this.lastCameraQuaternion=new Xt,this.lastCameraPosition=new L,this.PI_2=Math.PI/2,this.prevMouse=new oe,this.velocityTarget=new L,this.velocity=new L,this.directionXZ=new L,this.rotVelocityStick=new L,this.rotVelocityTarget=new L,this.rotVelocity=new L,this.rotDirection=new L,this.nonColliderRotOffset=new Ke,this.nonColliderPosOffset=new Ke,this.firstPointerId=-1,this.rot=new L,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new Ke,this.objectToTarget=new L,this.objectToTarget0=new L,this.objectToCamXZ=new L,this.objectToCamXZ0=new L,this.targetToCamera=new L,this.targetToCamera0=new L,this.cameraPolarAxis0=new L,this.targetPos=new L,this.targetQuat=new Xt,this.lerpFactorPos=new L().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Xt,this.objXZQuatInv=new Xt,this.objXZRotMat=new Ke,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new L,this.pushedVelocity=new L,this.groundYRotation=0,this.objectRealQuat=new Xt,this.colliderWorldQuat=new Xt,this.groundNormal=new L,this.groundTilt=new Xt,this.groundTiltInv=new Xt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new L,this.quaternion=new Xt,this.scale=new L,this.initialAction=!0,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!mo&&(!rG||iG>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let g=m.clientX-this.prevMouse.x,v=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(rG&&iG<15.5&&!mo?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-v*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-v*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?Sk.isLocked=!0:Sk.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]){this.movementState[g[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]||m.code.slice(3,m.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(m,g)=>{for(let v=2;v<4;v++){let y=m.axes[v];g===0?v===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,v===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),d=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,d,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new L(0,0,-1).applyQuaternion(this.camera.quaternion),g=new L().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let v,y;Math.abs(m.y)<1e-6?(g.y=0,m.y=0,y=g.projectOnVector(m)):g.y/m.y>0?y=m.multiplyScalar(g.y/m.y):y=m.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),v=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(v,this.position);let b=new kn().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-b.x,b.x=0,b.z=0,b.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(b)}if(this.object instanceof Js&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*Zot,this.speedOrbit=(r.speedRotate??100)*Jot,this.mouseOrbitSensitivity=(r.speedRotate??100)*elt,this.keyAssignments=r.keyAssignments.map(m=>{let g=[m[0],m[1]];return g[1]==="▲"?g[1]="ArrowUp":g[1]==="◀"?g[1]="ArrowLeft":g[1]==="▼"?g[1]="ArrowDown":g[1]==="▶"?g[1]="ArrowRight":g[1]==="⇧"?g[1]="Shift":g[1]==="↵"?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]==="⌘"?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),r.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??t0.defaultData.gravity)*wq,this.usePhysics=this.gloabalPhysics.usePhysics??t0.defaultData.usePhysics,this.jumpPower=r.jumpPower*tlt,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??KA.defaultDataThirdPerson.orientWith,this.slopeThresh=qot*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*RD/this.pixelsPerMeter,this.stepThresh=r.collider.height*DD/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*RD/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*DD/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*RD/this.pixelsPerMeter,this.stepThresh=r.collider.height*DD/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let u=new L().fromArray(r.collider.position),h=new Xt().setFromEuler(new kn().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(u).multiply(this.scale),this.collider.rotation.copy(h),this.collider.matrix.compose(u,h,xq),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.runMultiplier=r.runMultiplier??2;let f=r.navmesh.destinationHelperRadius*2;if(f>0){let m=new Nt;m.push({fi:0,data:{...Qn.defaultData("light","phong"),alpha:0},id:"layer1"}),m.push({fi:0,data:{...Qn.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let g=new Aj({layers:m},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new An(zae.create({parameters:{width:f,height:f/10,hollow:.7}}),g),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new kn().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof Js?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},YA.list.forEach(r=>{this.actions[r]=Aa({...e,disabled:!1,type:"GameControl"},e.gameActions[r],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),ns(this.actions.idle),ns(this.actions.move),ns(this.actions.run),ns(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return ua.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var o,l,c,d,u,h,f,p,m;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let g=Na.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*wq),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),v=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,g,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(v){this.onObject=!0,this.groundNormal.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=v.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let y=v.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===y&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(ua,yu,Na),this.groundVelocity.subVectors(ua,b.prevT),this.object.getWorldPosition(Na).add(this.collider.position).sub(ua),this.groundYRotation=hc.setFromQuaternion(yu).y-b.prevR.y,kd.copy(Na).applyAxisAngle(vl,this.groundYRotation),this.groundVelocity.add(kd.sub(Na)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let g=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let v=ua.subVectors(this.path[1],this.position),y=Na.subVectors(this.path[1],this.path[0]);v.dot(y)<0?this.path.shift():(this.directionXZ.x=y.x,this.directionXZ.z=y.z),g.opacity=g.userData.opacity0}else g.opacity-=.05*g.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=Xot.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let g=Na.copy(a);g.y=0,a.set(0,a.y,g.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let g=ua;this.camera.getWorldDirection(g);let v=kd.copy(vl).multiplyScalar(g.dot(vl));g.sub(v);let y=Na.copy(this.directionXZ);y.x*=-1,this.rot.y=g.angleTo(y)*(g.cross(y).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(hc.setFromVector3(this.rot),this.moveMode==="walk"&&(hc.x=0),a.applyEuler(hc),s&&(yu.setFromUnitVectors(vl,this.groundNormal),a.applyQuaternion(yu)),r){let g=hc.set(0,this.vrEulerYOffset*_q,0);r.applyEuler(g),a.x+=r.x,a.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let g=Na;this.pushedVelocity.set(0,0,0);for(let v of this.sharedGameControlGlobals.entitiesWithTransformAnim){let y=kd.setFromMatrixPosition(v.matrixWorld).sub(v.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),b=v.rigidBody.collider(0).castCollider(y,this.object.rigidBody.collider(0),ua.copy(a).divideScalar(this.pixelsPerMeter),i,!1);y.multiplyScalar(this.pixelsPerMeter);let x=_r.is(v)?v:v.object;if(b!==null&&this.lastHitObj!==x){let S;v instanceof Xs&&(S=v);let w=this.sharedGameControlGlobals.entityToCollisionEvents[x.uuid];if(w)for(let E of w)E.data.target==="character"&&(E.dispatch(S),x.dispatchEvent(Ck));this.lastHitObj=x}if(b!==null){this.pushedVelocity.copy(y),g.copy(b.normal1).applyQuaternion(v.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let v=g.dot(a);v<0&&a.addScaledVector(g,-v),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(vl,this.euler.y-this.euler0.y);let g=Na.copy(this.objectToCamXZ).normalize(),v=kd.copy(a).multiplyScalar(i);v.y=0;let y=v.sub(ua.copy(g).multiplyScalar(v.dot(g))).cross(g).y;this.euler.y-=Math.atan2(y,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=Et.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=Et.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=Et.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(hc.copy(t),hc.y=0):(hc.copy(this.euler),hc.y=0),this.nonColliderRotOffset.makeRotationFromEuler(hc)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*_q),gl.setFromAxisAngle(Kot,this.rot.x),yu.setFromAxisAngle(vl,this.rot.y),yu.multiply(gl),gl.setFromAxisAngle(Qot,this.rot.z),yu.multiply(gl),this.quaternion.copy(yu),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let g=Na.copy(a).multiplyScalar(i/this.pixelsPerMeter),v=null;this.didHit=!1;let y=new L;for(let b=0;b<5;b++){let x=g.length(),S=kd.copy(g).normalize();if(v=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),this.colliderWorldQuat,S,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,x,!1,24,void 0,void 0,this.object.rigidBody),v!==null){this.didHit=!0;let w=this.sharedGameControlGlobals.colliderToEntity.get(v.collider.handle);if(w!==this.lastHitObj&&b===0){this.lastHitObj=w;let A=this.sharedGameControlGlobals.entityToCollisionEvents[w==null?void 0:w.uuid];if(A){for(let M of A)if(M.data.target==="character"){let P=((d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.getCollider(v.collider.handle))._parent,I;if(w.cloner){for(let R of w.cloner.children)if(R.rigidBody===P){I=R;break}}M.dispatch(I),w.dispatchEvent(Ck)}}}let E=vq.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat),C=yq.copy(S).multiplyScalar(v.toi).dot(E),T=v.toi;if(T===0&&(this.position.y+=this.offset*this.pixelsPerMeter),C>this.offset&&(T=v.toi*(C-this.offset)/C,y.addScaledVector(S,T)),g.copy(S).multiplyScalar(x-T),Math.acos(-E.y)>this.slopeThresh){let A=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),M=kd.copy(v.witness2).applyQuaternion(this.colliderWorldQuat);M.y=0;let P=A.add(M);P.y+=this.stepThresh;let I=this.sharedGameControlGlobals.rapierWorld.castShape(P,this.colliderWorldQuat,g,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);I!==null&&I.toi===0&&(E.y=0,E.normalize())}g.addScaledVector(E,-g.dot(E))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),y.add(g);break}}this.position.addScaledVector(y,this.pixelsPerMeter),(h=this.object.rigidBody)==null||h.setTranslation(ua.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(gl.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let g=this.onObject?1:5,v=a.multiplyScalar(i/g);for(let y=0;y<g;y++)this.position.add(v),this.collisionAdjustment(i/g)}else this.position.addScaledVector(a,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let g=this.objectToTarget.add(this.position),v=this.targetToCamera.add(g);OD.lookAt(v,g,vl).setPosition(v),OD.decompose(this.targetPos,this.targetQuat,ua),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=Et.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=Et.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(ilt),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((m=(p=this.navMeshPathDest)==null?void 0:p.material)==null?void 0:m.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(rlt),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=gl.setFromAxisAngle(vl,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?Et.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=Et.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=Et.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=ua.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=yu.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){vl.angleTo(e)*180/Math.PI<15||vl.angleTo(e)*180/Math.PI>85?gl.identity():gl.setFromUnitVectors(vl,e),this.groundTilt.slerp(gl,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var n;let t=yq.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=OD.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(ua,gl,Na).compose(ua,gl,xq);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;Fo.makeEmpty(),s.updateMatrixWorldSVD();let a=s.matrixWorldRigid,o=bq.copy(a).invert(),l=Yot.copy(bq).multiply(r);Xn.copy(this.collider.segment),Xn.start.applyMatrix4(l),Xn.end.applyMatrix4(l);let c=vq.copy(this.position).applyMatrix4(o);Fo.expandByPoint(Xn.start),Fo.expandByPoint(Xn.end),Fo.min.addScalar(-this.collider.radius),Fo.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(d){return d.distanceToPoint(Xn.end)},intersectsBounds:d=>d.intersectsBox(Fo),intersectsTriangle:d=>{let u=ua,h=Na,f=d.closestPointToSegment(Xn,u,h);if(f<this.collider.radius){let p=this.collider.radius-f,m=h.sub(u).normalize(),g=kd.copy(c);g.addScaledVector(m,p);let v=g.applyMatrix4(a).sub(this.position);t.add(v),Xn.start.addScaledVector(m,p),Xn.end.addScaledVector(m,p)}}})}),Fo.makeEmpty(),Xn.copy(this.collider.segment),Xn.start.applyMatrix4(r),Xn.end.applyMatrix4(r),Fo.expandByPoint(Xn.start),Fo.expandByPoint(Xn.end),Fo.min.addScalar(-this.collider.radius),Fo.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(Xn.end)},intersectsBounds:s=>s.intersectsBox(Fo),intersectsTriangle:s=>{let a=ua,o=Na,l=s.closestPointToSegment(Xn,a,o);if(l<this.collider.radius){let c=this.collider.radius-l,d=o.sub(a).normalize();this.alignToGround&&this.groundTiltAdjustment(d),t.addScaledVector(d,c),Xn.start.addScaledVector(d,c),Xn.end.addScaledVector(d,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},ece=Sk;ece.isLocked=!1;var nlt=Pn(mne());function Ru(e,t){let r=new Dt;if(!e.getAttribute("position"))return r.setAttribute("position",new vt([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=YM(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new vt(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var slt=new Ke,alt=new Ke,fc=[[0,0,0],[0,0,0],[0,0,0]];function tce(e){let t=e.elements;fc[0][0]=t[0],fc[0][1]=t[4],fc[0][2]=t[8],fc[1][0]=t[1],fc[1][1]=t[5],fc[1][2]=t[9],fc[2][0]=t[2],fc[2][1]=t[6],fc[2][2]=t[10];let{u:r,v:i}=(0,nlt.SVD)(fc),n=slt.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),s=alt.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var olt=class extends ose{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new tf({color:65280,linewidth:10}),t=new L(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new L(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new L().addVectors(t,r.multiplyScalar(i)),s=new Dt;return s.setFromPoints([t,n]),new yA(s,e)}},rce=e=>e instanceof yv||e instanceof bv;function llt(e,t){return e.distance-t.distance}function ice(e,t,r){if(!(!Iu(t)||!t.visible)){Pl(t)&&t.raycast(e,r);for(let i of t.children)ice(e,i,r)}}function NE(e,t,r,i=!1){if(!i&&!r.some(s=>fT(e,s)!==void 0))return[];let n=[];return t.children.forEach(s=>ice(e,s,n)),n.sort(llt),n}function Ek(e){let t=[];if(e.length){let r=e[0].object;Iu(r)&&t.push(r);let i=r.parent;for(;i;)rce(i)&&t.push(i),i=i.parent}return t}function Du(e,t,r,i){let n=e.frame;if(n){let s=t[0]*n.width,a=(1-t[1])*n.height;for(let o of r){let l=o===n.uuid?n:n.find(o);if(l!=null&&l.intersects(s,a))return i(l),!0}}return!1}function fT(e,t){if(Pl(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(rce(t))return nce(e,t)}function nce(e,t){if(!(!Iu(t)||!t.visible)){if(Pl(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=nce(e,r);if(i)return i}}}function clt(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}function ult(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width,y:1-(t-(r.top+window.scrollY))/r.height}}var dlt=class{constructor(e,t,r,i,n,s,a,o){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new olt,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var i;let{pageX:t,pageY:r}=((i=e.touches)==null?void 0:i.length)>0?e.touches[0]:e;this.pointerWorld=clt(t,r,this._domRect),this.pointerScreen=ult(t,r,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},rc=class{constructor(t){this.eventContext=t,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},Jj=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],sce=e=>{var t;return(t=Jj.find(([r,i])=>i===e))==null?void 0:t[0]},Mw=e=>{var t;return(t=Jj.find(([r])=>r===e))==null?void 0:t[1]},hlt=(e,t)=>{let r=sce(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},flt=class extends rc{constructor(e){super(e),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=r=>{var s;if(!r.eventName||!r.target||r.eventName==="Scroll")return;let i=(s=this.splineEvents[sce(r.eventName)])==null?void 0:s[r.target.uuid];if(!i)return;r.eventName==="Scroll"&&r.deltaY!==void 0&&Object.assign(i,{deltaY:r.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(i)};let{page:t}=this.eventContext;t.traverseEntity(r=>{var i,n;if((i=r.data)!=null&&i.events.length){for(let[s,a]of Jj)if(r.data.events.some(o=>o.data.type===a&&!o.data.disabled)){this.objectsPerEvents.has(s)?(n=this.objectsPerEvents.get(s))==null||n.push(r):this.objectsPerEvents.set(s,[r]);let o={id:r.uuid,name:r.name},l=hlt(a,o),c=this.splineEvents[s];c?c[r.uuid]=l:this.splineEvents[s]={[r.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},plt=class{constructor(e,t,r,i,n,s){if(this.id=e,this.data=t,this.object=r,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=t.runMode==="Toggle",(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=Aa(t,t.actions,i,n,s,r)}disconnect(){ns(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this?(t.object.currentTransitionEvent=this,t.init()):this.data.runMode==="Once"&&this.alreadyPlayedNonTogglingActions.add(t)}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing)||this.actions.Transition.forEach(t=>{this.alreadyPlayedNonTogglingActions.has(t)===!1&&t.play()}),this.actions.SwitchCamera.some(t=>t.playing)||this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch())}},mlt=class extends rc{constructor(e,t,r){super(e),this.useForRaycastProperty=r,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=a=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(a);let{raycaster:o,page:l}=this.eventContext,c=NE(o,l,[],!0);this.sceneInterects=c,c.length&&(this.eventContext.sharedAssets.raycastProperty={x:c[0].point.x,y:c[0].point.y,z:c[0].point.z,objX:c[0].object.matrixWorld.elements[12],objY:c[0].object.matrixWorld.elements[13],objZ:c[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=a=>{(a.target===this.eventContext.domElement||a.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(o=>{(o.data.type==="MouseDown"||o.data.type==="MousePress")&&(this.onCanvasRaycast(a),o.dispatch())})},this.onCanvasMouseUp=a=>{(a.target===this.eventContext.domElement||a.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(o=>{o.data.type==="MouseUp"?(this.onCanvasRaycast(a),o.dispatch()):o.data.type==="MousePress"&&o.dispatchRelease()})},this.onMouseDown=a=>{Ut.length>1||(this.eventContext.updateRaycaster(a),this.handleMouseEvent("MouseDown"))},this.onMouseUp=a=>{Ut.length>1||(this.eventContext.updateRaycaster(a),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=a=>{Ut.length>1||(this.eventContext.updateRaycaster(a),this.handleMousePressEvent())},this.onMousePressRelease=a=>{Ut.length>1||(this.eventContext.updateRaycaster(a),this.handleMousePressEvent(!0))},this.onKeyDown=a=>{this.heldKeys[a.key]||(this.handleKeyEvent(a,"KeyDown"),this.handleKeyEventHeld(a,"KeyDown",!0)),this.heldKeys[a.key]=!0},this.onKeyUp=a=>{this.handleKeyEvent(a,"KeyUp"),this.handleKeyEventHeld(a,"KeyUp",!0)},this.onKeyPressDown=a=>{this.heldKeysPress[a.key]?this.handleKeyEventHeld(a,"KeyPress"):(this.handleKeyEvent(a,"KeyPress"),this.handleKeyEventHeld(a,"KeyPress",!0)),this.heldKeysPress[a.key]=!0},this.onKeyPressUp=a=>{this.handleKeyEvent(a,"KeyPress",!0)},this.releaseHeldKey=a=>{delete this.heldKeys[a.key]},this.releaseHeldKeyPress=a=>{delete this.heldKeysPress[a.key]},this._onUserEvent=({eventName:a,target:o,reverse:l})=>{var d,u,h,f;if(!a||!o)return;let c=Mw(a);c&&(c==="MouseDown"||c==="MouseUp"||c==="MousePress"?(o.dispatchEvent({type:"beginEvent",eventName:c}),(u=(d=this.eventsPerObjects[c])==null?void 0:d[o.uuid])==null||u.forEach(p=>{p.dispatchUserEvent(l)})):(c==="KeyDown"||c==="KeyUp"||c==="KeyPress")&&(o.dispatchEvent({type:"beginEvent",eventName:c}),(f=(h=this.eventsPerObjects[c])==null?void 0:h[o.uuid])==null||f.forEach(p=>{p.dispatchUserEvent()})))};let{page:i,sharedAssets:n}=this.eventContext,s=(a,o)=>{var c,d;if(!((c=a.data)!=null&&c.events.length))return;let l=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let u of l){let h=this.eventsPerObjects[u];a.data.events.filter(({data:f})=>f.type===u&&f.disabled!==!0).forEach(({id:f,data:p})=>{try{let m=new plt(f,p,a,i,n,t);m.actions.Video.length&&(this.hasVideoAction=!0),(p.type==="MouseDown"||p.type==="MouseUp"||p.type==="MousePress")&&(p.mode==="Canvas"||p.mode==="Window")?this.canvasMouseEvents.push(m):h[a.uuid]?h[a.uuid].some(g=>g.id===m.id)||h[a.uuid].push(m):h[a.uuid]=[m]}catch{}}),(d=h[a.uuid])!=null&&d.length&&this.objectsPerTypes[u].push(a instanceof Un&&(u==="MouseDown"||u==="MouseUp"||u==="MousePress")?o:a)}};i.traverseEntity(a=>{var o;(a instanceof qs||a instanceof Jn)&&((o=a.frame)==null||o.traverse(l=>{s(l,a)})),s(a)})}connect(){var t,r,i,n,s,a;let{domElement:e}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),e.addEventListener("pointerdown",this.onCanvasMouseDown),e.addEventListener("pointerup",this.onCanvasMouseUp),((t=this.objectsPerTypes.MouseDown)!=null&&t.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown)),(r=this.objectsPerTypes.MouseUp)!=null&&r.length&&(this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),(i=this.objectsPerTypes.MousePress)!=null&&i.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMousePressRelease)),(n=this.objectsPerTypes.KeyDown)!=null&&n.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(a=this.objectsPerTypes.KeyPress)!=null&&a.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([o,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){var o,l,c,d;let{stopRaycast:t,raycaster:r,page:i,pointerScreen:n}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter(u=>!(u instanceof Un));if(!(!s.length&&!this.useForRaycastProperty)&&!(i.uiCanvas&&Du(i,[n.x,n.y],Object.keys(this.eventsPerObjects[e]),u=>{this.handleObjectMouseEventDispatch(u,e)}))){if(t||this.useForRaycastProperty){let u;if(this.sceneInterects===null?u=NE(r,i,a,this.useForRaycastProperty):(u=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&u.length&&(this.eventContext.sharedAssets.raycastProperty={x:u[0].point.x,y:u[0].point.y,z:u[0].point.z,objX:u[0].object.matrixWorld.elements[12],objY:u[0].object.matrixWorld.elements[13],objZ:u[0].object.matrixWorld.elements[14]}),t){let h=[((l=(o=u[0])==null?void 0:o.uv)==null?void 0:l.x)??0,((d=(c=u[0])==null?void 0:c.uv)==null?void 0:d.y)??0];Ek(u).forEach(f=>{f instanceof qs&&Du(f,h,Object.keys(this.eventsPerObjects[e]),p=>{this.handleObjectMouseEventDispatch(p,e)}),this.eventsPerObjects[e][f.uuid]&&this.handleObjectMouseEventDispatch(f,e)})}}t||a.forEach(u=>{var f,p;let h=fT(r,u);h&&(this.handleObjectMouseEventDispatch(u,e),u instanceof qs&&Du(u,[((f=h==null?void 0:h.uv)==null?void 0:f.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[e]),m=>{this.handleObjectMouseEventDispatch(m,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=r.filter(s=>!(s instanceof Un)),n=[];if(r.length){if(!e){let{stopRaycast:s,raycaster:a,page:o,pointerScreen:l}=this.eventContext,c=!1;if(o.uiCanvas&&(c=Du(o,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),d=>{n.push(d)})),s&&!c){let d=NE(a,o,i);n=Ek(d),d.forEach(u=>{var h,f;u.object instanceof qs&&Du(u.object,[((h=u==null?void 0:u.uv)==null?void 0:h.x)??0,((f=u==null?void 0:u.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),p=>{n.push(p)})})}else i.forEach(d=>{var h,f;let u=fT(a,d);u&&(n.push(d),d instanceof qs&&Du(d,[((h=u==null?void 0:u.uv)==null?void 0:h.x)??0,((f=u==null?void 0:u.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),p=>{n.push(p)}))})}this._prevObjects.length&&this._prevObjects.forEach(s=>{n.includes(s)||this.handleObjectMouseEventDispatchRelease(s,t)}),n.length&&n.forEach(s=>{this.handleObjectMouseEventDispatch(s,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:s})=>"key"in s&&s.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(r?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},glt=new L,vlt=new L,ace=class{constructor(e,t,r,i,n){this.actionsIn=Aa(e,e.inActions,r,i,n,t),this.actionsOut=Aa(e,e.outActions,r,i,n,t)}disconnect(){ns(this.actionsIn),ns(this.actionsOut)}},ylt=class extends ace{constructor(e,t,r,i,n,s){super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let h of this.objects)if(!h.visible)return;let c=glt.setFromMatrixPosition(this.objects[0].matrixWorld),d=vlt.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(d)<=this.distance?"in":"out";if(this.stage!==u){this.stage=u;let h=u==="in"?this.actionsIn:this.actionsOut;h.Audio.forEach(f=>f.dispatchConditional()),h.Particles.forEach(f=>f.dispatchConditional()),h.Video.forEach(f=>f.dispatchConditional()),h.Link.forEach(f=>f.dispatch()),h.Create.forEach(f=>f.dispatch()),h.Destroy.forEach(f=>f.dispatch()),h.Reset.forEach(f=>f.dispatch()),h.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),h.Transition.forEach(f=>f.play()),h.Animation.forEach(f=>f.play()),h.SwitchCamera.forEach(f=>f.play()),h.SceneTransition.forEach(f=>f.dispatch()),h.SetVariable.forEach(f=>f.checkConditions()),h.SetVariable.forEach(f=>f.dispatch()),h.DynamicVariablePlay.forEach(f=>f.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let d=i.find(c);if(!d)throw new Error("Missing property");this.objects.push(d)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},blt=class extends ace{constructor(e,t,r,i,n,s){var l;super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.onBegin=({target:c,state:d})=>{this.toState!==d&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Particles.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Link.forEach(u=>u.dispatch()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Reset.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsOut.Animation.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()),this.actionsOut.SceneTransition.forEach(u=>u.dispatch()),this.actionsOut.SetVariable.forEach(u=>u.checkConditions()),this.actionsOut.SetVariable.forEach(u=>u.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(u=>u.dispatch()))},this.onComplete=({target:c,state:d})=>{this.toState===d&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Particles.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Link.forEach(u=>u.dispatch()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Reset.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsIn.Animation.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()),this.actionsIn.SceneTransition.forEach(u=>u.dispatch()),this.actionsIn.SetVariable.forEach(u=>u.checkConditions()),this.actionsIn.SetVariable.forEach(u=>u.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(u=>u.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=i.find(a.object)??i.scene.find2D(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!((l=this.toObject.states)!=null&&l[a.state]))throw new Error("Missing property");this.toState=a.state}connect(){Hf(this.actionsOut).forEach(e=>{var t;(t=this.actionsOut[e])!=null&&t.length&&this.toObject.addEventListener("beginState",this.onBegin)}),Hf(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),Hf(this.actionsOut).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),Hf(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},xlt=class extends rc{constructor(e,t){super(e),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:r,sharedAssets:i}=this.eventContext;r.traverseEntity(n=>{var s;if((s=n.data)!=null&&s.events.length){for(let{id:a,data:o}of n.data.events)if(!o.disabled&&o.type==="Conditional")try{let l;o.condition.type==="Comparison"||(o.condition.type==="Distance"?l=new ylt(a,o,n,r,i,t):o.condition.type==="State"&&(l=new blt(a,o,n,r,i,t))),l&&(this.eventsPerConditions[o.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},Gy=new L,zd=new L,ff=new L,Sq=new co,wlt=.01,jr=new L,Ln=new L,Eq=new L,Qf=new Xt,LD=new kn,_lt=new Ke,ND=new on,ig=new L,pc=new L,ng=.2;function kD(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var Slt=function(){let e=new Ke;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&kD(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?kD(n.position,t.limits):t.reference==="local"&&(Qf.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(Qf),kD(n.position,t.limits),Qf.invert(),n.position.applyQuaternion(Qf),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(jr,n.quaternion,Ln),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof Ca&&Hu(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),Elt=class{constructor(e,t,r,i,n,s){this.object=e,this.data=t,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Aa(t,t.dragDropActions.drag,r,i,n,this.object),this.actionsDrop=Aa(t,t.dragDropActions.drop,r,i,n,this.object);let a=[];this.data.objects.forEach(o=>{let l=r.find(o);!l||l.data.visible!==!1&&(a.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let d=r.find(c);!d||d.data.visible!==!1&&a.push(d)}))}),this.data.dropDestinations.forEach(o=>{let l=r.find(o);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let d=r.find(c);!d||d.data.visible!==!1&&this.dropDestIds.push(d.uuid)}))}),this.dragItems=a.map(o=>(this.data.planeMode==="locked"&&(o.userData.lockedPlane=!0),o.userData.worldPosition0=new L().setFromMatrixPosition(o.matrixWorld),{obj:o,fromPosition:new L().setFromMatrixPosition(o.matrixWorld),pointStart:new L,pointEnd:new L,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new L().copy(o.position),quat0:new Xt().copy(o.quaternion),snapped:!1,orientationMatrix:new Ke,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){ns(this.actionsDrag),ns(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},Clt=class extends rc{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=i=>{var o;if(Ut.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:d,pointEnd:u,pointStart:h}of l.dragItems){if(d===a[0].object||d===a[0].object.object||_r.is(d)&&d.isAncestorOf(a[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let f=l.activeDragItem.obj;d.hasNonUniformScale&&d.updateMatrixWorldSVD(),(f.hasNonUniformScale?f.matrixWorldRigid:f.matrixWorld).decompose(jr,Qf,Ln),LD.setFromQuaternion(Qf),f.prevR===void 0?(f.prevR=LD.clone(),f.prevT=jr.clone()):(f.prevR.copy(LD),f.prevT.copy(jr)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(d,h,l.data.plane,l.data.referenceFrame),u.copy(h),(this.eventManager.controlsManager.usePhysics&&((o=d.data.physics)==null?void 0:o.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=i=>{var o,l,c,d;if(Ut.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(Ut.length===0){let u=!1;for(let h of this.events){for(let{obj:f}of h.dragItems)if(f===((o=a[0])==null?void 0:o.object)||f===((c=(l=a[0])==null?void 0:l.object)==null?void 0:c.object)||_r.is(f)&&f.isAncestorOf((d=a[0])==null?void 0:d.object.uuid)){switch(u=!0,h.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(u)break}u||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let u=this.activeEvent.activeDragItem;u.snapped=!1;let h;if(this.activeEvent.data.drop&&(h=a.filter(f=>u.obj!==f.object&&!u.obj.isAncestorOf(f.object.uuid)&&!(f.object instanceof yv)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(p=>p===f.object.uuid||s.scene.find(p).isAncestorOf(f.object.uuid))))[0]),h){let f=Eq.copy(h.face.normal).applyMatrix3(ND.getNormalMatrix(h.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")u.fromPosition.setFromMatrixPosition(h.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(u.fromPosition.copy(h.point),this.activeEvent.data.snapSurfaceMode==="bbox"){jr.copy(f).applyMatrix3(ND.setFromMatrix4(u.obj.matrixWorld).transpose());let p=u.obj;jr.x>ng?Ln.x=-p.recursiveBBox.min.x:jr.x<-ng&&(Ln.x=-p.recursiveBBox.max.x),jr.y>ng?Ln.y=-p.recursiveBBox.min.y:jr.y<-ng&&(Ln.y=-p.recursiveBBox.max.y),jr.z>ng?Ln.z=-p.recursiveBBox.min.z:jr.z<-ng&&(Ln.z=-p.recursiveBBox.max.z),Ln.applyMatrix3(ND.invert())}else Ln.copy(f).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);u.fromPosition.add(Ln)}this.activeEvent.data.autoOrient&&(jr.set(0,1,0).cross(f),jr.length()<1e-4&&jr.set(-1,0,0).cross(f),Ln.crossVectors(Eq,jr),u.orientationMatrix.makeBasis(jr,Ln,f)),u.pointStart.copy(u.fromPosition),u.pointEnd.copy(u.pointStart),u.currentDampingFactor=this.activeEvent.snapDampingFactor,u.snapped=!0,this.lastDropDestination!==h.object&&(this.lastDropDestination=h.object,this.activeEvent.actionsDrop.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(p=>{p.dispatchThrottled()}))}else u.orientationMatrix.makeRotationFromQuaternion(u.quat0),this.lastDropDestination=null,u.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(u.obj,u.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.stop()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(f=>{f.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(f=>{f.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(f=>f.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(f=>f.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(f=>f.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(f=>{f.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(f=>{f.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(f=>{f.stop()}))},500),this.updateDragItem(u),u.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=i=>{var n;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((n=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:n.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(a=>a.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let r={};e.page.traverseEntity(i=>{i.component&&(r[i.component.uuid]?r[i.component.uuid].push(i.uuid):r[i.component.uuid]=[i.uuid])}),e.page.traverseEntity(i=>{var n;(n=i.data)==null||n.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new Elt(i,s.data,e.page,e.sharedAssets,t,r))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let e=this.eventContext.domElement;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,i){let{getCamera:n,raycaster:s}=this.eventContext;n().getWorldDirection(zd),zd.negate();let a=Qf.identity();switch(i==="parent"?_lt.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(jr,a,Ln):i==="local"&&e.matrixWorld.decompose(jr,a,Ln),r){case"x":jr.set(1,0,0).applyQuaternion(a),ig.copy(zd).cross(jr),pc.copy(jr).cross(ig);break;case"y":jr.set(0,1,0).applyQuaternion(a),ig.copy(zd).cross(jr),pc.copy(jr).cross(ig);break;case"z":jr.set(0,0,1).applyQuaternion(a),ig.copy(zd).cross(jr),pc.copy(jr).cross(ig);break;case"xy":pc.set(0,0,1).applyQuaternion(a);break;case"yz":pc.set(1,0,0).applyQuaternion(a);break;case"xz":pc.set(0,1,0).applyQuaternion(a);break;case"adaptive":zd.angleTo(Ln.set(0,1,0))>Math.PI/6?(jr.crossVectors(Ln.set(0,1,0),zd),pc.crossVectors(jr,Ln)):pc.set(0,1,0);break;default:pc.copy(zd);break}ff.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:ff;if(Sq.setFromNormalAndCoplanarPoint(pc,o),!!s.ray.intersectPlane(Sq,t)&&(r==="x"||r==="y"||r==="z")){let l=Ln.subVectors(t,o).dot(jr);t.copy(o).addScaledVector(jr,l)}}updateDragItem(e,t=!1){var r,i;ff.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?Gy.subVectors(e.fromPosition,ff).divideScalar(e.currentDampingFactor):e.reset==="original"?(Gy.subVectors(e.obj.userData.worldPosition0,ff).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):Gy.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(ff).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?Gy.length()<wlt:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&Slt(e,Gy.add(ff),(r=this.activeEvent)!=null&&r.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},sg=new L,zD=new L,bu=new L,xu=new L,Cq=new co,Alt=.01,Tlt={type:"requestRender"},Mlt=function(){let e=new L,t=new L;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),Aq=function(){let e=new Ke;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof Ca&&Hu(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),Plt=class{constructor(e,t,r,i,n){this.data=e,this.object=t,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new L,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...eN.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Aa(e,e.actions,r,i,n,t)}},Ilt=class extends rc{constructor(e,t){super(e),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(Ut.length>1)){this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)};let{page:r}=this.eventContext;r.traverseEntity(i=>{var s,a;let n=(s=i.data)==null?void 0:s.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);n&&(!r.data.globalPhysics.usePhysics||((a=i.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new Plt(n.data,i,r,e.sharedAssets,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),mo&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events)if(r.target!==void 0){let i=r.target,n=this.onTargetChange(r);this.pairOfEventListeners.push([i,n]),i.addEventListener("requestRender",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),mo&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,ns(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var a;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(bu),e.isReset)xu.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(xu);else{let{getCamera:o,raycaster:l}=this.eventContext;if(r==="custom"?(o().getWorldDirection(zD),zD.negate(),sg.copy(zD)):r==="xy"?sg.set(0,0,1):r==="xz"?sg.set(0,1,0):r==="yz"&&sg.set(1,0,0),Cq.setFromNormalAndCoplanarPoint(sg,bu),!l.ray.intersectPlane(Cq,xu))return}if(!e.isReset){if(xu.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)xu.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(xu.x=bu.x),e.data.enabledTranslation[1]===!1&&(xu.y=bu.y),e.data.enabledTranslation[2]===!1&&(xu.z=bu.z);let s=Mlt(bu,xu,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=sg.subVectors(s,bu).divideScalar(e.currentDampingFactor);bu.add(o),t&&Aq(e.object,bu),e.paused=o.length()<Alt}else Aq(e.object,s),e.paused=!0;(a=e.object)==null||a.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(Tlt)}},qy=new L,FS=new L,Xy=new Ke,ag=new Xt,Bd=new Xt,Yy=new L,Ky=new L,pf=new L,wu=new L,BD=new co,Rlt=1e-6,Dlt={type:"requestRender"},Olt={type:"changeRotation"},Tq=function(){let e=new Ke;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply(tce(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof Ca&&Hu(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),Llt=class{constructor(e,t,r){this.object=t,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Xt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...tN.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=r.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},Nlt=class extends rc{constructor(e){super(e),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=r=>{if(!(Ut.length>1)){this._lastMouseEvent=r,this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onScroll=r=>{if(this._lastMouseEvent){let i=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(i)}},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)},this.createUserEventListener=r=>({eventName:i,target:n})=>{if(!i||!n)return;let s=Mw(i);s&&s==="LookAt"&&this.updateSingleEvent(r)};let{page:t}=this.eventContext;t.traverseEntity(r=>{var n,s;let i=(n=r.data)==null?void 0:n.events.find(a=>a.data.type==="LookAt"&&!a.data.disabled);i&&(!t.data.globalPhysics.usePhysics||((s=r.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new Llt(i.data,r,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),mo&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?t.addEventListener("scroll",this.onScroll):(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let r of this.events){if(r.target!==void 0){let s=this.onTargetChange(r),a=r.target;this.pairOfEventListeners.push([a,s]),a.addEventListener("requestRender",s)}let i=this.createUserEventListener(r),n=r.object;this.pairOfUserEventListeners.push([n,i]),n.addEventListener("userEvent",i)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),mo&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var h;let{tilt:t,axis:r,distance:i,plane:n,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:d,target:u}=e;if(d.getWorldPosition(Yy),!e.isReset)if(e.target)e.target.getWorldPosition(Ky);else{if(n==="custom"?(l().getWorldDirection(FS),FS.negate(),BD.setFromNormalAndCoplanarPoint(FS,Yy)):(n==="xy"?qy.set(0,0,1):n==="xz"?qy.set(0,1,0):n==="yz"&&qy.set(1,0,0),BD.setFromNormalAndCoplanarPoint(qy,Yy)),!c.ray.intersectPlane(BD,Ky))return;i>0&&(n==="custom"||n===void 0)&&Ky.addScaledVector(FS,i)}if(e.isReset||(u?t==="target"?pf.copy(u.up).applyMatrix4(Xy.extractRotation(u.matrixWorld)).normalize():a.some(f=>f===!1)?(r==="x"?(wu.set(0,0,1),a[2]===!1&&wu.set(0,1,0)):r==="y"?(wu.set(1,0,0),a[0]===!1&&wu.set(0,0,1)):(wu.set(0,1,0),a[1]===!1&&wu.set(1,0,0)),pf.copy(wu).applyQuaternion(e.worldQuaternion0).normalize()):pf.set(0,1,0):n==="custom"?pf.set(0,1,0):pf.copy(qy)),e.isReset)Bd.copy(e.worldQuaternion0);else if(Yy.distanceTo(Ky)>s&&o&&u)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Bd.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;klt(Xy,Ky,Yy,pf,r,wu),Bd.setFromRotationMatrix(Xy),ag.setFromUnitVectors(wu.applyQuaternion(Bd),pf),a.some(f=>f===!1)&&t!=="target"&&Bd.premultiply(ag).normalize()}e.currentDampingFactor>1?(d.updateWorldMatrix(!0,!1),ag.setFromRotationMatrix(tce(d.matrixWorld)),ag.slerp(Bd,1/e.currentDampingFactor),Tq(d,Xy.makeRotationFromQuaternion(ag)),e.paused=8*(1-ag.dot(Bd))<Rlt):(Tq(d,Xy.makeRotationFromQuaternion(Bd)),e.paused=!0),(h=e.object)==null||h.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),d.dispatchEvent(Dlt),d.dispatchEvent(Olt)}},jo=new L,On=new L,rn=new L;function klt(e,t,r,i,n,s){let a=e.elements;rn.subVectors(t,r),rn.lengthSq()===0&&(rn.z=1),rn.normalize(),On.crossVectors(i,rn),On.lengthSq()===0&&(Math.abs(i.z)===1?rn.x+=1e-4:rn.z+=1e-4,rn.normalize(),On.crossVectors(i,rn)),On.normalize(),jo.crossVectors(rn,On),n==="x"?s.z===1?[On,jo,rn]=[rn,On,jo]:(On.negate(),[On,rn]=[rn,On]):n==="y"?s.x===1?[On,jo,rn]=[jo,rn,On]:(On.negate(),[jo,rn]=[rn,jo]):s.x===1&&(On.negate(),[On,jo]=[jo,On]),a[0]=On.x,a[4]=jo.x,a[8]=rn.x,a[1]=On.y,a[5]=jo.y,a[9]=rn.y,a[2]=On.z,a[6]=jo.z,a[10]=rn.z}var zlt=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=Aa(t,t.actions,i,n,s,r)}disconnect(){ns(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch())}},Blt=class extends rc{constructor(e,t){super(e),this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=s=>{Ut.length>1||(this.eventContext.updateRaycaster(s),this.handleMouseHoverEvent())},this.onMouseUp=s=>{Ut.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=s=>{Ut.length>1||(this.eventContext.updateRaycaster(s),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:s,target:a,reverse:o})=>{var c;if(!s||!a)return;let l=Mw(s);l&&l==="MouseHover"&&(a.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(c=this.eventsPerObjects[a.uuid])==null||c.forEach(d=>d.dispatchUserEvent(o)))};let{page:r,sharedAssets:i}=this.eventContext,n=(s,a)=>{var o,l;if(!(!s.visible||!((o=s.data)!=null&&o.events.length))){for(let{id:c,data:d}of s.data.events)if(!d.disabled&&d.type==="MouseHover")try{let u=new zlt(c,d,s,r,i,t);this.eventsPerObjects[s.uuid]?this.eventsPerObjects[s.uuid].push(u):this.eventsPerObjects[s.uuid]=[u]}catch{}(l=this.eventsPerObjects[s.uuid])!=null&&l.length&&this.objects.push(s instanceof Un?a:s)}};r.traverseEntity(s=>{var a;(s instanceof qs||s instanceof Jn)&&((a=s.frame)==null||a.traverse(o=>{n(o,s)})),n(s)})}connect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),mo&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(t=>{t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),mo&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n,pointerScreen:s}=this.eventContext,a=!1;if(n.uiCanvas&&(a=Du(n,[s.x,s.y],Object.keys(this.eventsPerObjects),o=>{t.push(o)})),r&&!a){let o=NE(i,n,this.objects);t=Ek(o),o.forEach(l=>{var c,d;l.object instanceof qs&&Du(l.object,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((d=l==null?void 0:l.uv)==null?void 0:d.y)??0],Object.keys(this.eventsPerObjects),u=>{t.push(u)})})}else this.objects.forEach(o=>{var c,d;let l=fT(i,o);l&&(t.push(o),o instanceof qs&&Du(o,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((d=l==null?void 0:l.uv)==null?void 0:d.y)??0],Object.keys(this.eventsPerObjects),u=>{t.push(u)}))})}this._prevObjects.length&&this._prevObjects.forEach(r=>{var i;t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(r=>{var i;r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},Flt=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=Aa(t,t.actions,i,n,s,r)}connect(){this.scrollCounter=0}disconnect(){ns(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled()),this.actions.SetVariable.forEach(i=>i.checkConditions()),this.actions.SetVariable.forEach(i=>i.dispatch()),this.actions.DynamicVariablePlay.forEach(i=>i.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch())}},jlt=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.object=r,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=Aa(t,t.actions,i,n,a,r)}computeScrollBounds(){let e=this.domElement.getBoundingClientRect(),t=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||t.scrollTop,n=r.clientTop||t.clientTop||0,s=Math.round(e.top+i-n);if(this.data.startFrom==="enter"){let a=window.innerHeight,o=e.height,l=this.data.enterAnchor,c=l==="top"?a:l==="bottom"?a-o:a-o*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=e,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){ns(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch())}},Vlt=class extends rc{constructor(e,t){super(e),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([o,l])=>{l.forEach(c=>c.handleResize())})},this.onScroll=o=>{if(!this.isInview)return;let l={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([c,d])=>{c.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:l}),d.forEach(u=>u.dispatch(l))})},this.onWheel=o=>{!this.isInview||o.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:o.deltaY}),c.forEach(d=>d.dispatch(o.deltaY))})},this.onUserEvent=({eventName:o,target:l,reverse:c})=>{var u;if(!o||!l)return;let d=Mw(o);d&&d==="Scroll"&&(l.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(u=this.wheelEventsPerObject.get(l))==null||u.forEach(h=>{h.dispatchUserEvent(c)}))};let{page:r,sharedAssets:i,domElement:n,isExport:s}=this.eventContext,a=o=>{var l,c,d;if((l=o.data)!=null&&l.events.length){for(let{id:u,data:h}of o.data.events)if(!h.disabled&&h.type==="Scroll")if(h.trigger==="load"||!s){let f=new Flt(u,h,o,r,i,t);this.wheelEventsPerObject.has(o)?(c=this.wheelEventsPerObject.get(o))==null||c.push(f):this.wheelEventsPerObject.set(o,[f])}else{let f=new jlt(u,h,o,r,i,n,t);this.scrollEventsPerObject.has(o)?(d=this.scrollEventsPerObject.get(o))==null||d.push(f):this.scrollEventsPerObject.set(o,[f])}}};r.traverseEntity(o=>{var l;(o instanceof qs||o instanceof Jn)&&((l=o.frame)==null||l.traverse(c=>{a(c)})),a(o)}),this.intersectionObserver=new IntersectionObserver(o=>{let l=o[0];l&&(this.isInview=l.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},Ult=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=Aa(t,t.actions,i,n,s,r)}disconnect(){ns(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof Kf?t.interaction.audioPlayer.play():t.interaction instanceof vk&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof wv?t.interaction.play(r==="autoplay"):t.interaction instanceof _k&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof Kf?t.interaction.audioPlayer.play():t.interaction instanceof vk&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof wv?t.interaction.play():t.interaction instanceof _k&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},$lt=class extends rc{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext;(i?document:r).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(a=>{a.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof Kf&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof wv&&s.interaction.play(a==="autoplay")}),n.actions.Particles.forEach(s=>{s.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var a,o;if(!r||!i)return;let s=Mw(r);s&&s==="Start"&&(i instanceof Un||i.dispatchEvent({type:"beginEvent",eventName:"Start"}),(a=this.eventsPerObject.get(i))==null||a.forEach(l=>{l.dispatchUserEvent(n)}),(o=this.eventsAfterPerObject.get(i))==null||o.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,r=i=>{var n,s,a,o,l;if((n=i.data)!=null&&n.events.length)for(let{id:c,data:d}of i.data.events){if(d.disabled||d.type!=="Start")continue;let u=new Ult(c,d,i,t,e,this.eventManager);(u.actions.Transition.length||u.actions.Animation.length||u.actions.SwitchCamera.length||u.actions.Create.length||u.actions.Destroy.length||u.actions.SceneTransition.length||u.actions.Reset.length||u.actions.SetVariable.length||u.actions.DynamicVariablePlay.length)&&(this.eventsPerObject.has(i)?(s=this.eventsPerObject.get(i))==null||s.push(u):this.eventsPerObject.set(i,[u])),u.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(a=this.eventsAfterPerObject.get(i))==null||a.push(u):this.eventsAfterPerObject.set(i,[u])),u.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(o=this.eventsAfterPerObject.get(i))==null||o.push(u):this.eventsAfterPerObject.set(i,[u])),u.actions.Particles.length&&(this.eventsAfterPerObject.has(i)?(l=this.eventsAfterPerObject.get(i))==null||l.push(u):this.eventsAfterPerObject.set(i,[u]))}};if(t.traverseEntity(i=>{var n;(i instanceof qs||i instanceof Jn)&&((n=i.frame)==null||n.traverse(s=>{r(s)})),r(i)}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,s=n?document:i;s.addEventListener("pointerdown",this.onMouseDown,{once:!0}),s.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),s.addEventListener("pointerdown",this.onAny),s.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,o])=>{a.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(s=>s.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},Hlt=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.disabled=!1,this.alreadyPlayedNonTogglingActions=new Set,this.actions=Aa(t,t.actions,i,n,s,r),this.target=t.target,this.useToggle=t.runMode==="Toggle"}disconnect(){ns(this.actions)}dispatch(e){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this?(t.object.currentTransitionEvent=this,t.init()):this.data.runMode==="Once"&&this.alreadyPlayedNonTogglingActions.add(t)}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{this.alreadyPlayedNonTogglingActions.has(t)===!1&&t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}))}},Wlt=class extends rc{constructor(e,t,r,i,n){super(e),this.sharedVariables=t,this.eventManager=r,this.needsMouse=i,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.events=[],this.onFrame=s=>{this.rafId=window.requestAnimationFrame(this.onFrame);let a=new Date,o=[],l=[];for(let u=0;u<this.propertiesToWatch.length;u++){let{objectId:h,property:f,prevValue:p}=this.propertiesToWatch[u],m=this.eventContext.scene.find(h),g=iN.propertyPaths[f];if(g[0]==="width"||g[0]==="height"||g[0]==="depth")m=m.geometry.userData.parameters[g[0]];else for(let v=0;v<g.length;v++)m=m[g[v]];p===null?this.propertiesToWatch[u].prevValue=m instanceof L?m.clone():m:(m instanceof L?!m.equals(p):p!==m)&&(l.push({objId:h,property:f}),m instanceof L?this.propertiesToWatch[u].prevValue.copy(m):this.propertiesToWatch[u].prevValue=m)}for(let u=0;u<this.variablesToWatch.length;u++){let{id:h,prevValue:f}=this.variablesToWatch[u],p=this.shared.getVariable(h);p!==f&&(o.push(h),this.variablesToWatch[u].prevValue=p)}for(let u=0;u<this.dynamicVars.length;u++){let{id:h,expectedTime:f,last:p,data:m,timerSeconds:g,startValue:v}=this.dynamicVars[u],y=1e3;if((m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&m.format==="number3decimal"?y=1:m.dynamicVariableType==="counter"?y=m.updateInterval:m.dynamicVariableType==="random"&&(y=m.isStatic?1/0:m.updateInterval),f===-1){this.dynamicVars[u].last=s,this.dynamicVars[u].expectedTime=s+y;continue}if(!((this.shared.getDynamicVariablePlayState(h)==="Stopped"||this.shared.getDynamicVariablePlayState(h)==="Restarted")&&(this.dynamicVars[u].last=s,this.dynamicVars[u].expectedTime=s+y,m.dynamicVariableType==="counter"&&this.shared.getVariable(h)!==v&&(this.shared.updateVariable(h,v),this.eventManager.requestRender()),(m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&this.dynamicVars[u].timerSeconds!==v&&(this.dynamicVars[u].timerSeconds=v,this.shared.updateVariable(h,Ho.getFormattedTimerTime(v,m)),this.eventManager.requestRender()),this.shared.getDynamicVariablePlayState(h)==="Restarted"&&this.shared.setDynamicVariablePlayState(h,"Playing"),this.shared.getDynamicVariablePlayState(h)==="Stopped"))){if(this.shared.getDynamicVariablePlayState(h)==="Paused"){this.dynamicVars[u].deltaToExpectedTime===void 0&&(this.dynamicVars[u].deltaToExpectedTime=Math.max(this.dynamicVars[u].expectedTime-s,0)),this.dynamicVars[u].last=s-(y-this.dynamicVars[u].deltaToExpectedTime),this.dynamicVars[u].expectedTime=s+this.dynamicVars[u].deltaToExpectedTime;continue}else this.dynamicVars[u].deltaToExpectedTime=void 0;if(s>=f)if(this.dynamicVars[u].last=s,this.dynamicVars[u].expectedTime+=y,m.dynamicVariableType==="random"){let b=m.min+Math.random()*(m.max-m.min),x=m.decimals;b=Math.round(b*Math.pow(10,x))/Math.pow(10,x),this.shared.updateVariable(h,b),o.push(h),this.eventManager.requestRender()}else if(m.dynamicVariableType==="counter"){if(m.increment===0)continue;let b=this.shared.getVariable(h),x=this.shared.getDynamicVariableToggleIsForward(h)??!0,S=this.shared.getVariable(h)+m.increment*(x?1:-1);m.hasEnd&&(S=m.increment>0?Et.clamp(S,v,m.endValue):Et.clamp(S,m.endValue,v),S===v&&this.shared.setDynamicVariableToggleIsForward(h,void 0),m.repeat?S===m.endValue&&(S=v):(S===v||S===m.endValue)&&this.shared.setDynamicVariablePlayState(h,"Paused")),S!==b&&(o.push(h),this.shared.updateVariable(h,S),this.eventManager.requestRender())}else if(m.dynamicVariableType==="time")this.shared.updateVariable(h,H9(a,m)),o.push(h),this.eventManager.requestRender();else{let b=go.isTextValue(m.endValue)?Mq(m.endValue.textValue):m.endValue,x=this.shared.getDynamicVariableToggleIsForward(h)??!0,S=g+(s-p)/1e3*(m.dynamicVariableType==="timer"?-1:1)*(x?1:-1);S=Math.max(S,0),m.hasEnd&&(S=m.dynamicVariableType==="stopwatch"?Et.clamp(S,v,b):Et.clamp(S,b,v),S===v&&this.shared.setDynamicVariableToggleIsForward(h,void 0),m.repeat?Math.abs(S-b)<(m.format==="number3decimal"?1e-4:.1)&&(S=v):(Math.abs(S-v)<(m.format==="number3decimal"?1e-4:.1)||Math.abs(S-b)<(m.format==="number3decimal"?1e-4:.1))&&this.shared.setDynamicVariablePlayState(h,"Paused")),S!==g&&(o.push(h),this.dynamicVars[u].timerSeconds=S,this.shared.updateVariable(h,Ho.getFormattedTimerTime(S,m)),this.eventManager.requestRender())}}}this.needsMouse&&this.shared.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=this.shared.mouseProperty,this.events.forEach(u=>{u.data.variableId==="mouseProperty"&&(u.dispatch(),this.eventManager.requestRender())}));let c=!1;this.shared.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=this.shared.mouseProperty,c=!0);let d=!1;this.shared.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=this.shared.raycastProperty,d=!0),this.events.forEach(u=>{(o.includes(u.data.variableId)||l.find(h=>h.objId===u.data.objectId&&h.property===u.data.property)||u.data.variableId==="mouseProperty"&&c||u.data.variableId==="raycastProperty"&&d)&&(u.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()},e.page.traverseEntity(s=>{var a;(a=s.data)==null||a.events.filter(o=>o.data.type==="VariableChange"&&!o.data.disabled).forEach(o=>{this.events.push(new Glt(s.uuid,o.data,s,e.page,e.sharedAssets,r))})}),this.propertiesToWatch=this.events.filter(s=>s.data.variableId==="objectProperty"&&s.data.objectId!==null).map(s=>({objectId:s.data.objectId,property:s.data.property,prevValue:null})),this.shared=e.sharedAssets,this.sharedVariables.forEach(({id:s,data:a})=>{if(!("dynamicVariableType"in a)){this.events.find(l=>l.data.variableId===s)&&this.variablesToWatch.push({id:s,prevValue:this.shared.getVariable(s)});return}let o;if(a.dynamicVariableType==="timer"||a.dynamicVariableType==="stopwatch"){let l;if(go.isTextValue(a.value)&&Array.isArray(a.value.textValue)){let c=a.value.textValue;c.length===3?l=c[2]+c[1]*60+c[0]*3600:l=c[1]+c[0]*60}else l=a.value;o=l,this.dynamicVars.push({id:s,last:-1,expectedTime:-1,data:a,timerSeconds:l,startValue:o})}else a.dynamicVariableType==="time"&&this.shared.updateVariable(s,H9(new Date,a)),a.dynamicVariableType==="counter"&&(o=go.isTextValue(a.value)?Mq(a.value.textValue):a.value),this.dynamicVars.push({id:s,last:-1,expectedTime:-1,data:a,startValue:o})})}pause(){this.pauseTime=Date.now()}resume(){let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},Glt=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=Aa(t,t.actions,i,n,s,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch())}dispose(){ns(this.actions)}};function Mq(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var qlt="https://unpkg.com/@splinetool/runtime@1.0.28/build/",Xlt="https://unpkg.com/@splinetool/navmesh-wasm@1.0.28/build/",Ylt=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${qlt}' + 'navmesh.js'),
		fetch('${Xlt}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,Klt=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,Qlt=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,Zlt=.001,Jlt={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},oce,xr,hs;JKe.then(e=>{oce=e,xr=new e.Vec3,hs=new e.Vec3});var ect=new L,tct=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(Ut.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let s=n.raycastWithClones(i);if(s.length!==0){if(this.gameControl){let a=ect.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{var h,f,p,m,g,v,y;let s;if(n instanceof Ol)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof Xs)s=n.object;else if(s=n,((h=s.dataPatched.cloner)==null?void 0:h.disabled)===!1&&((f=s.dataPatched.cloner)==null?void 0:f.hideBase)&&((p=s.dataPatched.physics)==null?void 0:p.fusedBody)!==!0)return!0;if(i&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&((m=a.physics)==null?void 0:m.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let o=pT(a),l=s.userData.hasDestroy,c=s.userData.hasDrag,d=!1,u=!1;for(let b of a.events)b.data.disabled!==!0&&(b.data.type==="GameControl"?d=!0:b.data.type==="Follow"&&(u=!0));if(d||o||u||l||c)return!0;if(this.usePhysics&&((g=a.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((v=a.physics)!=null&&v.fusedBody))return!0}else if("geometry"in n&&n.geometry&&r.push(Ru(n.geometry,n.matrixWorld)),this.usePhysics&&((y=a.physics)==null?void 0:y.fusedBody))return n.traverseObject((b,x)=>{var E,C;if(x===0)return;let S;if(b instanceof Ol)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;S=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof Xs)S=b.object;else if(S=b,(E=b.dataPatched.cloner)==null?void 0:E.hideBase)return!0;let w=S.dataPatched;if(!w.visible&&((C=w.physics)==null?void 0:C.enabled)!==!0)return!0;"geometry"in b&&b.geometry&&r.push(Ru(b.geometry,b.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let s;if(n instanceof Ol)return;n instanceof Xs?s=n.object:s=n;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(i&&!s.userData.navmesh)return;let o=n.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(pT(a)||l||c||s.dataPatched.events.some(d=>d.data.disabled!==!0&&d.data.type==="GameControl"))return!0;o&&r.push(Ru(o,n.matrixWorld))},this.navmeshWasm=oce,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?Ylt:Klt)+Qlt])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.resolution=e.ch,this.setDefaultQueryExtent(new L().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{var d;let c=e.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=!0}),(d=c.cloner)==null||d.traverseObject(u=>{u.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var d;let c=e.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=void 0}),(d=c.cloner)==null||d.traverseObject(u=>{u.userData.navmesh=void 0})}),i.length===0)return!1;let s=Yf(i),{positions:a,triIndices:o}=YM(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...Jlt,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),s=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let o=r.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new Dt;return a.setIndex(new Wt(n,1)),a.setAttribute("position",new Wt(s,3)),a}getClosestPoint(e){return xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.getClosestPoint(xr)}getClosestPointToRef(e,t){xr.x=e.x,xr.y=e.y,xr.z=e.z;let r=this.navMesh.getClosestPoint(xr);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.getRandomPointAround(xr,t)}getRandomPointAroundToRef(e,t,r){xr.x=e.x,xr.y=e.y,xr.z=e.z;let i=this.navMesh.getRandomPointAround(xr,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return xr.x=e.x,xr.y=e.y,xr.z=e.z,hs.x=t.x,hs.y=t.y,hs.z=t.z,this.navMesh.moveAlong(xr,hs)}moveAlongToRef(e,t,r){return xr.x=e.x,xr.y=e.y,xr.z=e.z,hs.x=t.x,hs.y=t.y,hs.z=t.z,this.navMesh.moveAlong(xr,hs)}computePath(e,t){let r=this.getClosestPoint(t);hs.x=r.x,hs.y=r.y,hs.z=r.z,this.getClosestPoint(e);let i=this.navMesh.computePath(xr,hs),n=i.getPointCount(),s=[];for(let a=0;a<n;a++){let o=i.getPoint(a);s.push(new L(o.x,o.y,o.z))}return s}createCrowd(e,t){return new rct(this,e,t)}setDefaultQueryExtent(e){xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.setDefaultQueryExtent(xr)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return xr.x=e.x,xr.y=e.y,xr.z=e.z,this.navMesh.addCylinderObstacle(xr,t,r)}addBoxObstacle(e,t,r){return xr.x=e.x,xr.y=e.y,xr.z=e.z,hs.x=t.x,hs.y=t.y,hs.z=t.z,this.navMesh.addBoxObstacle(xr,hs,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},rct=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new L(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=Zlt)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let s=0;s<i;s++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],s=this.getAgentPosition(n);if(this.transforms[i].copy(s),this._agentDestinationArmed[i]){let a=s.x-this._agentDestination[i].x,o=s.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],d=this._agentDestination[i].y+this.reachRadii[i],u=a*a+o*o;s.y>c&&s.y<d&&u<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let s=r.getPoint(t);n.push(new L(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function ict(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&mx.traverseModuleInstances(e,r.id,(i,n,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var nct={type:"change"},Pq={type:"changeZoom"},sct={type:"changePan"},og={type:"start"},lg={type:"end",changed:!0},act={type:"end",changed:!1},FD=new Xt,Iq=new oe,oct=2*Math.PI,lct=1e-8,cct=.01,jD=new L,jS=new oe,VD=new L,VS=new Xt,Rq=new Ke,uct={type:"requestRender"},lce=class extends Ls{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Lo.DOLLY_ROTATE,Lo.PAN],this.offset=new L,this.eye=new L,this.lastPosition=new L,this.lastQuaternion=new Xt,this.current=new oe,this.overShoot=new oe,this.overRatio=new oe,this.spherical=new p8,this.sphericalDelta=new p8,this.panOffset=new L,this.panLeftV=new L,this.panUpV=new L,this.panV=new L,this.rotateStart=new oe,this.rotateEnd=new oe,this.rotateDelta=new oe,this.panStart=new oe,this.panEnd=new oe,this.panDelta=new oe,this.dollyStart=new oe,this.dollyEnd=new oe,this.dollyDelta=new oe,this.rotationRangeFactor=new oe,this.panRangeFactor=new oe,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(VD,VS,jD),this.offset.copy(VD).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(FD.copy(VS).invert()),this.panOffset.applyQuaternion(FD),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(VS),this.panOffset.applyQuaternion(VS)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),VD.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(Rq.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(Rq));let i=this.spherical.phi%oct;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Yr.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>cct||8*(1-this.lastQuaternion.dot(this.object.quaternion))>lct?(this.dispatchEvent(nct),this.object.dispatchEvent(uct),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&mo?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(og),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&mo||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,jD.subVectors(this.position0,this.target0),this.spherical.setFromVector3(jD),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?jS.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):jS.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(jS).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(Iq,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(jS).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&mo?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,Ut.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Ut.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(lg):this.dispatchEvent(act),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&mo||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!J_(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(J_(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(J_(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(Ut.length>1&&i.preventDefault(),this.touches[Ut.length-1]){case Lo.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Lo.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Lo.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Lo.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(Ut.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=Z4(()=>this.dispatchEvent(lg),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(og),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!J4)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(og),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(lg)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(og))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(Ut[0]),i.key===" "&&this.dispatchEvent(lg))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(FD.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=mc(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=mc(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=mc(mc(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=mc(mc(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Lo.ROTATE),e.panTouches===1&&(this.touches[0]=Lo.PAN),e.orbitTouches===2&&(this.touches[1]=Lo.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Lo.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Lo.ROTATE),e.panTouches===3&&(this.touches[2]=Lo.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,s,a,o){this.overShoot.set(0,0);let l,c,d;e instanceof L?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),d=!0):(l=e.theta,c=e.phi,this.current.set(mc(this.spherical.theta),mc(this.spherical.phi)),d=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!d&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),d||(this.overShoot.x=mc(this.overShoot.x),this.overShoot.y=mc(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=Dq(Math.abs(this.overRatio.x)),this.overRatio.y=Dq(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!d&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||d&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),d?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):d?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof L?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(sct)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(Pq)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(Pq)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(og),this.dollyOut(e),this.dispatchEvent(lg)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(og),this.dollyIn(e),this.dispatchEvent(lg)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(Iq,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(XKe===!1&&J_(e)===!1&&YKe(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Ut.length===2){let e=.5*(Ut[0].pageX+Ut[1].pageX),t=.5*(Ut[0].pageY+Ut[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(Ut[0].pageX,Ut[0].pageY)}handleTouchStartPan(){if(Ut.length===2){let e=.5*(Ut[0].pageX+Ut[1].pageX),t=.5*(Ut[0].pageY+Ut[1].pageY);this.panStart.set(e,t)}else this.panStart.set(Ut[0].pageX,Ut[0].pageY)}handleTouchStartDolly(){let e=Ut[0].pageX-Ut[1].pageX,t=Ut[0].pageY-Ut[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(Ut.length===2){let r=RR(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==Ut[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(Ut.length===2){let t=RR(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==Ut[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=RR(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function mc(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function Dq(e){return 1-Math.pow(1-e,4)}var Oq=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.page=i,this.currentIntersectedObjects=[],this.disabled=!1,this.alreadyPlayedNonTogglingActions=new Set,this.actions=Aa(t,t.actions,i,n,s,r),this.target=t.target,this.useToggle=t.runMode==="Toggle",this.triggeringObjects=t.triggeringObjects.map(a=>i.scene.find(a))}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){ns(this.actions)}dispatch(){this.disabled||this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this?(e.object.currentTransitionEvent=this,e.init()):this.data.runMode==="Once"&&this.alreadyPlayedNonTogglingActions.add(e)}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{this.alreadyPlayedNonTogglingActions.has(e)===!1&&e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()))}},Mr;tQe.then(e=>Mr=e);var gn=new L,yl=new Xt,Fd=new L,UD=new kn(0,0,0,"YXZ"),Lq=new kn(0,0,0,"XYZ"),bl=new L,$D=new L,HD=new L(1,1,1),cg=new Xt,US=new Ke,Nq=new Ke,dct={type:"updateMatrix"},kq=new Xt,WD=new Za,Ck={type:"beginEvent",eventName:"Collision"},hct={type:"beginEvent",eventName:"Trigger"};function fct(e){if(mx.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){if(Array.isArray(i.events)){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var pT=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),pct=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==Mr.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(gn.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),yl.copy(t.rotation()),r.matrixWorld.compose(gn,yl,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(dct),n){let s=r.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(r.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of r.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{var a,o,l,c;if(i===!1)return;let n,s;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let d=this.sharedGameControlGlobals.createdObjects.length-1;d>=0;d--){let u=this.sharedGameControlGlobals.createdObjects[d];if(u.userData.hasCollisionDestroy&&(((a=u.rigidBody)==null?void 0:a.collider(0).handle)===t||((o=u.rigidBody)==null?void 0:o.collider(0).handle)===r)){this.sharedGameControlGlobals.createdObjects.splice(d,1),u.removeFromParent(),requestAnimationFrame(()=>{var h;return(h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.removeRigidBody(u.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(t)){let d=this.sharedGameControlGlobals.colliderToEntity.get(r),u=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(u===void 0)return;for(let h of u)h.data.target==="character"&&this.dispatchCollisionEvent(h,d,r)}else if(((c=this.gameControl)==null?void 0:c.object)===this.sharedGameControlGlobals.colliderToEntity.get(r)){let d=this.sharedGameControlGlobals.colliderToEntity.get(t),u=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(u===void 0)return;for(let h of u)h.data.target==="character"&&this.dispatchCollisionEvent(h,d,t)}else{let d=this.sharedGameControlGlobals.colliderToEntity.get(t),u=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(u!==void 0)for(let p of u)p.data.target==="scene"&&this.dispatchCollisionEvent(p,d,t);let h=this.sharedGameControlGlobals.colliderToEntity.get(r),f=this.sharedGameControlGlobals.entityToCollisionEvents[h==null?void 0:h.uuid];if(f!==void 0)for(let p of f)p.data.target==="scene"&&this.dispatchCollisionEvent(p,h,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=Jle,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var r,i;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let s=(i=(r=n.data.actions)==null?void 0:r.find(a=>a.data.type==="Destroy"))==null?void 0:i.data;if(s)for(let a of s.objects){let o=this.page.scene.find(a);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var c,d;let r,i=t instanceof ZN,n=t instanceof ck;if(t instanceof Ol||i||n)return;t instanceof Xs?r=t.object:r=t;let s=r.dataPatched;if(((c=s.physics)==null?void 0:c.enabled)==="visibility"?!s.visible:!((d=s.physics)!=null&&d.enabled))return!0;let a=t.geometry,o=r.userData.hasDestroy===!0,l=r.userData.hasDrag===!0;if(pT(s)||o||l||r.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;a&&e.push(Ru(a,t.matrixWorld))}),e.length>0){let t=Yf(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new rb(t)}}addRigidBody(e,t,r){let i=[],n="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&i.push(Ru(n,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,i);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let a,o=!r.fromCreate&&s.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;o?(a=Mr.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(a=Mr.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=Mr.RigidBodyDesc.fixed();let l=Yf(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(gn,yl,Fd),e.position0=gn.clone().divideScalar(this.pixelsPerMeter),e.rotation0=yl.clone(),gn.divideScalar(this.pixelsPerMeter),a.setTranslation(gn.x,gn.y,gn.z).setRotation(yl),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Fd.x/this.pixelsPerMeter,Fd.y/this.pixelsPerMeter,Fd.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(c.handle,[e,Fd.clone(),s.physics.fusedBody]);let d=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,t,d)}catch{try{this.addCollider(c,s.physics,l,t,!1)}catch(u){console.error(u)}}e.rigidBody=c}}addBoundsTree(e){var r,i;let t=[];if(((r=e.geometry)==null?void 0:r.getAttribute("position"))!==void 0&&((i=e.geometry)==null?void 0:i.getAttribute("position").count)>0&&t.push(Ru(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(n=>n.updateMatrixWorld(!0)),t.length>0){let n=Yf(t,!1);e.bvhGeometry=n,e.bvhGeometry.boundsTree=new rb(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)}}addCollider(e,t,r,i,n=!0){var o,l;if((r==null?void 0:r.getAttribute("position").count)===0||((o=r==null?void 0:r.getIndex())==null?void 0:o.count)===0)return;let s;r&&(t.colliderType==="trimesh"?s=Mr.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):s=Mr.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),s.setFrictionCombineRule(Mr.CoefficientCombineRule.Average).setRestitutionCombineRule(Mr.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,i),(l=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])!=null&&l.some(c=>c.target==="scene")&&a.setActiveEvents(Mr.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{var o;if(i===0)return;let n;if(r instanceof Ol)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof Xs)n=r.object;else if(n=r,(o=n.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let a=r.geometry;(a==null?void 0:a.getAttribute("position"))!==void 0&&t.push(Ru(a,r.matrixWorld))}}activate(e){var h,f;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,c=null;if(l)for(let p of l.data.events){if(p.data.disabled||p.data.type!=="GameControl")break;let m=l;for(;this.usePhysics&&((h=m=m.parent)==null?void 0:h.parent)!==null&&!((f=m.data.physics)!=null&&f.fusedBody););p.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=p.data)}if(this.page.traverseEntity(p=>{for(let m of p.dataPatched.events)if(m.data.disabled===!1&&m.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&c){r=r||c.camera===t.uuid||l.uuid===t.uuid;let p=new ece(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=p,i=c.joystickPosLoc,n=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,mo&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let p=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new tct(this.usePhysics,this.isExport);let m;p.collider.type==="sphere"?m=p.collider.radius*2:m=p.collider.height,m=Math.floor(m/p.navmesh.ch-1),this.navigationMeshWrapper.init({...p.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:p,enablePan:m,enableZoom:g,autoRotate:v,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(p||m||g||v||y!==0)&&(this.orbitControls=new lce(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let d=this.renderer.domElement.width/this.renderer.getPixelRatio(),u=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((p,m)=>{let g=document.body.appendChild(document.createElement("div")),[v,y,b]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],x=(d-5*v)/4+v,S={},w=p==="jmp",E=w?0:v;m<10?(m<5?S.top=E/2:S.bottom=E/2,S.left=E/2+m%5*x):m===10?(S.left=E/2,S.top=u/2):(S.right=E/2,S.top=u/2),S.top?S.top-=y[1]:S.bottom+=y[1],S.left?S.left+=y[0]:S.right-=y[0];for(let A in S)S[A]+="px";if(w){let A=g.appendChild(document.createElement("div"));Object.assign(A.style,S,{position:"absolute",width:v+"px",height:v+"px",backgroundColor:`rgba(255,255,255,${b==="show"?.4:0})`,zIndex:"9999",borderRadius:v+"px",border:b==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let M=v/16*16*.4;b==="show"&&(A.innerHTML=`
						<svg width="${M}" height="${v*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),A.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),A.addEventListener("touchend",P=>P.preventDefault()),this.joysticks[m]=[void 0,g];return}let C={zone:g,mode:"static",position:S,size:v};b==="hide"&&(C.restOpacity=0);let T=Aat.create(C);T.on("move",(A,M)=>{let P=this.gameControl;p==="pos"?M.force<.2?P.moveForce=0:(P.movementState.movePosZ=Math.sin(-M.angle.radian),P.movementState.movePosX=Math.cos(-M.angle.radian),M.force>1.2?P.movementState.run=1:P.movementState.run=0,M.force<.3?P.moveForce=(M.force-.2)/.1:P.moveForce=1):p==="rot"&&(M.force<.2?P.rotForce=0:(P.movementState.rotPosX=M.vector.y,P.movementState.rotPosY=-M.vector.x,M.force<.3?P.rotForce=(M.force-.2)/.1:P.rotForce=1)),this.requestRender()}),T.on("end",(A,M)=>{let P=this.gameControl;p==="pos"?(P.movementState.movePosZ=0,P.movementState.movePosX=0,P.moveForce=1):p==="rot"&&(P.movementState.rotPosX=0,P.movementState.rotPosY=0,P.rotForce=1)}),this.joysticks[m]=[T,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(p=>p.disabled=!1)},80)}initPhysics(){var a;(a=this.sharedGameControlGlobals.rapierWorld)==null||a.free(),this.sharedGameControlGlobals.rapierWorld=new Mr.World(new Mr.Vector3(0,this.gravity,0)),this.events=new Mr.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var v,y,b,x;let l;if(o instanceof Ol)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof Xs)l=o.object;else{if(o instanceof ck||o instanceof ZN)return;if(l=o,((v=l.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((b=l.dataPatched.physics)==null?void 0:b.fusedBody)!==!0)return!0}let c=l.dataPatched,d;for(let S of c.events)S.data.disabled!==!0&&S.data.type==="GameControl"&&(d=S.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;o.updateMatrixWorldSVD();let u=pT(c),h=!1,f=l.userData.hasDestroy,p=l.userData.hasDrag,m=!1;for(let S of c.events)if(S.data.disabled!==!0){if(S.data.type==="Collision"){h=!0;let w=new Hlt(S.id,S.data,l,this.page,this.sharedAssets,this.eventManager);w.disabled=!0,this.collisionEvents.push(w),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(E=>E.id!==S.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(w):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[w]}else if(S.data.type==="Follow"){m=!0;let w=S.data.target;o.traverseVisible(E=>{E.userData.isFollowingObj=w})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let g=o.geometry;if(d!==void 0){let S=Mr.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(gn,yl,Fd),o.position0=gn.clone().divideScalar(this.pixelsPerMeter),o.rotation0=yl.clone(),gn.divideScalar(this.pixelsPerMeter),S.setTranslation(gn.x,gn.y,gn.z).setRotation(yl);let w=this.sharedGameControlGlobals.rapierWorld.createRigidBody(S);o.rigidBody=w;let E;d.collider.type==="sphere"?E=Mr.ColliderDesc.ball(d.collider.radius/this.pixelsPerMeter):d.collider.type==="capsule"?E=Mr.ColliderDesc.capsule((d.collider.height/2-d.collider.radius)/this.pixelsPerMeter,d.collider.radius/this.pixelsPerMeter):E=Mr.ColliderDesc.cuboid(d.collider.width/this.pixelsPerMeter/2,d.collider.height/this.pixelsPerMeter/2,d.collider.depth/this.pixelsPerMeter/2),E.setFrictionCombineRule(Mr.CoefficientCombineRule.Average).setRestitutionCombineRule(Mr.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let C=this.sharedGameControlGlobals.rapierWorld.createCollider(E,w);this.sharedGameControlGlobals.colliderToEntity.set(C.handle,l),gn.fromArray(d.collider.position).multiply(Fd.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),C.setTranslationWrtParent(gn);let T=new Xt().setFromEuler(new kn().setFromVector3(new L().fromArray(d.collider.rotation)));C.setRotationWrtParent(T),C.setActiveEvents(Mr.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||u||m||f||p||h?(this.addRigidBody(o,l,{hasFollow:m,hasTransformAnim:u,hasDrag:p}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(g&&e.push(Ru(g,o.matrixWorld)),c.physics.fusedBody&&o.traverseObject((S,w)=>{var A;if(w===0)return;let E;if(S instanceof Ol)if(S.objectForSample){if(S.objectForSample.dataPatched.physics.fusedBody)return;E=S.object}else return S.object.dataPatched.physics.fusedBody===!0&&S.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(S instanceof Xs)E=S.object;else if(E=S,(A=E.dataPatched.cloner)==null?void 0:A.hideBase)return!0;let C=E.dataPatched;if(C.physics.enabled==="visibility"?!C.visible:!C.physics.enabled)return!0;let T=S.geometry;(T==null?void 0:T.getAttribute("position"))!==void 0&&e.push(Ru(T,S.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((x=c.physics)==null?void 0:x.fusedBody)===!0||d)return!0}),e.length===0)return;let r=Yf(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=Mr.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),s=Mr.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(Mr.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Mr.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[o,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(o,n);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new Oq(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new Ke().compose(bl.fromArray(t.data.position),cg.setFromEuler(Lq.fromArray(t.data.rotation)),HD);if(t.data.triggerZone==="box"){let n=new un;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,r,i;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let s=n;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(r=this.gameControl)==null||r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,s])=>{n==null||n.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(i=this.navigationMeshWrapper)==null||i.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let s=e/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=n&&o<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,o++,!(performance.now()-a>n*1e3)););this.accumulator=this.accumulator%n}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(gn,yl,Fd),UD.setFromQuaternion(yl);let r=t;r.prevR===void 0?(r.prevR=UD.clone(),r.prevT=gn.clone()):(r.prevR.copy(UD),r.prevT.copy(gn)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(gn.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(yl))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var s;let i=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(r))._parent,n;if(t.cloner){for(let a of t.cloner.children)if(a.rigidBody===i){n=a;break}}e.dispatch(n),t.dispatchEvent(Ck)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=Nq.copy(e.matrixWorld).invert();e.traverseEntity((n,s)=>{if(t===!1&&s===1)return!0;for(let a of n.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new Oq(a.id,a.data,n,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=Mr.ColliderDesc.cuboid(...a.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=Mr.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(Mr.ActiveEvents.COLLISION_EVENTS),bl.fromArray(a.data.position),cg.setFromEuler(Lq.fromArray(a.data.rotation)),US.compose(bl,cg,HD).premultiply(n.matrixWorld),r?(US.decompose(bl,cg,$D),l.setActiveCollisionTypes(Mr.ActiveCollisionTypes.KINEMATIC_FIXED|Mr.ActiveCollisionTypes.DYNAMIC_FIXED)):(US.premultiply(i).decompose(bl,cg,$D),e.rigidBody.bodyType()===Mr.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===Mr.RigidBodyType.Fixed?l.setActiveCollisionTypes(Mr.ActiveCollisionTypes.KINEMATIC_FIXED|Mr.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(Mr.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Mr.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),bl.divideScalar(this.pixelsPerMeter),l.setTranslation(bl.x,bl.y,bl.z),l.setRotation(cg),r)r.push([l,o]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=o}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(n===o||s.isValidTriggeringObject(_r.is(o)?o:o.object)===!1)continue;let l=Nq.copy(n.matrixWorld).decompose(bl,kq,$D).compose(bl,kq,HD).multiply(i),c=US.copy(o.matrixWorld).invert().multiply(l);r instanceof un?e=o.bvhGeometry.boundsTree.intersectsBox(r,c):(WD.radius=r,WD.center.setFromMatrixPosition(c),e=o.bvhGeometry.boundsTree.intersectsSphere(WD)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),n.dispatchEvent(hct)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(d=>d!==o)}}}};function mct(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,s=this._loopCount,a=i===b4;if(e===0)return s===-1?n:a&&(s&1)===1?t-(n-r):n;if(i===Sne){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=t||n<r){let o=Math.floor((n-r)/(t-r));n-=(t-r)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return t-(n-r)}return n}var zq=!1,gct=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(n.identity)?o+=n.identity[0]:o+=n.uuid,this.clipIdToAction[o])return;let l=kL.parse(JSON.parse(s[2]));n.animations[a]=l;let c=this.mixer.clipAction(l,n);zq===!1&&(Object.getPrototypeOf(c)._updateTime=mct,zq=!0),c.clampWhenFinished=!0,this.clipIdToAction[o]=c})},this.mixer=new vWe(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(s=>s.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=Ene}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=b4)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var e,t;return((t=(e=this.activeClip)==null?void 0:e.tracks[0])==null?void 0:t.times.length)??0}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?e/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},GD=new WeakMap,vct=class extends bw{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new zL(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{this.decodeDracoFile(s,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(GD.has(e)){let o=GD.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(i=o,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),GD.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new Dt;e.index&&t.setIndex(new Wt(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,s=i.array,a=i.itemSize;t.setAttribute(n,new Wt(s,a))}return t}_loadLibrary(e,t){let r=new zL(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=yct.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let s=n.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function yct(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(d){e.onModuleLoaded=function(u){d({draco:u})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,c=o.taskConfig;t.then(d=>{let u=d.draco,h=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=r(u,h,f,c),m=p.attributes.map(g=>g.array.buffer);p.index&&m.push(p.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:p},m)}catch(p){console.error(p),self.postMessage({type:"error",id:o.id,error:p.message})}finally{u.destroy(f),u.destroy(h)}});break}};function r(a,o,l,c){let d=c.attributeIDs,u=c.attributeTypes,h,f,p=o.GetEncodedGeometryType(l);if(p===a.TRIANGULAR_MESH)h=new a.Mesh,f=o.DecodeBufferToMesh(l,h);else if(p===a.POINT_CLOUD)h=new a.PointCloud,f=o.DecodeBufferToPointCloud(l,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let m={index:null,attributes:[]};for(let g in d){let v=self[u[g]],y,b;if(c.useUniqueIDs)b=d[g],y=o.GetAttributeByUniqueId(h,b);else{if(b=o.GetAttributeId(h,a[d[g]]),b===-1)continue;y=o.GetAttribute(h,b)}m.attributes.push(n(a,o,h,g,v,y))}return p===a.TRIANGULAR_MESH&&(m.index=i(a,o,h)),a.destroy(h),m}function i(a,o,l){let c=l.num_faces()*3,d=c*4,u=a._malloc(d);o.GetTrianglesUInt32Array(l,d,u);let h=new Uint32Array(a.HEAPF32.buffer,u,c).slice();return a._free(u),{array:h,itemSize:1}}function n(a,o,l,c,d,u){let h=u.num_components(),f=l.num_points()*h,p=f*d.BYTES_PER_ELEMENT,m=s(a,d),g=a._malloc(p);o.GetAttributeDataArrayForAllPoints(l,u,m,p,g);let v=new d(a.HEAPF32.buffer,g,f).slice();return a._free(g),{name:c,array:v,itemSize:h}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var gh;function bct(){return gh||(gh=new vct,gh.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),gh.decoderPending}async function xct(e){if(gh){let t={attributeIDs:gh.defaultAttributeIDs,attributeTypes:gh.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await gh.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function wct(e,t){let[r,i]=aae(ZL.deserialize(new Uint8Array(e)));Rae(r);let n=[];r.scene.objects.traverse((s,a)=>{a.type==="Mesh"&&a.geometry.type==="NonParametricGeometry"&&a.geometry.data.draco!==void 0&&n.push(a)}),n.length&&await bct();for(let s of n){let a=await xct(ln(s.geometry.data.draco));if(a){a.index&&(s.geometry.data.index={array:a.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let o={};a.attributes.forEach(({name:l,array:c,itemSize:d})=>{o[l]={array:c,itemSize:d,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=o,s.geometry.data.draco=void 0}}return t&&t(r),i.result().data}var _ct=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.dataEvent=r,this.object=i,this.stage=!1,this.actions=Aa(r,t.actions,n,s,a,i)}disconnect(){ns(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},Sct=class extends rc{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(r,i)=>{this.breakpoints.forEach(n=>{let s=rN.deviceToSize(n.data.size),a=n.dataEvent.orientation==="horizontal"?r:i,o;switch(n.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}n.stage!==o&&(n.stage=o,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:s}=i.contentRect;this.resize(n,s)}})}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext;this.onResizeObserver.observe(r);let i=n=>{var s;if(!(!n.visible||!((s=n.data)!=null&&s.events.length)))for(let{data:a}of n.data.events)a.disabled||a.type==="Resize"&&a.breakpoints.forEach(({data:o,id:l})=>{try{let c=new _ct(l,o,a,n,e,t,this.eventManager);this.breakpoints.push(c)}catch{}})};e.traverseEntity(n=>{var s;(n instanceof qs||n instanceof Jn)&&((s=n.frame)==null||s.traverse(a=>{i(a)})),i(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},Ect=class{constructor(e,t,r,i,n){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=s=>{(s.touches.length>1||this.preventTouchScroll)&&s.preventDefault()},this.onMouseWheelPreventScroll=s=>{this.preventScroll&&s.preventDefault()},this.onMouseMove=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:s.buttons>0}},this.onMouseDown=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!0}},this.onMouseUp=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!1}},this.getMousePosition=s=>{var c;let{domRect:a}=this.eventContext,{pageX:o,pageY:l}=((c=s.touches)==null?void 0:c.length)>0?s.touches[0]:s;return{x:o-(a.left+window.scrollX),y:l-(a.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new flt(this.eventContext),DynamicVariable:new Wlt(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),Conditional:new xlt(this.eventContext,this),Start:new $lt(this.eventContext,this),Basic:new mlt(this.eventContext,this,this.needsRaycast),MouseHover:new Blt(this.eventContext,this),Scroll:new Vlt(this.eventContext,this),Follow:new Ilt(this.eventContext,this),DragDrop:new Clt(this.eventContext,this),LookAt:new Nlt(this.eventContext),Resize:new Sct(this.eventContext,this)};let{page:e,domElement:t}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(r=>{r.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(r=>r.connect()),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var r;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender),i.destroyedInAction=!1}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=r=>{if(r.data.type==="Conditional"&&(r.data.ifActions.forEach(t),r.data.elseActions.forEach(t)),r.data.type==="Conditional"||r.data.type==="SetVariable")for(let i of r.data.type==="Conditional"?r.data.condition:r.data.expression)"id"in i&&Array.isArray(i.id)&&(i.id[0]==="mouse"&&(this.needsMouse=!0),i.id[0]==="raycast"&&(this.needsRaycast=!0));r.data.type==="DynamicVariablePlay"&&r.data.variableId!==""&&(r.data.mode==="Play"||r.data.mode==="PlayPause"||r.data.mode==="Toggle")&&e.setDynamicVariablePlayState(r.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length){for(let n of r.data.events)if(!n.data.disabled)if(n.data.type==="VariableChange"&&(n.data.variableId==="mouseProperty"&&(this.needsMouse=!0),n.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),n.data.type==="Conditional")for(let s of["inActions","outActions"])n.data[s].forEach(t);else if(n.data.type==="DragDrop")for(let s of["drag","drop"])n.data.dragDropActions[s].forEach(t);else if(n.data.type==="GameControl")for(let s of["idle","move","jump","run"])n.data.gameActions[s].forEach(t);else if(n.data.type==="Resize")for(let s of n.data.breakpoints)s.data.actions.forEach(t);else n.data.type==="LookAt"||n.data.actions.forEach(t)}})}},Cct=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new oe().copy(r),this._editorSize=new oe().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=Act(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function Act(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var Tct=class{get sharedAssets(){return this.shared}constructor(e,t={}){this.shared=new Tj(e.shared,t),this.scene=new Fj(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof Jn&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof Ys&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Mct=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function Pct(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function ob(e){return e instanceof Sx?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function Ict(e,t){let r={};return e.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof Ca)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof Ca&&i.states&&Object.keys(i.states).length)return;n=n.parent}let s=i.material.uuid,a=t.shared.materials[s];if(a){if(!Zs.isMergable(a))return}else{let c=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!Zs.isMergable(c.material))return;s=Zs.getHash(c.material)}}r[s]||(r[s]={});let o=r[s][ob(i)];if(o){if(o.push(i),i.cloner)for(let c of i.cloner.children)o.push(c)}else if(r[s][ob(i)]=[i],i.cloner)for(let c of i.cloner.children)r[s][ob(i)].push(c)}),r}function Rct(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function Dct(e,t){let r=Ict(t,e),i=Rct(r),n=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),c=0,d=new Array(i),u=0;for(let[h,f]of Object.entries(r))for(let p of Object.values(f)){if(o=0,c=0,p.forEach(g=>{g instanceof Ca&&(a[o++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),a[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&Pct(a[g]);let m=Yf(a.slice(0,o),!1);if(m){let g;switch(h){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new An(m,l[0].material);break}default:{g=new An(m,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,t.add(g);let v=y=>{u=0;for(let b of y)b.children&&v(b.children),b instanceof Ca&&(Array.isArray(b.material)||r[b.material.uuid]&&r[b.material.uuid][ob(b)]&&r[b.material.uuid][ob(b)].length>1||(d[u++]=b));for(let b=0;b<u;b++)t.attach(d[b])};for(let y=0;y<c;y++){let b=l[y];v(b.children),n[s++]=b}}}for(let h=0;h<s;h++)n[h].removeFromParent()}var Oct=Pn(tje(),1),Lct=new oe;function Nct(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var kct=class{constructor(e,{renderOnDemand:t,renderMode:r="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=i=>{var n,s,a,o,l,c,d,u,h,f,p,m,g;if(this.time=i,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(a=this._perfs)==null||a.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(d=this._animationControls)==null||d.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(u=this._scene)==null||u.traverseVisibleEntity(v=>{v.type==="ParticleSystem"&&(v.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(h=this._eventManager)!=null&&h.isEnabled&&(((f=this._eventManager.handlers)==null?void 0:f.Follow).onAnimationFrameDamping(),((p=this._eventManager.handlers)==null?void 0:p.LookAt).onAnimationFrameDamping(),((m=this._eventManager.handlers)==null?void 0:m.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let v=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=v,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(g=this._perfs)==null||g.end()},this._resize=()=>{var i,n,s,a,o,l,c,d,u,h;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=Lct.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(i=this._scene)==null?void 0:i.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((s=(n=this._frameView)==null?void 0:n.frameSize)==null?void 0:s.x)??this._viewportWidth,((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.y)??this._viewportHeight,((l=this._frameView)==null?void 0:l.enableResponsive)??!1),this._camera){let f=Object.values(((d=this._data)==null?void 0:d.frames)??{})[0].preset??"fullscreen";(u=this._frameView)==null||u.setCamera(this._camera),(h=this._frameView)==null||h.updateCamera(f!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=Z4(this._resize,10),this._onScroll=i=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Mct({x:10,y:10})),QKe(e)}async load(e,t,r){Nct(e),this.disposed=!1;let i=await(await fetch(e,r)).arrayBuffer();await this.start(i,{variables:t})}async start(e,{interactive:t=!0,variables:r}={}){var o,l,c,d;if(this.disposed)return;let i=await wct(e);this._data=i,i.version&&(0,Oct.default)(i.version,"1.0.28")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([u7(i)&&ket(),Art(i)&&Det(),mx.physicsEnabled(i.scene.objects)&&rQe(),n7(i)&&frt(),T7(i)&&hst(),ict(i)&&eQe()].filter(Boolean)),(o=this._eventManager)==null||o.deactivate(),(l=this._controls)==null||l.deactivate(),(c=this._scene)==null||c.dispose();let n=new Tct(i);if(n.resetPersonalCameraFromDocumentData(),this._scene=n.scene,this._sharedAssetsManager=n.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let u=performance.now();Dct(i,n.scene);let h=performance.now();console.log("Merged geometries in ",h-u," ms")}u7(i)&&this._scene.traverse(u=>{Hu(u)&&u.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var u;this._requestRenderAutoMode(),(u=this._scene)==null||u.traverse(h=>{h instanceof Ol&&h.pendingMediaLoad&&h.update()})}),(d=this._scene)==null||d.traverse(u=>{u.type==="ParticleSystem"&&(u.wakeUp(),u.data.autoPlay?u.start():u.stop())});let s=Object.keys(i.shared.fonts).map(u=>this._sharedAssetsManager.getFont(u).loadingPromise);if(Promise.all(s).then(()=>{n.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),n7(i)&&fct(i)&&await Promise.all(s),T7(i)){let u=[];this._scene.traverseEntity(h=>{(h instanceof qs||h instanceof Jn)&&h.uiCanvas&&u.push(h.uiCanvas)}),await Promise.all(u.map(h=>h.promise))}this._scene.rewriteEventsBeforeGoToPlayMode(),Zj(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new nst({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),this._scene.initializeSplatViewer(this._renderer),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let a=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(a.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=a.size[0],this._viewportHeight=a.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Cct(this._renderer,this._camera,new oe(this._viewportWidth,this._viewportHeight),new oe(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(a.allowResponsive??!1)&&a.preset==="fullscreen"),t){let u=new dlt(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,a);this._scene.updateMatrixWorld(!0),this._controls=new pct(u),this._animationControls=new gct(this._scene,this._requestRenderAutoMode),this._eventManager=new Ect(i.scene.publish,this._controls,this._animationControls,u,i.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),r!==void 0&&this.setVariables(r),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var u;(u=this._renderer)==null||u.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[r,i]of t)this.setVariable(r,i)}}setVariable(e,t){var i;let r=this._getVariableByName(e);if(r&&!("dynamicVariableType"in r.data)){let n=t;typeof r.data.value=="number"?n=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof r.data.value=="boolean"?n=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof r.data.value!="string"&&r.data.value.textValue!==void 0&&(n=t.toString());let s=typeof n=="string"?{textValue:n}:n;(i=this._sharedAssetsManager)==null||i.updateVariable(r.id,s),this.requestRender(),this._requestRenderAutoMode()}else r===void 0?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in r.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let r=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(r)}}_getVariableValue(e){return typeof e!="string"&&go.isTextValue(e)?go.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(r=>r.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(r=>{if(r.uuid!==H0&&!this._scene.isInvisibleObjects(r)&&!(r instanceof Jn)){let i=this._createProxyObject(r);i&&e.push(i)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;((t=this._controls)==null?void 0:t.orbitControls)instanceof lce&&((r=this._controls)==null||r.orbitControls.zoomOut(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var a;let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},s=new Ps(t,r,i,n);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(a=this._scene)==null||a.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,r,i,n,s,a;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._proxyObjectCache.forEach(o=>{E8.unsubscribe(o)}),this._variablesCache.clear(),(i=this._renderer)==null||i.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(a=this._controls)==null||a.deactivate(),ZKe(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(r=this._controls)!=null&&r.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(r=this._renderer)==null||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(s=>{s instanceof Jn&&(t=s.name)});let r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof Jn||e instanceof Fj||(n=e.parent)==null?void 0:n.uuid,emitEvent(s){e.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){e.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},i=E8(r,(s,a)=>{var o;typeof e[s]!="object"&&((o=Object.getOwnPropertyDescriptor(e,s))!=null&&o.writable)&&(e[s]=a),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}setUIWasmUrl(e){zoe.skiaWasmUrl=e}},$S=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ak={},zct={get exports(){return Ak},set exports(e){Ak=e}},Qy={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bq;function Bct(){if(Bq)return Qy;Bq=1;var e=Ge,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var d,u={},h=null,f=null;c!==void 0&&(h=""+c),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(f=l.ref);for(d in l)i.call(l,d)&&!s.hasOwnProperty(d)&&(u[d]=l[d]);if(o&&o.defaultProps)for(d in l=o.defaultProps,l)u[d]===void 0&&(u[d]=l[d]);return{$$typeof:t,type:o,key:h,ref:f,props:u,_owner:n.current}}return Qy.Fragment=r,Qy.jsx=a,Qy.jsxs=a,Qy}(function(e){e.exports=Bct()})(zct);const Tk=Ak.jsx;var Fct="Expected a function",Fq=0/0,jct="[object Symbol]",Vct=/^\s+|\s+$/g,Uct=/^[-+]0x[0-9a-f]+$/i,$ct=/^0b[01]+$/i,Hct=/^0o[0-7]+$/i,Wct=parseInt,Gct=typeof $S=="object"&&$S&&$S.Object===Object&&$S,qct=typeof self=="object"&&self&&self.Object===Object&&self,Xct=Gct||qct||Function("return this")(),Yct=Object.prototype,Kct=Yct.toString,Qct=Math.max,Zct=Math.min,qD=function(){return Xct.Date.now()};function Jct(e,t,r){var i,n,s,a,o,l,c=0,d=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(Fct);t=jq(t)||0,Mk(r)&&(d=!!r.leading,u="maxWait"in r,s=u?Qct(jq(r.maxWait)||0,t):s,h="trailing"in r?!!r.trailing:h);function f(w){var E=i,C=n;return i=n=void 0,c=w,a=e.apply(C,E),a}function p(w){return c=w,o=setTimeout(v,t),d?f(w):a}function m(w){var E=w-l,C=w-c,T=t-E;return u?Zct(T,s-C):T}function g(w){var E=w-l,C=w-c;return l===void 0||E>=t||E<0||u&&C>=s}function v(){var w=qD();if(g(w))return y(w);o=setTimeout(v,m(w))}function y(w){return o=void 0,h&&i?f(w):(i=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function x(){return o===void 0?a:y(qD())}function S(){var w=qD(),E=g(w);if(i=arguments,n=this,l=w,E){if(o===void 0)return p(l);if(u)return o=setTimeout(v,t),f(l)}return o===void 0&&(o=setTimeout(v,t)),a}return S.cancel=b,S.flush=x,S}function Mk(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function eut(e){return!!e&&typeof e=="object"}function tut(e){return typeof e=="symbol"||eut(e)&&Kct.call(e)==jct}function jq(e){if(typeof e=="number")return e;if(tut(e))return Fq;if(Mk(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Mk(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Vct,"");var r=$ct.test(e);return r||Hct.test(e)?Wct(e.slice(2),r?2:8):Uct.test(e)?Fq:+e}var rut=Jct;function iut(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}const nut=[],sut={width:"100%",height:"100%"},aut=_.forwardRef(function({className:e,children:t,debounceTime:r=300,ignoreDimensions:i=nut,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const c=_.useRef(null),d=_.useRef(0),[u,h]=_.useState({width:0,height:0,top:0,left:0}),f=_.useMemo(()=>{const p=Array.isArray(i)?i:[i];return rut(m=>{h(g=>Object.keys(g).filter(v=>g[v]!==m[v]).every(v=>p.includes(v))?g:m)},r,{leading:s})},[r,s,i]);return _.useEffect(()=>{const p=a||window.ResizeObserver,m=new p(g=>{g.forEach(v=>{const{left:y,top:b,width:x,height:S}=(v==null?void 0:v.contentRect)??{};d.current=window.requestAnimationFrame(()=>{f({width:x,height:S,top:b,left:y})})})});return c.current&&m.observe(c.current),()=>{window.cancelAnimationFrame(d.current),m.disconnect(),f.cancel()}},[f,a]),Tk("div",{style:{...sut,...n},ref:iut([l,c]),className:e,...o,children:t({...u,ref:c.current,resize:f})})}),cce=_.forwardRef(({scene:e,style:t,onMouseDown:r,onMouseUp:i,onMouseHover:n,onKeyDown:s,onKeyUp:a,onStart:o,onLookAt:l,onFollow:c,onWheel:d,onLoad:u,renderOnDemand:h=!0,...f},p)=>{const m=_.useRef(null),[g,v]=_.useState(!0);return _.useEffect(()=>{v(!0);let y;const b=[{name:"mouseDown",cb:r},{name:"mouseUp",cb:i},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:d}];if(m.current){y=new kct(m.current,{renderOnDemand:h});async function x(){await y.load(e);for(let S of b)S.cb&&y.addEventListener(S.name,S.cb);v(!1),u==null||u(y)}x()}return()=>{for(let x of b)x.cb&&y.removeEventListener(x.name,x.cb);y.dispose()}},[e]),Tk(aut,{ref:p,parentSizeStyles:t,debounceTime:50,...f,children:()=>Tk("canvas",{ref:m,style:{display:g?"none":"block"}})})}),out=()=>{const[e,t]=one.useNotification(),r=Ix(),i=async s=>{const{username:a,password:o}=s;typeof a=="string"&&o!=null&&await tme(TJ,a,o).then(l=>{const c=l.user;tbe(c.uid,c.email),console.log(c),r("/")}).catch(l=>{const c=l.code,d=l.message;n("warning",d),console.log(`${c}: ${d}`)})},n=(s,a)=>{e[s]({message:"Регистрация не удалась",description:a,duration:5})};return G.jsxs(G.Fragment,{children:[t,G.jsxs(oo,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},style:{maxWidth:600},initialValues:{remember:!0},onFinish:i,autoComplete:"off",className:"h-screen w-1/2 bg-white flex flex-col justify-center items-center basis-1/3",children:[G.jsx("div",{className:"text-2xl mb-5 ml-10 font-bold",children:"Регистрация"}),G.jsx(oo.Item,{label:"Email",name:"username",rules:[{required:!0,message:"Введите вашу почту!"}],style:{width:"360px"},children:G.jsx(lA,{style:{width:"180px"}})}),G.jsx(oo.Item,{label:"Пароль",name:"password",rules:[{required:!0,message:"Введите ваш пароль!"}],style:{width:"360px"},children:G.jsx(lA.Password,{style:{width:"180px"}})}),G.jsx(oo.Item,{label:"Телефон: ",rules:[{required:!1,message:"Введите ваш телефон!"}],style:{width:"360px"},children:G.jsx(f4,{direction:"vertical",children:G.jsx(Dze,{addonBefore:"+7",style:{width:"180px"},controls:!0})})}),G.jsx(oo.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:4,span:16},children:G.jsx(kie,{style:{width:"180px"},children:"Запомнить меня"})}),G.jsx(oo.Item,{wrapperCol:{offset:0,span:16},children:G.jsx(ql,{type:"default",htmlType:"submit",children:"Зарегистрироваться"})}),G.jsx(oo.Item,{wrapperCol:{offset:0,span:16},children:G.jsx(ql,{type:"link",onClick:()=>r("/"),children:"Уже есть аккаунт? Войти"})})]})]})},lut=()=>G.jsxs("div",{className:"flex",children:[G.jsx(out,{}),G.jsx(cce,{className:"p-20 hover:animate-pulse",scene:"https://prod.spline.design/NIhvxJXCoZPUn8iT/scene.splinecode"})]}),cut=({isOpened:e,params:t})=>{const[r,i]=one.useNotification();return e&&((s,a,o)=>{r[s]({message:o,description:a,duration:5})})(t.type,t.description,t.message),G.jsx("div",{children:i})},uut=()=>{const e=Ix(),[t,r]=_.useState(!1),i=async n=>{const{username:s,password:a}=n;typeof s=="string"&&a!=null&&await rme(TJ,s,a).then(o=>{localStorage.setItem("currentUserId",o.user.uid),e("/main")}).catch(o=>{const l=o.code,c=o.message;r(!0),console.log(`${l}: ${c}`)})};return G.jsxs(G.Fragment,{children:[G.jsx(cut,{isOpened:t,params:xAe}),G.jsxs(oo,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:i,autoComplete:"off",className:"h-screen bg-white flex flex-col justify-center items-center",children:[G.jsx("div",{className:"flex justify-center items-center w-screen lg:hidden",children:G.jsx("img",{src:"/assets/logo-transparent.png",alt:"Logo"})}),G.jsx("div",{className:"text-2xl mb-5 font-bold",children:"Вход"}),G.jsx(oo.Item,{label:"Email",name:"username",rules:[{required:!0,message:"Введите вашу почту!"}],style:{width:"360px"},children:G.jsx(lA,{style:{width:"180px"}})}),G.jsx(oo.Item,{label:"Пароль",name:"password",rules:[{required:!0,message:"Введите ваш пароль!"}],style:{width:"360px"},children:G.jsx(lA.Password,{style:{width:"180px"}})}),G.jsx(oo.Item,{name:"remember",valuePropName:"checked",wrapperCol:{offset:8,span:16},style:{width:"360px"},children:G.jsx(kie,{children:"Запомнить меня"})}),G.jsx(oo.Item,{wrapperCol:{offset:2,span:16},children:G.jsx(ql,{type:"default",htmlType:"submit",children:"Войти"})}),G.jsx(oo.Item,{wrapperCol:{offset:1,span:16},children:G.jsx(ql,{type:"link",htmlType:"submit",onClick:()=>e("/register"),children:"Ещё нет аккаунта? Регистрация"})})]})]})},dut=()=>{const e={height:"100dvh",padding:"10vh"};return G.jsxs("div",{className:"lg:flex md:flex-row flex-col",children:[G.jsx(uut,{}),G.jsx(cce,{className:"hidden 2xl:block",scene:"https://prod.spline.design/NIhvxJXCoZPUn8iT/scene.splinecode",style:e}),G.jsx("div",{className:"hidden justify-center items-center w-screen lg:flex 2xl:hidden",children:G.jsx("img",{src:"/assets/logo-transparent.png",alt:"Logo"})})]})};function hut(){return G.jsx("div",{children:G.jsx(The,{children:G.jsxs(Che,{children:[G.jsx(jd,{path:"/",element:G.jsx(dut,{})}),G.jsx(jd,{path:"/main",element:G.jsx(zFe,{})}),G.jsx(jd,{path:"/my_music",element:G.jsx(IFe,{})}),G.jsx(jd,{path:"/tracks",element:G.jsx(h4e,{})}),G.jsx(jd,{path:"/creators",element:G.jsx(T4e,{})}),G.jsx(jd,{path:"/other",element:G.jsx(R4e,{})}),G.jsx(jd,{path:"/register",element:G.jsx(lut,{})})]})})})}XD.createRoot(document.getElementById("root")).render(G.jsx(hut,{}));
